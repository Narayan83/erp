var EN=Object.defineProperty;var NN=(e,r,t)=>r in e?EN(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;var _1=(e,r,t)=>NN(e,typeof r!="symbol"?r+"":r,t);function Pj(e,r){for(var t=0;t<r.length;t++){const n=r[t];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const o=Object.getOwnPropertyDescriptor(n,s);o&&Object.defineProperty(e,s,o.get?o:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();var Kn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var I4={exports:{}},A1={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G_;function TN(){if(G_)return A1;G_=1;var e=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function t(n,s,o){var i=null;if(o!==void 0&&(i=""+o),s.key!==void 0&&(i=""+s.key),"key"in s){o={};for(var c in s)c!=="key"&&(o[c]=s[c])}else o=s;return s=o.ref,{$$typeof:e,type:n,key:i,ref:s!==void 0?s:null,props:o}}return A1.Fragment=r,A1.jsx=t,A1.jsxs=t,A1}var K_;function LN(){return K_||(K_=1,I4.exports=TN()),I4.exports}var a=LN(),O4={exports:{}},na={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var X_;function MN(){if(X_)return na;X_=1;var e=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),i=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),l=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),h=Symbol.iterator;function f(N){return N===null||typeof N!="object"?null:(N=h&&N[h]||N["@@iterator"],typeof N=="function"?N:null)}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,g={};function m(N,V,M){this.props=N,this.context=V,this.refs=g,this.updater=M||p}m.prototype.isReactComponent={},m.prototype.setState=function(N,V){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,V,"setState")},m.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function b(){}b.prototype=m.prototype;function y(N,V,M){this.props=N,this.context=V,this.refs=g,this.updater=M||p}var S=y.prototype=new b;S.constructor=y,v(S,m.prototype),S.isPureReactComponent=!0;var C=Array.isArray,L={H:null,A:null,T:null,S:null,V:null},O=Object.prototype.hasOwnProperty;function H(N,V,M,Z,J,re){return M=re.ref,{$$typeof:e,type:N,key:V,ref:M!==void 0?M:null,props:re}}function z(N,V){return H(N.type,V,void 0,void 0,void 0,N.props)}function q(N){return typeof N=="object"&&N!==null&&N.$$typeof===e}function D(N){var V={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function(M){return V[M]})}var W=/\/+/g;function P(N,V){return typeof N=="object"&&N!==null&&N.key!=null?D(""+N.key):V.toString(36)}function I(){}function U(N){switch(N.status){case"fulfilled":return N.value;case"rejected":throw N.reason;default:switch(typeof N.status=="string"?N.then(I,I):(N.status="pending",N.then(function(V){N.status==="pending"&&(N.status="fulfilled",N.value=V)},function(V){N.status==="pending"&&(N.status="rejected",N.reason=V)})),N.status){case"fulfilled":return N.value;case"rejected":throw N.reason}}throw N}function k(N,V,M,Z,J){var re=typeof N;(re==="undefined"||re==="boolean")&&(N=null);var X=!1;if(N===null)X=!0;else switch(re){case"bigint":case"string":case"number":X=!0;break;case"object":switch(N.$$typeof){case e:case r:X=!0;break;case d:return X=N._init,k(X(N._payload),V,M,Z,J)}}if(X)return J=J(N),X=Z===""?"."+P(N,0):Z,C(J)?(M="",X!=null&&(M=X.replace(W,"$&/")+"/"),k(J,V,M,"",function(K){return K})):J!=null&&(q(J)&&(J=z(J,M+(J.key==null||N&&N.key===J.key?"":(""+J.key).replace(W,"$&/")+"/")+X)),V.push(J)),1;X=0;var ne=Z===""?".":Z+":";if(C(N))for(var Y=0;Y<N.length;Y++)Z=N[Y],re=ne+P(Z,Y),X+=k(Z,V,M,re,J);else if(Y=f(N),typeof Y=="function")for(N=Y.call(N),Y=0;!(Z=N.next()).done;)Z=Z.value,re=ne+P(Z,Y++),X+=k(Z,V,M,re,J);else if(re==="object"){if(typeof N.then=="function")return k(U(N),V,M,Z,J);throw V=String(N),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.")}return X}function _(N,V,M){if(N==null)return N;var Z=[],J=0;return k(N,Z,"","",function(re){return V.call(M,re,J++)}),Z}function R(N){if(N._status===-1){var V=N._result;V=V(),V.then(function(M){(N._status===0||N._status===-1)&&(N._status=1,N._result=M)},function(M){(N._status===0||N._status===-1)&&(N._status=2,N._result=M)}),N._status===-1&&(N._status=0,N._result=V)}if(N._status===1)return N._result.default;throw N._result}var j=typeof reportError=="function"?reportError:function(N){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var V=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof N=="object"&&N!==null&&typeof N.message=="string"?String(N.message):String(N),error:N});if(!window.dispatchEvent(V))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",N);return}console.error(N)};function A(){}return na.Children={map:_,forEach:function(N,V,M){_(N,function(){V.apply(this,arguments)},M)},count:function(N){var V=0;return _(N,function(){V++}),V},toArray:function(N){return _(N,function(V){return V})||[]},only:function(N){if(!q(N))throw Error("React.Children.only expected to receive a single React element child.");return N}},na.Component=m,na.Fragment=t,na.Profiler=s,na.PureComponent=y,na.StrictMode=n,na.Suspense=u,na.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=L,na.__COMPILER_RUNTIME={__proto__:null,c:function(N){return L.H.useMemoCache(N)}},na.cache=function(N){return function(){return N.apply(null,arguments)}},na.cloneElement=function(N,V,M){if(N==null)throw Error("The argument must be a React element, but you passed "+N+".");var Z=v({},N.props),J=N.key,re=void 0;if(V!=null)for(X in V.ref!==void 0&&(re=void 0),V.key!==void 0&&(J=""+V.key),V)!O.call(V,X)||X==="key"||X==="__self"||X==="__source"||X==="ref"&&V.ref===void 0||(Z[X]=V[X]);var X=arguments.length-2;if(X===1)Z.children=M;else if(1<X){for(var ne=Array(X),Y=0;Y<X;Y++)ne[Y]=arguments[Y+2];Z.children=ne}return H(N.type,J,void 0,void 0,re,Z)},na.createContext=function(N){return N={$$typeof:i,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null},N.Provider=N,N.Consumer={$$typeof:o,_context:N},N},na.createElement=function(N,V,M){var Z,J={},re=null;if(V!=null)for(Z in V.key!==void 0&&(re=""+V.key),V)O.call(V,Z)&&Z!=="key"&&Z!=="__self"&&Z!=="__source"&&(J[Z]=V[Z]);var X=arguments.length-2;if(X===1)J.children=M;else if(1<X){for(var ne=Array(X),Y=0;Y<X;Y++)ne[Y]=arguments[Y+2];J.children=ne}if(N&&N.defaultProps)for(Z in X=N.defaultProps,X)J[Z]===void 0&&(J[Z]=X[Z]);return H(N,re,void 0,void 0,null,J)},na.createRef=function(){return{current:null}},na.forwardRef=function(N){return{$$typeof:c,render:N}},na.isValidElement=q,na.lazy=function(N){return{$$typeof:d,_payload:{_status:-1,_result:N},_init:R}},na.memo=function(N,V){return{$$typeof:l,type:N,compare:V===void 0?null:V}},na.startTransition=function(N){var V=L.T,M={};L.T=M;try{var Z=N(),J=L.S;J!==null&&J(M,Z),typeof Z=="object"&&Z!==null&&typeof Z.then=="function"&&Z.then(A,j)}catch(re){j(re)}finally{L.T=V}},na.unstable_useCacheRefresh=function(){return L.H.useCacheRefresh()},na.use=function(N){return L.H.use(N)},na.useActionState=function(N,V,M){return L.H.useActionState(N,V,M)},na.useCallback=function(N,V){return L.H.useCallback(N,V)},na.useContext=function(N){return L.H.useContext(N)},na.useDebugValue=function(){},na.useDeferredValue=function(N,V){return L.H.useDeferredValue(N,V)},na.useEffect=function(N,V,M){var Z=L.H;if(typeof M=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Z.useEffect(N,V)},na.useId=function(){return L.H.useId()},na.useImperativeHandle=function(N,V,M){return L.H.useImperativeHandle(N,V,M)},na.useInsertionEffect=function(N,V){return L.H.useInsertionEffect(N,V)},na.useLayoutEffect=function(N,V){return L.H.useLayoutEffect(N,V)},na.useMemo=function(N,V){return L.H.useMemo(N,V)},na.useOptimistic=function(N,V){return L.H.useOptimistic(N,V)},na.useReducer=function(N,V,M){return L.H.useReducer(N,V,M)},na.useRef=function(N){return L.H.useRef(N)},na.useState=function(N){return L.H.useState(N)},na.useSyncExternalStore=function(N,V,M){return L.H.useSyncExternalStore(N,V,M)},na.useTransition=function(){return L.H.useTransition()},na.version="19.1.0",na}var Y_;function QS(){return Y_||(Y_=1,O4.exports=MN()),O4.exports}var G=QS();const vr=Xv(G),rS=Pj({__proto__:null,default:vr},[G]);var P4={exports:{}},C1={},F4={exports:{}},B4={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Z_;function DN(){return Z_||(Z_=1,function(e){function r(_,R){var j=_.length;_.push(R);e:for(;0<j;){var A=j-1>>>1,N=_[A];if(0<s(N,R))_[A]=R,_[j]=N,j=A;else break e}}function t(_){return _.length===0?null:_[0]}function n(_){if(_.length===0)return null;var R=_[0],j=_.pop();if(j!==R){_[0]=j;e:for(var A=0,N=_.length,V=N>>>1;A<V;){var M=2*(A+1)-1,Z=_[M],J=M+1,re=_[J];if(0>s(Z,j))J<N&&0>s(re,Z)?(_[A]=re,_[J]=j,A=J):(_[A]=Z,_[M]=j,A=M);else if(J<N&&0>s(re,j))_[A]=re,_[J]=j,A=J;else break e}}return R}function s(_,R){var j=_.sortIndex-R.sortIndex;return j!==0?j:_.id-R.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var i=Date,c=i.now();e.unstable_now=function(){return i.now()-c}}var u=[],l=[],d=1,h=null,f=3,p=!1,v=!1,g=!1,m=!1,b=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function C(_){for(var R=t(l);R!==null;){if(R.callback===null)n(l);else if(R.startTime<=_)n(l),R.sortIndex=R.expirationTime,r(u,R);else break;R=t(l)}}function L(_){if(g=!1,C(_),!v)if(t(u)!==null)v=!0,O||(O=!0,P());else{var R=t(l);R!==null&&k(L,R.startTime-_)}}var O=!1,H=-1,z=5,q=-1;function D(){return m?!0:!(e.unstable_now()-q<z)}function W(){if(m=!1,O){var _=e.unstable_now();q=_;var R=!0;try{e:{v=!1,g&&(g=!1,y(H),H=-1),p=!0;var j=f;try{t:{for(C(_),h=t(u);h!==null&&!(h.expirationTime>_&&D());){var A=h.callback;if(typeof A=="function"){h.callback=null,f=h.priorityLevel;var N=A(h.expirationTime<=_);if(_=e.unstable_now(),typeof N=="function"){h.callback=N,C(_),R=!0;break t}h===t(u)&&n(u),C(_)}else n(u);h=t(u)}if(h!==null)R=!0;else{var V=t(l);V!==null&&k(L,V.startTime-_),R=!1}}break e}finally{h=null,f=j,p=!1}R=void 0}}finally{R?P():O=!1}}}var P;if(typeof S=="function")P=function(){S(W)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,U=I.port2;I.port1.onmessage=W,P=function(){U.postMessage(null)}}else P=function(){b(W,0)};function k(_,R){H=b(function(){_(e.unstable_now())},R)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(_){_.callback=null},e.unstable_forceFrameRate=function(_){0>_||125<_?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<_?Math.floor(1e3/_):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_next=function(_){switch(f){case 1:case 2:case 3:var R=3;break;default:R=f}var j=f;f=R;try{return _()}finally{f=j}},e.unstable_requestPaint=function(){m=!0},e.unstable_runWithPriority=function(_,R){switch(_){case 1:case 2:case 3:case 4:case 5:break;default:_=3}var j=f;f=_;try{return R()}finally{f=j}},e.unstable_scheduleCallback=function(_,R,j){var A=e.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?A+j:A):j=A,_){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=j+N,_={id:d++,callback:R,priorityLevel:_,startTime:j,expirationTime:N,sortIndex:-1},j>A?(_.sortIndex=j,r(l,_),t(u)===null&&_===t(l)&&(g?(y(H),H=-1):g=!0,k(L,j-A))):(_.sortIndex=N,r(u,_),v||p||(v=!0,O||(O=!0,P()))),_},e.unstable_shouldYield=D,e.unstable_wrapCallback=function(_){var R=f;return function(){var j=f;f=R;try{return _.apply(this,arguments)}finally{f=j}}}}(B4)),B4}var J_;function IN(){return J_||(J_=1,F4.exports=DN()),F4.exports}var z4={exports:{}},So={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Q_;function ON(){if(Q_)return So;Q_=1;var e=QS();function r(u){var l="https://react.dev/errors/"+u;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)l+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+u+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(r(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function o(u,l,d){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:h==null?null:""+h,children:u,containerInfo:l,implementation:d}}var i=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(u,l){if(u==="font")return"";if(typeof l=="string")return l==="use-credentials"?l:""}return So.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,So.createPortal=function(u,l){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)throw Error(r(299));return o(u,l,null,d)},So.flushSync=function(u){var l=i.T,d=n.p;try{if(i.T=null,n.p=2,u)return u()}finally{i.T=l,n.p=d,n.d.f()}},So.preconnect=function(u,l){typeof u=="string"&&(l?(l=l.crossOrigin,l=typeof l=="string"?l==="use-credentials"?l:"":void 0):l=null,n.d.C(u,l))},So.prefetchDNS=function(u){typeof u=="string"&&n.d.D(u)},So.preinit=function(u,l){if(typeof u=="string"&&l&&typeof l.as=="string"){var d=l.as,h=c(d,l.crossOrigin),f=typeof l.integrity=="string"?l.integrity:void 0,p=typeof l.fetchPriority=="string"?l.fetchPriority:void 0;d==="style"?n.d.S(u,typeof l.precedence=="string"?l.precedence:void 0,{crossOrigin:h,integrity:f,fetchPriority:p}):d==="script"&&n.d.X(u,{crossOrigin:h,integrity:f,fetchPriority:p,nonce:typeof l.nonce=="string"?l.nonce:void 0})}},So.preinitModule=function(u,l){if(typeof u=="string")if(typeof l=="object"&&l!==null){if(l.as==null||l.as==="script"){var d=c(l.as,l.crossOrigin);n.d.M(u,{crossOrigin:d,integrity:typeof l.integrity=="string"?l.integrity:void 0,nonce:typeof l.nonce=="string"?l.nonce:void 0})}}else l==null&&n.d.M(u)},So.preload=function(u,l){if(typeof u=="string"&&typeof l=="object"&&l!==null&&typeof l.as=="string"){var d=l.as,h=c(d,l.crossOrigin);n.d.L(u,d,{crossOrigin:h,integrity:typeof l.integrity=="string"?l.integrity:void 0,nonce:typeof l.nonce=="string"?l.nonce:void 0,type:typeof l.type=="string"?l.type:void 0,fetchPriority:typeof l.fetchPriority=="string"?l.fetchPriority:void 0,referrerPolicy:typeof l.referrerPolicy=="string"?l.referrerPolicy:void 0,imageSrcSet:typeof l.imageSrcSet=="string"?l.imageSrcSet:void 0,imageSizes:typeof l.imageSizes=="string"?l.imageSizes:void 0,media:typeof l.media=="string"?l.media:void 0})}},So.preloadModule=function(u,l){if(typeof u=="string")if(l){var d=c(l.as,l.crossOrigin);n.d.m(u,{as:typeof l.as=="string"&&l.as!=="script"?l.as:void 0,crossOrigin:d,integrity:typeof l.integrity=="string"?l.integrity:void 0})}else n.d.m(u)},So.requestFormReset=function(u){n.d.r(u)},So.unstable_batchedUpdates=function(u,l){return u(l)},So.useFormState=function(u,l,d){return i.H.useFormState(u,l,d)},So.useFormStatus=function(){return i.H.useHostTransitionStatus()},So.version="19.1.0",So}var e5;function Fj(){if(e5)return z4.exports;e5=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),z4.exports=ON(),z4.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t5;function PN(){if(t5)return C1;t5=1;var e=IN(),r=QS(),t=Fj();function n(x){var w="https://react.dev/errors/"+x;if(1<arguments.length){w+="?args[]="+encodeURIComponent(arguments[1]);for(var E=2;E<arguments.length;E++)w+="&args[]="+encodeURIComponent(arguments[E])}return"Minified React error #"+x+"; visit "+w+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(x){return!(!x||x.nodeType!==1&&x.nodeType!==9&&x.nodeType!==11)}function o(x){var w=x,E=x;if(x.alternate)for(;w.return;)w=w.return;else{x=w;do w=x,(w.flags&4098)!==0&&(E=w.return),x=w.return;while(x)}return w.tag===3?E:null}function i(x){if(x.tag===13){var w=x.memoizedState;if(w===null&&(x=x.alternate,x!==null&&(w=x.memoizedState)),w!==null)return w.dehydrated}return null}function c(x){if(o(x)!==x)throw Error(n(188))}function u(x){var w=x.alternate;if(!w){if(w=o(x),w===null)throw Error(n(188));return w!==x?null:x}for(var E=x,B=w;;){var Q=E.return;if(Q===null)break;var ie=Q.alternate;if(ie===null){if(B=Q.return,B!==null){E=B;continue}break}if(Q.child===ie.child){for(ie=Q.child;ie;){if(ie===E)return c(Q),x;if(ie===B)return c(Q),w;ie=ie.sibling}throw Error(n(188))}if(E.return!==B.return)E=Q,B=ie;else{for(var Ae=!1,Ue=Q.child;Ue;){if(Ue===E){Ae=!0,E=Q,B=ie;break}if(Ue===B){Ae=!0,B=Q,E=ie;break}Ue=Ue.sibling}if(!Ae){for(Ue=ie.child;Ue;){if(Ue===E){Ae=!0,E=ie,B=Q;break}if(Ue===B){Ae=!0,B=ie,E=Q;break}Ue=Ue.sibling}if(!Ae)throw Error(n(189))}}if(E.alternate!==B)throw Error(n(190))}if(E.tag!==3)throw Error(n(188));return E.stateNode.current===E?x:w}function l(x){var w=x.tag;if(w===5||w===26||w===27||w===6)return x;for(x=x.child;x!==null;){if(w=l(x),w!==null)return w;x=x.sibling}return null}var d=Object.assign,h=Symbol.for("react.element"),f=Symbol.for("react.transitional.element"),p=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),g=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),b=Symbol.for("react.provider"),y=Symbol.for("react.consumer"),S=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),H=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),q=Symbol.for("react.activity"),D=Symbol.for("react.memo_cache_sentinel"),W=Symbol.iterator;function P(x){return x===null||typeof x!="object"?null:(x=W&&x[W]||x["@@iterator"],typeof x=="function"?x:null)}var I=Symbol.for("react.client.reference");function U(x){if(x==null)return null;if(typeof x=="function")return x.$$typeof===I?null:x.displayName||x.name||null;if(typeof x=="string")return x;switch(x){case v:return"Fragment";case m:return"Profiler";case g:return"StrictMode";case L:return"Suspense";case O:return"SuspenseList";case q:return"Activity"}if(typeof x=="object")switch(x.$$typeof){case p:return"Portal";case S:return(x.displayName||"Context")+".Provider";case y:return(x._context.displayName||"Context")+".Consumer";case C:var w=x.render;return x=x.displayName,x||(x=w.displayName||w.name||"",x=x!==""?"ForwardRef("+x+")":"ForwardRef"),x;case H:return w=x.displayName||null,w!==null?w:U(x.type)||"Memo";case z:w=x._payload,x=x._init;try{return U(x(w))}catch{}}return null}var k=Array.isArray,_=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,R=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,j={pending:!1,data:null,method:null,action:null},A=[],N=-1;function V(x){return{current:x}}function M(x){0>N||(x.current=A[N],A[N]=null,N--)}function Z(x,w){N++,A[N]=x.current,x.current=w}var J=V(null),re=V(null),X=V(null),ne=V(null);function Y(x,w){switch(Z(X,w),Z(re,x),Z(J,null),w.nodeType){case 9:case 11:x=(x=w.documentElement)&&(x=x.namespaceURI)?_s(x):0;break;default:if(x=w.tagName,w=w.namespaceURI)w=_s(w),x=Ms(w,x);else switch(x){case"svg":x=1;break;case"math":x=2;break;default:x=0}}M(J),Z(J,x)}function K(){M(J),M(re),M(X)}function ee(x){x.memoizedState!==null&&Z(ne,x);var w=J.current,E=Ms(w,x.type);w!==E&&(Z(re,x),Z(J,E))}function ue(x){re.current===x&&(M(J),M(re)),ne.current===x&&(M(ne),Nf._currentValue=j)}var se=Object.prototype.hasOwnProperty,ce=e.unstable_scheduleCallback,fe=e.unstable_cancelCallback,ve=e.unstable_shouldYield,_e=e.unstable_requestPaint,le=e.unstable_now,ke=e.unstable_getCurrentPriorityLevel,Te=e.unstable_ImmediatePriority,pe=e.unstable_UserBlockingPriority,ye=e.unstable_NormalPriority,ge=e.unstable_LowPriority,De=e.unstable_IdlePriority,He=e.log,Xe=e.unstable_setDisableYieldValue,at=null,dt=null;function wt(x){if(typeof He=="function"&&Xe(x),dt&&typeof dt.setStrictMode=="function")try{dt.setStrictMode(at,x)}catch{}}var $t=Math.clz32?Math.clz32:tr,Bt=Math.log,ft=Math.LN2;function tr(x){return x>>>=0,x===0?32:31-(Bt(x)/ft|0)|0}var Me=256,tt=4194304;function Ze(x){var w=x&42;if(w!==0)return w;switch(x&-x){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return x&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return x&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return x}}function St(x,w,E){var B=x.pendingLanes;if(B===0)return 0;var Q=0,ie=x.suspendedLanes,Ae=x.pingedLanes;x=x.warmLanes;var Ue=B&134217727;return Ue!==0?(B=Ue&~ie,B!==0?Q=Ze(B):(Ae&=Ue,Ae!==0?Q=Ze(Ae):E||(E=Ue&~x,E!==0&&(Q=Ze(E))))):(Ue=B&~ie,Ue!==0?Q=Ze(Ue):Ae!==0?Q=Ze(Ae):E||(E=B&~x,E!==0&&(Q=Ze(E)))),Q===0?0:w!==0&&w!==Q&&(w&ie)===0&&(ie=Q&-Q,E=w&-w,ie>=E||ie===32&&(E&4194048)!==0)?w:Q}function et(x,w){return(x.pendingLanes&~(x.suspendedLanes&~x.pingedLanes)&w)===0}function Ht(x,w){switch(x){case 1:case 2:case 4:case 8:case 64:return w+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return w+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Nt(){var x=Me;return Me<<=1,(Me&4194048)===0&&(Me=256),x}function kt(){var x=tt;return tt<<=1,(tt&62914560)===0&&(tt=4194304),x}function kr(x){for(var w=[],E=0;31>E;E++)w.push(x);return w}function Jt(x,w){x.pendingLanes|=w,w!==268435456&&(x.suspendedLanes=0,x.pingedLanes=0,x.warmLanes=0)}function Pt(x,w,E,B,Q,ie){var Ae=x.pendingLanes;x.pendingLanes=E,x.suspendedLanes=0,x.pingedLanes=0,x.warmLanes=0,x.expiredLanes&=E,x.entangledLanes&=E,x.errorRecoveryDisabledLanes&=E,x.shellSuspendCounter=0;var Ue=x.entanglements,lt=x.expirationTimes,Ot=x.hiddenUpdates;for(E=Ae&~E;0<E;){var hr=31-$t(E),Sr=1<<hr;Ue[hr]=0,lt[hr]=-1;var Gt=Ot[hr];if(Gt!==null)for(Ot[hr]=null,hr=0;hr<Gt.length;hr++){var Ft=Gt[hr];Ft!==null&&(Ft.lane&=-536870913)}E&=~Sr}B!==0&&Ur(x,B,0),ie!==0&&Q===0&&x.tag!==0&&(x.suspendedLanes|=ie&~(Ae&~w))}function Ur(x,w,E){x.pendingLanes|=w,x.suspendedLanes&=~w;var B=31-$t(w);x.entangledLanes|=w,x.entanglements[B]=x.entanglements[B]|1073741824|E&4194090}function Lr(x,w){var E=x.entangledLanes|=w;for(x=x.entanglements;E;){var B=31-$t(E),Q=1<<B;Q&w|x[B]&w&&(x[B]|=w),E&=~Q}}function vt(x){switch(x){case 2:x=1;break;case 8:x=4;break;case 32:x=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:x=128;break;case 268435456:x=134217728;break;default:x=0}return x}function nr(x){return x&=-x,2<x?8<x?(x&134217727)!==0?32:268435456:8:2}function Cr(){var x=R.p;return x!==0?x:(x=window.event,x===void 0?32:sy(x.type))}function Dt(x,w){var E=R.p;try{return R.p=x,w()}finally{R.p=E}}var je=Math.random().toString(36).slice(2),ct="__reactFiber$"+je,nt="__reactProps$"+je,Pe="__reactContainer$"+je,Qe="__reactEvents$"+je,gt="__reactListeners$"+je,xe="__reactHandles$"+je,Oe="__reactResources$"+je,Ce="__reactMarker$"+je;function de(x){delete x[ct],delete x[nt],delete x[Qe],delete x[gt],delete x[xe]}function be(x){var w=x[ct];if(w)return w;for(var E=x.parentNode;E;){if(w=E[Pe]||E[ct]){if(E=w.alternate,w.child!==null||E!==null&&E.child!==null)for(x=Gb(x);x!==null;){if(E=x[ct])return E;x=Gb(x)}return w}x=E,E=x.parentNode}return null}function Se(x){if(x=x[ct]||x[Pe]){var w=x.tag;if(w===5||w===6||w===13||w===26||w===27||w===3)return x}return null}function Ne(x){var w=x.tag;if(w===5||w===26||w===27||w===6)return x.stateNode;throw Error(n(33))}function ze(x){var w=x[Oe];return w||(w=x[Oe]={hoistableStyles:new Map,hoistableScripts:new Map}),w}function Re(x){x[Ce]=!0}var Ie=new Set,ae={};function we(x,w){Fe(x,w),Fe(x+"Capture",w)}function Fe(x,w){for(ae[x]=w,x=0;x<w.length;x++)Ie.add(w[x])}var Ye=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),me={},Be={};function Ge(x){return se.call(Be,x)?!0:se.call(me,x)?!1:Ye.test(x)?Be[x]=!0:(me[x]=!0,!1)}function mt(x,w,E){if(Ge(w))if(E===null)x.removeAttribute(w);else{switch(typeof E){case"undefined":case"function":case"symbol":x.removeAttribute(w);return;case"boolean":var B=w.toLowerCase().slice(0,5);if(B!=="data-"&&B!=="aria-"){x.removeAttribute(w);return}}x.setAttribute(w,""+E)}}function _t(x,w,E){if(E===null)x.removeAttribute(w);else{switch(typeof E){case"undefined":case"function":case"symbol":case"boolean":x.removeAttribute(w);return}x.setAttribute(w,""+E)}}function ot(x,w,E,B){if(B===null)x.removeAttribute(E);else{switch(typeof B){case"undefined":case"function":case"symbol":case"boolean":x.removeAttribute(E);return}x.setAttributeNS(w,E,""+B)}}var xt,zt;function Vt(x){if(xt===void 0)try{throw Error()}catch(E){var w=E.stack.trim().match(/\n( *(at )?)/);xt=w&&w[1]||"",zt=-1<E.stack.indexOf(`
    at`)?" (<anonymous>)":-1<E.stack.indexOf("@")?"@unknown:0:0":""}return`
`+xt+x+zt}var Ar=!1;function wr(x,w){if(!x||Ar)return"";Ar=!0;var E=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var B={DetermineComponentFrameRoot:function(){try{if(w){var Sr=function(){throw Error()};if(Object.defineProperty(Sr.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Sr,[])}catch(Ft){var Gt=Ft}Reflect.construct(x,[],Sr)}else{try{Sr.call()}catch(Ft){Gt=Ft}x.call(Sr.prototype)}}else{try{throw Error()}catch(Ft){Gt=Ft}(Sr=x())&&typeof Sr.catch=="function"&&Sr.catch(function(){})}}catch(Ft){if(Ft&&Gt&&typeof Ft.stack=="string")return[Ft.stack,Gt.stack]}return[null,null]}};B.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var Q=Object.getOwnPropertyDescriptor(B.DetermineComponentFrameRoot,"name");Q&&Q.configurable&&Object.defineProperty(B.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var ie=B.DetermineComponentFrameRoot(),Ae=ie[0],Ue=ie[1];if(Ae&&Ue){var lt=Ae.split(`
`),Ot=Ue.split(`
`);for(Q=B=0;B<lt.length&&!lt[B].includes("DetermineComponentFrameRoot");)B++;for(;Q<Ot.length&&!Ot[Q].includes("DetermineComponentFrameRoot");)Q++;if(B===lt.length||Q===Ot.length)for(B=lt.length-1,Q=Ot.length-1;1<=B&&0<=Q&&lt[B]!==Ot[Q];)Q--;for(;1<=B&&0<=Q;B--,Q--)if(lt[B]!==Ot[Q]){if(B!==1||Q!==1)do if(B--,Q--,0>Q||lt[B]!==Ot[Q]){var hr=`
`+lt[B].replace(" at new "," at ");return x.displayName&&hr.includes("<anonymous>")&&(hr=hr.replace("<anonymous>",x.displayName)),hr}while(1<=B&&0<=Q);break}}}finally{Ar=!1,Error.prepareStackTrace=E}return(E=x?x.displayName||x.name:"")?Vt(E):""}function Nr(x){switch(x.tag){case 26:case 27:case 5:return Vt(x.type);case 16:return Vt("Lazy");case 13:return Vt("Suspense");case 19:return Vt("SuspenseList");case 0:case 15:return wr(x.type,!1);case 11:return wr(x.type.render,!1);case 1:return wr(x.type,!0);case 31:return Vt("Activity");default:return""}}function Dr(x){try{var w="";do w+=Nr(x),x=x.return;while(x);return w}catch(E){return`
Error generating stack: `+E.message+`
`+E.stack}}function Yr(x){switch(typeof x){case"bigint":case"boolean":case"number":case"string":case"undefined":return x;case"object":return x;default:return""}}function Vr(x){var w=x.type;return(x=x.nodeName)&&x.toLowerCase()==="input"&&(w==="checkbox"||w==="radio")}function on(x){var w=Vr(x)?"checked":"value",E=Object.getOwnPropertyDescriptor(x.constructor.prototype,w),B=""+x[w];if(!x.hasOwnProperty(w)&&typeof E<"u"&&typeof E.get=="function"&&typeof E.set=="function"){var Q=E.get,ie=E.set;return Object.defineProperty(x,w,{configurable:!0,get:function(){return Q.call(this)},set:function(Ae){B=""+Ae,ie.call(this,Ae)}}),Object.defineProperty(x,w,{enumerable:E.enumerable}),{getValue:function(){return B},setValue:function(Ae){B=""+Ae},stopTracking:function(){x._valueTracker=null,delete x[w]}}}}function xn(x){x._valueTracker||(x._valueTracker=on(x))}function ia(x){if(!x)return!1;var w=x._valueTracker;if(!w)return!0;var E=w.getValue(),B="";return x&&(B=Vr(x)?x.checked?"true":"false":x.value),x=B,x!==E?(w.setValue(x),!0):!1}function yn(x){if(x=x||(typeof document<"u"?document:void 0),typeof x>"u")return null;try{return x.activeElement||x.body}catch{return x.body}}var oa=/[\n"\\]/g;function Qn(x){return x.replace(oa,function(w){return"\\"+w.charCodeAt(0).toString(16)+" "})}function za(x,w,E,B,Q,ie,Ae,Ue){x.name="",Ae!=null&&typeof Ae!="function"&&typeof Ae!="symbol"&&typeof Ae!="boolean"?x.type=Ae:x.removeAttribute("type"),w!=null?Ae==="number"?(w===0&&x.value===""||x.value!=w)&&(x.value=""+Yr(w)):x.value!==""+Yr(w)&&(x.value=""+Yr(w)):Ae!=="submit"&&Ae!=="reset"||x.removeAttribute("value"),w!=null?Ir(x,Ae,Yr(w)):E!=null?Ir(x,Ae,Yr(E)):B!=null&&x.removeAttribute("value"),Q==null&&ie!=null&&(x.defaultChecked=!!ie),Q!=null&&(x.checked=Q&&typeof Q!="function"&&typeof Q!="symbol"),Ue!=null&&typeof Ue!="function"&&typeof Ue!="symbol"&&typeof Ue!="boolean"?x.name=""+Yr(Ue):x.removeAttribute("name")}function pr(x,w,E,B,Q,ie,Ae,Ue){if(ie!=null&&typeof ie!="function"&&typeof ie!="symbol"&&typeof ie!="boolean"&&(x.type=ie),w!=null||E!=null){if(!(ie!=="submit"&&ie!=="reset"||w!=null))return;E=E!=null?""+Yr(E):"",w=w!=null?""+Yr(w):E,Ue||w===x.value||(x.value=w),x.defaultValue=w}B=B??Q,B=typeof B!="function"&&typeof B!="symbol"&&!!B,x.checked=Ue?x.checked:!!B,x.defaultChecked=!!B,Ae!=null&&typeof Ae!="function"&&typeof Ae!="symbol"&&typeof Ae!="boolean"&&(x.name=Ae)}function Ir(x,w,E){w==="number"&&yn(x.ownerDocument)===x||x.defaultValue===""+E||(x.defaultValue=""+E)}function $n(x,w,E,B){if(x=x.options,w){w={};for(var Q=0;Q<E.length;Q++)w["$"+E[Q]]=!0;for(E=0;E<x.length;E++)Q=w.hasOwnProperty("$"+x[E].value),x[E].selected!==Q&&(x[E].selected=Q),Q&&B&&(x[E].defaultSelected=!0)}else{for(E=""+Yr(E),w=null,Q=0;Q<x.length;Q++){if(x[Q].value===E){x[Q].selected=!0,B&&(x[Q].defaultSelected=!0);return}w!==null||x[Q].disabled||(w=x[Q])}w!==null&&(w.selected=!0)}}function Fr(x,w,E){if(w!=null&&(w=""+Yr(w),w!==x.value&&(x.value=w),E==null)){x.defaultValue!==w&&(x.defaultValue=w);return}x.defaultValue=E!=null?""+Yr(E):""}function jr(x,w,E,B){if(w==null){if(B!=null){if(E!=null)throw Error(n(92));if(k(B)){if(1<B.length)throw Error(n(93));B=B[0]}E=B}E==null&&(E=""),w=E}E=Yr(w),x.defaultValue=E,B=x.textContent,B===E&&B!==""&&B!==null&&(x.value=B)}function Le(x,w){if(w){var E=x.firstChild;if(E&&E===x.lastChild&&E.nodeType===3){E.nodeValue=w;return}}x.textContent=w}var rt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ke(x,w,E){var B=w.indexOf("--")===0;E==null||typeof E=="boolean"||E===""?B?x.setProperty(w,""):w==="float"?x.cssFloat="":x[w]="":B?x.setProperty(w,E):typeof E!="number"||E===0||rt.has(w)?w==="float"?x.cssFloat=E:x[w]=(""+E).trim():x[w]=E+"px"}function pt(x,w,E){if(w!=null&&typeof w!="object")throw Error(n(62));if(x=x.style,E!=null){for(var B in E)!E.hasOwnProperty(B)||w!=null&&w.hasOwnProperty(B)||(B.indexOf("--")===0?x.setProperty(B,""):B==="float"?x.cssFloat="":x[B]="");for(var Q in w)B=w[Q],w.hasOwnProperty(Q)&&E[Q]!==B&&Ke(x,Q,B)}else for(var ie in w)w.hasOwnProperty(ie)&&Ke(x,ie,w[ie])}function rr(x){if(x.indexOf("-")===-1)return!1;switch(x){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ur=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Rr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Kr(x){return Rr.test(""+x)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":x}var sr=null;function jn(x){return x=x.target||x.srcElement||window,x.correspondingUseElement&&(x=x.correspondingUseElement),x.nodeType===3?x.parentNode:x}var Kt=null,qt=null;function Gr(x){var w=Se(x);if(w&&(x=w.stateNode)){var E=x[nt]||null;e:switch(x=w.stateNode,w.type){case"input":if(za(x,E.value,E.defaultValue,E.defaultValue,E.checked,E.defaultChecked,E.type,E.name),w=E.name,E.type==="radio"&&w!=null){for(E=x;E.parentNode;)E=E.parentNode;for(E=E.querySelectorAll('input[name="'+Qn(""+w)+'"][type="radio"]'),w=0;w<E.length;w++){var B=E[w];if(B!==x&&B.form===x.form){var Q=B[nt]||null;if(!Q)throw Error(n(90));za(B,Q.value,Q.defaultValue,Q.defaultValue,Q.checked,Q.defaultChecked,Q.type,Q.name)}}for(w=0;w<E.length;w++)B=E[w],B.form===x.form&&ia(B)}break e;case"textarea":Fr(x,E.value,E.defaultValue);break e;case"select":w=E.value,w!=null&&$n(x,!!E.multiple,w,!1)}}}var fn=!1;function rn(x,w,E){if(fn)return x(w,E);fn=!0;try{var B=x(w);return B}finally{if(fn=!1,(Kt!==null||qt!==null)&&($p(),Kt&&(w=Kt,x=qt,qt=Kt=null,Gr(w),x)))for(w=0;w<x.length;w++)Gr(x[w])}}function $a(x,w){var E=x.stateNode;if(E===null)return null;var B=E[nt]||null;if(B===null)return null;E=B[w];e:switch(w){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(B=!B.disabled)||(x=x.type,B=!(x==="button"||x==="input"||x==="select"||x==="textarea")),x=!B;break e;default:x=!1}if(x)return null;if(E&&typeof E!="function")throw Error(n(231,w,typeof E));return E}var la=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=!1;if(la)try{var mn={};Object.defineProperty(mn,"passive",{get:function(){ja=!0}}),window.addEventListener("test",mn,mn),window.removeEventListener("test",mn,mn)}catch{ja=!1}var Or=null,wa=null,Vn=null;function Xs(){if(Vn)return Vn;var x,w=wa,E=w.length,B,Q="value"in Or?Or.value:Or.textContent,ie=Q.length;for(x=0;x<E&&w[x]===Q[x];x++);var Ae=E-x;for(B=1;B<=Ae&&w[E-B]===Q[ie-B];B++);return Vn=Q.slice(x,1<B?1-B:void 0)}function Qr(x){var w=x.keyCode;return"charCode"in x?(x=x.charCode,x===0&&w===13&&(x=13)):x=w,x===10&&(x=13),32<=x||x===13?x:0}function qn(){return!0}function ks(){return!1}function wn(x){function w(E,B,Q,ie,Ae){this._reactName=E,this._targetInst=Q,this.type=B,this.nativeEvent=ie,this.target=Ae,this.currentTarget=null;for(var Ue in x)x.hasOwnProperty(Ue)&&(E=x[Ue],this[Ue]=E?E(ie):ie[Ue]);return this.isDefaultPrevented=(ie.defaultPrevented!=null?ie.defaultPrevented:ie.returnValue===!1)?qn:ks,this.isPropagationStopped=ks,this}return d(w.prototype,{preventDefault:function(){this.defaultPrevented=!0;var E=this.nativeEvent;E&&(E.preventDefault?E.preventDefault():typeof E.returnValue!="unknown"&&(E.returnValue=!1),this.isDefaultPrevented=qn)},stopPropagation:function(){var E=this.nativeEvent;E&&(E.stopPropagation?E.stopPropagation():typeof E.cancelBubble!="unknown"&&(E.cancelBubble=!0),this.isPropagationStopped=qn)},persist:function(){},isPersistent:qn}),w}var ka={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(x){return x.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xn=wn(ka),st=d({},ka,{view:0,detail:0}),Wt=wn(st),At,Xt,ht,er=d({},st,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ys,button:0,buttons:0,relatedTarget:function(x){return x.relatedTarget===void 0?x.fromElement===x.srcElement?x.toElement:x.fromElement:x.relatedTarget},movementX:function(x){return"movementX"in x?x.movementX:(x!==ht&&(ht&&x.type==="mousemove"?(At=x.screenX-ht.screenX,Xt=x.screenY-ht.screenY):Xt=At=0,ht=x),At)},movementY:function(x){return"movementY"in x?x.movementY:Xt}}),mr=wn(er),ar=d({},er,{dataTransfer:0}),Mr=wn(ar),Wr=d({},st,{relatedTarget:0}),_n=wn(Wr),en=d({},ka,{animationName:0,elapsedTime:0,pseudoElement:0}),Yt=wn(en),xr=d({},ka,{clipboardData:function(x){return"clipboardData"in x?x.clipboardData:window.clipboardData}}),Hr=wn(xr),Na=d({},ka,{data:0}),Ra=wn(Na),Xi={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Oi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Rs(x){var w=this.nativeEvent;return w.getModifierState?w.getModifierState(x):(x=Oi[x])?!!w[x]:!1}function Ys(){return Rs}var Do=d({},st,{key:function(x){if(x.key){var w=Xi[x.key]||x.key;if(w!=="Unidentified")return w}return x.type==="keypress"?(x=Qr(x),x===13?"Enter":String.fromCharCode(x)):x.type==="keydown"||x.type==="keyup"?hn[x.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ys,charCode:function(x){return x.type==="keypress"?Qr(x):0},keyCode:function(x){return x.type==="keydown"||x.type==="keyup"?x.keyCode:0},which:function(x){return x.type==="keypress"?Qr(x):x.type==="keydown"||x.type==="keyup"?x.keyCode:0}}),ea=wn(Do),Gn=d({},er,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Za=wn(Gn),Zu=d({},st,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ys}),ls=wn(Zu),Es=d({},ka,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ns=wn(Es),yl=d({},er,{deltaX:function(x){return"deltaX"in x?x.deltaX:"wheelDeltaX"in x?-x.wheelDeltaX:0},deltaY:function(x){return"deltaY"in x?x.deltaY:"wheelDeltaY"in x?-x.wheelDeltaY:"wheelDelta"in x?-x.wheelDelta:0},deltaZ:0,deltaMode:0}),_c=wn(yl),Vd=d({},ka,{newState:0,oldState:0}),Wd=wn(Vd),Ac=[9,13,27,32],ah=la&&"CompositionEvent"in window,nu=null;la&&"documentMode"in document&&(nu=document.documentMode);var sh=la&&"TextEvent"in window&&!nu,au=la&&(!ah||nu&&8<nu&&11>=nu),qd=" ",ih=!1;function ep(x,w){switch(x){case"keyup":return Ac.indexOf(w.keyCode)!==-1;case"keydown":return w.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gd(x){return x=x.detail,typeof x=="object"&&"data"in x?x.data:null}var Kl=!1;function oe(x,w){switch(x){case"compositionend":return Gd(w);case"keypress":return w.which!==32?null:(ih=!0,qd);case"textInput":return x=w.data,x===qd&&ih?null:x;default:return null}}function Ve(x,w){if(Kl)return x==="compositionend"||!ah&&ep(x,w)?(x=Xs(),Vn=wa=Or=null,Kl=!1,x):null;switch(x){case"paste":return null;case"keypress":if(!(w.ctrlKey||w.altKey||w.metaKey)||w.ctrlKey&&w.altKey){if(w.char&&1<w.char.length)return w.char;if(w.which)return String.fromCharCode(w.which)}return null;case"compositionend":return au&&w.locale!=="ko"?null:w.data;default:return null}}var It={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Qt(x){var w=x&&x.nodeName&&x.nodeName.toLowerCase();return w==="input"?!!It[x.type]:w==="textarea"}function Lt(x,w,E,B){Kt?qt?qt.push(B):qt=[B]:Kt=B,w=Kp(w,"onChange"),0<w.length&&(E=new Xn("onChange","change",null,E,B),x.push({event:E,listeners:w}))}var jt=null,cr=null;function Jr(x){Bb(x,0)}function ta(x){var w=Ne(x);if(ia(w))return x}function Ta(x,w){if(x==="change")return w}var Ts=!1;if(la){var cs;if(la){var Ps="oninput"in document;if(!Ps){var Yi=document.createElement("div");Yi.setAttribute("oninput","return;"),Ps=typeof Yi.oninput=="function"}cs=Ps}else cs=!1;Ts=cs&&(!document.documentMode||9<document.documentMode)}function wl(){jt&&(jt.detachEvent("onpropertychange",oi),cr=jt=null)}function oi(x){if(x.propertyName==="value"&&ta(cr)){var w=[];Lt(w,cr,x,jn(x)),rn(Jr,w)}}function Xo(x,w,E){x==="focusin"?(wl(),jt=w,cr=E,jt.attachEvent("onpropertychange",oi)):x==="focusout"&&wl()}function li(x){if(x==="selectionchange"||x==="keyup"||x==="keydown")return ta(cr)}function Yo(x,w){if(x==="click")return ta(w)}function Ju(x,w){if(x==="input"||x==="change")return ta(w)}function Kd(x,w){return x===w&&(x!==0||1/x===1/w)||x!==x&&w!==w}var Pi=typeof Object.is=="function"?Object.is:Kd;function Io(x,w){if(Pi(x,w))return!0;if(typeof x!="object"||x===null||typeof w!="object"||w===null)return!1;var E=Object.keys(x),B=Object.keys(w);if(E.length!==B.length)return!1;for(B=0;B<E.length;B++){var Q=E[B];if(!se.call(w,Q)||!Pi(x[Q],w[Q]))return!1}return!0}function Zi(x){for(;x&&x.firstChild;)x=x.firstChild;return x}function Xd(x,w){var E=Zi(x);x=0;for(var B;E;){if(E.nodeType===3){if(B=x+E.textContent.length,x<=w&&B>=w)return{node:E,offset:w-x};x=B}e:{for(;E;){if(E.nextSibling){E=E.nextSibling;break e}E=E.parentNode}E=void 0}E=Zi(E)}}function oh(x,w){return x&&w?x===w?!0:x&&x.nodeType===3?!1:w&&w.nodeType===3?oh(x,w.parentNode):"contains"in x?x.contains(w):x.compareDocumentPosition?!!(x.compareDocumentPosition(w)&16):!1:!1}function lh(x){x=x!=null&&x.ownerDocument!=null&&x.ownerDocument.defaultView!=null?x.ownerDocument.defaultView:window;for(var w=yn(x.document);w instanceof x.HTMLIFrameElement;){try{var E=typeof w.contentWindow.location.href=="string"}catch{E=!1}if(E)x=w.contentWindow;else break;w=yn(x.document)}return w}function Yd(x){var w=x&&x.nodeName&&x.nodeName.toLowerCase();return w&&(w==="input"&&(x.type==="text"||x.type==="search"||x.type==="tel"||x.type==="url"||x.type==="password")||w==="textarea"||x.contentEditable==="true")}var tp=la&&"documentMode"in document&&11>=document.documentMode,Cc=null,Sl=null,Ct=null,lr=!1;function Zt(x,w,E){var B=E.window===E?E.document:E.nodeType===9?E:E.ownerDocument;lr||Cc==null||Cc!==yn(B)||(B=Cc,"selectionStart"in B&&Yd(B)?B={start:B.selectionStart,end:B.selectionEnd}:(B=(B.ownerDocument&&B.ownerDocument.defaultView||window).getSelection(),B={anchorNode:B.anchorNode,anchorOffset:B.anchorOffset,focusNode:B.focusNode,focusOffset:B.focusOffset}),Ct&&Io(Ct,B)||(Ct=B,B=Kp(Sl,"onSelect"),0<B.length&&(w=new Xn("onSelect","select",null,w,E),x.push({event:w,listeners:B}),w.target=Cc)))}function qr(x,w){var E={};return E[x.toLowerCase()]=w.toLowerCase(),E["Webkit"+x]="webkit"+w,E["Moz"+x]="moz"+w,E}var kn={animationend:qr("Animation","AnimationEnd"),animationiteration:qr("Animation","AnimationIteration"),animationstart:qr("Animation","AnimationStart"),transitionrun:qr("Transition","TransitionRun"),transitionstart:qr("Transition","TransitionStart"),transitioncancel:qr("Transition","TransitionCancel"),transitionend:qr("Transition","TransitionEnd")},ga={},Ls={};la&&(Ls=document.createElement("div").style,"AnimationEvent"in window||(delete kn.animationend.animation,delete kn.animationiteration.animation,delete kn.animationstart.animation),"TransitionEvent"in window||delete kn.transitionend.transition);function va(x){if(ga[x])return ga[x];if(!kn[x])return x;var w=kn[x],E;for(E in w)if(w.hasOwnProperty(E)&&E in Ls)return ga[x]=w[E];return x}var Qu=va("animationend"),su=va("animationiteration"),Oo=va("animationstart"),rp=va("transitionrun"),Vw=va("transitionstart"),Zd=va("transitioncancel"),ch=va("transitionend"),uh=new Map,Da="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Da.push("scrollEnd");function _l(x,w){uh.set(x,w),we(w,[x])}var ag=new WeakMap;function Ji(x,w){if(typeof x=="object"&&x!==null){var E=ag.get(x);return E!==void 0?E:(w={value:x,source:w,stack:Dr(w)},ag.set(x,w),w)}return{value:x,source:w,stack:Dr(w)}}var Zo=[],Jd=0,sg=0;function ed(){for(var x=Jd,w=sg=Jd=0;w<x;){var E=Zo[w];Zo[w++]=null;var B=Zo[w];Zo[w++]=null;var Q=Zo[w];Zo[w++]=null;var ie=Zo[w];if(Zo[w++]=null,B!==null&&Q!==null){var Ae=B.pending;Ae===null?Q.next=Q:(Q.next=Ae.next,Ae.next=Q),B.pending=Q}ie!==0&&dh(E,Q,ie)}}function Al(x,w,E,B){Zo[Jd++]=x,Zo[Jd++]=w,Zo[Jd++]=E,Zo[Jd++]=B,sg|=B,x.lanes|=B,x=x.alternate,x!==null&&(x.lanes|=B)}function Qd(x,w,E,B){return Al(x,w,E,B),fh(x)}function td(x,w){return Al(x,null,null,w),fh(x)}function dh(x,w,E){x.lanes|=E;var B=x.alternate;B!==null&&(B.lanes|=E);for(var Q=!1,ie=x.return;ie!==null;)ie.childLanes|=E,B=ie.alternate,B!==null&&(B.childLanes|=E),ie.tag===22&&(x=ie.stateNode,x===null||x._visibility&1||(Q=!0)),x=ie,ie=ie.return;return x.tag===3?(ie=x.stateNode,Q&&w!==null&&(Q=31-$t(E),x=ie.hiddenUpdates,B=x[Q],B===null?x[Q]=[w]:B.push(w),w.lane=E|536870912),ie):null}function fh(x){if(50<Sf)throw Sf=0,Qg=null,Error(n(185));for(var w=x.return;w!==null;)x=w,w=x.return;return x.tag===3?x.stateNode:null}var rd={};function np(x,w,E,B){this.tag=x,this.key=E,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=w,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=B,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function uo(x,w,E,B){return new np(x,w,E,B)}function nd(x){return x=x.prototype,!(!x||!x.isReactComponent)}function Qi(x,w){var E=x.alternate;return E===null?(E=uo(x.tag,w,x.key,x.mode),E.elementType=x.elementType,E.type=x.type,E.stateNode=x.stateNode,E.alternate=x,x.alternate=E):(E.pendingProps=w,E.type=x.type,E.flags=0,E.subtreeFlags=0,E.deletions=null),E.flags=x.flags&65011712,E.childLanes=x.childLanes,E.lanes=x.lanes,E.child=x.child,E.memoizedProps=x.memoizedProps,E.memoizedState=x.memoizedState,E.updateQueue=x.updateQueue,w=x.dependencies,E.dependencies=w===null?null:{lanes:w.lanes,firstContext:w.firstContext},E.sibling=x.sibling,E.index=x.index,E.ref=x.ref,E.refCleanup=x.refCleanup,E}function hh(x,w){x.flags&=65011714;var E=x.alternate;return E===null?(x.childLanes=0,x.lanes=w,x.child=null,x.subtreeFlags=0,x.memoizedProps=null,x.memoizedState=null,x.updateQueue=null,x.dependencies=null,x.stateNode=null):(x.childLanes=E.childLanes,x.lanes=E.lanes,x.child=E.child,x.subtreeFlags=0,x.deletions=null,x.memoizedProps=E.memoizedProps,x.memoizedState=E.memoizedState,x.updateQueue=E.updateQueue,x.type=E.type,w=E.dependencies,x.dependencies=w===null?null:{lanes:w.lanes,firstContext:w.firstContext}),x}function ap(x,w,E,B,Q,ie){var Ae=0;if(B=x,typeof x=="function")nd(x)&&(Ae=1);else if(typeof x=="string")Ae=w4(x,E,J.current)?26:x==="html"||x==="head"||x==="body"?27:5;else e:switch(x){case q:return x=uo(31,E,w,Q),x.elementType=q,x.lanes=ie,x;case v:return ad(E.children,Q,ie,w);case g:Ae=8,Q|=24;break;case m:return x=uo(12,E,w,Q|2),x.elementType=m,x.lanes=ie,x;case L:return x=uo(13,E,w,Q),x.elementType=L,x.lanes=ie,x;case O:return x=uo(19,E,w,Q),x.elementType=O,x.lanes=ie,x;default:if(typeof x=="object"&&x!==null)switch(x.$$typeof){case b:case S:Ae=10;break e;case y:Ae=9;break e;case C:Ae=11;break e;case H:Ae=14;break e;case z:Ae=16,B=null;break e}Ae=29,E=Error(n(130,x===null?"null":typeof x,"")),B=null}return w=uo(Ae,E,w,Q),w.elementType=x,w.type=B,w.lanes=ie,w}function ad(x,w,E,B){return x=uo(7,x,B,w),x.lanes=E,x}function ig(x,w,E){return x=uo(6,x,null,w),x.lanes=E,x}function ef(x,w,E){return w=uo(4,x.children!==null?x.children:[],x.key,w),w.lanes=E,w.stateNode={containerInfo:x.containerInfo,pendingChildren:null,implementation:x.implementation},w}var jc=[],iu=0,sp=null,ph=0,Jo=[],Qo=0,ps=null,ys=1,kc="";function sd(x,w){jc[iu++]=ph,jc[iu++]=sp,sp=x,ph=w}function og(x,w,E){Jo[Qo++]=ys,Jo[Qo++]=kc,Jo[Qo++]=ps,ps=x;var B=ys;x=kc;var Q=32-$t(B)-1;B&=~(1<<Q),E+=1;var ie=32-$t(w)+Q;if(30<ie){var Ae=Q-Q%5;ie=(B&(1<<Ae)-1).toString(32),B>>=Ae,Q-=Ae,ys=1<<32-$t(w)+Q|E<<Q|B,kc=ie+x}else ys=1<<ie|E<<Q|B,kc=x}function lg(x){x.return!==null&&(sd(x,1),og(x,1,0))}function mh(x){for(;x===sp;)sp=jc[--iu],jc[iu]=null,ph=jc[--iu],jc[iu]=null;for(;x===ps;)ps=Jo[--Qo],Jo[Qo]=null,kc=Jo[--Qo],Jo[Qo]=null,ys=Jo[--Qo],Jo[Qo]=null}var ci=null,ws=null,xa=!1,Cl=null,fo=!1,tf=Error(n(519));function el(x){var w=Error(n(418,""));throw ou(Ji(w,x)),tf}function bx(x){var w=x.stateNode,E=x.type,B=x.memoizedProps;switch(w[ct]=x,w[nt]=B,E){case"dialog":pa("cancel",w),pa("close",w);break;case"iframe":case"object":case"embed":pa("load",w);break;case"video":case"audio":for(E=0;E<n0.length;E++)pa(n0[E],w);break;case"source":pa("error",w);break;case"img":case"image":case"link":pa("error",w),pa("load",w);break;case"details":pa("toggle",w);break;case"input":pa("invalid",w),pr(w,B.value,B.defaultValue,B.checked,B.defaultChecked,B.type,B.name,!0),xn(w);break;case"select":pa("invalid",w);break;case"textarea":pa("invalid",w),jr(w,B.value,B.defaultValue,B.children),xn(w)}E=B.children,typeof E!="string"&&typeof E!="number"&&typeof E!="bigint"||w.textContent===""+E||B.suppressHydrationWarning===!0||Ub(w.textContent,E)?(B.popover!=null&&(pa("beforetoggle",w),pa("toggle",w)),B.onScroll!=null&&pa("scroll",w),B.onScrollEnd!=null&&pa("scrollend",w),B.onClick!=null&&(w.onclick=Xp),w=!0):w=!1,w||el(x)}function yx(x){for(ci=x.return;ci;)switch(ci.tag){case 5:case 13:fo=!1;return;case 27:case 3:fo=!0;return;default:ci=ci.return}}function gh(x){if(x!==ci)return!1;if(!xa)return yx(x),xa=!0,!1;var w=x.tag,E;if((E=w!==3&&w!==27)&&((E=w===5)&&(E=x.type,E=!(E!=="form"&&E!=="button")||Zp(x.type,x.memoizedProps)),E=!E),E&&ws&&el(x),yx(x),w===13){if(x=x.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(n(317));e:{for(x=x.nextSibling,w=0;x;){if(x.nodeType===8)if(E=x.data,E==="/$"){if(w===0){ws=Tl(x.nextSibling);break e}w--}else E!=="$"&&E!=="$!"&&E!=="$?"||w++;x=x.nextSibling}ws=null}}else w===27?(w=ws,il(x.type)?(x=h1,h1=null,ws=x):ws=w):ws=ci?Tl(x.stateNode.nextSibling):null;return!0}function vh(){ws=ci=null,xa=!1}function wx(){var x=Cl;return x!==null&&(yo===null?yo=x:yo.push.apply(yo,x),Cl=null),x}function ou(x){Cl===null?Cl=[x]:Cl.push(x)}var id=V(null),lu=null,$e=null;function Po(x,w,E){Z(id,w._currentValue),w._currentValue=E}function tl(x){x._currentValue=id.current,M(id)}function ho(x,w,E){for(;x!==null;){var B=x.alternate;if((x.childLanes&w)!==w?(x.childLanes|=w,B!==null&&(B.childLanes|=w)):B!==null&&(B.childLanes&w)!==w&&(B.childLanes|=w),x===E)break;x=x.return}}function ca(x,w,E,B){var Q=x.child;for(Q!==null&&(Q.return=x);Q!==null;){var ie=Q.dependencies;if(ie!==null){var Ae=Q.child;ie=ie.firstContext;e:for(;ie!==null;){var Ue=ie;ie=Q;for(var lt=0;lt<w.length;lt++)if(Ue.context===w[lt]){ie.lanes|=E,Ue=ie.alternate,Ue!==null&&(Ue.lanes|=E),ho(ie.return,E,x),B||(Ae=null);break e}ie=Ue.next}}else if(Q.tag===18){if(Ae=Q.return,Ae===null)throw Error(n(341));Ae.lanes|=E,ie=Ae.alternate,ie!==null&&(ie.lanes|=E),ho(Ae,E,x),Ae=null}else Ae=Q.child;if(Ae!==null)Ae.return=Q;else for(Ae=Q;Ae!==null;){if(Ae===x){Ae=null;break}if(Q=Ae.sibling,Q!==null){Q.return=Ae.return,Ae=Q;break}Ae=Ae.return}Q=Ae}}function xh(x,w,E,B){x=null;for(var Q=w,ie=!1;Q!==null;){if(!ie){if((Q.flags&524288)!==0)ie=!0;else if((Q.flags&262144)!==0)break}if(Q.tag===10){var Ae=Q.alternate;if(Ae===null)throw Error(n(387));if(Ae=Ae.memoizedProps,Ae!==null){var Ue=Q.type;Pi(Q.pendingProps.value,Ae.value)||(x!==null?x.push(Ue):x=[Ue])}}else if(Q===ne.current){if(Ae=Q.alternate,Ae===null)throw Error(n(387));Ae.memoizedState.memoizedState!==Q.memoizedState.memoizedState&&(x!==null?x.push(Nf):x=[Nf])}Q=Q.return}x!==null&&ca(w,x,E,B),w.flags|=262144}function ip(x){for(x=x.firstContext;x!==null;){if(!Pi(x.context._currentValue,x.memoizedValue))return!0;x=x.next}return!1}function od(x){lu=x,$e=null,x=x.dependencies,x!==null&&(x.firstContext=null)}function Fs(x){return Sx(lu,x)}function op(x,w){return lu===null&&od(x),Sx(x,w)}function Sx(x,w){var E=w._currentValue;if(w={context:w,memoizedValue:E,next:null},$e===null){if(x===null)throw Error(n(308));$e=w,x.dependencies={lanes:0,firstContext:w},x.flags|=524288}else $e=$e.next=w;return E}var Ww=typeof AbortController<"u"?AbortController:function(){var x=[],w=this.signal={aborted:!1,addEventListener:function(E,B){x.push(B)}};this.abort=function(){w.aborted=!0,x.forEach(function(E){return E()})}},qw=e.unstable_scheduleCallback,Gw=e.unstable_NormalPriority,ts={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function cg(){return{controller:new Ww,data:new Map,refCount:0}}function bh(x){x.refCount--,x.refCount===0&&qw(Gw,function(){x.controller.abort()})}var yh=null,ug=0,rf=0,po=null;function Kw(x,w){if(yh===null){var E=yh=[];ug=0,rf=Gp(),po={status:"pending",value:void 0,then:function(B){E.push(B)}}}return ug++,w.then(_x,_x),w}function _x(){if(--ug===0&&yh!==null){po!==null&&(po.status="fulfilled");var x=yh;yh=null,rf=0,po=null;for(var w=0;w<x.length;w++)(0,x[w])()}}function Xw(x,w){var E=[],B={status:"pending",value:null,reason:null,then:function(Q){E.push(Q)}};return x.then(function(){B.status="fulfilled",B.value=w;for(var Q=0;Q<E.length;Q++)(0,E[Q])(w)},function(Q){for(B.status="rejected",B.reason=Q,Q=0;Q<E.length;Q++)(0,E[Q])(void 0)}),B}var Ax=_.S;_.S=function(x,w){typeof w=="object"&&w!==null&&typeof w.then=="function"&&Kw(x,w),Ax!==null&&Ax(x,w)};var ld=V(null);function Rc(){var x=ld.current;return x!==null?x:us.pooledCache}function lp(x,w){w===null?Z(ld,ld.current):Z(ld,w.pool)}function Cx(){var x=Rc();return x===null?null:{parent:ts._currentValue,pool:x}}var eo=Error(n(460)),jx=Error(n(474)),cp=Error(n(542)),dg={then:function(){}};function kx(x){return x=x.status,x==="fulfilled"||x==="rejected"}function up(){}function fg(x,w,E){switch(E=x[E],E===void 0?x.push(w):E!==w&&(w.then(up,up),w=E),w.status){case"fulfilled":return w.value;case"rejected":throw x=w.reason,Ex(x),x;default:if(typeof w.status=="string")w.then(up,up);else{if(x=us,x!==null&&100<x.shellSuspendCounter)throw Error(n(482));x=w,x.status="pending",x.then(function(B){if(w.status==="pending"){var Q=w;Q.status="fulfilled",Q.value=B}},function(B){if(w.status==="pending"){var Q=w;Q.status="rejected",Q.reason=B}})}switch(w.status){case"fulfilled":return w.value;case"rejected":throw x=w.reason,Ex(x),x}throw nf=w,eo}}var nf=null;function Rx(){if(nf===null)throw Error(n(459));var x=nf;return nf=null,x}function Ex(x){if(x===eo||x===cp)throw Error(n(483))}var Xl=!1;function cd(x){x.updateQueue={baseState:x.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function af(x,w){x=x.updateQueue,w.updateQueue===x&&(w.updateQueue={baseState:x.baseState,firstBaseUpdate:x.firstBaseUpdate,lastBaseUpdate:x.lastBaseUpdate,shared:x.shared,callbacks:null})}function cu(x){return{lane:x,tag:0,payload:null,callback:null,next:null}}function Ec(x,w,E){var B=x.updateQueue;if(B===null)return null;if(B=B.shared,(Ga&2)!==0){var Q=B.pending;return Q===null?w.next=w:(w.next=Q.next,Q.next=w),B.pending=w,w=fh(x),dh(x,null,E),w}return Al(x,B,w,E),fh(x)}function wh(x,w,E){if(w=w.updateQueue,w!==null&&(w=w.shared,(E&4194048)!==0)){var B=w.lanes;B&=x.pendingLanes,E|=B,w.lanes=E,Lr(x,E)}}function jl(x,w){var E=x.updateQueue,B=x.alternate;if(B!==null&&(B=B.updateQueue,E===B)){var Q=null,ie=null;if(E=E.firstBaseUpdate,E!==null){do{var Ae={lane:E.lane,tag:E.tag,payload:E.payload,callback:null,next:null};ie===null?Q=ie=Ae:ie=ie.next=Ae,E=E.next}while(E!==null);ie===null?Q=ie=w:ie=ie.next=w}else Q=ie=w;E={baseState:B.baseState,firstBaseUpdate:Q,lastBaseUpdate:ie,shared:B.shared,callbacks:B.callbacks},x.updateQueue=E;return}x=E.lastBaseUpdate,x===null?E.firstBaseUpdate=w:x.next=w,E.lastBaseUpdate=w}var Sh=!1;function kl(){if(Sh){var x=po;if(x!==null)throw x}}function Fi(x,w,E,B){Sh=!1;var Q=x.updateQueue;Xl=!1;var ie=Q.firstBaseUpdate,Ae=Q.lastBaseUpdate,Ue=Q.shared.pending;if(Ue!==null){Q.shared.pending=null;var lt=Ue,Ot=lt.next;lt.next=null,Ae===null?ie=Ot:Ae.next=Ot,Ae=lt;var hr=x.alternate;hr!==null&&(hr=hr.updateQueue,Ue=hr.lastBaseUpdate,Ue!==Ae&&(Ue===null?hr.firstBaseUpdate=Ot:Ue.next=Ot,hr.lastBaseUpdate=lt))}if(ie!==null){var Sr=Q.baseState;Ae=0,hr=Ot=lt=null,Ue=ie;do{var Gt=Ue.lane&-536870913,Ft=Gt!==Ue.lane;if(Ft?(Ea&Gt)===Gt:(B&Gt)===Gt){Gt!==0&&Gt===rf&&(Sh=!0),hr!==null&&(hr=hr.next={lane:0,tag:Ue.tag,payload:Ue.payload,callback:null,next:null});e:{var Nn=x,Rn=Ue;Gt=w;var Qa=E;switch(Rn.tag){case 1:if(Nn=Rn.payload,typeof Nn=="function"){Sr=Nn.call(Qa,Sr,Gt);break e}Sr=Nn;break e;case 3:Nn.flags=Nn.flags&-65537|128;case 0:if(Nn=Rn.payload,Gt=typeof Nn=="function"?Nn.call(Qa,Sr,Gt):Nn,Gt==null)break e;Sr=d({},Sr,Gt);break e;case 2:Xl=!0}}Gt=Ue.callback,Gt!==null&&(x.flags|=64,Ft&&(x.flags|=8192),Ft=Q.callbacks,Ft===null?Q.callbacks=[Gt]:Ft.push(Gt))}else Ft={lane:Gt,tag:Ue.tag,payload:Ue.payload,callback:Ue.callback,next:null},hr===null?(Ot=hr=Ft,lt=Sr):hr=hr.next=Ft,Ae|=Gt;if(Ue=Ue.next,Ue===null){if(Ue=Q.shared.pending,Ue===null)break;Ft=Ue,Ue=Ft.next,Ft.next=null,Q.lastBaseUpdate=Ft,Q.shared.pending=null}}while(!0);hr===null&&(lt=Sr),Q.baseState=lt,Q.firstBaseUpdate=Ot,Q.lastBaseUpdate=hr,ie===null&&(Q.shared.lanes=0),xu|=Ae,x.lanes=Ae,x.memoizedState=Sr}}function Nx(x,w){if(typeof x!="function")throw Error(n(191,x));x.call(w)}function hg(x,w){var E=x.callbacks;if(E!==null)for(x.callbacks=null,x=0;x<E.length;x++)Nx(E[x],w)}var ud=V(null),uu=V(0);function Nc(x,w){x=Bc,Z(uu,x),Z(ud,w),Bc=x|w.baseLanes}function dp(){Z(uu,Bc),Z(ud,ud.current)}function pg(){Bc=uu.current,M(ud),M(uu)}var Rl=0,ra=null,qa=null,ba=null,sf=!1,dd=!1,Bi=!1,of=0,du=0,rl=null,Tx=0;function Sa(){throw Error(n(321))}function _h(x,w){if(w===null)return!1;for(var E=0;E<w.length&&E<x.length;E++)if(!Pi(x[E],w[E]))return!1;return!0}function mg(x,w,E,B,Q,ie){return Rl=ie,ra=w,w.memoizedState=null,w.updateQueue=null,w.lanes=0,_.H=x===null||x.memoizedState===null?Vx:Mg,Bi=!1,ie=E(B,Q),Bi=!1,dd&&(ie=Mx(w,E,B,Q)),Lx(x),ie}function Lx(x){_.H=Dh;var w=qa!==null&&qa.next!==null;if(Rl=0,ba=qa=ra=null,sf=!1,du=0,rl=null,w)throw Error(n(300));x===null||Si||(x=x.dependencies,x!==null&&ip(x)&&(Si=!0))}function Mx(x,w,E,B){ra=x;var Q=0;do{if(dd&&(rl=null),du=0,dd=!1,25<=Q)throw Error(n(301));if(Q+=1,ba=qa=null,x.updateQueue!=null){var ie=x.updateQueue;ie.lastEffect=null,ie.events=null,ie.stores=null,ie.memoCache!=null&&(ie.memoCache.index=0)}_.H=Wx,ie=w(E,B)}while(dd);return ie}function gg(){var x=_.H,w=x.useState()[0];return w=typeof w.then=="function"?Ah(w):w,x=x.useState()[0],(qa!==null?qa.memoizedState:null)!==x&&(ra.flags|=1024),w}function vg(){var x=of!==0;return of=0,x}function fd(x,w,E){w.updateQueue=x.updateQueue,w.flags&=-2053,x.lanes&=~E}function fp(x){if(sf){for(x=x.memoizedState;x!==null;){var w=x.queue;w!==null&&(w.pending=null),x=x.next}sf=!1}Rl=0,ba=qa=ra=null,dd=!1,du=of=0,rl=null}function mo(){var x={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ba===null?ra.memoizedState=ba=x:ba=ba.next=x,ba}function Zs(){if(qa===null){var x=ra.alternate;x=x!==null?x.memoizedState:null}else x=qa.next;var w=ba===null?ra.memoizedState:ba.next;if(w!==null)ba=w,qa=x;else{if(x===null)throw ra.alternate===null?Error(n(467)):Error(n(310));qa=x,x={memoizedState:qa.memoizedState,baseState:qa.baseState,baseQueue:qa.baseQueue,queue:qa.queue,next:null},ba===null?ra.memoizedState=ba=x:ba=ba.next=x}return ba}function hd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ah(x){var w=du;return du+=1,rl===null&&(rl=[]),x=fg(rl,x,w),w=ra,(ba===null?w.memoizedState:ba.next)===null&&(w=w.alternate,_.H=w===null||w.memoizedState===null?Vx:Mg),x}function hp(x){if(x!==null&&typeof x=="object"){if(typeof x.then=="function")return Ah(x);if(x.$$typeof===S)return Fs(x)}throw Error(n(438,String(x)))}function Ch(x){var w=null,E=ra.updateQueue;if(E!==null&&(w=E.memoCache),w==null){var B=ra.alternate;B!==null&&(B=B.updateQueue,B!==null&&(B=B.memoCache,B!=null&&(w={data:B.data.map(function(Q){return Q.slice()}),index:0})))}if(w==null&&(w={data:[],index:0}),E===null&&(E=hd(),ra.updateQueue=E),E.memoCache=w,E=w.data[w.index],E===void 0)for(E=w.data[w.index]=Array(x),B=0;B<x;B++)E[B]=D;return w.index++,E}function Yl(x,w){return typeof w=="function"?w(x):w}function pp(x){var w=Zs();return xg(w,qa,x)}function xg(x,w,E){var B=x.queue;if(B===null)throw Error(n(311));B.lastRenderedReducer=E;var Q=x.baseQueue,ie=B.pending;if(ie!==null){if(Q!==null){var Ae=Q.next;Q.next=ie.next,ie.next=Ae}w.baseQueue=Q=ie,B.pending=null}if(ie=x.baseState,Q===null)x.memoizedState=ie;else{w=Q.next;var Ue=Ae=null,lt=null,Ot=w,hr=!1;do{var Sr=Ot.lane&-536870913;if(Sr!==Ot.lane?(Ea&Sr)===Sr:(Rl&Sr)===Sr){var Gt=Ot.revertLane;if(Gt===0)lt!==null&&(lt=lt.next={lane:0,revertLane:0,action:Ot.action,hasEagerState:Ot.hasEagerState,eagerState:Ot.eagerState,next:null}),Sr===rf&&(hr=!0);else if((Rl&Gt)===Gt){Ot=Ot.next,Gt===rf&&(hr=!0);continue}else Sr={lane:0,revertLane:Ot.revertLane,action:Ot.action,hasEagerState:Ot.hasEagerState,eagerState:Ot.eagerState,next:null},lt===null?(Ue=lt=Sr,Ae=ie):lt=lt.next=Sr,ra.lanes|=Gt,xu|=Gt;Sr=Ot.action,Bi&&E(ie,Sr),ie=Ot.hasEagerState?Ot.eagerState:E(ie,Sr)}else Gt={lane:Sr,revertLane:Ot.revertLane,action:Ot.action,hasEagerState:Ot.hasEagerState,eagerState:Ot.eagerState,next:null},lt===null?(Ue=lt=Gt,Ae=ie):lt=lt.next=Gt,ra.lanes|=Sr,xu|=Sr;Ot=Ot.next}while(Ot!==null&&Ot!==w);if(lt===null?Ae=ie:lt.next=Ue,!Pi(ie,x.memoizedState)&&(Si=!0,hr&&(E=po,E!==null)))throw E;x.memoizedState=ie,x.baseState=Ae,x.baseQueue=lt,B.lastRenderedState=ie}return Q===null&&(B.lanes=0),[x.memoizedState,B.dispatch]}function bg(x){var w=Zs(),E=w.queue;if(E===null)throw Error(n(311));E.lastRenderedReducer=x;var B=E.dispatch,Q=E.pending,ie=w.memoizedState;if(Q!==null){E.pending=null;var Ae=Q=Q.next;do ie=x(ie,Ae.action),Ae=Ae.next;while(Ae!==Q);Pi(ie,w.memoizedState)||(Si=!0),w.memoizedState=ie,w.baseQueue===null&&(w.baseState=ie),E.lastRenderedState=ie}return[ie,B]}function yg(x,w,E){var B=ra,Q=Zs(),ie=xa;if(ie){if(E===void 0)throw Error(n(407));E=E()}else E=w();var Ae=!Pi((qa||Q).memoizedState,E);Ae&&(Q.memoizedState=E,Si=!0),Q=Q.queue;var Ue=gp.bind(null,B,Q,x);if(Rh(2048,8,Ue,[x]),Q.getSnapshot!==w||Ae||ba!==null&&ba.memoizedState.tag&1){if(B.flags|=2048,lf(9,wp(),Dx.bind(null,B,Q,E,w),null),us===null)throw Error(n(349));ie||(Rl&124)!==0||mp(B,w,E)}return E}function mp(x,w,E){x.flags|=16384,x={getSnapshot:w,value:E},w=ra.updateQueue,w===null?(w=hd(),ra.updateQueue=w,w.stores=[x]):(E=w.stores,E===null?w.stores=[x]:E.push(x))}function Dx(x,w,E,B){w.value=E,w.getSnapshot=B,wg(w)&&Sg(x)}function gp(x,w,E){return E(function(){wg(w)&&Sg(x)})}function wg(x){var w=x.getSnapshot;x=x.value;try{var E=w();return!Pi(x,E)}catch{return!0}}function Sg(x){var w=td(x,2);w!==null&&Uo(w,x,2)}function vp(x){var w=mo();if(typeof x=="function"){var E=x;if(x=E(),Bi){wt(!0);try{E()}finally{wt(!1)}}}return w.memoizedState=w.baseState=x,w.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yl,lastRenderedState:x},w}function jh(x,w,E,B){return x.baseState=E,xg(x,qa,typeof B=="function"?B:Yl)}function Yw(x,w,E,B,Q){if(Cp(x))throw Error(n(485));if(x=w.action,x!==null){var ie={payload:Q,action:x,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Ae){ie.listeners.push(Ae)}};_.T!==null?E(!0):ie.isTransition=!1,B(ie),E=w.pending,E===null?(ie.next=w.pending=ie,_g(w,ie)):(ie.next=E.next,w.pending=E.next=ie)}}function _g(x,w){var E=w.action,B=w.payload,Q=x.state;if(w.isTransition){var ie=_.T,Ae={};_.T=Ae;try{var Ue=E(Q,B),lt=_.S;lt!==null&&lt(Ae,Ue),Ag(x,w,Ue)}catch(Ot){xp(x,w,Ot)}finally{_.T=ie}}else try{ie=E(Q,B),Ag(x,w,ie)}catch(Ot){xp(x,w,Ot)}}function Ag(x,w,E){E!==null&&typeof E=="object"&&typeof E.then=="function"?E.then(function(B){Ix(x,w,B)},function(B){return xp(x,w,B)}):Ix(x,w,E)}function Ix(x,w,E){w.status="fulfilled",w.value=E,Ox(w),x.state=E,w=x.pending,w!==null&&(E=w.next,E===w?x.pending=null:(E=E.next,w.next=E,_g(x,E)))}function xp(x,w,E){var B=x.pending;if(x.pending=null,B!==null){B=B.next;do w.status="rejected",w.reason=E,Ox(w),w=w.next;while(w!==B)}x.action=null}function Ox(x){x=x.listeners;for(var w=0;w<x.length;w++)(0,x[w])()}function bp(x,w){return w}function Cg(x,w){if(xa){var E=us.formState;if(E!==null){e:{var B=ra;if(xa){if(ws){t:{for(var Q=ws,ie=fo;Q.nodeType!==8;){if(!ie){Q=null;break t}if(Q=Tl(Q.nextSibling),Q===null){Q=null;break t}}ie=Q.data,Q=ie==="F!"||ie==="F"?Q:null}if(Q){ws=Tl(Q.nextSibling),B=Q.data==="F!";break e}}el(B)}B=!1}B&&(w=E[0])}}return E=mo(),E.memoizedState=E.baseState=w,B={pending:null,lanes:0,dispatch:null,lastRenderedReducer:bp,lastRenderedState:w},E.queue=B,E=Ng.bind(null,ra,B),B.dispatch=E,B=vp(!1),ie=Tg.bind(null,ra,!1,B.queue),B=mo(),Q={state:w,dispatch:null,action:x,pending:null},B.queue=Q,E=Yw.bind(null,ra,Q,ie,E),Q.dispatch=E,B.memoizedState=x,[w,E,!1]}function yp(x){var w=Zs();return Px(w,qa,x)}function Px(x,w,E){if(w=xg(x,w,bp)[0],x=pp(Yl)[0],typeof w=="object"&&w!==null&&typeof w.then=="function")try{var B=Ah(w)}catch(Ae){throw Ae===eo?cp:Ae}else B=w;w=Zs();var Q=w.queue,ie=Q.dispatch;return E!==w.memoizedState&&(ra.flags|=2048,lf(9,wp(),jg.bind(null,Q,E),null)),[B,ie,x]}function jg(x,w){x.action=w}function Yn(x){var w=Zs(),E=qa;if(E!==null)return Px(w,E,x);Zs(),w=w.memoizedState,E=Zs();var B=E.queue.dispatch;return E.memoizedState=x,[w,B,!1]}function lf(x,w,E,B){return x={tag:x,create:E,deps:B,inst:w,next:null},w=ra.updateQueue,w===null&&(w=hd(),ra.updateQueue=w),E=w.lastEffect,E===null?w.lastEffect=x.next=x:(B=E.next,E.next=x,x.next=B,w.lastEffect=x),x}function wp(){return{destroy:void 0,resource:void 0}}function cf(){return Zs().memoizedState}function kh(x,w,E,B){var Q=mo();B=B===void 0?null:B,ra.flags|=x,Q.memoizedState=lf(1|w,wp(),E,B)}function Rh(x,w,E,B){var Q=Zs();B=B===void 0?null:B;var ie=Q.memoizedState.inst;qa!==null&&B!==null&&_h(B,qa.memoizedState.deps)?Q.memoizedState=lf(w,ie,E,B):(ra.flags|=x,Q.memoizedState=lf(1|w,ie,E,B))}function Fx(x,w){kh(8390656,8,x,w)}function Fo(x,w){Rh(2048,8,x,w)}function Bx(x,w){return Rh(4,2,x,w)}function Eh(x,w){return Rh(4,4,x,w)}function Sp(x,w){if(typeof w=="function"){x=x();var E=w(x);return function(){typeof E=="function"?E():w(null)}}if(w!=null)return x=x(),w.current=x,function(){w.current=null}}function kg(x,w,E){E=E!=null?E.concat([x]):null,Rh(4,4,Sp.bind(null,w,x),E)}function _p(){}function go(x,w){var E=Zs();w=w===void 0?null:w;var B=E.memoizedState;return w!==null&&_h(w,B[1])?B[0]:(E.memoizedState=[x,w],x)}function Tc(x,w){var E=Zs();w=w===void 0?null:w;var B=E.memoizedState;if(w!==null&&_h(w,B[1]))return B[0];if(B=x(),Bi){wt(!0);try{x()}finally{wt(!1)}}return E.memoizedState=[B,w],B}function Nh(x,w,E){return E===void 0||(Rl&1073741824)!==0?x.memoizedState=w:(x.memoizedState=E,x=xb(),ra.lanes|=x,xu|=x,E)}function Rg(x,w,E,B){return Pi(E,w)?E:ud.current!==null?(x=Nh(x,E,B),Pi(x,w)||(Si=!0),x):(Rl&42)===0?(Si=!0,x.memoizedState=E):(x=xb(),ra.lanes|=x,xu|=x,w)}function Th(x,w,E,B,Q){var ie=R.p;R.p=ie!==0&&8>ie?ie:8;var Ae=_.T,Ue={};_.T=Ue,Tg(x,!1,w,E);try{var lt=Q(),Ot=_.S;if(Ot!==null&&Ot(Ue,lt),lt!==null&&typeof lt=="object"&&typeof lt.then=="function"){var hr=Xw(lt,B);pd(x,w,hr,$i(x))}else pd(x,w,B,$i(x))}catch(Sr){pd(x,w,{then:function(){},status:"rejected",reason:Sr},$i())}finally{R.p=ie,_.T=Ae}}function zx(){}function Lh(x,w,E,B){if(x.tag!==5)throw Error(n(476));var Q=Eg(x).queue;Th(x,Q,w,j,E===null?zx:function(){return Ap(x),E(B)})}function Eg(x){var w=x.memoizedState;if(w!==null)return w;w={memoizedState:j,baseState:j,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yl,lastRenderedState:j},next:null};var E={};return w.next={memoizedState:E,baseState:E,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yl,lastRenderedState:E},next:null},x.memoizedState=w,x=x.alternate,x!==null&&(x.memoizedState=w),w}function Ap(x){var w=Eg(x).next.queue;pd(x,w,{},$i())}function Mh(){return Fs(Nf)}function Lc(){return Zs().memoizedState}function $x(){return Zs().memoizedState}function fu(x){for(var w=x.return;w!==null;){switch(w.tag){case 24:case 3:var E=$i();x=cu(E);var B=Ec(w,x,E);B!==null&&(Uo(B,w,E),wh(B,w,E)),w={cache:cg()},x.payload=w;return}w=w.return}}function Ux(x,w,E){var B=$i();E={lane:B,revertLane:0,action:E,hasEagerState:!1,eagerState:null,next:null},Cp(x)?Hx(w,E):(E=Qd(x,w,E,B),E!==null&&(Uo(E,x,B),Lg(E,w,B)))}function Ng(x,w,E){var B=$i();pd(x,w,E,B)}function pd(x,w,E,B){var Q={lane:B,revertLane:0,action:E,hasEagerState:!1,eagerState:null,next:null};if(Cp(x))Hx(w,Q);else{var ie=x.alternate;if(x.lanes===0&&(ie===null||ie.lanes===0)&&(ie=w.lastRenderedReducer,ie!==null))try{var Ae=w.lastRenderedState,Ue=ie(Ae,E);if(Q.hasEagerState=!0,Q.eagerState=Ue,Pi(Ue,Ae))return Al(x,w,Q,0),us===null&&ed(),!1}catch{}finally{}if(E=Qd(x,w,Q,B),E!==null)return Uo(E,x,B),Lg(E,w,B),!0}return!1}function Tg(x,w,E,B){if(B={lane:2,revertLane:Gp(),action:B,hasEagerState:!1,eagerState:null,next:null},Cp(x)){if(w)throw Error(n(479))}else w=Qd(x,E,B,2),w!==null&&Uo(w,x,2)}function Cp(x){var w=x.alternate;return x===ra||w!==null&&w===ra}function Hx(x,w){dd=sf=!0;var E=x.pending;E===null?w.next=w:(w.next=E.next,E.next=w),x.pending=w}function Lg(x,w,E){if((E&4194048)!==0){var B=w.lanes;B&=x.pendingLanes,E|=B,w.lanes=E,Lr(x,E)}}var Dh={readContext:Fs,use:hp,useCallback:Sa,useContext:Sa,useEffect:Sa,useImperativeHandle:Sa,useLayoutEffect:Sa,useInsertionEffect:Sa,useMemo:Sa,useReducer:Sa,useRef:Sa,useState:Sa,useDebugValue:Sa,useDeferredValue:Sa,useTransition:Sa,useSyncExternalStore:Sa,useId:Sa,useHostTransitionStatus:Sa,useFormState:Sa,useActionState:Sa,useOptimistic:Sa,useMemoCache:Sa,useCacheRefresh:Sa},Vx={readContext:Fs,use:hp,useCallback:function(x,w){return mo().memoizedState=[x,w===void 0?null:w],x},useContext:Fs,useEffect:Fx,useImperativeHandle:function(x,w,E){E=E!=null?E.concat([x]):null,kh(4194308,4,Sp.bind(null,w,x),E)},useLayoutEffect:function(x,w){return kh(4194308,4,x,w)},useInsertionEffect:function(x,w){kh(4,2,x,w)},useMemo:function(x,w){var E=mo();w=w===void 0?null:w;var B=x();if(Bi){wt(!0);try{x()}finally{wt(!1)}}return E.memoizedState=[B,w],B},useReducer:function(x,w,E){var B=mo();if(E!==void 0){var Q=E(w);if(Bi){wt(!0);try{E(w)}finally{wt(!1)}}}else Q=w;return B.memoizedState=B.baseState=Q,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:x,lastRenderedState:Q},B.queue=x,x=x.dispatch=Ux.bind(null,ra,x),[B.memoizedState,x]},useRef:function(x){var w=mo();return x={current:x},w.memoizedState=x},useState:function(x){x=vp(x);var w=x.queue,E=Ng.bind(null,ra,w);return w.dispatch=E,[x.memoizedState,E]},useDebugValue:_p,useDeferredValue:function(x,w){var E=mo();return Nh(E,x,w)},useTransition:function(){var x=vp(!1);return x=Th.bind(null,ra,x.queue,!0,!1),mo().memoizedState=x,[!1,x]},useSyncExternalStore:function(x,w,E){var B=ra,Q=mo();if(xa){if(E===void 0)throw Error(n(407));E=E()}else{if(E=w(),us===null)throw Error(n(349));(Ea&124)!==0||mp(B,w,E)}Q.memoizedState=E;var ie={value:E,getSnapshot:w};return Q.queue=ie,Fx(gp.bind(null,B,ie,x),[x]),B.flags|=2048,lf(9,wp(),Dx.bind(null,B,ie,E,w),null),E},useId:function(){var x=mo(),w=us.identifierPrefix;if(xa){var E=kc,B=ys;E=(B&~(1<<32-$t(B)-1)).toString(32)+E,w=""+w+"R"+E,E=of++,0<E&&(w+="H"+E.toString(32)),w+=""}else E=Tx++,w=""+w+"r"+E.toString(32)+"";return x.memoizedState=w},useHostTransitionStatus:Mh,useFormState:Cg,useActionState:Cg,useOptimistic:function(x){var w=mo();w.memoizedState=w.baseState=x;var E={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return w.queue=E,w=Tg.bind(null,ra,!0,E),E.dispatch=w,[x,w]},useMemoCache:Ch,useCacheRefresh:function(){return mo().memoizedState=fu.bind(null,ra)}},Mg={readContext:Fs,use:hp,useCallback:go,useContext:Fs,useEffect:Fo,useImperativeHandle:kg,useInsertionEffect:Bx,useLayoutEffect:Eh,useMemo:Tc,useReducer:pp,useRef:cf,useState:function(){return pp(Yl)},useDebugValue:_p,useDeferredValue:function(x,w){var E=Zs();return Rg(E,qa.memoizedState,x,w)},useTransition:function(){var x=pp(Yl)[0],w=Zs().memoizedState;return[typeof x=="boolean"?x:Ah(x),w]},useSyncExternalStore:yg,useId:Lc,useHostTransitionStatus:Mh,useFormState:yp,useActionState:yp,useOptimistic:function(x,w){var E=Zs();return jh(E,qa,x,w)},useMemoCache:Ch,useCacheRefresh:$x},Wx={readContext:Fs,use:hp,useCallback:go,useContext:Fs,useEffect:Fo,useImperativeHandle:kg,useInsertionEffect:Bx,useLayoutEffect:Eh,useMemo:Tc,useReducer:bg,useRef:cf,useState:function(){return bg(Yl)},useDebugValue:_p,useDeferredValue:function(x,w){var E=Zs();return qa===null?Nh(E,x,w):Rg(E,qa.memoizedState,x,w)},useTransition:function(){var x=bg(Yl)[0],w=Zs().memoizedState;return[typeof x=="boolean"?x:Ah(x),w]},useSyncExternalStore:yg,useId:Lc,useHostTransitionStatus:Mh,useFormState:Yn,useActionState:Yn,useOptimistic:function(x,w){var E=Zs();return qa!==null?jh(E,qa,x,w):(E.baseState=x,[x,E.queue.dispatch])},useMemoCache:Ch,useCacheRefresh:$x},ui=null,vo=0;function jp(x){var w=vo;return vo+=1,ui===null&&(ui=[]),fg(ui,x,w)}function Ih(x,w){w=w.props.ref,x.ref=w!==void 0?w:null}function md(x,w){throw w.$$typeof===h?Error(n(525)):(x=Object.prototype.toString.call(w),Error(n(31,x==="[object Object]"?"object with keys {"+Object.keys(w).join(", ")+"}":x)))}function gd(x){var w=x._init;return w(x._payload)}function Dg(x){function w(Rt,yt){if(x){var Mt=Rt.deletions;Mt===null?(Rt.deletions=[yt],Rt.flags|=16):Mt.push(yt)}}function E(Rt,yt){if(!x)return null;for(;yt!==null;)w(Rt,yt),yt=yt.sibling;return null}function B(Rt){for(var yt=new Map;Rt!==null;)Rt.key!==null?yt.set(Rt.key,Rt):yt.set(Rt.index,Rt),Rt=Rt.sibling;return yt}function Q(Rt,yt){return Rt=Qi(Rt,yt),Rt.index=0,Rt.sibling=null,Rt}function ie(Rt,yt,Mt){return Rt.index=Mt,x?(Mt=Rt.alternate,Mt!==null?(Mt=Mt.index,Mt<yt?(Rt.flags|=67108866,yt):Mt):(Rt.flags|=67108866,yt)):(Rt.flags|=1048576,yt)}function Ae(Rt){return x&&Rt.alternate===null&&(Rt.flags|=67108866),Rt}function Ue(Rt,yt,Mt,gr){return yt===null||yt.tag!==6?(yt=ig(Mt,Rt.mode,gr),yt.return=Rt,yt):(yt=Q(yt,Mt),yt.return=Rt,yt)}function lt(Rt,yt,Mt,gr){var tn=Mt.type;return tn===v?hr(Rt,yt,Mt.props.children,gr,Mt.key):yt!==null&&(yt.elementType===tn||typeof tn=="object"&&tn!==null&&tn.$$typeof===z&&gd(tn)===yt.type)?(yt=Q(yt,Mt.props),Ih(yt,Mt),yt.return=Rt,yt):(yt=ap(Mt.type,Mt.key,Mt.props,null,Rt.mode,gr),Ih(yt,Mt),yt.return=Rt,yt)}function Ot(Rt,yt,Mt,gr){return yt===null||yt.tag!==4||yt.stateNode.containerInfo!==Mt.containerInfo||yt.stateNode.implementation!==Mt.implementation?(yt=ef(Mt,Rt.mode,gr),yt.return=Rt,yt):(yt=Q(yt,Mt.children||[]),yt.return=Rt,yt)}function hr(Rt,yt,Mt,gr,tn){return yt===null||yt.tag!==7?(yt=ad(Mt,Rt.mode,gr,tn),yt.return=Rt,yt):(yt=Q(yt,Mt),yt.return=Rt,yt)}function Sr(Rt,yt,Mt){if(typeof yt=="string"&&yt!==""||typeof yt=="number"||typeof yt=="bigint")return yt=ig(""+yt,Rt.mode,Mt),yt.return=Rt,yt;if(typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case f:return Mt=ap(yt.type,yt.key,yt.props,null,Rt.mode,Mt),Ih(Mt,yt),Mt.return=Rt,Mt;case p:return yt=ef(yt,Rt.mode,Mt),yt.return=Rt,yt;case z:var gr=yt._init;return yt=gr(yt._payload),Sr(Rt,yt,Mt)}if(k(yt)||P(yt))return yt=ad(yt,Rt.mode,Mt,null),yt.return=Rt,yt;if(typeof yt.then=="function")return Sr(Rt,jp(yt),Mt);if(yt.$$typeof===S)return Sr(Rt,op(Rt,yt),Mt);md(Rt,yt)}return null}function Gt(Rt,yt,Mt,gr){var tn=yt!==null?yt.key:null;if(typeof Mt=="string"&&Mt!==""||typeof Mt=="number"||typeof Mt=="bigint")return tn!==null?null:Ue(Rt,yt,""+Mt,gr);if(typeof Mt=="object"&&Mt!==null){switch(Mt.$$typeof){case f:return Mt.key===tn?lt(Rt,yt,Mt,gr):null;case p:return Mt.key===tn?Ot(Rt,yt,Mt,gr):null;case z:return tn=Mt._init,Mt=tn(Mt._payload),Gt(Rt,yt,Mt,gr)}if(k(Mt)||P(Mt))return tn!==null?null:hr(Rt,yt,Mt,gr,null);if(typeof Mt.then=="function")return Gt(Rt,yt,jp(Mt),gr);if(Mt.$$typeof===S)return Gt(Rt,yt,op(Rt,Mt),gr);md(Rt,Mt)}return null}function Ft(Rt,yt,Mt,gr,tn){if(typeof gr=="string"&&gr!==""||typeof gr=="number"||typeof gr=="bigint")return Rt=Rt.get(Mt)||null,Ue(yt,Rt,""+gr,tn);if(typeof gr=="object"&&gr!==null){switch(gr.$$typeof){case f:return Rt=Rt.get(gr.key===null?Mt:gr.key)||null,lt(yt,Rt,gr,tn);case p:return Rt=Rt.get(gr.key===null?Mt:gr.key)||null,Ot(yt,Rt,gr,tn);case z:var ua=gr._init;return gr=ua(gr._payload),Ft(Rt,yt,Mt,gr,tn)}if(k(gr)||P(gr))return Rt=Rt.get(Mt)||null,hr(yt,Rt,gr,tn,null);if(typeof gr.then=="function")return Ft(Rt,yt,Mt,jp(gr),tn);if(gr.$$typeof===S)return Ft(Rt,yt,Mt,op(yt,gr),tn);md(yt,gr)}return null}function Nn(Rt,yt,Mt,gr){for(var tn=null,ua=null,bn=yt,Tn=yt=0,Ci=null;bn!==null&&Tn<Mt.length;Tn++){bn.index>Tn?(Ci=bn,bn=null):Ci=bn.sibling;var La=Gt(Rt,bn,Mt[Tn],gr);if(La===null){bn===null&&(bn=Ci);break}x&&bn&&La.alternate===null&&w(Rt,bn),yt=ie(La,yt,Tn),ua===null?tn=La:ua.sibling=La,ua=La,bn=Ci}if(Tn===Mt.length)return E(Rt,bn),xa&&sd(Rt,Tn),tn;if(bn===null){for(;Tn<Mt.length;Tn++)bn=Sr(Rt,Mt[Tn],gr),bn!==null&&(yt=ie(bn,yt,Tn),ua===null?tn=bn:ua.sibling=bn,ua=bn);return xa&&sd(Rt,Tn),tn}for(bn=B(bn);Tn<Mt.length;Tn++)Ci=Ft(bn,Rt,Tn,Mt[Tn],gr),Ci!==null&&(x&&Ci.alternate!==null&&bn.delete(Ci.key===null?Tn:Ci.key),yt=ie(Ci,yt,Tn),ua===null?tn=Ci:ua.sibling=Ci,ua=Ci);return x&&bn.forEach(function(Ru){return w(Rt,Ru)}),xa&&sd(Rt,Tn),tn}function Rn(Rt,yt,Mt,gr){if(Mt==null)throw Error(n(151));for(var tn=null,ua=null,bn=yt,Tn=yt=0,Ci=null,La=Mt.next();bn!==null&&!La.done;Tn++,La=Mt.next()){bn.index>Tn?(Ci=bn,bn=null):Ci=bn.sibling;var Ru=Gt(Rt,bn,La.value,gr);if(Ru===null){bn===null&&(bn=Ci);break}x&&bn&&Ru.alternate===null&&w(Rt,bn),yt=ie(Ru,yt,Tn),ua===null?tn=Ru:ua.sibling=Ru,ua=Ru,bn=Ci}if(La.done)return E(Rt,bn),xa&&sd(Rt,Tn),tn;if(bn===null){for(;!La.done;Tn++,La=Mt.next())La=Sr(Rt,La.value,gr),La!==null&&(yt=ie(La,yt,Tn),ua===null?tn=La:ua.sibling=La,ua=La);return xa&&sd(Rt,Tn),tn}for(bn=B(bn);!La.done;Tn++,La=Mt.next())La=Ft(bn,Rt,Tn,La.value,gr),La!==null&&(x&&La.alternate!==null&&bn.delete(La.key===null?Tn:La.key),yt=ie(La,yt,Tn),ua===null?tn=La:ua.sibling=La,ua=La);return x&&bn.forEach(function(L4){return w(Rt,L4)}),xa&&sd(Rt,Tn),tn}function Qa(Rt,yt,Mt,gr){if(typeof Mt=="object"&&Mt!==null&&Mt.type===v&&Mt.key===null&&(Mt=Mt.props.children),typeof Mt=="object"&&Mt!==null){switch(Mt.$$typeof){case f:e:{for(var tn=Mt.key;yt!==null;){if(yt.key===tn){if(tn=Mt.type,tn===v){if(yt.tag===7){E(Rt,yt.sibling),gr=Q(yt,Mt.props.children),gr.return=Rt,Rt=gr;break e}}else if(yt.elementType===tn||typeof tn=="object"&&tn!==null&&tn.$$typeof===z&&gd(tn)===yt.type){E(Rt,yt.sibling),gr=Q(yt,Mt.props),Ih(gr,Mt),gr.return=Rt,Rt=gr;break e}E(Rt,yt);break}else w(Rt,yt);yt=yt.sibling}Mt.type===v?(gr=ad(Mt.props.children,Rt.mode,gr,Mt.key),gr.return=Rt,Rt=gr):(gr=ap(Mt.type,Mt.key,Mt.props,null,Rt.mode,gr),Ih(gr,Mt),gr.return=Rt,Rt=gr)}return Ae(Rt);case p:e:{for(tn=Mt.key;yt!==null;){if(yt.key===tn)if(yt.tag===4&&yt.stateNode.containerInfo===Mt.containerInfo&&yt.stateNode.implementation===Mt.implementation){E(Rt,yt.sibling),gr=Q(yt,Mt.children||[]),gr.return=Rt,Rt=gr;break e}else{E(Rt,yt);break}else w(Rt,yt);yt=yt.sibling}gr=ef(Mt,Rt.mode,gr),gr.return=Rt,Rt=gr}return Ae(Rt);case z:return tn=Mt._init,Mt=tn(Mt._payload),Qa(Rt,yt,Mt,gr)}if(k(Mt))return Nn(Rt,yt,Mt,gr);if(P(Mt)){if(tn=P(Mt),typeof tn!="function")throw Error(n(150));return Mt=tn.call(Mt),Rn(Rt,yt,Mt,gr)}if(typeof Mt.then=="function")return Qa(Rt,yt,jp(Mt),gr);if(Mt.$$typeof===S)return Qa(Rt,yt,op(Rt,Mt),gr);md(Rt,Mt)}return typeof Mt=="string"&&Mt!==""||typeof Mt=="number"||typeof Mt=="bigint"?(Mt=""+Mt,yt!==null&&yt.tag===6?(E(Rt,yt.sibling),gr=Q(yt,Mt),gr.return=Rt,Rt=gr):(E(Rt,yt),gr=ig(Mt,Rt.mode,gr),gr.return=Rt,Rt=gr),Ae(Rt)):E(Rt,yt)}return function(Rt,yt,Mt,gr){try{vo=0;var tn=Qa(Rt,yt,Mt,gr);return ui=null,tn}catch(bn){if(bn===eo||bn===cp)throw bn;var ua=uo(29,bn,null,Rt.mode);return ua.lanes=gr,ua.return=Rt,ua}finally{}}}var vd=Dg(!0),qx=Dg(!1),Bo=V(null),to=null;function nl(x){var w=x.alternate;Z(Bs,Bs.current&1),Z(Bo,x),to===null&&(w===null||ud.current!==null||w.memoizedState!==null)&&(to=x)}function Gx(x){if(x.tag===22){if(Z(Bs,Bs.current),Z(Bo,x),to===null){var w=x.alternate;w!==null&&w.memoizedState!==null&&(to=x)}}else Mc()}function Mc(){Z(Bs,Bs.current),Z(Bo,Bo.current)}function Zl(x){M(Bo),to===x&&(to=null),M(Bs)}var Bs=V(0);function Oh(x){for(var w=x;w!==null;){if(w.tag===13){var E=w.memoizedState;if(E!==null&&(E=E.dehydrated,E===null||E.data==="$?"||no(E)))return w}else if(w.tag===19&&w.memoizedProps.revealOrder!==void 0){if((w.flags&128)!==0)return w}else if(w.child!==null){w.child.return=w,w=w.child;continue}if(w===x)break;for(;w.sibling===null;){if(w.return===null||w.return===x)return null;w=w.return}w.sibling.return=w.return,w=w.sibling}return null}function uf(x,w,E,B){w=x.memoizedState,E=E(B,w),E=E==null?w:d({},w,E),x.memoizedState=E,x.lanes===0&&(x.updateQueue.baseState=E)}var Ph={enqueueSetState:function(x,w,E){x=x._reactInternals;var B=$i(),Q=cu(B);Q.payload=w,E!=null&&(Q.callback=E),w=Ec(x,Q,B),w!==null&&(Uo(w,x,B),wh(w,x,B))},enqueueReplaceState:function(x,w,E){x=x._reactInternals;var B=$i(),Q=cu(B);Q.tag=1,Q.payload=w,E!=null&&(Q.callback=E),w=Ec(x,Q,B),w!==null&&(Uo(w,x,B),wh(w,x,B))},enqueueForceUpdate:function(x,w){x=x._reactInternals;var E=$i(),B=cu(E);B.tag=2,w!=null&&(B.callback=w),w=Ec(x,B,E),w!==null&&(Uo(w,x,E),wh(w,x,E))}};function Fh(x,w,E,B,Q,ie,Ae){return x=x.stateNode,typeof x.shouldComponentUpdate=="function"?x.shouldComponentUpdate(B,ie,Ae):w.prototype&&w.prototype.isPureReactComponent?!Io(E,B)||!Io(Q,ie):!0}function Kx(x,w,E,B){x=w.state,typeof w.componentWillReceiveProps=="function"&&w.componentWillReceiveProps(E,B),typeof w.UNSAFE_componentWillReceiveProps=="function"&&w.UNSAFE_componentWillReceiveProps(E,B),w.state!==x&&Ph.enqueueReplaceState(w,w.state,null)}function hu(x,w){var E=w;if("ref"in w){E={};for(var B in w)B!=="ref"&&(E[B]=w[B])}if(x=x.defaultProps){E===w&&(E=d({},E));for(var Q in x)E[Q]===void 0&&(E[Q]=x[Q])}return E}var xd=typeof reportError=="function"?reportError:function(x){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var w=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof x=="object"&&x!==null&&typeof x.message=="string"?String(x.message):String(x),error:x});if(!window.dispatchEvent(w))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",x);return}console.error(x)};function Ig(x){xd(x)}function kp(x){console.error(x)}function Xx(x){xd(x)}function Bh(x,w){try{var E=x.onUncaughtError;E(w.value,{componentStack:w.stack})}catch(B){setTimeout(function(){throw B})}}function Jl(x,w,E){try{var B=x.onCaughtError;B(E.value,{componentStack:E.stack,errorBoundary:w.tag===1?w.stateNode:null})}catch(Q){setTimeout(function(){throw Q})}}function Rp(x,w,E){return E=cu(E),E.tag=3,E.payload={element:null},E.callback=function(){Bh(x,w)},E}function Og(x){return x=cu(x),x.tag=3,x}function Yx(x,w,E,B){var Q=E.type.getDerivedStateFromError;if(typeof Q=="function"){var ie=B.value;x.payload=function(){return Q(ie)},x.callback=function(){Jl(w,E,B)}}var Ae=E.stateNode;Ae!==null&&typeof Ae.componentDidCatch=="function"&&(x.callback=function(){Jl(w,E,B),typeof Q!="function"&&(bu===null?bu=new Set([this]):bu.add(this));var Ue=B.stack;this.componentDidCatch(B.value,{componentStack:Ue!==null?Ue:""})})}function Zx(x,w,E,B,Q){if(E.flags|=32768,B!==null&&typeof B=="object"&&typeof B.then=="function"){if(w=E.alternate,w!==null&&xh(w,E,Q,!0),E=Bo.current,E!==null){switch(E.tag){case 13:return to===null?t1():E.alternate===null&&zs===0&&(zs=3),E.flags&=-257,E.flags|=65536,E.lanes=Q,B===dg?E.flags|=16384:(w=E.updateQueue,w===null?E.updateQueue=new Set([B]):w.add(B),a1(x,B,Q)),!1;case 22:return E.flags|=65536,B===dg?E.flags|=16384:(w=E.updateQueue,w===null?(w={transitions:null,markerInstances:null,retryQueue:new Set([B])},E.updateQueue=w):(E=w.retryQueue,E===null?w.retryQueue=new Set([B]):E.add(B)),a1(x,B,Q)),!1}throw Error(n(435,E.tag))}return a1(x,B,Q),t1(),!1}if(xa)return w=Bo.current,w!==null?((w.flags&65536)===0&&(w.flags|=256),w.flags|=65536,w.lanes=Q,B!==tf&&(x=Error(n(422),{cause:B}),ou(Ji(x,E)))):(B!==tf&&(w=Error(n(423),{cause:B}),ou(Ji(w,E))),x=x.current.alternate,x.flags|=65536,Q&=-Q,x.lanes|=Q,B=Ji(B,E),Q=Rp(x.stateNode,B,Q),jl(x,Q),zs!==4&&(zs=2)),!1;var ie=Error(n(520),{cause:B});if(ie=Ji(ie,E),Xh===null?Xh=[ie]:Xh.push(ie),zs!==4&&(zs=2),w===null)return!0;B=Ji(B,E),E=w;do{switch(E.tag){case 3:return E.flags|=65536,x=Q&-Q,E.lanes|=x,x=Rp(E.stateNode,B,x),jl(E,x),!1;case 1:if(w=E.type,ie=E.stateNode,(E.flags&128)===0&&(typeof w.getDerivedStateFromError=="function"||ie!==null&&typeof ie.componentDidCatch=="function"&&(bu===null||!bu.has(ie))))return E.flags|=65536,Q&=-Q,E.lanes|=Q,Q=Og(Q),Yx(Q,x,E,B),jl(E,Q),!1}E=E.return}while(E!==null);return!1}var Jx=Error(n(461)),Si=!1;function ms(x,w,E,B){w.child=x===null?qx(w,null,E,B):vd(w,x.child,E,B)}function Ep(x,w,E,B,Q){E=E.render;var ie=w.ref;if("ref"in B){var Ae={};for(var Ue in B)Ue!=="ref"&&(Ae[Ue]=B[Ue])}else Ae=B;return od(w),B=mg(x,w,E,Ae,ie,Q),Ue=vg(),x!==null&&!Si?(fd(x,w,Q),Dc(x,w,Q)):(xa&&Ue&&lg(w),w.flags|=1,ms(x,w,B,Q),w.child)}function Np(x,w,E,B,Q){if(x===null){var ie=E.type;return typeof ie=="function"&&!nd(ie)&&ie.defaultProps===void 0&&E.compare===null?(w.tag=15,w.type=ie,Tp(x,w,ie,B,Q)):(x=ap(E.type,null,B,w,w.mode,Q),x.ref=w.ref,x.return=w,w.child=x)}if(ie=x.child,!El(x,Q)){var Ae=ie.memoizedProps;if(E=E.compare,E=E!==null?E:Io,E(Ae,B)&&x.ref===w.ref)return Dc(x,w,Q)}return w.flags|=1,x=Qi(ie,B),x.ref=w.ref,x.return=w,w.child=x}function Tp(x,w,E,B,Q){if(x!==null){var ie=x.memoizedProps;if(Io(ie,B)&&x.ref===w.ref)if(Si=!1,w.pendingProps=B=ie,El(x,Q))(x.flags&131072)!==0&&(Si=!0);else return w.lanes=x.lanes,Dc(x,w,Q)}return df(x,w,E,B,Q)}function zh(x,w,E){var B=w.pendingProps,Q=B.children,ie=x!==null?x.memoizedState:null;if(B.mode==="hidden"){if((w.flags&128)!==0){if(B=ie!==null?ie.baseLanes|E:E,x!==null){for(Q=w.child=x.child,ie=0;Q!==null;)ie=ie|Q.lanes|Q.childLanes,Q=Q.sibling;w.childLanes=ie&~B}else w.childLanes=0,w.child=null;return bd(x,w,B,E)}if((E&536870912)!==0)w.memoizedState={baseLanes:0,cachePool:null},x!==null&&lp(w,ie!==null?ie.cachePool:null),ie!==null?Nc(w,ie):dp(),Gx(w);else return w.lanes=w.childLanes=536870912,bd(x,w,ie!==null?ie.baseLanes|E:E,E)}else ie!==null?(lp(w,ie.cachePool),Nc(w,ie),Mc(),w.memoizedState=null):(x!==null&&lp(w,null),dp(),Mc());return ms(x,w,Q,E),w.child}function bd(x,w,E,B){var Q=Rc();return Q=Q===null?null:{parent:ts._currentValue,pool:Q},w.memoizedState={baseLanes:E,cachePool:Q},x!==null&&lp(w,null),dp(),Gx(w),x!==null&&xh(x,w,B,!0),null}function Sn(x,w){var E=w.ref;if(E===null)x!==null&&x.ref!==null&&(w.flags|=4194816);else{if(typeof E!="function"&&typeof E!="object")throw Error(n(284));(x===null||x.ref!==E)&&(w.flags|=4194816)}}function df(x,w,E,B,Q){return od(w),E=mg(x,w,E,B,void 0,Q),B=vg(),x!==null&&!Si?(fd(x,w,Q),Dc(x,w,Q)):(xa&&B&&lg(w),w.flags|=1,ms(x,w,E,Q),w.child)}function Lp(x,w,E,B,Q,ie){return od(w),w.updateQueue=null,E=Mx(w,B,E,Q),Lx(x),B=vg(),x!==null&&!Si?(fd(x,w,ie),Dc(x,w,ie)):(xa&&B&&lg(w),w.flags|=1,ms(x,w,E,ie),w.child)}function pu(x,w,E,B,Q){if(od(w),w.stateNode===null){var ie=rd,Ae=E.contextType;typeof Ae=="object"&&Ae!==null&&(ie=Fs(Ae)),ie=new E(B,ie),w.memoizedState=ie.state!==null&&ie.state!==void 0?ie.state:null,ie.updater=Ph,w.stateNode=ie,ie._reactInternals=w,ie=w.stateNode,ie.props=B,ie.state=w.memoizedState,ie.refs={},cd(w),Ae=E.contextType,ie.context=typeof Ae=="object"&&Ae!==null?Fs(Ae):rd,ie.state=w.memoizedState,Ae=E.getDerivedStateFromProps,typeof Ae=="function"&&(uf(w,E,Ae,B),ie.state=w.memoizedState),typeof E.getDerivedStateFromProps=="function"||typeof ie.getSnapshotBeforeUpdate=="function"||typeof ie.UNSAFE_componentWillMount!="function"&&typeof ie.componentWillMount!="function"||(Ae=ie.state,typeof ie.componentWillMount=="function"&&ie.componentWillMount(),typeof ie.UNSAFE_componentWillMount=="function"&&ie.UNSAFE_componentWillMount(),Ae!==ie.state&&Ph.enqueueReplaceState(ie,ie.state,null),Fi(w,B,ie,Q),kl(),ie.state=w.memoizedState),typeof ie.componentDidMount=="function"&&(w.flags|=4194308),B=!0}else if(x===null){ie=w.stateNode;var Ue=w.memoizedProps,lt=hu(E,Ue);ie.props=lt;var Ot=ie.context,hr=E.contextType;Ae=rd,typeof hr=="object"&&hr!==null&&(Ae=Fs(hr));var Sr=E.getDerivedStateFromProps;hr=typeof Sr=="function"||typeof ie.getSnapshotBeforeUpdate=="function",Ue=w.pendingProps!==Ue,hr||typeof ie.UNSAFE_componentWillReceiveProps!="function"&&typeof ie.componentWillReceiveProps!="function"||(Ue||Ot!==Ae)&&Kx(w,ie,B,Ae),Xl=!1;var Gt=w.memoizedState;ie.state=Gt,Fi(w,B,ie,Q),kl(),Ot=w.memoizedState,Ue||Gt!==Ot||Xl?(typeof Sr=="function"&&(uf(w,E,Sr,B),Ot=w.memoizedState),(lt=Xl||Fh(w,E,lt,B,Gt,Ot,Ae))?(hr||typeof ie.UNSAFE_componentWillMount!="function"&&typeof ie.componentWillMount!="function"||(typeof ie.componentWillMount=="function"&&ie.componentWillMount(),typeof ie.UNSAFE_componentWillMount=="function"&&ie.UNSAFE_componentWillMount()),typeof ie.componentDidMount=="function"&&(w.flags|=4194308)):(typeof ie.componentDidMount=="function"&&(w.flags|=4194308),w.memoizedProps=B,w.memoizedState=Ot),ie.props=B,ie.state=Ot,ie.context=Ae,B=lt):(typeof ie.componentDidMount=="function"&&(w.flags|=4194308),B=!1)}else{ie=w.stateNode,af(x,w),Ae=w.memoizedProps,hr=hu(E,Ae),ie.props=hr,Sr=w.pendingProps,Gt=ie.context,Ot=E.contextType,lt=rd,typeof Ot=="object"&&Ot!==null&&(lt=Fs(Ot)),Ue=E.getDerivedStateFromProps,(Ot=typeof Ue=="function"||typeof ie.getSnapshotBeforeUpdate=="function")||typeof ie.UNSAFE_componentWillReceiveProps!="function"&&typeof ie.componentWillReceiveProps!="function"||(Ae!==Sr||Gt!==lt)&&Kx(w,ie,B,lt),Xl=!1,Gt=w.memoizedState,ie.state=Gt,Fi(w,B,ie,Q),kl();var Ft=w.memoizedState;Ae!==Sr||Gt!==Ft||Xl||x!==null&&x.dependencies!==null&&ip(x.dependencies)?(typeof Ue=="function"&&(uf(w,E,Ue,B),Ft=w.memoizedState),(hr=Xl||Fh(w,E,hr,B,Gt,Ft,lt)||x!==null&&x.dependencies!==null&&ip(x.dependencies))?(Ot||typeof ie.UNSAFE_componentWillUpdate!="function"&&typeof ie.componentWillUpdate!="function"||(typeof ie.componentWillUpdate=="function"&&ie.componentWillUpdate(B,Ft,lt),typeof ie.UNSAFE_componentWillUpdate=="function"&&ie.UNSAFE_componentWillUpdate(B,Ft,lt)),typeof ie.componentDidUpdate=="function"&&(w.flags|=4),typeof ie.getSnapshotBeforeUpdate=="function"&&(w.flags|=1024)):(typeof ie.componentDidUpdate!="function"||Ae===x.memoizedProps&&Gt===x.memoizedState||(w.flags|=4),typeof ie.getSnapshotBeforeUpdate!="function"||Ae===x.memoizedProps&&Gt===x.memoizedState||(w.flags|=1024),w.memoizedProps=B,w.memoizedState=Ft),ie.props=B,ie.state=Ft,ie.context=lt,B=hr):(typeof ie.componentDidUpdate!="function"||Ae===x.memoizedProps&&Gt===x.memoizedState||(w.flags|=4),typeof ie.getSnapshotBeforeUpdate!="function"||Ae===x.memoizedProps&&Gt===x.memoizedState||(w.flags|=1024),B=!1)}return ie=B,Sn(x,w),B=(w.flags&128)!==0,ie||B?(ie=w.stateNode,E=B&&typeof E.getDerivedStateFromError!="function"?null:ie.render(),w.flags|=1,x!==null&&B?(w.child=vd(w,x.child,null,Q),w.child=vd(w,null,E,Q)):ms(x,w,E,Q),w.memoizedState=ie.state,x=w.child):x=Dc(x,w,Q),x}function Qx(x,w,E,B){return vh(),w.flags|=256,ms(x,w,E,B),w.child}var $h={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Mp(x){return{baseLanes:x,cachePool:Cx()}}function _i(x,w,E){return x=x!==null?x.childLanes&~E:0,w&&(x|=sl),x}function eb(x,w,E){var B=w.pendingProps,Q=!1,ie=(w.flags&128)!==0,Ae;if((Ae=ie)||(Ae=x!==null&&x.memoizedState===null?!1:(Bs.current&2)!==0),Ae&&(Q=!0,w.flags&=-129),Ae=(w.flags&32)!==0,w.flags&=-33,x===null){if(xa){if(Q?nl(w):Mc(),xa){var Ue=ws,lt;if(lt=Ue){e:{for(lt=Ue,Ue=fo;lt.nodeType!==8;){if(!Ue){Ue=null;break e}if(lt=Tl(lt.nextSibling),lt===null){Ue=null;break e}}Ue=lt}Ue!==null?(w.memoizedState={dehydrated:Ue,treeContext:ps!==null?{id:ys,overflow:kc}:null,retryLane:536870912,hydrationErrors:null},lt=uo(18,null,null,0),lt.stateNode=Ue,lt.return=w,w.child=lt,ci=w,ws=null,lt=!0):lt=!1}lt||el(w)}if(Ue=w.memoizedState,Ue!==null&&(Ue=Ue.dehydrated,Ue!==null))return no(Ue)?w.lanes=32:w.lanes=536870912,null;Zl(w)}return Ue=B.children,B=B.fallback,Q?(Mc(),Q=w.mode,Ue=Uh({mode:"hidden",children:Ue},Q),B=ad(B,Q,E,null),Ue.return=w,B.return=w,Ue.sibling=B,w.child=Ue,Q=w.child,Q.memoizedState=Mp(E),Q.childLanes=_i(x,Ae,E),w.memoizedState=$h,B):(nl(w),Pg(w,Ue))}if(lt=x.memoizedState,lt!==null&&(Ue=lt.dehydrated,Ue!==null)){if(ie)w.flags&256?(nl(w),w.flags&=-257,w=Fg(x,w,E)):w.memoizedState!==null?(Mc(),w.child=x.child,w.flags|=128,w=null):(Mc(),Q=B.fallback,Ue=w.mode,B=Uh({mode:"visible",children:B.children},Ue),Q=ad(Q,Ue,E,null),Q.flags|=2,B.return=w,Q.return=w,B.sibling=Q,w.child=B,vd(w,x.child,null,E),B=w.child,B.memoizedState=Mp(E),B.childLanes=_i(x,Ae,E),w.memoizedState=$h,w=Q);else if(nl(w),no(Ue)){if(Ae=Ue.nextSibling&&Ue.nextSibling.dataset,Ae)var Ot=Ae.dgst;Ae=Ot,B=Error(n(419)),B.stack="",B.digest=Ae,ou({value:B,source:null,stack:null}),w=Fg(x,w,E)}else if(Si||xh(x,w,E,!1),Ae=(E&x.childLanes)!==0,Si||Ae){if(Ae=us,Ae!==null&&(B=E&-E,B=(B&42)!==0?1:vt(B),B=(B&(Ae.suspendedLanes|E))!==0?0:B,B!==0&&B!==lt.retryLane))throw lt.retryLane=B,td(x,B),Uo(Ae,x,B),Jx;Ue.data==="$?"||t1(),w=Fg(x,w,E)}else Ue.data==="$?"?(w.flags|=192,w.child=x.child,w=null):(x=lt.treeContext,ws=Tl(Ue.nextSibling),ci=w,xa=!0,Cl=null,fo=!1,x!==null&&(Jo[Qo++]=ys,Jo[Qo++]=kc,Jo[Qo++]=ps,ys=x.id,kc=x.overflow,ps=w),w=Pg(w,B.children),w.flags|=4096);return w}return Q?(Mc(),Q=B.fallback,Ue=w.mode,lt=x.child,Ot=lt.sibling,B=Qi(lt,{mode:"hidden",children:B.children}),B.subtreeFlags=lt.subtreeFlags&65011712,Ot!==null?Q=Qi(Ot,Q):(Q=ad(Q,Ue,E,null),Q.flags|=2),Q.return=w,B.return=w,B.sibling=Q,w.child=B,B=Q,Q=w.child,Ue=x.child.memoizedState,Ue===null?Ue=Mp(E):(lt=Ue.cachePool,lt!==null?(Ot=ts._currentValue,lt=lt.parent!==Ot?{parent:Ot,pool:Ot}:lt):lt=Cx(),Ue={baseLanes:Ue.baseLanes|E,cachePool:lt}),Q.memoizedState=Ue,Q.childLanes=_i(x,Ae,E),w.memoizedState=$h,B):(nl(w),E=x.child,x=E.sibling,E=Qi(E,{mode:"visible",children:B.children}),E.return=w,E.sibling=null,x!==null&&(Ae=w.deletions,Ae===null?(w.deletions=[x],w.flags|=16):Ae.push(x)),w.child=E,w.memoizedState=null,E)}function Pg(x,w){return w=Uh({mode:"visible",children:w},x.mode),w.return=x,x.child=w}function Uh(x,w){return x=uo(22,x,null,w),x.lanes=0,x.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},x}function Fg(x,w,E){return vd(w,x.child,null,E),x=Pg(w,w.pendingProps.children),x.flags|=2,w.memoizedState=null,x}function Bg(x,w,E){x.lanes|=w;var B=x.alternate;B!==null&&(B.lanes|=w),ho(x.return,w,E)}function zg(x,w,E,B,Q){var ie=x.memoizedState;ie===null?x.memoizedState={isBackwards:w,rendering:null,renderingStartTime:0,last:B,tail:E,tailMode:Q}:(ie.isBackwards=w,ie.rendering=null,ie.renderingStartTime=0,ie.last=B,ie.tail=E,ie.tailMode=Q)}function tb(x,w,E){var B=w.pendingProps,Q=B.revealOrder,ie=B.tail;if(ms(x,w,B.children,E),B=Bs.current,(B&2)!==0)B=B&1|2,w.flags|=128;else{if(x!==null&&(x.flags&128)!==0)e:for(x=w.child;x!==null;){if(x.tag===13)x.memoizedState!==null&&Bg(x,E,w);else if(x.tag===19)Bg(x,E,w);else if(x.child!==null){x.child.return=x,x=x.child;continue}if(x===w)break e;for(;x.sibling===null;){if(x.return===null||x.return===w)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}B&=1}switch(Z(Bs,B),Q){case"forwards":for(E=w.child,Q=null;E!==null;)x=E.alternate,x!==null&&Oh(x)===null&&(Q=E),E=E.sibling;E=Q,E===null?(Q=w.child,w.child=null):(Q=E.sibling,E.sibling=null),zg(w,!1,Q,E,ie);break;case"backwards":for(E=null,Q=w.child,w.child=null;Q!==null;){if(x=Q.alternate,x!==null&&Oh(x)===null){w.child=Q;break}x=Q.sibling,Q.sibling=E,E=Q,Q=x}zg(w,!0,E,null,ie);break;case"together":zg(w,!1,null,null,void 0);break;default:w.memoizedState=null}return w.child}function Dc(x,w,E){if(x!==null&&(w.dependencies=x.dependencies),xu|=w.lanes,(E&w.childLanes)===0)if(x!==null){if(xh(x,w,E,!1),(E&w.childLanes)===0)return null}else return null;if(x!==null&&w.child!==x.child)throw Error(n(153));if(w.child!==null){for(x=w.child,E=Qi(x,x.pendingProps),w.child=E,E.return=w;x.sibling!==null;)x=x.sibling,E=E.sibling=Qi(x,x.pendingProps),E.return=w;E.sibling=null}return w.child}function El(x,w){return(x.lanes&w)!==0?!0:(x=x.dependencies,!!(x!==null&&ip(x)))}function ro(x,w,E){switch(w.tag){case 3:Y(w,w.stateNode.containerInfo),Po(w,ts,x.memoizedState.cache),vh();break;case 27:case 5:ee(w);break;case 4:Y(w,w.stateNode.containerInfo);break;case 10:Po(w,w.type,w.memoizedProps.value);break;case 13:var B=w.memoizedState;if(B!==null)return B.dehydrated!==null?(nl(w),w.flags|=128,null):(E&w.child.childLanes)!==0?eb(x,w,E):(nl(w),x=Dc(x,w,E),x!==null?x.sibling:null);nl(w);break;case 19:var Q=(x.flags&128)!==0;if(B=(E&w.childLanes)!==0,B||(xh(x,w,E,!1),B=(E&w.childLanes)!==0),Q){if(B)return tb(x,w,E);w.flags|=128}if(Q=w.memoizedState,Q!==null&&(Q.rendering=null,Q.tail=null,Q.lastEffect=null),Z(Bs,Bs.current),B)break;return null;case 22:case 23:return w.lanes=0,zh(x,w,E);case 24:Po(w,ts,x.memoizedState.cache)}return Dc(x,w,E)}function Dp(x,w,E){if(x!==null)if(x.memoizedProps!==w.pendingProps)Si=!0;else{if(!El(x,E)&&(w.flags&128)===0)return Si=!1,ro(x,w,E);Si=(x.flags&131072)!==0}else Si=!1,xa&&(w.flags&1048576)!==0&&og(w,ph,w.index);switch(w.lanes=0,w.tag){case 16:e:{x=w.pendingProps;var B=w.elementType,Q=B._init;if(B=Q(B._payload),w.type=B,typeof B=="function")nd(B)?(x=hu(B,x),w.tag=1,w=pu(null,w,B,x,E)):(w.tag=0,w=df(null,w,B,x,E));else{if(B!=null){if(Q=B.$$typeof,Q===C){w.tag=11,w=Ep(null,w,B,x,E);break e}else if(Q===H){w.tag=14,w=Np(null,w,B,x,E);break e}}throw w=U(B)||B,Error(n(306,w,""))}}return w;case 0:return df(x,w,w.type,w.pendingProps,E);case 1:return B=w.type,Q=hu(B,w.pendingProps),pu(x,w,B,Q,E);case 3:e:{if(Y(w,w.stateNode.containerInfo),x===null)throw Error(n(387));B=w.pendingProps;var ie=w.memoizedState;Q=ie.element,af(x,w),Fi(w,B,null,E);var Ae=w.memoizedState;if(B=Ae.cache,Po(w,ts,B),B!==ie.cache&&ca(w,[ts],E,!0),kl(),B=Ae.element,ie.isDehydrated)if(ie={element:B,isDehydrated:!1,cache:Ae.cache},w.updateQueue.baseState=ie,w.memoizedState=ie,w.flags&256){w=Qx(x,w,B,E);break e}else if(B!==Q){Q=Ji(Error(n(424)),w),ou(Q),w=Qx(x,w,B,E);break e}else{switch(x=w.stateNode.containerInfo,x.nodeType){case 9:x=x.body;break;default:x=x.nodeName==="HTML"?x.ownerDocument.body:x}for(ws=Tl(x.firstChild),ci=w,xa=!0,Cl=null,fo=!0,E=qx(w,null,B,E),w.child=E;E;)E.flags=E.flags&-3|4096,E=E.sibling}else{if(vh(),B===Q){w=Dc(x,w,E);break e}ms(x,w,B,E)}w=w.child}return w;case 26:return Sn(x,w),x===null?(E=Zb(w.type,null,w.pendingProps,null))?w.memoizedState=E:xa||(E=w.type,x=w.pendingProps,B=Sd(X.current).createElement(E),B[ct]=w,B[nt]=x,hi(B,E,x),Re(B),w.stateNode=B):w.memoizedState=Zb(w.type,x.memoizedProps,w.pendingProps,x.memoizedState),null;case 27:return ee(w),x===null&&xa&&(B=w.stateNode=Kb(w.type,w.pendingProps,X.current),ci=w,fo=!0,Q=ws,il(w.type)?(h1=Q,ws=Tl(B.firstChild)):ws=Q),ms(x,w,w.pendingProps.children,E),Sn(x,w),x===null&&(w.flags|=4194304),w.child;case 5:return x===null&&xa&&((Q=B=ws)&&(B=qb(B,w.type,w.pendingProps,fo),B!==null?(w.stateNode=B,ci=w,ws=Tl(B.firstChild),fo=!1,Q=!0):Q=!1),Q||el(w)),ee(w),Q=w.type,ie=w.pendingProps,Ae=x!==null?x.memoizedProps:null,B=ie.children,Zp(Q,ie)?B=null:Ae!==null&&Zp(Q,Ae)&&(w.flags|=32),w.memoizedState!==null&&(Q=mg(x,w,gg,null,null,E),Nf._currentValue=Q),Sn(x,w),ms(x,w,B,E),w.child;case 6:return x===null&&xa&&((x=E=ws)&&(E=Qp(E,w.pendingProps,fo),E!==null?(w.stateNode=E,ci=w,ws=null,x=!0):x=!1),x||el(w)),null;case 13:return eb(x,w,E);case 4:return Y(w,w.stateNode.containerInfo),B=w.pendingProps,x===null?w.child=vd(w,null,B,E):ms(x,w,B,E),w.child;case 11:return Ep(x,w,w.type,w.pendingProps,E);case 7:return ms(x,w,w.pendingProps,E),w.child;case 8:return ms(x,w,w.pendingProps.children,E),w.child;case 12:return ms(x,w,w.pendingProps.children,E),w.child;case 10:return B=w.pendingProps,Po(w,w.type,B.value),ms(x,w,B.children,E),w.child;case 9:return Q=w.type._context,B=w.pendingProps.children,od(w),Q=Fs(Q),B=B(Q),w.flags|=1,ms(x,w,B,E),w.child;case 14:return Np(x,w,w.type,w.pendingProps,E);case 15:return Tp(x,w,w.type,w.pendingProps,E);case 19:return tb(x,w,E);case 31:return B=w.pendingProps,E=w.mode,B={mode:B.mode,children:B.children},x===null?(E=Uh(B,E),E.ref=w.ref,w.child=E,E.return=w,w=E):(E=Qi(x.child,B),E.ref=w.ref,w.child=E,E.return=w,w=E),w;case 22:return zh(x,w,E);case 24:return od(w),B=Fs(ts),x===null?(Q=Rc(),Q===null&&(Q=us,ie=cg(),Q.pooledCache=ie,ie.refCount++,ie!==null&&(Q.pooledCacheLanes|=E),Q=ie),w.memoizedState={parent:B,cache:Q},cd(w),Po(w,ts,Q)):((x.lanes&E)!==0&&(af(x,w),Fi(w,null,null,E),kl()),Q=x.memoizedState,ie=w.memoizedState,Q.parent!==B?(Q={parent:B,cache:B},w.memoizedState=Q,w.lanes===0&&(w.memoizedState=w.updateQueue.baseState=Q),Po(w,ts,B)):(B=ie.cache,Po(w,ts,B),B!==Q.cache&&ca(w,[ts],E,!0))),ms(x,w,w.pendingProps.children,E),w.child;case 29:throw w.pendingProps}throw Error(n(156,w.tag))}function Ic(x){x.flags|=4}function Ip(x,w){if(w.type!=="stylesheet"||(w.state.loading&4)!==0)x.flags&=-16777217;else if(x.flags|=16777216,!pi(w)){if(w=Bo.current,w!==null&&((Ea&4194048)===Ea?to!==null:(Ea&62914560)!==Ea&&(Ea&536870912)===0||w!==to))throw nf=dg,jx;x.flags|=8192}}function Op(x,w){w!==null&&(x.flags|=4),x.flags&16384&&(w=x.tag!==22?kt():536870912,x.lanes|=w,xf|=w)}function Hh(x,w){if(!xa)switch(x.tailMode){case"hidden":w=x.tail;for(var E=null;w!==null;)w.alternate!==null&&(E=w),w=w.sibling;E===null?x.tail=null:E.sibling=null;break;case"collapsed":E=x.tail;for(var B=null;E!==null;)E.alternate!==null&&(B=E),E=E.sibling;B===null?w||x.tail===null?x.tail=null:x.tail.sibling=null:B.sibling=null}}function rs(x){var w=x.alternate!==null&&x.alternate.child===x.child,E=0,B=0;if(w)for(var Q=x.child;Q!==null;)E|=Q.lanes|Q.childLanes,B|=Q.subtreeFlags&65011712,B|=Q.flags&65011712,Q.return=x,Q=Q.sibling;else for(Q=x.child;Q!==null;)E|=Q.lanes|Q.childLanes,B|=Q.subtreeFlags,B|=Q.flags,Q.return=x,Q=Q.sibling;return x.subtreeFlags|=B,x.childLanes=E,w}function rb(x,w,E){var B=w.pendingProps;switch(mh(w),w.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return rs(w),null;case 1:return rs(w),null;case 3:return E=w.stateNode,B=null,x!==null&&(B=x.memoizedState.cache),w.memoizedState.cache!==B&&(w.flags|=2048),tl(ts),K(),E.pendingContext&&(E.context=E.pendingContext,E.pendingContext=null),(x===null||x.child===null)&&(gh(w)?Ic(w):x===null||x.memoizedState.isDehydrated&&(w.flags&256)===0||(w.flags|=1024,wx())),rs(w),null;case 26:return E=w.memoizedState,x===null?(Ic(w),E!==null?(rs(w),Ip(w,E)):(rs(w),w.flags&=-16777217)):E?E!==x.memoizedState?(Ic(w),rs(w),Ip(w,E)):(rs(w),w.flags&=-16777217):(x.memoizedProps!==B&&Ic(w),rs(w),w.flags&=-16777217),null;case 27:ue(w),E=X.current;var Q=w.type;if(x!==null&&w.stateNode!=null)x.memoizedProps!==B&&Ic(w);else{if(!B){if(w.stateNode===null)throw Error(n(166));return rs(w),null}x=J.current,gh(w)?bx(w):(x=Kb(Q,B,E),w.stateNode=x,Ic(w))}return rs(w),null;case 5:if(ue(w),E=w.type,x!==null&&w.stateNode!=null)x.memoizedProps!==B&&Ic(w);else{if(!B){if(w.stateNode===null)throw Error(n(166));return rs(w),null}if(x=J.current,gh(w))bx(w);else{switch(Q=Sd(X.current),x){case 1:x=Q.createElementNS("http://www.w3.org/2000/svg",E);break;case 2:x=Q.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;default:switch(E){case"svg":x=Q.createElementNS("http://www.w3.org/2000/svg",E);break;case"math":x=Q.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;case"script":x=Q.createElement("div"),x.innerHTML="<script><\/script>",x=x.removeChild(x.firstChild);break;case"select":x=typeof B.is=="string"?Q.createElement("select",{is:B.is}):Q.createElement("select"),B.multiple?x.multiple=!0:B.size&&(x.size=B.size);break;default:x=typeof B.is=="string"?Q.createElement(E,{is:B.is}):Q.createElement(E)}}x[ct]=w,x[nt]=B;e:for(Q=w.child;Q!==null;){if(Q.tag===5||Q.tag===6)x.appendChild(Q.stateNode);else if(Q.tag!==4&&Q.tag!==27&&Q.child!==null){Q.child.return=Q,Q=Q.child;continue}if(Q===w)break e;for(;Q.sibling===null;){if(Q.return===null||Q.return===w)break e;Q=Q.return}Q.sibling.return=Q.return,Q=Q.sibling}w.stateNode=x;e:switch(hi(x,E,B),E){case"button":case"input":case"select":case"textarea":x=!!B.autoFocus;break e;case"img":x=!0;break e;default:x=!1}x&&Ic(w)}}return rs(w),w.flags&=-16777217,null;case 6:if(x&&w.stateNode!=null)x.memoizedProps!==B&&Ic(w);else{if(typeof B!="string"&&w.stateNode===null)throw Error(n(166));if(x=X.current,gh(w)){if(x=w.stateNode,E=w.memoizedProps,B=null,Q=ci,Q!==null)switch(Q.tag){case 27:case 5:B=Q.memoizedProps}x[ct]=w,x=!!(x.nodeValue===E||B!==null&&B.suppressHydrationWarning===!0||Ub(x.nodeValue,E)),x||el(w)}else x=Sd(x).createTextNode(B),x[ct]=w,w.stateNode=x}return rs(w),null;case 13:if(B=w.memoizedState,x===null||x.memoizedState!==null&&x.memoizedState.dehydrated!==null){if(Q=gh(w),B!==null&&B.dehydrated!==null){if(x===null){if(!Q)throw Error(n(318));if(Q=w.memoizedState,Q=Q!==null?Q.dehydrated:null,!Q)throw Error(n(317));Q[ct]=w}else vh(),(w.flags&128)===0&&(w.memoizedState=null),w.flags|=4;rs(w),Q=!1}else Q=wx(),x!==null&&x.memoizedState!==null&&(x.memoizedState.hydrationErrors=Q),Q=!0;if(!Q)return w.flags&256?(Zl(w),w):(Zl(w),null)}if(Zl(w),(w.flags&128)!==0)return w.lanes=E,w;if(E=B!==null,x=x!==null&&x.memoizedState!==null,E){B=w.child,Q=null,B.alternate!==null&&B.alternate.memoizedState!==null&&B.alternate.memoizedState.cachePool!==null&&(Q=B.alternate.memoizedState.cachePool.pool);var ie=null;B.memoizedState!==null&&B.memoizedState.cachePool!==null&&(ie=B.memoizedState.cachePool.pool),ie!==Q&&(B.flags|=2048)}return E!==x&&E&&(w.child.flags|=8192),Op(w,w.updateQueue),rs(w),null;case 4:return K(),x===null&&c1(w.stateNode.containerInfo),rs(w),null;case 10:return tl(w.type),rs(w),null;case 19:if(M(Bs),Q=w.memoizedState,Q===null)return rs(w),null;if(B=(w.flags&128)!==0,ie=Q.rendering,ie===null)if(B)Hh(Q,!1);else{if(zs!==0||x!==null&&(x.flags&128)!==0)for(x=w.child;x!==null;){if(ie=Oh(x),ie!==null){for(w.flags|=128,Hh(Q,!1),x=ie.updateQueue,w.updateQueue=x,Op(w,x),w.subtreeFlags=0,x=E,E=w.child;E!==null;)hh(E,x),E=E.sibling;return Z(Bs,Bs.current&1|2),w.child}x=x.sibling}Q.tail!==null&&le()>bf&&(w.flags|=128,B=!0,Hh(Q,!1),w.lanes=4194304)}else{if(!B)if(x=Oh(ie),x!==null){if(w.flags|=128,B=!0,x=x.updateQueue,w.updateQueue=x,Op(w,x),Hh(Q,!0),Q.tail===null&&Q.tailMode==="hidden"&&!ie.alternate&&!xa)return rs(w),null}else 2*le()-Q.renderingStartTime>bf&&E!==536870912&&(w.flags|=128,B=!0,Hh(Q,!1),w.lanes=4194304);Q.isBackwards?(ie.sibling=w.child,w.child=ie):(x=Q.last,x!==null?x.sibling=ie:w.child=ie,Q.last=ie)}return Q.tail!==null?(w=Q.tail,Q.rendering=w,Q.tail=w.sibling,Q.renderingStartTime=le(),w.sibling=null,x=Bs.current,Z(Bs,B?x&1|2:x&1),w):(rs(w),null);case 22:case 23:return Zl(w),pg(),B=w.memoizedState!==null,x!==null?x.memoizedState!==null!==B&&(w.flags|=8192):B&&(w.flags|=8192),B?(E&536870912)!==0&&(w.flags&128)===0&&(rs(w),w.subtreeFlags&6&&(w.flags|=8192)):rs(w),E=w.updateQueue,E!==null&&Op(w,E.retryQueue),E=null,x!==null&&x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(E=x.memoizedState.cachePool.pool),B=null,w.memoizedState!==null&&w.memoizedState.cachePool!==null&&(B=w.memoizedState.cachePool.pool),B!==E&&(w.flags|=2048),x!==null&&M(ld),null;case 24:return E=null,x!==null&&(E=x.memoizedState.cache),w.memoizedState.cache!==E&&(w.flags|=2048),tl(ts),rs(w),null;case 25:return null;case 30:return null}throw Error(n(156,w.tag))}function nb(x,w){switch(mh(w),w.tag){case 1:return x=w.flags,x&65536?(w.flags=x&-65537|128,w):null;case 3:return tl(ts),K(),x=w.flags,(x&65536)!==0&&(x&128)===0?(w.flags=x&-65537|128,w):null;case 26:case 27:case 5:return ue(w),null;case 13:if(Zl(w),x=w.memoizedState,x!==null&&x.dehydrated!==null){if(w.alternate===null)throw Error(n(340));vh()}return x=w.flags,x&65536?(w.flags=x&-65537|128,w):null;case 19:return M(Bs),null;case 4:return K(),null;case 10:return tl(w.type),null;case 22:case 23:return Zl(w),pg(),x!==null&&M(ld),x=w.flags,x&65536?(w.flags=x&-65537|128,w):null;case 24:return tl(ts),null;case 25:return null;default:return null}}function ab(x,w){switch(mh(w),w.tag){case 3:tl(ts),K();break;case 26:case 27:case 5:ue(w);break;case 4:K();break;case 13:Zl(w);break;case 19:M(Bs);break;case 10:tl(w.type);break;case 22:case 23:Zl(w),pg(),x!==null&&M(ld);break;case 24:tl(ts)}}function Vh(x,w){try{var E=w.updateQueue,B=E!==null?E.lastEffect:null;if(B!==null){var Q=B.next;E=Q;do{if((E.tag&x)===x){B=void 0;var ie=E.create,Ae=E.inst;B=ie(),Ae.destroy=B}E=E.next}while(E!==Q)}}catch(Ue){ns(w,w.return,Ue)}}function mu(x,w,E){try{var B=w.updateQueue,Q=B!==null?B.lastEffect:null;if(Q!==null){var ie=Q.next;B=ie;do{if((B.tag&x)===x){var Ae=B.inst,Ue=Ae.destroy;if(Ue!==void 0){Ae.destroy=void 0,Q=w;var lt=E,Ot=Ue;try{Ot()}catch(hr){ns(Q,lt,hr)}}}B=B.next}while(B!==ie)}}catch(hr){ns(w,w.return,hr)}}function sb(x){var w=x.updateQueue;if(w!==null){var E=x.stateNode;try{hg(w,E)}catch(B){ns(x,x.return,B)}}}function $g(x,w,E){E.props=hu(x.type,x.memoizedProps),E.state=x.memoizedState;try{E.componentWillUnmount()}catch(B){ns(x,w,B)}}function ff(x,w){try{var E=x.ref;if(E!==null){switch(x.tag){case 26:case 27:case 5:var B=x.stateNode;break;case 30:B=x.stateNode;break;default:B=x.stateNode}typeof E=="function"?x.refCleanup=E(B):E.current=B}}catch(Q){ns(x,w,Q)}}function Ql(x,w){var E=x.ref,B=x.refCleanup;if(E!==null)if(typeof B=="function")try{B()}catch(Q){ns(x,w,Q)}finally{x.refCleanup=null,x=x.alternate,x!=null&&(x.refCleanup=null)}else if(typeof E=="function")try{E(null)}catch(Q){ns(x,w,Q)}else E.current=null}function Pp(x){var w=x.type,E=x.memoizedProps,B=x.stateNode;try{e:switch(w){case"button":case"input":case"select":case"textarea":E.autoFocus&&B.focus();break e;case"img":E.src?B.src=E.src:E.srcSet&&(B.srcset=E.srcSet)}}catch(Q){ns(x,x.return,Q)}}function Fp(x,w,E){try{var B=x.stateNode;d4(B,x.type,E,w),B[nt]=w}catch(Q){ns(x,x.return,Q)}}function hf(x){return x.tag===5||x.tag===3||x.tag===26||x.tag===27&&il(x.type)||x.tag===4}function Wh(x){e:for(;;){for(;x.sibling===null;){if(x.return===null||hf(x.return))return null;x=x.return}for(x.sibling.return=x.return,x=x.sibling;x.tag!==5&&x.tag!==6&&x.tag!==18;){if(x.tag===27&&il(x.type)||x.flags&2||x.child===null||x.tag===4)continue e;x.child.return=x,x=x.child}if(!(x.flags&2))return x.stateNode}}function Bp(x,w,E){var B=x.tag;if(B===5||B===6)x=x.stateNode,w?(E.nodeType===9?E.body:E.nodeName==="HTML"?E.ownerDocument.body:E).insertBefore(x,w):(w=E.nodeType===9?E.body:E.nodeName==="HTML"?E.ownerDocument.body:E,w.appendChild(x),E=E._reactRootContainer,E!=null||w.onclick!==null||(w.onclick=Xp));else if(B!==4&&(B===27&&il(x.type)&&(E=x.stateNode,w=null),x=x.child,x!==null))for(Bp(x,w,E),x=x.sibling;x!==null;)Bp(x,w,E),x=x.sibling}function qh(x,w,E){var B=x.tag;if(B===5||B===6)x=x.stateNode,w?E.insertBefore(x,w):E.appendChild(x);else if(B!==4&&(B===27&&il(x.type)&&(E=x.stateNode),x=x.child,x!==null))for(qh(x,w,E),x=x.sibling;x!==null;)qh(x,w,E),x=x.sibling}function Gh(x){var w=x.stateNode,E=x.memoizedProps;try{for(var B=x.type,Q=w.attributes;Q.length;)w.removeAttributeNode(Q[0]);hi(w,B,E),w[ct]=x,w[nt]=E}catch(ie){ns(x,x.return,ie)}}var ec=!1,Ua=!1,Oc=!1,ib=typeof WeakSet=="function"?WeakSet:Set,di=null;function Zw(x,w){if(x=x.containerInfo,Nl=nm,x=lh(x),Yd(x)){if("selectionStart"in x)var E={start:x.selectionStart,end:x.selectionEnd};else e:{E=(E=x.ownerDocument)&&E.defaultView||window;var B=E.getSelection&&E.getSelection();if(B&&B.rangeCount!==0){E=B.anchorNode;var Q=B.anchorOffset,ie=B.focusNode;B=B.focusOffset;try{E.nodeType,ie.nodeType}catch{E=null;break e}var Ae=0,Ue=-1,lt=-1,Ot=0,hr=0,Sr=x,Gt=null;t:for(;;){for(var Ft;Sr!==E||Q!==0&&Sr.nodeType!==3||(Ue=Ae+Q),Sr!==ie||B!==0&&Sr.nodeType!==3||(lt=Ae+B),Sr.nodeType===3&&(Ae+=Sr.nodeValue.length),(Ft=Sr.firstChild)!==null;)Gt=Sr,Sr=Ft;for(;;){if(Sr===x)break t;if(Gt===E&&++Ot===Q&&(Ue=Ae),Gt===ie&&++hr===B&&(lt=Ae),(Ft=Sr.nextSibling)!==null)break;Sr=Gt,Gt=Sr.parentNode}Sr=Ft}E=Ue===-1||lt===-1?null:{start:Ue,end:lt}}else E=null}E=E||{start:0,end:0}}else E=null;for(Yp={focusedElem:x,selectionRange:E},nm=!1,di=w;di!==null;)if(w=di,x=w.child,(w.subtreeFlags&1024)!==0&&x!==null)x.return=w,di=x;else for(;di!==null;){switch(w=di,ie=w.alternate,x=w.flags,w.tag){case 0:break;case 11:case 15:break;case 1:if((x&1024)!==0&&ie!==null){x=void 0,E=w,Q=ie.memoizedProps,ie=ie.memoizedState,B=E.stateNode;try{var Nn=hu(E.type,Q,E.elementType===E.type);x=B.getSnapshotBeforeUpdate(Nn,ie),B.__reactInternalSnapshotBeforeUpdate=x}catch(Rn){ns(E,E.return,Rn)}}break;case 3:if((x&1024)!==0){if(x=w.stateNode.containerInfo,E=x.nodeType,E===9)f1(x);else if(E===1)switch(x.nodeName){case"HEAD":case"HTML":case"BODY":f1(x);break;default:x.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((x&1024)!==0)throw Error(n(163))}if(x=w.sibling,x!==null){x.return=w.return,di=x;break}di=w.return}}function ob(x,w,E){var B=E.flags;switch(E.tag){case 0:case 11:case 15:gu(x,E),B&4&&Vh(5,E);break;case 1:if(gu(x,E),B&4)if(x=E.stateNode,w===null)try{x.componentDidMount()}catch(Ae){ns(E,E.return,Ae)}else{var Q=hu(E.type,w.memoizedProps);w=w.memoizedState;try{x.componentDidUpdate(Q,w,x.__reactInternalSnapshotBeforeUpdate)}catch(Ae){ns(E,E.return,Ae)}}B&64&&sb(E),B&512&&ff(E,E.return);break;case 3:if(gu(x,E),B&64&&(x=E.updateQueue,x!==null)){if(w=null,E.child!==null)switch(E.child.tag){case 27:case 5:w=E.child.stateNode;break;case 1:w=E.child.stateNode}try{hg(x,w)}catch(Ae){ns(E,E.return,Ae)}}break;case 27:w===null&&B&4&&Gh(E);case 26:case 5:gu(x,E),w===null&&B&4&&Pp(E),B&512&&ff(E,E.return);break;case 12:gu(x,E);break;case 13:gu(x,E),B&4&&ub(x,E),B&64&&(x=E.memoizedState,x!==null&&(x=x.dehydrated,x!==null&&(E=Vp.bind(null,E),Cf(x,E))));break;case 22:if(B=E.memoizedState!==null||ec,!B){w=w!==null&&w.memoizedState!==null||Ua,Q=ec;var ie=Ua;ec=B,(Ua=w)&&!ie?Fc(x,E,(E.subtreeFlags&8772)!==0):gu(x,E),ec=Q,Ua=ie}break;case 30:break;default:gu(x,E)}}function lb(x){var w=x.alternate;w!==null&&(x.alternate=null,lb(w)),x.child=null,x.deletions=null,x.sibling=null,x.tag===5&&(w=x.stateNode,w!==null&&de(w)),x.stateNode=null,x.return=null,x.dependencies=null,x.memoizedProps=null,x.memoizedState=null,x.pendingProps=null,x.stateNode=null,x.updateQueue=null}var Ss=null,xo=!1;function Pc(x,w,E){for(E=E.child;E!==null;)cb(x,w,E),E=E.sibling}function cb(x,w,E){if(dt&&typeof dt.onCommitFiberUnmount=="function")try{dt.onCommitFiberUnmount(at,E)}catch{}switch(E.tag){case 26:Ua||Ql(E,w),Pc(x,w,E),E.memoizedState?E.memoizedState.count--:E.stateNode&&(E=E.stateNode,E.parentNode.removeChild(E));break;case 27:Ua||Ql(E,w);var B=Ss,Q=xo;il(E.type)&&(Ss=E.stateNode,xo=!1),Pc(x,w,E),a0(E.stateNode),Ss=B,xo=Q;break;case 5:Ua||Ql(E,w);case 6:if(B=Ss,Q=xo,Ss=null,Pc(x,w,E),Ss=B,xo=Q,Ss!==null)if(xo)try{(Ss.nodeType===9?Ss.body:Ss.nodeName==="HTML"?Ss.ownerDocument.body:Ss).removeChild(E.stateNode)}catch(ie){ns(E,w,ie)}else try{Ss.removeChild(E.stateNode)}catch(ie){ns(E,w,ie)}break;case 18:Ss!==null&&(xo?(x=Ss,Jp(x.nodeType===9?x.body:x.nodeName==="HTML"?x.ownerDocument.body:x,E.stateNode),f0(x)):Jp(Ss,E.stateNode));break;case 4:B=Ss,Q=xo,Ss=E.stateNode.containerInfo,xo=!0,Pc(x,w,E),Ss=B,xo=Q;break;case 0:case 11:case 14:case 15:Ua||mu(2,E,w),Ua||mu(4,E,w),Pc(x,w,E);break;case 1:Ua||(Ql(E,w),B=E.stateNode,typeof B.componentWillUnmount=="function"&&$g(E,w,B)),Pc(x,w,E);break;case 21:Pc(x,w,E);break;case 22:Ua=(B=Ua)||E.memoizedState!==null,Pc(x,w,E),Ua=B;break;default:Pc(x,w,E)}}function ub(x,w){if(w.memoizedState===null&&(x=w.alternate,x!==null&&(x=x.memoizedState,x!==null&&(x=x.dehydrated,x!==null))))try{f0(x)}catch(E){ns(w,w.return,E)}}function Jw(x){switch(x.tag){case 13:case 19:var w=x.stateNode;return w===null&&(w=x.stateNode=new ib),w;case 22:return x=x.stateNode,w=x._retryCache,w===null&&(w=x._retryCache=new ib),w;default:throw Error(n(435,x.tag))}}function Ug(x,w){var E=Jw(x);w.forEach(function(B){var Q=a4.bind(null,x,B);E.has(B)||(E.add(B),B.then(Q,Q))})}function zo(x,w){var E=w.deletions;if(E!==null)for(var B=0;B<E.length;B++){var Q=E[B],ie=x,Ae=w,Ue=Ae;e:for(;Ue!==null;){switch(Ue.tag){case 27:if(il(Ue.type)){Ss=Ue.stateNode,xo=!1;break e}break;case 5:Ss=Ue.stateNode,xo=!1;break e;case 3:case 4:Ss=Ue.stateNode.containerInfo,xo=!0;break e}Ue=Ue.return}if(Ss===null)throw Error(n(160));cb(ie,Ae,Q),Ss=null,xo=!1,ie=Q.alternate,ie!==null&&(ie.return=null),Q.return=null}if(w.subtreeFlags&13878)for(w=w.child;w!==null;)Hg(w,x),w=w.sibling}var al=null;function Hg(x,w){var E=x.alternate,B=x.flags;switch(x.tag){case 0:case 11:case 14:case 15:zo(w,x),bo(x),B&4&&(mu(3,x,x.return),Vh(3,x),mu(5,x,x.return));break;case 1:zo(w,x),bo(x),B&512&&(Ua||E===null||Ql(E,E.return)),B&64&&ec&&(x=x.updateQueue,x!==null&&(B=x.callbacks,B!==null&&(E=x.shared.hiddenCallbacks,x.shared.hiddenCallbacks=E===null?B:E.concat(B))));break;case 26:var Q=al;if(zo(w,x),bo(x),B&512&&(Ua||E===null||Ql(E,E.return)),B&4){var ie=E!==null?E.memoizedState:null;if(B=x.memoizedState,E===null)if(B===null)if(x.stateNode===null){e:{B=x.type,E=x.memoizedProps,Q=Q.ownerDocument||Q;t:switch(B){case"title":ie=Q.getElementsByTagName("title")[0],(!ie||ie[Ce]||ie[ct]||ie.namespaceURI==="http://www.w3.org/2000/svg"||ie.hasAttribute("itemprop"))&&(ie=Q.createElement(B),Q.head.insertBefore(ie,Q.querySelector("head > title"))),hi(ie,B,E),ie[ct]=x,Re(ie),B=ie;break e;case"link":var Ae=ey("link","href",Q).get(B+(E.href||""));if(Ae){for(var Ue=0;Ue<Ae.length;Ue++)if(ie=Ae[Ue],ie.getAttribute("href")===(E.href==null||E.href===""?null:E.href)&&ie.getAttribute("rel")===(E.rel==null?null:E.rel)&&ie.getAttribute("title")===(E.title==null?null:E.title)&&ie.getAttribute("crossorigin")===(E.crossOrigin==null?null:E.crossOrigin)){Ae.splice(Ue,1);break t}}ie=Q.createElement(B),hi(ie,B,E),Q.head.appendChild(ie);break;case"meta":if(Ae=ey("meta","content",Q).get(B+(E.content||""))){for(Ue=0;Ue<Ae.length;Ue++)if(ie=Ae[Ue],ie.getAttribute("content")===(E.content==null?null:""+E.content)&&ie.getAttribute("name")===(E.name==null?null:E.name)&&ie.getAttribute("property")===(E.property==null?null:E.property)&&ie.getAttribute("http-equiv")===(E.httpEquiv==null?null:E.httpEquiv)&&ie.getAttribute("charset")===(E.charSet==null?null:E.charSet)){Ae.splice(Ue,1);break t}}ie=Q.createElement(B),hi(ie,B,E),Q.head.appendChild(ie);break;default:throw Error(n(468,B))}ie[ct]=x,Re(ie),B=ie}x.stateNode=B}else ty(Q,x.type,x.stateNode);else x.stateNode=Qb(Q,B,x.memoizedProps);else ie!==B?(ie===null?E.stateNode!==null&&(E=E.stateNode,E.parentNode.removeChild(E)):ie.count--,B===null?ty(Q,x.type,x.stateNode):Qb(Q,B,x.memoizedProps)):B===null&&x.stateNode!==null&&Fp(x,x.memoizedProps,E.memoizedProps)}break;case 27:zo(w,x),bo(x),B&512&&(Ua||E===null||Ql(E,E.return)),E!==null&&B&4&&Fp(x,x.memoizedProps,E.memoizedProps);break;case 5:if(zo(w,x),bo(x),B&512&&(Ua||E===null||Ql(E,E.return)),x.flags&32){Q=x.stateNode;try{Le(Q,"")}catch(Ft){ns(x,x.return,Ft)}}B&4&&x.stateNode!=null&&(Q=x.memoizedProps,Fp(x,Q,E!==null?E.memoizedProps:Q)),B&1024&&(Oc=!0);break;case 6:if(zo(w,x),bo(x),B&4){if(x.stateNode===null)throw Error(n(162));B=x.memoizedProps,E=x.stateNode;try{E.nodeValue=B}catch(Ft){ns(x,x.return,Ft)}}break;case 3:if(Ef=null,Q=al,al=Un(w.containerInfo),zo(w,x),al=Q,bo(x),B&4&&E!==null&&E.memoizedState.isDehydrated)try{f0(w.containerInfo)}catch(Ft){ns(x,x.return,Ft)}Oc&&(Oc=!1,db(x));break;case 4:B=al,al=Un(x.stateNode.containerInfo),zo(w,x),bo(x),al=B;break;case 12:zo(w,x),bo(x);break;case 13:zo(w,x),bo(x),x.child.flags&8192&&x.memoizedState!==null!=(E!==null&&E.memoizedState!==null)&&(Yg=le()),B&4&&(B=x.updateQueue,B!==null&&(x.updateQueue=null,Ug(x,B)));break;case 22:Q=x.memoizedState!==null;var lt=E!==null&&E.memoizedState!==null,Ot=ec,hr=Ua;if(ec=Ot||Q,Ua=hr||lt,zo(w,x),Ua=hr,ec=Ot,bo(x),B&8192)e:for(w=x.stateNode,w._visibility=Q?w._visibility&-2:w._visibility|1,Q&&(E===null||lt||ec||Ua||yd(x)),E=null,w=x;;){if(w.tag===5||w.tag===26){if(E===null){lt=E=w;try{if(ie=lt.stateNode,Q)Ae=ie.style,typeof Ae.setProperty=="function"?Ae.setProperty("display","none","important"):Ae.display="none";else{Ue=lt.stateNode;var Sr=lt.memoizedProps.style,Gt=Sr!=null&&Sr.hasOwnProperty("display")?Sr.display:null;Ue.style.display=Gt==null||typeof Gt=="boolean"?"":(""+Gt).trim()}}catch(Ft){ns(lt,lt.return,Ft)}}}else if(w.tag===6){if(E===null){lt=w;try{lt.stateNode.nodeValue=Q?"":lt.memoizedProps}catch(Ft){ns(lt,lt.return,Ft)}}}else if((w.tag!==22&&w.tag!==23||w.memoizedState===null||w===x)&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===x)break e;for(;w.sibling===null;){if(w.return===null||w.return===x)break e;E===w&&(E=null),w=w.return}E===w&&(E=null),w.sibling.return=w.return,w=w.sibling}B&4&&(B=x.updateQueue,B!==null&&(E=B.retryQueue,E!==null&&(B.retryQueue=null,Ug(x,E))));break;case 19:zo(w,x),bo(x),B&4&&(B=x.updateQueue,B!==null&&(x.updateQueue=null,Ug(x,B)));break;case 30:break;case 21:break;default:zo(w,x),bo(x)}}function bo(x){var w=x.flags;if(w&2){try{for(var E,B=x.return;B!==null;){if(hf(B)){E=B;break}B=B.return}if(E==null)throw Error(n(160));switch(E.tag){case 27:var Q=E.stateNode,ie=Wh(x);qh(x,ie,Q);break;case 5:var Ae=E.stateNode;E.flags&32&&(Le(Ae,""),E.flags&=-33);var Ue=Wh(x);qh(x,Ue,Ae);break;case 3:case 4:var lt=E.stateNode.containerInfo,Ot=Wh(x);Bp(x,Ot,lt);break;default:throw Error(n(161))}}catch(hr){ns(x,x.return,hr)}x.flags&=-3}w&4096&&(x.flags&=-4097)}function db(x){if(x.subtreeFlags&1024)for(x=x.child;x!==null;){var w=x;db(w),w.tag===5&&w.flags&1024&&w.stateNode.reset(),x=x.sibling}}function gu(x,w){if(w.subtreeFlags&8772)for(w=w.child;w!==null;)ob(x,w.alternate,w),w=w.sibling}function yd(x){for(x=x.child;x!==null;){var w=x;switch(w.tag){case 0:case 11:case 14:case 15:mu(4,w,w.return),yd(w);break;case 1:Ql(w,w.return);var E=w.stateNode;typeof E.componentWillUnmount=="function"&&$g(w,w.return,E),yd(w);break;case 27:a0(w.stateNode);case 26:case 5:Ql(w,w.return),yd(w);break;case 22:w.memoizedState===null&&yd(w);break;case 30:yd(w);break;default:yd(w)}x=x.sibling}}function Fc(x,w,E){for(E=E&&(w.subtreeFlags&8772)!==0,w=w.child;w!==null;){var B=w.alternate,Q=x,ie=w,Ae=ie.flags;switch(ie.tag){case 0:case 11:case 15:Fc(Q,ie,E),Vh(4,ie);break;case 1:if(Fc(Q,ie,E),B=ie,Q=B.stateNode,typeof Q.componentDidMount=="function")try{Q.componentDidMount()}catch(Ot){ns(B,B.return,Ot)}if(B=ie,Q=B.updateQueue,Q!==null){var Ue=B.stateNode;try{var lt=Q.shared.hiddenCallbacks;if(lt!==null)for(Q.shared.hiddenCallbacks=null,Q=0;Q<lt.length;Q++)Nx(lt[Q],Ue)}catch(Ot){ns(B,B.return,Ot)}}E&&Ae&64&&sb(ie),ff(ie,ie.return);break;case 27:Gh(ie);case 26:case 5:Fc(Q,ie,E),E&&B===null&&Ae&4&&Pp(ie),ff(ie,ie.return);break;case 12:Fc(Q,ie,E);break;case 13:Fc(Q,ie,E),E&&Ae&4&&ub(Q,ie);break;case 22:ie.memoizedState===null&&Fc(Q,ie,E),ff(ie,ie.return);break;case 30:break;default:Fc(Q,ie,E)}w=w.sibling}}function Vg(x,w){var E=null;x!==null&&x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(E=x.memoizedState.cachePool.pool),x=null,w.memoizedState!==null&&w.memoizedState.cachePool!==null&&(x=w.memoizedState.cachePool.pool),x!==E&&(x!=null&&x.refCount++,E!=null&&bh(E))}function Wg(x,w){x=null,w.alternate!==null&&(x=w.alternate.memoizedState.cache),w=w.memoizedState.cache,w!==x&&(w.refCount++,x!=null&&bh(x))}function tc(x,w,E,B){if(w.subtreeFlags&10256)for(w=w.child;w!==null;)fb(x,w,E,B),w=w.sibling}function fb(x,w,E,B){var Q=w.flags;switch(w.tag){case 0:case 11:case 15:tc(x,w,E,B),Q&2048&&Vh(9,w);break;case 1:tc(x,w,E,B);break;case 3:tc(x,w,E,B),Q&2048&&(x=null,w.alternate!==null&&(x=w.alternate.memoizedState.cache),w=w.memoizedState.cache,w!==x&&(w.refCount++,x!=null&&bh(x)));break;case 12:if(Q&2048){tc(x,w,E,B),x=w.stateNode;try{var ie=w.memoizedProps,Ae=ie.id,Ue=ie.onPostCommit;typeof Ue=="function"&&Ue(Ae,w.alternate===null?"mount":"update",x.passiveEffectDuration,-0)}catch(lt){ns(w,w.return,lt)}}else tc(x,w,E,B);break;case 13:tc(x,w,E,B);break;case 23:break;case 22:ie=w.stateNode,Ae=w.alternate,w.memoizedState!==null?ie._visibility&2?tc(x,w,E,B):Kh(x,w):ie._visibility&2?tc(x,w,E,B):(ie._visibility|=2,pf(x,w,E,B,(w.subtreeFlags&10256)!==0)),Q&2048&&Vg(Ae,w);break;case 24:tc(x,w,E,B),Q&2048&&Wg(w.alternate,w);break;default:tc(x,w,E,B)}}function pf(x,w,E,B,Q){for(Q=Q&&(w.subtreeFlags&10256)!==0,w=w.child;w!==null;){var ie=x,Ae=w,Ue=E,lt=B,Ot=Ae.flags;switch(Ae.tag){case 0:case 11:case 15:pf(ie,Ae,Ue,lt,Q),Vh(8,Ae);break;case 23:break;case 22:var hr=Ae.stateNode;Ae.memoizedState!==null?hr._visibility&2?pf(ie,Ae,Ue,lt,Q):Kh(ie,Ae):(hr._visibility|=2,pf(ie,Ae,Ue,lt,Q)),Q&&Ot&2048&&Vg(Ae.alternate,Ae);break;case 24:pf(ie,Ae,Ue,lt,Q),Q&&Ot&2048&&Wg(Ae.alternate,Ae);break;default:pf(ie,Ae,Ue,lt,Q)}w=w.sibling}}function Kh(x,w){if(w.subtreeFlags&10256)for(w=w.child;w!==null;){var E=x,B=w,Q=B.flags;switch(B.tag){case 22:Kh(E,B),Q&2048&&Vg(B.alternate,B);break;case 24:Kh(E,B),Q&2048&&Wg(B.alternate,B);break;default:Kh(E,B)}w=w.sibling}}var zi=8192;function mf(x){if(x.subtreeFlags&zi)for(x=x.child;x!==null;)hb(x),x=x.sibling}function hb(x){switch(x.tag){case 26:mf(x),x.flags&zi&&x.memoizedState!==null&&_4(al,x.memoizedState,x.memoizedProps);break;case 5:mf(x);break;case 3:case 4:var w=al;al=Un(x.stateNode.containerInfo),mf(x),al=w;break;case 22:x.memoizedState===null&&(w=x.alternate,w!==null&&w.memoizedState!==null?(w=zi,zi=16777216,mf(x),zi=w):mf(x));break;default:mf(x)}}function pb(x){var w=x.alternate;if(w!==null&&(x=w.child,x!==null)){w.child=null;do w=x.sibling,x.sibling=null,x=w;while(x!==null)}}function gf(x){var w=x.deletions;if((x.flags&16)!==0){if(w!==null)for(var E=0;E<w.length;E++){var B=w[E];di=B,gb(B,x)}pb(x)}if(x.subtreeFlags&10256)for(x=x.child;x!==null;)mb(x),x=x.sibling}function mb(x){switch(x.tag){case 0:case 11:case 15:gf(x),x.flags&2048&&mu(9,x,x.return);break;case 3:gf(x);break;case 12:gf(x);break;case 22:var w=x.stateNode;x.memoizedState!==null&&w._visibility&2&&(x.return===null||x.return.tag!==13)?(w._visibility&=-3,zp(x)):gf(x);break;default:gf(x)}}function zp(x){var w=x.deletions;if((x.flags&16)!==0){if(w!==null)for(var E=0;E<w.length;E++){var B=w[E];di=B,gb(B,x)}pb(x)}for(x=x.child;x!==null;){switch(w=x,w.tag){case 0:case 11:case 15:mu(8,w,w.return),zp(w);break;case 22:E=w.stateNode,E._visibility&2&&(E._visibility&=-3,zp(w));break;default:zp(w)}x=x.sibling}}function gb(x,w){for(;di!==null;){var E=di;switch(E.tag){case 0:case 11:case 15:mu(8,E,w);break;case 23:case 22:if(E.memoizedState!==null&&E.memoizedState.cachePool!==null){var B=E.memoizedState.cachePool.pool;B!=null&&B.refCount++}break;case 24:bh(E.memoizedState.cache)}if(B=E.child,B!==null)B.return=E,di=B;else e:for(E=x;di!==null;){B=di;var Q=B.sibling,ie=B.return;if(lb(B),B===E){di=null;break e}if(Q!==null){Q.return=ie,di=Q;break e}di=ie}}}var Qw={getCacheForType:function(x){var w=Fs(ts),E=w.data.get(x);return E===void 0&&(E=x(),w.data.set(x,E)),E}},qg=typeof WeakMap=="function"?WeakMap:Map,Ga=0,us=null,ha=null,Ea=0,Ka=0,$o=null,vu=!1,vf=!1,Gg=!1,Bc=0,zs=0,xu=0,wd=0,Kg=0,sl=0,xf=0,Xh=null,yo=null,Xg=!1,Yg=0,bf=1/0,Yh=null,bu=null,Ti=0,yu=null,yf=null,wf=0,Zg=0,Jg=null,vb=null,Sf=0,Qg=null;function $i(){if((Ga&2)!==0&&Ea!==0)return Ea&-Ea;if(_.T!==null){var x=rf;return x!==0?x:Gp()}return Cr()}function xb(){sl===0&&(sl=(Ea&536870912)===0||xa?Nt():536870912);var x=Bo.current;return x!==null&&(x.flags|=32),sl}function Uo(x,w,E){(x===us&&(Ka===2||Ka===9)||x.cancelPendingCommit!==null)&&(_f(x,0),wu(x,Ea,sl,!1)),Jt(x,E),((Ga&2)===0||x!==us)&&(x===us&&((Ga&2)===0&&(wd|=E),zs===4&&wu(x,Ea,sl,!1)),rc(x))}function bb(x,w,E){if((Ga&6)!==0)throw Error(n(327));var B=!E&&(w&124)===0&&(w&x.expiredLanes)===0||et(x,w),Q=B?r4(x,w):r1(x,w,!0),ie=B;do{if(Q===0){vf&&!B&&wu(x,w,0,!1);break}else{if(E=x.current.alternate,ie&&!e4(E)){Q=r1(x,w,!1),ie=!1;continue}if(Q===2){if(ie=w,x.errorRecoveryDisabledLanes&ie)var Ae=0;else Ae=x.pendingLanes&-536870913,Ae=Ae!==0?Ae:Ae&536870912?536870912:0;if(Ae!==0){w=Ae;e:{var Ue=x;Q=Xh;var lt=Ue.current.memoizedState.isDehydrated;if(lt&&(_f(Ue,Ae).flags|=256),Ae=r1(Ue,Ae,!1),Ae!==2){if(Gg&&!lt){Ue.errorRecoveryDisabledLanes|=ie,wd|=ie,Q=4;break e}ie=yo,yo=Q,ie!==null&&(yo===null?yo=ie:yo.push.apply(yo,ie))}Q=Ae}if(ie=!1,Q!==2)continue}}if(Q===1){_f(x,0),wu(x,w,0,!0);break}e:{switch(B=x,ie=Q,ie){case 0:case 1:throw Error(n(345));case 4:if((w&4194048)!==w)break;case 6:wu(B,w,sl,!vu);break e;case 2:yo=null;break;case 3:case 5:break;default:throw Error(n(329))}if((w&62914560)===w&&(Q=Yg+300-le(),10<Q)){if(wu(B,w,sl,!vu),St(B,0,!0)!==0)break e;B.timeoutHandle=Hb(yb.bind(null,B,E,yo,Yh,Xg,w,sl,wd,xf,vu,ie,2,-0,0),Q);break e}yb(B,E,yo,Yh,Xg,w,sl,wd,xf,vu,ie,0,-0,0)}}break}while(!0);rc(x)}function yb(x,w,E,B,Q,ie,Ae,Ue,lt,Ot,hr,Sr,Gt,Ft){if(x.timeoutHandle=-1,Sr=w.subtreeFlags,(Sr&8192||(Sr&16785408)===16785408)&&(Ai={stylesheets:null,count:0,unsuspend:S4},hb(w),Sr=A4(),Sr!==null)){x.cancelPendingCommit=Sr(Zh.bind(null,x,w,ie,E,B,Q,Ae,Ue,lt,hr,1,Gt,Ft)),wu(x,ie,Ae,!Ot);return}Zh(x,w,ie,E,B,Q,Ae,Ue,lt)}function e4(x){for(var w=x;;){var E=w.tag;if((E===0||E===11||E===15)&&w.flags&16384&&(E=w.updateQueue,E!==null&&(E=E.stores,E!==null)))for(var B=0;B<E.length;B++){var Q=E[B],ie=Q.getSnapshot;Q=Q.value;try{if(!Pi(ie(),Q))return!1}catch{return!1}}if(E=w.child,w.subtreeFlags&16384&&E!==null)E.return=w,w=E;else{if(w===x)break;for(;w.sibling===null;){if(w.return===null||w.return===x)return!0;w=w.return}w.sibling.return=w.return,w=w.sibling}}return!0}function wu(x,w,E,B){w&=~Kg,w&=~wd,x.suspendedLanes|=w,x.pingedLanes&=~w,B&&(x.warmLanes|=w),B=x.expirationTimes;for(var Q=w;0<Q;){var ie=31-$t(Q),Ae=1<<ie;B[ie]=-1,Q&=~Ae}E!==0&&Ur(x,E,w)}function $p(){return(Ga&6)===0?(e0(0),!1):!0}function e1(){if(ha!==null){if(Ka===0)var x=ha.return;else x=ha,$e=lu=null,fp(x),ui=null,vo=0,x=ha;for(;x!==null;)ab(x.alternate,x),x=x.return;ha=null}}function _f(x,w){var E=x.timeoutHandle;E!==-1&&(x.timeoutHandle=-1,h4(E)),E=x.cancelPendingCommit,E!==null&&(x.cancelPendingCommit=null,E()),e1(),us=x,ha=E=Qi(x.current,null),Ea=w,Ka=0,$o=null,vu=!1,vf=et(x,w),Gg=!1,xf=sl=Kg=wd=xu=zs=0,yo=Xh=null,Xg=!1,(w&8)!==0&&(w|=w&32);var B=x.entangledLanes;if(B!==0)for(x=x.entanglements,B&=w;0<B;){var Q=31-$t(B),ie=1<<Q;w|=x[Q],B&=~ie}return Bc=w,ed(),E}function wb(x,w){ra=null,_.H=Dh,w===eo||w===cp?(w=Rx(),Ka=3):w===jx?(w=Rx(),Ka=4):Ka=w===Jx?8:w!==null&&typeof w=="object"&&typeof w.then=="function"?6:1,$o=w,ha===null&&(zs=1,Bh(x,Ji(w,x.current)))}function Sb(){var x=_.H;return _.H=Dh,x===null?Dh:x}function _b(){var x=_.A;return _.A=Qw,x}function t1(){zs=4,vu||(Ea&4194048)!==Ea&&Bo.current!==null||(vf=!0),(xu&134217727)===0&&(wd&134217727)===0||us===null||wu(us,Ea,sl,!1)}function r1(x,w,E){var B=Ga;Ga|=2;var Q=Sb(),ie=_b();(us!==x||Ea!==w)&&(Yh=null,_f(x,w)),w=!1;var Ae=zs;e:do try{if(Ka!==0&&ha!==null){var Ue=ha,lt=$o;switch(Ka){case 8:e1(),Ae=6;break e;case 3:case 2:case 9:case 6:Bo.current===null&&(w=!0);var Ot=Ka;if(Ka=0,$o=null,Af(x,Ue,lt,Ot),E&&vf){Ae=0;break e}break;default:Ot=Ka,Ka=0,$o=null,Af(x,Ue,lt,Ot)}}t4(),Ae=zs;break}catch(hr){wb(x,hr)}while(!0);return w&&x.shellSuspendCounter++,$e=lu=null,Ga=B,_.H=Q,_.A=ie,ha===null&&(us=null,Ea=0,ed()),Ae}function t4(){for(;ha!==null;)n1(ha)}function r4(x,w){var E=Ga;Ga|=2;var B=Sb(),Q=_b();us!==x||Ea!==w?(Yh=null,bf=le()+500,_f(x,w)):vf=et(x,w);e:do try{if(Ka!==0&&ha!==null){w=ha;var ie=$o;t:switch(Ka){case 1:Ka=0,$o=null,Af(x,w,ie,1);break;case 2:case 9:if(kx(ie)){Ka=0,$o=null,Cb(w);break}w=function(){Ka!==2&&Ka!==9||us!==x||(Ka=7),rc(x)},ie.then(w,w);break e;case 3:Ka=7;break e;case 4:Ka=5;break e;case 7:kx(ie)?(Ka=0,$o=null,Cb(w)):(Ka=0,$o=null,Af(x,w,ie,7));break;case 5:var Ae=null;switch(ha.tag){case 26:Ae=ha.memoizedState;case 5:case 27:var Ue=ha;if(!Ae||pi(Ae)){Ka=0,$o=null;var lt=Ue.sibling;if(lt!==null)ha=lt;else{var Ot=Ue.return;Ot!==null?(ha=Ot,Up(Ot)):ha=null}break t}}Ka=0,$o=null,Af(x,w,ie,5);break;case 6:Ka=0,$o=null,Af(x,w,ie,6);break;case 8:e1(),zs=6;break e;default:throw Error(n(462))}}Ab();break}catch(hr){wb(x,hr)}while(!0);return $e=lu=null,_.H=B,_.A=Q,Ga=E,ha!==null?0:(us=null,Ea=0,ed(),zs)}function Ab(){for(;ha!==null&&!ve();)n1(ha)}function n1(x){var w=Dp(x.alternate,x,Bc);x.memoizedProps=x.pendingProps,w===null?Up(x):ha=w}function Cb(x){var w=x,E=w.alternate;switch(w.tag){case 15:case 0:w=Lp(E,w,w.pendingProps,w.type,void 0,Ea);break;case 11:w=Lp(E,w,w.pendingProps,w.type.render,w.ref,Ea);break;case 5:fp(w);default:ab(E,w),w=ha=hh(w,Bc),w=Dp(E,w,Bc)}x.memoizedProps=x.pendingProps,w===null?Up(x):ha=w}function Af(x,w,E,B){$e=lu=null,fp(w),ui=null,vo=0;var Q=w.return;try{if(Zx(x,Q,w,E,Ea)){zs=1,Bh(x,Ji(E,x.current)),ha=null;return}}catch(ie){if(Q!==null)throw ha=Q,ie;zs=1,Bh(x,Ji(E,x.current)),ha=null;return}w.flags&32768?(xa||B===1?x=!0:vf||(Ea&536870912)!==0?x=!1:(vu=x=!0,(B===2||B===9||B===3||B===6)&&(B=Bo.current,B!==null&&B.tag===13&&(B.flags|=16384))),jb(w,x)):Up(w)}function Up(x){var w=x;do{if((w.flags&32768)!==0){jb(w,vu);return}x=w.return;var E=rb(w.alternate,w,Bc);if(E!==null){ha=E;return}if(w=w.sibling,w!==null){ha=w;return}ha=w=x}while(w!==null);zs===0&&(zs=5)}function jb(x,w){do{var E=nb(x.alternate,x);if(E!==null){E.flags&=32767,ha=E;return}if(E=x.return,E!==null&&(E.flags|=32768,E.subtreeFlags=0,E.deletions=null),!w&&(x=x.sibling,x!==null)){ha=x;return}ha=x=E}while(x!==null);zs=6,ha=null}function Zh(x,w,E,B,Q,ie,Ae,Ue,lt){x.cancelPendingCommit=null;do Hp();while(Ti!==0);if((Ga&6)!==0)throw Error(n(327));if(w!==null){if(w===x.current)throw Error(n(177));if(ie=w.lanes|w.childLanes,ie|=sg,Pt(x,E,ie,Ae,Ue,lt),x===us&&(ha=us=null,Ea=0),yf=w,yu=x,wf=E,Zg=ie,Jg=Q,vb=B,(w.subtreeFlags&10256)!==0||(w.flags&10256)!==0?(x.callbackNode=null,x.callbackPriority=0,Db(ye,function(){return Tb(),null})):(x.callbackNode=null,x.callbackPriority=0),B=(w.flags&13878)!==0,(w.subtreeFlags&13878)!==0||B){B=_.T,_.T=null,Q=R.p,R.p=2,Ae=Ga,Ga|=4;try{Zw(x,w,E)}finally{Ga=Ae,R.p=Q,_.T=B}}Ti=1,kb(),Rb(),Eb()}}function kb(){if(Ti===1){Ti=0;var x=yu,w=yf,E=(w.flags&13878)!==0;if((w.subtreeFlags&13878)!==0||E){E=_.T,_.T=null;var B=R.p;R.p=2;var Q=Ga;Ga|=4;try{Hg(w,x);var ie=Yp,Ae=lh(x.containerInfo),Ue=ie.focusedElem,lt=ie.selectionRange;if(Ae!==Ue&&Ue&&Ue.ownerDocument&&oh(Ue.ownerDocument.documentElement,Ue)){if(lt!==null&&Yd(Ue)){var Ot=lt.start,hr=lt.end;if(hr===void 0&&(hr=Ot),"selectionStart"in Ue)Ue.selectionStart=Ot,Ue.selectionEnd=Math.min(hr,Ue.value.length);else{var Sr=Ue.ownerDocument||document,Gt=Sr&&Sr.defaultView||window;if(Gt.getSelection){var Ft=Gt.getSelection(),Nn=Ue.textContent.length,Rn=Math.min(lt.start,Nn),Qa=lt.end===void 0?Rn:Math.min(lt.end,Nn);!Ft.extend&&Rn>Qa&&(Ae=Qa,Qa=Rn,Rn=Ae);var Rt=Xd(Ue,Rn),yt=Xd(Ue,Qa);if(Rt&&yt&&(Ft.rangeCount!==1||Ft.anchorNode!==Rt.node||Ft.anchorOffset!==Rt.offset||Ft.focusNode!==yt.node||Ft.focusOffset!==yt.offset)){var Mt=Sr.createRange();Mt.setStart(Rt.node,Rt.offset),Ft.removeAllRanges(),Rn>Qa?(Ft.addRange(Mt),Ft.extend(yt.node,yt.offset)):(Mt.setEnd(yt.node,yt.offset),Ft.addRange(Mt))}}}}for(Sr=[],Ft=Ue;Ft=Ft.parentNode;)Ft.nodeType===1&&Sr.push({element:Ft,left:Ft.scrollLeft,top:Ft.scrollTop});for(typeof Ue.focus=="function"&&Ue.focus(),Ue=0;Ue<Sr.length;Ue++){var gr=Sr[Ue];gr.element.scrollLeft=gr.left,gr.element.scrollTop=gr.top}}nm=!!Nl,Yp=Nl=null}finally{Ga=Q,R.p=B,_.T=E}}x.current=w,Ti=2}}function Rb(){if(Ti===2){Ti=0;var x=yu,w=yf,E=(w.flags&8772)!==0;if((w.subtreeFlags&8772)!==0||E){E=_.T,_.T=null;var B=R.p;R.p=2;var Q=Ga;Ga|=4;try{ob(x,w.alternate,w)}finally{Ga=Q,R.p=B,_.T=E}}Ti=3}}function Eb(){if(Ti===4||Ti===3){Ti=0,_e();var x=yu,w=yf,E=wf,B=vb;(w.subtreeFlags&10256)!==0||(w.flags&10256)!==0?Ti=5:(Ti=0,yf=yu=null,Nb(x,x.pendingLanes));var Q=x.pendingLanes;if(Q===0&&(bu=null),nr(E),w=w.stateNode,dt&&typeof dt.onCommitFiberRoot=="function")try{dt.onCommitFiberRoot(at,w,void 0,(w.current.flags&128)===128)}catch{}if(B!==null){w=_.T,Q=R.p,R.p=2,_.T=null;try{for(var ie=x.onRecoverableError,Ae=0;Ae<B.length;Ae++){var Ue=B[Ae];ie(Ue.value,{componentStack:Ue.stack})}}finally{_.T=w,R.p=Q}}(wf&3)!==0&&Hp(),rc(x),Q=x.pendingLanes,(E&4194090)!==0&&(Q&42)!==0?x===Qg?Sf++:(Sf=0,Qg=x):Sf=0,e0(0)}}function Nb(x,w){(x.pooledCacheLanes&=w)===0&&(w=x.pooledCache,w!=null&&(x.pooledCache=null,bh(w)))}function Hp(x){return kb(),Rb(),Eb(),Tb()}function Tb(){if(Ti!==5)return!1;var x=yu,w=Zg;Zg=0;var E=nr(wf),B=_.T,Q=R.p;try{R.p=32>E?32:E,_.T=null,E=Jg,Jg=null;var ie=yu,Ae=wf;if(Ti=0,yf=yu=null,wf=0,(Ga&6)!==0)throw Error(n(331));var Ue=Ga;if(Ga|=4,mb(ie.current),fb(ie,ie.current,Ae,E),Ga=Ue,e0(0,!1),dt&&typeof dt.onPostCommitFiberRoot=="function")try{dt.onPostCommitFiberRoot(at,ie)}catch{}return!0}finally{R.p=Q,_.T=B,Nb(x,w)}}function Lb(x,w,E){w=Ji(E,w),w=Rp(x.stateNode,w,2),x=Ec(x,w,2),x!==null&&(Jt(x,2),rc(x))}function ns(x,w,E){if(x.tag===3)Lb(x,x,E);else for(;w!==null;){if(w.tag===3){Lb(w,x,E);break}else if(w.tag===1){var B=w.stateNode;if(typeof w.type.getDerivedStateFromError=="function"||typeof B.componentDidCatch=="function"&&(bu===null||!bu.has(B))){x=Ji(E,x),E=Og(2),B=Ec(w,E,2),B!==null&&(Yx(E,B,w,x),Jt(B,2),rc(B));break}}w=w.return}}function a1(x,w,E){var B=x.pingCache;if(B===null){B=x.pingCache=new qg;var Q=new Set;B.set(w,Q)}else Q=B.get(w),Q===void 0&&(Q=new Set,B.set(w,Q));Q.has(E)||(Gg=!0,Q.add(E),x=n4.bind(null,x,w,E),w.then(x,x))}function n4(x,w,E){var B=x.pingCache;B!==null&&B.delete(w),x.pingedLanes|=x.suspendedLanes&E,x.warmLanes&=~E,us===x&&(Ea&E)===E&&(zs===4||zs===3&&(Ea&62914560)===Ea&&300>le()-Yg?(Ga&2)===0&&_f(x,0):Kg|=E,xf===Ea&&(xf=0)),rc(x)}function Mb(x,w){w===0&&(w=kt()),x=td(x,w),x!==null&&(Jt(x,w),rc(x))}function Vp(x){var w=x.memoizedState,E=0;w!==null&&(E=w.retryLane),Mb(x,E)}function a4(x,w){var E=0;switch(x.tag){case 13:var B=x.stateNode,Q=x.memoizedState;Q!==null&&(E=Q.retryLane);break;case 19:B=x.stateNode;break;case 22:B=x.stateNode._retryCache;break;default:throw Error(n(314))}B!==null&&B.delete(w),Mb(x,E)}function Db(x,w){return ce(x,w)}var Jh=null,Su=null,Wp=!1,Qh=!1,qp=!1,_u=0;function rc(x){x!==Su&&x.next===null&&(Su===null?Jh=Su=x:Su=Su.next=x),Qh=!0,Wp||(Wp=!0,s1())}function e0(x,w){if(!qp&&Qh){qp=!0;do for(var E=!1,B=Jh;B!==null;){if(x!==0){var Q=B.pendingLanes;if(Q===0)var ie=0;else{var Ae=B.suspendedLanes,Ue=B.pingedLanes;ie=(1<<31-$t(42|x)+1)-1,ie&=Q&~(Ae&~Ue),ie=ie&201326741?ie&201326741|1:ie?ie|2:0}ie!==0&&(E=!0,Ob(B,ie))}else ie=Ea,ie=St(B,B===us?ie:0,B.cancelPendingCommit!==null||B.timeoutHandle!==-1),(ie&3)===0||et(B,ie)||(E=!0,Ob(B,ie));B=B.next}while(E);qp=!1}}function s4(){t0()}function t0(){Qh=Wp=!1;var x=0;_u!==0&&(f4()&&(x=_u),_u=0);for(var w=le(),E=null,B=Jh;B!==null;){var Q=B.next,ie=r0(B,w);ie===0?(B.next=null,E===null?Jh=Q:E.next=Q,Q===null&&(Su=E)):(E=B,(x!==0||(ie&3)!==0)&&(Qh=!0)),B=Q}e0(x)}function r0(x,w){for(var E=x.suspendedLanes,B=x.pingedLanes,Q=x.expirationTimes,ie=x.pendingLanes&-62914561;0<ie;){var Ae=31-$t(ie),Ue=1<<Ae,lt=Q[Ae];lt===-1?((Ue&E)===0||(Ue&B)!==0)&&(Q[Ae]=Ht(Ue,w)):lt<=w&&(x.expiredLanes|=Ue),ie&=~Ue}if(w=us,E=Ea,E=St(x,x===w?E:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),B=x.callbackNode,E===0||x===w&&(Ka===2||Ka===9)||x.cancelPendingCommit!==null)return B!==null&&B!==null&&fe(B),x.callbackNode=null,x.callbackPriority=0;if((E&3)===0||et(x,E)){if(w=E&-E,w===x.callbackPriority)return w;switch(B!==null&&fe(B),nr(E)){case 2:case 8:E=pe;break;case 32:E=ye;break;case 268435456:E=De;break;default:E=ye}return B=Ib.bind(null,x),E=ce(E,B),x.callbackPriority=w,x.callbackNode=E,w}return B!==null&&B!==null&&fe(B),x.callbackPriority=2,x.callbackNode=null,2}function Ib(x,w){if(Ti!==0&&Ti!==5)return x.callbackNode=null,x.callbackPriority=0,null;var E=x.callbackNode;if(Hp()&&x.callbackNode!==E)return null;var B=Ea;return B=St(x,x===us?B:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),B===0?null:(bb(x,B,w),r0(x,le()),x.callbackNode!=null&&x.callbackNode===E?Ib.bind(null,x):null)}function Ob(x,w){if(Hp())return null;bb(x,w,!0)}function s1(){p4(function(){(Ga&6)!==0?ce(Te,s4):t0()})}function Gp(){return _u===0&&(_u=Nt()),_u}function Pb(x){return x==null||typeof x=="symbol"||typeof x=="boolean"?null:typeof x=="function"?x:Kr(""+x)}function Fb(x,w){var E=w.ownerDocument.createElement("input");return E.name=w.name,E.value=w.value,x.id&&E.setAttribute("form",x.id),w.parentNode.insertBefore(E,w),x=new FormData(x),E.parentNode.removeChild(E),x}function i4(x,w,E,B,Q){if(w==="submit"&&E&&E.stateNode===Q){var ie=Pb((Q[nt]||null).action),Ae=B.submitter;Ae&&(w=(w=Ae[nt]||null)?Pb(w.formAction):Ae.getAttribute("formAction"),w!==null&&(ie=w,Ae=null));var Ue=new Xn("action","action",null,B,Q);x.push({event:Ue,listeners:[{instance:null,listener:function(){if(B.defaultPrevented){if(_u!==0){var lt=Ae?Fb(Q,Ae):new FormData(Q);Lh(E,{pending:!0,data:lt,method:Q.method,action:ie},null,lt)}}else typeof ie=="function"&&(Ue.preventDefault(),lt=Ae?Fb(Q,Ae):new FormData(Q),Lh(E,{pending:!0,data:lt,method:Q.method,action:ie},ie,lt))},currentTarget:Q}]})}}for(var i1=0;i1<Da.length;i1++){var o1=Da[i1],o4=o1.toLowerCase(),l4=o1[0].toUpperCase()+o1.slice(1);_l(o4,"on"+l4)}_l(Qu,"onAnimationEnd"),_l(su,"onAnimationIteration"),_l(Oo,"onAnimationStart"),_l("dblclick","onDoubleClick"),_l("focusin","onFocus"),_l("focusout","onBlur"),_l(rp,"onTransitionRun"),_l(Vw,"onTransitionStart"),_l(Zd,"onTransitionCancel"),_l(ch,"onTransitionEnd"),Fe("onMouseEnter",["mouseout","mouseover"]),Fe("onMouseLeave",["mouseout","mouseover"]),Fe("onPointerEnter",["pointerout","pointerover"]),Fe("onPointerLeave",["pointerout","pointerover"]),we("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),we("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),we("onBeforeInput",["compositionend","keypress","textInput","paste"]),we("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),we("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),we("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var n0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),c4=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(n0));function Bb(x,w){w=(w&4)!==0;for(var E=0;E<x.length;E++){var B=x[E],Q=B.event;B=B.listeners;e:{var ie=void 0;if(w)for(var Ae=B.length-1;0<=Ae;Ae--){var Ue=B[Ae],lt=Ue.instance,Ot=Ue.currentTarget;if(Ue=Ue.listener,lt!==ie&&Q.isPropagationStopped())break e;ie=Ue,Q.currentTarget=Ot;try{ie(Q)}catch(hr){xd(hr)}Q.currentTarget=null,ie=lt}else for(Ae=0;Ae<B.length;Ae++){if(Ue=B[Ae],lt=Ue.instance,Ot=Ue.currentTarget,Ue=Ue.listener,lt!==ie&&Q.isPropagationStopped())break e;ie=Ue,Q.currentTarget=Ot;try{ie(Q)}catch(hr){xd(hr)}Q.currentTarget=null,ie=lt}}}}function pa(x,w){var E=w[Qe];E===void 0&&(E=w[Qe]=new Set);var B=x+"__bubble";E.has(B)||(zb(w,x,2,!1),E.add(B))}function l1(x,w,E){var B=0;w&&(B|=4),zb(E,x,B,w)}var wo="_reactListening"+Math.random().toString(36).slice(2);function c1(x){if(!x[wo]){x[wo]=!0,Ie.forEach(function(E){E!=="selectionchange"&&(c4.has(E)||l1(E,!1,x),l1(E,!0,x))});var w=x.nodeType===9?x:x.ownerDocument;w===null||w[wo]||(w[wo]=!0,l1("selectionchange",!1,w))}}function zb(x,w,E,B){switch(sy(w)){case 2:var Q=k4;break;case 8:Q=Tf;break;default:Q=b1}E=Q.bind(null,w,E,x),Q=void 0,!ja||w!=="touchstart"&&w!=="touchmove"&&w!=="wheel"||(Q=!0),B?Q!==void 0?x.addEventListener(w,E,{capture:!0,passive:Q}):x.addEventListener(w,E,!0):Q!==void 0?x.addEventListener(w,E,{passive:Q}):x.addEventListener(w,E,!1)}function zc(x,w,E,B,Q){var ie=B;if((w&1)===0&&(w&2)===0&&B!==null)e:for(;;){if(B===null)return;var Ae=B.tag;if(Ae===3||Ae===4){var Ue=B.stateNode.containerInfo;if(Ue===Q)break;if(Ae===4)for(Ae=B.return;Ae!==null;){var lt=Ae.tag;if((lt===3||lt===4)&&Ae.stateNode.containerInfo===Q)return;Ae=Ae.return}for(;Ue!==null;){if(Ae=be(Ue),Ae===null)return;if(lt=Ae.tag,lt===5||lt===6||lt===26||lt===27){B=ie=Ae;continue e}Ue=Ue.parentNode}}B=B.return}rn(function(){var Ot=ie,hr=jn(E),Sr=[];e:{var Gt=uh.get(x);if(Gt!==void 0){var Ft=Xn,Nn=x;switch(x){case"keypress":if(Qr(E)===0)break e;case"keydown":case"keyup":Ft=ea;break;case"focusin":Nn="focus",Ft=_n;break;case"focusout":Nn="blur",Ft=_n;break;case"beforeblur":case"afterblur":Ft=_n;break;case"click":if(E.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ft=mr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ft=Mr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ft=ls;break;case Qu:case su:case Oo:Ft=Yt;break;case ch:Ft=Ns;break;case"scroll":case"scrollend":Ft=Wt;break;case"wheel":Ft=_c;break;case"copy":case"cut":case"paste":Ft=Hr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ft=Za;break;case"toggle":case"beforetoggle":Ft=Wd}var Rn=(w&4)!==0,Qa=!Rn&&(x==="scroll"||x==="scrollend"),Rt=Rn?Gt!==null?Gt+"Capture":null:Gt;Rn=[];for(var yt=Ot,Mt;yt!==null;){var gr=yt;if(Mt=gr.stateNode,gr=gr.tag,gr!==5&&gr!==26&&gr!==27||Mt===null||Rt===null||(gr=$a(yt,Rt),gr!=null&&Rn.push(Pn(yt,gr,Mt))),Qa)break;yt=yt.return}0<Rn.length&&(Gt=new Ft(Gt,Nn,null,E,hr),Sr.push({event:Gt,listeners:Rn}))}}if((w&7)===0){e:{if(Gt=x==="mouseover"||x==="pointerover",Ft=x==="mouseout"||x==="pointerout",Gt&&E!==sr&&(Nn=E.relatedTarget||E.fromElement)&&(be(Nn)||Nn[Pe]))break e;if((Ft||Gt)&&(Gt=hr.window===hr?hr:(Gt=hr.ownerDocument)?Gt.defaultView||Gt.parentWindow:window,Ft?(Nn=E.relatedTarget||E.toElement,Ft=Ot,Nn=Nn?be(Nn):null,Nn!==null&&(Qa=o(Nn),Rn=Nn.tag,Nn!==Qa||Rn!==5&&Rn!==27&&Rn!==6)&&(Nn=null)):(Ft=null,Nn=Ot),Ft!==Nn)){if(Rn=mr,gr="onMouseLeave",Rt="onMouseEnter",yt="mouse",(x==="pointerout"||x==="pointerover")&&(Rn=Za,gr="onPointerLeave",Rt="onPointerEnter",yt="pointer"),Qa=Ft==null?Gt:Ne(Ft),Mt=Nn==null?Gt:Ne(Nn),Gt=new Rn(gr,yt+"leave",Ft,E,hr),Gt.target=Qa,Gt.relatedTarget=Mt,gr=null,be(hr)===Ot&&(Rn=new Rn(Rt,yt+"enter",Nn,E,hr),Rn.target=Mt,Rn.relatedTarget=Qa,gr=Rn),Qa=gr,Ft&&Nn)t:{for(Rn=Ft,Rt=Nn,yt=0,Mt=Rn;Mt;Mt=fi(Mt))yt++;for(Mt=0,gr=Rt;gr;gr=fi(gr))Mt++;for(;0<yt-Mt;)Rn=fi(Rn),yt--;for(;0<Mt-yt;)Rt=fi(Rt),Mt--;for(;yt--;){if(Rn===Rt||Rt!==null&&Rn===Rt.alternate)break t;Rn=fi(Rn),Rt=fi(Rt)}Rn=null}else Rn=null;Ft!==null&&$s(Sr,Gt,Ft,Rn,!1),Nn!==null&&Qa!==null&&$s(Sr,Qa,Nn,Rn,!0)}}e:{if(Gt=Ot?Ne(Ot):window,Ft=Gt.nodeName&&Gt.nodeName.toLowerCase(),Ft==="select"||Ft==="input"&&Gt.type==="file")var tn=Ta;else if(Qt(Gt))if(Ts)tn=Ju;else{tn=li;var ua=Xo}else Ft=Gt.nodeName,!Ft||Ft.toLowerCase()!=="input"||Gt.type!=="checkbox"&&Gt.type!=="radio"?Ot&&rr(Ot.elementType)&&(tn=Ta):tn=Yo;if(tn&&(tn=tn(x,Ot))){Lt(Sr,tn,E,hr);break e}ua&&ua(x,Gt,Ot),x==="focusout"&&Ot&&Gt.type==="number"&&Ot.memoizedProps.value!=null&&Ir(Gt,"number",Gt.value)}switch(ua=Ot?Ne(Ot):window,x){case"focusin":(Qt(ua)||ua.contentEditable==="true")&&(Cc=ua,Sl=Ot,Ct=null);break;case"focusout":Ct=Sl=Cc=null;break;case"mousedown":lr=!0;break;case"contextmenu":case"mouseup":case"dragend":lr=!1,Zt(Sr,E,hr);break;case"selectionchange":if(tp)break;case"keydown":case"keyup":Zt(Sr,E,hr)}var bn;if(ah)e:{switch(x){case"compositionstart":var Tn="onCompositionStart";break e;case"compositionend":Tn="onCompositionEnd";break e;case"compositionupdate":Tn="onCompositionUpdate";break e}Tn=void 0}else Kl?ep(x,E)&&(Tn="onCompositionEnd"):x==="keydown"&&E.keyCode===229&&(Tn="onCompositionStart");Tn&&(au&&E.locale!=="ko"&&(Kl||Tn!=="onCompositionStart"?Tn==="onCompositionEnd"&&Kl&&(bn=Xs()):(Or=hr,wa="value"in Or?Or.value:Or.textContent,Kl=!0)),ua=Kp(Ot,Tn),0<ua.length&&(Tn=new Ra(Tn,x,null,E,hr),Sr.push({event:Tn,listeners:ua}),bn?Tn.data=bn:(bn=Gd(E),bn!==null&&(Tn.data=bn)))),(bn=sh?oe(x,E):Ve(x,E))&&(Tn=Kp(Ot,"onBeforeInput"),0<Tn.length&&(ua=new Ra("onBeforeInput","beforeinput",null,E,hr),Sr.push({event:ua,listeners:Tn}),ua.data=bn)),i4(Sr,x,Ot,E,hr)}Bb(Sr,w)})}function Pn(x,w,E){return{instance:x,listener:w,currentTarget:E}}function Kp(x,w){for(var E=w+"Capture",B=[];x!==null;){var Q=x,ie=Q.stateNode;if(Q=Q.tag,Q!==5&&Q!==26&&Q!==27||ie===null||(Q=$a(x,E),Q!=null&&B.unshift(Pn(x,Q,ie)),Q=$a(x,w),Q!=null&&B.push(Pn(x,Q,ie))),x.tag===3)return B;x=x.return}return[]}function fi(x){if(x===null)return null;do x=x.return;while(x&&x.tag!==5&&x.tag!==27);return x||null}function $s(x,w,E,B,Q){for(var ie=w._reactName,Ae=[];E!==null&&E!==B;){var Ue=E,lt=Ue.alternate,Ot=Ue.stateNode;if(Ue=Ue.tag,lt!==null&&lt===B)break;Ue!==5&&Ue!==26&&Ue!==27||Ot===null||(lt=Ot,Q?(Ot=$a(E,ie),Ot!=null&&Ae.unshift(Pn(E,Ot,lt))):Q||(Ot=$a(E,ie),Ot!=null&&Ae.push(Pn(E,Ot,lt)))),E=E.return}Ae.length!==0&&x.push({event:w,listeners:Ae})}var u4=/\r\n?/g,Au=/\u0000|\uFFFD/g;function $b(x){return(typeof x=="string"?x:""+x).replace(u4,`
`).replace(Au,"")}function Ub(x,w){return w=$b(w),$b(x)===w}function Xp(){}function Ja(x,w,E,B,Q,ie){switch(E){case"children":typeof B=="string"?w==="body"||w==="textarea"&&B===""||Le(x,B):(typeof B=="number"||typeof B=="bigint")&&w!=="body"&&Le(x,""+B);break;case"className":_t(x,"class",B);break;case"tabIndex":_t(x,"tabindex",B);break;case"dir":case"role":case"viewBox":case"width":case"height":_t(x,E,B);break;case"style":pt(x,B,ie);break;case"data":if(w!=="object"){_t(x,"data",B);break}case"src":case"href":if(B===""&&(w!=="a"||E!=="href")){x.removeAttribute(E);break}if(B==null||typeof B=="function"||typeof B=="symbol"||typeof B=="boolean"){x.removeAttribute(E);break}B=Kr(""+B),x.setAttribute(E,B);break;case"action":case"formAction":if(typeof B=="function"){x.setAttribute(E,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof ie=="function"&&(E==="formAction"?(w!=="input"&&Ja(x,w,"name",Q.name,Q,null),Ja(x,w,"formEncType",Q.formEncType,Q,null),Ja(x,w,"formMethod",Q.formMethod,Q,null),Ja(x,w,"formTarget",Q.formTarget,Q,null)):(Ja(x,w,"encType",Q.encType,Q,null),Ja(x,w,"method",Q.method,Q,null),Ja(x,w,"target",Q.target,Q,null)));if(B==null||typeof B=="symbol"||typeof B=="boolean"){x.removeAttribute(E);break}B=Kr(""+B),x.setAttribute(E,B);break;case"onClick":B!=null&&(x.onclick=Xp);break;case"onScroll":B!=null&&pa("scroll",x);break;case"onScrollEnd":B!=null&&pa("scrollend",x);break;case"dangerouslySetInnerHTML":if(B!=null){if(typeof B!="object"||!("__html"in B))throw Error(n(61));if(E=B.__html,E!=null){if(Q.children!=null)throw Error(n(60));x.innerHTML=E}}break;case"multiple":x.multiple=B&&typeof B!="function"&&typeof B!="symbol";break;case"muted":x.muted=B&&typeof B!="function"&&typeof B!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(B==null||typeof B=="function"||typeof B=="boolean"||typeof B=="symbol"){x.removeAttribute("xlink:href");break}E=Kr(""+B),x.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",E);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":B!=null&&typeof B!="function"&&typeof B!="symbol"?x.setAttribute(E,""+B):x.removeAttribute(E);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":B&&typeof B!="function"&&typeof B!="symbol"?x.setAttribute(E,""):x.removeAttribute(E);break;case"capture":case"download":B===!0?x.setAttribute(E,""):B!==!1&&B!=null&&typeof B!="function"&&typeof B!="symbol"?x.setAttribute(E,B):x.removeAttribute(E);break;case"cols":case"rows":case"size":case"span":B!=null&&typeof B!="function"&&typeof B!="symbol"&&!isNaN(B)&&1<=B?x.setAttribute(E,B):x.removeAttribute(E);break;case"rowSpan":case"start":B==null||typeof B=="function"||typeof B=="symbol"||isNaN(B)?x.removeAttribute(E):x.setAttribute(E,B);break;case"popover":pa("beforetoggle",x),pa("toggle",x),mt(x,"popover",B);break;case"xlinkActuate":ot(x,"http://www.w3.org/1999/xlink","xlink:actuate",B);break;case"xlinkArcrole":ot(x,"http://www.w3.org/1999/xlink","xlink:arcrole",B);break;case"xlinkRole":ot(x,"http://www.w3.org/1999/xlink","xlink:role",B);break;case"xlinkShow":ot(x,"http://www.w3.org/1999/xlink","xlink:show",B);break;case"xlinkTitle":ot(x,"http://www.w3.org/1999/xlink","xlink:title",B);break;case"xlinkType":ot(x,"http://www.w3.org/1999/xlink","xlink:type",B);break;case"xmlBase":ot(x,"http://www.w3.org/XML/1998/namespace","xml:base",B);break;case"xmlLang":ot(x,"http://www.w3.org/XML/1998/namespace","xml:lang",B);break;case"xmlSpace":ot(x,"http://www.w3.org/XML/1998/namespace","xml:space",B);break;case"is":mt(x,"is",B);break;case"innerText":case"textContent":break;default:(!(2<E.length)||E[0]!=="o"&&E[0]!=="O"||E[1]!=="n"&&E[1]!=="N")&&(E=ur.get(E)||E,mt(x,E,B))}}function u1(x,w,E,B,Q,ie){switch(E){case"style":pt(x,B,ie);break;case"dangerouslySetInnerHTML":if(B!=null){if(typeof B!="object"||!("__html"in B))throw Error(n(61));if(E=B.__html,E!=null){if(Q.children!=null)throw Error(n(60));x.innerHTML=E}}break;case"children":typeof B=="string"?Le(x,B):(typeof B=="number"||typeof B=="bigint")&&Le(x,""+B);break;case"onScroll":B!=null&&pa("scroll",x);break;case"onScrollEnd":B!=null&&pa("scrollend",x);break;case"onClick":B!=null&&(x.onclick=Xp);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ae.hasOwnProperty(E))e:{if(E[0]==="o"&&E[1]==="n"&&(Q=E.endsWith("Capture"),w=E.slice(2,Q?E.length-7:void 0),ie=x[nt]||null,ie=ie!=null?ie[E]:null,typeof ie=="function"&&x.removeEventListener(w,ie,Q),typeof B=="function")){typeof ie!="function"&&ie!==null&&(E in x?x[E]=null:x.hasAttribute(E)&&x.removeAttribute(E)),x.addEventListener(w,B,Q);break e}E in x?x[E]=B:B===!0?x.setAttribute(E,""):mt(x,E,B)}}}function hi(x,w,E){switch(w){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":pa("error",x),pa("load",x);var B=!1,Q=!1,ie;for(ie in E)if(E.hasOwnProperty(ie)){var Ae=E[ie];if(Ae!=null)switch(ie){case"src":B=!0;break;case"srcSet":Q=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,w));default:Ja(x,w,ie,Ae,E,null)}}Q&&Ja(x,w,"srcSet",E.srcSet,E,null),B&&Ja(x,w,"src",E.src,E,null);return;case"input":pa("invalid",x);var Ue=ie=Ae=Q=null,lt=null,Ot=null;for(B in E)if(E.hasOwnProperty(B)){var hr=E[B];if(hr!=null)switch(B){case"name":Q=hr;break;case"type":Ae=hr;break;case"checked":lt=hr;break;case"defaultChecked":Ot=hr;break;case"value":ie=hr;break;case"defaultValue":Ue=hr;break;case"children":case"dangerouslySetInnerHTML":if(hr!=null)throw Error(n(137,w));break;default:Ja(x,w,B,hr,E,null)}}pr(x,ie,Ue,lt,Ot,Ae,Q,!1),xn(x);return;case"select":pa("invalid",x),B=Ae=ie=null;for(Q in E)if(E.hasOwnProperty(Q)&&(Ue=E[Q],Ue!=null))switch(Q){case"value":ie=Ue;break;case"defaultValue":Ae=Ue;break;case"multiple":B=Ue;default:Ja(x,w,Q,Ue,E,null)}w=ie,E=Ae,x.multiple=!!B,w!=null?$n(x,!!B,w,!1):E!=null&&$n(x,!!B,E,!0);return;case"textarea":pa("invalid",x),ie=Q=B=null;for(Ae in E)if(E.hasOwnProperty(Ae)&&(Ue=E[Ae],Ue!=null))switch(Ae){case"value":B=Ue;break;case"defaultValue":Q=Ue;break;case"children":ie=Ue;break;case"dangerouslySetInnerHTML":if(Ue!=null)throw Error(n(91));break;default:Ja(x,w,Ae,Ue,E,null)}jr(x,B,Q,ie),xn(x);return;case"option":for(lt in E)if(E.hasOwnProperty(lt)&&(B=E[lt],B!=null))switch(lt){case"selected":x.selected=B&&typeof B!="function"&&typeof B!="symbol";break;default:Ja(x,w,lt,B,E,null)}return;case"dialog":pa("beforetoggle",x),pa("toggle",x),pa("cancel",x),pa("close",x);break;case"iframe":case"object":pa("load",x);break;case"video":case"audio":for(B=0;B<n0.length;B++)pa(n0[B],x);break;case"image":pa("error",x),pa("load",x);break;case"details":pa("toggle",x);break;case"embed":case"source":case"link":pa("error",x),pa("load",x);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ot in E)if(E.hasOwnProperty(Ot)&&(B=E[Ot],B!=null))switch(Ot){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,w));default:Ja(x,w,Ot,B,E,null)}return;default:if(rr(w)){for(hr in E)E.hasOwnProperty(hr)&&(B=E[hr],B!==void 0&&u1(x,w,hr,B,E,void 0));return}}for(Ue in E)E.hasOwnProperty(Ue)&&(B=E[Ue],B!=null&&Ja(x,w,Ue,B,E,null))}function d4(x,w,E,B){switch(w){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var Q=null,ie=null,Ae=null,Ue=null,lt=null,Ot=null,hr=null;for(Ft in E){var Sr=E[Ft];if(E.hasOwnProperty(Ft)&&Sr!=null)switch(Ft){case"checked":break;case"value":break;case"defaultValue":lt=Sr;default:B.hasOwnProperty(Ft)||Ja(x,w,Ft,null,B,Sr)}}for(var Gt in B){var Ft=B[Gt];if(Sr=E[Gt],B.hasOwnProperty(Gt)&&(Ft!=null||Sr!=null))switch(Gt){case"type":ie=Ft;break;case"name":Q=Ft;break;case"checked":Ot=Ft;break;case"defaultChecked":hr=Ft;break;case"value":Ae=Ft;break;case"defaultValue":Ue=Ft;break;case"children":case"dangerouslySetInnerHTML":if(Ft!=null)throw Error(n(137,w));break;default:Ft!==Sr&&Ja(x,w,Gt,Ft,B,Sr)}}za(x,Ae,Ue,lt,Ot,hr,ie,Q);return;case"select":Ft=Ae=Ue=Gt=null;for(ie in E)if(lt=E[ie],E.hasOwnProperty(ie)&&lt!=null)switch(ie){case"value":break;case"multiple":Ft=lt;default:B.hasOwnProperty(ie)||Ja(x,w,ie,null,B,lt)}for(Q in B)if(ie=B[Q],lt=E[Q],B.hasOwnProperty(Q)&&(ie!=null||lt!=null))switch(Q){case"value":Gt=ie;break;case"defaultValue":Ue=ie;break;case"multiple":Ae=ie;default:ie!==lt&&Ja(x,w,Q,ie,B,lt)}w=Ue,E=Ae,B=Ft,Gt!=null?$n(x,!!E,Gt,!1):!!B!=!!E&&(w!=null?$n(x,!!E,w,!0):$n(x,!!E,E?[]:"",!1));return;case"textarea":Ft=Gt=null;for(Ue in E)if(Q=E[Ue],E.hasOwnProperty(Ue)&&Q!=null&&!B.hasOwnProperty(Ue))switch(Ue){case"value":break;case"children":break;default:Ja(x,w,Ue,null,B,Q)}for(Ae in B)if(Q=B[Ae],ie=E[Ae],B.hasOwnProperty(Ae)&&(Q!=null||ie!=null))switch(Ae){case"value":Gt=Q;break;case"defaultValue":Ft=Q;break;case"children":break;case"dangerouslySetInnerHTML":if(Q!=null)throw Error(n(91));break;default:Q!==ie&&Ja(x,w,Ae,Q,B,ie)}Fr(x,Gt,Ft);return;case"option":for(var Nn in E)if(Gt=E[Nn],E.hasOwnProperty(Nn)&&Gt!=null&&!B.hasOwnProperty(Nn))switch(Nn){case"selected":x.selected=!1;break;default:Ja(x,w,Nn,null,B,Gt)}for(lt in B)if(Gt=B[lt],Ft=E[lt],B.hasOwnProperty(lt)&&Gt!==Ft&&(Gt!=null||Ft!=null))switch(lt){case"selected":x.selected=Gt&&typeof Gt!="function"&&typeof Gt!="symbol";break;default:Ja(x,w,lt,Gt,B,Ft)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Rn in E)Gt=E[Rn],E.hasOwnProperty(Rn)&&Gt!=null&&!B.hasOwnProperty(Rn)&&Ja(x,w,Rn,null,B,Gt);for(Ot in B)if(Gt=B[Ot],Ft=E[Ot],B.hasOwnProperty(Ot)&&Gt!==Ft&&(Gt!=null||Ft!=null))switch(Ot){case"children":case"dangerouslySetInnerHTML":if(Gt!=null)throw Error(n(137,w));break;default:Ja(x,w,Ot,Gt,B,Ft)}return;default:if(rr(w)){for(var Qa in E)Gt=E[Qa],E.hasOwnProperty(Qa)&&Gt!==void 0&&!B.hasOwnProperty(Qa)&&u1(x,w,Qa,void 0,B,Gt);for(hr in B)Gt=B[hr],Ft=E[hr],!B.hasOwnProperty(hr)||Gt===Ft||Gt===void 0&&Ft===void 0||u1(x,w,hr,Gt,B,Ft);return}}for(var Rt in E)Gt=E[Rt],E.hasOwnProperty(Rt)&&Gt!=null&&!B.hasOwnProperty(Rt)&&Ja(x,w,Rt,null,B,Gt);for(Sr in B)Gt=B[Sr],Ft=E[Sr],!B.hasOwnProperty(Sr)||Gt===Ft||Gt==null&&Ft==null||Ja(x,w,Sr,Gt,B,Ft)}var Nl=null,Yp=null;function Sd(x){return x.nodeType===9?x:x.ownerDocument}function _s(x){switch(x){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Ms(x,w){if(x===0)switch(w){case"svg":return 1;case"math":return 2;default:return 0}return x===1&&w==="foreignObject"?0:x}function Zp(x,w){return x==="textarea"||x==="noscript"||typeof w.children=="string"||typeof w.children=="number"||typeof w.children=="bigint"||typeof w.dangerouslySetInnerHTML=="object"&&w.dangerouslySetInnerHTML!==null&&w.dangerouslySetInnerHTML.__html!=null}var d1=null;function f4(){var x=window.event;return x&&x.type==="popstate"?x===d1?!1:(d1=x,!0):(d1=null,!1)}var Hb=typeof setTimeout=="function"?setTimeout:void 0,h4=typeof clearTimeout=="function"?clearTimeout:void 0,Vb=typeof Promise=="function"?Promise:void 0,p4=typeof queueMicrotask=="function"?queueMicrotask:typeof Vb<"u"?function(x){return Vb.resolve(null).then(x).catch(Wb)}:Hb;function Wb(x){setTimeout(function(){throw x})}function il(x){return x==="head"}function Jp(x,w){var E=w,B=0,Q=0;do{var ie=E.nextSibling;if(x.removeChild(E),ie&&ie.nodeType===8)if(E=ie.data,E==="/$"){if(0<B&&8>B){E=B;var Ae=x.ownerDocument;if(E&1&&a0(Ae.documentElement),E&2&&a0(Ae.body),E&4)for(E=Ae.head,a0(E),Ae=E.firstChild;Ae;){var Ue=Ae.nextSibling,lt=Ae.nodeName;Ae[Ce]||lt==="SCRIPT"||lt==="STYLE"||lt==="LINK"&&Ae.rel.toLowerCase()==="stylesheet"||E.removeChild(Ae),Ae=Ue}}if(Q===0){x.removeChild(ie),f0(w);return}Q--}else E==="$"||E==="$?"||E==="$!"?Q++:B=E.charCodeAt(0)-48;else B=0;E=ie}while(E);f0(w)}function f1(x){var w=x.firstChild;for(w&&w.nodeType===10&&(w=w.nextSibling);w;){var E=w;switch(w=w.nextSibling,E.nodeName){case"HTML":case"HEAD":case"BODY":f1(E),de(E);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(E.rel.toLowerCase()==="stylesheet")continue}x.removeChild(E)}}function qb(x,w,E,B){for(;x.nodeType===1;){var Q=E;if(x.nodeName.toLowerCase()!==w.toLowerCase()){if(!B&&(x.nodeName!=="INPUT"||x.type!=="hidden"))break}else if(B){if(!x[Ce])switch(w){case"meta":if(!x.hasAttribute("itemprop"))break;return x;case"link":if(ie=x.getAttribute("rel"),ie==="stylesheet"&&x.hasAttribute("data-precedence"))break;if(ie!==Q.rel||x.getAttribute("href")!==(Q.href==null||Q.href===""?null:Q.href)||x.getAttribute("crossorigin")!==(Q.crossOrigin==null?null:Q.crossOrigin)||x.getAttribute("title")!==(Q.title==null?null:Q.title))break;return x;case"style":if(x.hasAttribute("data-precedence"))break;return x;case"script":if(ie=x.getAttribute("src"),(ie!==(Q.src==null?null:Q.src)||x.getAttribute("type")!==(Q.type==null?null:Q.type)||x.getAttribute("crossorigin")!==(Q.crossOrigin==null?null:Q.crossOrigin))&&ie&&x.hasAttribute("async")&&!x.hasAttribute("itemprop"))break;return x;default:return x}}else if(w==="input"&&x.type==="hidden"){var ie=Q.name==null?null:""+Q.name;if(Q.type==="hidden"&&x.getAttribute("name")===ie)return x}else return x;if(x=Tl(x.nextSibling),x===null)break}return null}function Qp(x,w,E){if(w==="")return null;for(;x.nodeType!==3;)if((x.nodeType!==1||x.nodeName!=="INPUT"||x.type!=="hidden")&&!E||(x=Tl(x.nextSibling),x===null))return null;return x}function no(x){return x.data==="$!"||x.data==="$?"&&x.ownerDocument.readyState==="complete"}function Cf(x,w){var E=x.ownerDocument;if(x.data!=="$?"||E.readyState==="complete")w();else{var B=function(){w(),E.removeEventListener("DOMContentLoaded",B)};E.addEventListener("DOMContentLoaded",B),x._reactRetry=B}}function Tl(x){for(;x!=null;x=x.nextSibling){var w=x.nodeType;if(w===1||w===3)break;if(w===8){if(w=x.data,w==="$"||w==="$!"||w==="$?"||w==="F!"||w==="F")break;if(w==="/$")return null}}return x}var h1=null;function Gb(x){x=x.previousSibling;for(var w=0;x;){if(x.nodeType===8){var E=x.data;if(E==="$"||E==="$!"||E==="$?"){if(w===0)return x;w--}else E==="/$"&&w++}x=x.previousSibling}return null}function Kb(x,w,E){switch(w=Sd(E),x){case"html":if(x=w.documentElement,!x)throw Error(n(452));return x;case"head":if(x=w.head,!x)throw Error(n(453));return x;case"body":if(x=w.body,!x)throw Error(n(454));return x;default:throw Error(n(451))}}function a0(x){for(var w=x.attributes;w.length;)x.removeAttributeNode(w[0]);de(x)}var Ho=new Map,nc=new Set;function Un(x){return typeof x.getRootNode=="function"?x.getRootNode():x.nodeType===9?x:x.ownerDocument}var ac=R.d;R.d={f:ol,r:Xb,D:m4,C:Yb,L:em,m:g4,X:x4,S:v4,M:b4};function ol(){var x=ac.f(),w=$p();return x||w}function Xb(x){var w=Se(x);w!==null&&w.tag===5&&w.type==="form"?Ap(w):ac.r(x)}var jf=typeof document>"u"?null:document;function Ia(x,w,E){var B=jf;if(B&&typeof w=="string"&&w){var Q=Qn(w);Q='link[rel="'+x+'"][href="'+Q+'"]',typeof E=="string"&&(Q+='[crossorigin="'+E+'"]'),nc.has(Q)||(nc.add(Q),x={rel:x,crossOrigin:E,href:w},B.querySelector(Q)===null&&(w=B.createElement("link"),hi(w,"link",x),Re(w),B.head.appendChild(w)))}}function m4(x){ac.D(x),Ia("dns-prefetch",x,null)}function Yb(x,w){ac.C(x,w),Ia("preconnect",x,w)}function em(x,w,E){ac.L(x,w,E);var B=jf;if(B&&x&&w){var Q='link[rel="preload"][as="'+Qn(w)+'"]';w==="image"&&E&&E.imageSrcSet?(Q+='[imagesrcset="'+Qn(E.imageSrcSet)+'"]',typeof E.imageSizes=="string"&&(Q+='[imagesizes="'+Qn(E.imageSizes)+'"]')):Q+='[href="'+Qn(x)+'"]';var ie=Q;switch(w){case"style":ie=kf(x);break;case"script":ie=Rf(x)}Ho.has(ie)||(x=d({rel:"preload",href:w==="image"&&E&&E.imageSrcSet?void 0:x,as:w},E),Ho.set(ie,x),B.querySelector(Q)!==null||w==="style"&&B.querySelector(s0(ie))||w==="script"&&B.querySelector(i0(ie))||(w=B.createElement("link"),hi(w,"link",x),Re(w),B.head.appendChild(w)))}}function g4(x,w){ac.m(x,w);var E=jf;if(E&&x){var B=w&&typeof w.as=="string"?w.as:"script",Q='link[rel="modulepreload"][as="'+Qn(B)+'"][href="'+Qn(x)+'"]',ie=Q;switch(B){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":ie=Rf(x)}if(!Ho.has(ie)&&(x=d({rel:"modulepreload",href:x},w),Ho.set(ie,x),E.querySelector(Q)===null)){switch(B){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(E.querySelector(i0(ie)))return}B=E.createElement("link"),hi(B,"link",x),Re(B),E.head.appendChild(B)}}}function v4(x,w,E){ac.S(x,w,E);var B=jf;if(B&&x){var Q=ze(B).hoistableStyles,ie=kf(x);w=w||"default";var Ae=Q.get(ie);if(!Ae){var Ue={loading:0,preload:null};if(Ae=B.querySelector(s0(ie)))Ue.loading=5;else{x=d({rel:"stylesheet",href:x,"data-precedence":w},E),(E=Ho.get(ie))&&o0(x,E);var lt=Ae=B.createElement("link");Re(lt),hi(lt,"link",x),lt._p=new Promise(function(Ot,hr){lt.onload=Ot,lt.onerror=hr}),lt.addEventListener("load",function(){Ue.loading|=1}),lt.addEventListener("error",function(){Ue.loading|=2}),Ue.loading|=4,tm(Ae,w,B)}Ae={type:"stylesheet",instance:Ae,count:1,state:Ue},Q.set(ie,Ae)}}}function x4(x,w){ac.X(x,w);var E=jf;if(E&&x){var B=ze(E).hoistableScripts,Q=Rf(x),ie=B.get(Q);ie||(ie=E.querySelector(i0(Q)),ie||(x=d({src:x,async:!0},w),(w=Ho.get(Q))&&p1(x,w),ie=E.createElement("script"),Re(ie),hi(ie,"link",x),E.head.appendChild(ie)),ie={type:"script",instance:ie,count:1,state:null},B.set(Q,ie))}}function b4(x,w){ac.M(x,w);var E=jf;if(E&&x){var B=ze(E).hoistableScripts,Q=Rf(x),ie=B.get(Q);ie||(ie=E.querySelector(i0(Q)),ie||(x=d({src:x,async:!0,type:"module"},w),(w=Ho.get(Q))&&p1(x,w),ie=E.createElement("script"),Re(ie),hi(ie,"link",x),E.head.appendChild(ie)),ie={type:"script",instance:ie,count:1,state:null},B.set(Q,ie))}}function Zb(x,w,E,B){var Q=(Q=X.current)?Un(Q):null;if(!Q)throw Error(n(446));switch(x){case"meta":case"title":return null;case"style":return typeof E.precedence=="string"&&typeof E.href=="string"?(w=kf(E.href),E=ze(Q).hoistableStyles,B=E.get(w),B||(B={type:"style",instance:null,count:0,state:null},E.set(w,B)),B):{type:"void",instance:null,count:0,state:null};case"link":if(E.rel==="stylesheet"&&typeof E.href=="string"&&typeof E.precedence=="string"){x=kf(E.href);var ie=ze(Q).hoistableStyles,Ae=ie.get(x);if(Ae||(Q=Q.ownerDocument||Q,Ae={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},ie.set(x,Ae),(ie=Q.querySelector(s0(x)))&&!ie._p&&(Ae.instance=ie,Ae.state.loading=5),Ho.has(x)||(E={rel:"preload",as:"style",href:E.href,crossOrigin:E.crossOrigin,integrity:E.integrity,media:E.media,hrefLang:E.hrefLang,referrerPolicy:E.referrerPolicy},Ho.set(x,E),ie||y4(Q,x,E,Ae.state))),w&&B===null)throw Error(n(528,""));return Ae}if(w&&B!==null)throw Error(n(529,""));return null;case"script":return w=E.async,E=E.src,typeof E=="string"&&w&&typeof w!="function"&&typeof w!="symbol"?(w=Rf(E),E=ze(Q).hoistableScripts,B=E.get(w),B||(B={type:"script",instance:null,count:0,state:null},E.set(w,B)),B):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,x))}}function kf(x){return'href="'+Qn(x)+'"'}function s0(x){return'link[rel="stylesheet"]['+x+"]"}function Jb(x){return d({},x,{"data-precedence":x.precedence,precedence:null})}function y4(x,w,E,B){x.querySelector('link[rel="preload"][as="style"]['+w+"]")?B.loading=1:(w=x.createElement("link"),B.preload=w,w.addEventListener("load",function(){return B.loading|=1}),w.addEventListener("error",function(){return B.loading|=2}),hi(w,"link",E),Re(w),x.head.appendChild(w))}function Rf(x){return'[src="'+Qn(x)+'"]'}function i0(x){return"script[async]"+x}function Qb(x,w,E){if(w.count++,w.instance===null)switch(w.type){case"style":var B=x.querySelector('style[data-href~="'+Qn(E.href)+'"]');if(B)return w.instance=B,Re(B),B;var Q=d({},E,{"data-href":E.href,"data-precedence":E.precedence,href:null,precedence:null});return B=(x.ownerDocument||x).createElement("style"),Re(B),hi(B,"style",Q),tm(B,E.precedence,x),w.instance=B;case"stylesheet":Q=kf(E.href);var ie=x.querySelector(s0(Q));if(ie)return w.state.loading|=4,w.instance=ie,Re(ie),ie;B=Jb(E),(Q=Ho.get(Q))&&o0(B,Q),ie=(x.ownerDocument||x).createElement("link"),Re(ie);var Ae=ie;return Ae._p=new Promise(function(Ue,lt){Ae.onload=Ue,Ae.onerror=lt}),hi(ie,"link",B),w.state.loading|=4,tm(ie,E.precedence,x),w.instance=ie;case"script":return ie=Rf(E.src),(Q=x.querySelector(i0(ie)))?(w.instance=Q,Re(Q),Q):(B=E,(Q=Ho.get(ie))&&(B=d({},E),p1(B,Q)),x=x.ownerDocument||x,Q=x.createElement("script"),Re(Q),hi(Q,"link",B),x.head.appendChild(Q),w.instance=Q);case"void":return null;default:throw Error(n(443,w.type))}else w.type==="stylesheet"&&(w.state.loading&4)===0&&(B=w.instance,w.state.loading|=4,tm(B,E.precedence,x));return w.instance}function tm(x,w,E){for(var B=E.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),Q=B.length?B[B.length-1]:null,ie=Q,Ae=0;Ae<B.length;Ae++){var Ue=B[Ae];if(Ue.dataset.precedence===w)ie=Ue;else if(ie!==Q)break}ie?ie.parentNode.insertBefore(x,ie.nextSibling):(w=E.nodeType===9?E.head:E,w.insertBefore(x,w.firstChild))}function o0(x,w){x.crossOrigin==null&&(x.crossOrigin=w.crossOrigin),x.referrerPolicy==null&&(x.referrerPolicy=w.referrerPolicy),x.title==null&&(x.title=w.title)}function p1(x,w){x.crossOrigin==null&&(x.crossOrigin=w.crossOrigin),x.referrerPolicy==null&&(x.referrerPolicy=w.referrerPolicy),x.integrity==null&&(x.integrity=w.integrity)}var Ef=null;function ey(x,w,E){if(Ef===null){var B=new Map,Q=Ef=new Map;Q.set(E,B)}else Q=Ef,B=Q.get(E),B||(B=new Map,Q.set(E,B));if(B.has(x))return B;for(B.set(x,null),E=E.getElementsByTagName(x),Q=0;Q<E.length;Q++){var ie=E[Q];if(!(ie[Ce]||ie[ct]||x==="link"&&ie.getAttribute("rel")==="stylesheet")&&ie.namespaceURI!=="http://www.w3.org/2000/svg"){var Ae=ie.getAttribute(w)||"";Ae=x+Ae;var Ue=B.get(Ae);Ue?Ue.push(ie):B.set(Ae,[ie])}}return B}function ty(x,w,E){x=x.ownerDocument||x,x.head.insertBefore(E,w==="title"?x.querySelector("head > title"):null)}function w4(x,w,E){if(E===1||w.itemProp!=null)return!1;switch(x){case"meta":case"title":return!0;case"style":if(typeof w.precedence!="string"||typeof w.href!="string"||w.href==="")break;return!0;case"link":if(typeof w.rel!="string"||typeof w.href!="string"||w.href===""||w.onLoad||w.onError)break;switch(w.rel){case"stylesheet":return x=w.disabled,typeof w.precedence=="string"&&x==null;default:return!0}case"script":if(w.async&&typeof w.async!="function"&&typeof w.async!="symbol"&&!w.onLoad&&!w.onError&&w.src&&typeof w.src=="string")return!0}return!1}function pi(x){return!(x.type==="stylesheet"&&(x.state.loading&3)===0)}var Ai=null;function S4(){}function _4(x,w,E){if(Ai===null)throw Error(n(475));var B=Ai;if(w.type==="stylesheet"&&(typeof E.media!="string"||matchMedia(E.media).matches!==!1)&&(w.state.loading&4)===0){if(w.instance===null){var Q=kf(E.href),ie=x.querySelector(s0(Q));if(ie){x=ie._p,x!==null&&typeof x=="object"&&typeof x.then=="function"&&(B.count++,B=l0.bind(B),x.then(B,B)),w.state.loading|=4,w.instance=ie,Re(ie);return}ie=x.ownerDocument||x,E=Jb(E),(Q=Ho.get(Q))&&o0(E,Q),ie=ie.createElement("link"),Re(ie);var Ae=ie;Ae._p=new Promise(function(Ue,lt){Ae.onload=Ue,Ae.onerror=lt}),hi(ie,"link",E),w.instance=ie}B.stylesheets===null&&(B.stylesheets=new Map),B.stylesheets.set(w,x),(x=w.state.preload)&&(w.state.loading&3)===0&&(B.count++,w=l0.bind(B),x.addEventListener("load",w),x.addEventListener("error",w))}}function A4(){if(Ai===null)throw Error(n(475));var x=Ai;return x.stylesheets&&x.count===0&&m1(x,x.stylesheets),0<x.count?function(w){var E=setTimeout(function(){if(x.stylesheets&&m1(x,x.stylesheets),x.unsuspend){var B=x.unsuspend;x.unsuspend=null,B()}},6e4);return x.unsuspend=w,function(){x.unsuspend=null,clearTimeout(E)}}:null}function l0(){if(this.count--,this.count===0){if(this.stylesheets)m1(this,this.stylesheets);else if(this.unsuspend){var x=this.unsuspend;this.unsuspend=null,x()}}}var rm=null;function m1(x,w){x.stylesheets=null,x.unsuspend!==null&&(x.count++,rm=new Map,w.forEach(C4,x),rm=null,l0.call(x))}function C4(x,w){if(!(w.state.loading&4)){var E=rm.get(x);if(E)var B=E.get(null);else{E=new Map,rm.set(x,E);for(var Q=x.querySelectorAll("link[data-precedence],style[data-precedence]"),ie=0;ie<Q.length;ie++){var Ae=Q[ie];(Ae.nodeName==="LINK"||Ae.getAttribute("media")!=="not all")&&(E.set(Ae.dataset.precedence,Ae),B=Ae)}B&&E.set(null,B)}Q=w.instance,Ae=Q.getAttribute("data-precedence"),ie=E.get(Ae)||B,ie===B&&E.set(null,Q),E.set(Ae,Q),this.count++,B=l0.bind(this),Q.addEventListener("load",B),Q.addEventListener("error",B),ie?ie.parentNode.insertBefore(Q,ie.nextSibling):(x=x.nodeType===9?x.head:x,x.insertBefore(Q,x.firstChild)),w.state.loading|=4}}var Nf={$$typeof:S,Provider:null,Consumer:null,_currentValue:j,_currentValue2:j,_threadCount:0};function j4(x,w,E,B,Q,ie,Ae,Ue){this.tag=1,this.containerInfo=x,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=kr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=kr(0),this.hiddenUpdates=kr(null),this.identifierPrefix=B,this.onUncaughtError=Q,this.onCaughtError=ie,this.onRecoverableError=Ae,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Ue,this.incompleteTransitions=new Map}function ry(x,w,E,B,Q,ie,Ae,Ue,lt,Ot,hr,Sr){return x=new j4(x,w,E,Ae,Ue,lt,Ot,Sr),w=1,ie===!0&&(w|=24),ie=uo(3,null,null,w),x.current=ie,ie.stateNode=x,w=cg(),w.refCount++,x.pooledCache=w,w.refCount++,ie.memoizedState={element:B,isDehydrated:E,cache:w},cd(ie),x}function ny(x){return x?(x=rd,x):rd}function g1(x,w,E,B,Q,ie){Q=ny(Q),B.context===null?B.context=Q:B.pendingContext=Q,B=cu(w),B.payload={element:E},ie=ie===void 0?null:ie,ie!==null&&(B.callback=ie),E=Ec(x,B,w),E!==null&&(Uo(E,x,w),wh(E,x,w))}function v1(x,w){if(x=x.memoizedState,x!==null&&x.dehydrated!==null){var E=x.retryLane;x.retryLane=E!==0&&E<w?E:w}}function x1(x,w){v1(x,w),(x=x.alternate)&&v1(x,w)}function ay(x){if(x.tag===13){var w=td(x,67108864);w!==null&&Uo(w,x,67108864),x1(x,67108864)}}var nm=!0;function k4(x,w,E,B){var Q=_.T;_.T=null;var ie=R.p;try{R.p=2,b1(x,w,E,B)}finally{R.p=ie,_.T=Q}}function Tf(x,w,E,B){var Q=_.T;_.T=null;var ie=R.p;try{R.p=8,b1(x,w,E,B)}finally{R.p=ie,_.T=Q}}function b1(x,w,E,B){if(nm){var Q=y1(B);if(Q===null)zc(x,w,B,am,E),iy(x,B);else if(E4(Q,x,w,E,B))B.stopPropagation();else if(iy(x,B),w&4&&-1<R4.indexOf(x)){for(;Q!==null;){var ie=Se(Q);if(ie!==null)switch(ie.tag){case 3:if(ie=ie.stateNode,ie.current.memoizedState.isDehydrated){var Ae=Ze(ie.pendingLanes);if(Ae!==0){var Ue=ie;for(Ue.pendingLanes|=2,Ue.entangledLanes|=2;Ae;){var lt=1<<31-$t(Ae);Ue.entanglements[1]|=lt,Ae&=~lt}rc(ie),(Ga&6)===0&&(bf=le()+500,e0(0))}}break;case 13:Ue=td(ie,2),Ue!==null&&Uo(Ue,ie,2),$p(),x1(ie,2)}if(ie=y1(B),ie===null&&zc(x,w,B,am,E),ie===Q)break;Q=ie}Q!==null&&B.stopPropagation()}else zc(x,w,B,null,E)}}function y1(x){return x=jn(x),w1(x)}var am=null;function w1(x){if(am=null,x=be(x),x!==null){var w=o(x);if(w===null)x=null;else{var E=w.tag;if(E===13){if(x=i(w),x!==null)return x;x=null}else if(E===3){if(w.stateNode.current.memoizedState.isDehydrated)return w.tag===3?w.stateNode.containerInfo:null;x=null}else w!==x&&(x=null)}}return am=x,null}function sy(x){switch(x){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ke()){case Te:return 2;case pe:return 8;case ye:case ge:return 32;case De:return 268435456;default:return 32}default:return 32}}var sm=!1,$c=null,Cu=null,ju=null,c0=new Map,u0=new Map,ku=[],R4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function iy(x,w){switch(x){case"focusin":case"focusout":$c=null;break;case"dragenter":case"dragleave":Cu=null;break;case"mouseover":case"mouseout":ju=null;break;case"pointerover":case"pointerout":c0.delete(w.pointerId);break;case"gotpointercapture":case"lostpointercapture":u0.delete(w.pointerId)}}function d0(x,w,E,B,Q,ie){return x===null||x.nativeEvent!==ie?(x={blockedOn:w,domEventName:E,eventSystemFlags:B,nativeEvent:ie,targetContainers:[Q]},w!==null&&(w=Se(w),w!==null&&ay(w)),x):(x.eventSystemFlags|=B,w=x.targetContainers,Q!==null&&w.indexOf(Q)===-1&&w.push(Q),x)}function E4(x,w,E,B,Q){switch(w){case"focusin":return $c=d0($c,x,w,E,B,Q),!0;case"dragenter":return Cu=d0(Cu,x,w,E,B,Q),!0;case"mouseover":return ju=d0(ju,x,w,E,B,Q),!0;case"pointerover":var ie=Q.pointerId;return c0.set(ie,d0(c0.get(ie)||null,x,w,E,B,Q)),!0;case"gotpointercapture":return ie=Q.pointerId,u0.set(ie,d0(u0.get(ie)||null,x,w,E,B,Q)),!0}return!1}function oy(x){var w=be(x.target);if(w!==null){var E=o(w);if(E!==null){if(w=E.tag,w===13){if(w=i(E),w!==null){x.blockedOn=w,Dt(x.priority,function(){if(E.tag===13){var B=$i();B=vt(B);var Q=td(E,B);Q!==null&&Uo(Q,E,B),x1(E,B)}});return}}else if(w===3&&E.stateNode.current.memoizedState.isDehydrated){x.blockedOn=E.tag===3?E.stateNode.containerInfo:null;return}}}x.blockedOn=null}function im(x){if(x.blockedOn!==null)return!1;for(var w=x.targetContainers;0<w.length;){var E=y1(x.nativeEvent);if(E===null){E=x.nativeEvent;var B=new E.constructor(E.type,E);sr=B,E.target.dispatchEvent(B),sr=null}else return w=Se(E),w!==null&&ay(w),x.blockedOn=E,!1;w.shift()}return!0}function ly(x,w,E){im(x)&&E.delete(w)}function N4(){sm=!1,$c!==null&&im($c)&&($c=null),Cu!==null&&im(Cu)&&(Cu=null),ju!==null&&im(ju)&&(ju=null),c0.forEach(ly),u0.forEach(ly)}function om(x,w){x.blockedOn===w&&(x.blockedOn=null,sm||(sm=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,N4)))}var lm=null;function cy(x){lm!==x&&(lm=x,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){lm===x&&(lm=null);for(var w=0;w<x.length;w+=3){var E=x[w],B=x[w+1],Q=x[w+2];if(typeof B!="function"){if(w1(B||E)===null)continue;break}var ie=Se(E);ie!==null&&(x.splice(w,3),w-=3,Lh(ie,{pending:!0,data:Q,method:E.method,action:B},B,Q))}}))}function f0(x){function w(lt){return om(lt,x)}$c!==null&&om($c,x),Cu!==null&&om(Cu,x),ju!==null&&om(ju,x),c0.forEach(w),u0.forEach(w);for(var E=0;E<ku.length;E++){var B=ku[E];B.blockedOn===x&&(B.blockedOn=null)}for(;0<ku.length&&(E=ku[0],E.blockedOn===null);)oy(E),E.blockedOn===null&&ku.shift();if(E=(x.ownerDocument||x).$$reactFormReplay,E!=null)for(B=0;B<E.length;B+=3){var Q=E[B],ie=E[B+1],Ae=Q[nt]||null;if(typeof ie=="function")Ae||cy(E);else if(Ae){var Ue=null;if(ie&&ie.hasAttribute("formAction")){if(Q=ie,Ae=ie[nt]||null)Ue=Ae.formAction;else if(w1(Q)!==null)continue}else Ue=Ae.action;typeof Ue=="function"?E[B+1]=Ue:(E.splice(B,3),B-=3),cy(E)}}}function S1(x){this._internalRoot=x}cm.prototype.render=S1.prototype.render=function(x){var w=this._internalRoot;if(w===null)throw Error(n(409));var E=w.current,B=$i();g1(E,B,x,w,null,null)},cm.prototype.unmount=S1.prototype.unmount=function(){var x=this._internalRoot;if(x!==null){this._internalRoot=null;var w=x.containerInfo;g1(x.current,2,null,x,null,null),$p(),w[Pe]=null}};function cm(x){this._internalRoot=x}cm.prototype.unstable_scheduleHydration=function(x){if(x){var w=Cr();x={blockedOn:null,target:x,priority:w};for(var E=0;E<ku.length&&w!==0&&w<ku[E].priority;E++);ku.splice(E,0,x),E===0&&oy(x)}};var uy=r.version;if(uy!=="19.1.0")throw Error(n(527,uy,"19.1.0"));R.findDOMNode=function(x){var w=x._reactInternals;if(w===void 0)throw typeof x.render=="function"?Error(n(188)):(x=Object.keys(x).join(","),Error(n(268,x)));return x=u(w),x=x!==null?l(x):null,x=x===null?null:x.stateNode,x};var T4={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:_,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var um=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!um.isDisabled&&um.supportsFiber)try{at=um.inject(T4),dt=um}catch{}}return C1.createRoot=function(x,w){if(!s(x))throw Error(n(299));var E=!1,B="",Q=Ig,ie=kp,Ae=Xx,Ue=null;return w!=null&&(w.unstable_strictMode===!0&&(E=!0),w.identifierPrefix!==void 0&&(B=w.identifierPrefix),w.onUncaughtError!==void 0&&(Q=w.onUncaughtError),w.onCaughtError!==void 0&&(ie=w.onCaughtError),w.onRecoverableError!==void 0&&(Ae=w.onRecoverableError),w.unstable_transitionCallbacks!==void 0&&(Ue=w.unstable_transitionCallbacks)),w=ry(x,1,!1,null,null,E,B,Q,ie,Ae,Ue,null),x[Pe]=w.current,c1(x),new S1(w)},C1.hydrateRoot=function(x,w,E){if(!s(x))throw Error(n(299));var B=!1,Q="",ie=Ig,Ae=kp,Ue=Xx,lt=null,Ot=null;return E!=null&&(E.unstable_strictMode===!0&&(B=!0),E.identifierPrefix!==void 0&&(Q=E.identifierPrefix),E.onUncaughtError!==void 0&&(ie=E.onUncaughtError),E.onCaughtError!==void 0&&(Ae=E.onCaughtError),E.onRecoverableError!==void 0&&(Ue=E.onRecoverableError),E.unstable_transitionCallbacks!==void 0&&(lt=E.unstable_transitionCallbacks),E.formState!==void 0&&(Ot=E.formState)),w=ry(x,1,!0,w,E??null,B,Q,ie,Ae,Ue,lt,Ot),w.context=ny(null),E=w.current,B=$i(),B=vt(B),Q=cu(B),Q.callback=null,Ec(E,Q,B),E=B,w.current.lanes=E,Jt(w,E),rc(w),x[Pe]=w.current,c1(x),new cm(w)},C1.version="19.1.0",C1}var r5;function FN(){if(r5)return P4.exports;r5=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),P4.exports=PN(),P4.exports}var BN=FN(),j1={},n5;function zN(){if(n5)return j1;n5=1,Object.defineProperty(j1,"__esModule",{value:!0}),j1.parse=i,j1.serialize=l;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,r=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,s=Object.prototype.toString,o=(()=>{const f=function(){};return f.prototype=Object.create(null),f})();function i(f,p){const v=new o,g=f.length;if(g<2)return v;const m=(p==null?void 0:p.decode)||d;let b=0;do{const y=f.indexOf("=",b);if(y===-1)break;const S=f.indexOf(";",b),C=S===-1?g:S;if(y>C){b=f.lastIndexOf(";",y-1)+1;continue}const L=c(f,b,y),O=u(f,y,L),H=f.slice(L,O);if(v[H]===void 0){let z=c(f,y+1,C),q=u(f,C,z);const D=m(f.slice(z,q));v[H]=D}b=C+1}while(b<g);return v}function c(f,p,v){do{const g=f.charCodeAt(p);if(g!==32&&g!==9)return p}while(++p<v);return v}function u(f,p,v){for(;p>v;){const g=f.charCodeAt(--p);if(g!==32&&g!==9)return p+1}return v}function l(f,p,v){const g=(v==null?void 0:v.encode)||encodeURIComponent;if(!e.test(f))throw new TypeError(`argument name is invalid: ${f}`);const m=g(p);if(!r.test(m))throw new TypeError(`argument val is invalid: ${p}`);let b=f+"="+m;if(!v)return b;if(v.maxAge!==void 0){if(!Number.isInteger(v.maxAge))throw new TypeError(`option maxAge is invalid: ${v.maxAge}`);b+="; Max-Age="+v.maxAge}if(v.domain){if(!t.test(v.domain))throw new TypeError(`option domain is invalid: ${v.domain}`);b+="; Domain="+v.domain}if(v.path){if(!n.test(v.path))throw new TypeError(`option path is invalid: ${v.path}`);b+="; Path="+v.path}if(v.expires){if(!h(v.expires)||!Number.isFinite(v.expires.valueOf()))throw new TypeError(`option expires is invalid: ${v.expires}`);b+="; Expires="+v.expires.toUTCString()}if(v.httpOnly&&(b+="; HttpOnly"),v.secure&&(b+="; Secure"),v.partitioned&&(b+="; Partitioned"),v.priority)switch(typeof v.priority=="string"?v.priority.toLowerCase():void 0){case"low":b+="; Priority=Low";break;case"medium":b+="; Priority=Medium";break;case"high":b+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${v.priority}`)}if(v.sameSite)switch(typeof v.sameSite=="string"?v.sameSite.toLowerCase():v.sameSite){case!0:case"strict":b+="; SameSite=Strict";break;case"lax":b+="; SameSite=Lax";break;case"none":b+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${v.sameSite}`)}return b}function d(f){if(f.indexOf("%")===-1)return f;try{return decodeURIComponent(f)}catch{return f}}function h(f){return s.call(f)==="[object Date]"}return j1}zN();var a5="popstate";function $N(e={}){function r(n,s){let{pathname:o,search:i,hash:c}=n.location;return nS("",{pathname:o,search:i,hash:c},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(n,s){return typeof s=="string"?s:Sv(s)}return HN(r,t,null,e)}function Ks(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}function Hu(e,r){if(!e){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function UN(){return Math.random().toString(36).substring(2,10)}function s5(e,r){return{usr:e.state,key:e.key,idx:r}}function nS(e,r,t=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof r=="string"?Wm(r):r,state:t,key:r&&r.key||n||UN()}}function Sv({pathname:e="/",search:r="",hash:t=""}){return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),t&&t!=="#"&&(e+=t.charAt(0)==="#"?t:"#"+t),e}function Wm(e){let r={};if(e){let t=e.indexOf("#");t>=0&&(r.hash=e.substring(t),e=e.substring(0,t));let n=e.indexOf("?");n>=0&&(r.search=e.substring(n),e=e.substring(0,n)),e&&(r.pathname=e)}return r}function HN(e,r,t,n={}){let{window:s=document.defaultView,v5Compat:o=!1}=n,i=s.history,c="POP",u=null,l=d();l==null&&(l=0,i.replaceState({...i.state,idx:l},""));function d(){return(i.state||{idx:null}).idx}function h(){c="POP";let m=d(),b=m==null?null:m-l;l=m,u&&u({action:c,location:g.location,delta:b})}function f(m,b){c="PUSH";let y=nS(g.location,m,b);l=d()+1;let S=s5(y,l),C=g.createHref(y);try{i.pushState(S,"",C)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;s.location.assign(C)}o&&u&&u({action:c,location:g.location,delta:1})}function p(m,b){c="REPLACE";let y=nS(g.location,m,b);l=d();let S=s5(y,l),C=g.createHref(y);i.replaceState(S,"",C),o&&u&&u({action:c,location:g.location,delta:0})}function v(m){return VN(m)}let g={get action(){return c},get location(){return e(s,i)},listen(m){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(a5,h),u=m,()=>{s.removeEventListener(a5,h),u=null}},createHref(m){return r(s,m)},createURL:v,encodeLocation(m){let b=v(m);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:f,replace:p,go(m){return i.go(m)}};return g}function VN(e,r=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Ks(t,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:Sv(e);return n=n.replace(/ $/,"%20"),!r&&n.startsWith("//")&&(n=t+n),new URL(n,t)}function Bj(e,r,t="/"){return WN(e,r,t,!1)}function WN(e,r,t,n){let s=typeof r=="string"?Wm(r):r,o=Dd(s.pathname||"/",t);if(o==null)return null;let i=zj(e);qN(i);let c=null;for(let u=0;c==null&&u<i.length;++u){let l=nT(o);c=tT(i[u],l,n)}return c}function zj(e,r=[],t=[],n=""){let s=(o,i,c)=>{let u={relativePath:c===void 0?o.path||"":c,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};u.relativePath.startsWith("/")&&(Ks(u.relativePath.startsWith(n),`Absolute route path "${u.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(n.length));let l=Ed([n,u.relativePath]),d=t.concat(u);o.children&&o.children.length>0&&(Ks(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${l}".`),zj(o.children,r,d,l)),!(o.path==null&&!o.index)&&r.push({path:l,score:QN(l,o.index),routesMeta:d})};return e.forEach((o,i)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))s(o,i);else for(let u of $j(o.path))s(o,i,u)}),r}function $j(e){let r=e.split("/");if(r.length===0)return[];let[t,...n]=r,s=t.endsWith("?"),o=t.replace(/\?$/,"");if(n.length===0)return s?[o,""]:[o];let i=$j(n.join("/")),c=[];return c.push(...i.map(u=>u===""?o:[o,u].join("/"))),s&&c.push(...i),c.map(u=>e.startsWith("/")&&u===""?"/":u)}function qN(e){e.sort((r,t)=>r.score!==t.score?t.score-r.score:eT(r.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var GN=/^:[\w-]+$/,KN=3,XN=2,YN=1,ZN=10,JN=-2,i5=e=>e==="*";function QN(e,r){let t=e.split("/"),n=t.length;return t.some(i5)&&(n+=JN),r&&(n+=XN),t.filter(s=>!i5(s)).reduce((s,o)=>s+(GN.test(o)?KN:o===""?YN:ZN),n)}function eT(e,r){return e.length===r.length&&e.slice(0,-1).every((n,s)=>n===r[s])?e[e.length-1]-r[r.length-1]:0}function tT(e,r,t=!1){let{routesMeta:n}=e,s={},o="/",i=[];for(let c=0;c<n.length;++c){let u=n[c],l=c===n.length-1,d=o==="/"?r:r.slice(o.length)||"/",h=n2({path:u.relativePath,caseSensitive:u.caseSensitive,end:l},d),f=u.route;if(!h&&l&&t&&!n[n.length-1].route.index&&(h=n2({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},d)),!h)return null;Object.assign(s,h.params),i.push({params:s,pathname:Ed([o,h.pathname]),pathnameBase:oT(Ed([o,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(o=Ed([o,h.pathnameBase]))}return i}function n2(e,r){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,n]=rT(e.path,e.caseSensitive,e.end),s=r.match(t);if(!s)return null;let o=s[0],i=o.replace(/(.)\/+$/,"$1"),c=s.slice(1);return{params:n.reduce((l,{paramName:d,isOptional:h},f)=>{if(d==="*"){let v=c[f]||"";i=o.slice(0,o.length-v.length).replace(/(.)\/+$/,"$1")}const p=c[f];return h&&!p?l[d]=void 0:l[d]=(p||"").replace(/%2F/g,"/"),l},{}),pathname:o,pathnameBase:i,pattern:e}}function rT(e,r=!1,t=!0){Hu(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,c,u)=>(n.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,r?void 0:"i"),n]}function nT(e){try{return e.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return Hu(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${r}).`),e}}function Dd(e,r){if(r==="/")return e;if(!e.toLowerCase().startsWith(r.toLowerCase()))return null;let t=r.endsWith("/")?r.length-1:r.length,n=e.charAt(t);return n&&n!=="/"?null:e.slice(t)||"/"}function aT(e,r="/"){let{pathname:t,search:n="",hash:s=""}=typeof e=="string"?Wm(e):e;return{pathname:t?t.startsWith("/")?t:sT(t,r):r,search:lT(n),hash:cT(s)}}function sT(e,r){let t=r.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function $4(e,r,t,n){return`Cannot include a '${e}' character in a manually specified \`to.${r}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function iT(e){return e.filter((r,t)=>t===0||r.route.path&&r.route.path.length>0)}function Uj(e){let r=iT(e);return r.map((t,n)=>n===r.length-1?t.pathname:t.pathnameBase)}function Hj(e,r,t,n=!1){let s;typeof e=="string"?s=Wm(e):(s={...e},Ks(!s.pathname||!s.pathname.includes("?"),$4("?","pathname","search",s)),Ks(!s.pathname||!s.pathname.includes("#"),$4("#","pathname","hash",s)),Ks(!s.search||!s.search.includes("#"),$4("#","search","hash",s)));let o=e===""||s.pathname==="",i=o?"/":s.pathname,c;if(i==null)c=t;else{let h=r.length-1;if(!n&&i.startsWith("..")){let f=i.split("/");for(;f[0]==="..";)f.shift(),h-=1;s.pathname=f.join("/")}c=h>=0?r[h]:"/"}let u=aT(s,c),l=i&&i!=="/"&&i.endsWith("/"),d=(o||i===".")&&t.endsWith("/");return!u.pathname.endsWith("/")&&(l||d)&&(u.pathname+="/"),u}var Ed=e=>e.join("/").replace(/\/\/+/g,"/"),oT=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),lT=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,cT=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function uT(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var Vj=["POST","PUT","PATCH","DELETE"];new Set(Vj);var dT=["GET",...Vj];new Set(dT);var qm=G.createContext(null);qm.displayName="DataRouter";var G2=G.createContext(null);G2.displayName="DataRouterState";var Wj=G.createContext({isTransitioning:!1});Wj.displayName="ViewTransition";var fT=G.createContext(new Map);fT.displayName="Fetchers";var hT=G.createContext(null);hT.displayName="Await";var Wu=G.createContext(null);Wu.displayName="Navigation";var Yv=G.createContext(null);Yv.displayName="Location";var qu=G.createContext({outlet:null,matches:[],isDataRoute:!1});qu.displayName="Route";var e6=G.createContext(null);e6.displayName="RouteError";function pT(e,{relative:r}={}){Ks(Zv(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=G.useContext(Wu),{hash:s,pathname:o,search:i}=Qv(e,{relative:r}),c=o;return t!=="/"&&(c=o==="/"?t:Ed([t,o])),n.createHref({pathname:c,search:i,hash:s})}function Zv(){return G.useContext(Yv)!=null}function qf(){return Ks(Zv(),"useLocation() may be used only in the context of a <Router> component."),G.useContext(Yv).location}var qj="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Gj(e){G.useContext(Wu).static||G.useLayoutEffect(e)}function ii(){let{isDataRoute:e}=G.useContext(qu);return e?kT():mT()}function mT(){Ks(Zv(),"useNavigate() may be used only in the context of a <Router> component.");let e=G.useContext(qm),{basename:r,navigator:t}=G.useContext(Wu),{matches:n}=G.useContext(qu),{pathname:s}=qf(),o=JSON.stringify(Uj(n)),i=G.useRef(!1);return Gj(()=>{i.current=!0}),G.useCallback((u,l={})=>{if(Hu(i.current,qj),!i.current)return;if(typeof u=="number"){t.go(u);return}let d=Hj(u,JSON.parse(o),s,l.relative==="path");e==null&&r!=="/"&&(d.pathname=d.pathname==="/"?r:Ed([r,d.pathname])),(l.replace?t.replace:t.push)(d,l.state,l)},[r,t,o,s,e])}G.createContext(null);function Jv(){let{matches:e}=G.useContext(qu),r=e[e.length-1];return r?r.params:{}}function Qv(e,{relative:r}={}){let{matches:t}=G.useContext(qu),{pathname:n}=qf(),s=JSON.stringify(Uj(t));return G.useMemo(()=>Hj(e,JSON.parse(s),n,r==="path"),[e,s,n,r])}function gT(e,r){return Kj(e,r)}function Kj(e,r,t,n){var b;Ks(Zv(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=G.useContext(Wu),{matches:o}=G.useContext(qu),i=o[o.length-1],c=i?i.params:{},u=i?i.pathname:"/",l=i?i.pathnameBase:"/",d=i&&i.route;{let y=d&&d.path||"";Xj(u,!d||y.endsWith("*")||y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${y}"> to <Route path="${y==="/"?"*":`${y}/*`}">.`)}let h=qf(),f;if(r){let y=typeof r=="string"?Wm(r):r;Ks(l==="/"||((b=y.pathname)==null?void 0:b.startsWith(l)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${l}" but pathname "${y.pathname}" was given in the \`location\` prop.`),f=y}else f=h;let p=f.pathname||"/",v=p;if(l!=="/"){let y=l.replace(/^\//,"").split("/");v="/"+p.replace(/^\//,"").split("/").slice(y.length).join("/")}let g=Bj(e,{pathname:v});Hu(d||g!=null,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),Hu(g==null||g[g.length-1].route.element!==void 0||g[g.length-1].route.Component!==void 0||g[g.length-1].route.lazy!==void 0,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let m=wT(g&&g.map(y=>Object.assign({},y,{params:Object.assign({},c,y.params),pathname:Ed([l,s.encodeLocation?s.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?l:Ed([l,s.encodeLocation?s.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),o,t,n);return r&&m?G.createElement(Yv.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...f},navigationType:"POP"}},m):m}function vT(){let e=jT(),r=uT(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),t=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},o={padding:"2px 4px",backgroundColor:n},i=null;return console.error("Error handled by React Router default ErrorBoundary:",e),i=G.createElement(G.Fragment,null,G.createElement("p",null," Hey developer "),G.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",G.createElement("code",{style:o},"ErrorBoundary")," or"," ",G.createElement("code",{style:o},"errorElement")," prop on your route.")),G.createElement(G.Fragment,null,G.createElement("h2",null,"Unexpected Application Error!"),G.createElement("h3",{style:{fontStyle:"italic"}},r),t?G.createElement("pre",{style:s},t):null,i)}var xT=G.createElement(vT,null),bT=class extends G.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?G.createElement(qu.Provider,{value:this.props.routeContext},G.createElement(e6.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function yT({routeContext:e,match:r,children:t}){let n=G.useContext(qm);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),G.createElement(qu.Provider,{value:e},t)}function wT(e,r=[],t=null,n=null){if(e==null){if(!t)return null;if(t.errors)e=t.matches;else if(r.length===0&&!t.initialized&&t.matches.length>0)e=t.matches;else return null}let s=e,o=t==null?void 0:t.errors;if(o!=null){let u=s.findIndex(l=>l.route.id&&(o==null?void 0:o[l.route.id])!==void 0);Ks(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),s=s.slice(0,Math.min(s.length,u+1))}let i=!1,c=-1;if(t)for(let u=0;u<s.length;u++){let l=s[u];if((l.route.HydrateFallback||l.route.hydrateFallbackElement)&&(c=u),l.route.id){let{loaderData:d,errors:h}=t,f=l.route.loader&&!d.hasOwnProperty(l.route.id)&&(!h||h[l.route.id]===void 0);if(l.route.lazy||f){i=!0,c>=0?s=s.slice(0,c+1):s=[s[0]];break}}}return s.reduceRight((u,l,d)=>{let h,f=!1,p=null,v=null;t&&(h=o&&l.route.id?o[l.route.id]:void 0,p=l.route.errorElement||xT,i&&(c<0&&d===0?(Xj("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),f=!0,v=null):c===d&&(f=!0,v=l.route.hydrateFallbackElement||null)));let g=r.concat(s.slice(0,d+1)),m=()=>{let b;return h?b=p:f?b=v:l.route.Component?b=G.createElement(l.route.Component,null):l.route.element?b=l.route.element:b=u,G.createElement(yT,{match:l,routeContext:{outlet:u,matches:g,isDataRoute:t!=null},children:b})};return t&&(l.route.ErrorBoundary||l.route.errorElement||d===0)?G.createElement(bT,{location:t.location,revalidation:t.revalidation,component:p,error:h,children:m(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):m()},null)}function t6(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ST(e){let r=G.useContext(qm);return Ks(r,t6(e)),r}function _T(e){let r=G.useContext(G2);return Ks(r,t6(e)),r}function AT(e){let r=G.useContext(qu);return Ks(r,t6(e)),r}function r6(e){let r=AT(e),t=r.matches[r.matches.length-1];return Ks(t.route.id,`${e} can only be used on routes that contain a unique "id"`),t.route.id}function CT(){return r6("useRouteId")}function jT(){var n;let e=G.useContext(e6),r=_T("useRouteError"),t=r6("useRouteError");return e!==void 0?e:(n=r.errors)==null?void 0:n[t]}function kT(){let{router:e}=ST("useNavigate"),r=r6("useNavigate"),t=G.useRef(!1);return Gj(()=>{t.current=!0}),G.useCallback(async(s,o={})=>{Hu(t.current,qj),t.current&&(typeof s=="number"?e.navigate(s):await e.navigate(s,{fromRouteId:r,...o}))},[e,r])}var o5={};function Xj(e,r,t){!r&&!o5[e]&&(o5[e]=!0,Hu(!1,t))}G.memo(RT);function RT({routes:e,future:r,state:t}){return Kj(e,void 0,t,r)}function zn(e){Ks(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function ET({basename:e="/",children:r=null,location:t,navigationType:n="POP",navigator:s,static:o=!1}){Ks(!Zv(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let i=e.replace(/^\/*/,"/"),c=G.useMemo(()=>({basename:i,navigator:s,static:o,future:{}}),[i,s,o]);typeof t=="string"&&(t=Wm(t));let{pathname:u="/",search:l="",hash:d="",state:h=null,key:f="default"}=t,p=G.useMemo(()=>{let v=Dd(u,i);return v==null?null:{location:{pathname:v,search:l,hash:d,state:h,key:f},navigationType:n}},[i,u,l,d,h,f,n]);return Hu(p!=null,`<Router basename="${i}"> is not able to match the URL "${u}${l}${d}" because it does not start with the basename, so the <Router> won't render anything.`),p==null?null:G.createElement(Wu.Provider,{value:c},G.createElement(Yv.Provider,{children:r,value:p}))}function NT({children:e,location:r}){return gT(aS(e),r)}function aS(e,r=[]){let t=[];return G.Children.forEach(e,(n,s)=>{if(!G.isValidElement(n))return;let o=[...r,s];if(n.type===G.Fragment){t.push.apply(t,aS(n.props.children,o));return}Ks(n.type===zn,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ks(!n.props.index||!n.props.children,"An index route cannot have child routes.");let i={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=aS(n.props.children,o)),t.push(i)}),t}var Hy="get",Vy="application/x-www-form-urlencoded";function K2(e){return e!=null&&typeof e.tagName=="string"}function TT(e){return K2(e)&&e.tagName.toLowerCase()==="button"}function LT(e){return K2(e)&&e.tagName.toLowerCase()==="form"}function MT(e){return K2(e)&&e.tagName.toLowerCase()==="input"}function DT(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function IT(e,r){return e.button===0&&(!r||r==="_self")&&!DT(e)}var dy=null;function OT(){if(dy===null)try{new FormData(document.createElement("form"),0),dy=!1}catch{dy=!0}return dy}var PT=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function U4(e){return e!=null&&!PT.has(e)?(Hu(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Vy}"`),null):e}function FT(e,r){let t,n,s,o,i;if(LT(e)){let c=e.getAttribute("action");n=c?Dd(c,r):null,t=e.getAttribute("method")||Hy,s=U4(e.getAttribute("enctype"))||Vy,o=new FormData(e)}else if(TT(e)||MT(e)&&(e.type==="submit"||e.type==="image")){let c=e.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=e.getAttribute("formaction")||c.getAttribute("action");if(n=u?Dd(u,r):null,t=e.getAttribute("formmethod")||c.getAttribute("method")||Hy,s=U4(e.getAttribute("formenctype"))||U4(c.getAttribute("enctype"))||Vy,o=new FormData(c,e),!OT()){let{name:l,type:d,value:h}=e;if(d==="image"){let f=l?`${l}.`:"";o.append(`${f}x`,"0"),o.append(`${f}y`,"0")}else l&&o.append(l,h)}}else{if(K2(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Hy,n=null,s=Vy,i=e}return o&&s==="text/plain"&&(i=o,o=void 0),{action:n,method:t.toLowerCase(),encType:s,formData:o,body:i}}function n6(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}async function BT(e,r){if(e.id in r)return r[e.id];try{let t=await import(e.module);return r[e.id]=t,t}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function zT(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function $T(e,r,t){let n=await Promise.all(e.map(async s=>{let o=r.routes[s.route.id];if(o){let i=await BT(o,t);return i.links?i.links():[]}return[]}));return WT(n.flat(1).filter(zT).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function l5(e,r,t,n,s,o){let i=(u,l)=>t[l]?u.route.id!==t[l].route.id:!0,c=(u,l)=>{var d;return t[l].pathname!==u.pathname||((d=t[l].route.path)==null?void 0:d.endsWith("*"))&&t[l].params["*"]!==u.params["*"]};return o==="assets"?r.filter((u,l)=>i(u,l)||c(u,l)):o==="data"?r.filter((u,l)=>{var h;let d=n.routes[u.route.id];if(!d||!d.hasLoader)return!1;if(i(u,l)||c(u,l))return!0;if(u.route.shouldRevalidate){let f=u.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((h=t[0])==null?void 0:h.params)||{},nextUrl:new URL(e,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function UT(e,r,{includeHydrateFallback:t}={}){return HT(e.map(n=>{let s=r.routes[n.route.id];if(!s)return[];let o=[s.module];return s.clientActionModule&&(o=o.concat(s.clientActionModule)),s.clientLoaderModule&&(o=o.concat(s.clientLoaderModule)),t&&s.hydrateFallbackModule&&(o=o.concat(s.hydrateFallbackModule)),s.imports&&(o=o.concat(s.imports)),o}).flat(1))}function HT(e){return[...new Set(e)]}function VT(e){let r={},t=Object.keys(e).sort();for(let n of t)r[n]=e[n];return r}function WT(e,r){let t=new Set;return new Set(r),e.reduce((n,s)=>{let o=JSON.stringify(VT(s));return t.has(o)||(t.add(o),n.push({key:o,link:s})),n},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var qT=new Set([100,101,204,205]);function GT(e,r){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":r&&Dd(t.pathname,r)==="/"?t.pathname=`${r.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function Yj(){let e=G.useContext(qm);return n6(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function KT(){let e=G.useContext(G2);return n6(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var a6=G.createContext(void 0);a6.displayName="FrameworkContext";function Zj(){let e=G.useContext(a6);return n6(e,"You must render this element inside a <HydratedRouter> element"),e}function XT(e,r){let t=G.useContext(a6),[n,s]=G.useState(!1),[o,i]=G.useState(!1),{onFocus:c,onBlur:u,onMouseEnter:l,onMouseLeave:d,onTouchStart:h}=r,f=G.useRef(null);G.useEffect(()=>{if(e==="render"&&i(!0),e==="viewport"){let g=b=>{b.forEach(y=>{i(y.isIntersecting)})},m=new IntersectionObserver(g,{threshold:.5});return f.current&&m.observe(f.current),()=>{m.disconnect()}}},[e]),G.useEffect(()=>{if(n){let g=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(g)}}},[n]);let p=()=>{s(!0)},v=()=>{s(!1),i(!1)};return t?e!=="intent"?[o,f,{}]:[o,f,{onFocus:k1(c,p),onBlur:k1(u,v),onMouseEnter:k1(l,p),onMouseLeave:k1(d,v),onTouchStart:k1(h,p)}]:[!1,f,{}]}function k1(e,r){return t=>{e&&e(t),t.defaultPrevented||r(t)}}function YT({page:e,...r}){let{router:t}=Yj(),n=G.useMemo(()=>Bj(t.routes,e,t.basename),[t.routes,e,t.basename]);return n?G.createElement(JT,{page:e,matches:n,...r}):null}function ZT(e){let{manifest:r,routeModules:t}=Zj(),[n,s]=G.useState([]);return G.useEffect(()=>{let o=!1;return $T(e,r,t).then(i=>{o||s(i)}),()=>{o=!0}},[e,r,t]),n}function JT({page:e,matches:r,...t}){let n=qf(),{manifest:s,routeModules:o}=Zj(),{basename:i}=Yj(),{loaderData:c,matches:u}=KT(),l=G.useMemo(()=>l5(e,r,u,s,n,"data"),[e,r,u,s,n]),d=G.useMemo(()=>l5(e,r,u,s,n,"assets"),[e,r,u,s,n]),h=G.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let v=new Set,g=!1;if(r.forEach(b=>{var S;let y=s.routes[b.route.id];!y||!y.hasLoader||(!l.some(C=>C.route.id===b.route.id)&&b.route.id in c&&((S=o[b.route.id])!=null&&S.shouldRevalidate)||y.hasClientLoader?g=!0:v.add(b.route.id))}),v.size===0)return[];let m=GT(e,i);return g&&v.size>0&&m.searchParams.set("_routes",r.filter(b=>v.has(b.route.id)).map(b=>b.route.id).join(",")),[m.pathname+m.search]},[i,c,n,s,l,r,e,o]),f=G.useMemo(()=>UT(d,s),[d,s]),p=ZT(d);return G.createElement(G.Fragment,null,h.map(v=>G.createElement("link",{key:v,rel:"prefetch",as:"fetch",href:v,...t})),f.map(v=>G.createElement("link",{key:v,rel:"modulepreload",href:v,...t})),p.map(({key:v,link:g})=>G.createElement("link",{key:v,...g})))}function QT(...e){return r=>{e.forEach(t=>{typeof t=="function"?t(r):t!=null&&(t.current=r)})}}var Jj=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Jj&&(window.__reactRouterVersion="7.6.1")}catch{}function eL({basename:e,children:r,window:t}){let n=G.useRef();n.current==null&&(n.current=$N({window:t,v5Compat:!0}));let s=n.current,[o,i]=G.useState({action:s.action,location:s.location}),c=G.useCallback(u=>{G.startTransition(()=>i(u))},[i]);return G.useLayoutEffect(()=>s.listen(c),[s,c]),G.createElement(ET,{basename:e,children:r,location:o.location,navigationType:o.action,navigator:s})}var Qj=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,_v=G.forwardRef(function({onClick:r,discover:t="render",prefetch:n="none",relative:s,reloadDocument:o,replace:i,state:c,target:u,to:l,preventScrollReset:d,viewTransition:h,...f},p){let{basename:v}=G.useContext(Wu),g=typeof l=="string"&&Qj.test(l),m,b=!1;if(typeof l=="string"&&g&&(m=l,Jj))try{let q=new URL(window.location.href),D=l.startsWith("//")?new URL(q.protocol+l):new URL(l),W=Dd(D.pathname,v);D.origin===q.origin&&W!=null?l=W+D.search+D.hash:b=!0}catch{Hu(!1,`<Link to="${l}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let y=pT(l,{relative:s}),[S,C,L]=XT(n,f),O=aL(l,{replace:i,state:c,target:u,preventScrollReset:d,relative:s,viewTransition:h});function H(q){r&&r(q),q.defaultPrevented||O(q)}let z=G.createElement("a",{...f,...L,href:m||y,onClick:b||o?r:H,ref:QT(p,C),target:u,"data-discover":!g&&t==="render"?"true":void 0});return S&&!g?G.createElement(G.Fragment,null,z,G.createElement(YT,{page:y})):z});_v.displayName="Link";var tL=G.forwardRef(function({"aria-current":r="page",caseSensitive:t=!1,className:n="",end:s=!1,style:o,to:i,viewTransition:c,children:u,...l},d){let h=Qv(i,{relative:l.relative}),f=qf(),p=G.useContext(G2),{navigator:v,basename:g}=G.useContext(Wu),m=p!=null&&cL(h)&&c===!0,b=v.encodeLocation?v.encodeLocation(h).pathname:h.pathname,y=f.pathname,S=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;t||(y=y.toLowerCase(),S=S?S.toLowerCase():null,b=b.toLowerCase()),S&&g&&(S=Dd(S,g)||S);const C=b!=="/"&&b.endsWith("/")?b.length-1:b.length;let L=y===b||!s&&y.startsWith(b)&&y.charAt(C)==="/",O=S!=null&&(S===b||!s&&S.startsWith(b)&&S.charAt(b.length)==="/"),H={isActive:L,isPending:O,isTransitioning:m},z=L?r:void 0,q;typeof n=="function"?q=n(H):q=[n,L?"active":null,O?"pending":null,m?"transitioning":null].filter(Boolean).join(" ");let D=typeof o=="function"?o(H):o;return G.createElement(_v,{...l,"aria-current":z,className:q,ref:d,style:D,to:i,viewTransition:c},typeof u=="function"?u(H):u)});tL.displayName="NavLink";var rL=G.forwardRef(({discover:e="render",fetcherKey:r,navigate:t,reloadDocument:n,replace:s,state:o,method:i=Hy,action:c,onSubmit:u,relative:l,preventScrollReset:d,viewTransition:h,...f},p)=>{let v=oL(),g=lL(c,{relative:l}),m=i.toLowerCase()==="get"?"get":"post",b=typeof c=="string"&&Qj.test(c),y=S=>{if(u&&u(S),S.defaultPrevented)return;S.preventDefault();let C=S.nativeEvent.submitter,L=(C==null?void 0:C.getAttribute("formmethod"))||i;v(C||S.currentTarget,{fetcherKey:r,method:L,navigate:t,replace:s,state:o,relative:l,preventScrollReset:d,viewTransition:h})};return G.createElement("form",{ref:p,method:m,action:g,onSubmit:n?u:y,...f,"data-discover":!b&&e==="render"?"true":void 0})});rL.displayName="Form";function nL(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ek(e){let r=G.useContext(qm);return Ks(r,nL(e)),r}function aL(e,{target:r,replace:t,state:n,preventScrollReset:s,relative:o,viewTransition:i}={}){let c=ii(),u=qf(),l=Qv(e,{relative:o});return G.useCallback(d=>{if(IT(d,r)){d.preventDefault();let h=t!==void 0?t:Sv(u)===Sv(l);c(e,{replace:h,state:n,preventScrollReset:s,relative:o,viewTransition:i})}},[u,c,l,t,n,r,e,s,o,i])}var sL=0,iL=()=>`__${String(++sL)}__`;function oL(){let{router:e}=ek("useSubmit"),{basename:r}=G.useContext(Wu),t=CT();return G.useCallback(async(n,s={})=>{let{action:o,method:i,encType:c,formData:u,body:l}=FT(n,r);if(s.navigate===!1){let d=s.fetcherKey||iL();await e.fetch(d,t,s.action||o,{preventScrollReset:s.preventScrollReset,formData:u,body:l,formMethod:s.method||i,formEncType:s.encType||c,flushSync:s.flushSync})}else await e.navigate(s.action||o,{preventScrollReset:s.preventScrollReset,formData:u,body:l,formMethod:s.method||i,formEncType:s.encType||c,replace:s.replace,state:s.state,fromRouteId:t,flushSync:s.flushSync,viewTransition:s.viewTransition})},[e,r,t])}function lL(e,{relative:r}={}){let{basename:t}=G.useContext(Wu),n=G.useContext(qu);Ks(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),o={...Qv(e||".",{relative:r})},i=qf();if(e==null){o.search=i.search;let c=new URLSearchParams(o.search),u=c.getAll("index");if(u.some(d=>d==="")){c.delete("index"),u.filter(h=>h).forEach(h=>c.append("index",h));let d=c.toString();o.search=d?`?${d}`:""}}return(!e||e===".")&&s.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(o.pathname=o.pathname==="/"?t:Ed([t,o.pathname])),Sv(o)}function cL(e,r={}){let t=G.useContext(Wj);Ks(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=ek("useViewTransitionState"),s=Qv(e,{relative:r.relative});if(!t.isTransitioning)return!1;let o=Dd(t.currentLocation.pathname,n)||t.currentLocation.pathname,i=Dd(t.nextLocation.pathname,n)||t.nextLocation.pathname;return n2(s.pathname,i)!=null||n2(s.pathname,o)!=null}[...qT];var s6=Fj();const fy=Xv(s6),uL="/assets/userIcon-Cv1yHxT9.png",dL={userIcon:uL};function tk(e){var r,t,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(r=0;r<s;r++)e[r]&&(t=tk(e[r]))&&(n&&(n+=" "),n+=t)}else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}function Pr(){for(var e,r,t=0,n="",s=arguments.length;t<s;t++)(e=arguments[t])&&(r=tk(e))&&(n&&(n+=" "),n+=r);return n}function Av(e,r){const t={...r};for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const s=n;if(s==="components"||s==="slots")t[s]={...e[s],...t[s]};else if(s==="componentsProps"||s==="slotProps"){const o=e[s],i=r[s];if(!i)t[s]=o||{};else if(!o)t[s]=i;else{t[s]={...i};for(const c in o)if(Object.prototype.hasOwnProperty.call(o,c)){const u=c;t[s][u]=Av(o[u],i[u])}}}else t[s]===void 0&&(t[s]=e[s])}return t}function nn(e,r,t=void 0){const n={};for(const s in e){const o=e[s];let i="",c=!0;for(let u=0;u<o.length;u+=1){const l=o[u];l&&(i+=(c===!0?"":" ")+r(l),c=!1,t&&t[l]&&(i+=" "+t[l]))}n[s]=i}return n}function Id(e,...r){const t=new URL(`https://mui.com/production-error/?code=${e}`);return r.forEach(n=>t.searchParams.append("args[]",n)),`Minified MUI error #${e}; visit ${t} for the full message.`}function fL(e,r=Number.MIN_SAFE_INTEGER,t=Number.MAX_SAFE_INTEGER){return Math.max(r,Math.min(e,t))}function i6(e,r=0,t=1){return fL(e,r,t)}function hL(e){e=e.slice(1);const r=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let t=e.match(r);return t&&t[0].length===1&&(t=t.map(n=>n+n)),t?`rgb${t.length===4?"a":""}(${t.map((n,s)=>s<3?parseInt(n,16):Math.round(parseInt(n,16)/255*1e3)/1e3).join(", ")})`:""}function zf(e){if(e.type)return e;if(e.charAt(0)==="#")return zf(hL(e));const r=e.indexOf("("),t=e.substring(0,r);if(!["rgb","rgba","hsl","hsla","color"].includes(t))throw new Error(Id(9,e));let n=e.substring(r+1,e.length-1),s;if(t==="color"){if(n=n.split(" "),s=n.shift(),n.length===4&&n[3].charAt(0)==="/"&&(n[3]=n[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(s))throw new Error(Id(10,s))}else n=n.split(",");return n=n.map(o=>parseFloat(o)),{type:t,values:n,colorSpace:s}}const pL=e=>{const r=zf(e);return r.values.slice(0,3).map((t,n)=>r.type.includes("hsl")&&n!==0?`${t}%`:t).join(" ")},X1=(e,r)=>{try{return pL(e)}catch{return e}};function X2(e){const{type:r,colorSpace:t}=e;let{values:n}=e;return r.includes("rgb")?n=n.map((s,o)=>o<3?parseInt(s,10):s):r.includes("hsl")&&(n[1]=`${n[1]}%`,n[2]=`${n[2]}%`),r.includes("color")?n=`${t} ${n.join(" ")}`:n=`${n.join(", ")}`,`${r}(${n})`}function rk(e){e=zf(e);const{values:r}=e,t=r[0],n=r[1]/100,s=r[2]/100,o=n*Math.min(s,1-s),i=(l,d=(l+t/30)%12)=>s-o*Math.max(Math.min(d-3,9-d,1),-1);let c="rgb";const u=[Math.round(i(0)*255),Math.round(i(8)*255),Math.round(i(4)*255)];return e.type==="hsla"&&(c+="a",u.push(r[3])),X2({type:c,values:u})}function sS(e){e=zf(e);let r=e.type==="hsl"||e.type==="hsla"?zf(rk(e)).values:e.values;return r=r.map(t=>(e.type!=="color"&&(t/=255),t<=.03928?t/12.92:((t+.055)/1.055)**2.4)),Number((.2126*r[0]+.7152*r[1]+.0722*r[2]).toFixed(3))}function mL(e,r){const t=sS(e),n=sS(r);return(Math.max(t,n)+.05)/(Math.min(t,n)+.05)}function Ca(e,r){return e=zf(e),r=i6(r),(e.type==="rgb"||e.type==="hsl")&&(e.type+="a"),e.type==="color"?e.values[3]=`/${r}`:e.values[3]=r,X2(e)}function hy(e,r,t){try{return Ca(e,r)}catch{return e}}function Mm(e,r){if(e=zf(e),r=i6(r),e.type.includes("hsl"))e.values[2]*=1-r;else if(e.type.includes("rgb")||e.type.includes("color"))for(let t=0;t<3;t+=1)e.values[t]*=1-r;return X2(e)}function gs(e,r,t){try{return Mm(e,r)}catch{return e}}function Dm(e,r){if(e=zf(e),r=i6(r),e.type.includes("hsl"))e.values[2]+=(100-e.values[2])*r;else if(e.type.includes("rgb"))for(let t=0;t<3;t+=1)e.values[t]+=(255-e.values[t])*r;else if(e.type.includes("color"))for(let t=0;t<3;t+=1)e.values[t]+=(1-e.values[t])*r;return X2(e)}function vs(e,r,t){try{return Dm(e,r)}catch{return e}}function nk(e,r=.15){return sS(e)>.5?Mm(e,r):Dm(e,r)}function py(e,r,t){try{return nk(e,r)}catch{return e}}const c5=e=>e,gL=()=>{let e=c5;return{configure(r){e=r},generate(r){return e(r)},reset(){e=c5}}},ak=gL();function yr(e){if(typeof e!="string")throw new Error(Id(7));return e.charAt(0).toUpperCase()+e.slice(1)}function u5(...e){return e.reduce((r,t)=>t==null?r:function(...s){r.apply(this,s),t.apply(this,s)},()=>{})}var H4={exports:{}},ds={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var d5;function vL(){if(d5)return ds;d5=1;var e=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),i=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),l=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.for("react.view_transition"),p=Symbol.for("react.client.reference");function v(g){if(typeof g=="object"&&g!==null){var m=g.$$typeof;switch(m){case e:switch(g=g.type,g){case t:case s:case n:case u:case l:case f:return g;default:switch(g=g&&g.$$typeof,g){case i:case c:case h:case d:return g;case o:return g;default:return m}}case r:return m}}}return ds.ContextConsumer=o,ds.ContextProvider=i,ds.Element=e,ds.ForwardRef=c,ds.Fragment=t,ds.Lazy=h,ds.Memo=d,ds.Portal=r,ds.Profiler=s,ds.StrictMode=n,ds.Suspense=u,ds.SuspenseList=l,ds.isContextConsumer=function(g){return v(g)===o},ds.isContextProvider=function(g){return v(g)===i},ds.isElement=function(g){return typeof g=="object"&&g!==null&&g.$$typeof===e},ds.isForwardRef=function(g){return v(g)===c},ds.isFragment=function(g){return v(g)===t},ds.isLazy=function(g){return v(g)===h},ds.isMemo=function(g){return v(g)===d},ds.isPortal=function(g){return v(g)===r},ds.isProfiler=function(g){return v(g)===s},ds.isStrictMode=function(g){return v(g)===n},ds.isSuspense=function(g){return v(g)===u},ds.isSuspenseList=function(g){return v(g)===l},ds.isValidElementType=function(g){return typeof g=="string"||typeof g=="function"||g===t||g===s||g===n||g===u||g===l||typeof g=="object"&&g!==null&&(g.$$typeof===h||g.$$typeof===d||g.$$typeof===i||g.$$typeof===o||g.$$typeof===c||g.$$typeof===p||g.getModuleId!==void 0)},ds.typeOf=v,ds}var f5;function xL(){return f5||(f5=1,H4.exports=vL()),H4.exports}var sk=xL();function Pu(e){if(typeof e!="object"||e===null)return!1;const r=Object.getPrototypeOf(e);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function ik(e){if(G.isValidElement(e)||sk.isValidElementType(e)||!Pu(e))return e;const r={};return Object.keys(e).forEach(t=>{r[t]=ik(e[t])}),r}function Ki(e,r,t={clone:!0}){const n=t.clone?{...e}:e;return Pu(e)&&Pu(r)&&Object.keys(r).forEach(s=>{G.isValidElement(r[s])||sk.isValidElementType(r[s])?n[s]=r[s]:Pu(r[s])&&Object.prototype.hasOwnProperty.call(e,s)&&Pu(e[s])?n[s]=Ki(e[s],r[s],t):t.clone?n[s]=Pu(r[s])?ik(r[s]):r[s]:n[s]=r[s]}),n}function sv(e,r){return r?Ki(e,r,{clone:!1}):e}function bL(e,r){if(!e.containerQueries)return r;const t=Object.keys(r).filter(n=>n.startsWith("@container")).sort((n,s)=>{var i,c;const o=/min-width:\s*([0-9.]+)/;return+(((i=n.match(o))==null?void 0:i[1])||0)-+(((c=s.match(o))==null?void 0:c[1])||0)});return t.length?t.reduce((n,s)=>{const o=r[s];return delete n[s],n[s]=o,n},{...r}):r}function yL(e,r){return r==="@"||r.startsWith("@")&&(e.some(t=>r.startsWith(`@${t}`))||!!r.match(/^@\d/))}function wL(e,r){const t=r.match(/^@([^/]+)?\/?(.+)?$/);if(!t)return null;const[,n,s]=t,o=Number.isNaN(+n)?n||0:+n;return e.containerQueries(s).up(o)}function SL(e){const r=(o,i)=>o.replace("@media",i?`@container ${i}`:"@container");function t(o,i){o.up=(...c)=>r(e.breakpoints.up(...c),i),o.down=(...c)=>r(e.breakpoints.down(...c),i),o.between=(...c)=>r(e.breakpoints.between(...c),i),o.only=(...c)=>r(e.breakpoints.only(...c),i),o.not=(...c)=>{const u=r(e.breakpoints.not(...c),i);return u.includes("not all and")?u.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):u}}const n={},s=o=>(t(n,o),n);return t(s),{...e,containerQueries:s}}const Y2={xs:0,sm:600,md:900,lg:1200,xl:1536},h5={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${Y2[e]}px)`},_L={containerQueries:e=>({up:r=>{let t=typeof r=="number"?r:Y2[r]||r;return typeof t=="number"&&(t=`${t}px`),e?`@container ${e} (min-width:${t})`:`@container (min-width:${t})`}})};function Zc(e,r,t){const n=e.theme||{};if(Array.isArray(r)){const o=n.breakpoints||h5;return r.reduce((i,c,u)=>(i[o.up(o.keys[u])]=t(r[u]),i),{})}if(typeof r=="object"){const o=n.breakpoints||h5;return Object.keys(r).reduce((i,c)=>{if(yL(o.keys,c)){const u=wL(n.containerQueries?n:_L,c);u&&(i[u]=t(r[c],c))}else if(Object.keys(o.values||Y2).includes(c)){const u=o.up(c);i[u]=t(r[c],c)}else{const u=c;i[u]=r[u]}return i},{})}return t(r)}function ok(e={}){var t;return((t=e.keys)==null?void 0:t.reduce((n,s)=>{const o=e.up(s);return n[o]={},n},{}))||{}}function lk(e,r){return e.reduce((t,n)=>{const s=t[n];return(!s||Object.keys(s).length===0)&&delete t[n],t},r)}function AL(e,...r){const t=ok(e),n=[t,...r].reduce((s,o)=>Ki(s,o),{});return lk(Object.keys(t),n)}function CL(e,r){if(typeof e!="object")return{};const t={},n=Object.keys(r);return Array.isArray(e)?n.forEach((s,o)=>{o<e.length&&(t[s]=!0)}):n.forEach(s=>{e[s]!=null&&(t[s]=!0)}),t}function V4({values:e,breakpoints:r,base:t}){const n=t||CL(e,r),s=Object.keys(n);if(s.length===0)return e;let o;return s.reduce((i,c,u)=>(Array.isArray(e)?(i[c]=e[u]!=null?e[u]:e[o],o=u):typeof e=="object"?(i[c]=e[c]!=null?e[c]:e[o],o=c):i[c]=e,i),{})}function Z2(e,r,t=!0){if(!r||typeof r!="string")return null;if(e&&e.vars&&t){const n=`vars.${r}`.split(".").reduce((s,o)=>s&&s[o]?s[o]:null,e);if(n!=null)return n}return r.split(".").reduce((n,s)=>n&&n[s]!=null?n[s]:null,e)}function a2(e,r,t,n=t){let s;return typeof e=="function"?s=e(t):Array.isArray(e)?s=e[t]||n:s=Z2(e,t)||n,r&&(s=r(s,n,e)),s}function yi(e){const{prop:r,cssProperty:t=e.prop,themeKey:n,transform:s}=e,o=i=>{if(i[r]==null)return null;const c=i[r],u=i.theme,l=Z2(u,n)||{};return Zc(i,c,h=>{let f=a2(l,s,h);return h===f&&typeof h=="string"&&(f=a2(l,s,`${r}${h==="default"?"":yr(h)}`,h)),t===!1?f:{[t]:f}})};return o.propTypes={},o.filterProps=[r],o}function jL(e){const r={};return t=>(r[t]===void 0&&(r[t]=e(t)),r[t])}const kL={m:"margin",p:"padding"},RL={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},p5={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},EL=jL(e=>{if(e.length>2)if(p5[e])e=p5[e];else return[e];const[r,t]=e.split(""),n=kL[r],s=RL[t]||"";return Array.isArray(s)?s.map(o=>n+o):[n+s]}),o6=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],l6=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...o6,...l6];function ex(e,r,t,n){const s=Z2(e,r,!0)??t;return typeof s=="number"||typeof s=="string"?o=>typeof o=="string"?o:typeof s=="string"?s.startsWith("var(")&&o===0?0:s.startsWith("var(")&&o===1?s:`calc(${o} * ${s})`:s*o:Array.isArray(s)?o=>{if(typeof o=="string")return o;const i=Math.abs(o),c=s[i];return o>=0?c:typeof c=="number"?-c:typeof c=="string"&&c.startsWith("var(")?`calc(-1 * ${c})`:`-${c}`}:typeof s=="function"?s:()=>{}}function J2(e){return ex(e,"spacing",8)}function L0(e,r){return typeof r=="string"||r==null?r:e(r)}function NL(e,r){return t=>e.reduce((n,s)=>(n[s]=L0(r,t),n),{})}function TL(e,r,t,n){if(!r.includes(t))return null;const s=EL(t),o=NL(s,n),i=e[t];return Zc(e,i,o)}function ck(e,r){const t=J2(e.theme);return Object.keys(e).map(n=>TL(e,r,n,t)).reduce(sv,{})}function Js(e){return ck(e,o6)}Js.propTypes={};Js.filterProps=o6;function Qs(e){return ck(e,l6)}Qs.propTypes={};Qs.filterProps=l6;function Q2(...e){const r=e.reduce((n,s)=>(s.filterProps.forEach(o=>{n[o]=s}),n),{}),t=n=>Object.keys(n).reduce((s,o)=>r[o]?sv(s,r[o](n)):s,{});return t.propTypes={},t.filterProps=e.reduce((n,s)=>n.concat(s.filterProps),[]),t}function pc(e){return typeof e!="number"?e:`${e}px solid`}function wc(e,r){return yi({prop:e,themeKey:"borders",transform:r})}const LL=wc("border",pc),ML=wc("borderTop",pc),DL=wc("borderRight",pc),IL=wc("borderBottom",pc),OL=wc("borderLeft",pc),PL=wc("borderColor"),FL=wc("borderTopColor"),BL=wc("borderRightColor"),zL=wc("borderBottomColor"),$L=wc("borderLeftColor"),UL=wc("outline",pc),HL=wc("outlineColor"),ew=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const r=ex(e.theme,"shape.borderRadius",4),t=n=>({borderRadius:L0(r,n)});return Zc(e,e.borderRadius,t)}return null};ew.propTypes={};ew.filterProps=["borderRadius"];Q2(LL,ML,DL,IL,OL,PL,FL,BL,zL,$L,ew,UL,HL);const tw=e=>{if(e.gap!==void 0&&e.gap!==null){const r=ex(e.theme,"spacing",8),t=n=>({gap:L0(r,n)});return Zc(e,e.gap,t)}return null};tw.propTypes={};tw.filterProps=["gap"];const rw=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const r=ex(e.theme,"spacing",8),t=n=>({columnGap:L0(r,n)});return Zc(e,e.columnGap,t)}return null};rw.propTypes={};rw.filterProps=["columnGap"];const nw=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const r=ex(e.theme,"spacing",8),t=n=>({rowGap:L0(r,n)});return Zc(e,e.rowGap,t)}return null};nw.propTypes={};nw.filterProps=["rowGap"];const VL=yi({prop:"gridColumn"}),WL=yi({prop:"gridRow"}),qL=yi({prop:"gridAutoFlow"}),GL=yi({prop:"gridAutoColumns"}),KL=yi({prop:"gridAutoRows"}),XL=yi({prop:"gridTemplateColumns"}),YL=yi({prop:"gridTemplateRows"}),ZL=yi({prop:"gridTemplateAreas"}),JL=yi({prop:"gridArea"});Q2(tw,rw,nw,VL,WL,qL,GL,KL,XL,YL,ZL,JL);function jm(e,r){return r==="grey"?r:e}const QL=yi({prop:"color",themeKey:"palette",transform:jm}),eM=yi({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:jm}),tM=yi({prop:"backgroundColor",themeKey:"palette",transform:jm});Q2(QL,eM,tM);function Bl(e){return e<=1&&e!==0?`${e*100}%`:e}const rM=yi({prop:"width",transform:Bl}),c6=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const r=t=>{var s,o,i,c,u;const n=((i=(o=(s=e.theme)==null?void 0:s.breakpoints)==null?void 0:o.values)==null?void 0:i[t])||Y2[t];return n?((u=(c=e.theme)==null?void 0:c.breakpoints)==null?void 0:u.unit)!=="px"?{maxWidth:`${n}${e.theme.breakpoints.unit}`}:{maxWidth:n}:{maxWidth:Bl(t)}};return Zc(e,e.maxWidth,r)}return null};c6.filterProps=["maxWidth"];const nM=yi({prop:"minWidth",transform:Bl}),aM=yi({prop:"height",transform:Bl}),sM=yi({prop:"maxHeight",transform:Bl}),iM=yi({prop:"minHeight",transform:Bl});yi({prop:"size",cssProperty:"width",transform:Bl});yi({prop:"size",cssProperty:"height",transform:Bl});const oM=yi({prop:"boxSizing"});Q2(rM,c6,nM,aM,sM,iM,oM);const tx={border:{themeKey:"borders",transform:pc},borderTop:{themeKey:"borders",transform:pc},borderRight:{themeKey:"borders",transform:pc},borderBottom:{themeKey:"borders",transform:pc},borderLeft:{themeKey:"borders",transform:pc},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:pc},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:ew},color:{themeKey:"palette",transform:jm},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:jm},backgroundColor:{themeKey:"palette",transform:jm},p:{style:Qs},pt:{style:Qs},pr:{style:Qs},pb:{style:Qs},pl:{style:Qs},px:{style:Qs},py:{style:Qs},padding:{style:Qs},paddingTop:{style:Qs},paddingRight:{style:Qs},paddingBottom:{style:Qs},paddingLeft:{style:Qs},paddingX:{style:Qs},paddingY:{style:Qs},paddingInline:{style:Qs},paddingInlineStart:{style:Qs},paddingInlineEnd:{style:Qs},paddingBlock:{style:Qs},paddingBlockStart:{style:Qs},paddingBlockEnd:{style:Qs},m:{style:Js},mt:{style:Js},mr:{style:Js},mb:{style:Js},ml:{style:Js},mx:{style:Js},my:{style:Js},margin:{style:Js},marginTop:{style:Js},marginRight:{style:Js},marginBottom:{style:Js},marginLeft:{style:Js},marginX:{style:Js},marginY:{style:Js},marginInline:{style:Js},marginInlineStart:{style:Js},marginInlineEnd:{style:Js},marginBlock:{style:Js},marginBlockStart:{style:Js},marginBlockEnd:{style:Js},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:tw},rowGap:{style:nw},columnGap:{style:rw},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Bl},maxWidth:{style:c6},minWidth:{transform:Bl},height:{transform:Bl},maxHeight:{transform:Bl},minHeight:{transform:Bl},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function lM(...e){const r=e.reduce((n,s)=>n.concat(Object.keys(s)),[]),t=new Set(r);return e.every(n=>t.size===Object.keys(n).length)}function cM(e,r){return typeof e=="function"?e(r):e}function uM(){function e(t,n,s,o){const i={[t]:n,theme:s},c=o[t];if(!c)return{[t]:n};const{cssProperty:u=t,themeKey:l,transform:d,style:h}=c;if(n==null)return null;if(l==="typography"&&n==="inherit")return{[t]:n};const f=Z2(s,l)||{};return h?h(i):Zc(i,n,v=>{let g=a2(f,d,v);return v===g&&typeof v=="string"&&(g=a2(f,d,`${t}${v==="default"?"":yr(v)}`,v)),u===!1?g:{[u]:g}})}function r(t){const{sx:n,theme:s={}}=t||{};if(!n)return null;const o=s.unstable_sxConfig??tx;function i(c){let u=c;if(typeof c=="function")u=c(s);else if(typeof c!="object")return c;if(!u)return null;const l=ok(s.breakpoints),d=Object.keys(l);let h=l;return Object.keys(u).forEach(f=>{const p=cM(u[f],s);if(p!=null)if(typeof p=="object")if(o[f])h=sv(h,e(f,p,s,o));else{const v=Zc({theme:s},p,g=>({[f]:g}));lM(v,p)?h[f]=r({sx:p,theme:s}):h=sv(h,v)}else h=sv(h,e(f,p,s,o))}),bL(s,lk(d,h))}return Array.isArray(n)?n.map(i):i(n)}return r}const M0=uM();M0.filterProps=["sx"];const dM=e=>{var n;const r={systemProps:{},otherProps:{}},t=((n=e==null?void 0:e.theme)==null?void 0:n.unstable_sxConfig)??tx;return Object.keys(e).forEach(s=>{t[s]?r.systemProps[s]=e[s]:r.otherProps[s]=e[s]}),r};function aw(e){const{sx:r,...t}=e,{systemProps:n,otherProps:s}=dM(t);let o;return Array.isArray(r)?o=[n,...r]:typeof r=="function"?o=(...i)=>{const c=r(...i);return Pu(c)?{...n,...c}:n}:o={...n,...r},{...s,sx:o}}function Ln(){return Ln=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Ln.apply(null,arguments)}function fM(e){if(e.sheet)return e.sheet;for(var r=0;r<document.styleSheets.length;r++)if(document.styleSheets[r].ownerNode===e)return document.styleSheets[r]}function hM(e){var r=document.createElement("style");return r.setAttribute("data-emotion",e.key),e.nonce!==void 0&&r.setAttribute("nonce",e.nonce),r.appendChild(document.createTextNode("")),r.setAttribute("data-s",""),r}var pM=function(){function e(t){var n=this;this._insertTag=function(s){var o;n.tags.length===0?n.insertionPoint?o=n.insertionPoint.nextSibling:n.prepend?o=n.container.firstChild:o=n.before:o=n.tags[n.tags.length-1].nextSibling,n.container.insertBefore(s,o),n.tags.push(s)},this.isSpeedy=t.speedy===void 0?!0:t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var r=e.prototype;return r.hydrate=function(n){n.forEach(this._insertTag)},r.insert=function(n){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(hM(this));var s=this.tags[this.tags.length-1];if(this.isSpeedy){var o=fM(s);try{o.insertRule(n,o.cssRules.length)}catch{}}else s.appendChild(document.createTextNode(n));this.ctr++},r.flush=function(){this.tags.forEach(function(n){var s;return(s=n.parentNode)==null?void 0:s.removeChild(n)}),this.tags=[],this.ctr=0},e}(),Ao="-ms-",s2="-moz-",Xa="-webkit-",uk="comm",u6="rule",d6="decl",mM="@import",dk="@keyframes",gM="@layer",vM=Math.abs,sw=String.fromCharCode,xM=Object.assign;function bM(e,r){return io(e,0)^45?(((r<<2^io(e,0))<<2^io(e,1))<<2^io(e,2))<<2^io(e,3):0}function fk(e){return e.trim()}function yM(e,r){return(e=r.exec(e))?e[0]:e}function Ya(e,r,t){return e.replace(r,t)}function iS(e,r){return e.indexOf(r)}function io(e,r){return e.charCodeAt(r)|0}function Cv(e,r,t){return e.slice(r,t)}function Iu(e){return e.length}function f6(e){return e.length}function my(e,r){return r.push(e),e}function wM(e,r){return e.map(r).join("")}var iw=1,Im=1,hk=0,gl=0,Ei=0,Gm="";function ow(e,r,t,n,s,o,i){return{value:e,root:r,parent:t,type:n,props:s,children:o,line:iw,column:Im,length:i,return:""}}function R1(e,r){return xM(ow("",null,null,"",null,null,0),e,{length:-e.length},r)}function SM(){return Ei}function _M(){return Ei=gl>0?io(Gm,--gl):0,Im--,Ei===10&&(Im=1,iw--),Ei}function Hl(){return Ei=gl<hk?io(Gm,gl++):0,Im++,Ei===10&&(Im=1,iw++),Ei}function $u(){return io(Gm,gl)}function Wy(){return gl}function rx(e,r){return Cv(Gm,e,r)}function jv(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function pk(e){return iw=Im=1,hk=Iu(Gm=e),gl=0,[]}function mk(e){return Gm="",e}function qy(e){return fk(rx(gl-1,oS(e===91?e+2:e===40?e+1:e)))}function AM(e){for(;(Ei=$u())&&Ei<33;)Hl();return jv(e)>2||jv(Ei)>3?"":" "}function CM(e,r){for(;--r&&Hl()&&!(Ei<48||Ei>102||Ei>57&&Ei<65||Ei>70&&Ei<97););return rx(e,Wy()+(r<6&&$u()==32&&Hl()==32))}function oS(e){for(;Hl();)switch(Ei){case e:return gl;case 34:case 39:e!==34&&e!==39&&oS(Ei);break;case 40:e===41&&oS(e);break;case 92:Hl();break}return gl}function jM(e,r){for(;Hl()&&e+Ei!==57;)if(e+Ei===84&&$u()===47)break;return"/*"+rx(r,gl-1)+"*"+sw(e===47?e:Hl())}function kM(e){for(;!jv($u());)Hl();return rx(e,gl)}function RM(e){return mk(Gy("",null,null,null,[""],e=pk(e),0,[0],e))}function Gy(e,r,t,n,s,o,i,c,u){for(var l=0,d=0,h=i,f=0,p=0,v=0,g=1,m=1,b=1,y=0,S="",C=s,L=o,O=n,H=S;m;)switch(v=y,y=Hl()){case 40:if(v!=108&&io(H,h-1)==58){iS(H+=Ya(qy(y),"&","&\f"),"&\f")!=-1&&(b=-1);break}case 34:case 39:case 91:H+=qy(y);break;case 9:case 10:case 13:case 32:H+=AM(v);break;case 92:H+=CM(Wy()-1,7);continue;case 47:switch($u()){case 42:case 47:my(EM(jM(Hl(),Wy()),r,t),u);break;default:H+="/"}break;case 123*g:c[l++]=Iu(H)*b;case 125*g:case 59:case 0:switch(y){case 0:case 125:m=0;case 59+d:b==-1&&(H=Ya(H,/\f/g,"")),p>0&&Iu(H)-h&&my(p>32?g5(H+";",n,t,h-1):g5(Ya(H," ","")+";",n,t,h-2),u);break;case 59:H+=";";default:if(my(O=m5(H,r,t,l,d,s,c,S,C=[],L=[],h),o),y===123)if(d===0)Gy(H,r,O,O,C,o,h,c,L);else switch(f===99&&io(H,3)===110?100:f){case 100:case 108:case 109:case 115:Gy(e,O,O,n&&my(m5(e,O,O,0,0,s,c,S,s,C=[],h),L),s,L,h,c,n?C:L);break;default:Gy(H,O,O,O,[""],L,0,c,L)}}l=d=p=0,g=b=1,S=H="",h=i;break;case 58:h=1+Iu(H),p=v;default:if(g<1){if(y==123)--g;else if(y==125&&g++==0&&_M()==125)continue}switch(H+=sw(y),y*g){case 38:b=d>0?1:(H+="\f",-1);break;case 44:c[l++]=(Iu(H)-1)*b,b=1;break;case 64:$u()===45&&(H+=qy(Hl())),f=$u(),d=h=Iu(S=H+=kM(Wy())),y++;break;case 45:v===45&&Iu(H)==2&&(g=0)}}return o}function m5(e,r,t,n,s,o,i,c,u,l,d){for(var h=s-1,f=s===0?o:[""],p=f6(f),v=0,g=0,m=0;v<n;++v)for(var b=0,y=Cv(e,h+1,h=vM(g=i[v])),S=e;b<p;++b)(S=fk(g>0?f[b]+" "+y:Ya(y,/&\f/g,f[b])))&&(u[m++]=S);return ow(e,r,t,s===0?u6:c,u,l,d)}function EM(e,r,t){return ow(e,r,t,uk,sw(SM()),Cv(e,2,-2),0)}function g5(e,r,t,n){return ow(e,r,t,d6,Cv(e,0,n),Cv(e,n+1,-1),n)}function km(e,r){for(var t="",n=f6(e),s=0;s<n;s++)t+=r(e[s],s,e,r)||"";return t}function NM(e,r,t,n){switch(e.type){case gM:if(e.children.length)break;case mM:case d6:return e.return=e.return||e.value;case uk:return"";case dk:return e.return=e.value+"{"+km(e.children,n)+"}";case u6:e.value=e.props.join(",")}return Iu(t=km(e.children,n))?e.return=e.value+"{"+t+"}":""}function TM(e){var r=f6(e);return function(t,n,s,o){for(var i="",c=0;c<r;c++)i+=e[c](t,n,s,o)||"";return i}}function LM(e){return function(r){r.root||(r=r.return)&&e(r)}}function gk(e){var r=Object.create(null);return function(t){return r[t]===void 0&&(r[t]=e(t)),r[t]}}var MM=function(r,t,n){for(var s=0,o=0;s=o,o=$u(),s===38&&o===12&&(t[n]=1),!jv(o);)Hl();return rx(r,gl)},DM=function(r,t){var n=-1,s=44;do switch(jv(s)){case 0:s===38&&$u()===12&&(t[n]=1),r[n]+=MM(gl-1,t,n);break;case 2:r[n]+=qy(s);break;case 4:if(s===44){r[++n]=$u()===58?"&\f":"",t[n]=r[n].length;break}default:r[n]+=sw(s)}while(s=Hl());return r},IM=function(r,t){return mk(DM(pk(r),t))},v5=new WeakMap,OM=function(r){if(!(r.type!=="rule"||!r.parent||r.length<1)){for(var t=r.value,n=r.parent,s=r.column===n.column&&r.line===n.line;n.type!=="rule";)if(n=n.parent,!n)return;if(!(r.props.length===1&&t.charCodeAt(0)!==58&&!v5.get(n))&&!s){v5.set(r,!0);for(var o=[],i=IM(t,o),c=n.props,u=0,l=0;u<i.length;u++)for(var d=0;d<c.length;d++,l++)r.props[l]=o[u]?i[u].replace(/&\f/g,c[d]):c[d]+" "+i[u]}}},PM=function(r){if(r.type==="decl"){var t=r.value;t.charCodeAt(0)===108&&t.charCodeAt(2)===98&&(r.return="",r.value="")}};function vk(e,r){switch(bM(e,r)){case 5103:return Xa+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Xa+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Xa+e+s2+e+Ao+e+e;case 6828:case 4268:return Xa+e+Ao+e+e;case 6165:return Xa+e+Ao+"flex-"+e+e;case 5187:return Xa+e+Ya(e,/(\w+).+(:[^]+)/,Xa+"box-$1$2"+Ao+"flex-$1$2")+e;case 5443:return Xa+e+Ao+"flex-item-"+Ya(e,/flex-|-self/,"")+e;case 4675:return Xa+e+Ao+"flex-line-pack"+Ya(e,/align-content|flex-|-self/,"")+e;case 5548:return Xa+e+Ao+Ya(e,"shrink","negative")+e;case 5292:return Xa+e+Ao+Ya(e,"basis","preferred-size")+e;case 6060:return Xa+"box-"+Ya(e,"-grow","")+Xa+e+Ao+Ya(e,"grow","positive")+e;case 4554:return Xa+Ya(e,/([^-])(transform)/g,"$1"+Xa+"$2")+e;case 6187:return Ya(Ya(Ya(e,/(zoom-|grab)/,Xa+"$1"),/(image-set)/,Xa+"$1"),e,"")+e;case 5495:case 3959:return Ya(e,/(image-set\([^]*)/,Xa+"$1$`$1");case 4968:return Ya(Ya(e,/(.+:)(flex-)?(.*)/,Xa+"box-pack:$3"+Ao+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Xa+e+e;case 4095:case 3583:case 4068:case 2532:return Ya(e,/(.+)-inline(.+)/,Xa+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Iu(e)-1-r>6)switch(io(e,r+1)){case 109:if(io(e,r+4)!==45)break;case 102:return Ya(e,/(.+:)(.+)-([^]+)/,"$1"+Xa+"$2-$3$1"+s2+(io(e,r+3)==108?"$3":"$2-$3"))+e;case 115:return~iS(e,"stretch")?vk(Ya(e,"stretch","fill-available"),r)+e:e}break;case 4949:if(io(e,r+1)!==115)break;case 6444:switch(io(e,Iu(e)-3-(~iS(e,"!important")&&10))){case 107:return Ya(e,":",":"+Xa)+e;case 101:return Ya(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Xa+(io(e,14)===45?"inline-":"")+"box$3$1"+Xa+"$2$3$1"+Ao+"$2box$3")+e}break;case 5936:switch(io(e,r+11)){case 114:return Xa+e+Ao+Ya(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Xa+e+Ao+Ya(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Xa+e+Ao+Ya(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Xa+e+Ao+e+e}return e}var FM=function(r,t,n,s){if(r.length>-1&&!r.return)switch(r.type){case d6:r.return=vk(r.value,r.length);break;case dk:return km([R1(r,{value:Ya(r.value,"@","@"+Xa)})],s);case u6:if(r.length)return wM(r.props,function(o){switch(yM(o,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return km([R1(r,{props:[Ya(o,/:(read-\w+)/,":"+s2+"$1")]})],s);case"::placeholder":return km([R1(r,{props:[Ya(o,/:(plac\w+)/,":"+Xa+"input-$1")]}),R1(r,{props:[Ya(o,/:(plac\w+)/,":"+s2+"$1")]}),R1(r,{props:[Ya(o,/:(plac\w+)/,Ao+"input-$1")]})],s)}return""})}},BM=[FM],zM=function(r){var t=r.key;if(t==="css"){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,function(g){var m=g.getAttribute("data-emotion");m.indexOf(" ")!==-1&&(document.head.appendChild(g),g.setAttribute("data-s",""))})}var s=r.stylisPlugins||BM,o={},i,c=[];i=r.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(g){for(var m=g.getAttribute("data-emotion").split(" "),b=1;b<m.length;b++)o[m[b]]=!0;c.push(g)});var u,l=[OM,PM];{var d,h=[NM,LM(function(g){d.insert(g)})],f=TM(l.concat(s,h)),p=function(m){return km(RM(m),f)};u=function(m,b,y,S){d=y,p(m?m+"{"+b.styles+"}":b.styles),S&&(v.inserted[b.name]=!0)}}var v={key:t,sheet:new pM({key:t,container:i,nonce:r.nonce,speedy:r.speedy,prepend:r.prepend,insertionPoint:r.insertionPoint}),nonce:r.nonce,inserted:o,registered:{},insert:u};return v.sheet.hydrate(c),v},W4={exports:{}},es={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var x5;function $M(){if(x5)return es;x5=1;var e=typeof Symbol=="function"&&Symbol.for,r=e?Symbol.for("react.element"):60103,t=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,s=e?Symbol.for("react.strict_mode"):60108,o=e?Symbol.for("react.profiler"):60114,i=e?Symbol.for("react.provider"):60109,c=e?Symbol.for("react.context"):60110,u=e?Symbol.for("react.async_mode"):60111,l=e?Symbol.for("react.concurrent_mode"):60111,d=e?Symbol.for("react.forward_ref"):60112,h=e?Symbol.for("react.suspense"):60113,f=e?Symbol.for("react.suspense_list"):60120,p=e?Symbol.for("react.memo"):60115,v=e?Symbol.for("react.lazy"):60116,g=e?Symbol.for("react.block"):60121,m=e?Symbol.for("react.fundamental"):60117,b=e?Symbol.for("react.responder"):60118,y=e?Symbol.for("react.scope"):60119;function S(L){if(typeof L=="object"&&L!==null){var O=L.$$typeof;switch(O){case r:switch(L=L.type,L){case u:case l:case n:case o:case s:case h:return L;default:switch(L=L&&L.$$typeof,L){case c:case d:case v:case p:case i:return L;default:return O}}case t:return O}}}function C(L){return S(L)===l}return es.AsyncMode=u,es.ConcurrentMode=l,es.ContextConsumer=c,es.ContextProvider=i,es.Element=r,es.ForwardRef=d,es.Fragment=n,es.Lazy=v,es.Memo=p,es.Portal=t,es.Profiler=o,es.StrictMode=s,es.Suspense=h,es.isAsyncMode=function(L){return C(L)||S(L)===u},es.isConcurrentMode=C,es.isContextConsumer=function(L){return S(L)===c},es.isContextProvider=function(L){return S(L)===i},es.isElement=function(L){return typeof L=="object"&&L!==null&&L.$$typeof===r},es.isForwardRef=function(L){return S(L)===d},es.isFragment=function(L){return S(L)===n},es.isLazy=function(L){return S(L)===v},es.isMemo=function(L){return S(L)===p},es.isPortal=function(L){return S(L)===t},es.isProfiler=function(L){return S(L)===o},es.isStrictMode=function(L){return S(L)===s},es.isSuspense=function(L){return S(L)===h},es.isValidElementType=function(L){return typeof L=="string"||typeof L=="function"||L===n||L===l||L===o||L===s||L===h||L===f||typeof L=="object"&&L!==null&&(L.$$typeof===v||L.$$typeof===p||L.$$typeof===i||L.$$typeof===c||L.$$typeof===d||L.$$typeof===m||L.$$typeof===b||L.$$typeof===y||L.$$typeof===g)},es.typeOf=S,es}var b5;function UM(){return b5||(b5=1,W4.exports=$M()),W4.exports}var q4,y5;function HM(){if(y5)return q4;y5=1;var e=UM(),r={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},t={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},n={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o={};o[e.ForwardRef]=n,o[e.Memo]=s;function i(v){return e.isMemo(v)?s:o[v.$$typeof]||r}var c=Object.defineProperty,u=Object.getOwnPropertyNames,l=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,h=Object.getPrototypeOf,f=Object.prototype;function p(v,g,m){if(typeof g!="string"){if(f){var b=h(g);b&&b!==f&&p(v,b,m)}var y=u(g);l&&(y=y.concat(l(g)));for(var S=i(v),C=i(g),L=0;L<y.length;++L){var O=y[L];if(!t[O]&&!(m&&m[O])&&!(C&&C[O])&&!(S&&S[O])){var H=d(g,O);try{c(v,O,H)}catch{}}}}return v}return q4=p,q4}HM();var VM=!0;function xk(e,r,t){var n="";return t.split(" ").forEach(function(s){e[s]!==void 0?r.push(e[s]+";"):s&&(n+=s+" ")}),n}var h6=function(r,t,n){var s=r.key+"-"+t.name;(n===!1||VM===!1)&&r.registered[s]===void 0&&(r.registered[s]=t.styles)},p6=function(r,t,n){h6(r,t,n);var s=r.key+"-"+t.name;if(r.inserted[t.name]===void 0){var o=t;do r.insert(t===o?"."+s:"",o,r.sheet,!0),o=o.next;while(o!==void 0)}};function WM(e){for(var r=0,t,n=0,s=e.length;s>=4;++n,s-=4)t=e.charCodeAt(n)&255|(e.charCodeAt(++n)&255)<<8|(e.charCodeAt(++n)&255)<<16|(e.charCodeAt(++n)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,r=(t&65535)*1540483477+((t>>>16)*59797<<16)^(r&65535)*1540483477+((r>>>16)*59797<<16);switch(s){case 3:r^=(e.charCodeAt(n+2)&255)<<16;case 2:r^=(e.charCodeAt(n+1)&255)<<8;case 1:r^=e.charCodeAt(n)&255,r=(r&65535)*1540483477+((r>>>16)*59797<<16)}return r^=r>>>13,r=(r&65535)*1540483477+((r>>>16)*59797<<16),((r^r>>>15)>>>0).toString(36)}var qM={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},GM=/[A-Z]|^ms/g,KM=/_EMO_([^_]+?)_([^]*?)_EMO_/g,bk=function(r){return r.charCodeAt(1)===45},w5=function(r){return r!=null&&typeof r!="boolean"},G4=gk(function(e){return bk(e)?e:e.replace(GM,"-$&").toLowerCase()}),S5=function(r,t){switch(r){case"animation":case"animationName":if(typeof t=="string")return t.replace(KM,function(n,s,o){return Ou={name:s,styles:o,next:Ou},s})}return qM[r]!==1&&!bk(r)&&typeof t=="number"&&t!==0?t+"px":t};function kv(e,r,t){if(t==null)return"";var n=t;if(n.__emotion_styles!==void 0)return n;switch(typeof t){case"boolean":return"";case"object":{var s=t;if(s.anim===1)return Ou={name:s.name,styles:s.styles,next:Ou},s.name;var o=t;if(o.styles!==void 0){var i=o.next;if(i!==void 0)for(;i!==void 0;)Ou={name:i.name,styles:i.styles,next:Ou},i=i.next;var c=o.styles+";";return c}return XM(e,r,t)}case"function":{if(e!==void 0){var u=Ou,l=t(e);return Ou=u,kv(e,r,l)}break}}var d=t;if(r==null)return d;var h=r[d];return h!==void 0?h:d}function XM(e,r,t){var n="";if(Array.isArray(t))for(var s=0;s<t.length;s++)n+=kv(e,r,t[s])+";";else for(var o in t){var i=t[o];if(typeof i!="object"){var c=i;r!=null&&r[c]!==void 0?n+=o+"{"+r[c]+"}":w5(c)&&(n+=G4(o)+":"+S5(o,c)+";")}else if(Array.isArray(i)&&typeof i[0]=="string"&&(r==null||r[i[0]]===void 0))for(var u=0;u<i.length;u++)w5(i[u])&&(n+=G4(o)+":"+S5(o,i[u])+";");else{var l=kv(e,r,i);switch(o){case"animation":case"animationName":{n+=G4(o)+":"+l+";";break}default:n+=o+"{"+l+"}"}}}return n}var _5=/label:\s*([^\s;{]+)\s*(;|$)/g,Ou;function nx(e,r,t){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var n=!0,s="";Ou=void 0;var o=e[0];if(o==null||o.raw===void 0)n=!1,s+=kv(t,r,o);else{var i=o;s+=i[0]}for(var c=1;c<e.length;c++)if(s+=kv(t,r,e[c]),n){var u=o;s+=u[c]}_5.lastIndex=0;for(var l="",d;(d=_5.exec(s))!==null;)l+="-"+d[1];var h=WM(s)+l;return{name:h,styles:s,next:Ou}}var YM=function(r){return r()},yk=rS.useInsertionEffect?rS.useInsertionEffect:!1,wk=yk||YM,A5=yk||G.useLayoutEffect,Sk=G.createContext(typeof HTMLElement<"u"?zM({key:"css"}):null);Sk.Provider;var m6=function(r){return G.forwardRef(function(t,n){var s=G.useContext(Sk);return r(t,s,n)})},lw=G.createContext({}),g6={}.hasOwnProperty,lS="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",ZM=function(r,t){var n={};for(var s in t)g6.call(t,s)&&(n[s]=t[s]);return n[lS]=r,n},JM=function(r){var t=r.cache,n=r.serialized,s=r.isStringTag;return h6(t,n,s),wk(function(){return p6(t,n,s)}),null},QM=m6(function(e,r,t){var n=e.css;typeof n=="string"&&r.registered[n]!==void 0&&(n=r.registered[n]);var s=e[lS],o=[n],i="";typeof e.className=="string"?i=xk(r.registered,o,e.className):e.className!=null&&(i=e.className+" ");var c=nx(o,void 0,G.useContext(lw));i+=r.key+"-"+c.name;var u={};for(var l in e)g6.call(e,l)&&l!=="css"&&l!==lS&&(u[l]=e[l]);return u.className=i,t&&(u.ref=t),G.createElement(G.Fragment,null,G.createElement(JM,{cache:r,serialized:c,isStringTag:typeof s=="string"}),G.createElement(s,u))}),eD=QM,Cn=function(r,t){var n=arguments;if(t==null||!g6.call(t,"css"))return G.createElement.apply(void 0,n);var s=n.length,o=new Array(s);o[0]=eD,o[1]=ZM(r,t);for(var i=2;i<s;i++)o[i]=n[i];return G.createElement.apply(null,o)};(function(e){var r;r||(r=e.JSX||(e.JSX={}))})(Cn||(Cn={}));var tD=m6(function(e,r){var t=e.styles,n=nx([t],void 0,G.useContext(lw)),s=G.useRef();return A5(function(){var o=r.key+"-global",i=new r.sheet.constructor({key:o,nonce:r.sheet.nonce,container:r.sheet.container,speedy:r.sheet.isSpeedy}),c=!1,u=document.querySelector('style[data-emotion="'+o+" "+n.name+'"]');return r.sheet.tags.length&&(i.before=r.sheet.tags[0]),u!==null&&(c=!0,u.setAttribute("data-emotion",o),i.hydrate([u])),s.current=[i,c],function(){i.flush()}},[r]),A5(function(){var o=s.current,i=o[0],c=o[1];if(c){o[1]=!1;return}if(n.next!==void 0&&p6(r,n.next,!0),i.tags.length){var u=i.tags[i.tags.length-1].nextElementSibling;i.before=u,i.flush()}r.insert("",n,i,!1)},[r,n.name]),null});function H0(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return nx(r)}function Gf(){var e=H0.apply(void 0,arguments),r="animation-"+e.name;return{name:r,styles:"@keyframes "+r+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var rD=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,nD=gk(function(e){return rD.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),aD=nD,sD=function(r){return r!=="theme"},C5=function(r){return typeof r=="string"&&r.charCodeAt(0)>96?aD:sD},j5=function(r,t,n){var s;if(t){var o=t.shouldForwardProp;s=r.__emotion_forwardProp&&o?function(i){return r.__emotion_forwardProp(i)&&o(i)}:o}return typeof s!="function"&&n&&(s=r.__emotion_forwardProp),s},iD=function(r){var t=r.cache,n=r.serialized,s=r.isStringTag;return h6(t,n,s),wk(function(){return p6(t,n,s)}),null},oD=function e(r,t){var n=r.__emotion_real===r,s=n&&r.__emotion_base||r,o,i;t!==void 0&&(o=t.label,i=t.target);var c=j5(r,t,n),u=c||C5(s),l=!u("as");return function(){var d=arguments,h=n&&r.__emotion_styles!==void 0?r.__emotion_styles.slice(0):[];if(o!==void 0&&h.push("label:"+o+";"),d[0]==null||d[0].raw===void 0)h.push.apply(h,d);else{var f=d[0];h.push(f[0]);for(var p=d.length,v=1;v<p;v++)h.push(d[v],f[v])}var g=m6(function(m,b,y){var S=l&&m.as||s,C="",L=[],O=m;if(m.theme==null){O={};for(var H in m)O[H]=m[H];O.theme=G.useContext(lw)}typeof m.className=="string"?C=xk(b.registered,L,m.className):m.className!=null&&(C=m.className+" ");var z=nx(h.concat(L),b.registered,O);C+=b.key+"-"+z.name,i!==void 0&&(C+=" "+i);var q=l&&c===void 0?C5(S):u,D={};for(var W in m)l&&W==="as"||q(W)&&(D[W]=m[W]);return D.className=C,y&&(D.ref=y),G.createElement(G.Fragment,null,G.createElement(iD,{cache:b,serialized:z,isStringTag:typeof S=="string"}),G.createElement(S,D))});return g.displayName=o!==void 0?o:"Styled("+(typeof s=="string"?s:s.displayName||s.name||"Component")+")",g.defaultProps=r.defaultProps,g.__emotion_real=g,g.__emotion_base=s,g.__emotion_styles=h,g.__emotion_forwardProp=c,Object.defineProperty(g,"toString",{value:function(){return"."+i}}),g.withComponent=function(m,b){var y=e(m,Ln({},t,b,{shouldForwardProp:j5(g,b,!0)}));return y.apply(void 0,h)},g}},lD=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],cS=oD.bind(null);lD.forEach(function(e){cS[e]=cS(e)});function cD(e){return e==null||Object.keys(e).length===0}function uD(e){const{styles:r,defaultTheme:t={}}=e,n=typeof r=="function"?s=>r(cD(s)?t:s):r;return a.jsx(tD,{styles:n})}function _k(e,r){return cS(e,r)}function dD(e,r){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=r(e.__emotion_styles))}const k5=[];function R5(e){return k5[0]=e,nx(k5)}const fD=e=>{const r=Object.keys(e).map(t=>({key:t,val:e[t]}))||[];return r.sort((t,n)=>t.val-n.val),r.reduce((t,n)=>({...t,[n.key]:n.val}),{})};function hD(e){const{values:r={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:t="px",step:n=5,...s}=e,o=fD(r),i=Object.keys(o);function c(f){return`@media (min-width:${typeof r[f]=="number"?r[f]:f}${t})`}function u(f){return`@media (max-width:${(typeof r[f]=="number"?r[f]:f)-n/100}${t})`}function l(f,p){const v=i.indexOf(p);return`@media (min-width:${typeof r[f]=="number"?r[f]:f}${t}) and (max-width:${(v!==-1&&typeof r[i[v]]=="number"?r[i[v]]:p)-n/100}${t})`}function d(f){return i.indexOf(f)+1<i.length?l(f,i[i.indexOf(f)+1]):c(f)}function h(f){const p=i.indexOf(f);return p===0?c(i[1]):p===i.length-1?u(i[p]):l(f,i[i.indexOf(f)+1]).replace("@media","@media not all and")}return{keys:i,values:o,up:c,down:u,between:l,only:d,not:h,unit:t,...s}}const pD={borderRadius:4};function Ak(e=8,r=J2({spacing:e})){if(e.mui)return e;const t=(...n)=>(n.length===0?[1]:n).map(o=>{const i=r(o);return typeof i=="number"?`${i}px`:i}).join(" ");return t.mui=!0,t}function mD(e,r){var n;const t=this;if(t.vars){if(!((n=t.colorSchemes)!=null&&n[e])||typeof t.getColorSchemeSelector!="function")return{};let s=t.getColorSchemeSelector(e);return s==="&"?r:((s.includes("data-")||s.includes("."))&&(s=`*:where(${s.replace(/\s*&$/,"")}) &`),{[s]:r})}return t.palette.mode===e?r:{}}function Km(e={},...r){const{breakpoints:t={},palette:n={},spacing:s,shape:o={},...i}=e,c=hD(t),u=Ak(s);let l=Ki({breakpoints:c,direction:"ltr",components:{},palette:{mode:"light",...n},spacing:u,shape:{...pD,...o}},i);return l=SL(l),l.applyStyles=mD,l=r.reduce((d,h)=>Ki(d,h),l),l.unstable_sxConfig={...tx,...i==null?void 0:i.unstable_sxConfig},l.unstable_sx=function(h){return M0({sx:h,theme:this})},l}function gD(e){return Object.keys(e).length===0}function vD(e=null){const r=G.useContext(lw);return!r||gD(r)?e:r}const xD=Km();function ax(e=xD){return vD(e)}function bD({styles:e,themeId:r,defaultTheme:t={}}){const n=ax(t),s=typeof e=="function"?e(r&&n[r]||n):e;return a.jsx(uD,{styles:s})}function yD(e={}){const{themeId:r,defaultTheme:t,defaultClassName:n="MuiBox-root",generateClassName:s}=e,o=_k("div",{shouldForwardProp:c=>c!=="theme"&&c!=="sx"&&c!=="as"})(M0);return G.forwardRef(function(u,l){const d=ax(t),{className:h,component:f="div",...p}=aw(u);return a.jsx(o,{as:f,ref:l,className:Pr(h,s?s(n):n),theme:r&&d[r]||d,...p})})}const wD={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function an(e,r,t="Mui"){const n=wD[r];return n?`${t}-${n}`:`${ak.generate(e)}-${r}`}function un(e,r,t="Mui"){const n={};return r.forEach(s=>{n[s]=an(e,s,t)}),n}function Ck(e){const{variants:r,...t}=e,n={variants:r,style:R5(t),isProcessed:!0};return n.style===t||r&&r.forEach(s=>{typeof s.style!="function"&&(s.style=R5(s.style))}),n}const SD=Km();function K4(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}function _D(e){return e?(r,t)=>t[e]:null}function AD(e,r,t){e.theme=jD(e.theme)?t:e.theme[r]||e.theme}function Ky(e,r){const t=typeof r=="function"?r(e):r;if(Array.isArray(t))return t.flatMap(n=>Ky(e,n));if(Array.isArray(t==null?void 0:t.variants)){let n;if(t.isProcessed)n=t.style;else{const{variants:s,...o}=t;n=o}return jk(e,t.variants,[n])}return t!=null&&t.isProcessed?t.style:t}function jk(e,r,t=[]){var s;let n;e:for(let o=0;o<r.length;o+=1){const i=r[o];if(typeof i.props=="function"){if(n??(n={...e,...e.ownerState,ownerState:e.ownerState}),!i.props(n))continue}else for(const c in i.props)if(e[c]!==i.props[c]&&((s=e.ownerState)==null?void 0:s[c])!==i.props[c])continue e;typeof i.style=="function"?(n??(n={...e,...e.ownerState,ownerState:e.ownerState}),t.push(i.style(n))):t.push(i.style)}return t}function kk(e={}){const{themeId:r,defaultTheme:t=SD,rootShouldForwardProp:n=K4,slotShouldForwardProp:s=K4}=e;function o(c){AD(c,r,t)}return(c,u={})=>{dD(c,L=>L.filter(O=>O!==M0));const{name:l,slot:d,skipVariantsResolver:h,skipSx:f,overridesResolver:p=_D(RD(d)),...v}=u,g=h!==void 0?h:d&&d!=="Root"&&d!=="root"||!1,m=f||!1;let b=K4;d==="Root"||d==="root"?b=n:d?b=s:kD(c)&&(b=void 0);const y=_k(c,{shouldForwardProp:b,label:CD(),...v}),S=L=>{if(typeof L=="function"&&L.__emotion_real!==L)return function(H){return Ky(H,L)};if(Pu(L)){const O=Ck(L);return O.variants?function(z){return Ky(z,O)}:O.style}return L},C=(...L)=>{const O=[],H=L.map(S),z=[];if(O.push(o),l&&p&&z.push(function(P){var _,R;const U=(R=(_=P.theme.components)==null?void 0:_[l])==null?void 0:R.styleOverrides;if(!U)return null;const k={};for(const j in U)k[j]=Ky(P,U[j]);return p(P,k)}),l&&!g&&z.push(function(P){var k,_;const I=P.theme,U=(_=(k=I==null?void 0:I.components)==null?void 0:k[l])==null?void 0:_.variants;return U?jk(P,U):null}),m||z.push(M0),Array.isArray(H[0])){const W=H.shift(),P=new Array(O.length).fill(""),I=new Array(z.length).fill("");let U;U=[...P,...W,...I],U.raw=[...P,...W.raw,...I],O.unshift(U)}const q=[...O,...H,...z],D=y(...q);return c.muiName&&(D.muiName=c.muiName),D};return y.withConfig&&(C.withConfig=y.withConfig),C}}function CD(e,r){return void 0}function jD(e){for(const r in e)return!1;return!0}function kD(e){return typeof e=="string"&&e.charCodeAt(0)>96}function RD(e){return e&&e.charAt(0).toLowerCase()+e.slice(1)}const v6=kk();function ED(e){const{theme:r,name:t,props:n}=e;return!r||!r.components||!r.components[t]||!r.components[t].defaultProps?n:Av(r.components[t].defaultProps,n)}function x6({props:e,name:r,defaultTheme:t,themeId:n}){let s=ax(t);return n&&(s=s[n]||s),ED({theme:s,name:r,props:e})}const Jc=typeof window<"u"?G.useLayoutEffect:G.useEffect,ND=G.createContext(),Xm=()=>G.useContext(ND)??!1,TD=G.createContext(void 0);function LD(e){const{theme:r,name:t,props:n}=e;if(!r||!r.components||!r.components[t])return n;const s=r.components[t];return s.defaultProps?Av(s.defaultProps,n):!s.styleOverrides&&!s.variants?Av(s,n):n}function MD({props:e,name:r}){const t=G.useContext(TD);return LD({props:e,name:r,theme:{components:t}})}const E5={theme:void 0};function DD(e){let r,t;return function(s){let o=r;return(o===void 0||s.theme!==t)&&(E5.theme=s.theme,o=Ck(e(E5)),r=o,t=s.theme),o}}function ID(e=""){function r(...n){if(!n.length)return"";const s=n[0];return typeof s=="string"&&!s.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${e?`${e}-`:""}${s}${r(...n.slice(1))})`:`, ${s}`}return(n,...s)=>`var(--${e?`${e}-`:""}${n}${r(...s)})`}const N5=(e,r,t,n=[])=>{let s=e;r.forEach((o,i)=>{i===r.length-1?Array.isArray(s)?s[Number(o)]=t:s&&typeof s=="object"&&(s[o]=t):s&&typeof s=="object"&&(s[o]||(s[o]=n.includes(o)?[]:{}),s=s[o])})},OD=(e,r,t)=>{function n(s,o=[],i=[]){Object.entries(s).forEach(([c,u])=>{(!t||t&&!t([...o,c]))&&u!=null&&(typeof u=="object"&&Object.keys(u).length>0?n(u,[...o,c],Array.isArray(u)?[...i,c]:i):r([...o,c],u,i))})}n(e)},PD=(e,r)=>typeof r=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(n=>e.includes(n))||e[e.length-1].toLowerCase().includes("opacity")?r:`${r}px`:r;function X4(e,r){const{prefix:t,shouldSkipGeneratingVar:n}=r||{},s={},o={},i={};return OD(e,(c,u,l)=>{if((typeof u=="string"||typeof u=="number")&&(!n||!n(c,u))){const d=`--${t?`${t}-`:""}${c.join("-")}`,h=PD(c,u);Object.assign(s,{[d]:h}),N5(o,c,`var(${d})`,l),N5(i,c,`var(${d}, ${h})`,l)}},c=>c[0]==="vars"),{css:s,vars:o,varsWithDefaults:i}}function FD(e,r={}){const{getSelector:t=m,disableCssColorScheme:n,colorSchemeSelector:s}=r,{colorSchemes:o={},components:i,defaultColorScheme:c="light",...u}=e,{vars:l,css:d,varsWithDefaults:h}=X4(u,r);let f=h;const p={},{[c]:v,...g}=o;if(Object.entries(g||{}).forEach(([S,C])=>{const{vars:L,css:O,varsWithDefaults:H}=X4(C,r);f=Ki(f,H),p[S]={css:O,vars:L}}),v){const{css:S,vars:C,varsWithDefaults:L}=X4(v,r);f=Ki(f,L),p[c]={css:S,vars:C}}function m(S,C){var O,H;let L=s;if(s==="class"&&(L=".%s"),s==="data"&&(L="[data-%s]"),s!=null&&s.startsWith("data-")&&!s.includes("%s")&&(L=`[${s}="%s"]`),S){if(L==="media")return e.defaultColorScheme===S?":root":{[`@media (prefers-color-scheme: ${((H=(O=o[S])==null?void 0:O.palette)==null?void 0:H.mode)||S})`]:{":root":C}};if(L)return e.defaultColorScheme===S?`:root, ${L.replace("%s",String(S))}`:L.replace("%s",String(S))}return":root"}return{vars:f,generateThemeVars:()=>{let S={...l};return Object.entries(p).forEach(([,{vars:C}])=>{S=Ki(S,C)}),S},generateStyleSheets:()=>{var z,q;const S=[],C=e.defaultColorScheme||"light";function L(D,W){Object.keys(W).length&&S.push(typeof D=="string"?{[D]:{...W}}:D)}L(t(void 0,{...d}),d);const{[C]:O,...H}=p;if(O){const{css:D}=O,W=(q=(z=o[C])==null?void 0:z.palette)==null?void 0:q.mode,P=!n&&W?{colorScheme:W,...D}:{...D};L(t(C,{...P}),P)}return Object.entries(H).forEach(([D,{css:W}])=>{var U,k;const P=(k=(U=o[D])==null?void 0:U.palette)==null?void 0:k.mode,I=!n&&P?{colorScheme:P,...W}:{...W};L(t(D,{...I}),I)}),S}}}function BD(e){return function(t){return e==="media"?`@media (prefers-color-scheme: ${t})`:e?e.startsWith("data-")&&!e.includes("%s")?`[${e}="${t}"] &`:e==="class"?`.${t} &`:e==="data"?`[data-${t}] &`:`${e.replace("%s",t)} &`:"&"}}const zD=Km(),$D=v6("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,r[`maxWidth${yr(String(t.maxWidth))}`],t.fixed&&r.fixed,t.disableGutters&&r.disableGutters]}}),UD=e=>x6({props:e,name:"MuiContainer",defaultTheme:zD}),HD=(e,r)=>{const t=u=>an(r,u),{classes:n,fixed:s,disableGutters:o,maxWidth:i}=e,c={root:["root",i&&`maxWidth${yr(String(i))}`,s&&"fixed",o&&"disableGutters"]};return nn(c,t,n)};function VD(e={}){const{createStyledComponent:r=$D,useThemeProps:t=UD,componentName:n="MuiContainer"}=e,s=r(({theme:i,ownerState:c})=>({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",...!c.disableGutters&&{paddingLeft:i.spacing(2),paddingRight:i.spacing(2),[i.breakpoints.up("sm")]:{paddingLeft:i.spacing(3),paddingRight:i.spacing(3)}}}),({theme:i,ownerState:c})=>c.fixed&&Object.keys(i.breakpoints.values).reduce((u,l)=>{const d=l,h=i.breakpoints.values[d];return h!==0&&(u[i.breakpoints.up(d)]={maxWidth:`${h}${i.breakpoints.unit}`}),u},{}),({theme:i,ownerState:c})=>({...c.maxWidth==="xs"&&{[i.breakpoints.up("xs")]:{maxWidth:Math.max(i.breakpoints.values.xs,444)}},...c.maxWidth&&c.maxWidth!=="xs"&&{[i.breakpoints.up(c.maxWidth)]:{maxWidth:`${i.breakpoints.values[c.maxWidth]}${i.breakpoints.unit}`}}}));return G.forwardRef(function(c,u){const l=t(c),{className:d,component:h="div",disableGutters:f=!1,fixed:p=!1,maxWidth:v="lg",classes:g,...m}=l,b={...l,component:h,disableGutters:f,fixed:p,maxWidth:v},y=HD(b,n);return a.jsx(s,{as:h,ownerState:b,className:Pr(y.root,d),ref:u,...m})})}function Xy(e,r){var t,n,s;return G.isValidElement(e)&&r.indexOf(e.type.muiName??((s=(n=(t=e.type)==null?void 0:t._payload)==null?void 0:n.value)==null?void 0:s.muiName))!==-1}const WD=(e,r)=>e.filter(t=>r.includes(t)),Ym=(e,r,t)=>{const n=e.keys[0];Array.isArray(r)?r.forEach((s,o)=>{t((i,c)=>{o<=e.keys.length-1&&(o===0?Object.assign(i,c):i[e.up(e.keys[o])]=c)},s)}):r&&typeof r=="object"?(Object.keys(r).length>e.keys.length?e.keys:WD(e.keys,Object.keys(r))).forEach(o=>{if(e.keys.includes(o)){const i=r[o];i!==void 0&&t((c,u)=>{n===o?Object.assign(c,u):c[e.up(o)]=u},i)}}):(typeof r=="number"||typeof r=="string")&&t((s,o)=>{Object.assign(s,o)},r)};function i2(e){return`--Grid-${e}Spacing`}function cw(e){return`--Grid-parent-${e}Spacing`}const T5="--Grid-columns",Rm="--Grid-parent-columns",qD=({theme:e,ownerState:r})=>{const t={};return Ym(e.breakpoints,r.size,(n,s)=>{let o={};s==="grow"&&(o={flexBasis:0,flexGrow:1,maxWidth:"100%"}),s==="auto"&&(o={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"}),typeof s=="number"&&(o={flexGrow:0,flexBasis:"auto",width:`calc(100% * ${s} / var(${Rm}) - (var(${Rm}) - ${s}) * (var(${cw("column")}) / var(${Rm})))`}),n(t,o)}),t},GD=({theme:e,ownerState:r})=>{const t={};return Ym(e.breakpoints,r.offset,(n,s)=>{let o={};s==="auto"&&(o={marginLeft:"auto"}),typeof s=="number"&&(o={marginLeft:s===0?"0px":`calc(100% * ${s} / var(${Rm}) + var(${cw("column")}) * ${s} / var(${Rm}))`}),n(t,o)}),t},KD=({theme:e,ownerState:r})=>{if(!r.container)return{};const t={[T5]:12};return Ym(e.breakpoints,r.columns,(n,s)=>{const o=s??12;n(t,{[T5]:o,"> *":{[Rm]:o}})}),t},XD=({theme:e,ownerState:r})=>{if(!r.container)return{};const t={};return Ym(e.breakpoints,r.rowSpacing,(n,s)=>{var i;const o=typeof s=="string"?s:(i=e.spacing)==null?void 0:i.call(e,s);n(t,{[i2("row")]:o,"> *":{[cw("row")]:o}})}),t},YD=({theme:e,ownerState:r})=>{if(!r.container)return{};const t={};return Ym(e.breakpoints,r.columnSpacing,(n,s)=>{var i;const o=typeof s=="string"?s:(i=e.spacing)==null?void 0:i.call(e,s);n(t,{[i2("column")]:o,"> *":{[cw("column")]:o}})}),t},ZD=({theme:e,ownerState:r})=>{if(!r.container)return{};const t={};return Ym(e.breakpoints,r.direction,(n,s)=>{n(t,{flexDirection:s})}),t},JD=({ownerState:e})=>({minWidth:0,boxSizing:"border-box",...e.container&&{display:"flex",flexWrap:"wrap",...e.wrap&&e.wrap!=="wrap"&&{flexWrap:e.wrap},gap:`var(${i2("row")}) var(${i2("column")})`}}),QD=e=>{const r=[];return Object.entries(e).forEach(([t,n])=>{n!==!1&&n!==void 0&&r.push(`grid-${t}-${String(n)}`)}),r},eI=(e,r="xs")=>{function t(n){return n===void 0?!1:typeof n=="string"&&!Number.isNaN(Number(n))||typeof n=="number"&&n>0}if(t(e))return[`spacing-${r}-${String(e)}`];if(typeof e=="object"&&!Array.isArray(e)){const n=[];return Object.entries(e).forEach(([s,o])=>{t(o)&&n.push(`spacing-${s}-${String(o)}`)}),n}return[]},tI=e=>e===void 0?[]:typeof e=="object"?Object.entries(e).map(([r,t])=>`direction-${r}-${t}`):[`direction-xs-${String(e)}`];function rI(e,r){e.item!==void 0&&delete e.item,e.zeroMinWidth!==void 0&&delete e.zeroMinWidth,r.keys.forEach(t=>{e[t]!==void 0&&delete e[t]})}const nI=Km(),aI=v6("div",{name:"MuiGrid",slot:"Root"});function sI(e){return x6({props:e,name:"MuiGrid",defaultTheme:nI})}function iI(e={}){const{createStyledComponent:r=aI,useThemeProps:t=sI,useTheme:n=ax,componentName:s="MuiGrid"}=e,o=(l,d)=>{const{container:h,direction:f,spacing:p,wrap:v,size:g}=l,m={root:["root",h&&"container",v!=="wrap"&&`wrap-xs-${String(v)}`,...tI(f),...QD(g),...h?eI(p,d.breakpoints.keys[0]):[]]};return nn(m,b=>an(s,b),{})};function i(l,d,h=()=>!0){const f={};return l===null||(Array.isArray(l)?l.forEach((p,v)=>{p!==null&&h(p)&&d.keys[v]&&(f[d.keys[v]]=p)}):typeof l=="object"?Object.keys(l).forEach(p=>{const v=l[p];v!=null&&h(v)&&(f[p]=v)}):f[d.keys[0]]=l),f}const c=r(KD,YD,XD,qD,ZD,JD,GD),u=G.forwardRef(function(d,h){const f=n(),p=t(d),v=aw(p);rI(v,f.breakpoints);const{className:g,children:m,columns:b=12,container:y=!1,component:S="div",direction:C="row",wrap:L="wrap",size:O={},offset:H={},spacing:z=0,rowSpacing:q=z,columnSpacing:D=z,unstable_level:W=0,...P}=v,I=i(O,f.breakpoints,V=>V!==!1),U=i(H,f.breakpoints),k=d.columns??(W?void 0:b),_=d.spacing??(W?void 0:z),R=d.rowSpacing??d.spacing??(W?void 0:q),j=d.columnSpacing??d.spacing??(W?void 0:D),A={...v,level:W,columns:k,container:y,direction:C,wrap:L,spacing:_,rowSpacing:R,columnSpacing:j,size:I,offset:U},N=o(A,f);return a.jsx(c,{ref:h,as:S,ownerState:A,className:Pr(N.root,g),...P,children:G.Children.map(m,V=>{var M;return G.isValidElement(V)&&Xy(V,["Grid"])&&y&&V.props.container?G.cloneElement(V,{unstable_level:((M=V.props)==null?void 0:M.unstable_level)??W+1}):V})})});return u.muiName="Grid",u}const oI=Km(),lI=v6("div",{name:"MuiStack",slot:"Root"});function cI(e){return x6({props:e,name:"MuiStack",defaultTheme:oI})}function uI(e,r){const t=G.Children.toArray(e).filter(Boolean);return t.reduce((n,s,o)=>(n.push(s),o<t.length-1&&n.push(G.cloneElement(r,{key:`separator-${o}`})),n),[])}const dI=e=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[e],fI=({ownerState:e,theme:r})=>{let t={display:"flex",flexDirection:"column",...Zc({theme:r},V4({values:e.direction,breakpoints:r.breakpoints.values}),n=>({flexDirection:n}))};if(e.spacing){const n=J2(r),s=Object.keys(r.breakpoints.values).reduce((u,l)=>((typeof e.spacing=="object"&&e.spacing[l]!=null||typeof e.direction=="object"&&e.direction[l]!=null)&&(u[l]=!0),u),{}),o=V4({values:e.direction,base:s}),i=V4({values:e.spacing,base:s});typeof o=="object"&&Object.keys(o).forEach((u,l,d)=>{if(!o[u]){const f=l>0?o[d[l-1]]:"column";o[u]=f}}),t=Ki(t,Zc({theme:r},i,(u,l)=>e.useFlexGap?{gap:L0(n,u)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${dI(l?o[l]:e.direction)}`]:L0(n,u)}}))}return t=AL(r.breakpoints,t),t};function hI(e={}){const{createStyledComponent:r=lI,useThemeProps:t=cI,componentName:n="MuiStack"}=e,s=()=>nn({root:["root"]},u=>an(n,u),{}),o=r(fI);return G.forwardRef(function(u,l){const d=t(u),h=aw(d),{component:f="div",direction:p="column",spacing:v=0,divider:g,children:m,className:b,useFlexGap:y=!1,...S}=h,C={direction:p,spacing:v,useFlexGap:y},L=s();return a.jsx(o,{as:f,ownerState:C,ref:l,className:Pr(L.root,b),...S,children:g?uI(m,g):m})})}const Rv={black:"#000",white:"#fff"},pI={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},dm={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},fm={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},E1={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},hm={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},pm={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},mm={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"};function Rk(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Rv.white,default:Rv.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const mI=Rk();function Ek(){return{text:{primary:Rv.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Rv.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const L5=Ek();function M5(e,r,t,n){const s=n.light||n,o=n.dark||n*1.5;e[r]||(e.hasOwnProperty(t)?e[r]=e[t]:r==="light"?e.light=Dm(e.main,s):r==="dark"&&(e.dark=Mm(e.main,o)))}function gI(e="light"){return e==="dark"?{main:hm[200],light:hm[50],dark:hm[400]}:{main:hm[700],light:hm[400],dark:hm[800]}}function vI(e="light"){return e==="dark"?{main:dm[200],light:dm[50],dark:dm[400]}:{main:dm[500],light:dm[300],dark:dm[700]}}function xI(e="light"){return e==="dark"?{main:fm[500],light:fm[300],dark:fm[700]}:{main:fm[700],light:fm[400],dark:fm[800]}}function bI(e="light"){return e==="dark"?{main:pm[400],light:pm[300],dark:pm[700]}:{main:pm[700],light:pm[500],dark:pm[900]}}function yI(e="light"){return e==="dark"?{main:mm[400],light:mm[300],dark:mm[700]}:{main:mm[800],light:mm[500],dark:mm[900]}}function wI(e="light"){return e==="dark"?{main:E1[400],light:E1[300],dark:E1[700]}:{main:"#ed6c02",light:E1[500],dark:E1[900]}}function b6(e){const{mode:r="light",contrastThreshold:t=3,tonalOffset:n=.2,...s}=e,o=e.primary||gI(r),i=e.secondary||vI(r),c=e.error||xI(r),u=e.info||bI(r),l=e.success||yI(r),d=e.warning||wI(r);function h(g){return mL(g,L5.text.primary)>=t?L5.text.primary:mI.text.primary}const f=({color:g,name:m,mainShade:b=500,lightShade:y=300,darkShade:S=700})=>{if(g={...g},!g.main&&g[b]&&(g.main=g[b]),!g.hasOwnProperty("main"))throw new Error(Id(11,m?` (${m})`:"",b));if(typeof g.main!="string")throw new Error(Id(12,m?` (${m})`:"",JSON.stringify(g.main)));return M5(g,"light",y,n),M5(g,"dark",S,n),g.contrastText||(g.contrastText=h(g.main)),g};let p;return r==="light"?p=Rk():r==="dark"&&(p=Ek()),Ki({common:{...Rv},mode:r,primary:f({color:o,name:"primary"}),secondary:f({color:i,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:f({color:c,name:"error"}),warning:f({color:d,name:"warning"}),info:f({color:u,name:"info"}),success:f({color:l,name:"success"}),grey:pI,contrastThreshold:t,getContrastText:h,augmentColor:f,tonalOffset:n,...p},s)}function SI(e){const r={};return Object.entries(e).forEach(n=>{const[s,o]=n;typeof o=="object"&&(r[s]=`${o.fontStyle?`${o.fontStyle} `:""}${o.fontVariant?`${o.fontVariant} `:""}${o.fontWeight?`${o.fontWeight} `:""}${o.fontStretch?`${o.fontStretch} `:""}${o.fontSize||""}${o.lineHeight?`/${o.lineHeight} `:""}${o.fontFamily||""}`)}),r}function _I(e,r){return{toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}},...r}}function AI(e){return Math.round(e*1e5)/1e5}const D5={textTransform:"uppercase"},I5='"Roboto", "Helvetica", "Arial", sans-serif';function CI(e,r){const{fontFamily:t=I5,fontSize:n=14,fontWeightLight:s=300,fontWeightRegular:o=400,fontWeightMedium:i=500,fontWeightBold:c=700,htmlFontSize:u=16,allVariants:l,pxToRem:d,...h}=typeof r=="function"?r(e):r,f=n/14,p=d||(m=>`${m/u*f}rem`),v=(m,b,y,S,C)=>({fontFamily:t,fontWeight:m,fontSize:p(b),lineHeight:y,...t===I5?{letterSpacing:`${AI(S/b)}em`}:{},...C,...l}),g={h1:v(s,96,1.167,-1.5),h2:v(s,60,1.2,-.5),h3:v(o,48,1.167,0),h4:v(o,34,1.235,.25),h5:v(o,24,1.334,0),h6:v(i,20,1.6,.15),subtitle1:v(o,16,1.75,.15),subtitle2:v(i,14,1.57,.1),body1:v(o,16,1.5,.15),body2:v(o,14,1.43,.15),button:v(i,14,1.75,.4,D5),caption:v(o,12,1.66,.4),overline:v(o,12,2.66,1,D5),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Ki({htmlFontSize:u,pxToRem:p,fontFamily:t,fontSize:n,fontWeightLight:s,fontWeightRegular:o,fontWeightMedium:i,fontWeightBold:c,...g},h,{clone:!1})}const jI=.2,kI=.14,RI=.12;function Us(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,${jI})`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,${kI})`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,${RI})`].join(",")}const EI=["none",Us(0,2,1,-1,0,1,1,0,0,1,3,0),Us(0,3,1,-2,0,2,2,0,0,1,5,0),Us(0,3,3,-2,0,3,4,0,0,1,8,0),Us(0,2,4,-1,0,4,5,0,0,1,10,0),Us(0,3,5,-1,0,5,8,0,0,1,14,0),Us(0,3,5,-1,0,6,10,0,0,1,18,0),Us(0,4,5,-2,0,7,10,1,0,2,16,1),Us(0,5,5,-3,0,8,10,1,0,3,14,2),Us(0,5,6,-3,0,9,12,1,0,3,16,2),Us(0,6,6,-3,0,10,14,1,0,4,18,3),Us(0,6,7,-4,0,11,15,1,0,4,20,3),Us(0,7,8,-4,0,12,17,2,0,5,22,4),Us(0,7,8,-4,0,13,19,2,0,5,24,4),Us(0,7,9,-4,0,14,21,2,0,5,26,4),Us(0,8,9,-5,0,15,22,2,0,6,28,5),Us(0,8,10,-5,0,16,24,2,0,6,30,5),Us(0,8,11,-5,0,17,26,2,0,6,32,5),Us(0,9,11,-5,0,18,28,2,0,7,34,6),Us(0,9,12,-6,0,19,29,2,0,7,36,6),Us(0,10,13,-6,0,20,31,3,0,8,38,7),Us(0,10,13,-6,0,21,33,3,0,8,40,7),Us(0,10,14,-6,0,22,35,3,0,8,42,7),Us(0,11,14,-7,0,23,36,3,0,9,44,8),Us(0,11,15,-7,0,24,38,3,0,9,46,8)],NI={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},TI={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function O5(e){return`${Math.round(e)}ms`}function LI(e){if(!e)return 0;const r=e/36;return Math.min(Math.round((4+15*r**.25+r/5)*10),3e3)}function MI(e){const r={...NI,...e.easing},t={...TI,...e.duration};return{getAutoHeightDuration:LI,create:(s=["all"],o={})=>{const{duration:i=t.standard,easing:c=r.easeInOut,delay:u=0,...l}=o;return(Array.isArray(s)?s:[s]).map(d=>`${d} ${typeof i=="string"?i:O5(i)} ${c} ${typeof u=="string"?u:O5(u)}`).join(",")},...e,easing:r,duration:t}}const DI={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function II(e){return Pu(e)||typeof e>"u"||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||Array.isArray(e)}function Nk(e={}){const r={...e};function t(n){const s=Object.entries(n);for(let o=0;o<s.length;o++){const[i,c]=s[o];!II(c)||i.startsWith("unstable_")?delete n[i]:Pu(c)&&(n[i]={...c},t(n[i]))}}return t(r),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(r,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function uS(e={},...r){const{breakpoints:t,mixins:n={},spacing:s,palette:o={},transitions:i={},typography:c={},shape:u,...l}=e;if(e.vars&&e.generateThemeVars===void 0)throw new Error(Id(20));const d=b6(o),h=Km(e);let f=Ki(h,{mixins:_I(h.breakpoints,n),palette:d,shadows:EI.slice(),typography:CI(d,c),transitions:MI(i),zIndex:{...DI}});return f=Ki(f,l),f=r.reduce((p,v)=>Ki(p,v),f),f.unstable_sxConfig={...tx,...l==null?void 0:l.unstable_sxConfig},f.unstable_sx=function(v){return M0({sx:v,theme:this})},f.toRuntimeSource=Nk,f}function dS(e){let r;return e<1?r=5.11916*e**2:r=4.5*Math.log(e+1)+2,Math.round(r*10)/1e3}const OI=[...Array(25)].map((e,r)=>{if(r===0)return"none";const t=dS(r);return`linear-gradient(rgba(255 255 255 / ${t}), rgba(255 255 255 / ${t}))`});function Tk(e){return{inputPlaceholder:e==="dark"?.5:.42,inputUnderline:e==="dark"?.7:.42,switchTrackDisabled:e==="dark"?.2:.12,switchTrack:e==="dark"?.3:.38}}function Lk(e){return e==="dark"?OI:[]}function PI(e){const{palette:r={mode:"light"},opacity:t,overlays:n,...s}=e,o=b6(r);return{palette:o,opacity:{...Tk(o.mode),...t},overlays:n||Lk(o.mode),...s}}function FI(e){var r;return!!e[0].match(/(cssVarPrefix|colorSchemeSelector|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!e[0].match(/sxConfig$/)||e[0]==="palette"&&!!((r=e[1])!=null&&r.match(/(mode|contrastThreshold|tonalOffset)/))}const BI=e=>[...[...Array(25)].map((r,t)=>`--${e?`${e}-`:""}overlays-${t}`),`--${e?`${e}-`:""}palette-AppBar-darkBg`,`--${e?`${e}-`:""}palette-AppBar-darkColor`],zI=e=>(r,t)=>{const n=e.rootSelector||":root",s=e.colorSchemeSelector;let o=s;if(s==="class"&&(o=".%s"),s==="data"&&(o="[data-%s]"),s!=null&&s.startsWith("data-")&&!s.includes("%s")&&(o=`[${s}="%s"]`),e.defaultColorScheme===r){if(r==="dark"){const i={};return BI(e.cssVarPrefix).forEach(c=>{i[c]=t[c],delete t[c]}),o==="media"?{[n]:t,"@media (prefers-color-scheme: dark)":{[n]:i}}:o?{[o.replace("%s",r)]:i,[`${n}, ${o.replace("%s",r)}`]:t}:{[n]:{...t,...i}}}if(o&&o!=="media")return`${n}, ${o.replace("%s",String(r))}`}else if(r){if(o==="media")return{[`@media (prefers-color-scheme: ${String(r)})`]:{[n]:t}};if(o)return o.replace("%s",String(r))}return n};function $I(e,r){r.forEach(t=>{e[t]||(e[t]={})})}function fr(e,r,t){!e[r]&&t&&(e[r]=t)}function Y1(e){return typeof e!="string"||!e.startsWith("hsl")?e:rk(e)}function Ad(e,r){`${r}Channel`in e||(e[`${r}Channel`]=X1(Y1(e[r])))}function UI(e){return typeof e=="number"?`${e}px`:typeof e=="string"||typeof e=="function"||Array.isArray(e)?e:"8px"}const Eu=e=>{try{return e()}catch{}},HI=(e="mui")=>ID(e);function Y4(e,r,t,n){if(!r)return;r=r===!0?{}:r;const s=n==="dark"?"dark":"light";if(!t){e[n]=PI({...r,palette:{mode:s,...r==null?void 0:r.palette}});return}const{palette:o,...i}=uS({...t,palette:{mode:s,...r==null?void 0:r.palette}});return e[n]={...r,palette:o,opacity:{...Tk(s),...r==null?void 0:r.opacity},overlays:(r==null?void 0:r.overlays)||Lk(s)},i}function VI(e={},...r){const{colorSchemes:t={light:!0},defaultColorScheme:n,disableCssColorScheme:s=!1,cssVarPrefix:o="mui",shouldSkipGeneratingVar:i=FI,colorSchemeSelector:c=t.light&&t.dark?"media":void 0,rootSelector:u=":root",...l}=e,d=Object.keys(t)[0],h=n||(t.light&&d!=="light"?"light":d),f=HI(o),{[h]:p,light:v,dark:g,...m}=t,b={...m};let y=p;if((h==="dark"&&!("dark"in t)||h==="light"&&!("light"in t))&&(y=!0),!y)throw new Error(Id(21,h));const S=Y4(b,y,l,h);v&&!b.light&&Y4(b,v,void 0,"light"),g&&!b.dark&&Y4(b,g,void 0,"dark");let C={defaultColorScheme:h,...S,cssVarPrefix:o,colorSchemeSelector:c,rootSelector:u,getCssVar:f,colorSchemes:b,font:{...SI(S.typography),...S.font},spacing:UI(l.spacing)};Object.keys(C.colorSchemes).forEach(q=>{const D=C.colorSchemes[q].palette,W=P=>{const I=P.split("-"),U=I[1],k=I[2];return f(P,D[U][k])};if(D.mode==="light"&&(fr(D.common,"background","#fff"),fr(D.common,"onBackground","#000")),D.mode==="dark"&&(fr(D.common,"background","#000"),fr(D.common,"onBackground","#fff")),$I(D,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),D.mode==="light"){fr(D.Alert,"errorColor",gs(D.error.light,.6)),fr(D.Alert,"infoColor",gs(D.info.light,.6)),fr(D.Alert,"successColor",gs(D.success.light,.6)),fr(D.Alert,"warningColor",gs(D.warning.light,.6)),fr(D.Alert,"errorFilledBg",W("palette-error-main")),fr(D.Alert,"infoFilledBg",W("palette-info-main")),fr(D.Alert,"successFilledBg",W("palette-success-main")),fr(D.Alert,"warningFilledBg",W("palette-warning-main")),fr(D.Alert,"errorFilledColor",Eu(()=>D.getContrastText(D.error.main))),fr(D.Alert,"infoFilledColor",Eu(()=>D.getContrastText(D.info.main))),fr(D.Alert,"successFilledColor",Eu(()=>D.getContrastText(D.success.main))),fr(D.Alert,"warningFilledColor",Eu(()=>D.getContrastText(D.warning.main))),fr(D.Alert,"errorStandardBg",vs(D.error.light,.9)),fr(D.Alert,"infoStandardBg",vs(D.info.light,.9)),fr(D.Alert,"successStandardBg",vs(D.success.light,.9)),fr(D.Alert,"warningStandardBg",vs(D.warning.light,.9)),fr(D.Alert,"errorIconColor",W("palette-error-main")),fr(D.Alert,"infoIconColor",W("palette-info-main")),fr(D.Alert,"successIconColor",W("palette-success-main")),fr(D.Alert,"warningIconColor",W("palette-warning-main")),fr(D.AppBar,"defaultBg",W("palette-grey-100")),fr(D.Avatar,"defaultBg",W("palette-grey-400")),fr(D.Button,"inheritContainedBg",W("palette-grey-300")),fr(D.Button,"inheritContainedHoverBg",W("palette-grey-A100")),fr(D.Chip,"defaultBorder",W("palette-grey-400")),fr(D.Chip,"defaultAvatarColor",W("palette-grey-700")),fr(D.Chip,"defaultIconColor",W("palette-grey-700")),fr(D.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),fr(D.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),fr(D.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),fr(D.LinearProgress,"primaryBg",vs(D.primary.main,.62)),fr(D.LinearProgress,"secondaryBg",vs(D.secondary.main,.62)),fr(D.LinearProgress,"errorBg",vs(D.error.main,.62)),fr(D.LinearProgress,"infoBg",vs(D.info.main,.62)),fr(D.LinearProgress,"successBg",vs(D.success.main,.62)),fr(D.LinearProgress,"warningBg",vs(D.warning.main,.62)),fr(D.Skeleton,"bg",`rgba(${W("palette-text-primaryChannel")} / 0.11)`),fr(D.Slider,"primaryTrack",vs(D.primary.main,.62)),fr(D.Slider,"secondaryTrack",vs(D.secondary.main,.62)),fr(D.Slider,"errorTrack",vs(D.error.main,.62)),fr(D.Slider,"infoTrack",vs(D.info.main,.62)),fr(D.Slider,"successTrack",vs(D.success.main,.62)),fr(D.Slider,"warningTrack",vs(D.warning.main,.62));const P=py(D.background.default,.8);fr(D.SnackbarContent,"bg",P),fr(D.SnackbarContent,"color",Eu(()=>D.getContrastText(P))),fr(D.SpeedDialAction,"fabHoverBg",py(D.background.paper,.15)),fr(D.StepConnector,"border",W("palette-grey-400")),fr(D.StepContent,"border",W("palette-grey-400")),fr(D.Switch,"defaultColor",W("palette-common-white")),fr(D.Switch,"defaultDisabledColor",W("palette-grey-100")),fr(D.Switch,"primaryDisabledColor",vs(D.primary.main,.62)),fr(D.Switch,"secondaryDisabledColor",vs(D.secondary.main,.62)),fr(D.Switch,"errorDisabledColor",vs(D.error.main,.62)),fr(D.Switch,"infoDisabledColor",vs(D.info.main,.62)),fr(D.Switch,"successDisabledColor",vs(D.success.main,.62)),fr(D.Switch,"warningDisabledColor",vs(D.warning.main,.62)),fr(D.TableCell,"border",vs(hy(D.divider,1),.88)),fr(D.Tooltip,"bg",hy(D.grey[700],.92))}if(D.mode==="dark"){fr(D.Alert,"errorColor",vs(D.error.light,.6)),fr(D.Alert,"infoColor",vs(D.info.light,.6)),fr(D.Alert,"successColor",vs(D.success.light,.6)),fr(D.Alert,"warningColor",vs(D.warning.light,.6)),fr(D.Alert,"errorFilledBg",W("palette-error-dark")),fr(D.Alert,"infoFilledBg",W("palette-info-dark")),fr(D.Alert,"successFilledBg",W("palette-success-dark")),fr(D.Alert,"warningFilledBg",W("palette-warning-dark")),fr(D.Alert,"errorFilledColor",Eu(()=>D.getContrastText(D.error.dark))),fr(D.Alert,"infoFilledColor",Eu(()=>D.getContrastText(D.info.dark))),fr(D.Alert,"successFilledColor",Eu(()=>D.getContrastText(D.success.dark))),fr(D.Alert,"warningFilledColor",Eu(()=>D.getContrastText(D.warning.dark))),fr(D.Alert,"errorStandardBg",gs(D.error.light,.9)),fr(D.Alert,"infoStandardBg",gs(D.info.light,.9)),fr(D.Alert,"successStandardBg",gs(D.success.light,.9)),fr(D.Alert,"warningStandardBg",gs(D.warning.light,.9)),fr(D.Alert,"errorIconColor",W("palette-error-main")),fr(D.Alert,"infoIconColor",W("palette-info-main")),fr(D.Alert,"successIconColor",W("palette-success-main")),fr(D.Alert,"warningIconColor",W("palette-warning-main")),fr(D.AppBar,"defaultBg",W("palette-grey-900")),fr(D.AppBar,"darkBg",W("palette-background-paper")),fr(D.AppBar,"darkColor",W("palette-text-primary")),fr(D.Avatar,"defaultBg",W("palette-grey-600")),fr(D.Button,"inheritContainedBg",W("palette-grey-800")),fr(D.Button,"inheritContainedHoverBg",W("palette-grey-700")),fr(D.Chip,"defaultBorder",W("palette-grey-700")),fr(D.Chip,"defaultAvatarColor",W("palette-grey-300")),fr(D.Chip,"defaultIconColor",W("palette-grey-300")),fr(D.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),fr(D.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),fr(D.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),fr(D.LinearProgress,"primaryBg",gs(D.primary.main,.5)),fr(D.LinearProgress,"secondaryBg",gs(D.secondary.main,.5)),fr(D.LinearProgress,"errorBg",gs(D.error.main,.5)),fr(D.LinearProgress,"infoBg",gs(D.info.main,.5)),fr(D.LinearProgress,"successBg",gs(D.success.main,.5)),fr(D.LinearProgress,"warningBg",gs(D.warning.main,.5)),fr(D.Skeleton,"bg",`rgba(${W("palette-text-primaryChannel")} / 0.13)`),fr(D.Slider,"primaryTrack",gs(D.primary.main,.5)),fr(D.Slider,"secondaryTrack",gs(D.secondary.main,.5)),fr(D.Slider,"errorTrack",gs(D.error.main,.5)),fr(D.Slider,"infoTrack",gs(D.info.main,.5)),fr(D.Slider,"successTrack",gs(D.success.main,.5)),fr(D.Slider,"warningTrack",gs(D.warning.main,.5));const P=py(D.background.default,.98);fr(D.SnackbarContent,"bg",P),fr(D.SnackbarContent,"color",Eu(()=>D.getContrastText(P))),fr(D.SpeedDialAction,"fabHoverBg",py(D.background.paper,.15)),fr(D.StepConnector,"border",W("palette-grey-600")),fr(D.StepContent,"border",W("palette-grey-600")),fr(D.Switch,"defaultColor",W("palette-grey-300")),fr(D.Switch,"defaultDisabledColor",W("palette-grey-600")),fr(D.Switch,"primaryDisabledColor",gs(D.primary.main,.55)),fr(D.Switch,"secondaryDisabledColor",gs(D.secondary.main,.55)),fr(D.Switch,"errorDisabledColor",gs(D.error.main,.55)),fr(D.Switch,"infoDisabledColor",gs(D.info.main,.55)),fr(D.Switch,"successDisabledColor",gs(D.success.main,.55)),fr(D.Switch,"warningDisabledColor",gs(D.warning.main,.55)),fr(D.TableCell,"border",gs(hy(D.divider,1),.68)),fr(D.Tooltip,"bg",hy(D.grey[700],.92))}Ad(D.background,"default"),Ad(D.background,"paper"),Ad(D.common,"background"),Ad(D.common,"onBackground"),Ad(D,"divider"),Object.keys(D).forEach(P=>{const I=D[P];P!=="tonalOffset"&&I&&typeof I=="object"&&(I.main&&fr(D[P],"mainChannel",X1(Y1(I.main))),I.light&&fr(D[P],"lightChannel",X1(Y1(I.light))),I.dark&&fr(D[P],"darkChannel",X1(Y1(I.dark))),I.contrastText&&fr(D[P],"contrastTextChannel",X1(Y1(I.contrastText))),P==="text"&&(Ad(D[P],"primary"),Ad(D[P],"secondary")),P==="action"&&(I.active&&Ad(D[P],"active"),I.selected&&Ad(D[P],"selected")))})}),C=r.reduce((q,D)=>Ki(q,D),C);const L={prefix:o,disableCssColorScheme:s,shouldSkipGeneratingVar:i,getSelector:zI(C)},{vars:O,generateThemeVars:H,generateStyleSheets:z}=FD(C,L);return C.vars=O,Object.entries(C.colorSchemes[C.defaultColorScheme]).forEach(([q,D])=>{C[q]=D}),C.generateThemeVars=H,C.generateStyleSheets=z,C.generateSpacing=function(){return Ak(l.spacing,J2(this))},C.getColorSchemeSelector=BD(c),C.spacing=C.generateSpacing(),C.shouldSkipGeneratingVar=i,C.unstable_sxConfig={...tx,...l==null?void 0:l.unstable_sxConfig},C.unstable_sx=function(D){return M0({sx:D,theme:this})},C.toRuntimeSource=Nk,C}function P5(e,r,t){e.colorSchemes&&t&&(e.colorSchemes[r]={...t!==!0&&t,palette:b6({...t===!0?{}:t.palette,mode:r})})}function Mk(e={},...r){const{palette:t,cssVariables:n=!1,colorSchemes:s=t?void 0:{light:!0},defaultColorScheme:o=t==null?void 0:t.mode,...i}=e,c=o||"light",u=s==null?void 0:s[c],l={...s,...t?{[c]:{...typeof u!="boolean"&&u,palette:t}}:void 0};if(n===!1){if(!("colorSchemes"in e))return uS(e,...r);let d=t;"palette"in e||l[c]&&(l[c]!==!0?d=l[c].palette:c==="dark"&&(d={mode:"dark"}));const h=uS({...e,palette:d},...r);return h.defaultColorScheme=c,h.colorSchemes=l,h.palette.mode==="light"&&(h.colorSchemes.light={...l.light!==!0&&l.light,palette:h.palette},P5(h,"dark",l.dark)),h.palette.mode==="dark"&&(h.colorSchemes.dark={...l.dark!==!0&&l.dark,palette:h.palette},P5(h,"light",l.light)),h}return!t&&!("light"in l)&&c==="light"&&(l.light=!0),VI({...i,colorSchemes:l,defaultColorScheme:c,...typeof n!="boolean"&&n},...r)}const y6=Mk(),uw="$$material";function Kf(){const e=ax(y6);return e[uw]||e}function WI(e){return a.jsx(bD,{...e,defaultTheme:y6,themeId:uw})}function Dk(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const xl=e=>Dk(e)&&e!=="classes",or=kk({themeId:uw,defaultTheme:y6,rootShouldForwardProp:xl});function qI(e){return function(t){return a.jsx(WI,{styles:typeof e=="function"?n=>e({theme:n,...t}):e})}}function GI(){return aw}const cn=DD;function dn(e){return MD(e)}function KI(e){return an("MuiSvgIcon",e)}un("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const XI=e=>{const{color:r,fontSize:t,classes:n}=e,s={root:["root",r!=="inherit"&&`color${yr(r)}`,`fontSize${yr(t)}`]};return nn(s,KI,n)},YI=or("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,t.color!=="inherit"&&r[`color${yr(t.color)}`],r[`fontSize${yr(t.fontSize)}`]]}})(cn(({theme:e})=>{var r,t,n,s,o,i,c,u,l,d,h,f,p,v;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:(s=(r=e.transitions)==null?void 0:r.create)==null?void 0:s.call(r,"fill",{duration:(n=(t=(e.vars??e).transitions)==null?void 0:t.duration)==null?void 0:n.shorter}),variants:[{props:g=>!g.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:((i=(o=e.typography)==null?void 0:o.pxToRem)==null?void 0:i.call(o,20))||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:((u=(c=e.typography)==null?void 0:c.pxToRem)==null?void 0:u.call(c,24))||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:((d=(l=e.typography)==null?void 0:l.pxToRem)==null?void 0:d.call(l,35))||"2.1875rem"}},...Object.entries((e.vars??e).palette).filter(([,g])=>g&&g.main).map(([g])=>{var m,b;return{props:{color:g},style:{color:(b=(m=(e.vars??e).palette)==null?void 0:m[g])==null?void 0:b.main}}}),{props:{color:"action"},style:{color:(f=(h=(e.vars??e).palette)==null?void 0:h.action)==null?void 0:f.active}},{props:{color:"disabled"},style:{color:(v=(p=(e.vars??e).palette)==null?void 0:p.action)==null?void 0:v.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}})),o2=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiSvgIcon"}),{children:s,className:o,color:i="inherit",component:c="svg",fontSize:u="medium",htmlColor:l,inheritViewBox:d=!1,titleAccess:h,viewBox:f="0 0 24 24",...p}=n,v=G.isValidElement(s)&&s.type==="svg",g={...n,color:i,component:c,fontSize:u,instanceFontSize:r.fontSize,inheritViewBox:d,viewBox:f,hasSvgAsChild:v},m={};d||(m.viewBox=f);const b=XI(g);return a.jsxs(YI,{as:c,className:Pr(b.root,o),focusable:"false",color:l,"aria-hidden":h?void 0:!0,role:h?"img":void 0,ref:t,...m,...p,...v&&s.props,ownerState:g,children:[v?s.props.children:s,h?a.jsx("title",{children:h}):null]})});o2.muiName="SvgIcon";function Hn(e,r){function t(n,s){return a.jsx(o2,{"data-testid":void 0,ref:s,...n,children:e})}return t.muiName=o2.muiName,G.memo(G.forwardRef(t))}function dw(e,r=166){let t;function n(...s){const o=()=>{e.apply(this,s)};clearTimeout(t),t=setTimeout(o,r)}return n.clear=()=>{clearTimeout(t)},n}function co(e){return e&&e.ownerDocument||document}function Qc(e){return co(e).defaultView||window}function fS(e,r){typeof e=="function"?e(r):e&&(e.current=r)}let F5=0;function ZI(e){const[r,t]=G.useState(e),n=e||r;return G.useEffect(()=>{r==null&&(F5+=1,t(`mui-${F5}`))},[r]),n}const JI={...rS},B5=JI.useId;function Od(e){if(B5!==void 0){const r=B5();return e??r}return ZI(e)}function A0(e){const{controlled:r,default:t,name:n,state:s="value"}=e,{current:o}=G.useRef(r!==void 0),[i,c]=G.useState(t),u=o?r:i,l=G.useCallback(d=>{o||c(d)},[]);return[u,l]}function Di(e){const r=G.useRef(e);return Jc(()=>{r.current=e}),G.useRef((...t)=>(0,r.current)(...t)).current}function Ni(...e){const r=G.useRef(void 0),t=G.useCallback(n=>{const s=e.map(o=>{if(o==null)return null;if(typeof o=="function"){const i=o,c=i(n);return typeof c=="function"?c:()=>{i(null)}}return o.current=n,()=>{o.current=null}});return()=>{s.forEach(o=>o==null?void 0:o())}},e);return G.useMemo(()=>e.every(n=>n==null)?null:n=>{r.current&&(r.current(),r.current=void 0),n!=null&&(r.current=t(n))},e)}function QI(e,r){const t=e.charCodeAt(2);return e[0]==="o"&&e[1]==="n"&&t>=65&&t<=90&&typeof r=="function"}function Ik(e,r){if(!e)return r;function t(i,c){const u={};return Object.keys(c).forEach(l=>{QI(l,c[l])&&typeof i[l]=="function"&&(u[l]=(...d)=>{i[l](...d),c[l](...d)})}),u}if(typeof e=="function"||typeof r=="function")return i=>{const c=typeof r=="function"?r(i):r,u=typeof e=="function"?e({...i,...c}):e,l=Pr(i==null?void 0:i.className,c==null?void 0:c.className,u==null?void 0:u.className),d=t(u,c);return{...c,...u,...d,...!!l&&{className:l},...(c==null?void 0:c.style)&&(u==null?void 0:u.style)&&{style:{...c.style,...u.style}},...(c==null?void 0:c.sx)&&(u==null?void 0:u.sx)&&{sx:[...Array.isArray(c.sx)?c.sx:[c.sx],...Array.isArray(u.sx)?u.sx:[u.sx]]}}};const n=r,s=t(e,n),o=Pr(n==null?void 0:n.className,e==null?void 0:e.className);return{...r,...e,...s,...!!o&&{className:o},...(n==null?void 0:n.style)&&(e==null?void 0:e.style)&&{style:{...n.style,...e.style}},...(n==null?void 0:n.sx)&&(e==null?void 0:e.sx)&&{sx:[...Array.isArray(n.sx)?n.sx:[n.sx],...Array.isArray(e.sx)?e.sx:[e.sx]]}}}function l2(e){try{return e.matches(":focus-visible")}catch{}return!1}const z5={};function Ok(e,r){const t=G.useRef(z5);return t.current===z5&&(t.current=e(r)),t}class c2{constructor(){_1(this,"mountEffect",()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())});this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}static create(){return new c2}static use(){const r=Ok(c2.create).current,[t,n]=G.useState(!1);return r.shouldMount=t,r.setShouldMount=n,G.useEffect(r.mountEffect,[t]),r}mount(){return this.mounted||(this.mounted=tO(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}start(...r){this.mount().then(()=>{var t;return(t=this.ref.current)==null?void 0:t.start(...r)})}stop(...r){this.mount().then(()=>{var t;return(t=this.ref.current)==null?void 0:t.stop(...r)})}pulsate(...r){this.mount().then(()=>{var t;return(t=this.ref.current)==null?void 0:t.pulsate(...r)})}}function eO(){return c2.use()}function tO(){let e,r;const t=new Promise((n,s)=>{e=n,r=s});return t.resolve=e,t.reject=r,t}function w6(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}function u2(e,r){return u2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},u2(e,r)}function Pk(e,r){e.prototype=Object.create(r.prototype),e.prototype.constructor=e,u2(e,r)}const $5={disabled:!1},d2=vr.createContext(null);var rO=function(r){return r.scrollTop},Z1="unmounted",p0="exited",m0="entering",Sm="entered",hS="exiting",Gu=function(e){Pk(r,e);function r(n,s){var o;o=e.call(this,n,s)||this;var i=s,c=i&&!i.isMounting?n.enter:n.appear,u;return o.appearStatus=null,n.in?c?(u=p0,o.appearStatus=m0):u=Sm:n.unmountOnExit||n.mountOnEnter?u=Z1:u=p0,o.state={status:u},o.nextCallback=null,o}r.getDerivedStateFromProps=function(s,o){var i=s.in;return i&&o.status===Z1?{status:p0}:null};var t=r.prototype;return t.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},t.componentDidUpdate=function(s){var o=null;if(s!==this.props){var i=this.state.status;this.props.in?i!==m0&&i!==Sm&&(o=m0):(i===m0||i===Sm)&&(o=hS)}this.updateStatus(!1,o)},t.componentWillUnmount=function(){this.cancelNextCallback()},t.getTimeouts=function(){var s=this.props.timeout,o,i,c;return o=i=c=s,s!=null&&typeof s!="number"&&(o=s.exit,i=s.enter,c=s.appear!==void 0?s.appear:i),{exit:o,enter:i,appear:c}},t.updateStatus=function(s,o){if(s===void 0&&(s=!1),o!==null)if(this.cancelNextCallback(),o===m0){if(this.props.unmountOnExit||this.props.mountOnEnter){var i=this.props.nodeRef?this.props.nodeRef.current:fy.findDOMNode(this);i&&rO(i)}this.performEnter(s)}else this.performExit();else this.props.unmountOnExit&&this.state.status===p0&&this.setState({status:Z1})},t.performEnter=function(s){var o=this,i=this.props.enter,c=this.context?this.context.isMounting:s,u=this.props.nodeRef?[c]:[fy.findDOMNode(this),c],l=u[0],d=u[1],h=this.getTimeouts(),f=c?h.appear:h.enter;if(!s&&!i||$5.disabled){this.safeSetState({status:Sm},function(){o.props.onEntered(l)});return}this.props.onEnter(l,d),this.safeSetState({status:m0},function(){o.props.onEntering(l,d),o.onTransitionEnd(f,function(){o.safeSetState({status:Sm},function(){o.props.onEntered(l,d)})})})},t.performExit=function(){var s=this,o=this.props.exit,i=this.getTimeouts(),c=this.props.nodeRef?void 0:fy.findDOMNode(this);if(!o||$5.disabled){this.safeSetState({status:p0},function(){s.props.onExited(c)});return}this.props.onExit(c),this.safeSetState({status:hS},function(){s.props.onExiting(c),s.onTransitionEnd(i.exit,function(){s.safeSetState({status:p0},function(){s.props.onExited(c)})})})},t.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},t.safeSetState=function(s,o){o=this.setNextCallback(o),this.setState(s,o)},t.setNextCallback=function(s){var o=this,i=!0;return this.nextCallback=function(c){i&&(i=!1,o.nextCallback=null,s(c))},this.nextCallback.cancel=function(){i=!1},this.nextCallback},t.onTransitionEnd=function(s,o){this.setNextCallback(o);var i=this.props.nodeRef?this.props.nodeRef.current:fy.findDOMNode(this),c=s==null&&!this.props.addEndListener;if(!i||c){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var u=this.props.nodeRef?[this.nextCallback]:[i,this.nextCallback],l=u[0],d=u[1];this.props.addEndListener(l,d)}s!=null&&setTimeout(this.nextCallback,s)},t.render=function(){var s=this.state.status;if(s===Z1)return null;var o=this.props,i=o.children;o.in,o.mountOnEnter,o.unmountOnExit,o.appear,o.enter,o.exit,o.timeout,o.addEndListener,o.onEnter,o.onEntering,o.onEntered,o.onExit,o.onExiting,o.onExited,o.nodeRef;var c=w6(o,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return vr.createElement(d2.Provider,{value:null},typeof i=="function"?i(s,c):vr.cloneElement(vr.Children.only(i),c))},r}(vr.Component);Gu.contextType=d2;Gu.propTypes={};function gm(){}Gu.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:gm,onEntering:gm,onEntered:gm,onExit:gm,onExiting:gm,onExited:gm};Gu.UNMOUNTED=Z1;Gu.EXITED=p0;Gu.ENTERING=m0;Gu.ENTERED=Sm;Gu.EXITING=hS;function Fk(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S6(e,r){var t=function(o){return r&&G.isValidElement(o)?r(o):o},n=Object.create(null);return e&&G.Children.map(e,function(s){return s}).forEach(function(s){n[s.key]=t(s)}),n}function nO(e,r){e=e||{},r=r||{};function t(d){return d in r?r[d]:e[d]}var n=Object.create(null),s=[];for(var o in e)o in r?s.length&&(n[o]=s,s=[]):s.push(o);var i,c={};for(var u in r){if(n[u])for(i=0;i<n[u].length;i++){var l=n[u][i];c[n[u][i]]=t(l)}c[u]=t(u)}for(i=0;i<s.length;i++)c[s[i]]=t(s[i]);return c}function x0(e,r,t){return t[r]!=null?t[r]:e.props[r]}function aO(e,r){return S6(e.children,function(t){return G.cloneElement(t,{onExited:r.bind(null,t),in:!0,appear:x0(t,"appear",e),enter:x0(t,"enter",e),exit:x0(t,"exit",e)})})}function sO(e,r,t){var n=S6(e.children),s=nO(r,n);return Object.keys(s).forEach(function(o){var i=s[o];if(G.isValidElement(i)){var c=o in r,u=o in n,l=r[o],d=G.isValidElement(l)&&!l.props.in;u&&(!c||d)?s[o]=G.cloneElement(i,{onExited:t.bind(null,i),in:!0,exit:x0(i,"exit",e),enter:x0(i,"enter",e)}):!u&&c&&!d?s[o]=G.cloneElement(i,{in:!1}):u&&c&&G.isValidElement(l)&&(s[o]=G.cloneElement(i,{onExited:t.bind(null,i),in:l.props.in,exit:x0(i,"exit",e),enter:x0(i,"enter",e)}))}}),s}var iO=Object.values||function(e){return Object.keys(e).map(function(r){return e[r]})},oO={component:"div",childFactory:function(r){return r}},_6=function(e){Pk(r,e);function r(n,s){var o;o=e.call(this,n,s)||this;var i=o.handleExited.bind(Fk(o));return o.state={contextValue:{isMounting:!0},handleExited:i,firstRender:!0},o}var t=r.prototype;return t.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},t.componentWillUnmount=function(){this.mounted=!1},r.getDerivedStateFromProps=function(s,o){var i=o.children,c=o.handleExited,u=o.firstRender;return{children:u?aO(s,c):sO(s,i,c),firstRender:!1}},t.handleExited=function(s,o){var i=S6(this.props.children);s.key in i||(s.props.onExited&&s.props.onExited(o),this.mounted&&this.setState(function(c){var u=Ln({},c.children);return delete u[s.key],{children:u}}))},t.render=function(){var s=this.props,o=s.component,i=s.childFactory,c=w6(s,["component","childFactory"]),u=this.state.contextValue,l=iO(this.state.children).map(i);return delete c.appear,delete c.enter,delete c.exit,o===null?vr.createElement(d2.Provider,{value:u},l):vr.createElement(d2.Provider,{value:u},vr.createElement(o,c,l))},r}(vr.Component);_6.propTypes={};_6.defaultProps=oO;const lO=[];function cO(e){G.useEffect(e,lO)}class fw{constructor(){_1(this,"currentId",null);_1(this,"clear",()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)});_1(this,"disposeEffect",()=>this.clear)}static create(){return new fw}start(r,t){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,t()},r)}}function b0(){const e=Ok(fw.create).current;return cO(e.disposeEffect),e}function uO(e){const{className:r,classes:t,pulsate:n=!1,rippleX:s,rippleY:o,rippleSize:i,in:c,onExited:u,timeout:l}=e,[d,h]=G.useState(!1),f=Pr(r,t.ripple,t.rippleVisible,n&&t.ripplePulsate),p={width:i,height:i,top:-(i/2)+o,left:-(i/2)+s},v=Pr(t.child,d&&t.childLeaving,n&&t.childPulsate);return!c&&!d&&h(!0),G.useEffect(()=>{if(!c&&u!=null){const g=setTimeout(u,l);return()=>{clearTimeout(g)}}},[u,c,l]),a.jsx("span",{className:f,style:p,children:a.jsx("span",{className:v})})}const hc=un("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),pS=550,dO=80,fO=Gf`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,hO=Gf`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,pO=Gf`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,mO=or("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),gO=or(uO,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${hc.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${fO};
    animation-duration: ${pS}ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
  }

  &.${hc.ripplePulsate} {
    animation-duration: ${({theme:e})=>e.transitions.duration.shorter}ms;
  }

  & .${hc.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${hc.childLeaving} {
    opacity: 0;
    animation-name: ${hO};
    animation-duration: ${pS}ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
  }

  & .${hc.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${pO};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,vO=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiTouchRipple"}),{center:s=!1,classes:o={},className:i,...c}=n,[u,l]=G.useState([]),d=G.useRef(0),h=G.useRef(null);G.useEffect(()=>{h.current&&(h.current(),h.current=null)},[u]);const f=G.useRef(!1),p=b0(),v=G.useRef(null),g=G.useRef(null),m=G.useCallback(C=>{const{pulsate:L,rippleX:O,rippleY:H,rippleSize:z,cb:q}=C;l(D=>[...D,a.jsx(gO,{classes:{ripple:Pr(o.ripple,hc.ripple),rippleVisible:Pr(o.rippleVisible,hc.rippleVisible),ripplePulsate:Pr(o.ripplePulsate,hc.ripplePulsate),child:Pr(o.child,hc.child),childLeaving:Pr(o.childLeaving,hc.childLeaving),childPulsate:Pr(o.childPulsate,hc.childPulsate)},timeout:pS,pulsate:L,rippleX:O,rippleY:H,rippleSize:z},d.current)]),d.current+=1,h.current=q},[o]),b=G.useCallback((C={},L={},O=()=>{})=>{const{pulsate:H=!1,center:z=s||L.pulsate,fakeElement:q=!1}=L;if((C==null?void 0:C.type)==="mousedown"&&f.current){f.current=!1;return}(C==null?void 0:C.type)==="touchstart"&&(f.current=!0);const D=q?null:g.current,W=D?D.getBoundingClientRect():{width:0,height:0,left:0,top:0};let P,I,U;if(z||C===void 0||C.clientX===0&&C.clientY===0||!C.clientX&&!C.touches)P=Math.round(W.width/2),I=Math.round(W.height/2);else{const{clientX:k,clientY:_}=C.touches&&C.touches.length>0?C.touches[0]:C;P=Math.round(k-W.left),I=Math.round(_-W.top)}if(z)U=Math.sqrt((2*W.width**2+W.height**2)/3),U%2===0&&(U+=1);else{const k=Math.max(Math.abs((D?D.clientWidth:0)-P),P)*2+2,_=Math.max(Math.abs((D?D.clientHeight:0)-I),I)*2+2;U=Math.sqrt(k**2+_**2)}C!=null&&C.touches?v.current===null&&(v.current=()=>{m({pulsate:H,rippleX:P,rippleY:I,rippleSize:U,cb:O})},p.start(dO,()=>{v.current&&(v.current(),v.current=null)})):m({pulsate:H,rippleX:P,rippleY:I,rippleSize:U,cb:O})},[s,m,p]),y=G.useCallback(()=>{b({},{pulsate:!0})},[b]),S=G.useCallback((C,L)=>{if(p.clear(),(C==null?void 0:C.type)==="touchend"&&v.current){v.current(),v.current=null,p.start(0,()=>{S(C,L)});return}v.current=null,l(O=>O.length>0?O.slice(1):O),h.current=L},[p]);return G.useImperativeHandle(t,()=>({pulsate:y,start:b,stop:S}),[y,b,S]),a.jsx(mO,{className:Pr(hc.root,o.root,i),ref:g,...c,children:a.jsx(_6,{component:null,exit:!0,children:u})})});function xO(e){return an("MuiButtonBase",e)}const bO=un("MuiButtonBase",["root","disabled","focusVisible"]),yO=e=>{const{disabled:r,focusVisible:t,focusVisibleClassName:n,classes:s}=e,i=nn({root:["root",r&&"disabled",t&&"focusVisible"]},xO,s);return t&&n&&(i.root+=` ${n}`),i},wO=or("button",{name:"MuiButtonBase",slot:"Root"})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${bO.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),$f=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiButtonBase"}),{action:s,centerRipple:o=!1,children:i,className:c,component:u="button",disabled:l=!1,disableRipple:d=!1,disableTouchRipple:h=!1,focusRipple:f=!1,focusVisibleClassName:p,LinkComponent:v="a",onBlur:g,onClick:m,onContextMenu:b,onDragLeave:y,onFocus:S,onFocusVisible:C,onKeyDown:L,onKeyUp:O,onMouseDown:H,onMouseLeave:z,onMouseUp:q,onTouchEnd:D,onTouchMove:W,onTouchStart:P,tabIndex:I=0,TouchRippleProps:U,touchRippleRef:k,type:_,...R}=n,j=G.useRef(null),A=eO(),N=Ni(A.ref,k),[V,M]=G.useState(!1);l&&V&&M(!1),G.useImperativeHandle(s,()=>({focusVisible:()=>{M(!0),j.current.focus()}}),[]);const Z=A.shouldMount&&!d&&!l;G.useEffect(()=>{V&&f&&!d&&A.pulsate()},[d,f,V,A]);const J=Cd(A,"start",H,h),re=Cd(A,"stop",b,h),X=Cd(A,"stop",y,h),ne=Cd(A,"stop",q,h),Y=Cd(A,"stop",ge=>{V&&ge.preventDefault(),z&&z(ge)},h),K=Cd(A,"start",P,h),ee=Cd(A,"stop",D,h),ue=Cd(A,"stop",W,h),se=Cd(A,"stop",ge=>{l2(ge.target)||M(!1),g&&g(ge)},!1),ce=Di(ge=>{j.current||(j.current=ge.currentTarget),l2(ge.target)&&(M(!0),C&&C(ge)),S&&S(ge)}),fe=()=>{const ge=j.current;return u&&u!=="button"&&!(ge.tagName==="A"&&ge.href)},ve=Di(ge=>{f&&!ge.repeat&&V&&ge.key===" "&&A.stop(ge,()=>{A.start(ge)}),ge.target===ge.currentTarget&&fe()&&ge.key===" "&&ge.preventDefault(),L&&L(ge),ge.target===ge.currentTarget&&fe()&&ge.key==="Enter"&&!l&&(ge.preventDefault(),m&&m(ge))}),_e=Di(ge=>{f&&ge.key===" "&&V&&!ge.defaultPrevented&&A.stop(ge,()=>{A.pulsate(ge)}),O&&O(ge),m&&ge.target===ge.currentTarget&&fe()&&ge.key===" "&&!ge.defaultPrevented&&m(ge)});let le=u;le==="button"&&(R.href||R.to)&&(le=v);const ke={};le==="button"?(ke.type=_===void 0?"button":_,ke.disabled=l):(!R.href&&!R.to&&(ke.role="button"),l&&(ke["aria-disabled"]=l));const Te=Ni(t,j),pe={...n,centerRipple:o,component:u,disabled:l,disableRipple:d,disableTouchRipple:h,focusRipple:f,tabIndex:I,focusVisible:V},ye=yO(pe);return a.jsxs(wO,{as:le,className:Pr(ye.root,c),ownerState:pe,onBlur:se,onClick:m,onContextMenu:re,onFocus:ce,onKeyDown:ve,onKeyUp:_e,onMouseDown:J,onMouseLeave:Y,onMouseUp:ne,onDragLeave:X,onTouchEnd:ee,onTouchMove:ue,onTouchStart:K,ref:Te,tabIndex:l?-1:I,type:_,...ke,...R,children:[i,Z?a.jsx(vO,{ref:N,center:o,...U}):null]})});function Cd(e,r,t,n=!1){return Di(s=>(t&&t(s),n||e[r](s),!0))}function SO(e){return typeof e.main=="string"}function _O(e,r=[]){if(!SO(e))return!1;for(const t of r)if(!e.hasOwnProperty(t)||typeof e[t]!="string")return!1;return!0}function qi(e=[]){return([,r])=>r&&_O(r,e)}function AO(e){return an("MuiCircularProgress",e)}un("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const Lf=44,mS=Gf`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,gS=Gf`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,CO=typeof mS!="string"?H0`
        animation: ${mS} 1.4s linear infinite;
      `:null,jO=typeof gS!="string"?H0`
        animation: ${gS} 1.4s ease-in-out infinite;
      `:null,kO=e=>{const{classes:r,variant:t,color:n,disableShrink:s}=e,o={root:["root",t,`color${yr(n)}`],svg:["svg"],circle:["circle",`circle${yr(t)}`,s&&"circleDisableShrink"]};return nn(o,AO,r)},RO=or("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,r[t.variant],r[`color${yr(t.color)}`]]}})(cn(({theme:e})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("transform")}},{props:{variant:"indeterminate"},style:CO||{animation:`${mS} 1.4s linear infinite`}},...Object.entries(e.palette).filter(qi()).map(([r])=>({props:{color:r},style:{color:(e.vars||e).palette[r].main}}))]}))),EO=or("svg",{name:"MuiCircularProgress",slot:"Svg"})({display:"block"}),NO=or("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.circle,r[`circle${yr(t.variant)}`],t.disableShrink&&r.circleDisableShrink]}})(cn(({theme:e})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:r})=>r.variant==="indeterminate"&&!r.disableShrink,style:jO||{animation:`${gS} 1.4s ease-in-out infinite`}}]}))),Vs=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiCircularProgress"}),{className:s,color:o="primary",disableShrink:i=!1,size:c=40,style:u,thickness:l=3.6,value:d=0,variant:h="indeterminate",...f}=n,p={...n,color:o,disableShrink:i,size:c,thickness:l,value:d,variant:h},v=kO(p),g={},m={},b={};if(h==="determinate"){const y=2*Math.PI*((Lf-l)/2);g.strokeDasharray=y.toFixed(3),b["aria-valuenow"]=Math.round(d),g.strokeDashoffset=`${((100-d)/100*y).toFixed(3)}px`,m.transform="rotate(-90deg)"}return a.jsx(RO,{className:Pr(v.root,s),style:{width:c,height:c,...m,...u},ownerState:p,ref:t,role:"progressbar",...b,...f,children:a.jsx(EO,{className:v.svg,ownerState:p,viewBox:`${Lf/2} ${Lf/2} ${Lf} ${Lf}`,children:a.jsx(NO,{className:v.circle,style:g,ownerState:p,cx:Lf,cy:Lf,r:(Lf-l)/2,fill:"none",strokeWidth:l})})})});function TO(e){return an("MuiButton",e)}const h0=un("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge","loading","loadingWrapper","loadingIconPlaceholder","loadingIndicator","loadingPositionCenter","loadingPositionStart","loadingPositionEnd"]),LO=G.createContext({}),MO=G.createContext(void 0),DO=e=>{const{color:r,disableElevation:t,fullWidth:n,size:s,variant:o,loading:i,loadingPosition:c,classes:u}=e,l={root:["root",i&&"loading",o,`${o}${yr(r)}`,`size${yr(s)}`,`${o}Size${yr(s)}`,`color${yr(r)}`,t&&"disableElevation",n&&"fullWidth",i&&`loadingPosition${yr(c)}`],startIcon:["icon","startIcon",`iconSize${yr(s)}`],endIcon:["icon","endIcon",`iconSize${yr(s)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]},d=nn(l,TO,u);return{...u,...d}},Bk=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],IO=or($f,{shouldForwardProp:e=>xl(e)||e==="classes",name:"MuiButton",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,r[t.variant],r[`${t.variant}${yr(t.color)}`],r[`size${yr(t.size)}`],r[`${t.variant}Size${yr(t.size)}`],t.color==="inherit"&&r.colorInherit,t.disableElevation&&r.disableElevation,t.fullWidth&&r.fullWidth,t.loading&&r.loading]}})(cn(({theme:e})=>{const r=e.palette.mode==="light"?e.palette.grey[300]:e.palette.grey[800],t=e.palette.mode==="light"?e.palette.grey.A100:e.palette.grey[700];return{...e.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create(["background-color","box-shadow","border-color","color"],{duration:e.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${h0.disabled}`]:{color:(e.vars||e).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(e.vars||e).shadows[2],"&:hover":{boxShadow:(e.vars||e).shadows[4],"@media (hover: none)":{boxShadow:(e.vars||e).shadows[2]}},"&:active":{boxShadow:(e.vars||e).shadows[8]},[`&.${h0.focusVisible}`]:{boxShadow:(e.vars||e).shadows[6]},[`&.${h0.disabled}`]:{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${h0.disabled}`]:{border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(e.palette).filter(qi()).map(([n])=>({props:{color:n},style:{"--variant-textColor":(e.vars||e).palette[n].main,"--variant-outlinedColor":(e.vars||e).palette[n].main,"--variant-outlinedBorder":e.vars?`rgba(${e.vars.palette[n].mainChannel} / 0.5)`:Ca(e.palette[n].main,.5),"--variant-containedColor":(e.vars||e).palette[n].contrastText,"--variant-containedBg":(e.vars||e).palette[n].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(e.vars||e).palette[n].dark,"--variant-textBg":e.vars?`rgba(${e.vars.palette[n].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:Ca(e.palette[n].main,e.palette.action.hoverOpacity),"--variant-outlinedBorder":(e.vars||e).palette[n].main,"--variant-outlinedBg":e.vars?`rgba(${e.vars.palette[n].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:Ca(e.palette[n].main,e.palette.action.hoverOpacity)}}}})),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":e.vars?e.vars.palette.Button.inheritContainedBg:r,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":e.vars?e.vars.palette.Button.inheritContainedHoverBg:t,"--variant-textBg":e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:Ca(e.palette.text.primary,e.palette.action.hoverOpacity),"--variant-outlinedBg":e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:Ca(e.palette.text.primary,e.palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:e.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:e.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:e.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${h0.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${h0.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{loadingPosition:"center"},style:{transition:e.transitions.create(["background-color","box-shadow","border-color"],{duration:e.transitions.duration.short}),[`&.${h0.loading}`]:{color:"transparent"}}}]}})),OO=or("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.startIcon,t.loading&&r.startIconLoadingStart,r[`iconSize${yr(t.size)}`]]}})(({theme:e})=>({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},{props:{loadingPosition:"start",loading:!0},style:{transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"start",loading:!0,fullWidth:!0},style:{marginRight:-8}},...Bk]})),PO=or("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.endIcon,t.loading&&r.endIconLoadingEnd,r[`iconSize${yr(t.size)}`]]}})(({theme:e})=>({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},{props:{loadingPosition:"end",loading:!0},style:{transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"end",loading:!0,fullWidth:!0},style:{marginLeft:-8}},...Bk]})),FO=or("span",{name:"MuiButton",slot:"LoadingIndicator"})(({theme:e})=>({display:"none",position:"absolute",visibility:"visible",variants:[{props:{loading:!0},style:{display:"flex"}},{props:{loadingPosition:"start"},style:{left:14}},{props:{loadingPosition:"start",size:"small"},style:{left:10}},{props:{variant:"text",loadingPosition:"start"},style:{left:6}},{props:{loadingPosition:"center"},style:{left:"50%",transform:"translate(-50%)",color:(e.vars||e).palette.action.disabled}},{props:{loadingPosition:"end"},style:{right:14}},{props:{loadingPosition:"end",size:"small"},style:{right:10}},{props:{variant:"text",loadingPosition:"end"},style:{right:6}},{props:{loadingPosition:"start",fullWidth:!0},style:{position:"relative",left:-10}},{props:{loadingPosition:"end",fullWidth:!0},style:{position:"relative",right:-10}}]})),U5=or("span",{name:"MuiButton",slot:"LoadingIconPlaceholder"})({display:"inline-block",width:"1em",height:"1em"}),Br=G.forwardRef(function(r,t){const n=G.useContext(LO),s=G.useContext(MO),o=Av(n,r),i=dn({props:o,name:"MuiButton"}),{children:c,color:u="primary",component:l="button",className:d,disabled:h=!1,disableElevation:f=!1,disableFocusRipple:p=!1,endIcon:v,focusVisibleClassName:g,fullWidth:m=!1,id:b,loading:y=null,loadingIndicator:S,loadingPosition:C="center",size:L="medium",startIcon:O,type:H,variant:z="text",...q}=i,D=Od(b),W=S??a.jsx(Vs,{"aria-labelledby":D,color:"inherit",size:16}),P={...i,color:u,component:l,disabled:h,disableElevation:f,disableFocusRipple:p,fullWidth:m,loading:y,loadingIndicator:W,loadingPosition:C,size:L,type:H,variant:z},I=DO(P),U=(O||y&&C==="start")&&a.jsx(OO,{className:I.startIcon,ownerState:P,children:O||a.jsx(U5,{className:I.loadingIconPlaceholder,ownerState:P})}),k=(v||y&&C==="end")&&a.jsx(PO,{className:I.endIcon,ownerState:P,children:v||a.jsx(U5,{className:I.loadingIconPlaceholder,ownerState:P})}),_=s||"",R=typeof y=="boolean"?a.jsx("span",{className:I.loadingWrapper,style:{display:"contents"},children:y&&a.jsx(FO,{className:I.loadingIndicator,ownerState:P,children:W})}):null;return a.jsxs(IO,{ownerState:P,className:Pr(n.className,I.root,d,_),component:l,disabled:h||y,focusRipple:!p,focusVisibleClassName:Pr(I.focusVisible,g),ref:t,type:H,id:y?D:b,...q,classes:I,children:[U,C!=="end"&&R,c,C==="end"&&R,k]})});var zk={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},H5=vr.createContext&&vr.createContext(zk),BO=["attr","size","title"];function zO(e,r){if(e==null)return{};var t=$O(e,r),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(t[n]=e[n])}return t}function $O(e,r){if(e==null)return{};var t={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(r.indexOf(n)>=0)continue;t[n]=e[n]}return t}function f2(){return f2=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},f2.apply(this,arguments)}function V5(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),t.push.apply(t,n)}return t}function h2(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?V5(Object(t),!0).forEach(function(n){UO(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):V5(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function UO(e,r,t){return r=HO(r),r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function HO(e){var r=VO(e,"string");return typeof r=="symbol"?r:r+""}function VO(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function $k(e){return e&&e.map((r,t)=>vr.createElement(r.tag,h2({key:t},r.attr),$k(r.child)))}function vn(e){return r=>vr.createElement(WO,f2({attr:h2({},e.attr)},r),$k(e.child))}function WO(e){var r=t=>{var{attr:n,size:s,title:o}=e,i=zO(e,BO),c=s||t.size||"1em",u;return t.className&&(u=t.className),e.className&&(u=(u?u+" ":"")+e.className),vr.createElement("svg",f2({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,n,i,{className:u,style:h2(h2({color:e.color||t.color},t.style),e.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),o&&vr.createElement("title",null,o),e.children)};return H5!==void 0?vr.createElement(H5.Consumer,null,t=>r(t)):r(zk)}function qO(e){return vn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9zm7.5-5-1-1h-5l-1 1H5v2h14V4z"},child:[]}]})(e)}function GO(e){return vn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4zM10 15l-3.89-3.89v2.55H5V9.22h4.44v1.11H6.89l3.11 3.1 4.22-4.22.78.79-5 5z"},child:[]}]})(e)}function KO(e){return vn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"},child:[]}]})(e)}function W5(e){return vn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"},child:[]}]})(e)}function Z4(e){return vn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a.996.996 0 0 0 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"},child:[]}]})(e)}function q5(e){return vn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M7 3v3h2V4h10v16H9v-2H7v3c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-2-2-2H9c-1.1 0-2 .9-2 2zm2.5 12.5c.29-.12.55-.29.8-.48l-.02.03 1.01.39c.23.09.49 0 .61-.22l.84-1.46c.12-.21.07-.49-.12-.64l-.85-.68-.02.03c.02-.16.05-.32.05-.48s-.03-.32-.05-.48l.02.03.85-.68c.19-.15.24-.43.12-.64l-.84-1.46a.499.499 0 0 0-.61-.22l-1.01.39.02.03c-.25-.17-.51-.34-.8-.46l-.17-1.08A.488.488 0 0 0 8.84 7H7.16c-.25 0-.46.18-.49.42L6.5 8.5c-.29.12-.55.29-.8.48l.02-.03-1.02-.39c-.23-.09-.49 0-.61.22l-.84 1.46c-.12.21-.07.49.12.64l.85.68.02-.03c-.02.15-.05.31-.05.47s.03.32.05.48l-.02-.03-.85.68c-.19.15-.24.43-.12.64l.84 1.46c.12.21.38.31.61.22l1.01-.39-.01-.04c.25.19.51.36.8.48l.17 1.07c.03.25.24.43.49.43h1.68c.25 0 .46-.18.49-.42l.17-1.08zM6 12c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2z"},child:[]}]})(e)}function XO(e){return vn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"},child:[]}]})(e)}function YO(e){return vn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M3 18h13v-2H3v2zm0-5h10v-2H3v2zm0-7v2h13V6H3zm18 9.59L17.42 12 21 8.41 19.59 7l-5 5 5 5L21 15.59z"},child:[]}]})(e)}function ZO(e){return vn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"},child:[]}]})(e)}function JO(e){return vn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M289.7 403c-6.1 0-11.4 4.2-12.7 10.2-1 4.5-2.7 8.2-5 10.9-1.3 1.5-5.1 5.9-16.1 5.9-11 0-14.8-4.5-16.1-5.9-2.3-2.7-4-6.4-5-10.9-1.3-6-6.6-10.2-12.7-10.2-8.4 0-14.5 7.8-12.7 15.9 5 22.3 21 37.1 46.5 37.1s41.5-14.7 46.5-37.1c1.8-8.1-4.4-15.9-12.7-15.9zM412 352.2c-15.4-20.3-45.7-32.2-45.7-123.1 0-93.3-41.2-130.8-79.6-139.8-3.6-.9-6.2-2.1-6.2-5.9v-2.9c0-13.3-10.8-24.6-24-24.6h-.6c-13.2 0-24 11.3-24 24.6v2.9c0 3.7-2.6 5-6.2 5.9-38.5 9.1-79.6 46.5-79.6 139.8 0 90.9-30.3 102.7-45.7 123.1-9.9 13.1-.5 31.8 15.9 31.8h280.1c16.1 0 25.4-18.8 15.6-31.8zm-39 5.8H139.8c-3.8 0-5.8-4.4-3.3-7.3 7-8 14.7-18.5 21-33.4 9.6-22.6 14.3-51.5 14.3-88.2 0-37.3 7-66.5 20.9-86.8 12.4-18.2 27.9-25.1 38.7-27.6 8.4-2 14.4-5.8 18.6-10.5 3.2-3.6 8.7-3.8 11.9-.2 5.1 5.7 12 9.1 18.8 10.7 10.8 2.5 26.3 9.4 38.7 27.6 13.9 20.3 20.9 49.5 20.9 86.8 0 36.7 4.7 65.6 14.3 88.2 6.5 15.2 14.4 25.9 21.5 33.9 2.2 2.7.4 6.8-3.1 6.8z"},child:[]}]})(e)}function QO(e){return vn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M443.5 420.2L336.7 312.4c20.9-26.2 33.5-59.4 33.5-95.5 0-84.5-68.5-153-153.1-153S64 132.5 64 217s68.5 153 153.1 153c36.6 0 70.1-12.8 96.5-34.2l106.1 107.1c3.2 3.4 7.6 5.1 11.9 5.1 4.1 0 8.2-1.5 11.3-4.5 6.6-6.3 6.8-16.7.6-23.3zm-226.4-83.1c-32.1 0-62.3-12.5-85-35.2-22.7-22.7-35.2-52.9-35.2-84.9 0-32.1 12.5-62.3 35.2-84.9 22.7-22.7 52.9-35.2 85-35.2s62.3 12.5 85 35.2c22.7 22.7 35.2 52.9 35.2 84.9 0 32.1-12.5 62.3-35.2 84.9-22.7 22.7-52.9 35.2-85 35.2z"},child:[]}]})(e)}function J4(e){return vn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M416 277.333H277.333V416h-42.666V277.333H96v-42.666h138.667V96h42.666v138.667H416v42.666z"},child:[]}]})(e)}function eP(e){return vn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M376 186h-20v-40c0-55-45-100-100-100S156 91 156 146v40h-20c-22.002 0-40 17.998-40 40v200c0 22.002 17.998 40 40 40h240c22.002 0 40-17.998 40-40V226c0-22.002-17.998-40-40-40zM256 368c-22.002 0-40-17.998-40-40s17.998-40 40-40 40 17.998 40 40-17.998 40-40 40zm62.002-182H193.998v-40c0-34.004 28.003-62.002 62.002-62.002 34.004 0 62.002 27.998 62.002 62.002v40z"},child:[]}]})(e)}function tP(e){return vn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M437.332 80H74.668C51.199 80 32 99.198 32 122.667v266.666C32 412.802 51.199 432 74.668 432h362.664C460.801 432 480 412.802 480 389.333V122.667C480 99.198 460.801 80 437.332 80zM432 170.667L256 288 80 170.667V128l176 117.333L432 128v42.667z"},child:[]}]})(e)}function rP(e){return vn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M399.95 160h-287.9C76.824 160 48 188.803 48 224v138.667h79.899V448H384.1v-85.333H464V224c0-35.197-28.825-64-64.05-64zM352 416H160V288h192v128zm32.101-352H127.899v80H384.1V64z"},child:[]}]})(e)}const nP=()=>a.jsxs("div",{className:"searchbox position-relative d-flex align-items-center",children:[a.jsx(QO,{className:"mr-2"}),a.jsx("input",{type:"text",placeholder:"search"})]});function aP(e){return vn({attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{id:"Light"},child:[{tag:"g",attr:{},child:[{tag:"path",attr:{d:"M12,18.09A6.09,6.09,0,1,1,18.09,12,6.1,6.1,0,0,1,12,18.09ZM12,6.91A5.09,5.09,0,1,0,17.09,12,5.1,5.1,0,0,0,12,6.91Z"},child:[]},{tag:"path",attr:{d:"M11.5,2.568v1.6a.5.5,0,1,0,1,0v-1.6a.5.5,0,1,0-1,0Z"},child:[]},{tag:"path",attr:{d:"M12.5,21.432v-1.6a.5.5,0,0,0-1,0v1.6a.5.5,0,1,0,1,0Z"},child:[]},{tag:"path",attr:{d:"M21.432,11.5h-1.6a.5.5,0,0,0,0,1h1.6a.5.5,0,1,0,0-1Z"},child:[]},{tag:"path",attr:{d:"M2.568,12.5h1.6a.5.5,0,1,0,0-1h-1.6a.5.5,0,1,0,0,1Z"},child:[]},{tag:"path",attr:{d:"M18.316,4.977l-.992.992-.141.141a.514.514,0,0,0-.146.353.508.508,0,0,0,.146.354.5.5,0,0,0,.354.146.515.515,0,0,0,.353-.146l.992-.992.141-.141a.515.515,0,0,0,.147-.354.508.508,0,0,0-.147-.353.5.5,0,0,0-.353-.147.522.522,0,0,0-.354.147Z"},child:[]},{tag:"path",attr:{d:"M5.684,19.023l.992-.992.141-.141a.514.514,0,0,0,.146-.353.508.508,0,0,0-.146-.354.5.5,0,0,0-.354-.146.515.515,0,0,0-.353.146l-.992.992-.141.141a.515.515,0,0,0-.147.354.508.508,0,0,0,.147.353.5.5,0,0,0,.353.147.522.522,0,0,0,.354-.147Z"},child:[]},{tag:"path",attr:{d:"M19.023,18.316l-.992-.992-.141-.141a.514.514,0,0,0-.353-.146.508.508,0,0,0-.354.146.5.5,0,0,0-.146.354.515.515,0,0,0,.146.353l.992.992.141.141a.515.515,0,0,0,.354.147.508.508,0,0,0,.353-.147.5.5,0,0,0,.147-.353.522.522,0,0,0-.147-.354Z"},child:[]},{tag:"path",attr:{d:"M4.977,5.684l.992.992.141.141a.514.514,0,0,0,.353.146.508.508,0,0,0,.354-.146.5.5,0,0,0,.146-.354.515.515,0,0,0-.146-.353l-.992-.992-.141-.141A.515.515,0,0,0,5.33,4.83a.508.508,0,0,0-.353.147.5.5,0,0,0-.147.353.522.522,0,0,0,.147.354Z"},child:[]}]}]}]})(e)}function sP(e){return String(e).match(/[\d.\-+]*\s*(.*)/)[1]||""}function iP(e){return parseFloat(e)}const oP=un("MuiBox",["root"]),lP=Mk(),Ut=yD({themeId:uw,defaultTheme:lP,defaultClassName:oP.root,generateClassName:ak.generate});function cP(e){return typeof e=="string"}function Uk(e,r,t){return e===void 0||cP(e)?r:{...r,ownerState:{...r.ownerState,...t}}}function p2(e,r=[]){if(e===void 0)return{};const t={};return Object.keys(e).filter(n=>n.match(/^on[A-Z]/)&&typeof e[n]=="function"&&!r.includes(n)).forEach(n=>{t[n]=e[n]}),t}function G5(e){if(e===void 0)return{};const r={};return Object.keys(e).filter(t=>!(t.match(/^on[A-Z]/)&&typeof e[t]=="function")).forEach(t=>{r[t]=e[t]}),r}function Hk(e){const{getSlotProps:r,additionalProps:t,externalSlotProps:n,externalForwardedProps:s,className:o}=e;if(!r){const p=Pr(t==null?void 0:t.className,o,s==null?void 0:s.className,n==null?void 0:n.className),v={...t==null?void 0:t.style,...s==null?void 0:s.style,...n==null?void 0:n.style},g={...t,...s,...n};return p.length>0&&(g.className=p),Object.keys(v).length>0&&(g.style=v),{props:g,internalRef:void 0}}const i=p2({...s,...n}),c=G5(n),u=G5(s),l=r(i),d=Pr(l==null?void 0:l.className,t==null?void 0:t.className,o,s==null?void 0:s.className,n==null?void 0:n.className),h={...l==null?void 0:l.style,...t==null?void 0:t.style,...s==null?void 0:s.style,...n==null?void 0:n.style},f={...l,...t,...u,...c};return d.length>0&&(f.className=d),Object.keys(h).length>0&&(f.style=h),{props:f,internalRef:l.ref}}function Vk(e,r,t){return typeof e=="function"?e(r,t):e}function Om(e){var h;const{elementType:r,externalSlotProps:t,ownerState:n,skipResolvingSlotProps:s=!1,...o}=e,i=s?{}:Vk(t,n),{props:c,internalRef:u}=Hk({...o,externalSlotProps:i}),l=Ni(u,i==null?void 0:i.ref,(h=e.additionalProps)==null?void 0:h.ref);return Uk(r,{...c,ref:l},n)}const Ev=G.createContext({});function uP(e){return an("MuiList",e)}un("MuiList",["root","padding","dense","subheader"]);const dP=e=>{const{classes:r,disablePadding:t,dense:n,subheader:s}=e;return nn({root:["root",!t&&"padding",n&&"dense",s&&"subheader"]},uP,r)},fP=or("ul",{name:"MuiList",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,!t.disablePadding&&r.padding,t.dense&&r.dense,t.subheader&&r.subheader]}})({listStyle:"none",margin:0,padding:0,position:"relative",variants:[{props:({ownerState:e})=>!e.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:e})=>e.subheader,style:{paddingTop:0}}]}),hP=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiList"}),{children:s,className:o,component:i="ul",dense:c=!1,disablePadding:u=!1,subheader:l,...d}=n,h=G.useMemo(()=>({dense:c}),[c]),f={...n,component:i,dense:c,disablePadding:u},p=dP(f);return a.jsx(Ev.Provider,{value:h,children:a.jsxs(fP,{as:i,className:Pr(p.root,o),ref:t,ownerState:f,...d,children:[l,s]})})});function Wk(e=window){const r=e.document.documentElement.clientWidth;return e.innerWidth-r}function Q4(e,r,t){return e===r?e.firstChild:r&&r.nextElementSibling?r.nextElementSibling:t?null:e.firstChild}function K5(e,r,t){return e===r?t?e.firstChild:e.lastChild:r&&r.previousElementSibling?r.previousElementSibling:t?null:e.lastChild}function qk(e,r){if(r===void 0)return!0;let t=e.innerText;return t===void 0&&(t=e.textContent),t=t.trim().toLowerCase(),t.length===0?!1:r.repeating?t[0]===r.keys[0]:t.startsWith(r.keys.join(""))}function N1(e,r,t,n,s,o){let i=!1,c=s(e,r,r?t:!1);for(;c;){if(c===e.firstChild){if(i)return!1;i=!0}const u=n?!1:c.disabled||c.getAttribute("aria-disabled")==="true";if(!c.hasAttribute("tabindex")||!qk(c,o)||u)c=s(e,c,t);else return c.focus(),!0}return!1}const pP=G.forwardRef(function(r,t){const{actions:n,autoFocus:s=!1,autoFocusItem:o=!1,children:i,className:c,disabledItemsFocusable:u=!1,disableListWrap:l=!1,onKeyDown:d,variant:h="selectedMenu",...f}=r,p=G.useRef(null),v=G.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});Jc(()=>{s&&p.current.focus()},[s]),G.useImperativeHandle(n,()=>({adjustStyleForScrollbar:(S,{direction:C})=>{const L=!p.current.style.width;if(S.clientHeight<p.current.clientHeight&&L){const O=`${Wk(Qc(S))}px`;p.current.style[C==="rtl"?"paddingLeft":"paddingRight"]=O,p.current.style.width=`calc(100% + ${O})`}return p.current}}),[]);const g=S=>{const C=p.current,L=S.key;if(S.ctrlKey||S.metaKey||S.altKey){d&&d(S);return}const H=co(C).activeElement;if(L==="ArrowDown")S.preventDefault(),N1(C,H,l,u,Q4);else if(L==="ArrowUp")S.preventDefault(),N1(C,H,l,u,K5);else if(L==="Home")S.preventDefault(),N1(C,null,l,u,Q4);else if(L==="End")S.preventDefault(),N1(C,null,l,u,K5);else if(L.length===1){const z=v.current,q=L.toLowerCase(),D=performance.now();z.keys.length>0&&(D-z.lastTime>500?(z.keys=[],z.repeating=!0,z.previousKeyMatched=!0):z.repeating&&q!==z.keys[0]&&(z.repeating=!1)),z.lastTime=D,z.keys.push(q);const W=H&&!z.repeating&&qk(H,z);z.previousKeyMatched&&(W||N1(C,H,!1,u,Q4,z))?S.preventDefault():z.previousKeyMatched=!1}d&&d(S)},m=Ni(p,t);let b=-1;G.Children.forEach(i,(S,C)=>{if(!G.isValidElement(S)){b===C&&(b+=1,b>=i.length&&(b=-1));return}S.props.disabled||(h==="selectedMenu"&&S.props.selected||b===-1)&&(b=C),b===C&&(S.props.disabled||S.props.muiSkipListHighlight||S.type.muiSkipListHighlight)&&(b+=1,b>=i.length&&(b=-1))});const y=G.Children.map(i,(S,C)=>{if(C===b){const L={};return o&&(L.autoFocus=!0),S.props.tabIndex===void 0&&h==="selectedMenu"&&(L.tabIndex=0),G.cloneElement(S,L)}return S});return a.jsx(hP,{role:"menu",ref:m,className:c,onKeyDown:g,tabIndex:s?0:-1,...f,children:y})});function vS(e){return typeof e=="string"}function V0(e){var r;return parseInt(G.version,10)>=19?((r=e==null?void 0:e.props)==null?void 0:r.ref)||null:(e==null?void 0:e.ref)||null}const Gk=e=>e.scrollTop;function m2(e,r){const{timeout:t,easing:n,style:s={}}=e;return{duration:s.transitionDuration??(typeof t=="number"?t:t[r.mode]||0),easing:s.transitionTimingFunction??(typeof n=="object"?n[r.mode]:n),delay:s.transitionDelay}}function xS(e){return`scale(${e}, ${e**2})`}const mP={entering:{opacity:1,transform:xS(1)},entered:{opacity:1,transform:"none"}},e3=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),Nv=G.forwardRef(function(r,t){const{addEndListener:n,appear:s=!0,children:o,easing:i,in:c,onEnter:u,onEntered:l,onEntering:d,onExit:h,onExited:f,onExiting:p,style:v,timeout:g="auto",TransitionComponent:m=Gu,...b}=r,y=b0(),S=G.useRef(),C=Kf(),L=G.useRef(null),O=Ni(L,V0(o),t),H=k=>_=>{if(k){const R=L.current;_===void 0?k(R):k(R,_)}},z=H(d),q=H((k,_)=>{Gk(k);const{duration:R,delay:j,easing:A}=m2({style:v,timeout:g,easing:i},{mode:"enter"});let N;g==="auto"?(N=C.transitions.getAutoHeightDuration(k.clientHeight),S.current=N):N=R,k.style.transition=[C.transitions.create("opacity",{duration:N,delay:j}),C.transitions.create("transform",{duration:e3?N:N*.666,delay:j,easing:A})].join(","),u&&u(k,_)}),D=H(l),W=H(p),P=H(k=>{const{duration:_,delay:R,easing:j}=m2({style:v,timeout:g,easing:i},{mode:"exit"});let A;g==="auto"?(A=C.transitions.getAutoHeightDuration(k.clientHeight),S.current=A):A=_,k.style.transition=[C.transitions.create("opacity",{duration:A,delay:R}),C.transitions.create("transform",{duration:e3?A:A*.666,delay:e3?R:R||A*.333,easing:j})].join(","),k.style.opacity=0,k.style.transform=xS(.75),h&&h(k)}),I=H(f),U=k=>{g==="auto"&&y.start(S.current||0,k),n&&n(L.current,k)};return a.jsx(m,{appear:s,in:c,nodeRef:L,onEnter:q,onEntered:D,onEntering:z,onExit:P,onExited:I,onExiting:W,addEndListener:U,timeout:g==="auto"?null:g,...b,children:(k,{ownerState:_,...R})=>G.cloneElement(o,{style:{opacity:0,transform:xS(.75),visibility:k==="exited"&&!c?"hidden":void 0,...mP[k],...v,...o.props.style},ref:O,...R})})});Nv&&(Nv.muiSupportAuto=!0);function gP(e){const r=co(e);return r.body===e?Qc(e).innerWidth>r.documentElement.clientWidth:e.scrollHeight>e.clientHeight}function iv(e,r){r?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden")}function X5(e){return parseInt(Qc(e).getComputedStyle(e).paddingRight,10)||0}function vP(e){const t=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].includes(e.tagName),n=e.tagName==="INPUT"&&e.getAttribute("type")==="hidden";return t||n}function Y5(e,r,t,n,s){const o=[r,t,...n];[].forEach.call(e.children,i=>{const c=!o.includes(i),u=!vP(i);c&&u&&iv(i,s)})}function t3(e,r){let t=-1;return e.some((n,s)=>r(n)?(t=s,!0):!1),t}function xP(e,r){const t=[],n=e.container;if(!r.disableScrollLock){if(gP(n)){const i=Wk(Qc(n));t.push({value:n.style.paddingRight,property:"padding-right",el:n}),n.style.paddingRight=`${X5(n)+i}px`;const c=co(n).querySelectorAll(".mui-fixed");[].forEach.call(c,u=>{t.push({value:u.style.paddingRight,property:"padding-right",el:u}),u.style.paddingRight=`${X5(u)+i}px`})}let o;if(n.parentNode instanceof DocumentFragment)o=co(n).body;else{const i=n.parentElement,c=Qc(n);o=(i==null?void 0:i.nodeName)==="HTML"&&c.getComputedStyle(i).overflowY==="scroll"?i:n}t.push({value:o.style.overflow,property:"overflow",el:o},{value:o.style.overflowX,property:"overflow-x",el:o},{value:o.style.overflowY,property:"overflow-y",el:o}),o.style.overflow="hidden"}return()=>{t.forEach(({value:o,el:i,property:c})=>{o?i.style.setProperty(c,o):i.style.removeProperty(c)})}}function bP(e){const r=[];return[].forEach.call(e.children,t=>{t.getAttribute("aria-hidden")==="true"&&r.push(t)}),r}class yP{constructor(){this.modals=[],this.containers=[]}add(r,t){let n=this.modals.indexOf(r);if(n!==-1)return n;n=this.modals.length,this.modals.push(r),r.modalRef&&iv(r.modalRef,!1);const s=bP(t);Y5(t,r.mount,r.modalRef,s,!0);const o=t3(this.containers,i=>i.container===t);return o!==-1?(this.containers[o].modals.push(r),n):(this.containers.push({modals:[r],container:t,restore:null,hiddenSiblings:s}),n)}mount(r,t){const n=t3(this.containers,o=>o.modals.includes(r)),s=this.containers[n];s.restore||(s.restore=xP(s,t))}remove(r,t=!0){const n=this.modals.indexOf(r);if(n===-1)return n;const s=t3(this.containers,i=>i.modals.includes(r)),o=this.containers[s];if(o.modals.splice(o.modals.indexOf(r),1),this.modals.splice(n,1),o.modals.length===0)o.restore&&o.restore(),r.modalRef&&iv(r.modalRef,t),Y5(o.container,r.mount,r.modalRef,o.hiddenSiblings,!1),this.containers.splice(s,1);else{const i=o.modals[o.modals.length-1];i.modalRef&&iv(i.modalRef,!1)}return n}isTopModal(r){return this.modals.length>0&&this.modals[this.modals.length-1]===r}}const wP=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function SP(e){const r=parseInt(e.getAttribute("tabindex")||"",10);return Number.isNaN(r)?e.contentEditable==="true"||(e.nodeName==="AUDIO"||e.nodeName==="VIDEO"||e.nodeName==="DETAILS")&&e.getAttribute("tabindex")===null?0:e.tabIndex:r}function _P(e){if(e.tagName!=="INPUT"||e.type!=="radio"||!e.name)return!1;const r=n=>e.ownerDocument.querySelector(`input[type="radio"]${n}`);let t=r(`[name="${e.name}"]:checked`);return t||(t=r(`[name="${e.name}"]`)),t!==e}function AP(e){return!(e.disabled||e.tagName==="INPUT"&&e.type==="hidden"||_P(e))}function CP(e){const r=[],t=[];return Array.from(e.querySelectorAll(wP)).forEach((n,s)=>{const o=SP(n);o===-1||!AP(n)||(o===0?r.push(n):t.push({documentOrder:s,tabIndex:o,node:n}))}),t.sort((n,s)=>n.tabIndex===s.tabIndex?n.documentOrder-s.documentOrder:n.tabIndex-s.tabIndex).map(n=>n.node).concat(r)}function jP(){return!0}function kP(e){const{children:r,disableAutoFocus:t=!1,disableEnforceFocus:n=!1,disableRestoreFocus:s=!1,getTabbable:o=CP,isEnabled:i=jP,open:c}=e,u=G.useRef(!1),l=G.useRef(null),d=G.useRef(null),h=G.useRef(null),f=G.useRef(null),p=G.useRef(!1),v=G.useRef(null),g=Ni(V0(r),v),m=G.useRef(null);G.useEffect(()=>{!c||!v.current||(p.current=!t)},[t,c]),G.useEffect(()=>{if(!c||!v.current)return;const S=co(v.current);return v.current.contains(S.activeElement)||(v.current.hasAttribute("tabIndex")||v.current.setAttribute("tabIndex","-1"),p.current&&v.current.focus()),()=>{s||(h.current&&h.current.focus&&(u.current=!0,h.current.focus()),h.current=null)}},[c]),G.useEffect(()=>{if(!c||!v.current)return;const S=co(v.current),C=H=>{m.current=H,!(n||!i()||H.key!=="Tab")&&S.activeElement===v.current&&H.shiftKey&&(u.current=!0,d.current&&d.current.focus())},L=()=>{var q,D;const H=v.current;if(H===null)return;if(!S.hasFocus()||!i()||u.current){u.current=!1;return}if(H.contains(S.activeElement)||n&&S.activeElement!==l.current&&S.activeElement!==d.current)return;if(S.activeElement!==f.current)f.current=null;else if(f.current!==null)return;if(!p.current)return;let z=[];if((S.activeElement===l.current||S.activeElement===d.current)&&(z=o(v.current)),z.length>0){const W=!!((q=m.current)!=null&&q.shiftKey&&((D=m.current)==null?void 0:D.key)==="Tab"),P=z[0],I=z[z.length-1];typeof P!="string"&&typeof I!="string"&&(W?I.focus():P.focus())}else H.focus()};S.addEventListener("focusin",L),S.addEventListener("keydown",C,!0);const O=setInterval(()=>{S.activeElement&&S.activeElement.tagName==="BODY"&&L()},50);return()=>{clearInterval(O),S.removeEventListener("focusin",L),S.removeEventListener("keydown",C,!0)}},[t,n,s,i,c,o]);const b=S=>{h.current===null&&(h.current=S.relatedTarget),p.current=!0,f.current=S.target;const C=r.props.onFocus;C&&C(S)},y=S=>{h.current===null&&(h.current=S.relatedTarget),p.current=!0};return a.jsxs(G.Fragment,{children:[a.jsx("div",{tabIndex:c?0:-1,onFocus:y,ref:l,"data-testid":"sentinelStart"}),G.cloneElement(r,{ref:g,onFocus:b}),a.jsx("div",{tabIndex:c?0:-1,onFocus:y,ref:d,"data-testid":"sentinelEnd"})]})}function RP(e){return typeof e=="function"?e():e}const Kk=G.forwardRef(function(r,t){const{children:n,container:s,disablePortal:o=!1}=r,[i,c]=G.useState(null),u=Ni(G.isValidElement(n)?V0(n):null,t);if(Jc(()=>{o||c(RP(s)||document.body)},[s,o]),Jc(()=>{if(i&&!o)return fS(t,i),()=>{fS(t,null)}},[t,i,o]),o){if(G.isValidElement(n)){const l={ref:u};return G.cloneElement(n,l)}return n}return i&&s6.createPortal(n,i)});function ln(e,r){const{className:t,elementType:n,ownerState:s,externalForwardedProps:o,internalForwardedProps:i,shouldForwardComponentProp:c=!1,...u}=r,{component:l,slots:d={[e]:void 0},slotProps:h={[e]:void 0},...f}=o,p=d[e]||n,v=Vk(h[e],s),{props:{component:g,...m},internalRef:b}=Hk({className:t,...u,externalForwardedProps:e==="root"?f:void 0,externalSlotProps:v}),y=Ni(b,v==null?void 0:v.ref,r.ref),S=e==="root"?g||l:g,C=Uk(p,{...e==="root"&&!l&&!d[e]&&i,...e!=="root"&&!d[e]&&i,...m,...S&&!c&&{as:S},...S&&c&&{component:S},ref:y},s);return[p,C]}const EP={entering:{opacity:1},entered:{opacity:1}},bS=G.forwardRef(function(r,t){const n=Kf(),s={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{addEndListener:o,appear:i=!0,children:c,easing:u,in:l,onEnter:d,onEntered:h,onEntering:f,onExit:p,onExited:v,onExiting:g,style:m,timeout:b=s,TransitionComponent:y=Gu,...S}=r,C=G.useRef(null),L=Ni(C,V0(c),t),O=U=>k=>{if(U){const _=C.current;k===void 0?U(_):U(_,k)}},H=O(f),z=O((U,k)=>{Gk(U);const _=m2({style:m,timeout:b,easing:u},{mode:"enter"});U.style.webkitTransition=n.transitions.create("opacity",_),U.style.transition=n.transitions.create("opacity",_),d&&d(U,k)}),q=O(h),D=O(g),W=O(U=>{const k=m2({style:m,timeout:b,easing:u},{mode:"exit"});U.style.webkitTransition=n.transitions.create("opacity",k),U.style.transition=n.transitions.create("opacity",k),p&&p(U)}),P=O(v),I=U=>{o&&o(C.current,U)};return a.jsx(y,{appear:i,in:l,nodeRef:C,onEnter:z,onEntered:q,onEntering:H,onExit:W,onExited:P,onExiting:D,addEndListener:I,timeout:b,...S,children:(U,{ownerState:k,..._})=>G.cloneElement(c,{style:{opacity:0,visibility:U==="exited"&&!l?"hidden":void 0,...EP[U],...m,...c.props.style},ref:L,..._})})});function NP(e){return an("MuiBackdrop",e)}un("MuiBackdrop",["root","invisible"]);const TP=e=>{const{classes:r,invisible:t}=e;return nn({root:["root",t&&"invisible"]},NP,r)},LP=or("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,t.invisible&&r.invisible]}})({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",variants:[{props:{invisible:!0},style:{backgroundColor:"transparent"}}]}),Xk=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiBackdrop"}),{children:s,className:o,component:i="div",invisible:c=!1,open:u,components:l={},componentsProps:d={},slotProps:h={},slots:f={},TransitionComponent:p,transitionDuration:v,...g}=n,m={...n,component:i,invisible:c},b=TP(m),y={transition:p,root:l.Root,...f},S={...d,...h},C={slots:y,slotProps:S},[L,O]=ln("root",{elementType:LP,externalForwardedProps:C,className:Pr(b.root,o),ownerState:m}),[H,z]=ln("transition",{elementType:bS,externalForwardedProps:C,ownerState:m});return a.jsx(H,{in:u,timeout:v,...g,...z,children:a.jsx(L,{"aria-hidden":!0,...O,classes:b,ref:t,children:s})})});function MP(e){return typeof e=="function"?e():e}function DP(e){return e?e.props.hasOwnProperty("in"):!1}const Z5=()=>{},gy=new yP;function IP(e){const{container:r,disableEscapeKeyDown:t=!1,disableScrollLock:n=!1,closeAfterTransition:s=!1,onTransitionEnter:o,onTransitionExited:i,children:c,onClose:u,open:l,rootRef:d}=e,h=G.useRef({}),f=G.useRef(null),p=G.useRef(null),v=Ni(p,d),[g,m]=G.useState(!l),b=DP(c);let y=!0;(e["aria-hidden"]==="false"||e["aria-hidden"]===!1)&&(y=!1);const S=()=>co(f.current),C=()=>(h.current.modalRef=p.current,h.current.mount=f.current,h.current),L=()=>{gy.mount(C(),{disableScrollLock:n}),p.current&&(p.current.scrollTop=0)},O=Di(()=>{const k=MP(r)||S().body;gy.add(C(),k),p.current&&L()}),H=()=>gy.isTopModal(C()),z=Di(k=>{f.current=k,k&&(l&&H()?L():p.current&&iv(p.current,y))}),q=G.useCallback(()=>{gy.remove(C(),y)},[y]);G.useEffect(()=>()=>{q()},[q]),G.useEffect(()=>{l?O():(!b||!s)&&q()},[l,q,b,s,O]);const D=k=>_=>{var R;(R=k.onKeyDown)==null||R.call(k,_),!(_.key!=="Escape"||_.which===229||!H())&&(t||(_.stopPropagation(),u&&u(_,"escapeKeyDown")))},W=k=>_=>{var R;(R=k.onClick)==null||R.call(k,_),_.target===_.currentTarget&&u&&u(_,"backdropClick")};return{getRootProps:(k={})=>{const _=p2(e);delete _.onTransitionEnter,delete _.onTransitionExited;const R={..._,...k};return{role:"presentation",...R,onKeyDown:D(R),ref:v}},getBackdropProps:(k={})=>{const _=k;return{"aria-hidden":!0,..._,onClick:W(_),open:l}},getTransitionProps:()=>{const k=()=>{m(!1),o&&o()},_=()=>{m(!0),i&&i(),s&&q()};return{onEnter:u5(k,(c==null?void 0:c.props.onEnter)??Z5),onExited:u5(_,(c==null?void 0:c.props.onExited)??Z5)}},rootRef:v,portalRef:z,isTopModal:H,exited:g,hasTransition:b}}function OP(e){return an("MuiModal",e)}un("MuiModal",["root","hidden","backdrop"]);const PP=e=>{const{open:r,exited:t,classes:n}=e;return nn({root:["root",!r&&t&&"hidden"],backdrop:["backdrop"]},OP,n)},FP=or("div",{name:"MuiModal",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,!t.open&&t.exited&&r.hidden]}})(cn(({theme:e})=>({position:"fixed",zIndex:(e.vars||e).zIndex.modal,right:0,bottom:0,top:0,left:0,variants:[{props:({ownerState:r})=>!r.open&&r.exited,style:{visibility:"hidden"}}]}))),BP=or(Xk,{name:"MuiModal",slot:"Backdrop"})({zIndex:-1}),Yk=G.forwardRef(function(r,t){const n=dn({name:"MuiModal",props:r}),{BackdropComponent:s=BP,BackdropProps:o,classes:i,className:c,closeAfterTransition:u=!1,children:l,container:d,component:h,components:f={},componentsProps:p={},disableAutoFocus:v=!1,disableEnforceFocus:g=!1,disableEscapeKeyDown:m=!1,disablePortal:b=!1,disableRestoreFocus:y=!1,disableScrollLock:S=!1,hideBackdrop:C=!1,keepMounted:L=!1,onClose:O,onTransitionEnter:H,onTransitionExited:z,open:q,slotProps:D={},slots:W={},theme:P,...I}=n,U={...n,closeAfterTransition:u,disableAutoFocus:v,disableEnforceFocus:g,disableEscapeKeyDown:m,disablePortal:b,disableRestoreFocus:y,disableScrollLock:S,hideBackdrop:C,keepMounted:L},{getRootProps:k,getBackdropProps:_,getTransitionProps:R,portalRef:j,isTopModal:A,exited:N,hasTransition:V}=IP({...U,rootRef:t}),M={...U,exited:N},Z=PP(M),J={};if(l.props.tabIndex===void 0&&(J.tabIndex="-1"),V){const{onEnter:ee,onExited:ue}=R();J.onEnter=ee,J.onExited=ue}const re={slots:{root:f.Root,backdrop:f.Backdrop,...W},slotProps:{...p,...D}},[X,ne]=ln("root",{ref:t,elementType:FP,externalForwardedProps:{...re,...I,component:h},getSlotProps:k,ownerState:M,className:Pr(c,Z==null?void 0:Z.root,!M.open&&M.exited&&(Z==null?void 0:Z.hidden))}),[Y,K]=ln("backdrop",{ref:o==null?void 0:o.ref,elementType:s,externalForwardedProps:re,shouldForwardComponentProp:!0,additionalProps:o,getSlotProps:ee=>_({...ee,onClick:ue=>{ee!=null&&ee.onClick&&ee.onClick(ue)}}),className:Pr(o==null?void 0:o.className,Z==null?void 0:Z.backdrop),ownerState:M});return!L&&!q&&(!V||N)?null:a.jsx(Kk,{ref:j,container:d,disablePortal:b,children:a.jsxs(X,{...ne,children:[!C&&s?a.jsx(Y,{...K}):null,a.jsx(kP,{disableEnforceFocus:g,disableAutoFocus:v,disableRestoreFocus:y,isEnabled:A,open:q,children:G.cloneElement(l,J)})]})})});function zP(e){return an("MuiPaper",e)}un("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const $P=e=>{const{square:r,elevation:t,variant:n,classes:s}=e,o={root:["root",n,!r&&"rounded",n==="elevation"&&`elevation${t}`]};return nn(o,zP,s)},UP=or("div",{name:"MuiPaper",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,r[t.variant],!t.square&&r.rounded,t.variant==="elevation"&&r[`elevation${t.elevation}`]]}})(cn(({theme:e})=>({backgroundColor:(e.vars||e).palette.background.paper,color:(e.vars||e).palette.text.primary,transition:e.transitions.create("box-shadow"),variants:[{props:({ownerState:r})=>!r.square,style:{borderRadius:e.shape.borderRadius}},{props:{variant:"outlined"},style:{border:`1px solid ${(e.vars||e).palette.divider}`}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}))),sa=G.forwardRef(function(r,t){var p;const n=dn({props:r,name:"MuiPaper"}),s=Kf(),{className:o,component:i="div",elevation:c=1,square:u=!1,variant:l="elevation",...d}=n,h={...n,component:i,elevation:c,square:u,variant:l},f=$P(h);return a.jsx(UP,{as:i,ownerState:h,className:Pr(f.root,o),ref:t,...d,style:{...l==="elevation"&&{"--Paper-shadow":(s.vars||s).shadows[c],...s.vars&&{"--Paper-overlay":(p=s.vars.overlays)==null?void 0:p[c]},...!s.vars&&s.palette.mode==="dark"&&{"--Paper-overlay":`linear-gradient(${Ca("#fff",dS(c))}, ${Ca("#fff",dS(c))})`}},...d.style}})});function HP(e){return an("MuiPopover",e)}un("MuiPopover",["root","paper"]);function J5(e,r){let t=0;return typeof r=="number"?t=r:r==="center"?t=e.height/2:r==="bottom"&&(t=e.height),t}function Q5(e,r){let t=0;return typeof r=="number"?t=r:r==="center"?t=e.width/2:r==="right"&&(t=e.width),t}function e8(e){return[e.horizontal,e.vertical].map(r=>typeof r=="number"?`${r}px`:r).join(" ")}function vy(e){return typeof e=="function"?e():e}const VP=e=>{const{classes:r}=e;return nn({root:["root"],paper:["paper"]},HP,r)},WP=or(Yk,{name:"MuiPopover",slot:"Root"})({}),Zk=or(sa,{name:"MuiPopover",slot:"Paper"})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),A6=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiPopover"}),{action:s,anchorEl:o,anchorOrigin:i={vertical:"top",horizontal:"left"},anchorPosition:c,anchorReference:u="anchorEl",children:l,className:d,container:h,elevation:f=8,marginThreshold:p=16,open:v,PaperProps:g={},slots:m={},slotProps:b={},transformOrigin:y={vertical:"top",horizontal:"left"},TransitionComponent:S,transitionDuration:C="auto",TransitionProps:L={},disableScrollLock:O=!1,...H}=n,z=G.useRef(),q={...n,anchorOrigin:i,anchorReference:u,elevation:f,marginThreshold:p,transformOrigin:y,TransitionComponent:S,transitionDuration:C,TransitionProps:L},D=VP(q),W=G.useCallback(()=>{if(u==="anchorPosition")return c;const ee=vy(o),se=(ee&&ee.nodeType===1?ee:co(z.current).body).getBoundingClientRect();return{top:se.top+J5(se,i.vertical),left:se.left+Q5(se,i.horizontal)}},[o,i.horizontal,i.vertical,c,u]),P=G.useCallback(ee=>({vertical:J5(ee,y.vertical),horizontal:Q5(ee,y.horizontal)}),[y.horizontal,y.vertical]),I=G.useCallback(ee=>{const ue={width:ee.offsetWidth,height:ee.offsetHeight},se=P(ue);if(u==="none")return{top:null,left:null,transformOrigin:e8(se)};const ce=W();let fe=ce.top-se.vertical,ve=ce.left-se.horizontal;const _e=fe+ue.height,le=ve+ue.width,ke=Qc(vy(o)),Te=ke.innerHeight-p,pe=ke.innerWidth-p;if(p!==null&&fe<p){const ye=fe-p;fe-=ye,se.vertical+=ye}else if(p!==null&&_e>Te){const ye=_e-Te;fe-=ye,se.vertical+=ye}if(p!==null&&ve<p){const ye=ve-p;ve-=ye,se.horizontal+=ye}else if(le>pe){const ye=le-pe;ve-=ye,se.horizontal+=ye}return{top:`${Math.round(fe)}px`,left:`${Math.round(ve)}px`,transformOrigin:e8(se)}},[o,u,W,P,p]),[U,k]=G.useState(v),_=G.useCallback(()=>{const ee=z.current;if(!ee)return;const ue=I(ee);ue.top!==null&&ee.style.setProperty("top",ue.top),ue.left!==null&&(ee.style.left=ue.left),ee.style.transformOrigin=ue.transformOrigin,k(!0)},[I]);G.useEffect(()=>(O&&window.addEventListener("scroll",_),()=>window.removeEventListener("scroll",_)),[o,O,_]);const R=()=>{_()},j=()=>{k(!1)};G.useEffect(()=>{v&&_()}),G.useImperativeHandle(s,()=>v?{updatePosition:()=>{_()}}:null,[v,_]),G.useEffect(()=>{if(!v)return;const ee=dw(()=>{_()}),ue=Qc(vy(o));return ue.addEventListener("resize",ee),()=>{ee.clear(),ue.removeEventListener("resize",ee)}},[o,v,_]);let A=C;const N={slots:{transition:S,...m},slotProps:{transition:L,paper:g,...b}},[V,M]=ln("transition",{elementType:Nv,externalForwardedProps:N,ownerState:q,getSlotProps:ee=>({...ee,onEntering:(ue,se)=>{var ce;(ce=ee.onEntering)==null||ce.call(ee,ue,se),R()},onExited:ue=>{var se;(se=ee.onExited)==null||se.call(ee,ue),j()}}),additionalProps:{appear:!0,in:v}});C==="auto"&&!V.muiSupportAuto&&(A=void 0);const Z=h||(o?co(vy(o)).body:void 0),[J,{slots:re,slotProps:X,...ne}]=ln("root",{ref:t,elementType:WP,externalForwardedProps:{...N,...H},shouldForwardComponentProp:!0,additionalProps:{slots:{backdrop:m.backdrop},slotProps:{backdrop:Ik(typeof b.backdrop=="function"?b.backdrop(q):b.backdrop,{invisible:!0})},container:Z,open:v},ownerState:q,className:Pr(D.root,d)}),[Y,K]=ln("paper",{ref:z,className:D.paper,elementType:Zk,externalForwardedProps:N,shouldForwardComponentProp:!0,additionalProps:{elevation:f,style:U?void 0:{opacity:0}},ownerState:q});return a.jsx(J,{...ne,...!vS(J)&&{slots:re,slotProps:X,disableScrollLock:O},children:a.jsx(V,{...M,timeout:A,children:a.jsx(Y,{...K,children:l})})})});function qP(e){return an("MuiMenu",e)}un("MuiMenu",["root","paper","list"]);const GP={vertical:"top",horizontal:"right"},KP={vertical:"top",horizontal:"left"},XP=e=>{const{classes:r}=e;return nn({root:["root"],paper:["paper"],list:["list"]},qP,r)},YP=or(A6,{shouldForwardProp:e=>xl(e)||e==="classes",name:"MuiMenu",slot:"Root"})({}),ZP=or(Zk,{name:"MuiMenu",slot:"Paper"})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),JP=or(pP,{name:"MuiMenu",slot:"List"})({outline:0}),Jk=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiMenu"}),{autoFocus:s=!0,children:o,className:i,disableAutoFocusItem:c=!1,MenuListProps:u={},onClose:l,open:d,PaperProps:h={},PopoverClasses:f,transitionDuration:p="auto",TransitionProps:{onEntering:v,...g}={},variant:m="selectedMenu",slots:b={},slotProps:y={},...S}=n,C=Xm(),L={...n,autoFocus:s,disableAutoFocusItem:c,MenuListProps:u,onEntering:v,PaperProps:h,transitionDuration:p,TransitionProps:g,variant:m},O=XP(L),H=s&&!c&&d,z=G.useRef(null),q=(A,N)=>{z.current&&z.current.adjustStyleForScrollbar(A,{direction:C?"rtl":"ltr"}),v&&v(A,N)},D=A=>{A.key==="Tab"&&(A.preventDefault(),l&&l(A,"tabKeyDown"))};let W=-1;G.Children.map(o,(A,N)=>{G.isValidElement(A)&&(A.props.disabled||(m==="selectedMenu"&&A.props.selected||W===-1)&&(W=N))});const P={slots:b,slotProps:{list:u,transition:g,paper:h,...y}},I=Om({elementType:b.root,externalSlotProps:y.root,ownerState:L,className:[O.root,i]}),[U,k]=ln("paper",{className:O.paper,elementType:ZP,externalForwardedProps:P,shouldForwardComponentProp:!0,ownerState:L}),[_,R]=ln("list",{className:Pr(O.list,u.className),elementType:JP,shouldForwardComponentProp:!0,externalForwardedProps:P,getSlotProps:A=>({...A,onKeyDown:N=>{var V;D(N),(V=A.onKeyDown)==null||V.call(A,N)}}),ownerState:L}),j=typeof P.slotProps.transition=="function"?P.slotProps.transition(L):P.slotProps.transition;return a.jsx(YP,{onClose:l,anchorOrigin:{vertical:"bottom",horizontal:C?"right":"left"},transformOrigin:C?GP:KP,slots:{root:b.root,paper:U,backdrop:b.backdrop,...b.transition&&{transition:b.transition}},slotProps:{root:I,paper:k,backdrop:typeof y.backdrop=="function"?y.backdrop(L):y.backdrop,transition:{...j,onEntering:(...A)=>{var N;q(...A),(N=j==null?void 0:j.onEntering)==null||N.call(j,...A)}}},open:d,ref:t,transitionDuration:p,ownerState:L,...S,classes:f,children:a.jsx(_,{actions:z,autoFocus:s&&(W===-1||c),autoFocusItem:H,variant:m,...R,children:o})})});function QP(e){return an("MuiDivider",e)}const t8=un("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),eF=e=>{const{absolute:r,children:t,classes:n,flexItem:s,light:o,orientation:i,textAlign:c,variant:u}=e;return nn({root:["root",r&&"absolute",u,o&&"light",i==="vertical"&&"vertical",s&&"flexItem",t&&"withChildren",t&&i==="vertical"&&"withChildrenVertical",c==="right"&&i!=="vertical"&&"textAlignRight",c==="left"&&i!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",i==="vertical"&&"wrapperVertical"]},QP,n)},tF=or("div",{name:"MuiDivider",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,t.absolute&&r.absolute,r[t.variant],t.light&&r.light,t.orientation==="vertical"&&r.vertical,t.flexItem&&r.flexItem,t.children&&r.withChildren,t.children&&t.orientation==="vertical"&&r.withChildrenVertical,t.textAlign==="right"&&t.orientation!=="vertical"&&r.textAlignRight,t.textAlign==="left"&&t.orientation!=="vertical"&&r.textAlignLeft]}})(cn(({theme:e})=>({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(e.vars||e).palette.divider,borderBottomWidth:"thin",variants:[{props:{absolute:!0},style:{position:"absolute",bottom:0,left:0,width:"100%"}},{props:{light:!0},style:{borderColor:e.vars?`rgba(${e.vars.palette.dividerChannel} / 0.08)`:Ca(e.palette.divider,.08)}},{props:{variant:"inset"},style:{marginLeft:72}},{props:{variant:"middle",orientation:"horizontal"},style:{marginLeft:e.spacing(2),marginRight:e.spacing(2)}},{props:{variant:"middle",orientation:"vertical"},style:{marginTop:e.spacing(1),marginBottom:e.spacing(1)}},{props:{orientation:"vertical"},style:{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"}},{props:{flexItem:!0},style:{alignSelf:"stretch",height:"auto"}},{props:({ownerState:r})=>!!r.children,style:{display:"flex",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}},{props:({ownerState:r})=>r.children&&r.orientation!=="vertical",style:{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(e.vars||e).palette.divider}`,borderTopStyle:"inherit"}}},{props:({ownerState:r})=>r.orientation==="vertical"&&r.children,style:{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(e.vars||e).palette.divider}`,borderLeftStyle:"inherit"}}},{props:({ownerState:r})=>r.textAlign==="right"&&r.orientation!=="vertical",style:{"&::before":{width:"90%"},"&::after":{width:"10%"}}},{props:({ownerState:r})=>r.textAlign==="left"&&r.orientation!=="vertical",style:{"&::before":{width:"10%"},"&::after":{width:"90%"}}}]}))),rF=or("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.wrapper,t.orientation==="vertical"&&r.wrapperVertical]}})(cn(({theme:e})=>({display:"inline-block",paddingLeft:`calc(${e.spacing(1)} * 1.2)`,paddingRight:`calc(${e.spacing(1)} * 1.2)`,whiteSpace:"nowrap",variants:[{props:{orientation:"vertical"},style:{paddingTop:`calc(${e.spacing(1)} * 1.2)`,paddingBottom:`calc(${e.spacing(1)} * 1.2)`}}]}))),Tv=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiDivider"}),{absolute:s=!1,children:o,className:i,orientation:c="horizontal",component:u=o||c==="vertical"?"div":"hr",flexItem:l=!1,light:d=!1,role:h=u!=="hr"?"separator":void 0,textAlign:f="center",variant:p="fullWidth",...v}=n,g={...n,absolute:s,component:u,flexItem:l,light:d,orientation:c,role:h,textAlign:f,variant:p},m=eF(g);return a.jsx(tF,{as:u,className:Pr(m.root,i),role:h,ref:t,ownerState:g,"aria-orientation":h==="separator"&&(u!=="hr"||c==="vertical")?c:void 0,...v,children:o?a.jsx(rF,{className:m.wrapper,ownerState:g,children:o}):null})});Tv&&(Tv.muiSkipListHighlight=!0);function nF(e){return an("MuiListItemIcon",e)}const r8=un("MuiListItemIcon",["root","alignItemsFlexStart"]),aF=e=>{const{alignItems:r,classes:t}=e;return nn({root:["root",r==="flex-start"&&"alignItemsFlexStart"]},nF,t)},sF=or("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,t.alignItems==="flex-start"&&r.alignItemsFlexStart]}})(cn(({theme:e})=>({minWidth:56,color:(e.vars||e).palette.action.active,flexShrink:0,display:"inline-flex",variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}))),r3=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiListItemIcon"}),{className:s,...o}=n,i=G.useContext(Ev),c={...n,alignItems:i.alignItems},u=aF(c);return a.jsx(sF,{className:Pr(u.root,s),ownerState:c,ref:t,...o})});function iF(e){return an("MuiTypography",e)}const n8=un("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]),oF={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},lF=GI(),cF=e=>{const{align:r,gutterBottom:t,noWrap:n,paragraph:s,variant:o,classes:i}=e,c={root:["root",o,e.align!=="inherit"&&`align${yr(r)}`,t&&"gutterBottom",n&&"noWrap",s&&"paragraph"]};return nn(c,iF,i)},uF=or("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,t.variant&&r[t.variant],t.align!=="inherit"&&r[`align${yr(t.align)}`],t.noWrap&&r.noWrap,t.gutterBottom&&r.gutterBottom,t.paragraph&&r.paragraph]}})(cn(({theme:e})=>{var r;return{margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(e.typography).filter(([t,n])=>t!=="inherit"&&n&&typeof n=="object").map(([t,n])=>({props:{variant:t},style:n})),...Object.entries(e.palette).filter(qi()).map(([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].main}})),...Object.entries(((r=e.palette)==null?void 0:r.text)||{}).filter(([,t])=>typeof t=="string").map(([t])=>({props:{color:`text${yr(t)}`},style:{color:(e.vars||e).palette.text[t]}})),{props:({ownerState:t})=>t.align!=="inherit",style:{textAlign:"var(--Typography-textAlign)"}},{props:({ownerState:t})=>t.noWrap,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:({ownerState:t})=>t.gutterBottom,style:{marginBottom:"0.35em"}},{props:({ownerState:t})=>t.paragraph,style:{marginBottom:16}}]}})),a8={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},Et=G.forwardRef(function(r,t){const{color:n,...s}=dn({props:r,name:"MuiTypography"}),o=!oF[n],i=lF({...s,...o&&{color:n}}),{align:c="inherit",className:u,component:l,gutterBottom:d=!1,noWrap:h=!1,paragraph:f=!1,variant:p="body1",variantMapping:v=a8,...g}=i,m={...i,align:c,color:n,className:u,component:l,gutterBottom:d,noWrap:h,paragraph:f,variant:p,variantMapping:v},b=l||(f?"p":v[p]||a8[p])||"span",y=cF(m);return a.jsx(uF,{as:b,ref:t,className:Pr(y.root,u),...g,ownerState:m,style:{...c!=="inherit"&&{"--Typography-textAlign":c},...g.style}})});function dF(e){return an("MuiListItemText",e)}const Am=un("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),fF=e=>{const{classes:r,inset:t,primary:n,secondary:s,dense:o}=e;return nn({root:["root",t&&"inset",o&&"dense",n&&s&&"multiline"],primary:["primary"],secondary:["secondary"]},dF,r)},hF=or("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[{[`& .${Am.primary}`]:r.primary},{[`& .${Am.secondary}`]:r.secondary},r.root,t.inset&&r.inset,t.primary&&t.secondary&&r.multiline,t.dense&&r.dense]}})({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4,[`.${n8.root}:where(& .${Am.primary})`]:{display:"block"},[`.${n8.root}:where(& .${Am.secondary})`]:{display:"block"},variants:[{props:({ownerState:e})=>e.primary&&e.secondary,style:{marginTop:6,marginBottom:6}},{props:({ownerState:e})=>e.inset,style:{paddingLeft:56}}]}),pF=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiListItemText"}),{children:s,className:o,disableTypography:i=!1,inset:c=!1,primary:u,primaryTypographyProps:l,secondary:d,secondaryTypographyProps:h,slots:f={},slotProps:p={},...v}=n,{dense:g}=G.useContext(Ev);let m=u??s,b=d;const y={...n,disableTypography:i,inset:c,primary:!!m,secondary:!!b,dense:g},S=fF(y),C={slots:f,slotProps:{primary:l,secondary:h,...p}},[L,O]=ln("root",{className:Pr(S.root,o),elementType:hF,externalForwardedProps:{...C,...v},ownerState:y,ref:t}),[H,z]=ln("primary",{className:S.primary,elementType:Et,externalForwardedProps:C,ownerState:y}),[q,D]=ln("secondary",{className:S.secondary,elementType:Et,externalForwardedProps:C,ownerState:y});return m!=null&&m.type!==Et&&!i&&(m=a.jsx(H,{variant:g?"body2":"body1",component:z!=null&&z.variant?void 0:"span",...z,children:m})),b!=null&&b.type!==Et&&!i&&(b=a.jsx(q,{variant:"body2",color:"textSecondary",...D,children:b})),a.jsxs(L,{...O,children:[m,b]})});function mF(e){return an("MuiMenuItem",e)}const T1=un("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),gF=(e,r)=>{const{ownerState:t}=e;return[r.root,t.dense&&r.dense,t.divider&&r.divider,!t.disableGutters&&r.gutters]},vF=e=>{const{disabled:r,dense:t,divider:n,disableGutters:s,selected:o,classes:i}=e,u=nn({root:["root",t&&"dense",r&&"disabled",!s&&"gutters",n&&"divider",o&&"selected"]},mF,i);return{...i,...u}},xF=or($f,{shouldForwardProp:e=>xl(e)||e==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:gF})(cn(({theme:e})=>({...e.typography.body1,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap","&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${T1.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:Ca(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${T1.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:Ca(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`&.${T1.selected}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:Ca(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:Ca(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${T1.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${T1.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},[`& + .${t8.root}`]:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},[`& + .${t8.inset}`]:{marginLeft:52},[`& .${Am.root}`]:{marginTop:0,marginBottom:0},[`& .${Am.inset}`]:{paddingLeft:36},[`& .${r8.root}`]:{minWidth:36},variants:[{props:({ownerState:r})=>!r.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:r})=>r.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:r})=>!r.dense,style:{[e.breakpoints.up("sm")]:{minHeight:"auto"}}},{props:({ownerState:r})=>r.dense,style:{minHeight:32,paddingTop:4,paddingBottom:4,...e.typography.body2,[`& .${r8.root} svg`]:{fontSize:"1.25rem"}}}]}))),zl=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiMenuItem"}),{autoFocus:s=!1,component:o="li",dense:i=!1,divider:c=!1,disableGutters:u=!1,focusVisibleClassName:l,role:d="menuitem",tabIndex:h,className:f,...p}=n,v=G.useContext(Ev),g=G.useMemo(()=>({dense:i||v.dense||!1,disableGutters:u}),[v.dense,i,u]),m=G.useRef(null);Jc(()=>{s&&m.current&&m.current.focus()},[s]);const b={...n,dense:g.dense,divider:c,disableGutters:u},y=vF(n),S=Ni(m,t);let C;return n.disabled||(C=h!==void 0?h:-1),a.jsx(Ev.Provider,{value:g,children:a.jsx(xF,{ref:S,role:d,tabIndex:C,component:o,focusVisibleClassName:Pr(y.focusVisible,l),className:Pr(y.root,f),...p,ownerState:b,classes:y})})});function bF(e){return an("MuiIconButton",e)}const s8=un("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge","loading","loadingIndicator","loadingWrapper"]),yF=e=>{const{classes:r,disabled:t,color:n,edge:s,size:o,loading:i}=e,c={root:["root",i&&"loading",t&&"disabled",n!=="default"&&`color${yr(n)}`,s&&`edge${yr(s)}`,`size${yr(o)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]};return nn(c,bF,r)},wF=or($f,{name:"MuiIconButton",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,t.loading&&r.loading,t.color!=="default"&&r[`color${yr(t.color)}`],t.edge&&r[`edge${yr(t.edge)}`],r[`size${yr(t.size)}`]]}})(cn(({theme:e})=>({textAlign:"center",flex:"0 0 auto",fontSize:e.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(e.vars||e).palette.action.active,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),variants:[{props:r=>!r.disableRipple,style:{"--IconButton-hoverBg":e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:Ca(e.palette.action.active,e.palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]})),cn(({theme:e})=>({variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(e.palette).filter(qi()).map(([r])=>({props:{color:r},style:{color:(e.vars||e).palette[r].main}})),...Object.entries(e.palette).filter(qi()).map(([r])=>({props:{color:r},style:{"--IconButton-hoverBg":e.vars?`rgba(${(e.vars||e).palette[r].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:Ca((e.vars||e).palette[r].main,e.palette.action.hoverOpacity)}})),{props:{size:"small"},style:{padding:5,fontSize:e.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:e.typography.pxToRem(28)}}],[`&.${s8.disabled}`]:{backgroundColor:"transparent",color:(e.vars||e).palette.action.disabled},[`&.${s8.loading}`]:{color:"transparent"}}))),SF=or("span",{name:"MuiIconButton",slot:"LoadingIndicator"})(({theme:e})=>({display:"none",position:"absolute",visibility:"visible",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:(e.vars||e).palette.action.disabled,variants:[{props:{loading:!0},style:{display:"flex"}}]})),sn=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiIconButton"}),{edge:s=!1,children:o,className:i,color:c="default",disabled:u=!1,disableFocusRipple:l=!1,size:d="medium",id:h,loading:f=null,loadingIndicator:p,...v}=n,g=Od(h),m=p??a.jsx(Vs,{"aria-labelledby":g,color:"inherit",size:16}),b={...n,edge:s,color:c,disabled:u,disableFocusRipple:l,loading:f,loadingIndicator:m,size:d},y=yF(b);return a.jsxs(wF,{id:f?g:h,className:Pr(y.root,i),centerRipple:!0,focusRipple:!l,disabled:u||f,ref:t,...v,ownerState:b,children:[typeof f=="boolean"&&a.jsx("span",{className:y.loadingWrapper,style:{display:"contents"},children:a.jsx(SF,{className:y.loadingIndicator,ownerState:b,children:f&&m})}),o]})});var dl="top",vc="bottom",xc="right",fl="left",C6="auto",sx=[dl,vc,xc,fl],Pm="start",Lv="end",_F="clippingParents",Qk="viewport",L1="popper",AF="reference",i8=sx.reduce(function(e,r){return e.concat([r+"-"+Pm,r+"-"+Lv])},[]),e7=[].concat(sx,[C6]).reduce(function(e,r){return e.concat([r,r+"-"+Pm,r+"-"+Lv])},[]),CF="beforeRead",jF="read",kF="afterRead",RF="beforeMain",EF="main",NF="afterMain",TF="beforeWrite",LF="write",MF="afterWrite",DF=[CF,jF,kF,RF,EF,NF,TF,LF,MF];function Vu(e){return e?(e.nodeName||"").toLowerCase():null}function Vl(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var r=e.ownerDocument;return r&&r.defaultView||window}return e}function D0(e){var r=Vl(e).Element;return e instanceof r||e instanceof Element}function mc(e){var r=Vl(e).HTMLElement;return e instanceof r||e instanceof HTMLElement}function j6(e){if(typeof ShadowRoot>"u")return!1;var r=Vl(e).ShadowRoot;return e instanceof r||e instanceof ShadowRoot}function IF(e){var r=e.state;Object.keys(r.elements).forEach(function(t){var n=r.styles[t]||{},s=r.attributes[t]||{},o=r.elements[t];!mc(o)||!Vu(o)||(Object.assign(o.style,n),Object.keys(s).forEach(function(i){var c=s[i];c===!1?o.removeAttribute(i):o.setAttribute(i,c===!0?"":c)}))})}function OF(e){var r=e.state,t={popper:{position:r.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(r.elements.popper.style,t.popper),r.styles=t,r.elements.arrow&&Object.assign(r.elements.arrow.style,t.arrow),function(){Object.keys(r.elements).forEach(function(n){var s=r.elements[n],o=r.attributes[n]||{},i=Object.keys(r.styles.hasOwnProperty(n)?r.styles[n]:t[n]),c=i.reduce(function(u,l){return u[l]="",u},{});!mc(s)||!Vu(s)||(Object.assign(s.style,c),Object.keys(o).forEach(function(u){s.removeAttribute(u)}))})}}const PF={name:"applyStyles",enabled:!0,phase:"write",fn:IF,effect:OF,requires:["computeStyles"]};function Uu(e){return e.split("-")[0]}var C0=Math.max,g2=Math.min,Fm=Math.round;function yS(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(r){return r.brand+"/"+r.version}).join(" "):navigator.userAgent}function t7(){return!/^((?!chrome|android).)*safari/i.test(yS())}function Bm(e,r,t){r===void 0&&(r=!1),t===void 0&&(t=!1);var n=e.getBoundingClientRect(),s=1,o=1;r&&mc(e)&&(s=e.offsetWidth>0&&Fm(n.width)/e.offsetWidth||1,o=e.offsetHeight>0&&Fm(n.height)/e.offsetHeight||1);var i=D0(e)?Vl(e):window,c=i.visualViewport,u=!t7()&&t,l=(n.left+(u&&c?c.offsetLeft:0))/s,d=(n.top+(u&&c?c.offsetTop:0))/o,h=n.width/s,f=n.height/o;return{width:h,height:f,top:d,right:l+h,bottom:d+f,left:l,x:l,y:d}}function k6(e){var r=Bm(e),t=e.offsetWidth,n=e.offsetHeight;return Math.abs(r.width-t)<=1&&(t=r.width),Math.abs(r.height-n)<=1&&(n=r.height),{x:e.offsetLeft,y:e.offsetTop,width:t,height:n}}function r7(e,r){var t=r.getRootNode&&r.getRootNode();if(e.contains(r))return!0;if(t&&j6(t)){var n=r;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function Pd(e){return Vl(e).getComputedStyle(e)}function FF(e){return["table","td","th"].indexOf(Vu(e))>=0}function Xf(e){return((D0(e)?e.ownerDocument:e.document)||window.document).documentElement}function hw(e){return Vu(e)==="html"?e:e.assignedSlot||e.parentNode||(j6(e)?e.host:null)||Xf(e)}function o8(e){return!mc(e)||Pd(e).position==="fixed"?null:e.offsetParent}function BF(e){var r=/firefox/i.test(yS()),t=/Trident/i.test(yS());if(t&&mc(e)){var n=Pd(e);if(n.position==="fixed")return null}var s=hw(e);for(j6(s)&&(s=s.host);mc(s)&&["html","body"].indexOf(Vu(s))<0;){var o=Pd(s);if(o.transform!=="none"||o.perspective!=="none"||o.contain==="paint"||["transform","perspective"].indexOf(o.willChange)!==-1||r&&o.willChange==="filter"||r&&o.filter&&o.filter!=="none")return s;s=s.parentNode}return null}function ix(e){for(var r=Vl(e),t=o8(e);t&&FF(t)&&Pd(t).position==="static";)t=o8(t);return t&&(Vu(t)==="html"||Vu(t)==="body"&&Pd(t).position==="static")?r:t||BF(e)||r}function R6(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function ov(e,r,t){return C0(e,g2(r,t))}function zF(e,r,t){var n=ov(e,r,t);return n>t?t:n}function n7(){return{top:0,right:0,bottom:0,left:0}}function a7(e){return Object.assign({},n7(),e)}function s7(e,r){return r.reduce(function(t,n){return t[n]=e,t},{})}var $F=function(r,t){return r=typeof r=="function"?r(Object.assign({},t.rects,{placement:t.placement})):r,a7(typeof r!="number"?r:s7(r,sx))};function UF(e){var r,t=e.state,n=e.name,s=e.options,o=t.elements.arrow,i=t.modifiersData.popperOffsets,c=Uu(t.placement),u=R6(c),l=[fl,xc].indexOf(c)>=0,d=l?"height":"width";if(!(!o||!i)){var h=$F(s.padding,t),f=k6(o),p=u==="y"?dl:fl,v=u==="y"?vc:xc,g=t.rects.reference[d]+t.rects.reference[u]-i[u]-t.rects.popper[d],m=i[u]-t.rects.reference[u],b=ix(o),y=b?u==="y"?b.clientHeight||0:b.clientWidth||0:0,S=g/2-m/2,C=h[p],L=y-f[d]-h[v],O=y/2-f[d]/2+S,H=ov(C,O,L),z=u;t.modifiersData[n]=(r={},r[z]=H,r.centerOffset=H-O,r)}}function HF(e){var r=e.state,t=e.options,n=t.element,s=n===void 0?"[data-popper-arrow]":n;s!=null&&(typeof s=="string"&&(s=r.elements.popper.querySelector(s),!s)||r7(r.elements.popper,s)&&(r.elements.arrow=s))}const VF={name:"arrow",enabled:!0,phase:"main",fn:UF,effect:HF,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function zm(e){return e.split("-")[1]}var WF={top:"auto",right:"auto",bottom:"auto",left:"auto"};function qF(e,r){var t=e.x,n=e.y,s=r.devicePixelRatio||1;return{x:Fm(t*s)/s||0,y:Fm(n*s)/s||0}}function l8(e){var r,t=e.popper,n=e.popperRect,s=e.placement,o=e.variation,i=e.offsets,c=e.position,u=e.gpuAcceleration,l=e.adaptive,d=e.roundOffsets,h=e.isFixed,f=i.x,p=f===void 0?0:f,v=i.y,g=v===void 0?0:v,m=typeof d=="function"?d({x:p,y:g}):{x:p,y:g};p=m.x,g=m.y;var b=i.hasOwnProperty("x"),y=i.hasOwnProperty("y"),S=fl,C=dl,L=window;if(l){var O=ix(t),H="clientHeight",z="clientWidth";if(O===Vl(t)&&(O=Xf(t),Pd(O).position!=="static"&&c==="absolute"&&(H="scrollHeight",z="scrollWidth")),O=O,s===dl||(s===fl||s===xc)&&o===Lv){C=vc;var q=h&&O===L&&L.visualViewport?L.visualViewport.height:O[H];g-=q-n.height,g*=u?1:-1}if(s===fl||(s===dl||s===vc)&&o===Lv){S=xc;var D=h&&O===L&&L.visualViewport?L.visualViewport.width:O[z];p-=D-n.width,p*=u?1:-1}}var W=Object.assign({position:c},l&&WF),P=d===!0?qF({x:p,y:g},Vl(t)):{x:p,y:g};if(p=P.x,g=P.y,u){var I;return Object.assign({},W,(I={},I[C]=y?"0":"",I[S]=b?"0":"",I.transform=(L.devicePixelRatio||1)<=1?"translate("+p+"px, "+g+"px)":"translate3d("+p+"px, "+g+"px, 0)",I))}return Object.assign({},W,(r={},r[C]=y?g+"px":"",r[S]=b?p+"px":"",r.transform="",r))}function GF(e){var r=e.state,t=e.options,n=t.gpuAcceleration,s=n===void 0?!0:n,o=t.adaptive,i=o===void 0?!0:o,c=t.roundOffsets,u=c===void 0?!0:c,l={placement:Uu(r.placement),variation:zm(r.placement),popper:r.elements.popper,popperRect:r.rects.popper,gpuAcceleration:s,isFixed:r.options.strategy==="fixed"};r.modifiersData.popperOffsets!=null&&(r.styles.popper=Object.assign({},r.styles.popper,l8(Object.assign({},l,{offsets:r.modifiersData.popperOffsets,position:r.options.strategy,adaptive:i,roundOffsets:u})))),r.modifiersData.arrow!=null&&(r.styles.arrow=Object.assign({},r.styles.arrow,l8(Object.assign({},l,{offsets:r.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:u})))),r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-placement":r.placement})}const KF={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:GF,data:{}};var xy={passive:!0};function XF(e){var r=e.state,t=e.instance,n=e.options,s=n.scroll,o=s===void 0?!0:s,i=n.resize,c=i===void 0?!0:i,u=Vl(r.elements.popper),l=[].concat(r.scrollParents.reference,r.scrollParents.popper);return o&&l.forEach(function(d){d.addEventListener("scroll",t.update,xy)}),c&&u.addEventListener("resize",t.update,xy),function(){o&&l.forEach(function(d){d.removeEventListener("scroll",t.update,xy)}),c&&u.removeEventListener("resize",t.update,xy)}}const YF={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:XF,data:{}};var ZF={left:"right",right:"left",bottom:"top",top:"bottom"};function Yy(e){return e.replace(/left|right|bottom|top/g,function(r){return ZF[r]})}var JF={start:"end",end:"start"};function c8(e){return e.replace(/start|end/g,function(r){return JF[r]})}function E6(e){var r=Vl(e),t=r.pageXOffset,n=r.pageYOffset;return{scrollLeft:t,scrollTop:n}}function N6(e){return Bm(Xf(e)).left+E6(e).scrollLeft}function QF(e,r){var t=Vl(e),n=Xf(e),s=t.visualViewport,o=n.clientWidth,i=n.clientHeight,c=0,u=0;if(s){o=s.width,i=s.height;var l=t7();(l||!l&&r==="fixed")&&(c=s.offsetLeft,u=s.offsetTop)}return{width:o,height:i,x:c+N6(e),y:u}}function eB(e){var r,t=Xf(e),n=E6(e),s=(r=e.ownerDocument)==null?void 0:r.body,o=C0(t.scrollWidth,t.clientWidth,s?s.scrollWidth:0,s?s.clientWidth:0),i=C0(t.scrollHeight,t.clientHeight,s?s.scrollHeight:0,s?s.clientHeight:0),c=-n.scrollLeft+N6(e),u=-n.scrollTop;return Pd(s||t).direction==="rtl"&&(c+=C0(t.clientWidth,s?s.clientWidth:0)-o),{width:o,height:i,x:c,y:u}}function T6(e){var r=Pd(e),t=r.overflow,n=r.overflowX,s=r.overflowY;return/auto|scroll|overlay|hidden/.test(t+s+n)}function i7(e){return["html","body","#document"].indexOf(Vu(e))>=0?e.ownerDocument.body:mc(e)&&T6(e)?e:i7(hw(e))}function lv(e,r){var t;r===void 0&&(r=[]);var n=i7(e),s=n===((t=e.ownerDocument)==null?void 0:t.body),o=Vl(n),i=s?[o].concat(o.visualViewport||[],T6(n)?n:[]):n,c=r.concat(i);return s?c:c.concat(lv(hw(i)))}function wS(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function tB(e,r){var t=Bm(e,!1,r==="fixed");return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}function u8(e,r,t){return r===Qk?wS(QF(e,t)):D0(r)?tB(r,t):wS(eB(Xf(e)))}function rB(e){var r=lv(hw(e)),t=["absolute","fixed"].indexOf(Pd(e).position)>=0,n=t&&mc(e)?ix(e):e;return D0(n)?r.filter(function(s){return D0(s)&&r7(s,n)&&Vu(s)!=="body"}):[]}function nB(e,r,t,n){var s=r==="clippingParents"?rB(e):[].concat(r),o=[].concat(s,[t]),i=o[0],c=o.reduce(function(u,l){var d=u8(e,l,n);return u.top=C0(d.top,u.top),u.right=g2(d.right,u.right),u.bottom=g2(d.bottom,u.bottom),u.left=C0(d.left,u.left),u},u8(e,i,n));return c.width=c.right-c.left,c.height=c.bottom-c.top,c.x=c.left,c.y=c.top,c}function o7(e){var r=e.reference,t=e.element,n=e.placement,s=n?Uu(n):null,o=n?zm(n):null,i=r.x+r.width/2-t.width/2,c=r.y+r.height/2-t.height/2,u;switch(s){case dl:u={x:i,y:r.y-t.height};break;case vc:u={x:i,y:r.y+r.height};break;case xc:u={x:r.x+r.width,y:c};break;case fl:u={x:r.x-t.width,y:c};break;default:u={x:r.x,y:r.y}}var l=s?R6(s):null;if(l!=null){var d=l==="y"?"height":"width";switch(o){case Pm:u[l]=u[l]-(r[d]/2-t[d]/2);break;case Lv:u[l]=u[l]+(r[d]/2-t[d]/2);break}}return u}function Mv(e,r){r===void 0&&(r={});var t=r,n=t.placement,s=n===void 0?e.placement:n,o=t.strategy,i=o===void 0?e.strategy:o,c=t.boundary,u=c===void 0?_F:c,l=t.rootBoundary,d=l===void 0?Qk:l,h=t.elementContext,f=h===void 0?L1:h,p=t.altBoundary,v=p===void 0?!1:p,g=t.padding,m=g===void 0?0:g,b=a7(typeof m!="number"?m:s7(m,sx)),y=f===L1?AF:L1,S=e.rects.popper,C=e.elements[v?y:f],L=nB(D0(C)?C:C.contextElement||Xf(e.elements.popper),u,d,i),O=Bm(e.elements.reference),H=o7({reference:O,element:S,placement:s}),z=wS(Object.assign({},S,H)),q=f===L1?z:O,D={top:L.top-q.top+b.top,bottom:q.bottom-L.bottom+b.bottom,left:L.left-q.left+b.left,right:q.right-L.right+b.right},W=e.modifiersData.offset;if(f===L1&&W){var P=W[s];Object.keys(D).forEach(function(I){var U=[xc,vc].indexOf(I)>=0?1:-1,k=[dl,vc].indexOf(I)>=0?"y":"x";D[I]+=P[k]*U})}return D}function aB(e,r){r===void 0&&(r={});var t=r,n=t.placement,s=t.boundary,o=t.rootBoundary,i=t.padding,c=t.flipVariations,u=t.allowedAutoPlacements,l=u===void 0?e7:u,d=zm(n),h=d?c?i8:i8.filter(function(v){return zm(v)===d}):sx,f=h.filter(function(v){return l.indexOf(v)>=0});f.length===0&&(f=h);var p=f.reduce(function(v,g){return v[g]=Mv(e,{placement:g,boundary:s,rootBoundary:o,padding:i})[Uu(g)],v},{});return Object.keys(p).sort(function(v,g){return p[v]-p[g]})}function sB(e){if(Uu(e)===C6)return[];var r=Yy(e);return[c8(e),r,c8(r)]}function iB(e){var r=e.state,t=e.options,n=e.name;if(!r.modifiersData[n]._skip){for(var s=t.mainAxis,o=s===void 0?!0:s,i=t.altAxis,c=i===void 0?!0:i,u=t.fallbackPlacements,l=t.padding,d=t.boundary,h=t.rootBoundary,f=t.altBoundary,p=t.flipVariations,v=p===void 0?!0:p,g=t.allowedAutoPlacements,m=r.options.placement,b=Uu(m),y=b===m,S=u||(y||!v?[Yy(m)]:sB(m)),C=[m].concat(S).reduce(function(J,re){return J.concat(Uu(re)===C6?aB(r,{placement:re,boundary:d,rootBoundary:h,padding:l,flipVariations:v,allowedAutoPlacements:g}):re)},[]),L=r.rects.reference,O=r.rects.popper,H=new Map,z=!0,q=C[0],D=0;D<C.length;D++){var W=C[D],P=Uu(W),I=zm(W)===Pm,U=[dl,vc].indexOf(P)>=0,k=U?"width":"height",_=Mv(r,{placement:W,boundary:d,rootBoundary:h,altBoundary:f,padding:l}),R=U?I?xc:fl:I?vc:dl;L[k]>O[k]&&(R=Yy(R));var j=Yy(R),A=[];if(o&&A.push(_[P]<=0),c&&A.push(_[R]<=0,_[j]<=0),A.every(function(J){return J})){q=W,z=!1;break}H.set(W,A)}if(z)for(var N=v?3:1,V=function(re){var X=C.find(function(ne){var Y=H.get(ne);if(Y)return Y.slice(0,re).every(function(K){return K})});if(X)return q=X,"break"},M=N;M>0;M--){var Z=V(M);if(Z==="break")break}r.placement!==q&&(r.modifiersData[n]._skip=!0,r.placement=q,r.reset=!0)}}const oB={name:"flip",enabled:!0,phase:"main",fn:iB,requiresIfExists:["offset"],data:{_skip:!1}};function d8(e,r,t){return t===void 0&&(t={x:0,y:0}),{top:e.top-r.height-t.y,right:e.right-r.width+t.x,bottom:e.bottom-r.height+t.y,left:e.left-r.width-t.x}}function f8(e){return[dl,xc,vc,fl].some(function(r){return e[r]>=0})}function lB(e){var r=e.state,t=e.name,n=r.rects.reference,s=r.rects.popper,o=r.modifiersData.preventOverflow,i=Mv(r,{elementContext:"reference"}),c=Mv(r,{altBoundary:!0}),u=d8(i,n),l=d8(c,s,o),d=f8(u),h=f8(l);r.modifiersData[t]={referenceClippingOffsets:u,popperEscapeOffsets:l,isReferenceHidden:d,hasPopperEscaped:h},r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":h})}const cB={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:lB};function uB(e,r,t){var n=Uu(e),s=[fl,dl].indexOf(n)>=0?-1:1,o=typeof t=="function"?t(Object.assign({},r,{placement:e})):t,i=o[0],c=o[1];return i=i||0,c=(c||0)*s,[fl,xc].indexOf(n)>=0?{x:c,y:i}:{x:i,y:c}}function dB(e){var r=e.state,t=e.options,n=e.name,s=t.offset,o=s===void 0?[0,0]:s,i=e7.reduce(function(d,h){return d[h]=uB(h,r.rects,o),d},{}),c=i[r.placement],u=c.x,l=c.y;r.modifiersData.popperOffsets!=null&&(r.modifiersData.popperOffsets.x+=u,r.modifiersData.popperOffsets.y+=l),r.modifiersData[n]=i}const fB={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:dB};function hB(e){var r=e.state,t=e.name;r.modifiersData[t]=o7({reference:r.rects.reference,element:r.rects.popper,placement:r.placement})}const pB={name:"popperOffsets",enabled:!0,phase:"read",fn:hB,data:{}};function mB(e){return e==="x"?"y":"x"}function gB(e){var r=e.state,t=e.options,n=e.name,s=t.mainAxis,o=s===void 0?!0:s,i=t.altAxis,c=i===void 0?!1:i,u=t.boundary,l=t.rootBoundary,d=t.altBoundary,h=t.padding,f=t.tether,p=f===void 0?!0:f,v=t.tetherOffset,g=v===void 0?0:v,m=Mv(r,{boundary:u,rootBoundary:l,padding:h,altBoundary:d}),b=Uu(r.placement),y=zm(r.placement),S=!y,C=R6(b),L=mB(C),O=r.modifiersData.popperOffsets,H=r.rects.reference,z=r.rects.popper,q=typeof g=="function"?g(Object.assign({},r.rects,{placement:r.placement})):g,D=typeof q=="number"?{mainAxis:q,altAxis:q}:Object.assign({mainAxis:0,altAxis:0},q),W=r.modifiersData.offset?r.modifiersData.offset[r.placement]:null,P={x:0,y:0};if(O){if(o){var I,U=C==="y"?dl:fl,k=C==="y"?vc:xc,_=C==="y"?"height":"width",R=O[C],j=R+m[U],A=R-m[k],N=p?-z[_]/2:0,V=y===Pm?H[_]:z[_],M=y===Pm?-z[_]:-H[_],Z=r.elements.arrow,J=p&&Z?k6(Z):{width:0,height:0},re=r.modifiersData["arrow#persistent"]?r.modifiersData["arrow#persistent"].padding:n7(),X=re[U],ne=re[k],Y=ov(0,H[_],J[_]),K=S?H[_]/2-N-Y-X-D.mainAxis:V-Y-X-D.mainAxis,ee=S?-H[_]/2+N+Y+ne+D.mainAxis:M+Y+ne+D.mainAxis,ue=r.elements.arrow&&ix(r.elements.arrow),se=ue?C==="y"?ue.clientTop||0:ue.clientLeft||0:0,ce=(I=W==null?void 0:W[C])!=null?I:0,fe=R+K-ce-se,ve=R+ee-ce,_e=ov(p?g2(j,fe):j,R,p?C0(A,ve):A);O[C]=_e,P[C]=_e-R}if(c){var le,ke=C==="x"?dl:fl,Te=C==="x"?vc:xc,pe=O[L],ye=L==="y"?"height":"width",ge=pe+m[ke],De=pe-m[Te],He=[dl,fl].indexOf(b)!==-1,Xe=(le=W==null?void 0:W[L])!=null?le:0,at=He?ge:pe-H[ye]-z[ye]-Xe+D.altAxis,dt=He?pe+H[ye]+z[ye]-Xe-D.altAxis:De,wt=p&&He?zF(at,pe,dt):ov(p?at:ge,pe,p?dt:De);O[L]=wt,P[L]=wt-pe}r.modifiersData[n]=P}}const vB={name:"preventOverflow",enabled:!0,phase:"main",fn:gB,requiresIfExists:["offset"]};function xB(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function bB(e){return e===Vl(e)||!mc(e)?E6(e):xB(e)}function yB(e){var r=e.getBoundingClientRect(),t=Fm(r.width)/e.offsetWidth||1,n=Fm(r.height)/e.offsetHeight||1;return t!==1||n!==1}function wB(e,r,t){t===void 0&&(t=!1);var n=mc(r),s=mc(r)&&yB(r),o=Xf(r),i=Bm(e,s,t),c={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(n||!n&&!t)&&((Vu(r)!=="body"||T6(o))&&(c=bB(r)),mc(r)?(u=Bm(r,!0),u.x+=r.clientLeft,u.y+=r.clientTop):o&&(u.x=N6(o))),{x:i.left+c.scrollLeft-u.x,y:i.top+c.scrollTop-u.y,width:i.width,height:i.height}}function SB(e){var r=new Map,t=new Set,n=[];e.forEach(function(o){r.set(o.name,o)});function s(o){t.add(o.name);var i=[].concat(o.requires||[],o.requiresIfExists||[]);i.forEach(function(c){if(!t.has(c)){var u=r.get(c);u&&s(u)}}),n.push(o)}return e.forEach(function(o){t.has(o.name)||s(o)}),n}function _B(e){var r=SB(e);return DF.reduce(function(t,n){return t.concat(r.filter(function(s){return s.phase===n}))},[])}function AB(e){var r;return function(){return r||(r=new Promise(function(t){Promise.resolve().then(function(){r=void 0,t(e())})})),r}}function CB(e){var r=e.reduce(function(t,n){var s=t[n.name];return t[n.name]=s?Object.assign({},s,n,{options:Object.assign({},s.options,n.options),data:Object.assign({},s.data,n.data)}):n,t},{});return Object.keys(r).map(function(t){return r[t]})}var h8={placement:"bottom",modifiers:[],strategy:"absolute"};function p8(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return!r.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function jB(e){e===void 0&&(e={});var r=e,t=r.defaultModifiers,n=t===void 0?[]:t,s=r.defaultOptions,o=s===void 0?h8:s;return function(c,u,l){l===void 0&&(l=o);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},h8,o),modifiersData:{},elements:{reference:c,popper:u},attributes:{},styles:{}},h=[],f=!1,p={state:d,setOptions:function(b){var y=typeof b=="function"?b(d.options):b;g(),d.options=Object.assign({},o,d.options,y),d.scrollParents={reference:D0(c)?lv(c):c.contextElement?lv(c.contextElement):[],popper:lv(u)};var S=_B(CB([].concat(n,d.options.modifiers)));return d.orderedModifiers=S.filter(function(C){return C.enabled}),v(),p.update()},forceUpdate:function(){if(!f){var b=d.elements,y=b.reference,S=b.popper;if(p8(y,S)){d.rects={reference:wB(y,ix(S),d.options.strategy==="fixed"),popper:k6(S)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(D){return d.modifiersData[D.name]=Object.assign({},D.data)});for(var C=0;C<d.orderedModifiers.length;C++){if(d.reset===!0){d.reset=!1,C=-1;continue}var L=d.orderedModifiers[C],O=L.fn,H=L.options,z=H===void 0?{}:H,q=L.name;typeof O=="function"&&(d=O({state:d,options:z,name:q,instance:p})||d)}}}},update:AB(function(){return new Promise(function(m){p.forceUpdate(),m(d)})}),destroy:function(){g(),f=!0}};if(!p8(c,u))return p;p.setOptions(l).then(function(m){!f&&l.onFirstUpdate&&l.onFirstUpdate(m)});function v(){d.orderedModifiers.forEach(function(m){var b=m.name,y=m.options,S=y===void 0?{}:y,C=m.effect;if(typeof C=="function"){var L=C({state:d,name:b,instance:p,options:S}),O=function(){};h.push(L||O)}})}function g(){h.forEach(function(m){return m()}),h=[]}return p}}var kB=[YF,pB,KF,PF,fB,oB,vB,VF,cB],RB=jB({defaultModifiers:kB});function EB(e){return an("MuiPopper",e)}un("MuiPopper",["root"]);function NB(e,r){if(r==="ltr")return e;switch(e){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return e}}function SS(e){return typeof e=="function"?e():e}function TB(e){return e.nodeType!==void 0}const LB=e=>{const{classes:r}=e;return nn({root:["root"]},EB,r)},MB={},DB=G.forwardRef(function(r,t){const{anchorEl:n,children:s,direction:o,disablePortal:i,modifiers:c,open:u,placement:l,popperOptions:d,popperRef:h,slotProps:f={},slots:p={},TransitionProps:v,ownerState:g,...m}=r,b=G.useRef(null),y=Ni(b,t),S=G.useRef(null),C=Ni(S,h),L=G.useRef(C);Jc(()=>{L.current=C},[C]),G.useImperativeHandle(h,()=>S.current,[]);const O=NB(l,o),[H,z]=G.useState(O),[q,D]=G.useState(SS(n));G.useEffect(()=>{S.current&&S.current.forceUpdate()}),G.useEffect(()=>{n&&D(SS(n))},[n]),Jc(()=>{if(!q||!u)return;const k=j=>{z(j.placement)};let _=[{name:"preventOverflow",options:{altBoundary:i}},{name:"flip",options:{altBoundary:i}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:j})=>{k(j)}}];c!=null&&(_=_.concat(c)),d&&d.modifiers!=null&&(_=_.concat(d.modifiers));const R=RB(q,b.current,{placement:O,...d,modifiers:_});return L.current(R),()=>{R.destroy(),L.current(null)}},[q,i,c,u,d,O]);const W={placement:H};v!==null&&(W.TransitionProps=v);const P=LB(r),I=p.root??"div",U=Om({elementType:I,externalSlotProps:f.root,externalForwardedProps:m,additionalProps:{role:"tooltip",ref:y},ownerState:r,className:P.root});return a.jsx(I,{...U,children:typeof s=="function"?s(W):s})}),IB=G.forwardRef(function(r,t){const{anchorEl:n,children:s,container:o,direction:i="ltr",disablePortal:c=!1,keepMounted:u=!1,modifiers:l,open:d,placement:h="bottom",popperOptions:f=MB,popperRef:p,style:v,transition:g=!1,slotProps:m={},slots:b={},...y}=r,[S,C]=G.useState(!0),L=()=>{C(!1)},O=()=>{C(!0)};if(!u&&!d&&(!g||S))return null;let H;if(o)H=o;else if(n){const D=SS(n);H=D&&TB(D)?co(D).body:co(null).body}const z=!d&&u&&(!g||S)?"none":void 0,q=g?{in:d,onEnter:L,onExited:O}:void 0;return a.jsx(Kk,{disablePortal:c,container:H,children:a.jsx(DB,{anchorEl:n,direction:i,disablePortal:c,modifiers:l,ref:t,open:g?!S:d,placement:h,popperOptions:f,popperRef:p,slotProps:m,slots:b,...y,style:{position:"fixed",top:0,left:0,display:z,...v},TransitionProps:q,children:s})})}),OB=or(IB,{name:"MuiPopper",slot:"Root"})({}),pw=G.forwardRef(function(r,t){const n=Xm(),s=dn({props:r,name:"MuiPopper"}),{anchorEl:o,component:i,components:c,componentsProps:u,container:l,disablePortal:d,keepMounted:h,modifiers:f,open:p,placement:v,popperOptions:g,popperRef:m,transition:b,slots:y,slotProps:S,...C}=s,L=(y==null?void 0:y.root)??(c==null?void 0:c.Root),O={anchorEl:o,container:l,disablePortal:d,keepMounted:h,modifiers:f,open:p,placement:v,popperOptions:g,popperRef:m,transition:b,...C};return a.jsx(OB,{as:i,direction:n?"rtl":"ltr",slots:{root:L},slotProps:S??u,...O,ref:t})});function PB(e){return an("MuiTooltip",e)}const ei=un("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);function FB(e){return Math.round(e*1e5)/1e5}const BB=e=>{const{classes:r,disableInteractive:t,arrow:n,touch:s,placement:o}=e,i={popper:["popper",!t&&"popperInteractive",n&&"popperArrow"],tooltip:["tooltip",n&&"tooltipArrow",s&&"touch",`tooltipPlacement${yr(o.split("-")[0])}`],arrow:["arrow"]};return nn(i,PB,r)},zB=or(pw,{name:"MuiTooltip",slot:"Popper",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.popper,!t.disableInteractive&&r.popperInteractive,t.arrow&&r.popperArrow,!t.open&&r.popperClose]}})(cn(({theme:e})=>({zIndex:(e.vars||e).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:r})=>!r.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:r})=>!r,style:{pointerEvents:"none"}},{props:({ownerState:r})=>r.arrow,style:{[`&[data-popper-placement*="bottom"] .${ei.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${ei.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${ei.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${ei.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:r})=>r.arrow&&!r.isRtl,style:{[`&[data-popper-placement*="right"] .${ei.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:r})=>r.arrow&&!!r.isRtl,style:{[`&[data-popper-placement*="right"] .${ei.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:r})=>r.arrow&&!r.isRtl,style:{[`&[data-popper-placement*="left"] .${ei.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:r})=>r.arrow&&!!r.isRtl,style:{[`&[data-popper-placement*="left"] .${ei.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}))),$B=or("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.tooltip,t.touch&&r.touch,t.arrow&&r.tooltipArrow,r[`tooltipPlacement${yr(t.placement.split("-")[0])}`]]}})(cn(({theme:e})=>({backgroundColor:e.vars?e.vars.palette.Tooltip.bg:Ca(e.palette.grey[700],.92),borderRadius:(e.vars||e).shape.borderRadius,color:(e.vars||e).palette.common.white,fontFamily:e.typography.fontFamily,padding:"4px 8px",fontSize:e.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:e.typography.fontWeightMedium,[`.${ei.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${ei.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${ei.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${ei.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:r})=>r.arrow,style:{position:"relative",margin:0}},{props:({ownerState:r})=>r.touch,style:{padding:"8px 16px",fontSize:e.typography.pxToRem(14),lineHeight:`${FB(16/14)}em`,fontWeight:e.typography.fontWeightRegular}},{props:({ownerState:r})=>!r.isRtl,style:{[`.${ei.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${ei.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:r})=>!r.isRtl&&r.touch,style:{[`.${ei.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${ei.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:r})=>!!r.isRtl,style:{[`.${ei.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${ei.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:r})=>!!r.isRtl&&r.touch,style:{[`.${ei.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${ei.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:r})=>r.touch,style:{[`.${ei.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:r})=>r.touch,style:{[`.${ei.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]}))),UB=or("span",{name:"MuiTooltip",slot:"Arrow"})(cn(({theme:e})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:e.vars?e.vars.palette.Tooltip.bg:Ca(e.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let by=!1;const m8=new fw;let M1={x:0,y:0};function yy(e,r){return(t,...n)=>{r&&r(t,...n),e(t,...n)}}const bs=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiTooltip"}),{arrow:s=!1,children:o,classes:i,components:c={},componentsProps:u={},describeChild:l=!1,disableFocusListener:d=!1,disableHoverListener:h=!1,disableInteractive:f=!1,disableTouchListener:p=!1,enterDelay:v=100,enterNextDelay:g=0,enterTouchDelay:m=700,followCursor:b=!1,id:y,leaveDelay:S=0,leaveTouchDelay:C=1500,onClose:L,onOpen:O,open:H,placement:z="bottom",PopperComponent:q,PopperProps:D={},slotProps:W={},slots:P={},title:I,TransitionComponent:U,TransitionProps:k,..._}=n,R=G.isValidElement(o)?o:a.jsx("span",{children:o}),j=Kf(),A=Xm(),[N,V]=G.useState(),[M,Z]=G.useState(null),J=G.useRef(!1),re=f||b,X=b0(),ne=b0(),Y=b0(),K=b0(),[ee,ue]=A0({controlled:H,default:!1,name:"Tooltip",state:"open"});let se=ee;const ce=Od(y),fe=G.useRef(),ve=Di(()=>{fe.current!==void 0&&(document.body.style.WebkitUserSelect=fe.current,fe.current=void 0),K.clear()});G.useEffect(()=>ve,[ve]);const _e=nr=>{m8.clear(),by=!0,ue(!0),O&&!se&&O(nr)},le=Di(nr=>{m8.start(800+S,()=>{by=!1}),ue(!1),L&&se&&L(nr),X.start(j.transitions.duration.shortest,()=>{J.current=!1})}),ke=nr=>{J.current&&nr.type!=="touchstart"||(N&&N.removeAttribute("title"),ne.clear(),Y.clear(),v||by&&g?ne.start(by?g:v,()=>{_e(nr)}):_e(nr))},Te=nr=>{ne.clear(),Y.start(S,()=>{le(nr)})},[,pe]=G.useState(!1),ye=nr=>{l2(nr.target)||(pe(!1),Te(nr))},ge=nr=>{N||V(nr.currentTarget),l2(nr.target)&&(pe(!0),ke(nr))},De=nr=>{J.current=!0;const Cr=R.props;Cr.onTouchStart&&Cr.onTouchStart(nr)},He=nr=>{De(nr),Y.clear(),X.clear(),ve(),fe.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",K.start(m,()=>{document.body.style.WebkitUserSelect=fe.current,ke(nr)})},Xe=nr=>{R.props.onTouchEnd&&R.props.onTouchEnd(nr),ve(),Y.start(C,()=>{le(nr)})};G.useEffect(()=>{if(!se)return;function nr(Cr){Cr.key==="Escape"&&le(Cr)}return document.addEventListener("keydown",nr),()=>{document.removeEventListener("keydown",nr)}},[le,se]);const at=Ni(V0(R),V,t);!I&&I!==0&&(se=!1);const dt=G.useRef(),wt=nr=>{const Cr=R.props;Cr.onMouseMove&&Cr.onMouseMove(nr),M1={x:nr.clientX,y:nr.clientY},dt.current&&dt.current.update()},$t={},Bt=typeof I=="string";l?($t.title=!se&&Bt&&!h?I:null,$t["aria-describedby"]=se?ce:null):($t["aria-label"]=Bt?I:null,$t["aria-labelledby"]=se&&!Bt?ce:null);const ft={...$t,..._,...R.props,className:Pr(_.className,R.props.className),onTouchStart:De,ref:at,...b?{onMouseMove:wt}:{}},tr={};p||(ft.onTouchStart=He,ft.onTouchEnd=Xe),h||(ft.onMouseOver=yy(ke,ft.onMouseOver),ft.onMouseLeave=yy(Te,ft.onMouseLeave),re||(tr.onMouseOver=ke,tr.onMouseLeave=Te)),d||(ft.onFocus=yy(ge,ft.onFocus),ft.onBlur=yy(ye,ft.onBlur),re||(tr.onFocus=ge,tr.onBlur=ye));const Me={...n,isRtl:A,arrow:s,disableInteractive:re,placement:z,PopperComponentProp:q,touch:J.current},tt=typeof W.popper=="function"?W.popper(Me):W.popper,Ze=G.useMemo(()=>{var Cr,Dt;let nr=[{name:"arrow",enabled:!!M,options:{element:M,padding:4}}];return(Cr=D.popperOptions)!=null&&Cr.modifiers&&(nr=nr.concat(D.popperOptions.modifiers)),(Dt=tt==null?void 0:tt.popperOptions)!=null&&Dt.modifiers&&(nr=nr.concat(tt.popperOptions.modifiers)),{...D.popperOptions,...tt==null?void 0:tt.popperOptions,modifiers:nr}},[M,D.popperOptions,tt==null?void 0:tt.popperOptions]),St=BB(Me),et=typeof W.transition=="function"?W.transition(Me):W.transition,Ht={slots:{popper:c.Popper,transition:c.Transition??U,tooltip:c.Tooltip,arrow:c.Arrow,...P},slotProps:{arrow:W.arrow??u.arrow,popper:{...D,...tt??u.popper},tooltip:W.tooltip??u.tooltip,transition:{...k,...et??u.transition}}},[Nt,kt]=ln("popper",{elementType:zB,externalForwardedProps:Ht,ownerState:Me,className:Pr(St.popper,D==null?void 0:D.className)}),[kr,Jt]=ln("transition",{elementType:Nv,externalForwardedProps:Ht,ownerState:Me}),[Pt,Ur]=ln("tooltip",{elementType:$B,className:St.tooltip,externalForwardedProps:Ht,ownerState:Me}),[Lr,vt]=ln("arrow",{elementType:UB,className:St.arrow,externalForwardedProps:Ht,ownerState:Me,ref:Z});return a.jsxs(G.Fragment,{children:[G.cloneElement(R,ft),a.jsx(Nt,{as:q??pw,placement:z,anchorEl:b?{getBoundingClientRect:()=>({top:M1.y,left:M1.x,right:M1.x,bottom:M1.y,width:0,height:0})}:N,popperRef:dt,open:N?se:!1,id:ce,transition:!0,...tr,...kt,popperOptions:Ze,children:({TransitionProps:nr})=>a.jsx(kr,{timeout:j.transitions.duration.shorter,...nr,...Jt,children:a.jsxs(Pt,{...Ur,children:[I,s?a.jsx(Lr,{...vt}):null]})})})]})}),HB=Hn(a.jsx("path",{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m-9-2V7H4v3H1v2h3v3h2v-3h3v-2zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"})),l7=Hn(a.jsx("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6"})),VB=Hn(a.jsx("path",{d:"M13 3h-2v10h2zm4.83 2.17-1.42 1.42C17.99 7.86 19 9.81 19 12c0 3.87-3.13 7-7 7s-7-3.13-7-7c0-2.19 1.01-4.14 2.58-5.42L6.17 5.17C4.23 6.82 3 9.26 3 12c0 4.97 4.03 9 9 9s9-4.03 9-9c0-2.74-1.23-5.18-3.17-6.83"}));function WB(){const[e,r]=vr.useState(null),t=!!e,n=f=>{r(f.currentTarget)},s=()=>{r(null)},o=G.useContext(W_)||{isToggleSideBar:!1,setIsToggleSideBar:()=>{}},i=ii(),[c,u]=G.useState({name:"Logged In user name",role:"user role",avatar:null});G.useEffect(()=>{const f=()=>{try{const v=localStorage.getItem("userProfile");if(v){const g=JSON.parse(v);u({name:g.name||"Logged In user name",role:g.role||"user role",avatar:g.avatar||null})}}catch{}};f();const p=()=>f();return window.addEventListener("userProfileUpdated",p),window.addEventListener("storage",p),()=>{window.removeEventListener("userProfileUpdated",p),window.removeEventListener("storage",p)}},[]);const l=()=>{s(),i("/profile")},d=()=>{s(),i("/settings")},h=()=>{s(),o&&typeof o.logout=="function"?o.logout():i("/login")};return a.jsx(a.Fragment,{children:a.jsx("header",{children:a.jsx("div",{className:"container-fluid w-100 ",children:a.jsxs("div",{className:"row d-flex align-items-center",children:[a.jsx("div",{className:"col-sm-2 logo-part",children:a.jsx(_v,{to:"/",className:"d-flex align-items-center logo",children:a.jsx("span",{className:"ml-2",children:"ERP"})})}),a.jsxs("div",{className:"col-sm-2 d-flex align-items-center menu-btn-part",children:[a.jsx(Br,{className:"rounded-circle mr-3",onClick:()=>o.setIsToggleSideBar(!o.isToggleSideBar),children:o.isToggleSideBar===!1?a.jsx(YO,{}):a.jsx(ZO,{})}),a.jsx(nP,{})]}),a.jsxs("div",{className:"col-sm-8 d-flex align-items-center justify-content-end gap-2  other-btn-part",children:[a.jsx(Br,{className:"rounded-circle mr-3",children:a.jsx(aP,{})}),a.jsx(Br,{className:"rounded-circle mr-3",children:a.jsx(JO,{})}),a.jsxs(Br,{className:"my-account d-flex align-items-center",onClick:n,children:[a.jsx("div",{className:"user-image",children:a.jsx("span",{className:"rounded-circle",children:a.jsx("img",{src:c.avatar||dL.userIcon,alt:"",style:{width:36,height:36,objectFit:"cover",borderRadius:"50%"}})})}),a.jsxs("div",{className:"user-info",children:[a.jsx("h4",{children:c.name}),a.jsx("p",{children:c.role})]})]}),a.jsxs(Jk,{anchorEl:e,id:"account-menu",open:t,onClose:s,slotProps:{paper:{elevation:0,className:"account-menu-paper"}},transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},children:[a.jsxs(zl,{onClick:l,children:[a.jsx(r3,{children:a.jsx(HB,{fontSize:"small"})}),"Profile"]}),a.jsxs(zl,{onClick:d,children:[a.jsx(r3,{children:a.jsx(l7,{fontSize:"small"})}),"Settings"]}),a.jsxs(zl,{onClick:h,children:[a.jsx(r3,{children:a.jsx(VB,{fontSize:"small"})}),"Logout"]})]})]})]})})})})}function qB(e){return vn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",strokeWidth:"2",d:"M12,22 C17.5228475,22 22,17.5228475 22,12 C22,6.4771525 17.5228475,2 12,2 C6.4771525,2 2,6.4771525 2,12 C2,17.5228475 6.4771525,22 12,22 Z M15,16 C15,14.3431458 13.6568542,13 12,13 C10.3431458,13 9,14.3431458 9,16 M5,5 L7,7 M12,7 L12,13 M12,3 L12,5 M19,12 L21,12 M3,12 L5,12 M17,7 L19,5 M3,17 L21,17"},child:[]}]})(e)}function GB(e){return vn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M179.625 22.313L163.22 58.937c-3.258-.384-6.498-.604-9.72-.624-10.577-.066-20.857 1.808-30.47 5.28L99.78 31.032 55.75 63.188l24.063 33.657c-7.21 10.412-12.3 22.5-14.5 35.75l-42.72 4.687 5.345 54.25 45.468-5c5.082 10.2 12.078 19.372 20.594 26.97l-19.406 43.375 49.375 22.094 19.5-43.564c11.656 1.242 23.08.128 33.75-3l28.124 38.53 31.72-23.186 11.655 20.156C234.014 279.138 220.873 292.3 209.624 307l-49.22-28.344-25.718 46.72 48.125 27.937c-7.068 16.934-11.967 34.975-14.343 53.812H112.5v53.72h56.22c1.66 12.053 4.372 23.753 8.03 35.06h169.312c-23.915-10.758-40.562-34.788-40.562-62.717 0-37.964 30.754-68.75 68.72-68.75 37.963 0 68.75 30.786 68.75 68.75 0 27.93-16.67 51.96-40.595 62.718h91.5V200.375l-11.688-6.406L454.594 242c-16.842-7.204-34.808-12.234-53.594-14.72v-55.53h-53.72v55.47c-18.303 2.377-35.83 7.183-52.31 14.03l-27.126-47.28-36 20.25-9.25-12.97c7.08-9.223 12.43-19.93 15.5-31.72l44.437-4.843-5.342-54.25-42.25 4.157c-4.92-12.618-12.648-23.953-22.563-33.094L229 44.406l-49.375-22.093zm-27.344 84.25c23.3-.24 42.94 17.827 44.376 41.343 1.48 24.275-17.004 45.144-41.28 46.625-24.278 1.483-45.145-16.974-46.626-41.25-1.48-24.274 16.973-45.142 41.25-46.624.76-.046 1.53-.086 2.28-.094z"},child:[]}]})(e)}function D1(e){return vn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M252.3 21.12c-6.1 0-31.1 2.84-31.1 9.33.1 19.44 4.1 33.14 8.9 50.7h-30.8l8 18.42c35.2 1.93 54.5 2.43 90 .1l8-18.52h-31c5.9-16.71 7.6-35.72 8.6-50.89.4-6.89-24.5-9.14-30.6-9.14zm-26.9 97.68c-.9 4.2-1.5 8.8-1.5 13.5 0 12.4 3.8 23.6 9.3 31.1 5.5 7.6 12.3 11.4 19.4 11.4 7.1 0 13.9-3.8 19.4-11.4 5.5-7.5 9.3-18.7 9.3-31.1 0-4.7-.5-9.1-1.5-13.3-18.2.5-36.3.4-54.4-.2zm176.1 2c-4 7.4-5.8 15.7-3 22.1l19.4 29.4c15.6.2 43.3-9.3 45.9-25.6 0-10.7-12.4-16.7-19.8-20.1l-24.3 11.9zm-10.6 43.3c-19.2 13-36.2 20.6-76.6 25.3v.2c1.6 7.4 2.6 15.6 3 24.4 34-10.9 59-21.6 83.3-35.2zm-184.1 17.4c-4.5.5-8.7 1.1-12.8 2.3 6.4 30.4 25.5 63.1 53.3 87.5v-20.7c-27-19-33-43.3-40.5-69.1zm18.6 0c6.6 22.7 11 38.5 30.3 52.8 14.3-13.7 17.3-31.6 22.7-51.5-7.2 6.1-16.1 10-25.8 10-10.3 0-19.7-4.4-27.2-11.3zm69.9 7.8c-5 19.8-9.4 43.2-30 60.8v21.8c8.4-8.1 14.5-14 19.2-19.9 5.9-7.4 10.1-15 14.9-29-2-11 1-24.1-4.1-33.7zm-111.9 22c-3.9 38.6-6.8 72-6.7 98.6 4.7-4.3 10.6-7.3 17.2-8.1.9-19.6 2.8-39.3 5.5-59.1-6.5-10.1-11.9-20.7-16-31.4zm31.5 52.5c-1.5 13.9-2.6 27.7-3.1 41.4 8.3 4.5 14.5 12.8 16.8 22.6 5-12.5 7.8-25.4 11.6-38.8-9.2-7.7-17.7-16.1-25.3-25.2zm82.8.4c-7.2 8.8-15.7 16.3-27.5 28 4.3 14.9 11.1 28.6 19.6 41.7 5-25 6.5-47.1 7.9-69.7zM34.63 295l-2.48 17.8 126.95 17.6c-.4-5.8-.6-11.9-.7-18.2zm162.87 24.6c-7.3 0-14 6.7-14 16.4s6.7 16.4 14 16.4 14-6.7 14-16.4-6.7-16.4-14-16.4zm67.8 8.1v87.2h22v-53.2c-8.1-10.7-15.7-22-22-34zm-18 1.6c-4.9 13.4-11.8 27.1-23.6 40.4v45.2h23.6zm-53.9 42.8l.4 34.1c4.3 3.4 8.2 5.6 11.9 7.1v-33.6zm30.3 60.8v37.2c-6.9.7-13.8 1.6-20.8 2.8l-8 18h52.4v-58zm41.6 0v58h69.6l-10-18c-12.5-1.1-25-2.2-37.6-3v-37z"},child:[]}]})(e)}const KB=[{id:0,title:"Dashboard",path:"/home",icon:qB},{id:2,title:"Product Masters",icon:D1,submenu:[{title:"Product Master",path:"/ProductMaster"},{title:"Product Management",path:"/ManageProduct"},{title:"Category Management",path:"/ManageCategory"},{title:"Subcategory Management",path:"/ManageSubcategory"},{title:"Tag Management",path:"/ManageTag"},{title:"Store / Unit / Tax / HSN / Size",path:"/ManageUnitStoreTax"}]},{id:3,title:"Users Masters",icon:D1,submenu:[{title:"Users Management",path:"/users"},{title:"User Address",path:"/address"}]},{id:8,title:"Employee Masters",icon:D1,submenu:[{title:"Employee Management",path:"/employeemanagement"},{title:"Manage Department Head",path:"/departmentmaster"},{title:"Assign Employee to Head",path:"/designation"},{title:"Assign User to Employee",path:"/assignusertoemployee"}]},{id:6,title:"CRM Masters",icon:D1,submenu:[{title:"CRM",path:"/crm-master"},{title:"Account",path:"/account"},{title:"Quotation",path:"/quotation"},{title:"Quotation List",path:"/quotation-list"},{title:"Terms & Conditions  Management",path:"/Managetandc"}]},{id:7,title:"Admin",icon:D1,submenu:[{title:"Role Creation",path:"/rolecreation"},{title:"Role Management",path:"/existingroles"},{title:"Role Mapping",path:"/rolemanagement"},{title:"Menu Creation",path:"/menucreation"},{title:"Menu Management",path:"/existingmenus"},{title:"User Mapping",path:"/usermanagement"},{title:"Audit Logs",path:"/auditlogs"}]},{id:4,title:"Setup",icon:q5,submenu:[{title:"Company/Firm Master",path:"/ManageCompany"},{title:"Branch",path:"/ManageBranch"},{title:"Bank",path:"/ManageBank"},{title:"Series",path:"/ManageSeries"}]},{id:5,title:"Reports",icon:q5,submenu:[{title:"reports",path:"/erpreport"}]}],XB=()=>{const[e,r]=G.useState(0),t=n=>{r(s=>s===n?null:n)};return G.useContext(W_),a.jsx("div",{className:"sidebar",children:a.jsx("ul",{children:KB.map(n=>{const s=n.icon||(()=>null);return a.jsx("li",{children:n.submenu?a.jsxs(a.Fragment,{children:[a.jsxs(Br,{className:`w-100 ${e===n.id?"active":""}`,onClick:()=>t(n.id),children:[a.jsx("span",{className:"icon",children:a.jsx(s,{})}),n.title,a.jsx("span",{className:"arrow-right",children:e===n.id?a.jsx(KO,{}):a.jsx(W5,{})})]}),a.jsx("div",{className:`sub-menu-wraper ${e===n.id?"colapse":"colapsed"}`,children:a.jsx("ul",{className:"submenu",children:n.submenu.map((o,i)=>a.jsx("li",{children:a.jsx(_v,{to:o.path,children:o.title})},i))})})]}):a.jsx(_v,{to:n.path,children:a.jsxs(Br,{className:`w-100 ${e===n.id?"active":""}`,onClick:()=>r(n.id),children:[a.jsx("span",{className:"icon",children:a.jsx(s,{})}),n.title,a.jsx("span",{className:"arrow-right",children:a.jsx(W5,{})})]})})},n.id)})})})};function YB(){return a.jsx("div",{children:a.jsx("section",{className:"right-content",children:a.jsx("h1",{children:"Dashboard"})})})}function ZB(e){return vn({attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-600 72h560v208H232V136zm560 480H232V408h560v208zm0 272H232V680h560v208zM304 240a40 40 0 1 0 80 0 40 40 0 1 0-80 0zm0 272a40 40 0 1 0 80 0 40 40 0 1 0-80 0zm0 272a40 40 0 1 0 80 0 40 40 0 1 0-80 0z"},child:[]}]})(e)}function JB(e){return vn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"},child:[]}]})(e)}function c7(e){return vn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M413.1 222.5l22.2 22.2c9.4 9.4 9.4 24.6 0 33.9L241 473c-9.4 9.4-24.6 9.4-33.9 0L12.7 278.6c-9.4-9.4-9.4-24.6 0-33.9l22.2-22.2c9.5-9.5 25-9.3 34.3.4L184 343.4V56c0-13.3 10.7-24 24-24h32c13.3 0 24 10.7 24 24v287.4l114.8-120.5c9.3-9.8 24.8-10 34.3-.4z"},child:[]}]})(e)}function u7(e){return vn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"},child:[]}]})(e)}function d7(e){return vn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6 0-33.9L207 39c9.4-9.4 24.6-9.4 33.9 0l194.3 194.3c9.4 9.4 9.4 24.6 0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"},child:[]}]})(e)}function QB(e){return vn({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M256 336h-.02c0-16.18 1.34-8.73-85.05-181.51-17.65-35.29-68.19-35.36-85.87 0C-2.06 328.75.02 320.33.02 336H0c0 44.18 57.31 80 128 80s128-35.82 128-80zM128 176l72 144H56l72-144zm511.98 160c0-16.18 1.34-8.73-85.05-181.51-17.65-35.29-68.19-35.36-85.87 0-87.12 174.26-85.04 165.84-85.04 181.51H384c0 44.18 57.31 80 128 80s128-35.82 128-80h-.02zM440 320l72-144 72 144H440zm88 128H352V153.25c23.51-10.29 41.16-31.48 46.39-57.25H528c8.84 0 16-7.16 16-16V48c0-8.84-7.16-16-16-16H383.64C369.04 12.68 346.09 0 320 0s-49.04 12.68-63.64 32H112c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h129.61c5.23 25.76 22.87 46.96 46.39 57.25V448H112c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h416c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16z"},child:[]}]})(e)}function f7(e){return vn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"},child:[]}]})(e)}function ez(e){return vn({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M560 288h-80v96l-32-21.3-32 21.3v-96h-80c-8.8 0-16 7.2-16 16v192c0 8.8 7.2 16 16 16h224c8.8 0 16-7.2 16-16V304c0-8.8-7.2-16-16-16zm-384-64h224c8.8 0 16-7.2 16-16V16c0-8.8-7.2-16-16-16h-80v96l-32-21.3L256 96V0h-80c-8.8 0-16 7.2-16 16v192c0 8.8 7.2 16 16 16zm64 64h-80v96l-32-21.3L96 384v-96H16c-8.8 0-16 7.2-16 16v192c0 8.8 7.2 16 16 16h224c8.8 0 16-7.2 16-16V304c0-8.8-7.2-16-16-16z"},child:[]}]})(e)}function tz(e){return vn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M436 160H12c-6.627 0-12-5.373-12-12v-36c0-26.51 21.49-48 48-48h48V12c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v52h128V12c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v52h48c26.51 0 48 21.49 48 48v36c0 6.627-5.373 12-12 12zM12 192h424c6.627 0 12 5.373 12 12v260c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V204c0-6.627 5.373-12 12-12zm333.296 95.947l-28.169-28.398c-4.667-4.705-12.265-4.736-16.97-.068L194.12 364.665l-45.98-46.352c-4.667-4.705-12.266-4.736-16.971-.068l-28.397 28.17c-4.705 4.667-4.736 12.265-.068 16.97l82.601 83.269c4.667 4.705 12.265 4.736 16.97.068l142.953-141.805c4.705-4.667 4.736-12.265.068-16.97z"},child:[]}]})(e)}function L6(e){return vn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M332.8 320h38.4c6.4 0 12.8-6.4 12.8-12.8V172.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v134.4c0 6.4 6.4 12.8 12.8 12.8zm96 0h38.4c6.4 0 12.8-6.4 12.8-12.8V76.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v230.4c0 6.4 6.4 12.8 12.8 12.8zm-288 0h38.4c6.4 0 12.8-6.4 12.8-12.8v-70.4c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v70.4c0 6.4 6.4 12.8 12.8 12.8zm96 0h38.4c6.4 0 12.8-6.4 12.8-12.8V108.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v198.4c0 6.4 6.4 12.8 12.8 12.8zM496 384H64V80c0-8.84-7.16-16-16-16H16C7.16 64 0 71.16 0 80v336c0 17.67 14.33 32 32 32h464c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16z"},child:[]}]})(e)}function h7(e){return vn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M496 384H64V80c0-8.84-7.16-16-16-16H16C7.16 64 0 71.16 0 80v336c0 17.67 14.33 32 32 32h464c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16zM464 96H345.94c-21.38 0-32.09 25.85-16.97 40.97l32.4 32.4L288 242.75l-73.37-73.37c-12.5-12.5-32.76-12.5-45.25 0l-68.69 68.69c-6.25 6.25-6.25 16.38 0 22.63l22.62 22.62c6.25 6.25 16.38 6.25 22.63 0L192 237.25l73.37 73.37c12.5 12.5 32.76 12.5 45.25 0l96-96 32.4 32.4c15.12 15.12 40.97 4.41 40.97-16.97V112c.01-8.84-7.15-16-15.99-16z"},child:[]}]})(e)}function j0(e){return vn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"},child:[]}]})(e)}function g8(e){return vn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"},child:[]}]})(e)}function rz(e){return vn({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM96 424c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm96-192c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm128 368c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16z"},child:[]}]})(e)}function v8(e){return vn({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M537.6 226.6c4.1-10.7 6.4-22.4 6.4-34.6 0-53-43-96-96-96-19.7 0-38.1 6-53.3 16.2C367 64.2 315.3 32 256 32c-88.4 0-160 71.6-160 160 0 2.7.1 5.4.2 8.1C40.2 219.8 0 273.2 0 336c0 79.5 64.5 144 144 144h368c70.7 0 128-57.3 128-128 0-61.9-44-113.6-102.4-125.4z"},child:[]}]})(e)}function v2(e){return vn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(e)}function nz(e){return vn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(e)}function Yf(e){return vn({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(e)}function az(e){return vn({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm64 236c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-64c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-72v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm96-114.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"},child:[]}]})(e)}function sz(e){return vn({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm60.1 106.5L224 336l60.1 93.5c5.1 8-.6 18.5-10.1 18.5h-34.9c-4.4 0-8.5-2.4-10.6-6.3C208.9 405.5 192 373 192 373c-6.4 14.8-10 20-36.6 68.8-2.1 3.9-6.1 6.3-10.5 6.3H110c-9.5 0-15.2-10.5-10.1-18.5l60.3-93.5-60.3-93.5c-5.2-8 .6-18.5 10.1-18.5h34.8c4.4 0 8.5 2.4 10.6 6.3 26.1 48.8 20 33.6 36.6 68.5 0 0 6.1-11.7 36.6-68.5 2.1-3.9 6.2-6.3 10.6-6.3H274c9.5-.1 15.2 10.4 10.1 18.4zM384 121.9v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"},child:[]}]})(e)}function p7(e){return vn({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M384 121.9c0-6.3-2.5-12.4-7-16.9L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128zM571 308l-95.7-96.4c-10.1-10.1-27.4-3-27.4 11.3V288h-64v64h64v65.2c0 14.3 17.3 21.4 27.4 11.3L571 332c6.6-6.6 6.6-17.4 0-24zm-379 28v-32c0-8.8 7.2-16 16-16h176V160H248c-13.2 0-24-10.8-24-24V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V352H208c-8.8 0-16-7.2-16-16z"},child:[]}]})(e)}function iz(e){return vn({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-153 31V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zM64 72c0-4.42 3.58-8 8-8h80c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8H72c-4.42 0-8-3.58-8-8V72zm0 80v-16c0-4.42 3.58-8 8-8h80c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8H72c-4.42 0-8-3.58-8-8zm144 263.88V440c0 4.42-3.58 8-8 8h-16c-4.42 0-8-3.58-8-8v-24.29c-11.29-.58-22.27-4.52-31.37-11.35-3.9-2.93-4.1-8.77-.57-12.14l11.75-11.21c2.77-2.64 6.89-2.76 10.13-.73 3.87 2.42 8.26 3.72 12.82 3.72h28.11c6.5 0 11.8-5.92 11.8-13.19 0-5.95-3.61-11.19-8.77-12.73l-45-13.5c-18.59-5.58-31.58-23.42-31.58-43.39 0-24.52 19.05-44.44 42.67-45.07V232c0-4.42 3.58-8 8-8h16c4.42 0 8 3.58 8 8v24.29c11.29.58 22.27 4.51 31.37 11.35 3.9 2.93 4.1 8.77.57 12.14l-11.75 11.21c-2.77 2.64-6.89 2.76-10.13.73-3.87-2.43-8.26-3.72-12.82-3.72h-28.11c-6.5 0-11.8 5.92-11.8 13.19 0 5.95 3.61 11.19 8.77 12.73l45 13.5c18.59 5.58 31.58 23.42 31.58 43.39 0 24.53-19.05 44.44-42.67 45.07z"},child:[]}]})(e)}function oz(e){return vn({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M288 256H96v64h192v-64zm89-151L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-153 31V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zM64 72c0-4.42 3.58-8 8-8h80c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8H72c-4.42 0-8-3.58-8-8V72zm0 64c0-4.42 3.58-8 8-8h80c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8H72c-4.42 0-8-3.58-8-8v-16zm256 304c0 4.42-3.58 8-8 8h-80c-4.42 0-8-3.58-8-8v-16c0-4.42 3.58-8 8-8h80c4.42 0 8 3.58 8 8v16zm0-200v96c0 8.84-7.16 16-16 16H80c-8.84 0-16-7.16-16-16v-96c0-8.84 7.16-16 16-16h224c8.84 0 16 7.16 16 16z"},child:[]}]})(e)}function lz(e){return vn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.976 0H24.028C2.71 0-8.047 25.866 7.058 40.971L192 225.941V432c0 7.831 3.821 15.17 10.237 19.662l80 55.98C298.02 518.69 320 507.493 320 487.98V225.941l184.947-184.97C520.021 25.896 509.338 0 487.976 0z"},child:[]}]})(e)}function g0(e){return vn({attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M336.5 160C322 70.7 287.8 8 248 8s-74 62.7-88.5 152h177zM152 256c0 22.2 1.2 43.5 3.3 64h185.3c2.1-20.5 3.3-41.8 3.3-64s-1.2-43.5-3.3-64H155.3c-2.1 20.5-3.3 41.8-3.3 64zm324.7-96c-28.6-67.9-86.5-120.4-158-141.6 24.4 33.8 41.2 84.7 50 141.6h108zM177.2 18.4C105.8 39.6 47.8 92.1 19.3 160h108c8.7-56.9 25.5-107.8 49.9-141.6zM487.4 192H372.7c2.1 21 3.3 42.5 3.3 64s-1.2 43-3.3 64h114.6c5.5-20.5 8.6-41.8 8.6-64s-3.1-43.5-8.5-64zM120 256c0-21.5 1.2-43 3.3-64H8.6C3.2 212.5 0 233.8 0 256s3.2 43.5 8.6 64h114.6c-2-21-3.2-42.5-3.2-64zm39.5 96c14.5 89.3 48.7 152 88.5 152s74-62.7 88.5-152h-177zm159.3 141.6c71.4-21.2 129.4-73.7 158-141.6h-108c-8.8 56.9-25.6 107.8-50 141.6zM19.3 352c28.6 67.9 86.5 120.4 158 141.6-24.4-33.8-41.2-84.7-50-141.6h-108z"},child:[]}]})(e)}function cz(e){return vn({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M434.7 64h-85.9c-8 0-15.7 3-21.6 8.4l-98.3 90c-.1.1-.2.3-.3.4-16.6 15.6-16.3 40.5-2.1 56 12.7 13.9 39.4 17.6 56.1 2.7.1-.1.3-.1.4-.2l79.9-73.2c6.5-5.9 16.7-5.5 22.6 1 6 6.5 5.5 16.6-1 22.6l-26.1 23.9L504 313.8c2.9 2.4 5.5 5 7.9 7.7V128l-54.6-54.6c-5.9-6-14.1-9.4-22.6-9.4zM544 128.2v223.9c0 17.7 14.3 32 32 32h64V128.2h-96zm48 223.9c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zM0 384h64c17.7 0 32-14.3 32-32V128.2H0V384zm48-63.9c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16c0-8.9 7.2-16 16-16zm435.9 18.6L334.6 217.5l-30 27.5c-29.7 27.1-75.2 24.5-101.7-4.4-26.9-29.4-24.8-74.9 4.4-101.7L289.1 64h-83.8c-8.5 0-16.6 3.4-22.6 9.4L128 128v223.9h18.3l90.5 81.9c27.4 22.3 67.7 18.1 90-9.3l.2-.2 17.9 15.5c15.9 13 39.4 10.5 52.3-5.4l31.4-38.6 5.4 4.4c13.7 11.1 33.9 9.1 45-4.7l9.5-11.7c11.2-13.8 9.1-33.9-4.6-45.1z"},child:[]}]})(e)}function uz(e){return vn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M134.059 296H436c6.627 0 12-5.373 12-12v-56c0-6.627-5.373-12-12-12H134.059v-46.059c0-21.382-25.851-32.09-40.971-16.971L7.029 239.029c-9.373 9.373-9.373 24.569 0 33.941l86.059 86.059c15.119 15.119 40.971 4.411 40.971-16.971V296z"},child:[]}]})(e)}function dz(e){return vn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3 0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9 0l60.1 60.1c18.8 18.7 18.8 49.1 0 67.9zM284.2 99.8L21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3 0-17l-111-111c-4.8-4.7-12.4-4.7-17.1 0zM124.1 339.9c-5.5-5.5-5.5-14.3 0-19.8l154-154c5.5-5.5 14.3-5.5 19.8 0s5.5 14.3 0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8 0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"},child:[]}]})(e)}function fz(e){return vn({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M358.4 3.2L320 48 265.6 3.2a15.9 15.9 0 0 0-19.2 0L192 48 137.6 3.2a15.9 15.9 0 0 0-19.2 0L64 48 25.6 3.2C15-4.7 0 2.8 0 16v480c0 13.2 15 20.7 25.6 12.8L64 464l54.4 44.8a15.9 15.9 0 0 0 19.2 0L192 464l54.4 44.8a15.9 15.9 0 0 0 19.2 0L320 464l38.4 44.8c10.5 7.9 25.6.4 25.6-12.8V16c0-13.2-15-20.7-25.6-12.8zM320 360c0 4.4-3.6 8-8 8H72c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h240c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H72c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h240c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H72c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h240c4.4 0 8 3.6 8 8v16z"},child:[]}]})(e)}function hz(e){return vn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M416 320h-96c-17.6 0-32-14.4-32-32s14.4-32 32-32h96s96-107 96-160-43-96-96-96-96 43-96 96c0 25.5 22.2 63.4 45.3 96H320c-52.9 0-96 43.1-96 96s43.1 96 96 96h96c17.6 0 32 14.4 32 32s-14.4 32-32 32H185.5c-16 24.8-33.8 47.7-47.3 64H416c52.9 0 96-43.1 96-96s-43.1-96-96-96zm0-256c17.7 0 32 14.3 32 32s-14.3 32-32 32-32-14.3-32-32 14.3-32 32-32zM96 256c-53 0-96 43-96 96s96 160 96 160 96-107 96-160-43-96-96-96zm0 128c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"},child:[]}]})(e)}function M6(e){return vn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(e)}function x8(e){return vn({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M528.12 301.319l47.273-208C578.806 78.301 567.391 64 551.99 64H159.208l-9.166-44.81C147.758 8.021 137.93 0 126.529 0H24C10.745 0 0 10.745 0 24v16c0 13.255 10.745 24 24 24h69.883l70.248 343.435C147.325 417.1 136 435.222 136 456c0 30.928 25.072 56 56 56s56-25.072 56-56c0-15.674-6.447-29.835-16.824-40h209.647C430.447 426.165 424 440.326 424 456c0 30.928 25.072 56 56 56s56-25.072 56-56c0-22.172-12.888-41.332-31.579-50.405l5.517-24.276c3.413-15.018-8.002-29.319-23.403-29.319H218.117l-6.545-32h293.145c11.206 0 20.92-7.754 23.403-18.681z"},child:[]}]})(e)}function b8(e){return vn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"},child:[]}]})(e)}function m7(e){return vn({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"},child:[]}]})(e)}function pz(e){return vn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M149.333 56v80c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V56c0-13.255 10.745-24 24-24h101.333c13.255 0 24 10.745 24 24zm181.334 240v-80c0-13.255-10.745-24-24-24H205.333c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24h101.333c13.256 0 24.001-10.745 24.001-24zm32-240v80c0 13.255 10.745 24 24 24H488c13.255 0 24-10.745 24-24V56c0-13.255-10.745-24-24-24H386.667c-13.255 0-24 10.745-24 24zm-32 80V56c0-13.255-10.745-24-24-24H205.333c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24h101.333c13.256 0 24.001-10.745 24.001-24zm-205.334 56H24c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24h101.333c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24zM0 376v80c0 13.255 10.745 24 24 24h101.333c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H24c-13.255 0-24 10.745-24 24zm386.667-56H488c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H386.667c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24zm0 160H488c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H386.667c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24zM181.333 376v80c0 13.255 10.745 24 24 24h101.333c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H205.333c-13.255 0-24 10.745-24 24z"},child:[]}]})(e)}function Zf(e){return vn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(e)}function mz(e){return vn({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M496 224c-79.6 0-144 64.4-144 144s64.4 144 144 144 144-64.4 144-144-64.4-144-144-144zm64 150.3c0 5.3-4.4 9.7-9.7 9.7h-60.6c-5.3 0-9.7-4.4-9.7-9.7v-76.6c0-5.3 4.4-9.7 9.7-9.7h12.6c5.3 0 9.7 4.4 9.7 9.7V352h38.3c5.3 0 9.7 4.4 9.7 9.7v12.6zM320 368c0-27.8 6.7-54.1 18.2-77.5-8-1.5-16.2-2.5-24.6-2.5h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h347.1c-45.3-31.9-75.1-84.5-75.1-144zm-96-112c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128z"},child:[]}]})(e)}function gz(e){return vn({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M610.5 341.3c2.6-14.1 2.6-28.5 0-42.6l25.8-14.9c3-1.7 4.3-5.2 3.3-8.5-6.7-21.6-18.2-41.2-33.2-57.4-2.3-2.5-6-3.1-9-1.4l-25.8 14.9c-10.9-9.3-23.4-16.5-36.9-21.3v-29.8c0-3.4-2.4-6.4-5.7-7.1-22.3-5-45-4.8-66.2 0-3.3.7-5.7 3.7-5.7 7.1v29.8c-13.5 4.8-26 12-36.9 21.3l-25.8-14.9c-2.9-1.7-6.7-1.1-9 1.4-15 16.2-26.5 35.8-33.2 57.4-1 3.3.4 6.8 3.3 8.5l25.8 14.9c-2.6 14.1-2.6 28.5 0 42.6l-25.8 14.9c-3 1.7-4.3 5.2-3.3 8.5 6.7 21.6 18.2 41.1 33.2 57.4 2.3 2.5 6 3.1 9 1.4l25.8-14.9c10.9 9.3 23.4 16.5 36.9 21.3v29.8c0 3.4 2.4 6.4 5.7 7.1 22.3 5 45 4.8 66.2 0 3.3-.7 5.7-3.7 5.7-7.1v-29.8c13.5-4.8 26-12 36.9-21.3l25.8 14.9c2.9 1.7 6.7 1.1 9-1.4 15-16.2 26.5-35.8 33.2-57.4 1-3.3-.4-6.8-3.3-8.5l-25.8-14.9zM496 368.5c-26.8 0-48.5-21.8-48.5-48.5s21.8-48.5 48.5-48.5 48.5 21.8 48.5 48.5-21.7 48.5-48.5 48.5zM96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm224 32c1.9 0 3.7-.5 5.6-.6 8.3-21.7 20.5-42.1 36.3-59.2 7.4-8 17.9-12.6 28.9-12.6 6.9 0 13.7 1.8 19.6 5.3l7.9 4.6c.8-.5 1.6-.9 2.4-1.4 7-14.6 11.2-30.8 11.2-48 0-61.9-50.1-112-112-112S208 82.1 208 144c0 61.9 50.1 112 112 112zm105.2 194.5c-2.3-1.2-4.6-2.6-6.8-3.9-8.2 4.8-15.3 9.8-27.5 9.8-10.9 0-21.4-4.6-28.9-12.6-18.3-19.8-32.3-43.9-40.2-69.6-10.7-34.5 24.9-49.7 25.8-50.3-.1-2.6-.1-5.2 0-7.8l-7.9-4.6c-3.8-2.2-7-5-9.8-8.1-3.3.2-6.5.6-9.8.6-24.6 0-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h255.4c-3.7-6-6.2-12.8-6.2-20.3v-9.2zM173.1 274.6C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(e)}function vz(e){return vn({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(e)}function xz(e){return vn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M507.73 109.1c-2.24-9.03-13.54-12.09-20.12-5.51l-74.36 74.36-67.88-11.31-11.31-67.88 74.36-74.36c6.62-6.62 3.43-17.9-5.66-20.16-47.38-11.74-99.55.91-136.58 37.93-39.64 39.64-50.55 97.1-34.05 147.2L18.74 402.76c-24.99 24.99-24.99 65.51 0 90.5 24.99 24.99 65.51 24.99 90.5 0l213.21-213.21c50.12 16.71 107.47 5.68 147.37-34.22 37.07-37.07 49.7-89.32 37.91-136.73zM64 472c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24z"},child:[]}]})(e)}function bz(e){return vn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"20",x2:"18",y2:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"20",x2:"12",y2:"4"},child:[]},{tag:"line",attr:{x1:"6",y1:"20",x2:"6",y2:"14"},child:[]}]})(e)}function yz(e){return an("MuiSkeleton",e)}un("MuiSkeleton",["root","text","rectangular","rounded","circular","pulse","wave","withChildren","fitContent","heightAuto"]);const wz=e=>{const{classes:r,variant:t,animation:n,hasChildren:s,width:o,height:i}=e;return nn({root:["root",t,n,s&&"withChildren",s&&!o&&"fitContent",s&&!i&&"heightAuto"]},yz,r)},_S=Gf`
  0% {
    opacity: 1;
  }

  50% {
    opacity: 0.4;
  }

  100% {
    opacity: 1;
  }
`,AS=Gf`
  0% {
    transform: translateX(-100%);
  }

  50% {
    /* +0.5s of delay between each loop */
    transform: translateX(100%);
  }

  100% {
    transform: translateX(100%);
  }
`,Sz=typeof _S!="string"?H0`
        animation: ${_S} 2s ease-in-out 0.5s infinite;
      `:null,_z=typeof AS!="string"?H0`
        &::after {
          animation: ${AS} 2s linear 0.5s infinite;
        }
      `:null,Az=or("span",{name:"MuiSkeleton",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,r[t.variant],t.animation!==!1&&r[t.animation],t.hasChildren&&r.withChildren,t.hasChildren&&!t.width&&r.fitContent,t.hasChildren&&!t.height&&r.heightAuto]}})(cn(({theme:e})=>{const r=sP(e.shape.borderRadius)||"px",t=iP(e.shape.borderRadius);return{display:"block",backgroundColor:e.vars?e.vars.palette.Skeleton.bg:Ca(e.palette.text.primary,e.palette.mode==="light"?.11:.13),height:"1.2em",variants:[{props:{variant:"text"},style:{marginTop:0,marginBottom:0,height:"auto",transformOrigin:"0 55%",transform:"scale(1, 0.60)",borderRadius:`${t}${r}/${Math.round(t/.6*10)/10}${r}`,"&:empty:before":{content:'"\\00a0"'}}},{props:{variant:"circular"},style:{borderRadius:"50%"}},{props:{variant:"rounded"},style:{borderRadius:(e.vars||e).shape.borderRadius}},{props:({ownerState:n})=>n.hasChildren,style:{"& > *":{visibility:"hidden"}}},{props:({ownerState:n})=>n.hasChildren&&!n.width,style:{maxWidth:"fit-content"}},{props:({ownerState:n})=>n.hasChildren&&!n.height,style:{height:"auto"}},{props:{animation:"pulse"},style:Sz||{animation:`${_S} 2s ease-in-out 0.5s infinite`}},{props:{animation:"wave"},style:{position:"relative",overflow:"hidden",WebkitMaskImage:"-webkit-radial-gradient(white, black)","&::after":{background:`linear-gradient(
                90deg,
                transparent,
                ${(e.vars||e).palette.action.hover},
                transparent
              )`,content:'""',position:"absolute",transform:"translateX(-100%)",bottom:0,left:0,right:0,top:0}}},{props:{animation:"wave"},style:_z||{"&::after":{animation:`${AS} 2s linear 0.5s infinite`}}}]}})),Cz=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiSkeleton"}),{animation:s="pulse",className:o,component:i="span",height:c,style:u,variant:l="text",width:d,...h}=n,f={...n,animation:s,component:i,variant:l,hasChildren:!!h.children},p=wz(f);return a.jsx(Az,{as:i,ref:t,className:Pr(p.root,o),ownerState:f,...h,style:{width:d,height:c,...u}})}),Je="http://localhost:8000";function y8(){const[e,r]=G.useState({email:"",password:""}),[t,n]=G.useState(!1),[s,o]=G.useState(""),i=ii(),c=d=>{const{name:h,value:f}=d.target;r(p=>({...p,[h]:f}))},u=async d=>{d.preventDefault(),n(!0),o("");try{if(!e.email||!e.password)throw new Error("Please fill in all fields");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email))throw new Error("Please enter a valid email address");const h=await fetch(`${Je}/api/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),f=await h.json();if(!h.ok)throw new Error(f.message||"Login failed");localStorage.setItem("token",f.token),localStorage.setItem("isAuthenticated","true"),i("/dashboard")}catch(h){n(!1),o(h.message||"Login failed. Please try again.")}finally{n(!1)}},l=()=>{r({email:"",password:""}),o("")};return a.jsxs("div",{className:"login-page",children:[a.jsx("div",{className:"left-panel",children:a.jsxs("div",{className:"marketing-wrap",children:[a.jsx("h1",{className:"app-title",children:"Enterprise Resource Planning"}),a.jsx("p",{className:"app-sub",children:"Streamline your business operations with our comprehensive ERP solution"}),a.jsxs("ul",{className:"features-list",children:[a.jsxs("li",{children:[a.jsx("span",{className:"feature-icon",children:a.jsx(ZB,{})}),a.jsxs("div",{children:[a.jsx("h4",{children:"Centralized Data Management"}),a.jsx("p",{children:"All your business data in one secure location"})]})]}),a.jsxs("li",{children:[a.jsx("span",{className:"feature-icon",children:a.jsx(vz,{})}),a.jsxs("div",{children:[a.jsx("h4",{children:"Human Resources"}),a.jsx("p",{children:"Efficient employee management and payroll processing"})]})]}),a.jsxs("li",{children:[a.jsx("span",{className:"feature-icon",children:a.jsx(bz,{})}),a.jsxs("div",{children:[a.jsx("h4",{children:"Real-time Analytics"}),a.jsx("p",{children:"Make data-driven decisions with powerful insights"})]})]}),a.jsxs("li",{children:[a.jsx("span",{className:"feature-icon",children:a.jsx(GB,{})}),a.jsxs("div",{children:[a.jsx("h4",{children:"Process Automation"}),a.jsx("p",{children:"Automate routine tasks and improve efficiency"})]})]})]})]})}),a.jsx("div",{className:"right-panel",children:a.jsxs("div",{className:"login-card",children:[a.jsxs("div",{className:"login-header",children:[a.jsx("h2",{children:"Welcome Back"}),a.jsx("p",{children:"Please enter your credentials to login"})]}),s&&a.jsx("div",{className:"error-message",children:s}),a.jsxs("form",{onSubmit:u,className:"login-form",children:[a.jsx("label",{className:"label",children:"Email Address"}),a.jsxs("div",{className:"input-with-icon",children:[a.jsx(tP,{className:"input-icon"}),a.jsx("input",{type:"email",placeholder:"Enter your email",name:"email",value:e.email,onChange:c,required:!0})]}),a.jsx("label",{className:"label",children:"Password"}),a.jsxs("div",{className:"input-with-icon",children:[a.jsx(eP,{className:"input-icon"}),a.jsx("input",{type:"password",placeholder:"Enter your password",name:"password",value:e.password,onChange:c,required:!0})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx(Br,{variant:"contained",color:"primary",type:"submit",disabled:t,className:"btn-login",children:t?a.jsxs(a.Fragment,{children:[a.jsx(Cz,{variant:"circular",width:14,height:14}),a.jsx("span",{className:"ml-8",children:" Logging in..."})]}):a.jsx("span",{children:"Login"})}),a.jsxs(Br,{variant:"outlined",color:"secondary",onClick:l,className:"btn-reset",children:[a.jsx("span",{className:"icon",children:a.jsx(XO,{})}),"Reset"]})]}),a.jsxs("div",{className:"login-footer",children:[a.jsxs("p",{children:["Don't have an account? ",a.jsx("a",{href:"/register",children:"Sign up"})]}),a.jsx("p",{children:a.jsx("a",{href:"/forgot-password",children:"Forgot password?"})})]})]})]})})]})}const jz=Hn(a.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"})),kz=Hn(a.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"})),I1=Hn(a.jsx("path",{d:"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8z"})),W0=Hn(a.jsx("path",{d:"m7 10 5 5 5-5z"})),q0=Hn(a.jsx("path",{d:"m7 14 5-5 5 5z"})),O1=Hn(a.jsx("path",{d:"m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z"})),Rz=Hn(a.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"})),Ez=Hn(a.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),ql=Hn(a.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})),Nz=Hn(a.jsx("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"})),bl=Hn(a.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"})),Tz=Hn(a.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"})),Lz=Hn(a.jsx("path",{d:"M19 9h-4V3H9v6H5l7 7zM5 18v2h14v-2z"})),g7=Hn(a.jsx("path",{d:"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"})),D6=Hn(a.jsx("path",{d:"M19 9h-4V3H9v6H5l7 7zM5 18v2h14v-2z"})),Mz=Hn(a.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"})),w8=Hn(a.jsx("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 4-8 5-8-5V6l8 5 8-5z"})),Dz=Hn(a.jsx("path",{d:"M5 4v2h14V4zm0 10h4v6h6v-6h4l-7-7z"})),Iz=Hn(a.jsx("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"})),Oz=Hn(a.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"})),Pz=Hn(a.jsx("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})),v7=Hn(a.jsx("path",{d:"M19 7H9c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2m0 2v2H9V9zm-6 6v-2h2v2zm2 2v2h-2v-2zm-4-2H9v-2h2zm6-2h2v2h-2zm-8 4h2v2H9zm8 2v-2h2v2zM6 17H5c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2v1h-2V5H5v10h1z"})),Fz=Hn(a.jsx("path",{d:"M14.67 5v14H9.33V5zm1 14H21V5h-5.33zm-7.34 0V5H3v14z"})),cv=Hn(a.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"})),Bz=Hn(a.jsx("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"})),S8=Hn(a.jsx("path",{d:"M16.75 13.96c.25.13.41.2.46.3.06.11.04.61-.21 1.18-.2.56-1.24 1.1-1.7 1.12-.46.02-.47.36-2.96-.73-2.49-1.09-3.99-3.75-4.11-3.92-.12-.17-.96-1.38-.92-2.61.05-1.22.69-1.8.95-2.04.24-.26.51-.29.68-.26h.47c.15 0 .36-.06.55.45l.69 1.87c.06.13.1.28.01.44l-.27.41-.39.42c-.12.12-.26.25-.12.5.12.26.62 1.09 1.32 1.78.91.88 1.71 1.17 1.95 1.3.24.14.39.12.54-.04l.81-.94c.19-.25.35-.19.58-.11l1.67.88M12 2a10 10 0 0 1 10 10 10 10 0 0 1-10 10c-1.97 0-3.8-.57-5.35-1.55L2 22l1.55-4.65A9.969 9.969 0 0 1 2 12 10 10 0 0 1 12 2m0 2a8 8 0 0 0-8 8c0 1.72.54 3.31 1.46 4.61L4.5 19.5l2.89-.96A7.95 7.95 0 0 0 12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8z"}));function zz(){return a.jsx("div",{children:"NotFoundPage"})}function $z(){var h;const[e,r]=G.useState({name:"John Doe",email:"john.doe@example.com",role:"Administrator",phone:"",dob:"",gender:"",address:"",city:"",state:"",postalCode:"",country:"",department:"",employeeId:"",bio:""}),[t,n]=G.useState(!1),[s,o]=G.useState(!1),[i,c]=G.useState(!1),u=f=>{const{name:p,value:v}=f.target;r(g=>({...g,[p]:v}))},l=()=>{console.log("Save button clicked"),c(!0),setTimeout(()=>{console.log("Save operation completed"),n(!1),o(!0),c(!1)},1e3)};G.useEffect(()=>{if(s)try{const f={name:e.name,email:e.email,role:e.role,avatar:e.avatar};localStorage.setItem("userProfile",JSON.stringify(f)),window.dispatchEvent(new Event("userProfileUpdated"))}catch{}},[s]),G.useEffect(()=>{try{const f=localStorage.getItem("userProfile");if(f){const p=JSON.parse(f);r(v=>({...v,...p}))}}catch{}},[]),G.useEffect(()=>{if(s){const f=setTimeout(()=>{o(!1)},3e3);return()=>clearTimeout(f)}},[s]);const d=f=>{var g;const p=(g=f.target.files)==null?void 0:g[0];if(!p)return;const v=URL.createObjectURL(p);r(m=>({...m,avatar:v}));try{const m={name:e.name,email:e.email,role:e.role,avatar:v};localStorage.setItem("userProfile",JSON.stringify(m)),window.dispatchEvent(new Event("userProfileUpdated"))}catch{}c(!0),setTimeout(()=>{c(!1),o(!0),n(!1)},800)};return a.jsxs("div",{className:"profile-page",children:[a.jsx("div",{className:"profile-container",children:a.jsx("div",{className:"profile-card",children:a.jsxs("div",{className:"card-body",children:[a.jsxs("div",{className:"left-col",children:[a.jsxs("div",{className:"avatar-wrap",children:[a.jsx("div",{className:"avatar",children:e.avatar?a.jsx("img",{src:e.avatar}):a.jsx("div",{className:"initials",children:(h=e.name)==null?void 0:h.charAt(0)})}),a.jsxs("label",{className:"avatar-edit",htmlFor:"avatar-upload",children:[a.jsx("input",{accept:"image/*",id:"avatar-upload",type:"file",style:{display:"none"},onChange:d}),"+"]})]}),a.jsxs("div",{className:"profile-info",children:[a.jsx("h2",{id:"profile-name",children:e.name}),a.jsx("div",{className:"role",children:e.role})]})]}),a.jsxs("div",{className:"main-col",children:[a.jsxs("div",{className:"header-row",children:[a.jsx("h3",{children:" Profile Information"}),a.jsx("button",{className:"btn",onClick:()=>n(f=>!f),disabled:i,children:t?" Cancel":" Edit Profile"})]}),a.jsxs("form",{className:"profile-form",onSubmit:f=>{f.preventDefault(),l()},children:[a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"field",children:[a.jsx("label",{htmlFor:"name",children:" Full Name"}),a.jsx("input",{id:"name",name:"name",value:e.name,onChange:u,disabled:!t,placeholder:"Enter your full name"})]}),a.jsxs("div",{className:"field",children:[a.jsx("label",{htmlFor:"email",children:" Email Address"}),a.jsx("input",{id:"email",name:"email",type:"email",value:e.email,onChange:u,disabled:!t,placeholder:"your.email@example.com"})]}),a.jsxs("div",{className:"field",children:[a.jsx("label",{htmlFor:"role",children:" Job Role"}),a.jsx("input",{id:"role",name:"role",value:e.role,onChange:u,disabled:!t,placeholder:"Your position"})]}),a.jsxs("div",{className:"field",children:[a.jsx("label",{htmlFor:"department",children:" Department"}),a.jsx("input",{id:"department",name:"department",value:e.department,onChange:u,disabled:!t,placeholder:"Engineering"})]}),a.jsxs("div",{className:"field",children:[a.jsx("label",{htmlFor:"employeeId",children:" Employee ID"}),a.jsx("input",{id:"employeeId",name:"employeeId",value:e.employeeId,onChange:u,disabled:!t,placeholder:"EMP001"})]}),a.jsxs("div",{className:"field",children:[a.jsx("label",{htmlFor:"phone",children:" Phone Number"}),a.jsx("input",{id:"phone",name:"phone",type:"tel",value:e.phone,onChange:u,disabled:!t,placeholder:"+1 (555) 123-4567"})]}),a.jsxs("div",{className:"field",children:[a.jsx("label",{htmlFor:"dob",children:" Date of Birth"}),a.jsx("input",{id:"dob",name:"dob",type:"date",value:e.dob,onChange:u,disabled:!t})]}),a.jsxs("div",{className:"field",children:[a.jsx("label",{htmlFor:"gender",children:" Gender"}),a.jsxs("select",{id:"gender",name:"gender",value:e.gender,onChange:u,disabled:!t,children:[a.jsx("option",{value:"",children:"Select gender"}),a.jsx("option",{value:"male",children:"Male"}),a.jsx("option",{value:"female",children:"Female"}),a.jsx("option",{value:"other",children:"Other"}),a.jsx("option",{value:"prefer-not-to-say",children:"Prefer not to say"})]})]}),a.jsxs("div",{className:"field full",children:[a.jsx("label",{htmlFor:"address",children:" Address"}),a.jsx("textarea",{id:"address",name:"address",value:e.address,onChange:u,disabled:!t,placeholder:"Enter your full address",rows:2})]})]}),a.jsxs("div",{className:"submit-row",children:[a.jsx("button",{type:"button",className:"btn",onClick:()=>n(!1),disabled:!t||i,children:"Cancel"}),a.jsx("button",{type:"submit",className:`btn-primary ${i?"loading":""}`,disabled:!t||i,children:i?"Saving...":" Save Changes"})]})]})]})]})})}),s&&a.jsx("div",{className:"snackbar",role:"status","aria-live":"polite",children:a.jsx("div",{className:"alert success",children:" Profile updated successfully!"})})]})}const wy="appSettings";function _8({id:e,checked:r,onChange:t,label:n}){return a.jsxs("label",{className:"switch",htmlFor:e,children:[a.jsx("input",{id:e,type:"checkbox",checked:!!r,onChange:s=>t(s.target.checked)}),a.jsx("span",{className:"slider","aria-hidden":!0}),a.jsx("span",{className:"switch-label",children:n})]})}function Uz(){const[e,r]=G.useState({fullName:"",email:"",language:"en",theme:"system",notifications:!0,marketing:!1}),[t,n]=G.useState(!1),[s,o]=G.useState(!1),[i,c]=G.useState(null);G.useEffect(()=>{try{const v=localStorage.getItem(wy);v&&r(g=>({...g,...JSON.parse(v)}))}catch{}},[]);const u=v=>{try{localStorage.setItem(wy,JSON.stringify(v)),window.dispatchEvent(new Event("appSettingsUpdated"))}catch{}},l=v=>{const{name:g,value:m}=v.target;r(b=>({...b,[g]:m})),n(!0)},d=v=>g=>{const m={...e,[v]:g};r(m),u(m),c("Saved"),setTimeout(()=>c(null),1800)},h=v=>{v&&v.preventDefault(),o(!0),setTimeout(()=>{u(e),o(!1),n(!1),c("Settings saved"),setTimeout(()=>c(null),2500)},700)},f=()=>{try{const v=localStorage.getItem(wy);v&&r(JSON.parse(v)),n(!1),c("Reverted"),setTimeout(()=>c(null),1600)}catch{}},p=()=>{confirm("Clear local settings?")&&(localStorage.removeItem(wy),r({fullName:"",email:"",language:"en",theme:"system",notifications:!0,marketing:!1}),c("Cleared local settings"),setTimeout(()=>c(null),2200))};return a.jsx("div",{className:"settings-page profile-page-theme",children:a.jsxs("div",{className:"settings-container",children:[a.jsxs("form",{className:"settings-card",onSubmit:h,children:[a.jsxs("section",{className:"card-section",children:[a.jsx("h2",{children:"Account"}),a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"field",children:[a.jsx("label",{htmlFor:"fullName",children:"Full name"}),a.jsx("input",{id:"fullName",name:"fullName",value:e.fullName,onChange:l,placeholder:"Jane Doe",disabled:!t})]}),a.jsxs("div",{className:"field",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{id:"email",name:"email",type:"email",value:e.email,onChange:l,placeholder:"you@example.com",disabled:!t})]}),a.jsxs("div",{className:"field",children:[a.jsx("label",{htmlFor:"language",children:"Language"}),a.jsxs("select",{id:"language",name:"language",value:e.language,onChange:l,disabled:!t,children:[a.jsx("option",{value:"en",children:"English"}),a.jsx("option",{value:"es",children:"Espaol"}),a.jsx("option",{value:"fr",children:"Franais"}),a.jsx("option",{value:"hi",children:""})]})]}),a.jsxs("div",{className:"field",children:[a.jsx("label",{htmlFor:"theme",children:"Theme"}),a.jsxs("select",{id:"theme",name:"theme",value:e.theme,onChange:l,disabled:!t,children:[a.jsx("option",{value:"system",children:"System"}),a.jsx("option",{value:"light",children:"Light"}),a.jsx("option",{value:"dark",children:"Dark"})]})]})]})]}),a.jsxs("section",{className:"card-section",children:[a.jsx("h2",{children:"Notifications"}),a.jsxs("div",{className:"form-grid single-column",children:[a.jsx("div",{className:"field",children:a.jsx(_8,{id:"notifications",checked:e.notifications,onChange:d("notifications"),label:"Desktop notifications"})}),a.jsx("div",{className:"field",children:a.jsx(_8,{id:"marketing",checked:e.marketing,onChange:d("marketing"),label:"Marketing emails"})})]})]}),a.jsxs("section",{className:"card-section",children:[a.jsx("h2",{children:"Danger Zone"}),a.jsx("p",{className:"muted",children:"Operations in this section are destructive or irreversible."}),a.jsx("div",{className:"danger-actions",children:a.jsx("button",{type:"button",className:"btn-danger",onClick:p,children:"Clear local settings"})})]}),a.jsxs("footer",{className:"card-footer",children:[a.jsx("div",{className:"footer-left",children:a.jsx("button",{type:"button",className:"btn",onClick:f,disabled:s,children:"Revert"})}),a.jsxs("div",{className:"footer-right",children:[a.jsx("button",{type:"button",className:"btn",onClick:()=>n(!1),disabled:!t||s,children:"Cancel"}),a.jsx("button",{type:"submit",className:"btn-primary",disabled:!t||s,children:s?"Saving...":"Save changes"})]})]})]}),i&&a.jsx("div",{className:"snackbar",role:"status","aria-live":"polite",children:a.jsx("div",{className:"alert",children:i})})]})})}function Hz(e){return an("MuiAlert",e)}const A8=un("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),Vz=Hn(a.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"})),Wz=Hn(a.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"})),qz=Hn(a.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"})),Gz=Hn(a.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"})),x7=Hn(a.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),Kz=e=>{const{variant:r,color:t,severity:n,classes:s}=e,o={root:["root",`color${yr(t||n)}`,`${r}${yr(t||n)}`,`${r}`],icon:["icon"],message:["message"],action:["action"]};return nn(o,Hz,s)},Xz=or(sa,{name:"MuiAlert",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,r[t.variant],r[`${t.variant}${yr(t.color||t.severity)}`]]}})(cn(({theme:e})=>{const r=e.palette.mode==="light"?Mm:Dm,t=e.palette.mode==="light"?Dm:Mm;return{...e.typography.body2,backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(e.palette).filter(qi(["light"])).map(([n])=>({props:{colorSeverity:n,variant:"standard"},style:{color:e.vars?e.vars.palette.Alert[`${n}Color`]:r(e.palette[n].light,.6),backgroundColor:e.vars?e.vars.palette.Alert[`${n}StandardBg`]:t(e.palette[n].light,.9),[`& .${A8.icon}`]:e.vars?{color:e.vars.palette.Alert[`${n}IconColor`]}:{color:e.palette[n].main}}})),...Object.entries(e.palette).filter(qi(["light"])).map(([n])=>({props:{colorSeverity:n,variant:"outlined"},style:{color:e.vars?e.vars.palette.Alert[`${n}Color`]:r(e.palette[n].light,.6),border:`1px solid ${(e.vars||e).palette[n].light}`,[`& .${A8.icon}`]:e.vars?{color:e.vars.palette.Alert[`${n}IconColor`]}:{color:e.palette[n].main}}})),...Object.entries(e.palette).filter(qi(["dark"])).map(([n])=>({props:{colorSeverity:n,variant:"filled"},style:{fontWeight:e.typography.fontWeightMedium,...e.vars?{color:e.vars.palette.Alert[`${n}FilledColor`],backgroundColor:e.vars.palette.Alert[`${n}FilledBg`]}:{backgroundColor:e.palette.mode==="dark"?e.palette[n].dark:e.palette[n].main,color:e.palette.getContrastText(e.palette[n].main)}}}))]}})),Yz=or("div",{name:"MuiAlert",slot:"Icon"})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),Zz=or("div",{name:"MuiAlert",slot:"Message"})({padding:"8px 0",minWidth:0,overflow:"auto"}),Jz=or("div",{name:"MuiAlert",slot:"Action"})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),C8={success:a.jsx(Vz,{fontSize:"inherit"}),warning:a.jsx(Wz,{fontSize:"inherit"}),error:a.jsx(qz,{fontSize:"inherit"}),info:a.jsx(Gz,{fontSize:"inherit"})},eu=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiAlert"}),{action:s,children:o,className:i,closeText:c="Close",color:u,components:l={},componentsProps:d={},icon:h,iconMapping:f=C8,onClose:p,role:v="alert",severity:g="success",slotProps:m={},slots:b={},variant:y="standard",...S}=n,C={...n,color:u,severity:g,variant:y,colorSeverity:u||g},L=Kz(C),O={slots:{closeButton:l.CloseButton,closeIcon:l.CloseIcon,...b},slotProps:{...d,...m}},[H,z]=ln("root",{ref:t,shouldForwardComponentProp:!0,className:Pr(L.root,i),elementType:Xz,externalForwardedProps:{...O,...S},ownerState:C,additionalProps:{role:v,elevation:0}}),[q,D]=ln("icon",{className:L.icon,elementType:Yz,externalForwardedProps:O,ownerState:C}),[W,P]=ln("message",{className:L.message,elementType:Zz,externalForwardedProps:O,ownerState:C}),[I,U]=ln("action",{className:L.action,elementType:Jz,externalForwardedProps:O,ownerState:C}),[k,_]=ln("closeButton",{elementType:sn,externalForwardedProps:O,ownerState:C}),[R,j]=ln("closeIcon",{elementType:x7,externalForwardedProps:O,ownerState:C});return a.jsxs(H,{...z,children:[h!==!1?a.jsx(q,{...D,children:h||f[g]||C8[g]}):null,a.jsx(W,{...P,children:o}),s!=null?a.jsx(I,{...U,children:s}):null,s==null&&p?a.jsx(I,{...U,children:a.jsx(k,{size:"small","aria-label":c,title:c,color:"inherit",onClick:p,..._,children:a.jsx(R,{fontSize:"small",...j})})}):null]})}),Qz=e=>{const r=G.useRef({});return G.useEffect(()=>{r.current=e}),r.current};function j8(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function e$(e={}){const{ignoreAccents:r=!0,ignoreCase:t=!0,limit:n,matchFrom:s="any",stringify:o,trim:i=!1}=e;return(c,{inputValue:u,getOptionLabel:l})=>{let d=i?u.trim():u;t&&(d=d.toLowerCase()),r&&(d=j8(d));const h=d?c.filter(f=>{let p=(o||l)(f);return t&&(p=p.toLowerCase()),r&&(p=j8(p)),s==="start"?p.startsWith(d):p.includes(d)}):c;return typeof n=="number"?h.slice(0,n):h}}const t$=e$(),r$=5,n$=e=>{var r;return e.current!==null&&((r=e.current.parentElement)==null?void 0:r.contains(document.activeElement))},a$=[];function k8(e,r,t,n){if(r||e==null||n)return"";const s=t(e);return typeof s=="string"?s:""}function s$(e){const{unstable_isActiveElementInListbox:r=n$,unstable_classNamePrefix:t="Mui",autoComplete:n=!1,autoHighlight:s=!1,autoSelect:o=!1,blurOnSelect:i=!1,clearOnBlur:c=!e.freeSolo,clearOnEscape:u=!1,componentName:l="useAutocomplete",defaultValue:d=e.multiple?a$:null,disableClearable:h=!1,disableCloseOnSelect:f=!1,disabled:p,disabledItemsFocusable:v=!1,disableListWrap:g=!1,filterOptions:m=t$,filterSelectedOptions:b=!1,freeSolo:y=!1,getOptionDisabled:S,getOptionKey:C,getOptionLabel:L=Re=>Re.label??Re,groupBy:O,handleHomeEndKeys:H=!e.freeSolo,id:z,includeInputInList:q=!1,inputValue:D,isOptionEqualToValue:W=(Re,Ie)=>Re===Ie,multiple:P=!1,onChange:I,onClose:U,onHighlightChange:k,onInputChange:_,onOpen:R,open:j,openOnFocus:A=!1,options:N,readOnly:V=!1,renderValue:M,selectOnFocus:Z=!e.freeSolo,value:J}=e,re=Od(z);let X=L;X=Re=>{const Ie=L(Re);return typeof Ie!="string"?String(Ie):Ie};const ne=G.useRef(!1),Y=G.useRef(!0),K=G.useRef(null),ee=G.useRef(null),[ue,se]=G.useState(null),[ce,fe]=G.useState(-1),ve=s?0:-1,_e=G.useRef(ve),le=G.useRef(k8(d??J,P,X)).current,[ke,Te]=A0({controlled:J,default:d,name:l}),[pe,ye]=A0({controlled:D,default:le,name:l,state:"inputValue"}),[ge,De]=G.useState(!1),He=G.useCallback((Re,Ie,ae)=>{if(!(P?ke.length<Ie.length:Ie!==null)&&!c)return;const Fe=k8(Ie,P,X,M);pe!==Fe&&(ye(Fe),_&&_(Re,Fe,ae))},[X,pe,P,_,ye,c,ke,M]),[Xe,at]=A0({controlled:j,default:!1,name:l,state:"open"}),[dt,wt]=G.useState(!0),$t=!P&&ke!=null&&pe===X(ke),Bt=Xe&&!V,ft=Bt?m(N.filter(Re=>!(b&&(P?ke:[ke]).some(Ie=>Ie!==null&&W(Re,Ie)))),{inputValue:$t&&dt?"":pe,getOptionLabel:X}):[],tr=Qz({filteredOptions:ft,value:ke,inputValue:pe});G.useEffect(()=>{const Re=ke!==tr.value;ge&&!Re||y&&!Re||He(null,ke,"reset")},[ke,He,ge,tr.value,y]);const Me=Xe&&ft.length>0&&!V,tt=Di(Re=>{if(Re===-1)K.current.focus();else{const Ie=M?"data-item-index":"data-tag-index";ue.querySelector(`[${Ie}="${Re}"]`).focus()}});G.useEffect(()=>{P&&ce>ke.length-1&&(fe(-1),tt(-1))},[ke,P,ce,tt]);function Ze(Re,Ie){if(!ee.current||Re<0||Re>=ft.length)return-1;let ae=Re;for(;;){const we=ee.current.querySelector(`[data-option-index="${ae}"]`),Fe=v?!1:!we||we.disabled||we.getAttribute("aria-disabled")==="true";if(we&&we.hasAttribute("tabindex")&&!Fe)return ae;if(Ie==="next"?ae=(ae+1)%ft.length:ae=(ae-1+ft.length)%ft.length,ae===Re)return-1}}const St=Di(({event:Re,index:Ie,reason:ae})=>{if(_e.current=Ie,Ie===-1?K.current.removeAttribute("aria-activedescendant"):K.current.setAttribute("aria-activedescendant",`${re}-option-${Ie}`),k&&["mouse","keyboard","touch"].includes(ae)&&k(Re,Ie===-1?null:ft[Ie],ae),!ee.current)return;const we=ee.current.querySelector(`[role="option"].${t}-focused`);we&&(we.classList.remove(`${t}-focused`),we.classList.remove(`${t}-focusVisible`));let Fe=ee.current;if(ee.current.getAttribute("role")!=="listbox"&&(Fe=ee.current.parentElement.querySelector('[role="listbox"]')),!Fe)return;if(Ie===-1){Fe.scrollTop=0;return}const Ye=ee.current.querySelector(`[data-option-index="${Ie}"]`);if(Ye&&(Ye.classList.add(`${t}-focused`),ae==="keyboard"&&Ye.classList.add(`${t}-focusVisible`),Fe.scrollHeight>Fe.clientHeight&&ae!=="mouse"&&ae!=="touch")){const me=Ye,Be=Fe.clientHeight+Fe.scrollTop,Ge=me.offsetTop+me.offsetHeight;Ge>Be?Fe.scrollTop=Ge-Fe.clientHeight:me.offsetTop-me.offsetHeight*(O?1.3:0)<Fe.scrollTop&&(Fe.scrollTop=me.offsetTop-me.offsetHeight*(O?1.3:0))}}),et=Di(({event:Re,diff:Ie,direction:ae="next",reason:we})=>{if(!Bt)return;const Ye=Ze((()=>{const me=ft.length-1;if(Ie==="reset")return ve;if(Ie==="start")return 0;if(Ie==="end")return me;const Be=_e.current+Ie;return Be<0?Be===-1&&q?-1:g&&_e.current!==-1||Math.abs(Ie)>1?0:me:Be>me?Be===me+1&&q?-1:g||Math.abs(Ie)>1?me:0:Be})(),ae);if(St({index:Ye,reason:we,event:Re}),n&&Ie!=="reset")if(Ye===-1)K.current.value=pe;else{const me=X(ft[Ye]);K.current.value=me,me.toLowerCase().indexOf(pe.toLowerCase())===0&&pe.length>0&&K.current.setSelectionRange(pe.length,me.length)}}),Ht=()=>{const Re=(Ie,ae)=>{const we=Ie?X(Ie):"",Fe=ae?X(ae):"";return we===Fe};if(_e.current!==-1&&tr.filteredOptions&&tr.filteredOptions.length!==ft.length&&tr.inputValue===pe&&(P?ke.length===tr.value.length&&tr.value.every((Ie,ae)=>X(ke[ae])===X(Ie)):Re(tr.value,ke))){const Ie=tr.filteredOptions[_e.current];if(Ie)return ft.findIndex(ae=>X(ae)===X(Ie))}return-1},Nt=G.useCallback(()=>{if(!Bt)return;const Re=Ht();if(Re!==-1){_e.current=Re;return}const Ie=P?ke[0]:ke;if(ft.length===0||Ie==null){et({diff:"reset"});return}if(ee.current){if(Ie!=null){const ae=ft[_e.current];if(P&&ae&&ke.findIndex(Fe=>W(ae,Fe))!==-1)return;const we=ft.findIndex(Fe=>W(Fe,Ie));we===-1?et({diff:"reset"}):St({index:we});return}if(_e.current>=ft.length-1){St({index:ft.length-1});return}St({index:_e.current})}},[ft.length,P?!1:ke,b,et,St,Bt,pe,P]),kt=Di(Re=>{fS(ee,Re),Re&&Nt()});G.useEffect(()=>{Nt()},[Nt]);const kr=Re=>{Xe||(at(!0),wt(!0),R&&R(Re))},Jt=(Re,Ie)=>{Xe&&(at(!1),U&&U(Re,Ie))},Pt=(Re,Ie,ae,we)=>{if(P){if(ke.length===Ie.length&&ke.every((Fe,Ye)=>Fe===Ie[Ye]))return}else if(ke===Ie)return;I&&I(Re,Ie,ae,we),Te(Ie)},Ur=G.useRef(!1),Lr=(Re,Ie,ae="selectOption",we="options")=>{let Fe=ae,Ye=Ie;if(P){Ye=Array.isArray(ke)?ke.slice():[];const me=Ye.findIndex(Be=>W(Ie,Be));me===-1?Ye.push(Ie):we!=="freeSolo"&&(Ye.splice(me,1),Fe="removeOption")}He(Re,Ye,Fe),Pt(Re,Ye,Fe,{option:Ie}),!f&&(!Re||!Re.ctrlKey&&!Re.metaKey)&&Jt(Re,Fe),(i===!0||i==="touch"&&Ur.current||i==="mouse"&&!Ur.current)&&K.current.blur()};function vt(Re,Ie){if(Re===-1)return-1;let ae=Re;for(;;){if(Ie==="next"&&ae===ke.length||Ie==="previous"&&ae===-1)return-1;const we=M?"data-item-index":"data-tag-index",Fe=ue.querySelector(`[${we}="${ae}"]`);if(!Fe||!Fe.hasAttribute("tabindex")||Fe.disabled||Fe.getAttribute("aria-disabled")==="true")ae+=Ie==="next"?1:-1;else return ae}}const nr=(Re,Ie)=>{if(!P)return;pe===""&&Jt(Re,"toggleInput");let ae=ce;ce===-1?pe===""&&Ie==="previous"&&(ae=ke.length-1):(ae+=Ie==="next"?1:-1,ae<0&&(ae=0),ae===ke.length&&(ae=-1)),ae=vt(ae,Ie),fe(ae),tt(ae)},Cr=Re=>{ne.current=!0,ye(""),_&&_(Re,"","clear"),Pt(Re,P?[]:null,"clear")},Dt=Re=>Ie=>{if(Re.onKeyDown&&Re.onKeyDown(Ie),!Ie.defaultMuiPrevented&&(ce!==-1&&!["ArrowLeft","ArrowRight"].includes(Ie.key)&&(fe(-1),tt(-1)),Ie.which!==229))switch(Ie.key){case"Home":Bt&&H&&(Ie.preventDefault(),et({diff:"start",direction:"next",reason:"keyboard",event:Ie}));break;case"End":Bt&&H&&(Ie.preventDefault(),et({diff:"end",direction:"previous",reason:"keyboard",event:Ie}));break;case"PageUp":Ie.preventDefault(),et({diff:-5,direction:"previous",reason:"keyboard",event:Ie}),kr(Ie);break;case"PageDown":Ie.preventDefault(),et({diff:r$,direction:"next",reason:"keyboard",event:Ie}),kr(Ie);break;case"ArrowDown":Ie.preventDefault(),et({diff:1,direction:"next",reason:"keyboard",event:Ie}),kr(Ie);break;case"ArrowUp":Ie.preventDefault(),et({diff:-1,direction:"previous",reason:"keyboard",event:Ie}),kr(Ie);break;case"ArrowLeft":!P&&M?tt(0):nr(Ie,"previous");break;case"ArrowRight":!P&&M?tt(-1):nr(Ie,"next");break;case"Enter":if(_e.current!==-1&&Bt){const ae=ft[_e.current],we=S?S(ae):!1;if(Ie.preventDefault(),we)return;Lr(Ie,ae,"selectOption"),n&&K.current.setSelectionRange(K.current.value.length,K.current.value.length)}else y&&pe!==""&&$t===!1&&(P&&Ie.preventDefault(),Lr(Ie,pe,"createOption","freeSolo"));break;case"Escape":Bt?(Ie.preventDefault(),Ie.stopPropagation(),Jt(Ie,"escape")):u&&(pe!==""||P&&ke.length>0||M)&&(Ie.preventDefault(),Ie.stopPropagation(),Cr(Ie));break;case"Backspace":if(P&&!V&&pe===""&&ke.length>0){const ae=ce===-1?ke.length-1:ce,we=ke.slice();we.splice(ae,1),Pt(Ie,we,"removeOption",{option:ke[ae]})}!P&&M&&!V&&(Te(null),tt(-1));break;case"Delete":if(P&&!V&&pe===""&&ke.length>0&&ce!==-1){const ae=ce,we=ke.slice();we.splice(ae,1),Pt(Ie,we,"removeOption",{option:ke[ae]})}!P&&M&&!V&&(Te(null),tt(-1));break}},je=Re=>{De(!0),A&&!ne.current&&kr(Re)},ct=Re=>{if(r(ee)){K.current.focus();return}De(!1),Y.current=!0,ne.current=!1,o&&_e.current!==-1&&Bt?Lr(Re,ft[_e.current],"blur"):o&&y&&pe!==""?Lr(Re,pe,"blur","freeSolo"):c&&He(Re,ke,"blur"),Jt(Re,"blur")},nt=Re=>{const Ie=Re.target.value;pe!==Ie&&(ye(Ie),wt(!1),_&&_(Re,Ie,"input")),Ie===""?!h&&!P&&Pt(Re,null,"clear"):kr(Re)},Pe=Re=>{const Ie=Number(Re.currentTarget.getAttribute("data-option-index"));_e.current!==Ie&&St({event:Re,index:Ie,reason:"mouse"})},Qe=Re=>{St({event:Re,index:Number(Re.currentTarget.getAttribute("data-option-index")),reason:"touch"}),Ur.current=!0},gt=Re=>{const Ie=Number(Re.currentTarget.getAttribute("data-option-index"));Lr(Re,ft[Ie],"selectOption"),Ur.current=!1},xe=Re=>Ie=>{const ae=ke.slice();ae.splice(Re,1),Pt(Ie,ae,"removeOption",{option:ke[Re]})},Oe=Re=>{Pt(Re,null,"removeOption",{option:ke})},Ce=Re=>{Xe?Jt(Re,"toggleInput"):kr(Re)},de=Re=>{Re.currentTarget.contains(Re.target)&&Re.target.getAttribute("id")!==re&&Re.preventDefault()},be=Re=>{Re.currentTarget.contains(Re.target)&&(K.current.focus(),Z&&Y.current&&K.current.selectionEnd-K.current.selectionStart===0&&K.current.select(),Y.current=!1)},Se=Re=>{!p&&(pe===""||!Xe)&&Ce(Re)};let Ne=y&&pe.length>0;Ne=Ne||(P?ke.length>0:ke!==null);let ze=ft;return O&&(ze=ft.reduce((Re,Ie,ae)=>{const we=O(Ie);return Re.length>0&&Re[Re.length-1].group===we?Re[Re.length-1].options.push(Ie):Re.push({key:ae,index:ae,group:we,options:[Ie]}),Re},[])),p&&ge&&ct(),{getRootProps:(Re={})=>({...Re,onKeyDown:Dt(Re),onMouseDown:de,onClick:be}),getInputLabelProps:()=>({id:`${re}-label`,htmlFor:re}),getInputProps:()=>({id:re,value:pe,onBlur:ct,onFocus:je,onChange:nt,onMouseDown:Se,"aria-activedescendant":Bt?"":null,"aria-autocomplete":n?"both":"list","aria-controls":Me?`${re}-listbox`:void 0,"aria-expanded":Me,autoComplete:"off",ref:K,autoCapitalize:"none",spellCheck:"false",role:"combobox",disabled:p}),getClearProps:()=>({tabIndex:-1,type:"button",onClick:Cr}),getItemProps:({index:Re=0}={})=>({...P&&{key:Re},...M?{"data-item-index":Re}:{"data-tag-index":Re},tabIndex:-1,...!V&&{onDelete:P?xe(Re):Oe}}),getPopupIndicatorProps:()=>({tabIndex:-1,type:"button",onClick:Ce}),getTagProps:({index:Re})=>({key:Re,"data-tag-index":Re,tabIndex:-1,...!V&&{onDelete:xe(Re)}}),getListboxProps:()=>({role:"listbox",id:`${re}-listbox`,"aria-labelledby":`${re}-label`,ref:kt,onMouseDown:Re=>{Re.preventDefault()}}),getOptionProps:({index:Re,option:Ie})=>{const ae=(P?ke:[ke]).some(Fe=>Fe!=null&&W(Ie,Fe)),we=S?S(Ie):!1;return{key:(C==null?void 0:C(Ie))??X(Ie),tabIndex:-1,role:"option",id:`${re}-option-${Re}`,onMouseMove:Pe,onClick:gt,onTouchStart:Qe,"data-option-index":Re,"aria-disabled":we,"aria-selected":ae}},id:re,inputValue:pe,value:ke,dirty:Ne,expanded:Bt&&ue,popupOpen:Bt,focused:ge||ce!==-1,anchorEl:ue,setAnchorEl:se,focusedItem:ce,focusedTag:ce,groupedOptions:ze}}function i$(e){return an("MuiListSubheader",e)}un("MuiListSubheader",["root","colorPrimary","colorInherit","gutters","inset","sticky"]);const o$=e=>{const{classes:r,color:t,disableGutters:n,inset:s,disableSticky:o}=e,i={root:["root",t!=="default"&&`color${yr(t)}`,!n&&"gutters",s&&"inset",!o&&"sticky"]};return nn(i,i$,r)},l$=or("li",{name:"MuiListSubheader",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,t.color!=="default"&&r[`color${yr(t.color)}`],!t.disableGutters&&r.gutters,t.inset&&r.inset,!t.disableSticky&&r.sticky]}})(cn(({theme:e})=>({boxSizing:"border-box",lineHeight:"48px",listStyle:"none",color:(e.vars||e).palette.text.secondary,fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(14),variants:[{props:{color:"primary"},style:{color:(e.vars||e).palette.primary.main}},{props:{color:"inherit"},style:{color:"inherit"}},{props:({ownerState:r})=>!r.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:r})=>r.inset,style:{paddingLeft:72}},{props:({ownerState:r})=>!r.disableSticky,style:{position:"sticky",top:0,zIndex:1,backgroundColor:(e.vars||e).palette.background.paper}}]}))),CS=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiListSubheader"}),{className:s,color:o="default",component:i="li",disableGutters:c=!1,disableSticky:u=!1,inset:l=!1,...d}=n,h={...n,color:o,component:i,disableGutters:c,disableSticky:u,inset:l},f=o$(h);return a.jsx(l$,{as:i,className:Pr(f.root,s),ref:t,ownerState:h,...d})});CS&&(CS.muiSkipListHighlight=!0);const c$=Hn(a.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}));function u$(e){return an("MuiChip",e)}const Aa=un("MuiChip",["root","sizeSmall","sizeMedium","colorDefault","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),d$=e=>{const{classes:r,disabled:t,size:n,color:s,iconColor:o,onDelete:i,clickable:c,variant:u}=e,l={root:["root",u,t&&"disabled",`size${yr(n)}`,`color${yr(s)}`,c&&"clickable",c&&`clickableColor${yr(s)}`,i&&"deletable",i&&`deletableColor${yr(s)}`,`${u}${yr(s)}`],label:["label",`label${yr(n)}`],avatar:["avatar",`avatar${yr(n)}`,`avatarColor${yr(s)}`],icon:["icon",`icon${yr(n)}`,`iconColor${yr(o)}`],deleteIcon:["deleteIcon",`deleteIcon${yr(n)}`,`deleteIconColor${yr(s)}`,`deleteIcon${yr(u)}Color${yr(s)}`]};return nn(l,u$,r)},f$=or("div",{name:"MuiChip",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e,{color:n,iconColor:s,clickable:o,onDelete:i,size:c,variant:u}=t;return[{[`& .${Aa.avatar}`]:r.avatar},{[`& .${Aa.avatar}`]:r[`avatar${yr(c)}`]},{[`& .${Aa.avatar}`]:r[`avatarColor${yr(n)}`]},{[`& .${Aa.icon}`]:r.icon},{[`& .${Aa.icon}`]:r[`icon${yr(c)}`]},{[`& .${Aa.icon}`]:r[`iconColor${yr(s)}`]},{[`& .${Aa.deleteIcon}`]:r.deleteIcon},{[`& .${Aa.deleteIcon}`]:r[`deleteIcon${yr(c)}`]},{[`& .${Aa.deleteIcon}`]:r[`deleteIconColor${yr(n)}`]},{[`& .${Aa.deleteIcon}`]:r[`deleteIcon${yr(u)}Color${yr(n)}`]},r.root,r[`size${yr(c)}`],r[`color${yr(n)}`],o&&r.clickable,o&&n!=="default"&&r[`clickableColor${yr(n)})`],i&&r.deletable,i&&n!=="default"&&r[`deletableColor${yr(n)}`],r[u],r[`${u}${yr(n)}`]]}})(cn(({theme:e})=>{const r=e.palette.mode==="light"?e.palette.grey[700]:e.palette.grey[300];return{maxWidth:"100%",fontFamily:e.typography.fontFamily,fontSize:e.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(e.vars||e).palette.text.primary,backgroundColor:(e.vars||e).palette.action.selected,borderRadius:32/2,whiteSpace:"nowrap",transition:e.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${Aa.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${Aa.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:e.vars?e.vars.palette.Chip.defaultAvatarColor:r,fontSize:e.typography.pxToRem(12)},[`& .${Aa.avatarColorPrimary}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.dark},[`& .${Aa.avatarColorSecondary}`]:{color:(e.vars||e).palette.secondary.contrastText,backgroundColor:(e.vars||e).palette.secondary.dark},[`& .${Aa.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:e.typography.pxToRem(10)},[`& .${Aa.icon}`]:{marginLeft:5,marginRight:-6},[`& .${Aa.deleteIcon}`]:{WebkitTapHighlightColor:"transparent",color:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / 0.26)`:Ca(e.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / 0.4)`:Ca(e.palette.text.primary,.4)}},variants:[{props:{size:"small"},style:{height:24,[`& .${Aa.icon}`]:{fontSize:18,marginLeft:4,marginRight:-4},[`& .${Aa.deleteIcon}`]:{fontSize:16,marginRight:4,marginLeft:-4}}},...Object.entries(e.palette).filter(qi(["contrastText"])).map(([t])=>({props:{color:t},style:{backgroundColor:(e.vars||e).palette[t].main,color:(e.vars||e).palette[t].contrastText,[`& .${Aa.deleteIcon}`]:{color:e.vars?`rgba(${e.vars.palette[t].contrastTextChannel} / 0.7)`:Ca(e.palette[t].contrastText,.7),"&:hover, &:active":{color:(e.vars||e).palette[t].contrastText}}}})),{props:t=>t.iconColor===t.color,style:{[`& .${Aa.icon}`]:{color:e.vars?e.vars.palette.Chip.defaultIconColor:r}}},{props:t=>t.iconColor===t.color&&t.color!=="default",style:{[`& .${Aa.icon}`]:{color:"inherit"}}},{props:{onDelete:!0},style:{[`&.${Aa.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selectedChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:Ca(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}}},...Object.entries(e.palette).filter(qi(["dark"])).map(([t])=>({props:{color:t,onDelete:!0},style:{[`&.${Aa.focusVisible}`]:{background:(e.vars||e).palette[t].dark}}})),{props:{clickable:!0},style:{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selectedChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:Ca(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity)},[`&.${Aa.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selectedChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:Ca(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)},"&:active":{boxShadow:(e.vars||e).shadows[1]}}},...Object.entries(e.palette).filter(qi(["dark"])).map(([t])=>({props:{color:t,clickable:!0},style:{[`&:hover, &.${Aa.focusVisible}`]:{backgroundColor:(e.vars||e).palette[t].dark}}})),{props:{variant:"outlined"},style:{backgroundColor:"transparent",border:e.vars?`1px solid ${e.vars.palette.Chip.defaultBorder}`:`1px solid ${e.palette.mode==="light"?e.palette.grey[400]:e.palette.grey[700]}`,[`&.${Aa.clickable}:hover`]:{backgroundColor:(e.vars||e).palette.action.hover},[`&.${Aa.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`& .${Aa.avatar}`]:{marginLeft:4},[`& .${Aa.avatarSmall}`]:{marginLeft:2},[`& .${Aa.icon}`]:{marginLeft:4},[`& .${Aa.iconSmall}`]:{marginLeft:2},[`& .${Aa.deleteIcon}`]:{marginRight:5},[`& .${Aa.deleteIconSmall}`]:{marginRight:3}}},...Object.entries(e.palette).filter(qi()).map(([t])=>({props:{variant:"outlined",color:t},style:{color:(e.vars||e).palette[t].main,border:`1px solid ${e.vars?`rgba(${e.vars.palette[t].mainChannel} / 0.7)`:Ca(e.palette[t].main,.7)}`,[`&.${Aa.clickable}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette[t].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:Ca(e.palette[t].main,e.palette.action.hoverOpacity)},[`&.${Aa.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette[t].mainChannel} / ${e.vars.palette.action.focusOpacity})`:Ca(e.palette[t].main,e.palette.action.focusOpacity)},[`& .${Aa.deleteIcon}`]:{color:e.vars?`rgba(${e.vars.palette[t].mainChannel} / 0.7)`:Ca(e.palette[t].main,.7),"&:hover, &:active":{color:(e.vars||e).palette[t].main}}}}))]}})),h$=or("span",{name:"MuiChip",slot:"Label",overridesResolver:(e,r)=>{const{ownerState:t}=e,{size:n}=t;return[r.label,r[`label${yr(n)}`]]}})({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap",variants:[{props:{variant:"outlined"},style:{paddingLeft:11,paddingRight:11}},{props:{size:"small"},style:{paddingLeft:8,paddingRight:8}},{props:{size:"small",variant:"outlined"},style:{paddingLeft:7,paddingRight:7}}]});function R8(e){return e.key==="Backspace"||e.key==="Delete"}const b7=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiChip"}),{avatar:s,className:o,clickable:i,color:c="default",component:u,deleteIcon:l,disabled:d=!1,icon:h,label:f,onClick:p,onDelete:v,onKeyDown:g,onKeyUp:m,size:b="medium",variant:y="filled",tabIndex:S,skipFocusWhenDisabled:C=!1,...L}=n,O=G.useRef(null),H=Ni(O,t),z=A=>{A.stopPropagation(),v&&v(A)},q=A=>{A.currentTarget===A.target&&R8(A)&&A.preventDefault(),g&&g(A)},D=A=>{A.currentTarget===A.target&&v&&R8(A)&&v(A),m&&m(A)},W=i!==!1&&p?!0:i,P=W||v?$f:u||"div",I={...n,component:P,disabled:d,size:b,color:c,iconColor:G.isValidElement(h)&&h.props.color||c,onDelete:!!v,clickable:W,variant:y},U=d$(I),k=P===$f?{component:u||"div",focusVisibleClassName:U.focusVisible,...v&&{disableRipple:!0}}:{};let _=null;v&&(_=l&&G.isValidElement(l)?G.cloneElement(l,{className:Pr(l.props.className,U.deleteIcon),onClick:z}):a.jsx(c$,{className:U.deleteIcon,onClick:z}));let R=null;s&&G.isValidElement(s)&&(R=G.cloneElement(s,{className:Pr(U.avatar,s.props.className)}));let j=null;return h&&G.isValidElement(h)&&(j=G.cloneElement(h,{className:Pr(U.icon,h.props.className)})),a.jsxs(f$,{as:P,className:Pr(U.root,o),disabled:W&&d?!0:void 0,onClick:p,onKeyDown:q,onKeyUp:D,ref:H,tabIndex:C&&d?-1:S,ownerState:I,...k,...L,children:[R||j,a.jsx(h$,{className:U.label,ownerState:I,children:f}),_]})});function Sy(e){return parseInt(e,10)||0}const p$={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function m$(e){for(const r in e)return!1;return!0}function E8(e){return m$(e)||e.outerHeightStyle===0&&!e.overflowing}const g$=G.forwardRef(function(r,t){const{onChange:n,maxRows:s,minRows:o=1,style:i,value:c,...u}=r,{current:l}=G.useRef(c!=null),d=G.useRef(null),h=Ni(t,d),f=G.useRef(null),p=G.useRef(null),v=G.useCallback(()=>{const S=d.current,C=p.current;if(!S||!C)return;const O=Qc(S).getComputedStyle(S);if(O.width==="0px")return{outerHeightStyle:0,overflowing:!1};C.style.width=O.width,C.value=S.value||r.placeholder||"x",C.value.slice(-1)===`
`&&(C.value+=" ");const H=O.boxSizing,z=Sy(O.paddingBottom)+Sy(O.paddingTop),q=Sy(O.borderBottomWidth)+Sy(O.borderTopWidth),D=C.scrollHeight;C.value="x";const W=C.scrollHeight;let P=D;o&&(P=Math.max(Number(o)*W,P)),s&&(P=Math.min(Number(s)*W,P)),P=Math.max(P,W);const I=P+(H==="border-box"?z+q:0),U=Math.abs(P-D)<=1;return{outerHeightStyle:I,overflowing:U}},[s,o,r.placeholder]),g=Di(()=>{const S=d.current,C=v();if(!S||!C||E8(C))return!1;const L=C.outerHeightStyle;return f.current!=null&&f.current!==L}),m=G.useCallback(()=>{const S=d.current,C=v();if(!S||!C||E8(C))return;const L=C.outerHeightStyle;f.current!==L&&(f.current=L,S.style.height=`${L}px`),S.style.overflow=C.overflowing?"hidden":""},[v]),b=G.useRef(-1);Jc(()=>{const S=dw(m),C=d==null?void 0:d.current;if(!C)return;const L=Qc(C);L.addEventListener("resize",S);let O;return typeof ResizeObserver<"u"&&(O=new ResizeObserver(()=>{g()&&(O.unobserve(C),cancelAnimationFrame(b.current),m(),b.current=requestAnimationFrame(()=>{O.observe(C)}))}),O.observe(C)),()=>{S.clear(),cancelAnimationFrame(b.current),L.removeEventListener("resize",S),O&&O.disconnect()}},[v,m,g]),Jc(()=>{m()});const y=S=>{l||m();const C=S.target,L=C.value.length,O=C.value.endsWith(`
`),H=C.selectionStart===L;O&&H&&C.setSelectionRange(L,L),n&&n(S)};return a.jsxs(G.Fragment,{children:[a.jsx("textarea",{value:c,onChange:y,ref:h,rows:o,style:i,...u}),a.jsx("textarea",{"aria-hidden":!0,className:r.className,readOnly:!0,ref:p,tabIndex:-1,style:{...p$.shadow,...i,paddingTop:0,paddingBottom:0}})]})});function Jf({props:e,states:r,muiFormControl:t}){return r.reduce((n,s)=>(n[s]=e[s],t&&typeof e[s]>"u"&&(n[s]=t[s]),n),{})}const mw=G.createContext(void 0);function Ku(){return G.useContext(mw)}function N8(e){return e!=null&&!(Array.isArray(e)&&e.length===0)}function x2(e,r=!1){return e&&(N8(e.value)&&e.value!==""||r&&N8(e.defaultValue)&&e.defaultValue!=="")}function v$(e){return e.startAdornment}function x$(e){return an("MuiInputBase",e)}const Dl=un("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]);var T8;const gw=(e,r)=>{const{ownerState:t}=e;return[r.root,t.formControl&&r.formControl,t.startAdornment&&r.adornedStart,t.endAdornment&&r.adornedEnd,t.error&&r.error,t.size==="small"&&r.sizeSmall,t.multiline&&r.multiline,t.color&&r[`color${yr(t.color)}`],t.fullWidth&&r.fullWidth,t.hiddenLabel&&r.hiddenLabel]},vw=(e,r)=>{const{ownerState:t}=e;return[r.input,t.size==="small"&&r.inputSizeSmall,t.multiline&&r.inputMultiline,t.type==="search"&&r.inputTypeSearch,t.startAdornment&&r.inputAdornedStart,t.endAdornment&&r.inputAdornedEnd,t.hiddenLabel&&r.inputHiddenLabel]},b$=e=>{const{classes:r,color:t,disabled:n,error:s,endAdornment:o,focused:i,formControl:c,fullWidth:u,hiddenLabel:l,multiline:d,readOnly:h,size:f,startAdornment:p,type:v}=e,g={root:["root",`color${yr(t)}`,n&&"disabled",s&&"error",u&&"fullWidth",i&&"focused",c&&"formControl",f&&f!=="medium"&&`size${yr(f)}`,d&&"multiline",p&&"adornedStart",o&&"adornedEnd",l&&"hiddenLabel",h&&"readOnly"],input:["input",n&&"disabled",v==="search"&&"inputTypeSearch",d&&"inputMultiline",f==="small"&&"inputSizeSmall",l&&"inputHiddenLabel",p&&"inputAdornedStart",o&&"inputAdornedEnd",h&&"readOnly"]};return nn(g,x$,r)},xw=or("div",{name:"MuiInputBase",slot:"Root",overridesResolver:gw})(cn(({theme:e})=>({...e.typography.body1,color:(e.vars||e).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${Dl.disabled}`]:{color:(e.vars||e).palette.text.disabled,cursor:"default"},variants:[{props:({ownerState:r})=>r.multiline,style:{padding:"4px 0 5px"}},{props:({ownerState:r,size:t})=>r.multiline&&t==="small",style:{paddingTop:1}},{props:({ownerState:r})=>r.fullWidth,style:{width:"100%"}}]}))),bw=or("input",{name:"MuiInputBase",slot:"Input",overridesResolver:vw})(cn(({theme:e})=>{const r=e.palette.mode==="light",t={color:"currentColor",...e.vars?{opacity:e.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5},transition:e.transitions.create("opacity",{duration:e.transitions.duration.shorter})},n={opacity:"0 !important"},s=e.vars?{opacity:e.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5};return{font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%","&::-webkit-input-placeholder":t,"&::-moz-placeholder":t,"&::-ms-input-placeholder":t,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${Dl.formControl} &`]:{"&::-webkit-input-placeholder":n,"&::-moz-placeholder":n,"&::-ms-input-placeholder":n,"&:focus::-webkit-input-placeholder":s,"&:focus::-moz-placeholder":s,"&:focus::-ms-input-placeholder":s},[`&.${Dl.disabled}`]:{opacity:1,WebkitTextFillColor:(e.vars||e).palette.text.disabled},variants:[{props:({ownerState:o})=>!o.disableInjectingGlobalStyles,style:{animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}}},{props:{size:"small"},style:{paddingTop:1}},{props:({ownerState:o})=>o.multiline,style:{height:"auto",resize:"none",padding:0,paddingTop:0}},{props:{type:"search"},style:{MozAppearance:"textfield"}}]}})),L8=qI({"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}),yw=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiInputBase"}),{"aria-describedby":s,autoComplete:o,autoFocus:i,className:c,color:u,components:l={},componentsProps:d={},defaultValue:h,disabled:f,disableInjectingGlobalStyles:p,endAdornment:v,error:g,fullWidth:m=!1,id:b,inputComponent:y="input",inputProps:S={},inputRef:C,margin:L,maxRows:O,minRows:H,multiline:z=!1,name:q,onBlur:D,onChange:W,onClick:P,onFocus:I,onKeyDown:U,onKeyUp:k,placeholder:_,readOnly:R,renderSuffix:j,rows:A,size:N,slotProps:V={},slots:M={},startAdornment:Z,type:J="text",value:re,...X}=n,ne=S.value!=null?S.value:re,{current:Y}=G.useRef(ne!=null),K=G.useRef(),ee=G.useCallback(ft=>{},[]),ue=Ni(K,C,S.ref,ee),[se,ce]=G.useState(!1),fe=Ku(),ve=Jf({props:n,muiFormControl:fe,states:["color","disabled","error","hiddenLabel","size","required","filled"]});ve.focused=fe?fe.focused:se,G.useEffect(()=>{!fe&&f&&se&&(ce(!1),D&&D())},[fe,f,se,D]);const _e=fe&&fe.onFilled,le=fe&&fe.onEmpty,ke=G.useCallback(ft=>{x2(ft)?_e&&_e():le&&le()},[_e,le]);Jc(()=>{Y&&ke({value:ne})},[ne,ke,Y]);const Te=ft=>{I&&I(ft),S.onFocus&&S.onFocus(ft),fe&&fe.onFocus?fe.onFocus(ft):ce(!0)},pe=ft=>{D&&D(ft),S.onBlur&&S.onBlur(ft),fe&&fe.onBlur?fe.onBlur(ft):ce(!1)},ye=(ft,...tr)=>{if(!Y){const Me=ft.target||K.current;if(Me==null)throw new Error(Id(1));ke({value:Me.value})}S.onChange&&S.onChange(ft,...tr),W&&W(ft,...tr)};G.useEffect(()=>{ke(K.current)},[]);const ge=ft=>{K.current&&ft.currentTarget===ft.target&&K.current.focus(),P&&P(ft)};let De=y,He=S;z&&De==="input"&&(A?He={type:void 0,minRows:A,maxRows:A,...He}:He={type:void 0,maxRows:O,minRows:H,...He},De=g$);const Xe=ft=>{ke(ft.animationName==="mui-auto-fill-cancel"?K.current:{value:"x"})};G.useEffect(()=>{fe&&fe.setAdornedStart(!!Z)},[fe,Z]);const at={...n,color:ve.color||"primary",disabled:ve.disabled,endAdornment:v,error:ve.error,focused:ve.focused,formControl:fe,fullWidth:m,hiddenLabel:ve.hiddenLabel,multiline:z,size:ve.size,startAdornment:Z,type:J},dt=b$(at),wt=M.root||l.Root||xw,$t=V.root||d.root||{},Bt=M.input||l.Input||bw;return He={...He,...V.input??d.input},a.jsxs(G.Fragment,{children:[!p&&typeof L8=="function"&&(T8||(T8=a.jsx(L8,{}))),a.jsxs(wt,{...$t,ref:t,onClick:ge,...X,...!vS(wt)&&{ownerState:{...at,...$t.ownerState}},className:Pr(dt.root,$t.className,c,R&&"MuiInputBase-readOnly"),children:[Z,a.jsx(mw.Provider,{value:null,children:a.jsx(Bt,{"aria-invalid":ve.error,"aria-describedby":s,autoComplete:o,autoFocus:i,defaultValue:h,disabled:ve.disabled,id:b,onAnimationStart:Xe,name:q,placeholder:_,readOnly:R,required:ve.required,rows:A,value:ne,onKeyDown:U,onKeyUp:k,type:J,...He,...!vS(Bt)&&{as:De,ownerState:{...at,...He.ownerState}},ref:ue,className:Pr(dt.input,He.className,R&&"MuiInputBase-readOnly"),onBlur:pe,onChange:ye,onFocus:Te})}),v,j?j({...ve,startAdornment:Z}):null]})]})});function y$(e){return an("MuiInput",e)}const Df={...Dl,...un("MuiInput",["root","underline","input"])};function w$(e){return an("MuiOutlinedInput",e)}const uc={...Dl,...un("MuiOutlinedInput",["root","notchedOutline","input"])};function S$(e){return an("MuiFilledInput",e)}const Il={...Dl,...un("MuiFilledInput",["root","underline","input","adornedStart","adornedEnd","sizeSmall","multiline","hiddenLabel"])},y7=Hn(a.jsx("path",{d:"M7 10l5 5 5-5z"}));function _$(e){return an("MuiAutocomplete",e)}const fa=un("MuiAutocomplete",["root","expanded","fullWidth","focused","focusVisible","tag","tagSizeSmall","tagSizeMedium","hasPopupIcon","hasClearIcon","inputRoot","input","inputFocused","endAdornment","clearIndicator","popupIndicator","popupIndicatorOpen","popper","popperDisablePortal","paper","listbox","loading","noOptions","option","groupLabel","groupUl"]);var M8,D8;const A$=e=>{const{classes:r,disablePortal:t,expanded:n,focused:s,fullWidth:o,hasClearIcon:i,hasPopupIcon:c,inputFocused:u,popupOpen:l,size:d}=e,h={root:["root",n&&"expanded",s&&"focused",o&&"fullWidth",i&&"hasClearIcon",c&&"hasPopupIcon"],inputRoot:["inputRoot"],input:["input",u&&"inputFocused"],tag:["tag",`tagSize${yr(d)}`],endAdornment:["endAdornment"],clearIndicator:["clearIndicator"],popupIndicator:["popupIndicator",l&&"popupIndicatorOpen"],popper:["popper",t&&"popperDisablePortal"],paper:["paper"],listbox:["listbox"],loading:["loading"],noOptions:["noOptions"],option:["option"],groupLabel:["groupLabel"],groupUl:["groupUl"]};return nn(h,_$,r)},C$=or("div",{name:"MuiAutocomplete",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e,{fullWidth:n,hasClearIcon:s,hasPopupIcon:o,inputFocused:i,size:c}=t;return[{[`& .${fa.tag}`]:r.tag},{[`& .${fa.tag}`]:r[`tagSize${yr(c)}`]},{[`& .${fa.inputRoot}`]:r.inputRoot},{[`& .${fa.input}`]:r.input},{[`& .${fa.input}`]:i&&r.inputFocused},r.root,n&&r.fullWidth,o&&r.hasPopupIcon,s&&r.hasClearIcon]}})({[`&.${fa.focused} .${fa.clearIndicator}`]:{visibility:"visible"},"@media (pointer: fine)":{[`&:hover .${fa.clearIndicator}`]:{visibility:"visible"}},[`& .${fa.tag}`]:{margin:3,maxWidth:"calc(100% - 6px)"},[`& .${fa.inputRoot}`]:{[`.${fa.hasPopupIcon}&, .${fa.hasClearIcon}&`]:{paddingRight:30},[`.${fa.hasPopupIcon}.${fa.hasClearIcon}&`]:{paddingRight:56},[`& .${fa.input}`]:{width:0,minWidth:30}},[`& .${Df.root}`]:{paddingBottom:1,"& .MuiInput-input":{padding:"4px 4px 4px 0px"}},[`& .${Df.root}.${Dl.sizeSmall}`]:{[`& .${Df.input}`]:{padding:"2px 4px 3px 0"}},[`& .${uc.root}`]:{padding:9,[`.${fa.hasPopupIcon}&, .${fa.hasClearIcon}&`]:{paddingRight:39},[`.${fa.hasPopupIcon}.${fa.hasClearIcon}&`]:{paddingRight:65},[`& .${fa.input}`]:{padding:"7.5px 4px 7.5px 5px"},[`& .${fa.endAdornment}`]:{right:9}},[`& .${uc.root}.${Dl.sizeSmall}`]:{paddingTop:6,paddingBottom:6,paddingLeft:6,[`& .${fa.input}`]:{padding:"2.5px 4px 2.5px 8px"}},[`& .${Il.root}`]:{paddingTop:19,paddingLeft:8,[`.${fa.hasPopupIcon}&, .${fa.hasClearIcon}&`]:{paddingRight:39},[`.${fa.hasPopupIcon}.${fa.hasClearIcon}&`]:{paddingRight:65},[`& .${Il.input}`]:{padding:"7px 4px"},[`& .${fa.endAdornment}`]:{right:9}},[`& .${Il.root}.${Dl.sizeSmall}`]:{paddingBottom:1,[`& .${Il.input}`]:{padding:"2.5px 4px"}},[`& .${Dl.hiddenLabel}`]:{paddingTop:8},[`& .${Il.root}.${Dl.hiddenLabel}`]:{paddingTop:0,paddingBottom:0,[`& .${fa.input}`]:{paddingTop:16,paddingBottom:17}},[`& .${Il.root}.${Dl.hiddenLabel}.${Dl.sizeSmall}`]:{[`& .${fa.input}`]:{paddingTop:8,paddingBottom:9}},[`& .${fa.input}`]:{flexGrow:1,textOverflow:"ellipsis",opacity:0},variants:[{props:{fullWidth:!0},style:{width:"100%"}},{props:{size:"small"},style:{[`& .${fa.tag}`]:{margin:2,maxWidth:"calc(100% - 4px)"}}},{props:{inputFocused:!0},style:{[`& .${fa.input}`]:{opacity:1}}},{props:{multiple:!0},style:{[`& .${fa.inputRoot}`]:{flexWrap:"wrap"}}}]}),j$=or("div",{name:"MuiAutocomplete",slot:"EndAdornment"})({position:"absolute",right:0,top:"50%",transform:"translate(0, -50%)"}),k$=or(sn,{name:"MuiAutocomplete",slot:"ClearIndicator"})({marginRight:-2,padding:4,visibility:"hidden"}),R$=or(sn,{name:"MuiAutocomplete",slot:"PopupIndicator",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.popupIndicator,t.popupOpen&&r.popupIndicatorOpen]}})({padding:2,marginRight:-2,variants:[{props:{popupOpen:!0},style:{transform:"rotate(180deg)"}}]}),E$=or(pw,{name:"MuiAutocomplete",slot:"Popper",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[{[`& .${fa.option}`]:r.option},r.popper,t.disablePortal&&r.popperDisablePortal]}})(cn(({theme:e})=>({zIndex:(e.vars||e).zIndex.modal,variants:[{props:{disablePortal:!0},style:{position:"absolute"}}]}))),N$=or(sa,{name:"MuiAutocomplete",slot:"Paper"})(cn(({theme:e})=>({...e.typography.body1,overflow:"auto"}))),T$=or("div",{name:"MuiAutocomplete",slot:"Loading"})(cn(({theme:e})=>({color:(e.vars||e).palette.text.secondary,padding:"14px 16px"}))),L$=or("div",{name:"MuiAutocomplete",slot:"NoOptions"})(cn(({theme:e})=>({color:(e.vars||e).palette.text.secondary,padding:"14px 16px"}))),M$=or("ul",{name:"MuiAutocomplete",slot:"Listbox"})(cn(({theme:e})=>({listStyle:"none",margin:0,padding:"8px 0",maxHeight:"40vh",overflow:"auto",position:"relative",[`& .${fa.option}`]:{minHeight:48,display:"flex",overflow:"hidden",justifyContent:"flex-start",alignItems:"center",cursor:"pointer",paddingTop:6,boxSizing:"border-box",outline:"0",WebkitTapHighlightColor:"transparent",paddingBottom:6,paddingLeft:16,paddingRight:16,[e.breakpoints.up("sm")]:{minHeight:"auto"},[`&.${fa.focused}`]:{backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},'&[aria-disabled="true"]':{opacity:(e.vars||e).palette.action.disabledOpacity,pointerEvents:"none"},[`&.${fa.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},'&[aria-selected="true"]':{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:Ca(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${fa.focused}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:Ca(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(e.vars||e).palette.action.selected}},[`&.${fa.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:Ca(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}}}}))),D$=or(CS,{name:"MuiAutocomplete",slot:"GroupLabel"})(cn(({theme:e})=>({backgroundColor:(e.vars||e).palette.background.paper,top:-8}))),I$=or("ul",{name:"MuiAutocomplete",slot:"GroupUl"})({padding:0,[`& .${fa.option}`]:{paddingLeft:24}}),bc=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiAutocomplete"}),{autoComplete:s=!1,autoHighlight:o=!1,autoSelect:i=!1,blurOnSelect:c=!1,ChipProps:u,className:l,clearIcon:d=M8||(M8=a.jsx(x7,{fontSize:"small"})),clearOnBlur:h=!n.freeSolo,clearOnEscape:f=!1,clearText:p="Clear",closeText:v="Close",componentsProps:g,defaultValue:m=n.multiple?[]:null,disableClearable:b=!1,disableCloseOnSelect:y=!1,disabled:S=!1,disabledItemsFocusable:C=!1,disableListWrap:L=!1,disablePortal:O=!1,filterOptions:H,filterSelectedOptions:z=!1,forcePopupIcon:q="auto",freeSolo:D=!1,fullWidth:W=!1,getLimitTagsText:P=zt=>`+${zt}`,getOptionDisabled:I,getOptionKey:U,getOptionLabel:k,isOptionEqualToValue:_,groupBy:R,handleHomeEndKeys:j=!n.freeSolo,id:A,includeInputInList:N=!1,inputValue:V,limitTags:M=-1,ListboxComponent:Z,ListboxProps:J,loading:re=!1,loadingText:X="Loading",multiple:ne=!1,noOptionsText:Y="No options",onChange:K,onClose:ee,onHighlightChange:ue,onInputChange:se,onOpen:ce,open:fe,openOnFocus:ve=!1,openText:_e="Open",options:le,PaperComponent:ke,PopperComponent:Te,popupIcon:pe=D8||(D8=a.jsx(y7,{})),readOnly:ye=!1,renderGroup:ge,renderInput:De,renderOption:He,renderTags:Xe,renderValue:at,selectOnFocus:dt=!n.freeSolo,size:wt="medium",slots:$t={},slotProps:Bt={},value:ft,...tr}=n,{getRootProps:Me,getInputProps:tt,getInputLabelProps:Ze,getPopupIndicatorProps:St,getClearProps:et,getItemProps:Ht,getListboxProps:Nt,getOptionProps:kt,value:kr,dirty:Jt,expanded:Pt,id:Ur,popupOpen:Lr,focused:vt,focusedItem:nr,anchorEl:Cr,setAnchorEl:Dt,inputValue:je,groupedOptions:ct}=s$({...n,componentName:"Autocomplete"}),nt=!b&&!S&&Jt&&!ye,Pe=(!D||q===!0)&&q!==!1,{onMouseDown:Qe}=tt(),{ref:gt,...xe}=Nt(),Ce=k||(zt=>zt.label??zt),de={...n,disablePortal:O,expanded:Pt,focused:vt,fullWidth:W,getOptionLabel:Ce,hasClearIcon:nt,hasPopupIcon:Pe,inputFocused:nr===-1,popupOpen:Lr,size:wt},be=A$(de),Se={slots:{paper:ke,popper:Te,...$t},slotProps:{chip:u,listbox:J,...g,...Bt}},[Ne,ze]=ln("listbox",{elementType:M$,externalForwardedProps:Se,ownerState:de,className:be.listbox,additionalProps:xe,ref:gt}),[Re,Ie]=ln("paper",{elementType:sa,externalForwardedProps:Se,ownerState:de,className:be.paper}),[ae,we]=ln("popper",{elementType:pw,externalForwardedProps:Se,ownerState:de,className:be.popper,additionalProps:{disablePortal:O,style:{width:Cr?Cr.clientWidth:null},role:"presentation",anchorEl:Cr,open:Lr}});let Fe;const Ye=zt=>({className:be.tag,disabled:S,...Ht(zt)});if(Xe&&ne&&kr.length>0?Fe=Xe(kr,Ye,de):at&&kr?Fe=at(kr,Ye,de):ne&&kr.length>0&&(Fe=kr.map((zt,Vt)=>{const{key:Ar,...wr}=Ye({index:Vt});return a.jsx(b7,{label:Ce(zt),size:wt,...wr,...Se.slotProps.chip},Ar)})),M>-1&&Array.isArray(Fe)){const zt=Fe.length-M;!vt&&zt>0&&(Fe=Fe.splice(0,M),Fe.push(a.jsx("span",{className:be.tag,children:P(zt)},Fe.length)))}const Be=ge||(zt=>a.jsxs("li",{children:[a.jsx(D$,{className:be.groupLabel,ownerState:de,component:"div",children:zt.group}),a.jsx(I$,{className:be.groupUl,ownerState:de,children:zt.children})]},zt.key)),mt=He||((zt,Vt)=>{const{key:Ar,...wr}=zt;return a.jsx("li",{...wr,children:Ce(Vt)},Ar)}),_t=(zt,Vt)=>{const Ar=kt({option:zt,index:Vt});return mt({...Ar,className:be.option},zt,{selected:Ar["aria-selected"],index:Vt,inputValue:je},de)},ot=Se.slotProps.clearIndicator,xt=Se.slotProps.popupIndicator;return a.jsxs(G.Fragment,{children:[a.jsx(C$,{ref:t,className:Pr(be.root,l),ownerState:de,...Me(tr),children:De({id:Ur,disabled:S,fullWidth:!0,size:wt==="small"?"small":void 0,InputLabelProps:Ze(),InputProps:{ref:Dt,className:be.inputRoot,startAdornment:Fe,onMouseDown:zt=>{zt.target===zt.currentTarget&&Qe(zt)},...(nt||Pe)&&{endAdornment:a.jsxs(j$,{className:be.endAdornment,ownerState:de,children:[nt?a.jsx(k$,{...et(),"aria-label":p,title:p,ownerState:de,...ot,className:Pr(be.clearIndicator,ot==null?void 0:ot.className),children:d}):null,Pe?a.jsx(R$,{...St(),disabled:S,"aria-label":Lr?v:_e,title:Lr?v:_e,ownerState:de,...xt,className:Pr(be.popupIndicator,xt==null?void 0:xt.className),children:pe}):null]})}},inputProps:{className:be.input,disabled:S,readOnly:ye,...tt()}})}),Cr?a.jsx(E$,{as:ae,...we,children:a.jsxs(N$,{as:Re,...Ie,children:[re&&ct.length===0?a.jsx(T$,{className:be.loading,ownerState:de,children:X}):null,ct.length===0&&!D&&!re?a.jsx(L$,{className:be.noOptions,ownerState:de,role:"presentation",onMouseDown:zt=>{zt.preventDefault()},children:Y}):null,ct.length>0?a.jsx(Ne,{as:Z,...ze,children:ct.map((zt,Vt)=>R?Be({key:zt.key,group:zt.group,children:zt.options.map((Ar,wr)=>_t(Ar,zt.index+wr))}):_t(zt,Vt))}):null]})}):null]})}),O$=Hn(a.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}));function P$(e){return an("MuiAvatar",e)}un("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const F$=e=>{const{classes:r,variant:t,colorDefault:n}=e;return nn({root:["root",t,n&&"colorDefault"],img:["img"],fallback:["fallback"]},P$,r)},B$=or("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,r[t.variant],t.colorDefault&&r.colorDefault]}})(cn(({theme:e})=>({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:e.typography.fontFamily,fontSize:e.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(e.vars||e).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:{color:(e.vars||e).palette.background.default,...e.vars?{backgroundColor:e.vars.palette.Avatar.defaultBg}:{backgroundColor:e.palette.grey[400],...e.applyStyles("dark",{backgroundColor:e.palette.grey[600]})}}}]}))),z$=or("img",{name:"MuiAvatar",slot:"Img"})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),$$=or(O$,{name:"MuiAvatar",slot:"Fallback"})({width:"75%",height:"75%"});function U$({crossOrigin:e,referrerPolicy:r,src:t,srcSet:n}){const[s,o]=G.useState(!1);return G.useEffect(()=>{if(!t&&!n)return;o(!1);let i=!0;const c=new Image;return c.onload=()=>{i&&o("loaded")},c.onerror=()=>{i&&o("error")},c.crossOrigin=e,c.referrerPolicy=r,c.src=t,n&&(c.srcset=n),()=>{i=!1}},[e,r,t,n]),s}const H$=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiAvatar"}),{alt:s,children:o,className:i,component:c="div",slots:u={},slotProps:l={},imgProps:d,sizes:h,src:f,srcSet:p,variant:v="circular",...g}=n;let m=null;const b={...n,component:c,variant:v},y=U$({...d,...typeof l.img=="function"?l.img(b):l.img,src:f,srcSet:p}),S=f||p,C=S&&y!=="error";b.colorDefault=!C,delete b.ownerState;const L=F$(b),[O,H]=ln("root",{ref:t,className:Pr(L.root,i),elementType:B$,externalForwardedProps:{slots:u,slotProps:l,component:c,...g},ownerState:b}),[z,q]=ln("img",{className:L.img,elementType:z$,externalForwardedProps:{slots:u,slotProps:{img:{...d,...l.img}}},additionalProps:{alt:s,src:f,srcSet:p,sizes:h},ownerState:b}),[D,W]=ln("fallback",{className:L.fallback,elementType:$$,externalForwardedProps:{slots:u,slotProps:l},shouldForwardComponentProp:!0,ownerState:b});return C?m=a.jsx(z,{...q}):o||o===0?m=o:S&&s?m=s[0]:m=a.jsx(D,{...W}),a.jsx(O,{...H,children:m})});function V$(e){return an("PrivateSwitchBase",e)}un("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const W$=e=>{const{classes:r,checked:t,disabled:n,edge:s}=e,o={root:["root",t&&"checked",n&&"disabled",s&&`edge${yr(s)}`],input:["input"]};return nn(o,V$,r)},q$=or($f)({padding:9,borderRadius:"50%",variants:[{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:({edge:e,ownerState:r})=>e==="start"&&r.size!=="small",style:{marginLeft:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}},{props:({edge:e,ownerState:r})=>e==="end"&&r.size!=="small",style:{marginRight:-12}}]}),G$=or("input",{shouldForwardProp:xl})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),K$=G.forwardRef(function(r,t){const{autoFocus:n,checked:s,checkedIcon:o,defaultChecked:i,disabled:c,disableFocusRipple:u=!1,edge:l=!1,icon:d,id:h,inputProps:f,inputRef:p,name:v,onBlur:g,onChange:m,onFocus:b,readOnly:y,required:S=!1,tabIndex:C,type:L,value:O,slots:H={},slotProps:z={},...q}=r,[D,W]=A0({controlled:s,default:!!i,name:"SwitchBase",state:"checked"}),P=Ku(),I=re=>{b&&b(re),P&&P.onFocus&&P.onFocus(re)},U=re=>{g&&g(re),P&&P.onBlur&&P.onBlur(re)},k=re=>{if(re.nativeEvent.defaultPrevented)return;const X=re.target.checked;W(X),m&&m(re,X)};let _=c;P&&typeof _>"u"&&(_=P.disabled);const R=L==="checkbox"||L==="radio",j={...r,checked:D,disabled:_,disableFocusRipple:u,edge:l},A=W$(j),N={slots:H,slotProps:{input:f,...z}},[V,M]=ln("root",{ref:t,elementType:q$,className:A.root,shouldForwardComponentProp:!0,externalForwardedProps:{...N,component:"span",...q},getSlotProps:re=>({...re,onFocus:X=>{var ne;(ne=re.onFocus)==null||ne.call(re,X),I(X)},onBlur:X=>{var ne;(ne=re.onBlur)==null||ne.call(re,X),U(X)}}),ownerState:j,additionalProps:{centerRipple:!0,focusRipple:!u,disabled:_,role:void 0,tabIndex:null}}),[Z,J]=ln("input",{ref:p,elementType:G$,className:A.input,externalForwardedProps:N,getSlotProps:re=>({...re,onChange:X=>{var ne;(ne=re.onChange)==null||ne.call(re,X),k(X)}}),ownerState:j,additionalProps:{autoFocus:n,checked:s,defaultChecked:i,disabled:_,id:R?h:void 0,name:v,readOnly:y,required:S,tabIndex:C,type:L,...L==="checkbox"&&O===void 0?{}:{value:O}}});return a.jsxs(V,{...M,children:[a.jsx(Z,{...J}),D?o:d]})}),X$=Hn(a.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"})),Y$=Hn(a.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})),Z$=Hn(a.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}));function J$(e){return an("MuiCheckbox",e)}const n3=un("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),Q$=e=>{const{classes:r,indeterminate:t,color:n,size:s}=e,o={root:["root",t&&"indeterminate",`color${yr(n)}`,`size${yr(s)}`]},i=nn(o,J$,r);return{...r,...i}},eU=or(K$,{shouldForwardProp:e=>xl(e)||e==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,t.indeterminate&&r.indeterminate,r[`size${yr(t.size)}`],t.color!=="default"&&r[`color${yr(t.color)}`]]}})(cn(({theme:e})=>({color:(e.vars||e).palette.text.secondary,variants:[{props:{color:"default",disableRipple:!1},style:{"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:Ca(e.palette.action.active,e.palette.action.hoverOpacity)}}},...Object.entries(e.palette).filter(qi()).map(([r])=>({props:{color:r,disableRipple:!1},style:{"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette[r].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:Ca(e.palette[r].main,e.palette.action.hoverOpacity)}}})),...Object.entries(e.palette).filter(qi()).map(([r])=>({props:{color:r},style:{[`&.${n3.checked}, &.${n3.indeterminate}`]:{color:(e.vars||e).palette[r].main},[`&.${n3.disabled}`]:{color:(e.vars||e).palette.action.disabled}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]}))),tU=a.jsx(Y$,{}),rU=a.jsx(X$,{}),nU=a.jsx(Z$,{}),Wn=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiCheckbox"}),{checkedIcon:s=tU,color:o="primary",icon:i=rU,indeterminate:c=!1,indeterminateIcon:u=nU,inputProps:l,size:d="medium",disableRipple:h=!1,className:f,slots:p={},slotProps:v={},...g}=n,m=c?u:i,b=c?u:s,y={...n,disableRipple:h,color:o,indeterminate:c,size:d},S=Q$(y),C=v.input??l,[L,O]=ln("root",{ref:t,elementType:eU,className:Pr(S.root,f),shouldForwardComponentProp:!0,externalForwardedProps:{slots:p,slotProps:v,...g},ownerState:y,additionalProps:{type:"checkbox",icon:G.cloneElement(m,{fontSize:m.props.fontSize??d}),checkedIcon:G.cloneElement(b,{fontSize:b.props.fontSize??d}),disableRipple:h,slots:p,slotProps:{input:Ik(typeof C=="function"?C(y):C,{"data-indeterminate":c})}}});return a.jsx(L,{...O,classes:S})});function I8(e){return e.substring(2).toLowerCase()}function aU(e,r){return r.documentElement.clientWidth<e.clientX||r.documentElement.clientHeight<e.clientY}function sU(e){const{children:r,disableReactTree:t=!1,mouseEvent:n="onClick",onClickAway:s,touchEvent:o="onTouchEnd"}=e,i=G.useRef(!1),c=G.useRef(null),u=G.useRef(!1),l=G.useRef(!1);G.useEffect(()=>(setTimeout(()=>{u.current=!0},0),()=>{u.current=!1}),[]);const d=Ni(V0(r),c),h=Di(v=>{const g=l.current;l.current=!1;const m=co(c.current);if(!u.current||!c.current||"clientX"in v&&aU(v,m))return;if(i.current){i.current=!1;return}let b;v.composedPath?b=v.composedPath().includes(c.current):b=!m.documentElement.contains(v.target)||c.current.contains(v.target),!b&&(t||!g)&&s(v)}),f=v=>g=>{l.current=!0;const m=r.props[v];m&&m(g)},p={ref:d};return o!==!1&&(p[o]=f(o)),G.useEffect(()=>{if(o!==!1){const v=I8(o),g=co(c.current),m=()=>{i.current=!0};return g.addEventListener(v,h),g.addEventListener("touchmove",m),()=>{g.removeEventListener(v,h),g.removeEventListener("touchmove",m)}}},[h,o]),n!==!1&&(p[n]=f(n)),G.useEffect(()=>{if(n!==!1){const v=I8(n),g=co(c.current);return g.addEventListener(v,h),()=>{g.removeEventListener(v,h)}}},[h,n]),G.cloneElement(r,p)}const b2=VD({createStyledComponent:or("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,r[`maxWidth${yr(String(t.maxWidth))}`],t.fixed&&r.fixed,t.disableGutters&&r.disableGutters]}}),useThemeProps:e=>dn({props:e,name:"MuiContainer"})});function iU(e){return an("MuiDialog",e)}const a3=un("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),w7=G.createContext({}),oU=or(Xk,{name:"MuiDialog",slot:"Backdrop",overrides:(e,r)=>r.backdrop})({zIndex:-1}),lU=e=>{const{classes:r,scroll:t,maxWidth:n,fullWidth:s,fullScreen:o}=e,i={root:["root"],container:["container",`scroll${yr(t)}`],paper:["paper",`paperScroll${yr(t)}`,`paperWidth${yr(String(n))}`,s&&"paperFullWidth",o&&"paperFullScreen"]};return nn(i,iU,r)},cU=or(Yk,{name:"MuiDialog",slot:"Root"})({"@media print":{position:"absolute !important"}}),uU=or("div",{name:"MuiDialog",slot:"Container",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.container,r[`scroll${yr(t.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),dU=or(sa,{name:"MuiDialog",slot:"Paper",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.paper,r[`scrollPaper${yr(t.scroll)}`],r[`paperWidth${yr(String(t.maxWidth))}`],t.fullWidth&&r.paperFullWidth,t.fullScreen&&r.paperFullScreen]}})(cn(({theme:e})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:r})=>!r.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:e.breakpoints.unit==="px"?Math.max(e.breakpoints.values.xs,444):`max(${e.breakpoints.values.xs}${e.breakpoints.unit}, 444px)`,[`&.${a3.paperScrollBody}`]:{[e.breakpoints.down(Math.max(e.breakpoints.values.xs,444)+32*2)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(e.breakpoints.values).filter(r=>r!=="xs").map(r=>({props:{maxWidth:r},style:{maxWidth:`${e.breakpoints.values[r]}${e.breakpoints.unit}`,[`&.${a3.paperScrollBody}`]:{[e.breakpoints.down(e.breakpoints.values[r]+32*2)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:r})=>r.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:r})=>r.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${a3.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),Oa=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiDialog"}),s=Kf(),o={enter:s.transitions.duration.enteringScreen,exit:s.transitions.duration.leavingScreen},{"aria-describedby":i,"aria-labelledby":c,"aria-modal":u=!0,BackdropComponent:l,BackdropProps:d,children:h,className:f,disableEscapeKeyDown:p=!1,fullScreen:v=!1,fullWidth:g=!1,maxWidth:m="sm",onClick:b,onClose:y,open:S,PaperComponent:C=sa,PaperProps:L={},scroll:O="paper",slots:H={},slotProps:z={},TransitionComponent:q=bS,transitionDuration:D=o,TransitionProps:W,...P}=n,I={...n,disableEscapeKeyDown:p,fullScreen:v,fullWidth:g,maxWidth:m,scroll:O},U=lU(I),k=G.useRef(),_=ce=>{k.current=ce.target===ce.currentTarget},R=ce=>{b&&b(ce),k.current&&(k.current=null,y&&y(ce,"backdropClick"))},j=Od(c),A=G.useMemo(()=>({titleId:j}),[j]),N={transition:q,...H},V={transition:W,paper:L,backdrop:d,...z},M={slots:N,slotProps:V},[Z,J]=ln("root",{elementType:cU,shouldForwardComponentProp:!0,externalForwardedProps:M,ownerState:I,className:Pr(U.root,f),ref:t}),[re,X]=ln("backdrop",{elementType:oU,shouldForwardComponentProp:!0,externalForwardedProps:M,ownerState:I}),[ne,Y]=ln("paper",{elementType:dU,shouldForwardComponentProp:!0,externalForwardedProps:M,ownerState:I,className:Pr(U.paper,L.className)}),[K,ee]=ln("container",{elementType:uU,externalForwardedProps:M,ownerState:I,className:U.container}),[ue,se]=ln("transition",{elementType:bS,externalForwardedProps:M,ownerState:I,additionalProps:{appear:!0,in:S,timeout:D,role:"presentation"}});return a.jsx(Z,{closeAfterTransition:!0,slots:{backdrop:re},slotProps:{backdrop:{transitionDuration:D,as:l,...X}},disableEscapeKeyDown:p,onClose:y,open:S,onClick:R,...J,...P,children:a.jsx(ue,{...se,children:a.jsx(K,{onMouseDown:_,...ee,children:a.jsx(ne,{as:C,elevation:24,role:"dialog","aria-describedby":i,"aria-labelledby":j,"aria-modal":u,...Y,children:a.jsx(w7.Provider,{value:A,children:h})})})})})});function fU(e){return an("MuiDialogActions",e)}un("MuiDialogActions",["root","spacing"]);const hU=e=>{const{classes:r,disableSpacing:t}=e;return nn({root:["root",!t&&"spacing"]},fU,r)},pU=or("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,!t.disableSpacing&&r.spacing]}})({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto",variants:[{props:({ownerState:e})=>!e.disableSpacing,style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),Va=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiDialogActions"}),{className:s,disableSpacing:o=!1,...i}=n,c={...n,disableSpacing:o},u=hU(c);return a.jsx(pU,{className:Pr(u.root,s),ownerState:c,ref:t,...i})});function mU(e){return an("MuiDialogContent",e)}un("MuiDialogContent",["root","dividers"]);function gU(e){return an("MuiDialogTitle",e)}const vU=un("MuiDialogTitle",["root"]),xU=e=>{const{classes:r,dividers:t}=e;return nn({root:["root",t&&"dividers"]},mU,r)},bU=or("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,t.dividers&&r.dividers]}})(cn(({theme:e})=>({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px",variants:[{props:({ownerState:r})=>r.dividers,style:{padding:"16px 24px",borderTop:`1px solid ${(e.vars||e).palette.divider}`,borderBottom:`1px solid ${(e.vars||e).palette.divider}`}},{props:({ownerState:r})=>!r.dividers,style:{[`.${vU.root} + &`]:{paddingTop:0}}}]}))),Pa=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiDialogContent"}),{className:s,dividers:o=!1,...i}=n,c={...n,dividers:o},u=xU(c);return a.jsx(bU,{className:Pr(u.root,s),ownerState:c,ref:t,...i})}),yU=e=>{const{classes:r}=e;return nn({root:["root"]},gU,r)},wU=or(Et,{name:"MuiDialogTitle",slot:"Root"})({padding:"16px 24px",flex:"0 0 auto"}),Wa=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiDialogTitle"}),{className:s,id:o,...i}=n,c=n,u=yU(c),{titleId:l=o}=G.useContext(w7);return a.jsx(wU,{component:"h2",className:Pr(u.root,s),ownerState:c,ref:t,variant:"h6",id:o??l,...i})}),SU=e=>{const{classes:r,disableUnderline:t,startAdornment:n,endAdornment:s,size:o,hiddenLabel:i,multiline:c}=e,u={root:["root",!t&&"underline",n&&"adornedStart",s&&"adornedEnd",o==="small"&&`size${yr(o)}`,i&&"hiddenLabel",c&&"multiline"],input:["input"]},l=nn(u,S$,r);return{...r,...l}},_U=or(xw,{shouldForwardProp:e=>xl(e)||e==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[...gw(e,r),!t.disableUnderline&&r.underline]}})(cn(({theme:e})=>{const r=e.palette.mode==="light",t=r?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",n=r?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",s=r?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",o=r?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return{position:"relative",backgroundColor:e.vars?e.vars.palette.FilledInput.bg:n,borderTopLeftRadius:(e.vars||e).shape.borderRadius,borderTopRightRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),"&:hover":{backgroundColor:e.vars?e.vars.palette.FilledInput.hoverBg:s,"@media (hover: none)":{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:n}},[`&.${Il.focused}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:n},[`&.${Il.disabled}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.disabledBg:o},variants:[{props:({ownerState:i})=>!i.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Il.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Il.error}`]:{"&::before, &::after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / ${e.vars.opacity.inputUnderline})`:t}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Il.disabled}, .${Il.error}):before`]:{borderBottom:`1px solid ${(e.vars||e).palette.text.primary}`},[`&.${Il.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(e.palette).filter(qi()).map(([i])=>{var c;return{props:{disableUnderline:!1,color:i},style:{"&::after":{borderBottom:`2px solid ${(c=(e.vars||e).palette[i])==null?void 0:c.main}`}}}}),{props:({ownerState:i})=>i.startAdornment,style:{paddingLeft:12}},{props:({ownerState:i})=>i.endAdornment,style:{paddingRight:12}},{props:({ownerState:i})=>i.multiline,style:{padding:"25px 12px 8px"}},{props:({ownerState:i,size:c})=>i.multiline&&c==="small",style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:i})=>i.multiline&&i.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:i})=>i.multiline&&i.hiddenLabel&&i.size==="small",style:{paddingTop:8,paddingBottom:9}}]}})),AU=or(bw,{name:"MuiFilledInput",slot:"Input",overridesResolver:vw})(cn(({theme:e})=>({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12,...!e.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:e.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:e.palette.mode==="light"?null:"#fff",caretColor:e.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},...e.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[e.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:r})=>r.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:r})=>r.startAdornment,style:{paddingLeft:0}},{props:({ownerState:r})=>r.endAdornment,style:{paddingRight:0}},{props:({ownerState:r})=>r.hiddenLabel&&r.size==="small",style:{paddingTop:8,paddingBottom:9}},{props:({ownerState:r})=>r.multiline,style:{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}}]}))),I6=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiFilledInput"}),{disableUnderline:s=!1,components:o={},componentsProps:i,fullWidth:c=!1,hiddenLabel:u,inputComponent:l="input",multiline:d=!1,slotProps:h,slots:f={},type:p="text",...v}=n,g={...n,disableUnderline:s,fullWidth:c,inputComponent:l,multiline:d,type:p},m=SU(n),b={root:{ownerState:g},input:{ownerState:g}},y=h??i?Ki(b,h??i):b,S=f.root??o.Root??_U,C=f.input??o.Input??AU;return a.jsx(yw,{slots:{root:S,input:C},slotProps:y,fullWidth:c,inputComponent:l,multiline:d,ref:t,type:p,...v,classes:m})});I6.muiName="Input";function CU(e){return an("MuiFormControl",e)}un("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const jU=e=>{const{classes:r,margin:t,fullWidth:n}=e,s={root:["root",t!=="none"&&`margin${yr(t)}`,n&&"fullWidth"]};return nn(s,CU,r)},kU=or("div",{name:"MuiFormControl",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,r[`margin${yr(t.margin)}`],t.fullWidth&&r.fullWidth]}})({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top",variants:[{props:{margin:"normal"},style:{marginTop:16,marginBottom:8}},{props:{margin:"dense"},style:{marginTop:8,marginBottom:4}},{props:{fullWidth:!0},style:{width:"100%"}}]}),O6=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiFormControl"}),{children:s,className:o,color:i="primary",component:c="div",disabled:u=!1,error:l=!1,focused:d,fullWidth:h=!1,hiddenLabel:f=!1,margin:p="none",required:v=!1,size:g="medium",variant:m="outlined",...b}=n,y={...n,color:i,component:c,disabled:u,error:l,fullWidth:h,hiddenLabel:f,margin:p,required:v,size:g,variant:m},S=jU(y),[C,L]=G.useState(()=>{let k=!1;return s&&G.Children.forEach(s,_=>{if(!Xy(_,["Input","Select"]))return;const R=Xy(_,["Select"])?_.props.input:_;R&&v$(R.props)&&(k=!0)}),k}),[O,H]=G.useState(()=>{let k=!1;return s&&G.Children.forEach(s,_=>{Xy(_,["Input","Select"])&&(x2(_.props,!0)||x2(_.props.inputProps,!0))&&(k=!0)}),k}),[z,q]=G.useState(!1);u&&z&&q(!1);const D=d!==void 0&&!u?d:z;let W;G.useRef(!1);const P=G.useCallback(()=>{H(!0)},[]),I=G.useCallback(()=>{H(!1)},[]),U=G.useMemo(()=>({adornedStart:C,setAdornedStart:L,color:i,disabled:u,error:l,filled:O,focused:D,fullWidth:h,hiddenLabel:f,size:g,onBlur:()=>{q(!1)},onFocus:()=>{q(!0)},onEmpty:I,onFilled:P,registerEffect:W,required:v,variant:m}),[C,i,u,l,O,D,h,f,W,I,P,v,g,m]);return a.jsx(mw.Provider,{value:U,children:a.jsx(kU,{as:c,ownerState:y,className:Pr(S.root,o),ref:t,...b,children:s})})});function RU(e){return an("MuiFormControlLabel",e)}const J1=un("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),EU=e=>{const{classes:r,disabled:t,labelPlacement:n,error:s,required:o}=e,i={root:["root",t&&"disabled",`labelPlacement${yr(n)}`,s&&"error",o&&"required"],label:["label",t&&"disabled"],asterisk:["asterisk",s&&"error"]};return nn(i,RU,r)},NU=or("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[{[`& .${J1.label}`]:r.label},r.root,r[`labelPlacement${yr(t.labelPlacement)}`]]}})(cn(({theme:e})=>({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${J1.disabled}`]:{cursor:"default"},[`& .${J1.label}`]:{[`&.${J1.disabled}`]:{color:(e.vars||e).palette.text.disabled}},variants:[{props:{labelPlacement:"start"},style:{flexDirection:"row-reverse",marginRight:-11}},{props:{labelPlacement:"top"},style:{flexDirection:"column-reverse"}},{props:{labelPlacement:"bottom"},style:{flexDirection:"column"}},{props:({labelPlacement:r})=>r==="start"||r==="top"||r==="bottom",style:{marginLeft:16}}]}))),TU=or("span",{name:"MuiFormControlLabel",slot:"Asterisk"})(cn(({theme:e})=>({[`&.${J1.error}`]:{color:(e.vars||e).palette.error.main}}))),As=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiFormControlLabel"}),{checked:s,className:o,componentsProps:i={},control:c,disabled:u,disableTypography:l,inputRef:d,label:h,labelPlacement:f="end",name:p,onChange:v,required:g,slots:m={},slotProps:b={},value:y,...S}=n,C=Ku(),L=u??c.props.disabled??(C==null?void 0:C.disabled),O=g??c.props.required,H={disabled:L,required:O};["checked","name","onChange","value","inputRef"].forEach(k=>{typeof c.props[k]>"u"&&typeof n[k]<"u"&&(H[k]=n[k])});const z=Jf({props:n,muiFormControl:C,states:["error"]}),q={...n,disabled:L,labelPlacement:f,required:O,error:z.error},D=EU(q),W={slots:m,slotProps:{...i,...b}},[P,I]=ln("typography",{elementType:Et,externalForwardedProps:W,ownerState:q});let U=h;return U!=null&&U.type!==Et&&!l&&(U=a.jsx(P,{component:"span",...I,className:Pr(D.label,I==null?void 0:I.className),children:U})),a.jsxs(NU,{className:Pr(D.root,o),ownerState:q,ref:t,...S,children:[G.cloneElement(c,H),O?a.jsxs("div",{children:[U,a.jsxs(TU,{ownerState:q,"aria-hidden":!0,className:D.asterisk,children:["","*"]})]}):U]})});function LU(e){return an("MuiFormGroup",e)}un("MuiFormGroup",["root","row","error"]);const MU=e=>{const{classes:r,row:t,error:n}=e;return nn({root:["root",t&&"row",n&&"error"]},LU,r)},DU=or("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,t.row&&r.row]}})({display:"flex",flexDirection:"column",flexWrap:"wrap",variants:[{props:{row:!0},style:{flexDirection:"row"}}]}),IU=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiFormGroup"}),{className:s,row:o=!1,...i}=n,c=Ku(),u=Jf({props:n,muiFormControl:c,states:["error"]}),l={...n,row:o,error:u.error},d=MU(l);return a.jsx(DU,{className:Pr(d.root,s),ownerState:l,ref:t,...i})});function OU(e){return an("MuiFormHelperText",e)}const O8=un("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var P8;const PU=e=>{const{classes:r,contained:t,size:n,disabled:s,error:o,filled:i,focused:c,required:u}=e,l={root:["root",s&&"disabled",o&&"error",n&&`size${yr(n)}`,t&&"contained",c&&"focused",i&&"filled",u&&"required"]};return nn(l,OU,r)},FU=or("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,t.size&&r[`size${yr(t.size)}`],t.contained&&r.contained,t.filled&&r.filled]}})(cn(({theme:e})=>({color:(e.vars||e).palette.text.secondary,...e.typography.caption,textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${O8.disabled}`]:{color:(e.vars||e).palette.text.disabled},[`&.${O8.error}`]:{color:(e.vars||e).palette.error.main},variants:[{props:{size:"small"},style:{marginTop:4}},{props:({ownerState:r})=>r.contained,style:{marginLeft:14,marginRight:14}}]}))),BU=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiFormHelperText"}),{children:s,className:o,component:i="p",disabled:c,error:u,filled:l,focused:d,margin:h,required:f,variant:p,...v}=n,g=Ku(),m=Jf({props:n,muiFormControl:g,states:["variant","size","disabled","error","filled","focused","required"]}),b={...n,component:i,contained:m.variant==="filled"||m.variant==="outlined",variant:m.variant,size:m.size,disabled:m.disabled,error:m.error,filled:m.filled,focused:m.focused,required:m.required};delete b.ownerState;const y=PU(b);return a.jsx(FU,{as:i,className:Pr(y.root,o),ref:t,...v,ownerState:b,children:s===" "?P8||(P8=a.jsx("span",{className:"notranslate","aria-hidden":!0,children:""})):s})});function zU(e){return an("MuiFormLabel",e)}const uv=un("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),$U=e=>{const{classes:r,color:t,focused:n,disabled:s,error:o,filled:i,required:c}=e,u={root:["root",`color${yr(t)}`,s&&"disabled",o&&"error",i&&"filled",n&&"focused",c&&"required"],asterisk:["asterisk",o&&"error"]};return nn(u,zU,r)},UU=or("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,t.color==="secondary"&&r.colorSecondary,t.filled&&r.filled]}})(cn(({theme:e})=>({color:(e.vars||e).palette.text.secondary,...e.typography.body1,lineHeight:"1.4375em",padding:0,position:"relative",variants:[...Object.entries(e.palette).filter(qi()).map(([r])=>({props:{color:r},style:{[`&.${uv.focused}`]:{color:(e.vars||e).palette[r].main}}})),{props:{},style:{[`&.${uv.disabled}`]:{color:(e.vars||e).palette.text.disabled},[`&.${uv.error}`]:{color:(e.vars||e).palette.error.main}}}]}))),HU=or("span",{name:"MuiFormLabel",slot:"Asterisk"})(cn(({theme:e})=>({[`&.${uv.error}`]:{color:(e.vars||e).palette.error.main}}))),VU=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiFormLabel"}),{children:s,className:o,color:i,component:c="label",disabled:u,error:l,filled:d,focused:h,required:f,...p}=n,v=Ku(),g=Jf({props:n,muiFormControl:v,states:["color","required","focused","disabled","error","filled"]}),m={...n,color:g.color||"primary",component:c,disabled:g.disabled,error:g.error,filled:g.filled,focused:g.focused,required:g.required},b=$U(m);return a.jsxs(UU,{as:c,ownerState:m,className:Pr(b.root,o),ref:t,...p,children:[s,g.required&&a.jsxs(HU,{ownerState:m,"aria-hidden":!0,className:b.asterisk,children:["","*"]})]})}),is=iI({createStyledComponent:or("div",{name:"MuiGrid",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,t.container&&r.container]}}),componentName:"MuiGrid",useThemeProps:e=>dn({props:e,name:"MuiGrid"}),useTheme:Kf}),WU=e=>{const{classes:r,disableUnderline:t}=e,s=nn({root:["root",!t&&"underline"],input:["input"]},y$,r);return{...r,...s}},qU=or(xw,{shouldForwardProp:e=>xl(e)||e==="classes",name:"MuiInput",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[...gw(e,r),!t.disableUnderline&&r.underline]}})(cn(({theme:e})=>{let t=e.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return e.vars&&(t=`rgba(${e.vars.palette.common.onBackgroundChannel} / ${e.vars.opacity.inputUnderline})`),{position:"relative",variants:[{props:({ownerState:n})=>n.formControl,style:{"label + &":{marginTop:16}}},{props:({ownerState:n})=>!n.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Df.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Df.error}`]:{"&::before, &::after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${t}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Df.disabled}, .${Df.error}):before`]:{borderBottom:`2px solid ${(e.vars||e).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${t}`}},[`&.${Df.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(e.palette).filter(qi()).map(([n])=>({props:{color:n,disableUnderline:!1},style:{"&::after":{borderBottom:`2px solid ${(e.vars||e).palette[n].main}`}}}))]}})),GU=or(bw,{name:"MuiInput",slot:"Input",overridesResolver:vw})({}),P6=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiInput"}),{disableUnderline:s=!1,components:o={},componentsProps:i,fullWidth:c=!1,inputComponent:u="input",multiline:l=!1,slotProps:d,slots:h={},type:f="text",...p}=n,v=WU(n),m={root:{ownerState:{disableUnderline:s}}},b=d??i?Ki(d??i,m):m,y=h.root??o.Root??qU,S=h.input??o.Input??GU;return a.jsx(yw,{slots:{root:y,input:S},slotProps:b,fullWidth:c,inputComponent:u,multiline:l,ref:t,type:f,...p,classes:v})});P6.muiName="Input";function KU(e){return an("MuiInputAdornment",e)}const F8=un("MuiInputAdornment",["root","filled","standard","outlined","positionStart","positionEnd","disablePointerEvents","hiddenLabel","sizeSmall"]);var B8;const XU=(e,r)=>{const{ownerState:t}=e;return[r.root,r[`position${yr(t.position)}`],t.disablePointerEvents===!0&&r.disablePointerEvents,r[t.variant]]},YU=e=>{const{classes:r,disablePointerEvents:t,hiddenLabel:n,position:s,size:o,variant:i}=e,c={root:["root",t&&"disablePointerEvents",s&&`position${yr(s)}`,i,n&&"hiddenLabel",o&&`size${yr(o)}`]};return nn(c,KU,r)},ZU=or("div",{name:"MuiInputAdornment",slot:"Root",overridesResolver:XU})(cn(({theme:e})=>({display:"flex",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap",color:(e.vars||e).palette.action.active,variants:[{props:{variant:"filled"},style:{[`&.${F8.positionStart}&:not(.${F8.hiddenLabel})`]:{marginTop:16}}},{props:{position:"start"},style:{marginRight:8}},{props:{position:"end"},style:{marginLeft:8}},{props:{disablePointerEvents:!0},style:{pointerEvents:"none"}}]}))),Qf=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiInputAdornment"}),{children:s,className:o,component:i="div",disablePointerEvents:c=!1,disableTypography:u=!1,position:l,variant:d,...h}=n,f=Ku()||{};let p=d;d&&f.variant,f&&!p&&(p=f.variant);const v={...n,hiddenLabel:f.hiddenLabel,size:f.size,disablePointerEvents:c,position:l,variant:p},g=YU(v);return a.jsx(mw.Provider,{value:null,children:a.jsx(ZU,{as:i,ownerState:v,className:Pr(g.root,o),ref:t,...h,children:typeof s=="string"&&!u?a.jsx(Et,{color:"textSecondary",children:s}):a.jsxs(G.Fragment,{children:[l==="start"?B8||(B8=a.jsx("span",{className:"notranslate","aria-hidden":!0,children:""})):null,s]})})})});function JU(e){return an("MuiInputLabel",e)}un("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const QU=e=>{const{classes:r,formControl:t,size:n,shrink:s,disableAnimation:o,variant:i,required:c}=e,u={root:["root",t&&"formControl",!o&&"animated",s&&"shrink",n&&n!=="medium"&&`size${yr(n)}`,i],asterisk:[c&&"asterisk"]},l=nn(u,JU,r);return{...r,...l}},eH=or(VU,{shouldForwardProp:e=>xl(e)||e==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[{[`& .${uv.asterisk}`]:r.asterisk},r.root,t.formControl&&r.formControl,t.size==="small"&&r.sizeSmall,t.shrink&&r.shrink,!t.disableAnimation&&r.animated,t.focused&&r.focused,r[t.variant]]}})(cn(({theme:e})=>({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",variants:[{props:({ownerState:r})=>r.formControl,style:{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"}},{props:{size:"small"},style:{transform:"translate(0, 17px) scale(1)"}},{props:({ownerState:r})=>r.shrink,style:{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"}},{props:({ownerState:r})=>!r.disableAnimation,style:{transition:e.transitions.create(["color","transform","max-width"],{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut})}},{props:{variant:"filled"},style:{zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"filled",size:"small"},style:{transform:"translate(12px, 13px) scale(1)"}},{props:({variant:r,ownerState:t})=>r==="filled"&&t.shrink,style:{userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"}},{props:({variant:r,ownerState:t,size:n})=>r==="filled"&&t.shrink&&n==="small",style:{transform:"translate(12px, 4px) scale(0.75)"}},{props:{variant:"outlined"},style:{zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"outlined",size:"small"},style:{transform:"translate(14px, 9px) scale(1)"}},{props:({variant:r,ownerState:t})=>r==="outlined"&&t.shrink,style:{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}}]}))),F6=G.forwardRef(function(r,t){const n=dn({name:"MuiInputLabel",props:r}),{disableAnimation:s=!1,margin:o,shrink:i,variant:c,className:u,...l}=n,d=Ku();let h=i;typeof h>"u"&&d&&(h=d.filled||d.focused||d.adornedStart);const f=Jf({props:n,muiFormControl:d,states:["size","variant","required","focused"]}),p={...n,disableAnimation:s,formControl:d,shrink:h,size:f.size,variant:f.variant,required:f.required,focused:f.focused},v=QU(p);return a.jsx(eH,{"data-shrink":h,ref:t,className:Pr(v.root,u),...l,ownerState:p,classes:v})});function tH(e){return an("MuiNativeSelect",e)}const B6=un("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),rH=e=>{const{classes:r,variant:t,disabled:n,multiple:s,open:o,error:i}=e,c={select:["select",t,n&&"disabled",s&&"multiple",i&&"error"],icon:["icon",`icon${yr(t)}`,o&&"iconOpen",n&&"disabled"]};return nn(c,tH,r)},S7=or("select")(({theme:e})=>({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":{borderRadius:0},[`&.${B6.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(e.vars||e).palette.background.paper},variants:[{props:({ownerState:r})=>r.variant!=="filled"&&r.variant!=="outlined",style:{"&&&":{paddingRight:24,minWidth:16}}},{props:{variant:"filled"},style:{"&&&":{paddingRight:32}}},{props:{variant:"outlined"},style:{borderRadius:(e.vars||e).shape.borderRadius,"&:focus":{borderRadius:(e.vars||e).shape.borderRadius},"&&&":{paddingRight:32}}}]})),nH=or(S7,{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:xl,overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.select,r[t.variant],t.error&&r.error,{[`&.${B6.multiple}`]:r.multiple}]}})({}),_7=or("svg")(({theme:e})=>({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(e.vars||e).palette.action.active,[`&.${B6.disabled}`]:{color:(e.vars||e).palette.action.disabled},variants:[{props:({ownerState:r})=>r.open,style:{transform:"rotate(180deg)"}},{props:{variant:"filled"},style:{right:7}},{props:{variant:"outlined"},style:{right:7}}]})),aH=or(_7,{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.icon,t.variant&&r[`icon${yr(t.variant)}`],t.open&&r.iconOpen]}})({}),sH=G.forwardRef(function(r,t){const{className:n,disabled:s,error:o,IconComponent:i,inputRef:c,variant:u="standard",...l}=r,d={...r,disabled:s,variant:u,error:o},h=rH(d);return a.jsxs(G.Fragment,{children:[a.jsx(nH,{ownerState:d,className:Pr(h.select,n),disabled:s,ref:c||t,...l}),r.multiple?null:a.jsx(aH,{as:i,ownerState:d,className:h.icon})]})});var z8;const iH=or("fieldset",{shouldForwardProp:xl})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),oH=or("legend",{shouldForwardProp:xl})(cn(({theme:e})=>({float:"unset",width:"auto",overflow:"hidden",variants:[{props:({ownerState:r})=>!r.withLabel,style:{padding:0,lineHeight:"11px",transition:e.transitions.create("width",{duration:150,easing:e.transitions.easing.easeOut})}},{props:({ownerState:r})=>r.withLabel,style:{display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:e.transitions.create("max-width",{duration:50,easing:e.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}}},{props:({ownerState:r})=>r.withLabel&&r.notched,style:{maxWidth:"100%",transition:e.transitions.create("max-width",{duration:100,easing:e.transitions.easing.easeOut,delay:50})}}]})));function lH(e){const{children:r,classes:t,className:n,label:s,notched:o,...i}=e,c=s!=null&&s!=="",u={...e,notched:o,withLabel:c};return a.jsx(iH,{"aria-hidden":!0,className:n,ownerState:u,...i,children:a.jsx(oH,{ownerState:u,children:c?a.jsx("span",{children:s}):z8||(z8=a.jsx("span",{className:"notranslate","aria-hidden":!0,children:""}))})})}const cH=e=>{const{classes:r}=e,n=nn({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},w$,r);return{...r,...n}},uH=or(xw,{shouldForwardProp:e=>xl(e)||e==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:gw})(cn(({theme:e})=>{const r=e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{position:"relative",borderRadius:(e.vars||e).shape.borderRadius,[`&:hover .${uc.notchedOutline}`]:{borderColor:(e.vars||e).palette.text.primary},"@media (hover: none)":{[`&:hover .${uc.notchedOutline}`]:{borderColor:e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:r}},[`&.${uc.focused} .${uc.notchedOutline}`]:{borderWidth:2},variants:[...Object.entries(e.palette).filter(qi()).map(([t])=>({props:{color:t},style:{[`&.${uc.focused} .${uc.notchedOutline}`]:{borderColor:(e.vars||e).palette[t].main}}})),{props:{},style:{[`&.${uc.error} .${uc.notchedOutline}`]:{borderColor:(e.vars||e).palette.error.main},[`&.${uc.disabled} .${uc.notchedOutline}`]:{borderColor:(e.vars||e).palette.action.disabled}}},{props:({ownerState:t})=>t.startAdornment,style:{paddingLeft:14}},{props:({ownerState:t})=>t.endAdornment,style:{paddingRight:14}},{props:({ownerState:t})=>t.multiline,style:{padding:"16.5px 14px"}},{props:({ownerState:t,size:n})=>t.multiline&&n==="small",style:{padding:"8.5px 14px"}}]}})),dH=or(lH,{name:"MuiOutlinedInput",slot:"NotchedOutline"})(cn(({theme:e})=>{const r=e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:r}})),fH=or(bw,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:vw})(cn(({theme:e})=>({padding:"16.5px 14px",...!e.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:e.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:e.palette.mode==="light"?null:"#fff",caretColor:e.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},...e.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[e.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{padding:"8.5px 14px"}},{props:({ownerState:r})=>r.multiline,style:{padding:0}},{props:({ownerState:r})=>r.startAdornment,style:{paddingLeft:0}},{props:({ownerState:r})=>r.endAdornment,style:{paddingRight:0}}]}))),z6=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiOutlinedInput"}),{components:s={},fullWidth:o=!1,inputComponent:i="input",label:c,multiline:u=!1,notched:l,slots:d={},slotProps:h={},type:f="text",...p}=n,v=cH(n),g=Ku(),m=Jf({props:n,muiFormControl:g,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),b={...n,color:m.color||"primary",disabled:m.disabled,error:m.error,focused:m.focused,formControl:g,fullWidth:o,hiddenLabel:m.hiddenLabel,multiline:u,size:m.size,type:f},y=d.root??s.Root??uH,S=d.input??s.Input??fH,[C,L]=ln("notchedOutline",{elementType:dH,className:v.notchedOutline,shouldForwardComponentProp:!0,ownerState:b,externalForwardedProps:{slots:d,slotProps:h},additionalProps:{label:c!=null&&c!==""&&m.required?a.jsxs(G.Fragment,{children:[c,"","*"]}):c}});return a.jsx(yw,{slots:{root:y,input:S},slotProps:h,renderSuffix:O=>a.jsx(C,{...L,notched:typeof l<"u"?l:!!(O.startAdornment||O.filled||O.focused)}),fullWidth:o,inputComponent:i,multiline:u,ref:t,type:f,...p,classes:{...v,notchedOutline:null}})});z6.muiName="Input";const hH=Hn(a.jsx("path",{d:"M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"})),pH=Hn(a.jsx("path",{d:"M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"}));function A7(e){return an("MuiSelect",e)}const P1=un("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var $8;const mH=or(S7,{name:"MuiSelect",slot:"Select",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[{[`&.${P1.select}`]:r.select},{[`&.${P1.select}`]:r[t.variant]},{[`&.${P1.error}`]:r.error},{[`&.${P1.multiple}`]:r.multiple}]}})({[`&.${P1.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),gH=or(_7,{name:"MuiSelect",slot:"Icon",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.icon,t.variant&&r[`icon${yr(t.variant)}`],t.open&&r.iconOpen]}})({}),vH=or("input",{shouldForwardProp:e=>Dk(e)&&e!=="classes",name:"MuiSelect",slot:"NativeInput"})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function U8(e,r){return typeof r=="object"&&r!==null?e===r:String(e)===String(r)}function xH(e){return e==null||typeof e=="string"&&!e.trim()}const bH=e=>{const{classes:r,variant:t,disabled:n,multiple:s,open:o,error:i}=e,c={select:["select",t,n&&"disabled",s&&"multiple",i&&"error"],icon:["icon",`icon${yr(t)}`,o&&"iconOpen",n&&"disabled"],nativeInput:["nativeInput"]};return nn(c,A7,r)},yH=G.forwardRef(function(r,t){var tt;const{"aria-describedby":n,"aria-label":s,autoFocus:o,autoWidth:i,children:c,className:u,defaultOpen:l,defaultValue:d,disabled:h,displayEmpty:f,error:p=!1,IconComponent:v,inputRef:g,labelId:m,MenuProps:b={},multiple:y,name:S,onBlur:C,onChange:L,onClose:O,onFocus:H,onOpen:z,open:q,readOnly:D,renderValue:W,required:P,SelectDisplayProps:I={},tabIndex:U,type:k,value:_,variant:R="standard",...j}=r,[A,N]=A0({controlled:_,default:d,name:"Select"}),[V,M]=A0({controlled:q,default:l,name:"Select"}),Z=G.useRef(null),J=G.useRef(null),[re,X]=G.useState(null),{current:ne}=G.useRef(q!=null),[Y,K]=G.useState(),ee=Ni(t,g),ue=G.useCallback(Ze=>{J.current=Ze,Ze&&X(Ze)},[]),se=re==null?void 0:re.parentNode;G.useImperativeHandle(ee,()=>({focus:()=>{J.current.focus()},node:Z.current,value:A}),[A]),G.useEffect(()=>{l&&V&&re&&!ne&&(K(i?null:se.clientWidth),J.current.focus())},[re,i]),G.useEffect(()=>{o&&J.current.focus()},[o]),G.useEffect(()=>{if(!m)return;const Ze=co(J.current).getElementById(m);if(Ze){const St=()=>{getSelection().isCollapsed&&J.current.focus()};return Ze.addEventListener("click",St),()=>{Ze.removeEventListener("click",St)}}},[m]);const ce=(Ze,St)=>{Ze?z&&z(St):O&&O(St),ne||(K(i?null:se.clientWidth),M(Ze))},fe=Ze=>{Ze.button===0&&(Ze.preventDefault(),J.current.focus(),ce(!0,Ze))},ve=Ze=>{ce(!1,Ze)},_e=G.Children.toArray(c),le=Ze=>{const St=_e.find(et=>et.props.value===Ze.target.value);St!==void 0&&(N(St.props.value),L&&L(Ze,St))},ke=Ze=>St=>{let et;if(St.currentTarget.hasAttribute("tabindex")){if(y){et=Array.isArray(A)?A.slice():[];const Ht=A.indexOf(Ze.props.value);Ht===-1?et.push(Ze.props.value):et.splice(Ht,1)}else et=Ze.props.value;if(Ze.props.onClick&&Ze.props.onClick(St),A!==et&&(N(et),L)){const Ht=St.nativeEvent||St,Nt=new Ht.constructor(Ht.type,Ht);Object.defineProperty(Nt,"target",{writable:!0,value:{value:et,name:S}}),L(Nt,Ze)}y||ce(!1,St)}},Te=Ze=>{D||[" ","ArrowUp","ArrowDown","Enter"].includes(Ze.key)&&(Ze.preventDefault(),ce(!0,Ze))},pe=re!==null&&V,ye=Ze=>{!pe&&C&&(Object.defineProperty(Ze,"target",{writable:!0,value:{value:A,name:S}}),C(Ze))};delete j["aria-invalid"];let ge,De;const He=[];let Xe=!1;(x2({value:A})||f)&&(W?ge=W(A):Xe=!0);const at=_e.map(Ze=>{if(!G.isValidElement(Ze))return null;let St;if(y){if(!Array.isArray(A))throw new Error(Id(2));St=A.some(et=>U8(et,Ze.props.value)),St&&Xe&&He.push(Ze.props.children)}else St=U8(A,Ze.props.value),St&&Xe&&(De=Ze.props.children);return G.cloneElement(Ze,{"aria-selected":St?"true":"false",onClick:ke(Ze),onKeyUp:et=>{et.key===" "&&et.preventDefault(),Ze.props.onKeyUp&&Ze.props.onKeyUp(et)},role:"option",selected:St,value:void 0,"data-value":Ze.props.value})});Xe&&(y?He.length===0?ge=null:ge=He.reduce((Ze,St,et)=>(Ze.push(St),et<He.length-1&&Ze.push(", "),Ze),[]):ge=De);let dt=Y;!i&&ne&&re&&(dt=se.clientWidth);let wt;typeof U<"u"?wt=U:wt=h?null:0;const $t=I.id||(S?`mui-component-select-${S}`:void 0),Bt={...r,variant:R,value:A,open:pe,error:p},ft=bH(Bt),tr={...b.PaperProps,...(tt=b.slotProps)==null?void 0:tt.paper},Me=Od();return a.jsxs(G.Fragment,{children:[a.jsx(mH,{as:"div",ref:ue,tabIndex:wt,role:"combobox","aria-controls":pe?Me:void 0,"aria-disabled":h?"true":void 0,"aria-expanded":pe?"true":"false","aria-haspopup":"listbox","aria-label":s,"aria-labelledby":[m,$t].filter(Boolean).join(" ")||void 0,"aria-describedby":n,"aria-required":P?"true":void 0,"aria-invalid":p?"true":void 0,onKeyDown:Te,onMouseDown:h||D?null:fe,onBlur:ye,onFocus:H,...I,ownerState:Bt,className:Pr(I.className,ft.select,u),id:$t,children:xH(ge)?$8||($8=a.jsx("span",{className:"notranslate","aria-hidden":!0,children:""})):ge}),a.jsx(vH,{"aria-invalid":p,value:Array.isArray(A)?A.join(","):A,name:S,ref:Z,"aria-hidden":!0,onChange:le,tabIndex:-1,disabled:h,className:ft.nativeInput,autoFocus:o,required:P,...j,ownerState:Bt}),a.jsx(gH,{as:v,className:ft.icon,ownerState:Bt}),a.jsx(Jk,{id:`menu-${S||""}`,anchorEl:se,open:pe,onClose:ve,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},...b,slotProps:{...b.slotProps,list:{"aria-labelledby":m,role:"listbox","aria-multiselectable":y?"true":void 0,disableListWrap:!0,id:Me,...b.MenuListProps},paper:{...tr,style:{minWidth:dt,...tr!=null?tr.style:null}}},children:at})]})}),wH=e=>{const{classes:r}=e,n=nn({root:["root"]},A7,r);return{...r,...n}},$6={name:"MuiSelect",slot:"Root",shouldForwardProp:e=>xl(e)&&e!=="variant"},SH=or(P6,$6)(""),_H=or(z6,$6)(""),AH=or(I6,$6)(""),eh=G.forwardRef(function(r,t){const n=dn({name:"MuiSelect",props:r}),{autoWidth:s=!1,children:o,classes:i={},className:c,defaultOpen:u=!1,displayEmpty:l=!1,IconComponent:d=y7,id:h,input:f,inputProps:p,label:v,labelId:g,MenuProps:m,multiple:b=!1,native:y=!1,onClose:S,onOpen:C,open:L,renderValue:O,SelectDisplayProps:H,variant:z="outlined",...q}=n,D=y?sH:yH,W=Ku(),P=Jf({props:n,muiFormControl:W,states:["variant","error"]}),I=P.variant||z,U={...n,variant:I,classes:i},k=wH(U),{root:_,...R}=k,j=f||{standard:a.jsx(SH,{ownerState:U}),outlined:a.jsx(_H,{label:v,ownerState:U}),filled:a.jsx(AH,{ownerState:U})}[I],A=Ni(t,V0(j));return a.jsx(G.Fragment,{children:G.cloneElement(j,{inputComponent:D,inputProps:{children:o,error:P.error,IconComponent:d,variant:I,type:void 0,multiple:b,...y?{id:h}:{autoWidth:s,defaultOpen:u,displayEmpty:l,labelId:g,MenuProps:m,onClose:S,onOpen:C,open:L,renderValue:O,SelectDisplayProps:{id:h,...H}},...p,classes:p?Ki(R,p.classes):R,...f?f.props.inputProps:{}},...(b&&y||l)&&I==="outlined"?{notched:!0}:{},ref:A,className:Pr(j.props.className,c,k.root),...!f&&{variant:I},...q})})});eh.muiName="Select";function CH(e={}){const{autoHideDuration:r=null,disableWindowBlurListener:t=!1,onClose:n,open:s,resumeHideDuration:o}=e,i=b0();G.useEffect(()=>{if(!s)return;function b(y){y.defaultPrevented||y.key==="Escape"&&(n==null||n(y,"escapeKeyDown"))}return document.addEventListener("keydown",b),()=>{document.removeEventListener("keydown",b)}},[s,n]);const c=Di((b,y)=>{n==null||n(b,y)}),u=Di(b=>{!n||b==null||i.start(b,()=>{c(null,"timeout")})});G.useEffect(()=>(s&&u(r),i.clear),[s,r,u,i]);const l=b=>{n==null||n(b,"clickaway")},d=i.clear,h=G.useCallback(()=>{r!=null&&u(o??r*.5)},[r,o,u]),f=b=>y=>{const S=b.onBlur;S==null||S(y),h()},p=b=>y=>{const S=b.onFocus;S==null||S(y),d()},v=b=>y=>{const S=b.onMouseEnter;S==null||S(y),d()},g=b=>y=>{const S=b.onMouseLeave;S==null||S(y),h()};return G.useEffect(()=>{if(!t&&s)return window.addEventListener("focus",h),window.addEventListener("blur",d),()=>{window.removeEventListener("focus",h),window.removeEventListener("blur",d)}},[t,s,h,d]),{getRootProps:(b={})=>{const y={...p2(e),...p2(b)};return{role:"presentation",...b,...y,onBlur:f(y),onFocus:p(y),onMouseEnter:v(y),onMouseLeave:g(y)}},onClickAway:l}}function jH(e){return an("MuiSnackbarContent",e)}un("MuiSnackbarContent",["root","message","action"]);const kH=e=>{const{classes:r}=e;return nn({root:["root"],action:["action"],message:["message"]},jH,r)},RH=or(sa,{name:"MuiSnackbarContent",slot:"Root"})(cn(({theme:e})=>{const r=e.palette.mode==="light"?.8:.98,t=nk(e.palette.background.default,r);return{...e.typography.body2,color:e.vars?e.vars.palette.SnackbarContent.color:e.palette.getContrastText(t),backgroundColor:e.vars?e.vars.palette.SnackbarContent.bg:t,display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",borderRadius:(e.vars||e).shape.borderRadius,flexGrow:1,[e.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}}})),EH=or("div",{name:"MuiSnackbarContent",slot:"Message"})({padding:"8px 0"}),NH=or("div",{name:"MuiSnackbarContent",slot:"Action"})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),TH=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiSnackbarContent"}),{action:s,className:o,message:i,role:c="alert",...u}=n,l=n,d=kH(l);return a.jsxs(RH,{role:c,square:!0,elevation:6,className:Pr(d.root,o),ownerState:l,ref:t,...u,children:[a.jsx(EH,{className:d.message,ownerState:l,children:i}),s?a.jsx(NH,{className:d.action,ownerState:l,children:s}):null]})});function LH(e){return an("MuiSnackbar",e)}un("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const MH=e=>{const{classes:r,anchorOrigin:t}=e,n={root:["root",`anchorOrigin${yr(t.vertical)}${yr(t.horizontal)}`]};return nn(n,LH,r)},DH=or("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,r[`anchorOrigin${yr(t.anchorOrigin.vertical)}${yr(t.anchorOrigin.horizontal)}`]]}})(cn(({theme:e})=>({zIndex:(e.vars||e).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center",variants:[{props:({ownerState:r})=>r.anchorOrigin.vertical==="top",style:{top:8,[e.breakpoints.up("sm")]:{top:24}}},{props:({ownerState:r})=>r.anchorOrigin.vertical!=="top",style:{bottom:8,[e.breakpoints.up("sm")]:{bottom:24}}},{props:({ownerState:r})=>r.anchorOrigin.horizontal==="left",style:{justifyContent:"flex-start",[e.breakpoints.up("sm")]:{left:24,right:"auto"}}},{props:({ownerState:r})=>r.anchorOrigin.horizontal==="right",style:{justifyContent:"flex-end",[e.breakpoints.up("sm")]:{right:24,left:"auto"}}},{props:({ownerState:r})=>r.anchorOrigin.horizontal==="center",style:{[e.breakpoints.up("sm")]:{left:"50%",right:"auto",transform:"translateX(-50%)"}}}]}))),tu=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiSnackbar"}),s=Kf(),o={enter:s.transitions.duration.enteringScreen,exit:s.transitions.duration.leavingScreen},{action:i,anchorOrigin:{vertical:c,horizontal:u}={vertical:"bottom",horizontal:"left"},autoHideDuration:l=null,children:d,className:h,ClickAwayListenerProps:f,ContentProps:p,disableWindowBlurListener:v=!1,message:g,onBlur:m,onClose:b,onFocus:y,onMouseEnter:S,onMouseLeave:C,open:L,resumeHideDuration:O,slots:H={},slotProps:z={},TransitionComponent:q,transitionDuration:D=o,TransitionProps:{onEnter:W,onExited:P,...I}={},...U}=n,k={...n,anchorOrigin:{vertical:c,horizontal:u},autoHideDuration:l,disableWindowBlurListener:v,TransitionComponent:q,transitionDuration:D},_=MH(k),{getRootProps:R,onClickAway:j}=CH({...k}),[A,N]=G.useState(!0),V=ce=>{N(!0),P&&P(ce)},M=(ce,fe)=>{N(!1),W&&W(ce,fe)},Z={slots:{transition:q,...H},slotProps:{content:p,clickAwayListener:f,transition:I,...z}},[J,re]=ln("root",{ref:t,className:[_.root,h],elementType:DH,getSlotProps:R,externalForwardedProps:{...Z,...U},ownerState:k}),[X,{ownerState:ne,...Y}]=ln("clickAwayListener",{elementType:sU,externalForwardedProps:Z,getSlotProps:ce=>({onClickAway:(...fe)=>{var _e;const ve=fe[0];(_e=ce.onClickAway)==null||_e.call(ce,...fe),!(ve!=null&&ve.defaultMuiPrevented)&&j(...fe)}}),ownerState:k}),[K,ee]=ln("content",{elementType:TH,shouldForwardComponentProp:!0,externalForwardedProps:Z,additionalProps:{message:g,action:i},ownerState:k}),[ue,se]=ln("transition",{elementType:Nv,externalForwardedProps:Z,getSlotProps:ce=>({onEnter:(...fe)=>{var ve;(ve=ce.onEnter)==null||ve.call(ce,...fe),M(...fe)},onExited:(...fe)=>{var ve;(ve=ce.onExited)==null||ve.call(ce,...fe),V(...fe)}}),additionalProps:{appear:!0,in:L,timeout:D,direction:c==="top"?"down":"up"},ownerState:k});return!L&&A?null:a.jsx(X,{...Y,...H.clickAwayListener&&{ownerState:ne},children:a.jsx(J,{...re,children:a.jsx(ue,{...se,children:d||a.jsx(K,{...ee})})})})}),IH=hI({createStyledComponent:or("div",{name:"MuiStack",slot:"Root"}),useThemeProps:e=>dn({props:e,name:"MuiStack"})}),ww=G.createContext({}),U6=G.createContext({});function OH(e){return an("MuiStep",e)}un("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const PH=e=>{const{classes:r,orientation:t,alternativeLabel:n,completed:s}=e;return nn({root:["root",t,n&&"alternativeLabel",s&&"completed"]},OH,r)},FH=or("div",{name:"MuiStep",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,r[t.orientation],t.alternativeLabel&&r.alternativeLabel,t.completed&&r.completed]}})({variants:[{props:{orientation:"horizontal"},style:{paddingLeft:8,paddingRight:8}},{props:{alternativeLabel:!0},style:{flex:1,position:"relative"}}]}),BH=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiStep"}),{active:s,children:o,className:i,component:c="div",completed:u,disabled:l,expanded:d=!1,index:h,last:f,...p}=n,{activeStep:v,connector:g,alternativeLabel:m,orientation:b,nonLinear:y}=G.useContext(ww);let[S=!1,C=!1,L=!1]=[s,u,l];v===h?S=s!==void 0?s:!0:!y&&v>h?C=u!==void 0?u:!0:!y&&v<h&&(L=l!==void 0?l:!0);const O=G.useMemo(()=>({index:h,last:f,expanded:d,icon:h+1,active:S,completed:C,disabled:L}),[h,f,d,S,C,L]),H={...n,active:S,orientation:b,alternativeLabel:m,completed:C,disabled:L,expanded:d,component:c},z=PH(H),q=a.jsxs(FH,{as:c,className:Pr(z.root,i),ref:t,ownerState:H,...p,children:[g&&m&&h!==0?g:null,o]});return a.jsx(U6.Provider,{value:O,children:g&&!m&&h!==0?a.jsxs(G.Fragment,{children:[g,q]}):q})}),zH=Hn(a.jsx("path",{d:"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z"})),$H=Hn(a.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}));function UH(e){return an("MuiStepIcon",e)}const s3=un("MuiStepIcon",["root","active","completed","error","text"]);var H8;const HH=e=>{const{classes:r,active:t,completed:n,error:s}=e;return nn({root:["root",t&&"active",n&&"completed",s&&"error"],text:["text"]},UH,r)},i3=or(o2,{name:"MuiStepIcon",slot:"Root"})(cn(({theme:e})=>({display:"block",transition:e.transitions.create("color",{duration:e.transitions.duration.shortest}),color:(e.vars||e).palette.text.disabled,[`&.${s3.completed}`]:{color:(e.vars||e).palette.primary.main},[`&.${s3.active}`]:{color:(e.vars||e).palette.primary.main},[`&.${s3.error}`]:{color:(e.vars||e).palette.error.main}}))),VH=or("text",{name:"MuiStepIcon",slot:"Text"})(cn(({theme:e})=>({fill:(e.vars||e).palette.primary.contrastText,fontSize:e.typography.caption.fontSize,fontFamily:e.typography.fontFamily}))),WH=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiStepIcon"}),{active:s=!1,className:o,completed:i=!1,error:c=!1,icon:u,...l}=n,d={...n,active:s,completed:i,error:c},h=HH(d);if(typeof u=="number"||typeof u=="string"){const f=Pr(o,h.root);return c?a.jsx(i3,{as:$H,className:f,ref:t,ownerState:d,...l}):i?a.jsx(i3,{as:zH,className:f,ref:t,ownerState:d,...l}):a.jsxs(i3,{className:f,ref:t,ownerState:d,...l,children:[H8||(H8=a.jsx("circle",{cx:"12",cy:"12",r:"12"})),a.jsx(VH,{className:h.text,x:"12",y:"12",textAnchor:"middle",dominantBaseline:"central",ownerState:d,children:u})]})}return u});function qH(e){return an("MuiStepLabel",e)}const Of=un("MuiStepLabel",["root","horizontal","vertical","label","active","completed","error","disabled","iconContainer","alternativeLabel","labelContainer"]),GH=e=>{const{classes:r,orientation:t,active:n,completed:s,error:o,disabled:i,alternativeLabel:c}=e;return nn({root:["root",t,o&&"error",i&&"disabled",c&&"alternativeLabel"],label:["label",n&&"active",s&&"completed",o&&"error",i&&"disabled",c&&"alternativeLabel"],iconContainer:["iconContainer",n&&"active",s&&"completed",o&&"error",i&&"disabled",c&&"alternativeLabel"],labelContainer:["labelContainer",c&&"alternativeLabel"]},qH,r)},KH=or("span",{name:"MuiStepLabel",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,r[t.orientation]]}})({display:"flex",alignItems:"center",[`&.${Of.alternativeLabel}`]:{flexDirection:"column"},[`&.${Of.disabled}`]:{cursor:"default"},variants:[{props:{orientation:"vertical"},style:{textAlign:"left",padding:"8px 0"}}]}),XH=or("span",{name:"MuiStepLabel",slot:"Label"})(cn(({theme:e})=>({...e.typography.body2,display:"block",transition:e.transitions.create("color",{duration:e.transitions.duration.shortest}),[`&.${Of.active}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${Of.completed}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${Of.alternativeLabel}`]:{marginTop:16},[`&.${Of.error}`]:{color:(e.vars||e).palette.error.main}}))),YH=or("span",{name:"MuiStepLabel",slot:"IconContainer"})({flexShrink:0,display:"flex",paddingRight:8,[`&.${Of.alternativeLabel}`]:{paddingRight:0}}),ZH=or("span",{name:"MuiStepLabel",slot:"LabelContainer"})(cn(({theme:e})=>({width:"100%",color:(e.vars||e).palette.text.secondary,[`&.${Of.alternativeLabel}`]:{textAlign:"center"}}))),C7=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiStepLabel"}),{children:s,className:o,componentsProps:i={},error:c=!1,icon:u,optional:l,slots:d={},slotProps:h={},StepIconComponent:f,StepIconProps:p,...v}=n,{alternativeLabel:g,orientation:m}=G.useContext(ww),{active:b,disabled:y,completed:S,icon:C}=G.useContext(U6),L=u||C;let O=f;L&&!O&&(O=WH);const H={...n,active:b,alternativeLabel:g,completed:S,disabled:y,error:c,orientation:m},z=GH(H),q={slots:d,slotProps:{stepIcon:p,...i,...h}},[D,W]=ln("root",{elementType:KH,externalForwardedProps:{...q,...v},ownerState:H,ref:t,className:Pr(z.root,o)}),[P,I]=ln("label",{elementType:XH,externalForwardedProps:q,ownerState:H}),[U,k]=ln("stepIcon",{elementType:O,externalForwardedProps:q,ownerState:H});return a.jsxs(D,{...W,children:[L||U?a.jsx(YH,{className:z.iconContainer,ownerState:H,children:a.jsx(U,{completed:S,active:b,error:c,icon:L,...k})}):null,a.jsxs(ZH,{className:z.labelContainer,ownerState:H,children:[s?a.jsx(P,{...I,className:Pr(z.label,I==null?void 0:I.className),children:s}):null,l]})]})});C7.muiName="StepLabel";function JH(e){return an("MuiStepConnector",e)}un("MuiStepConnector",["root","horizontal","vertical","alternativeLabel","active","completed","disabled","line","lineHorizontal","lineVertical"]);const QH=e=>{const{classes:r,orientation:t,alternativeLabel:n,active:s,completed:o,disabled:i}=e,c={root:["root",t,n&&"alternativeLabel",s&&"active",o&&"completed",i&&"disabled"],line:["line",`line${yr(t)}`]};return nn(c,JH,r)},eV=or("div",{name:"MuiStepConnector",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,r[t.orientation],t.alternativeLabel&&r.alternativeLabel,t.completed&&r.completed]}})({flex:"1 1 auto",variants:[{props:{orientation:"vertical"},style:{marginLeft:12}},{props:{alternativeLabel:!0},style:{position:"absolute",top:12,left:"calc(-50% + 20px)",right:"calc(50% + 20px)"}}]}),tV=or("span",{name:"MuiStepConnector",slot:"Line",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.line,r[`line${yr(t.orientation)}`]]}})(cn(({theme:e})=>{const r=e.palette.mode==="light"?e.palette.grey[400]:e.palette.grey[600];return{display:"block",borderColor:e.vars?e.vars.palette.StepConnector.border:r,variants:[{props:{orientation:"horizontal"},style:{borderTopStyle:"solid",borderTopWidth:1}},{props:{orientation:"vertical"},style:{borderLeftStyle:"solid",borderLeftWidth:1,minHeight:24}}]}})),rV=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiStepConnector"}),{className:s,...o}=n,{alternativeLabel:i,orientation:c="horizontal"}=G.useContext(ww),{active:u,disabled:l,completed:d}=G.useContext(U6),h={...n,alternativeLabel:i,orientation:c,active:u,completed:d,disabled:l},f=QH(h);return a.jsx(eV,{className:Pr(f.root,s),ref:t,ownerState:h,...o,children:a.jsx(tV,{className:f.line,ownerState:h})})});function nV(e){return an("MuiStepper",e)}un("MuiStepper",["root","horizontal","vertical","nonLinear","alternativeLabel"]);const aV=e=>{const{orientation:r,nonLinear:t,alternativeLabel:n,classes:s}=e;return nn({root:["root",r,t&&"nonLinear",n&&"alternativeLabel"]},nV,s)},sV=or("div",{name:"MuiStepper",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,r[t.orientation],t.alternativeLabel&&r.alternativeLabel,t.nonLinear&&r.nonLinear]}})({display:"flex",variants:[{props:{orientation:"horizontal"},style:{flexDirection:"row",alignItems:"center"}},{props:{orientation:"vertical"},style:{flexDirection:"column"}},{props:{alternativeLabel:!0},style:{alignItems:"flex-start"}}]}),iV=a.jsx(rV,{}),oV=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiStepper"}),{activeStep:s=0,alternativeLabel:o=!1,children:i,className:c,component:u="div",connector:l=iV,nonLinear:d=!1,orientation:h="horizontal",...f}=n,p={...n,nonLinear:d,alternativeLabel:o,orientation:h,component:u},v=aV(p),g=G.Children.toArray(i).filter(Boolean),m=g.map((y,S)=>G.cloneElement(y,{index:S,last:S+1===g.length,...y.props})),b=G.useMemo(()=>({activeStep:s,alternativeLabel:o,connector:l,nonLinear:d,orientation:h}),[s,o,l,d,h]);return a.jsx(ww.Provider,{value:b,children:a.jsx(sV,{as:u,ownerState:p,className:Pr(v.root,c),ref:t,...f,children:m})})});function lV(e){return an("MuiTab",e)}const sc=un("MuiTab",["root","labelIcon","textColorInherit","textColorPrimary","textColorSecondary","selected","disabled","fullWidth","wrapped","iconWrapper","icon"]),cV=e=>{const{classes:r,textColor:t,fullWidth:n,wrapped:s,icon:o,label:i,selected:c,disabled:u}=e,l={root:["root",o&&i&&"labelIcon",`textColor${yr(t)}`,n&&"fullWidth",s&&"wrapped",c&&"selected",u&&"disabled"],icon:["iconWrapper","icon"]};return nn(l,lV,r)},uV=or($f,{name:"MuiTab",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,t.label&&t.icon&&r.labelIcon,r[`textColor${yr(t.textColor)}`],t.fullWidth&&r.fullWidth,t.wrapped&&r.wrapped,{[`& .${sc.iconWrapper}`]:r.iconWrapper},{[`& .${sc.icon}`]:r.icon}]}})(cn(({theme:e})=>({...e.typography.button,maxWidth:360,minWidth:90,position:"relative",minHeight:48,flexShrink:0,padding:"12px 16px",overflow:"hidden",whiteSpace:"normal",textAlign:"center",lineHeight:1.25,variants:[{props:({ownerState:r})=>r.label&&(r.iconPosition==="top"||r.iconPosition==="bottom"),style:{flexDirection:"column"}},{props:({ownerState:r})=>r.label&&r.iconPosition!=="top"&&r.iconPosition!=="bottom",style:{flexDirection:"row"}},{props:({ownerState:r})=>r.icon&&r.label,style:{minHeight:72,paddingTop:9,paddingBottom:9}},{props:({ownerState:r,iconPosition:t})=>r.icon&&r.label&&t==="top",style:{[`& > .${sc.icon}`]:{marginBottom:6}}},{props:({ownerState:r,iconPosition:t})=>r.icon&&r.label&&t==="bottom",style:{[`& > .${sc.icon}`]:{marginTop:6}}},{props:({ownerState:r,iconPosition:t})=>r.icon&&r.label&&t==="start",style:{[`& > .${sc.icon}`]:{marginRight:e.spacing(1)}}},{props:({ownerState:r,iconPosition:t})=>r.icon&&r.label&&t==="end",style:{[`& > .${sc.icon}`]:{marginLeft:e.spacing(1)}}},{props:{textColor:"inherit"},style:{color:"inherit",opacity:.6,[`&.${sc.selected}`]:{opacity:1},[`&.${sc.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity}}},{props:{textColor:"primary"},style:{color:(e.vars||e).palette.text.secondary,[`&.${sc.selected}`]:{color:(e.vars||e).palette.primary.main},[`&.${sc.disabled}`]:{color:(e.vars||e).palette.text.disabled}}},{props:{textColor:"secondary"},style:{color:(e.vars||e).palette.text.secondary,[`&.${sc.selected}`]:{color:(e.vars||e).palette.secondary.main},[`&.${sc.disabled}`]:{color:(e.vars||e).palette.text.disabled}}},{props:({ownerState:r})=>r.fullWidth,style:{flexShrink:1,flexGrow:1,flexBasis:0,maxWidth:"none"}},{props:({ownerState:r})=>r.wrapped,style:{fontSize:e.typography.pxToRem(12)}}]}))),F1=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiTab"}),{className:s,disabled:o=!1,disableFocusRipple:i=!1,fullWidth:c,icon:u,iconPosition:l="top",indicator:d,label:h,onChange:f,onClick:p,onFocus:v,selected:g,selectionFollowsFocus:m,textColor:b="inherit",value:y,wrapped:S=!1,...C}=n,L={...n,disabled:o,disableFocusRipple:i,selected:g,icon:!!u,iconPosition:l,label:!!h,fullWidth:c,textColor:b,wrapped:S},O=cV(L),H=u&&h&&G.isValidElement(u)?G.cloneElement(u,{className:Pr(O.icon,u.props.className)}):u,z=D=>{!g&&f&&f(D,y),p&&p(D)},q=D=>{m&&!g&&f&&f(D,y),v&&v(D)};return a.jsxs(uV,{focusRipple:!i,className:Pr(O.root,s),ref:t,role:"tab","aria-selected":g,disabled:o,onClick:z,onFocus:q,ownerState:L,tabIndex:g?0:-1,...C,children:[l==="top"||l==="start"?a.jsxs(G.Fragment,{children:[H,h]}):a.jsxs(G.Fragment,{children:[h,H]}),d]})}),j7=G.createContext();function dV(e){return an("MuiTable",e)}un("MuiTable",["root","stickyHeader"]);const fV=e=>{const{classes:r,stickyHeader:t}=e;return nn({root:["root",t&&"stickyHeader"]},dV,r)},hV=or("table",{name:"MuiTable",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,t.stickyHeader&&r.stickyHeader]}})(cn(({theme:e})=>({display:"table",width:"100%",borderCollapse:"collapse",borderSpacing:0,"& caption":{...e.typography.body2,padding:e.spacing(2),color:(e.vars||e).palette.text.secondary,textAlign:"left",captionSide:"bottom"},variants:[{props:({ownerState:r})=>r.stickyHeader,style:{borderCollapse:"separate"}}]}))),V8="table",Cs=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiTable"}),{className:s,component:o=V8,padding:i="normal",size:c="medium",stickyHeader:u=!1,...l}=n,d={...n,component:o,padding:i,size:c,stickyHeader:u},h=fV(d),f=G.useMemo(()=>({padding:i,size:c,stickyHeader:u}),[i,c,u]);return a.jsx(j7.Provider,{value:f,children:a.jsx(hV,{as:o,role:o===V8?null:"table",ref:t,className:Pr(h.root,s),ownerState:d,...l})})}),Sw=G.createContext();function pV(e){return an("MuiTableBody",e)}un("MuiTableBody",["root"]);const mV=e=>{const{classes:r}=e;return nn({root:["root"]},pV,r)},gV=or("tbody",{name:"MuiTableBody",slot:"Root"})({display:"table-row-group"}),vV={variant:"body"},W8="tbody",fs=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiTableBody"}),{className:s,component:o=W8,...i}=n,c={...n,component:o},u=mV(c);return a.jsx(Sw.Provider,{value:vV,children:a.jsx(gV,{className:Pr(u.root,s),as:o,ref:t,role:o===W8?null:"rowgroup",ownerState:c,...i})})});function xV(e){return an("MuiTableCell",e)}const bV=un("MuiTableCell",["root","head","body","footer","sizeSmall","sizeMedium","paddingCheckbox","paddingNone","alignLeft","alignCenter","alignRight","alignJustify","stickyHeader"]),yV=e=>{const{classes:r,variant:t,align:n,padding:s,size:o,stickyHeader:i}=e,c={root:["root",t,i&&"stickyHeader",n!=="inherit"&&`align${yr(n)}`,s!=="normal"&&`padding${yr(s)}`,`size${yr(o)}`]};return nn(c,xV,r)},wV=or("td",{name:"MuiTableCell",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,r[t.variant],r[`size${yr(t.size)}`],t.padding!=="normal"&&r[`padding${yr(t.padding)}`],t.align!=="inherit"&&r[`align${yr(t.align)}`],t.stickyHeader&&r.stickyHeader]}})(cn(({theme:e})=>({...e.typography.body2,display:"table-cell",verticalAlign:"inherit",borderBottom:e.vars?`1px solid ${e.vars.palette.TableCell.border}`:`1px solid
    ${e.palette.mode==="light"?Dm(Ca(e.palette.divider,1),.88):Mm(Ca(e.palette.divider,1),.68)}`,textAlign:"left",padding:16,variants:[{props:{variant:"head"},style:{color:(e.vars||e).palette.text.primary,lineHeight:e.typography.pxToRem(24),fontWeight:e.typography.fontWeightMedium}},{props:{variant:"body"},style:{color:(e.vars||e).palette.text.primary}},{props:{variant:"footer"},style:{color:(e.vars||e).palette.text.secondary,lineHeight:e.typography.pxToRem(21),fontSize:e.typography.pxToRem(12)}},{props:{size:"small"},style:{padding:"6px 16px",[`&.${bV.paddingCheckbox}`]:{width:24,padding:"0 12px 0 16px","& > *":{padding:0}}}},{props:{padding:"checkbox"},style:{width:48,padding:"0 0 0 4px"}},{props:{padding:"none"},style:{padding:0}},{props:{align:"left"},style:{textAlign:"left"}},{props:{align:"center"},style:{textAlign:"center"}},{props:{align:"right"},style:{textAlign:"right",flexDirection:"row-reverse"}},{props:{align:"justify"},style:{textAlign:"justify"}},{props:({ownerState:r})=>r.stickyHeader,style:{position:"sticky",top:0,zIndex:2,backgroundColor:(e.vars||e).palette.background.default}}]}))),qe=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiTableCell"}),{align:s="inherit",className:o,component:i,padding:c,scope:u,size:l,sortDirection:d,variant:h,...f}=n,p=G.useContext(j7),v=G.useContext(Sw),g=v&&v.variant==="head";let m;i?m=i:m=g?"th":"td";let b=u;m==="td"?b=void 0:!b&&g&&(b="col");const y=h||v&&v.variant,S={...n,align:s,component:m,padding:c||(p&&p.padding?p.padding:"normal"),size:l||(p&&p.size?p.size:"medium"),sortDirection:d,stickyHeader:y==="head"&&p&&p.stickyHeader,variant:y},C=yV(S);let L=null;return d&&(L=d==="asc"?"ascending":"descending"),a.jsx(wV,{as:m,ref:t,className:Pr(C.root,o),"aria-sort":L,scope:b,ownerState:S,...f})});function SV(e){return an("MuiTableContainer",e)}un("MuiTableContainer",["root"]);const _V=e=>{const{classes:r}=e;return nn({root:["root"]},SV,r)},AV=or("div",{name:"MuiTableContainer",slot:"Root"})({width:"100%",overflowX:"auto"}),Ws=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiTableContainer"}),{className:s,component:o="div",...i}=n,c={...n,component:o},u=_V(c);return a.jsx(AV,{ref:t,as:o,className:Pr(u.root,s),ownerState:c,...i})});function CV(e){return an("MuiTableHead",e)}un("MuiTableHead",["root"]);const jV=e=>{const{classes:r}=e;return nn({root:["root"]},CV,r)},kV=or("thead",{name:"MuiTableHead",slot:"Root"})({display:"table-header-group"}),RV={variant:"head"},q8="thead",js=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiTableHead"}),{className:s,component:o=q8,...i}=n,c={...n,component:o},u=jV(c);return a.jsx(Sw.Provider,{value:RV,children:a.jsx(kV,{as:o,className:Pr(u.root,s),ref:t,role:o===q8?null:"rowgroup",ownerState:c,...i})})});function EV(e){return an("MuiToolbar",e)}un("MuiToolbar",["root","gutters","regular","dense"]);const NV=e=>{const{classes:r,disableGutters:t,variant:n}=e;return nn({root:["root",!t&&"gutters",n]},EV,r)},TV=or("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,!t.disableGutters&&r.gutters,r[t.variant]]}})(cn(({theme:e})=>({position:"relative",display:"flex",alignItems:"center",variants:[{props:({ownerState:r})=>!r.disableGutters,style:{paddingLeft:e.spacing(2),paddingRight:e.spacing(2),[e.breakpoints.up("sm")]:{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}}},{props:{variant:"dense"},style:{minHeight:48}},{props:{variant:"regular"},style:e.mixins.toolbar}]}))),LV=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiToolbar"}),{className:s,component:o="div",disableGutters:i=!1,variant:c="regular",...u}=n,l={...n,component:o,disableGutters:i,variant:c},d=NV(l);return a.jsx(TV,{as:o,className:Pr(d.root,s),ref:t,ownerState:l,...u})}),k7=Hn(a.jsx("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"})),R7=Hn(a.jsx("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"})),MV=G.forwardRef(function(r,t){const{backIconButtonProps:n,count:s,disabled:o=!1,getItemAriaLabel:i,nextIconButtonProps:c,onPageChange:u,page:l,rowsPerPage:d,showFirstButton:h,showLastButton:f,slots:p={},slotProps:v={},...g}=r,m=Xm(),b=V=>{u(V,0)},y=V=>{u(V,l-1)},S=V=>{u(V,l+1)},C=V=>{u(V,Math.max(0,Math.ceil(s/d)-1))},L=p.firstButton??sn,O=p.lastButton??sn,H=p.nextButton??sn,z=p.previousButton??sn,q=p.firstButtonIcon??hH,D=p.lastButtonIcon??pH,W=p.nextButtonIcon??R7,P=p.previousButtonIcon??k7,I=m?O:L,U=m?H:z,k=m?z:H,_=m?L:O,R=m?v.lastButton:v.firstButton,j=m?v.nextButton:v.previousButton,A=m?v.previousButton:v.nextButton,N=m?v.firstButton:v.lastButton;return a.jsxs("div",{ref:t,...g,children:[h&&a.jsx(I,{onClick:b,disabled:o||l===0,"aria-label":i("first",l),title:i("first",l),...R,children:m?a.jsx(D,{...v.lastButtonIcon}):a.jsx(q,{...v.firstButtonIcon})}),a.jsx(U,{onClick:y,disabled:o||l===0,color:"inherit","aria-label":i("previous",l),title:i("previous",l),...j??n,children:m?a.jsx(W,{...v.nextButtonIcon}):a.jsx(P,{...v.previousButtonIcon})}),a.jsx(k,{onClick:S,disabled:o||(s!==-1?l>=Math.ceil(s/d)-1:!1),color:"inherit","aria-label":i("next",l),title:i("next",l),...A??c,children:m?a.jsx(P,{...v.previousButtonIcon}):a.jsx(W,{...v.nextButtonIcon})}),f&&a.jsx(_,{onClick:C,disabled:o||l>=Math.ceil(s/d)-1,"aria-label":i("last",l),title:i("last",l),...N,children:m?a.jsx(q,{...v.firstButtonIcon}):a.jsx(D,{...v.lastButtonIcon})})]})});function DV(e){return an("MuiTablePagination",e)}const dv=un("MuiTablePagination",["root","toolbar","spacer","selectLabel","selectRoot","select","selectIcon","input","menuItem","displayedRows","actions"]);var G8;const IV=or(qe,{name:"MuiTablePagination",slot:"Root"})(cn(({theme:e})=>({overflow:"auto",color:(e.vars||e).palette.text.primary,fontSize:e.typography.pxToRem(14),"&:last-child":{padding:0}}))),OV=or(LV,{name:"MuiTablePagination",slot:"Toolbar",overridesResolver:(e,r)=>({[`& .${dv.actions}`]:r.actions,...r.toolbar})})(cn(({theme:e})=>({minHeight:52,paddingRight:2,[`${e.breakpoints.up("xs")} and (orientation: landscape)`]:{minHeight:52},[e.breakpoints.up("sm")]:{minHeight:52,paddingRight:2},[`& .${dv.actions}`]:{flexShrink:0,marginLeft:20}}))),PV=or("div",{name:"MuiTablePagination",slot:"Spacer"})({flex:"1 1 100%"}),FV=or("p",{name:"MuiTablePagination",slot:"SelectLabel"})(cn(({theme:e})=>({...e.typography.body2,flexShrink:0}))),BV=or(eh,{name:"MuiTablePagination",slot:"Select",overridesResolver:(e,r)=>({[`& .${dv.selectIcon}`]:r.selectIcon,[`& .${dv.select}`]:r.select,...r.input,...r.selectRoot})})({color:"inherit",fontSize:"inherit",flexShrink:0,marginRight:32,marginLeft:8,[`& .${dv.select}`]:{paddingLeft:8,paddingRight:24,textAlign:"right",textAlignLast:"right"}}),zV=or(zl,{name:"MuiTablePagination",slot:"MenuItem"})({}),$V=or("p",{name:"MuiTablePagination",slot:"DisplayedRows"})(cn(({theme:e})=>({...e.typography.body2,flexShrink:0})));function UV({from:e,to:r,count:t}){return`${e}${r} of ${t!==-1?t:`more than ${r}`}`}function HV(e){return`Go to ${e} page`}const VV=e=>{const{classes:r}=e;return nn({root:["root"],toolbar:["toolbar"],spacer:["spacer"],selectLabel:["selectLabel"],select:["select"],input:["input"],selectIcon:["selectIcon"],menuItem:["menuItem"],displayedRows:["displayedRows"],actions:["actions"]},DV,r)},Zm=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiTablePagination"}),{ActionsComponent:s=MV,backIconButtonProps:o,colSpan:i,component:c=qe,count:u,disabled:l=!1,getItemAriaLabel:d=HV,labelDisplayedRows:h=UV,labelRowsPerPage:f="Rows per page:",nextIconButtonProps:p,onPageChange:v,onRowsPerPageChange:g,page:m,rowsPerPage:b,rowsPerPageOptions:y=[10,25,50,100],SelectProps:S={},showFirstButton:C=!1,showLastButton:L=!1,slotProps:O={},slots:H={},...z}=n,q=n,D=VV(q),W=(O==null?void 0:O.select)??S,P=W.native?"option":zV;let I;(c===qe||c==="td")&&(I=i||1e3);const U=Od(W.id),k=Od(W.labelId),_=()=>u===-1?(m+1)*b:b===-1?u:Math.min(u,(m+1)*b),R={slots:H,slotProps:O},[j,A]=ln("root",{ref:t,className:D.root,elementType:IV,externalForwardedProps:{...R,component:c,...z},ownerState:q,additionalProps:{colSpan:I}}),[N,V]=ln("toolbar",{className:D.toolbar,elementType:OV,externalForwardedProps:R,ownerState:q}),[M,Z]=ln("spacer",{className:D.spacer,elementType:PV,externalForwardedProps:R,ownerState:q}),[J,re]=ln("selectLabel",{className:D.selectLabel,elementType:FV,externalForwardedProps:R,ownerState:q,additionalProps:{id:k}}),[X,ne]=ln("select",{className:D.select,elementType:BV,externalForwardedProps:R,ownerState:q}),[Y,K]=ln("menuItem",{className:D.menuItem,elementType:P,externalForwardedProps:R,ownerState:q}),[ee,ue]=ln("displayedRows",{className:D.displayedRows,elementType:$V,externalForwardedProps:R,ownerState:q});return a.jsx(j,{...A,children:a.jsxs(N,{...V,children:[a.jsx(M,{...Z}),y.length>1&&a.jsx(J,{...re,children:f}),y.length>1&&a.jsx(X,{variant:"standard",...!W.variant&&{input:G8||(G8=a.jsx(yw,{}))},value:b,onChange:g,id:U,labelId:k,...W,classes:{...W.classes,root:Pr(D.input,D.selectRoot,(W.classes||{}).root),select:Pr(D.select,(W.classes||{}).select),icon:Pr(D.selectIcon,(W.classes||{}).icon)},disabled:l,...ne,children:y.map(se=>G.createElement(Y,{...K,key:se.label?se.label:se,value:se.value?se.value:se},se.label?se.label:se))}),a.jsx(ee,{...ue,children:h({from:u===0?0:m*b+1,to:_(),count:u===-1?-1:u,page:m})}),a.jsx(s,{className:D.actions,backIconButtonProps:o,count:u,nextIconButtonProps:p,onPageChange:v,page:m,rowsPerPage:b,showFirstButton:C,showLastButton:L,slotProps:O.actions,slots:H.actions,getItemAriaLabel:d,disabled:l})]})})});function WV(e){return an("MuiTableRow",e)}const K8=un("MuiTableRow",["root","selected","hover","head","footer"]),qV=e=>{const{classes:r,selected:t,hover:n,head:s,footer:o}=e;return nn({root:["root",t&&"selected",n&&"hover",s&&"head",o&&"footer"]},WV,r)},GV=or("tr",{name:"MuiTableRow",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,t.head&&r.head,t.footer&&r.footer]}})(cn(({theme:e})=>({color:"inherit",display:"table-row",verticalAlign:"middle",outline:0,[`&.${K8.hover}:hover`]:{backgroundColor:(e.vars||e).palette.action.hover},[`&.${K8.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:Ca(e.palette.primary.main,e.palette.action.selectedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:Ca(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity)}}}))),X8="tr",pn=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiTableRow"}),{className:s,component:o=X8,hover:i=!1,selected:c=!1,...u}=n,l=G.useContext(Sw),d={...n,component:o,hover:i,selected:c,head:l&&l.variant==="head",footer:l&&l.variant==="footer"},h=qV(d);return a.jsx(GV,{as:o,ref:t,className:Pr(h.root,s),role:o===X8?null:"row",ownerState:d,...u})});function KV(e){return(1+Math.sin(Math.PI*e-Math.PI/2))/2}function XV(e,r,t,n={},s=()=>{}){const{ease:o=KV,duration:i=300}=n;let c=null;const u=r[e];let l=!1;const d=()=>{l=!0},h=f=>{if(l){s(new Error("Animation cancelled"));return}c===null&&(c=f);const p=Math.min(1,(f-c)/i);if(r[e]=o(p)*(t-u)+u,p>=1){requestAnimationFrame(()=>{s(null)});return}requestAnimationFrame(h)};return u===t?(s(new Error("Element already at target position")),d):(requestAnimationFrame(h),d)}const YV={width:99,height:99,position:"absolute",top:-9999,overflow:"scroll"};function ZV(e){const{onChange:r,...t}=e,n=G.useRef(),s=G.useRef(null),o=()=>{n.current=s.current.offsetHeight-s.current.clientHeight};return Jc(()=>{const i=dw(()=>{const u=n.current;o(),u!==n.current&&r(n.current)}),c=Qc(s.current);return c.addEventListener("resize",i),()=>{i.clear(),c.removeEventListener("resize",i)}},[r]),G.useEffect(()=>{o(),r(n.current)},[r]),a.jsx("div",{style:YV,...t,ref:s})}function JV(e){return an("MuiTabScrollButton",e)}const QV=un("MuiTabScrollButton",["root","vertical","horizontal","disabled"]),eW=e=>{const{classes:r,orientation:t,disabled:n}=e;return nn({root:["root",t,n&&"disabled"]},JV,r)},tW=or($f,{name:"MuiTabScrollButton",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,t.orientation&&r[t.orientation]]}})({width:40,flexShrink:0,opacity:.8,[`&.${QV.disabled}`]:{opacity:0},variants:[{props:{orientation:"vertical"},style:{width:"100%",height:40,"& svg":{transform:"var(--TabScrollButton-svgRotate)"}}}]}),rW=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiTabScrollButton"}),{className:s,slots:o={},slotProps:i={},direction:c,orientation:u,disabled:l,...d}=n,h=Xm(),f={isRtl:h,...n},p=eW(f),v=o.StartScrollButtonIcon??k7,g=o.EndScrollButtonIcon??R7,m=Om({elementType:v,externalSlotProps:i.startScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:f}),b=Om({elementType:g,externalSlotProps:i.endScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:f});return a.jsx(tW,{component:"div",className:Pr(p.root,s),ref:t,role:null,ownerState:f,tabIndex:null,...d,style:{...d.style,...u==="vertical"&&{"--TabScrollButton-svgRotate":`rotate(${h?-90:90}deg)`}},children:c==="left"?a.jsx(v,{...m}):a.jsx(g,{...b})})});function nW(e){return an("MuiTabs",e)}const o3=un("MuiTabs",["root","vertical","list","flexContainer","flexContainerVertical","centered","scroller","fixed","scrollableX","scrollableY","hideScrollbar","scrollButtons","scrollButtonsHideMobile","indicator"]),Y8=(e,r)=>e===r?e.firstChild:r&&r.nextElementSibling?r.nextElementSibling:e.firstChild,Z8=(e,r)=>e===r?e.lastChild:r&&r.previousElementSibling?r.previousElementSibling:e.lastChild,_y=(e,r,t)=>{let n=!1,s=t(e,r);for(;s;){if(s===e.firstChild){if(n)return;n=!0}const o=s.disabled||s.getAttribute("aria-disabled")==="true";if(!s.hasAttribute("tabindex")||o)s=t(e,s);else{s.focus();return}}},aW=e=>{const{vertical:r,fixed:t,hideScrollbar:n,scrollableX:s,scrollableY:o,centered:i,scrollButtonsHideMobile:c,classes:u}=e;return nn({root:["root",r&&"vertical"],scroller:["scroller",t&&"fixed",n&&"hideScrollbar",s&&"scrollableX",o&&"scrollableY"],list:["list","flexContainer",r&&"flexContainerVertical",r&&"vertical",i&&"centered"],indicator:["indicator"],scrollButtons:["scrollButtons",c&&"scrollButtonsHideMobile"],scrollableX:[s&&"scrollableX"],hideScrollbar:[n&&"hideScrollbar"]},nW,u)},sW=or("div",{name:"MuiTabs",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[{[`& .${o3.scrollButtons}`]:r.scrollButtons},{[`& .${o3.scrollButtons}`]:t.scrollButtonsHideMobile&&r.scrollButtonsHideMobile},r.root,t.vertical&&r.vertical]}})(cn(({theme:e})=>({overflow:"hidden",minHeight:48,WebkitOverflowScrolling:"touch",display:"flex",variants:[{props:({ownerState:r})=>r.vertical,style:{flexDirection:"column"}},{props:({ownerState:r})=>r.scrollButtonsHideMobile,style:{[`& .${o3.scrollButtons}`]:{[e.breakpoints.down("sm")]:{display:"none"}}}}]}))),iW=or("div",{name:"MuiTabs",slot:"Scroller",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.scroller,t.fixed&&r.fixed,t.hideScrollbar&&r.hideScrollbar,t.scrollableX&&r.scrollableX,t.scrollableY&&r.scrollableY]}})({position:"relative",display:"inline-block",flex:"1 1 auto",whiteSpace:"nowrap",variants:[{props:({ownerState:e})=>e.fixed,style:{overflowX:"hidden",width:"100%"}},{props:({ownerState:e})=>e.hideScrollbar,style:{scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}}},{props:({ownerState:e})=>e.scrollableX,style:{overflowX:"auto",overflowY:"hidden"}},{props:({ownerState:e})=>e.scrollableY,style:{overflowY:"auto",overflowX:"hidden"}}]}),oW=or("div",{name:"MuiTabs",slot:"List",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.list,r.flexContainer,t.vertical&&r.flexContainerVertical,t.centered&&r.centered]}})({display:"flex",variants:[{props:({ownerState:e})=>e.vertical,style:{flexDirection:"column"}},{props:({ownerState:e})=>e.centered,style:{justifyContent:"center"}}]}),lW=or("span",{name:"MuiTabs",slot:"Indicator"})(cn(({theme:e})=>({position:"absolute",height:2,bottom:0,width:"100%",transition:e.transitions.create(),variants:[{props:{indicatorColor:"primary"},style:{backgroundColor:(e.vars||e).palette.primary.main}},{props:{indicatorColor:"secondary"},style:{backgroundColor:(e.vars||e).palette.secondary.main}},{props:({ownerState:r})=>r.vertical,style:{height:"100%",width:2,right:0}}]}))),cW=or(ZV)({overflowX:"auto",overflowY:"hidden",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}}),J8={},uW=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiTabs"}),s=Kf(),o=Xm(),{"aria-label":i,"aria-labelledby":c,action:u,centered:l=!1,children:d,className:h,component:f="div",allowScrollButtonsMobile:p=!1,indicatorColor:v="primary",onChange:g,orientation:m="horizontal",ScrollButtonComponent:b,scrollButtons:y="auto",selectionFollowsFocus:S,slots:C={},slotProps:L={},TabIndicatorProps:O={},TabScrollButtonProps:H={},textColor:z="primary",value:q,variant:D="standard",visibleScrollbar:W=!1,...P}=n,I=D==="scrollable",U=m==="vertical",k=U?"scrollTop":"scrollLeft",_=U?"top":"left",R=U?"bottom":"right",j=U?"clientHeight":"clientWidth",A=U?"height":"width",N={...n,component:f,allowScrollButtonsMobile:p,indicatorColor:v,orientation:m,vertical:U,scrollButtons:y,textColor:z,variant:D,visibleScrollbar:W,fixed:!I,hideScrollbar:I&&!W,scrollableX:I&&!U,scrollableY:I&&U,centered:l&&!I,scrollButtonsHideMobile:!p},V=aW(N),M=Om({elementType:C.StartScrollButtonIcon,externalSlotProps:L.startScrollButtonIcon,ownerState:N}),Z=Om({elementType:C.EndScrollButtonIcon,externalSlotProps:L.endScrollButtonIcon,ownerState:N}),[J,re]=G.useState(!1),[X,ne]=G.useState(J8),[Y,K]=G.useState(!1),[ee,ue]=G.useState(!1),[se,ce]=G.useState(!1),[fe,ve]=G.useState({overflow:"hidden",scrollbarWidth:0}),_e=new Map,le=G.useRef(null),ke=G.useRef(null),Te={slots:C,slotProps:{indicator:O,scrollButton:H,...L}},pe=()=>{const Dt=le.current;let je;if(Dt){const nt=Dt.getBoundingClientRect();je={clientWidth:Dt.clientWidth,scrollLeft:Dt.scrollLeft,scrollTop:Dt.scrollTop,scrollWidth:Dt.scrollWidth,top:nt.top,bottom:nt.bottom,left:nt.left,right:nt.right}}let ct;if(Dt&&q!==!1){const nt=ke.current.children;if(nt.length>0){const Pe=nt[_e.get(q)];ct=Pe?Pe.getBoundingClientRect():null}}return{tabsMeta:je,tabMeta:ct}},ye=Di(()=>{const{tabsMeta:Dt,tabMeta:je}=pe();let ct=0,nt;U?(nt="top",je&&Dt&&(ct=je.top-Dt.top+Dt.scrollTop)):(nt=o?"right":"left",je&&Dt&&(ct=(o?-1:1)*(je[nt]-Dt[nt]+Dt.scrollLeft)));const Pe={[nt]:ct,[A]:je?je[A]:0};if(typeof X[nt]!="number"||typeof X[A]!="number")ne(Pe);else{const Qe=Math.abs(X[nt]-Pe[nt]),gt=Math.abs(X[A]-Pe[A]);(Qe>=1||gt>=1)&&ne(Pe)}}),ge=(Dt,{animation:je=!0}={})=>{je?XV(k,le.current,Dt,{duration:s.transitions.duration.standard}):le.current[k]=Dt},De=Dt=>{let je=le.current[k];U?je+=Dt:je+=Dt*(o?-1:1),ge(je)},He=()=>{const Dt=le.current[j];let je=0;const ct=Array.from(ke.current.children);for(let nt=0;nt<ct.length;nt+=1){const Pe=ct[nt];if(je+Pe[j]>Dt){nt===0&&(je=Dt);break}je+=Pe[j]}return je},Xe=()=>{De(-1*He())},at=()=>{De(He())},[dt,{onChange:wt,...$t}]=ln("scrollbar",{className:Pr(V.scrollableX,V.hideScrollbar),elementType:cW,shouldForwardComponentProp:!0,externalForwardedProps:Te,ownerState:N}),Bt=G.useCallback(Dt=>{wt==null||wt(Dt),ve({overflow:null,scrollbarWidth:Dt})},[wt]),[ft,tr]=ln("scrollButtons",{className:Pr(V.scrollButtons,H.className),elementType:rW,externalForwardedProps:Te,ownerState:N,additionalProps:{orientation:m,slots:{StartScrollButtonIcon:C.startScrollButtonIcon||C.StartScrollButtonIcon,EndScrollButtonIcon:C.endScrollButtonIcon||C.EndScrollButtonIcon},slotProps:{startScrollButtonIcon:M,endScrollButtonIcon:Z}}}),Me=()=>{const Dt={};Dt.scrollbarSizeListener=I?a.jsx(dt,{...$t,onChange:Bt}):null;const ct=I&&(y==="auto"&&(Y||ee)||y===!0);return Dt.scrollButtonStart=ct?a.jsx(ft,{direction:o?"right":"left",onClick:Xe,disabled:!Y,...tr}):null,Dt.scrollButtonEnd=ct?a.jsx(ft,{direction:o?"left":"right",onClick:at,disabled:!ee,...tr}):null,Dt},tt=Di(Dt=>{const{tabsMeta:je,tabMeta:ct}=pe();if(!(!ct||!je)){if(ct[_]<je[_]){const nt=je[k]+(ct[_]-je[_]);ge(nt,{animation:Dt})}else if(ct[R]>je[R]){const nt=je[k]+(ct[R]-je[R]);ge(nt,{animation:Dt})}}}),Ze=Di(()=>{I&&y!==!1&&ce(!se)});G.useEffect(()=>{const Dt=dw(()=>{le.current&&ye()});let je;const ct=Qe=>{Qe.forEach(gt=>{gt.removedNodes.forEach(xe=>{je==null||je.unobserve(xe)}),gt.addedNodes.forEach(xe=>{je==null||je.observe(xe)})}),Dt(),Ze()},nt=Qc(le.current);nt.addEventListener("resize",Dt);let Pe;return typeof ResizeObserver<"u"&&(je=new ResizeObserver(Dt),Array.from(ke.current.children).forEach(Qe=>{je.observe(Qe)})),typeof MutationObserver<"u"&&(Pe=new MutationObserver(ct),Pe.observe(ke.current,{childList:!0})),()=>{Dt.clear(),nt.removeEventListener("resize",Dt),Pe==null||Pe.disconnect(),je==null||je.disconnect()}},[ye,Ze]),G.useEffect(()=>{const Dt=Array.from(ke.current.children),je=Dt.length;if(typeof IntersectionObserver<"u"&&je>0&&I&&y!==!1){const ct=Dt[0],nt=Dt[je-1],Pe={root:le.current,threshold:.99},Qe=Ce=>{K(!Ce[0].isIntersecting)},gt=new IntersectionObserver(Qe,Pe);gt.observe(ct);const xe=Ce=>{ue(!Ce[0].isIntersecting)},Oe=new IntersectionObserver(xe,Pe);return Oe.observe(nt),()=>{gt.disconnect(),Oe.disconnect()}}},[I,y,se,d==null?void 0:d.length]),G.useEffect(()=>{re(!0)},[]),G.useEffect(()=>{ye()}),G.useEffect(()=>{tt(J8!==X)},[tt,X]),G.useImperativeHandle(u,()=>({updateIndicator:ye,updateScrollButtons:Ze}),[ye,Ze]);const[St,et]=ln("indicator",{className:Pr(V.indicator,O.className),elementType:lW,externalForwardedProps:Te,ownerState:N,additionalProps:{style:X}}),Ht=a.jsx(St,{...et});let Nt=0;const kt=G.Children.map(d,Dt=>{if(!G.isValidElement(Dt))return null;const je=Dt.props.value===void 0?Nt:Dt.props.value;_e.set(je,Nt);const ct=je===q;return Nt+=1,G.cloneElement(Dt,{fullWidth:D==="fullWidth",indicator:ct&&!J&&Ht,selected:ct,selectionFollowsFocus:S,onChange:g,textColor:z,value:je,...Nt===1&&q===!1&&!Dt.props.tabIndex?{tabIndex:0}:{}})}),kr=Dt=>{if(Dt.altKey||Dt.shiftKey||Dt.ctrlKey||Dt.metaKey)return;const je=ke.current,ct=co(je).activeElement;if(ct.getAttribute("role")!=="tab")return;let Pe=m==="horizontal"?"ArrowLeft":"ArrowUp",Qe=m==="horizontal"?"ArrowRight":"ArrowDown";switch(m==="horizontal"&&o&&(Pe="ArrowRight",Qe="ArrowLeft"),Dt.key){case Pe:Dt.preventDefault(),_y(je,ct,Z8);break;case Qe:Dt.preventDefault(),_y(je,ct,Y8);break;case"Home":Dt.preventDefault(),_y(je,null,Y8);break;case"End":Dt.preventDefault(),_y(je,null,Z8);break}},Jt=Me(),[Pt,Ur]=ln("root",{ref:t,className:Pr(V.root,h),elementType:sW,externalForwardedProps:{...Te,...P,component:f},ownerState:N}),[Lr,vt]=ln("scroller",{ref:le,className:V.scroller,elementType:iW,externalForwardedProps:Te,ownerState:N,additionalProps:{style:{overflow:fe.overflow,[U?`margin${o?"Left":"Right"}`:"marginBottom"]:W?void 0:-fe.scrollbarWidth}}}),[nr,Cr]=ln("list",{ref:ke,className:Pr(V.list,V.flexContainer),elementType:oW,externalForwardedProps:Te,ownerState:N,getSlotProps:Dt=>({...Dt,onKeyDown:je=>{var ct;kr(je),(ct=Dt.onKeyDown)==null||ct.call(Dt,je)}})});return a.jsxs(Pt,{...Ur,children:[Jt.scrollButtonStart,Jt.scrollbarSizeListener,a.jsxs(Lr,{...vt,children:[a.jsx(nr,{"aria-label":i,"aria-labelledby":c,"aria-orientation":m==="vertical"?"vertical":null,role:"tablist",...Cr,children:kt}),J&&Ht]}),Jt.scrollButtonEnd]})});function dW(e){return an("MuiTextField",e)}un("MuiTextField",["root"]);const fW={standard:P6,filled:I6,outlined:z6},hW=e=>{const{classes:r}=e;return nn({root:["root"]},dW,r)},pW=or(O6,{name:"MuiTextField",slot:"Root"})({}),ri=G.forwardRef(function(r,t){const n=dn({props:r,name:"MuiTextField"}),{autoComplete:s,autoFocus:o=!1,children:i,className:c,color:u="primary",defaultValue:l,disabled:d=!1,error:h=!1,FormHelperTextProps:f,fullWidth:p=!1,helperText:v,id:g,InputLabelProps:m,inputProps:b,InputProps:y,inputRef:S,label:C,maxRows:L,minRows:O,multiline:H=!1,name:z,onBlur:q,onChange:D,onFocus:W,placeholder:P,required:I=!1,rows:U,select:k=!1,SelectProps:_,slots:R={},slotProps:j={},type:A,value:N,variant:V="outlined",...M}=n,Z={...n,autoFocus:o,color:u,disabled:d,error:h,fullWidth:p,multiline:H,required:I,select:k,variant:V},J=hW(Z),re=Od(g),X=v&&re?`${re}-helper-text`:void 0,ne=C&&re?`${re}-label`:void 0,Y=fW[V],K={slots:R,slotProps:{input:y,inputLabel:m,htmlInput:b,formHelperText:f,select:_,...j}},ee={},ue=K.slotProps.inputLabel;V==="outlined"&&(ue&&typeof ue.shrink<"u"&&(ee.notched=ue.shrink),ee.label=C),k&&((!_||!_.native)&&(ee.id=void 0),ee["aria-describedby"]=void 0);const[se,ce]=ln("root",{elementType:pW,shouldForwardComponentProp:!0,externalForwardedProps:{...K,...M},ownerState:Z,className:Pr(J.root,c),ref:t,additionalProps:{disabled:d,error:h,fullWidth:p,required:I,color:u,variant:V}}),[fe,ve]=ln("input",{elementType:Y,externalForwardedProps:K,additionalProps:ee,ownerState:Z}),[_e,le]=ln("inputLabel",{elementType:F6,externalForwardedProps:K,ownerState:Z}),[ke,Te]=ln("htmlInput",{elementType:"input",externalForwardedProps:K,ownerState:Z}),[pe,ye]=ln("formHelperText",{elementType:BU,externalForwardedProps:K,ownerState:Z}),[ge,De]=ln("select",{elementType:eh,externalForwardedProps:K,ownerState:Z}),He=a.jsx(fe,{"aria-describedby":X,autoComplete:s,autoFocus:o,defaultValue:l,fullWidth:p,multiline:H,name:z,rows:U,maxRows:L,minRows:O,type:A,value:N,id:re,inputRef:S,onBlur:q,onChange:D,onFocus:W,placeholder:P,inputProps:Te,slots:{input:R.htmlInput?ke:void 0},...ve});return a.jsxs(se,{...ce,children:[C!=null&&C!==""&&a.jsx(_e,{htmlFor:re,id:ne,...le,children:C}),k?a.jsx(ge,{"aria-describedby":X,id:re,labelId:ne,value:N,input:He,...De,children:i}):He,v&&a.jsx(pe,{id:X,...ye,children:v})]})});function mW({categories:e,onEdit:r,onDelete:t,page:n,rowsPerPage:s}){return a.jsx(Ws,{component:sa,children:a.jsxs(Cs,{size:"small",children:[a.jsx(js,{children:a.jsxs(pn,{children:[a.jsx(qe,{children:"S.No."}),a.jsx(qe,{children:"Category Name"}),a.jsx(qe,{align:"right",children:"Actions"})]})}),a.jsx(fs,{children:e.map((o,i)=>a.jsxs(pn,{sx:{height:36},children:[a.jsx(qe,{sx:{py:.5},children:n*s+i+1}),a.jsx(qe,{sx:{py:.5},children:o.Name}),a.jsxs(qe,{align:"right",sx:{py:.5},children:[a.jsx(sn,{size:"small",onClick:()=>r(o),children:a.jsx(bl,{fontSize:"small"})}),a.jsx(sn,{size:"small",onClick:()=>t(o),children:a.jsx(ql,{fontSize:"small"})})]})]},o.ID))})]})})}var ox=e=>e.type==="checkbox",y0=e=>e instanceof Date,Wo=e=>e==null;const E7=e=>typeof e=="object";var xi=e=>!Wo(e)&&!Array.isArray(e)&&E7(e)&&!y0(e),N7=e=>xi(e)&&e.target?ox(e.target)?e.target.checked:e.target.value:e,gW=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,T7=(e,r)=>e.has(gW(r)),vW=e=>{const r=e.constructor&&e.constructor.prototype;return xi(r)&&r.hasOwnProperty("isPrototypeOf")},H6=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function ao(e){let r;const t=Array.isArray(e),n=typeof FileList<"u"?e instanceof FileList:!1;if(e instanceof Date)r=new Date(e);else if(e instanceof Set)r=new Set(e);else if(!(H6&&(e instanceof Blob||n))&&(t||xi(e)))if(r=t?[]:{},!t&&!vW(e))r=e;else for(const s in e)e.hasOwnProperty(s)&&(r[s]=ao(e[s]));else return e;return r}var _w=e=>Array.isArray(e)?e.filter(Boolean):[],vi=e=>e===void 0,Zr=(e,r,t)=>{if(!r||!xi(e))return t;const n=_w(r.split(/[,[\].]+?/)).reduce((s,o)=>Wo(s)?s:s[o],e);return vi(n)||n===e?vi(e[r])?t:e[r]:n},Ol=e=>typeof e=="boolean",V6=e=>/^\w*$/.test(e),L7=e=>_w(e.replace(/["|']|\]/g,"").split(/\.|\[/)),xs=(e,r,t)=>{let n=-1;const s=V6(r)?[r]:L7(r),o=s.length,i=o-1;for(;++n<o;){const c=s[n];let u=t;if(n!==i){const l=e[c];u=xi(l)||Array.isArray(l)?l:isNaN(+s[n+1])?{}:[]}if(c==="__proto__"||c==="constructor"||c==="prototype")return;e[c]=u,e=e[c]}};const y2={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Vc={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},jd={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},xW=vr.createContext(null),W6=()=>vr.useContext(xW);var M7=(e,r,t,n=!0)=>{const s={defaultValues:r._defaultValues};for(const o in e)Object.defineProperty(s,o,{get:()=>{const i=o;return r._proxyFormState[i]!==Vc.all&&(r._proxyFormState[i]=!n||Vc.all),t&&(t[i]=!0),e[i]}});return s};const q6=typeof window<"u"?G.useLayoutEffect:G.useEffect;function bW(e){const r=W6(),{control:t=r.control,disabled:n,name:s,exact:o}=e||{},[i,c]=vr.useState(t._formState),u=vr.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return q6(()=>t._subscribe({name:s,formState:u.current,exact:o,callback:l=>{!n&&c({...t._formState,...l})}}),[s,n,o]),vr.useEffect(()=>{u.current.isValid&&t._setValid(!0)},[t]),vr.useMemo(()=>M7(i,t,u.current,!1),[i,t])}var Fu=e=>typeof e=="string",D7=(e,r,t,n,s)=>Fu(e)?(n&&r.watch.add(e),Zr(t,e,s)):Array.isArray(e)?e.map(o=>(n&&r.watch.add(o),Zr(t,o))):(n&&(r.watchAll=!0),t);function Dv(e){const r=W6(),{control:t=r.control,name:n,defaultValue:s,disabled:o,exact:i}=e||{},c=vr.useRef(s),[u,l]=vr.useState(t._getWatch(n,c.current));return q6(()=>t._subscribe({name:n,formState:{values:!0},exact:i,callback:d=>!o&&l(D7(n,t._names,d.values||t._formValues,!1,c.current))}),[n,t,o,i]),vr.useEffect(()=>t._removeUnmounted()),u}function yW(e){const r=W6(),{name:t,disabled:n,control:s=r.control,shouldUnregister:o}=e,i=T7(s._names.array,t),c=Dv({control:s,name:t,defaultValue:Zr(s._formValues,t,Zr(s._defaultValues,t,e.defaultValue)),exact:!0}),u=bW({control:s,name:t,exact:!0}),l=vr.useRef(e),d=vr.useRef(s.register(t,{...e.rules,value:c,...Ol(e.disabled)?{disabled:e.disabled}:{}})),h=vr.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Zr(u.errors,t)},isDirty:{enumerable:!0,get:()=>!!Zr(u.dirtyFields,t)},isTouched:{enumerable:!0,get:()=>!!Zr(u.touchedFields,t)},isValidating:{enumerable:!0,get:()=>!!Zr(u.validatingFields,t)},error:{enumerable:!0,get:()=>Zr(u.errors,t)}}),[u,t]),f=vr.useCallback(m=>d.current.onChange({target:{value:N7(m),name:t},type:y2.CHANGE}),[t]),p=vr.useCallback(()=>d.current.onBlur({target:{value:Zr(s._formValues,t),name:t},type:y2.BLUR}),[t,s._formValues]),v=vr.useCallback(m=>{const b=Zr(s._fields,t);b&&m&&(b._f.ref={focus:()=>m.focus&&m.focus(),select:()=>m.select&&m.select(),setCustomValidity:y=>m.setCustomValidity(y),reportValidity:()=>m.reportValidity()})},[s._fields,t]),g=vr.useMemo(()=>({name:t,value:c,...Ol(n)||u.disabled?{disabled:u.disabled||n}:{},onChange:f,onBlur:p,ref:v}),[t,n,u.disabled,f,p,v,c]);return vr.useEffect(()=>{const m=s._options.shouldUnregister||o;s.register(t,{...l.current.rules,...Ol(l.current.disabled)?{disabled:l.current.disabled}:{}});const b=(y,S)=>{const C=Zr(s._fields,y);C&&C._f&&(C._f.mount=S)};if(b(t,!0),m){const y=ao(Zr(s._options.defaultValues,t));xs(s._defaultValues,t,y),vi(Zr(s._formValues,t))&&xs(s._formValues,t,y)}return!i&&s.register(t),()=>{(i?m&&!s._state.action:m)?s.unregister(t):b(t,!1)}},[t,s,i,o]),vr.useEffect(()=>{s._setDisabledField({disabled:n,name:t})},[n,t,s]),vr.useMemo(()=>({field:g,formState:u,fieldState:h}),[g,u,h])}const En=e=>e.render(yW(e));var wW=(e,r,t,n,s)=>r?{...t[e],types:{...t[e]&&t[e].types?t[e].types:{},[n]:s||!0}}:{},fv=e=>Array.isArray(e)?e:[e],Q8=()=>{let e=[];return{get observers(){return e},next:s=>{for(const o of e)o.next&&o.next(s)},subscribe:s=>(e.push(s),{unsubscribe:()=>{e=e.filter(o=>o!==s)}}),unsubscribe:()=>{e=[]}}},jS=e=>Wo(e)||!E7(e);function If(e,r){if(jS(e)||jS(r))return e===r;if(y0(e)&&y0(r))return e.getTime()===r.getTime();const t=Object.keys(e),n=Object.keys(r);if(t.length!==n.length)return!1;for(const s of t){const o=e[s];if(!n.includes(s))return!1;if(s!=="ref"){const i=r[s];if(y0(o)&&y0(i)||xi(o)&&xi(i)||Array.isArray(o)&&Array.isArray(i)?!If(o,i):o!==i)return!1}}return!0}var cl=e=>xi(e)&&!Object.keys(e).length,G6=e=>e.type==="file",Wc=e=>typeof e=="function",w2=e=>{if(!H6)return!1;const r=e?e.ownerDocument:0;return e instanceof(r&&r.defaultView?r.defaultView.HTMLElement:HTMLElement)},I7=e=>e.type==="select-multiple",K6=e=>e.type==="radio",SW=e=>K6(e)||ox(e),l3=e=>w2(e)&&e.isConnected;function _W(e,r){const t=r.slice(0,-1).length;let n=0;for(;n<t;)e=vi(e)?n++:e[r[n++]];return e}function AW(e){for(const r in e)if(e.hasOwnProperty(r)&&!vi(e[r]))return!1;return!0}function Li(e,r){const t=Array.isArray(r)?r:V6(r)?[r]:L7(r),n=t.length===1?e:_W(e,t),s=t.length-1,o=t[s];return n&&delete n[o],s!==0&&(xi(n)&&cl(n)||Array.isArray(n)&&AW(n))&&Li(e,t.slice(0,-1)),e}var O7=e=>{for(const r in e)if(Wc(e[r]))return!0;return!1};function S2(e,r={}){const t=Array.isArray(e);if(xi(e)||t)for(const n in e)Array.isArray(e[n])||xi(e[n])&&!O7(e[n])?(r[n]=Array.isArray(e[n])?[]:{},S2(e[n],r[n])):Wo(e[n])||(r[n]=!0);return r}function P7(e,r,t){const n=Array.isArray(e);if(xi(e)||n)for(const s in e)Array.isArray(e[s])||xi(e[s])&&!O7(e[s])?vi(r)||jS(t[s])?t[s]=Array.isArray(e[s])?S2(e[s],[]):{...S2(e[s])}:P7(e[s],Wo(r)?{}:r[s],t[s]):t[s]=!If(e[s],r[s]);return t}var B1=(e,r)=>P7(e,r,S2(r));const eA={value:!1,isValid:!1},tA={value:!0,isValid:!0};var F7=e=>{if(Array.isArray(e)){if(e.length>1){const r=e.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:r,isValid:!!r.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!vi(e[0].attributes.value)?vi(e[0].value)||e[0].value===""?tA:{value:e[0].value,isValid:!0}:tA:eA}return eA},B7=(e,{valueAsNumber:r,valueAsDate:t,setValueAs:n})=>vi(e)?e:r?e===""?NaN:e&&+e:t&&Fu(e)?new Date(e):n?n(e):e;const rA={isValid:!1,value:null};var z7=e=>Array.isArray(e)?e.reduce((r,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:r,rA):rA;function nA(e){const r=e.ref;return G6(r)?r.files:K6(r)?z7(e.refs).value:I7(r)?[...r.selectedOptions].map(({value:t})=>t):ox(r)?F7(e.refs).value:B7(vi(r.value)?e.ref.value:r.value,e)}var CW=(e,r,t,n)=>{const s={};for(const o of e){const i=Zr(r,o);i&&xs(s,o,i._f)}return{criteriaMode:t,names:[...e],fields:s,shouldUseNativeValidation:n}},_2=e=>e instanceof RegExp,z1=e=>vi(e)?e:_2(e)?e.source:xi(e)?_2(e.value)?e.value.source:e.value:e,aA=e=>({isOnSubmit:!e||e===Vc.onSubmit,isOnBlur:e===Vc.onBlur,isOnChange:e===Vc.onChange,isOnAll:e===Vc.all,isOnTouch:e===Vc.onTouched});const sA="AsyncFunction";var jW=e=>!!e&&!!e.validate&&!!(Wc(e.validate)&&e.validate.constructor.name===sA||xi(e.validate)&&Object.values(e.validate).find(r=>r.constructor.name===sA)),kW=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),iA=(e,r,t)=>!t&&(r.watchAll||r.watch.has(e)||[...r.watch].some(n=>e.startsWith(n)&&/^\.\w+/.test(e.slice(n.length))));const hv=(e,r,t,n)=>{for(const s of t||Object.keys(e)){const o=Zr(e,s);if(o){const{_f:i,...c}=o;if(i){if(i.refs&&i.refs[0]&&r(i.refs[0],s)&&!n)return!0;if(i.ref&&r(i.ref,i.name)&&!n)return!0;if(hv(c,r))break}else if(xi(c)&&hv(c,r))break}}};function oA(e,r,t){const n=Zr(e,t);if(n||V6(t))return{error:n,name:t};const s=t.split(".");for(;s.length;){const o=s.join("."),i=Zr(r,o),c=Zr(e,o);if(i&&!Array.isArray(i)&&t!==o)return{name:t};if(c&&c.type)return{name:o,error:c};if(c&&c.root&&c.root.type)return{name:`${o}.root`,error:c.root};s.pop()}return{name:t}}var RW=(e,r,t,n)=>{t(e);const{name:s,...o}=e;return cl(o)||Object.keys(o).length>=Object.keys(r).length||Object.keys(o).find(i=>r[i]===(!n||Vc.all))},EW=(e,r,t)=>!e||!r||e===r||fv(e).some(n=>n&&(t?n===r:n.startsWith(r)||r.startsWith(n))),NW=(e,r,t,n,s)=>s.isOnAll?!1:!t&&s.isOnTouch?!(r||e):(t?n.isOnBlur:s.isOnBlur)?!e:(t?n.isOnChange:s.isOnChange)?e:!0,TW=(e,r)=>!_w(Zr(e,r)).length&&Li(e,r),LW=(e,r,t)=>{const n=fv(Zr(e,t));return xs(n,"root",r[t]),xs(e,t,n),e},Zy=e=>Fu(e);function lA(e,r,t="validate"){if(Zy(e)||Array.isArray(e)&&e.every(Zy)||Ol(e)&&!e)return{type:t,message:Zy(e)?e:"",ref:r}}var vm=e=>xi(e)&&!_2(e)?e:{value:e,message:""},cA=async(e,r,t,n,s,o)=>{const{ref:i,refs:c,required:u,maxLength:l,minLength:d,min:h,max:f,pattern:p,validate:v,name:g,valueAsNumber:m,mount:b}=e._f,y=Zr(t,g);if(!b||r.has(g))return{};const S=c?c[0]:i,C=P=>{s&&S.reportValidity&&(S.setCustomValidity(Ol(P)?"":P||""),S.reportValidity())},L={},O=K6(i),H=ox(i),z=O||H,q=(m||G6(i))&&vi(i.value)&&vi(y)||w2(i)&&i.value===""||y===""||Array.isArray(y)&&!y.length,D=wW.bind(null,g,n,L),W=(P,I,U,k=jd.maxLength,_=jd.minLength)=>{const R=P?I:U;L[g]={type:P?k:_,message:R,ref:i,...D(P?k:_,R)}};if(o?!Array.isArray(y)||!y.length:u&&(!z&&(q||Wo(y))||Ol(y)&&!y||H&&!F7(c).isValid||O&&!z7(c).isValid)){const{value:P,message:I}=Zy(u)?{value:!!u,message:u}:vm(u);if(P&&(L[g]={type:jd.required,message:I,ref:S,...D(jd.required,I)},!n))return C(I),L}if(!q&&(!Wo(h)||!Wo(f))){let P,I;const U=vm(f),k=vm(h);if(!Wo(y)&&!isNaN(y)){const _=i.valueAsNumber||y&&+y;Wo(U.value)||(P=_>U.value),Wo(k.value)||(I=_<k.value)}else{const _=i.valueAsDate||new Date(y),R=N=>new Date(new Date().toDateString()+" "+N),j=i.type=="time",A=i.type=="week";Fu(U.value)&&y&&(P=j?R(y)>R(U.value):A?y>U.value:_>new Date(U.value)),Fu(k.value)&&y&&(I=j?R(y)<R(k.value):A?y<k.value:_<new Date(k.value))}if((P||I)&&(W(!!P,U.message,k.message,jd.max,jd.min),!n))return C(L[g].message),L}if((l||d)&&!q&&(Fu(y)||o&&Array.isArray(y))){const P=vm(l),I=vm(d),U=!Wo(P.value)&&y.length>+P.value,k=!Wo(I.value)&&y.length<+I.value;if((U||k)&&(W(U,P.message,I.message),!n))return C(L[g].message),L}if(p&&!q&&Fu(y)){const{value:P,message:I}=vm(p);if(_2(P)&&!y.match(P)&&(L[g]={type:jd.pattern,message:I,ref:i,...D(jd.pattern,I)},!n))return C(I),L}if(v){if(Wc(v)){const P=await v(y,t),I=lA(P,S);if(I&&(L[g]={...I,...D(jd.validate,I.message)},!n))return C(I.message),L}else if(xi(v)){let P={};for(const I in v){if(!cl(P)&&!n)break;const U=lA(await v[I](y,t),S,I);U&&(P={...U,...D(I,U.message)},C(U.message),n&&(L[g]=P))}if(!cl(P)&&(L[g]={ref:S,...P},!n))return L}}return C(!0),L};const MW={mode:Vc.onSubmit,reValidateMode:Vc.onChange,shouldFocusError:!0};function DW(e={}){let r={...MW,...e},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:Wc(r.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:r.errors||{},disabled:r.disabled||!1};const n={};let s=xi(r.defaultValues)||xi(r.values)?ao(r.defaultValues||r.values)||{}:{},o=r.shouldUnregister?{}:ao(s),i={action:!1,mount:!1,watch:!1},c={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},u,l=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let h={...d};const f={array:Q8(),state:Q8()},p=r.criteriaMode===Vc.all,v=pe=>ye=>{clearTimeout(l),l=setTimeout(pe,ye)},g=async pe=>{if(!r.disabled&&(d.isValid||h.isValid||pe)){const ye=r.resolver?cl((await H()).errors):await q(n,!0);ye!==t.isValid&&f.state.next({isValid:ye})}},m=(pe,ye)=>{!r.disabled&&(d.isValidating||d.validatingFields||h.isValidating||h.validatingFields)&&((pe||Array.from(c.mount)).forEach(ge=>{ge&&(ye?xs(t.validatingFields,ge,ye):Li(t.validatingFields,ge))}),f.state.next({validatingFields:t.validatingFields,isValidating:!cl(t.validatingFields)}))},b=(pe,ye=[],ge,De,He=!0,Xe=!0)=>{if(De&&ge&&!r.disabled){if(i.action=!0,Xe&&Array.isArray(Zr(n,pe))){const at=ge(Zr(n,pe),De.argA,De.argB);He&&xs(n,pe,at)}if(Xe&&Array.isArray(Zr(t.errors,pe))){const at=ge(Zr(t.errors,pe),De.argA,De.argB);He&&xs(t.errors,pe,at),TW(t.errors,pe)}if((d.touchedFields||h.touchedFields)&&Xe&&Array.isArray(Zr(t.touchedFields,pe))){const at=ge(Zr(t.touchedFields,pe),De.argA,De.argB);He&&xs(t.touchedFields,pe,at)}(d.dirtyFields||h.dirtyFields)&&(t.dirtyFields=B1(s,o)),f.state.next({name:pe,isDirty:W(pe,ye),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else xs(o,pe,ye)},y=(pe,ye)=>{xs(t.errors,pe,ye),f.state.next({errors:t.errors})},S=pe=>{t.errors=pe,f.state.next({errors:t.errors,isValid:!1})},C=(pe,ye,ge,De)=>{const He=Zr(n,pe);if(He){const Xe=Zr(o,pe,vi(ge)?Zr(s,pe):ge);vi(Xe)||De&&De.defaultChecked||ye?xs(o,pe,ye?Xe:nA(He._f)):U(pe,Xe),i.mount&&g()}},L=(pe,ye,ge,De,He)=>{let Xe=!1,at=!1;const dt={name:pe};if(!r.disabled){if(!ge||De){(d.isDirty||h.isDirty)&&(at=t.isDirty,t.isDirty=dt.isDirty=W(),Xe=at!==dt.isDirty);const wt=If(Zr(s,pe),ye);at=!!Zr(t.dirtyFields,pe),wt?Li(t.dirtyFields,pe):xs(t.dirtyFields,pe,!0),dt.dirtyFields=t.dirtyFields,Xe=Xe||(d.dirtyFields||h.dirtyFields)&&at!==!wt}if(ge){const wt=Zr(t.touchedFields,pe);wt||(xs(t.touchedFields,pe,ge),dt.touchedFields=t.touchedFields,Xe=Xe||(d.touchedFields||h.touchedFields)&&wt!==ge)}Xe&&He&&f.state.next(dt)}return Xe?dt:{}},O=(pe,ye,ge,De)=>{const He=Zr(t.errors,pe),Xe=(d.isValid||h.isValid)&&Ol(ye)&&t.isValid!==ye;if(r.delayError&&ge?(u=v(()=>y(pe,ge)),u(r.delayError)):(clearTimeout(l),u=null,ge?xs(t.errors,pe,ge):Li(t.errors,pe)),(ge?!If(He,ge):He)||!cl(De)||Xe){const at={...De,...Xe&&Ol(ye)?{isValid:ye}:{},errors:t.errors,name:pe};t={...t,...at},f.state.next(at)}},H=async pe=>{m(pe,!0);const ye=await r.resolver(o,r.context,CW(pe||c.mount,n,r.criteriaMode,r.shouldUseNativeValidation));return m(pe),ye},z=async pe=>{const{errors:ye}=await H(pe);if(pe)for(const ge of pe){const De=Zr(ye,ge);De?xs(t.errors,ge,De):Li(t.errors,ge)}else t.errors=ye;return ye},q=async(pe,ye,ge={valid:!0})=>{for(const De in pe){const He=pe[De];if(He){const{_f:Xe,...at}=He;if(Xe){const dt=c.array.has(Xe.name),wt=He._f&&jW(He._f);wt&&d.validatingFields&&m([De],!0);const $t=await cA(He,c.disabled,o,p,r.shouldUseNativeValidation&&!ye,dt);if(wt&&d.validatingFields&&m([De]),$t[Xe.name]&&(ge.valid=!1,ye))break;!ye&&(Zr($t,Xe.name)?dt?LW(t.errors,$t,Xe.name):xs(t.errors,Xe.name,$t[Xe.name]):Li(t.errors,Xe.name))}!cl(at)&&await q(at,ye,ge)}}return ge.valid},D=()=>{for(const pe of c.unMount){const ye=Zr(n,pe);ye&&(ye._f.refs?ye._f.refs.every(ge=>!l3(ge)):!l3(ye._f.ref))&&ne(pe)}c.unMount=new Set},W=(pe,ye)=>!r.disabled&&(pe&&ye&&xs(o,pe,ye),!If(N(),s)),P=(pe,ye,ge)=>D7(pe,c,{...i.mount?o:vi(ye)?s:Fu(pe)?{[pe]:ye}:ye},ge,ye),I=pe=>_w(Zr(i.mount?o:s,pe,r.shouldUnregister?Zr(s,pe,[]):[])),U=(pe,ye,ge={})=>{const De=Zr(n,pe);let He=ye;if(De){const Xe=De._f;Xe&&(!Xe.disabled&&xs(o,pe,B7(ye,Xe)),He=w2(Xe.ref)&&Wo(ye)?"":ye,I7(Xe.ref)?[...Xe.ref.options].forEach(at=>at.selected=He.includes(at.value)):Xe.refs?ox(Xe.ref)?Xe.refs.forEach(at=>{(!at.defaultChecked||!at.disabled)&&(Array.isArray(He)?at.checked=!!He.find(dt=>dt===at.value):at.checked=He===at.value||!!He)}):Xe.refs.forEach(at=>at.checked=at.value===He):G6(Xe.ref)?Xe.ref.value="":(Xe.ref.value=He,Xe.ref.type||f.state.next({name:pe,values:ao(o)})))}(ge.shouldDirty||ge.shouldTouch)&&L(pe,He,ge.shouldTouch,ge.shouldDirty,!0),ge.shouldValidate&&A(pe)},k=(pe,ye,ge)=>{for(const De in ye){if(!ye.hasOwnProperty(De))return;const He=ye[De],Xe=pe+"."+De,at=Zr(n,Xe);(c.array.has(pe)||xi(He)||at&&!at._f)&&!y0(He)?k(Xe,He,ge):U(Xe,He,ge)}},_=(pe,ye,ge={})=>{const De=Zr(n,pe),He=c.array.has(pe),Xe=ao(ye);xs(o,pe,Xe),He?(f.array.next({name:pe,values:ao(o)}),(d.isDirty||d.dirtyFields||h.isDirty||h.dirtyFields)&&ge.shouldDirty&&f.state.next({name:pe,dirtyFields:B1(s,o),isDirty:W(pe,Xe)})):De&&!De._f&&!Wo(Xe)?k(pe,Xe,ge):U(pe,Xe,ge),iA(pe,c)&&f.state.next({...t}),f.state.next({name:i.mount?pe:void 0,values:ao(o)})},R=async pe=>{i.mount=!0;const ye=pe.target;let ge=ye.name,De=!0;const He=Zr(n,ge),Xe=wt=>{De=Number.isNaN(wt)||y0(wt)&&isNaN(wt.getTime())||If(wt,Zr(o,ge,wt))},at=aA(r.mode),dt=aA(r.reValidateMode);if(He){let wt,$t;const Bt=ye.type?nA(He._f):N7(pe),ft=pe.type===y2.BLUR||pe.type===y2.FOCUS_OUT,tr=!kW(He._f)&&!r.resolver&&!Zr(t.errors,ge)&&!He._f.deps||NW(ft,Zr(t.touchedFields,ge),t.isSubmitted,dt,at),Me=iA(ge,c,ft);xs(o,ge,Bt),ft?(He._f.onBlur&&He._f.onBlur(pe),u&&u(0)):He._f.onChange&&He._f.onChange(pe);const tt=L(ge,Bt,ft),Ze=!cl(tt)||Me;if(!ft&&f.state.next({name:ge,type:pe.type,values:ao(o)}),tr)return(d.isValid||h.isValid)&&(r.mode==="onBlur"?ft&&g():ft||g()),Ze&&f.state.next({name:ge,...Me?{}:tt});if(!ft&&Me&&f.state.next({...t}),r.resolver){const{errors:St}=await H([ge]);if(Xe(Bt),De){const et=oA(t.errors,n,ge),Ht=oA(St,n,et.name||ge);wt=Ht.error,ge=Ht.name,$t=cl(St)}}else m([ge],!0),wt=(await cA(He,c.disabled,o,p,r.shouldUseNativeValidation))[ge],m([ge]),Xe(Bt),De&&(wt?$t=!1:(d.isValid||h.isValid)&&($t=await q(n,!0)));De&&(He._f.deps&&A(He._f.deps),O(ge,$t,wt,tt))}},j=(pe,ye)=>{if(Zr(t.errors,ye)&&pe.focus)return pe.focus(),1},A=async(pe,ye={})=>{let ge,De;const He=fv(pe);if(r.resolver){const Xe=await z(vi(pe)?pe:He);ge=cl(Xe),De=pe?!He.some(at=>Zr(Xe,at)):ge}else pe?(De=(await Promise.all(He.map(async Xe=>{const at=Zr(n,Xe);return await q(at&&at._f?{[Xe]:at}:at)}))).every(Boolean),!(!De&&!t.isValid)&&g()):De=ge=await q(n);return f.state.next({...!Fu(pe)||(d.isValid||h.isValid)&&ge!==t.isValid?{}:{name:pe},...r.resolver||!pe?{isValid:ge}:{},errors:t.errors}),ye.shouldFocus&&!De&&hv(n,j,pe?He:c.mount),De},N=pe=>{const ye={...i.mount?o:s};return vi(pe)?ye:Fu(pe)?Zr(ye,pe):pe.map(ge=>Zr(ye,ge))},V=(pe,ye)=>({invalid:!!Zr((ye||t).errors,pe),isDirty:!!Zr((ye||t).dirtyFields,pe),error:Zr((ye||t).errors,pe),isValidating:!!Zr(t.validatingFields,pe),isTouched:!!Zr((ye||t).touchedFields,pe)}),M=pe=>{pe&&fv(pe).forEach(ye=>Li(t.errors,ye)),f.state.next({errors:pe?t.errors:{}})},Z=(pe,ye,ge)=>{const De=(Zr(n,pe,{_f:{}})._f||{}).ref,He=Zr(t.errors,pe)||{},{ref:Xe,message:at,type:dt,...wt}=He;xs(t.errors,pe,{...wt,...ye,ref:De}),f.state.next({name:pe,errors:t.errors,isValid:!1}),ge&&ge.shouldFocus&&De&&De.focus&&De.focus()},J=(pe,ye)=>Wc(pe)?f.state.subscribe({next:ge=>pe(P(void 0,ye),ge)}):P(pe,ye,!0),re=pe=>f.state.subscribe({next:ye=>{EW(pe.name,ye.name,pe.exact)&&RW(ye,pe.formState||d,le,pe.reRenderRoot)&&pe.callback({values:{...o},...t,...ye})}}).unsubscribe,X=pe=>(i.mount=!0,h={...h,...pe.formState},re({...pe,formState:h})),ne=(pe,ye={})=>{for(const ge of pe?fv(pe):c.mount)c.mount.delete(ge),c.array.delete(ge),ye.keepValue||(Li(n,ge),Li(o,ge)),!ye.keepError&&Li(t.errors,ge),!ye.keepDirty&&Li(t.dirtyFields,ge),!ye.keepTouched&&Li(t.touchedFields,ge),!ye.keepIsValidating&&Li(t.validatingFields,ge),!r.shouldUnregister&&!ye.keepDefaultValue&&Li(s,ge);f.state.next({values:ao(o)}),f.state.next({...t,...ye.keepDirty?{isDirty:W()}:{}}),!ye.keepIsValid&&g()},Y=({disabled:pe,name:ye})=>{(Ol(pe)&&i.mount||pe||c.disabled.has(ye))&&(pe?c.disabled.add(ye):c.disabled.delete(ye))},K=(pe,ye={})=>{let ge=Zr(n,pe);const De=Ol(ye.disabled)||Ol(r.disabled);return xs(n,pe,{...ge||{},_f:{...ge&&ge._f?ge._f:{ref:{name:pe}},name:pe,mount:!0,...ye}}),c.mount.add(pe),ge?Y({disabled:Ol(ye.disabled)?ye.disabled:r.disabled,name:pe}):C(pe,!0,ye.value),{...De?{disabled:ye.disabled||r.disabled}:{},...r.progressive?{required:!!ye.required,min:z1(ye.min),max:z1(ye.max),minLength:z1(ye.minLength),maxLength:z1(ye.maxLength),pattern:z1(ye.pattern)}:{},name:pe,onChange:R,onBlur:R,ref:He=>{if(He){K(pe,ye),ge=Zr(n,pe);const Xe=vi(He.value)&&He.querySelectorAll&&He.querySelectorAll("input,select,textarea")[0]||He,at=SW(Xe),dt=ge._f.refs||[];if(at?dt.find(wt=>wt===Xe):Xe===ge._f.ref)return;xs(n,pe,{_f:{...ge._f,...at?{refs:[...dt.filter(l3),Xe,...Array.isArray(Zr(s,pe))?[{}]:[]],ref:{type:Xe.type,name:pe}}:{ref:Xe}}}),C(pe,!1,void 0,Xe)}else ge=Zr(n,pe,{}),ge._f&&(ge._f.mount=!1),(r.shouldUnregister||ye.shouldUnregister)&&!(T7(c.array,pe)&&i.action)&&c.unMount.add(pe)}}},ee=()=>r.shouldFocusError&&hv(n,j,c.mount),ue=pe=>{Ol(pe)&&(f.state.next({disabled:pe}),hv(n,(ye,ge)=>{const De=Zr(n,ge);De&&(ye.disabled=De._f.disabled||pe,Array.isArray(De._f.refs)&&De._f.refs.forEach(He=>{He.disabled=De._f.disabled||pe}))},0,!1))},se=(pe,ye)=>async ge=>{let De;ge&&(ge.preventDefault&&ge.preventDefault(),ge.persist&&ge.persist());let He=ao(o);if(f.state.next({isSubmitting:!0}),r.resolver){const{errors:Xe,values:at}=await H();t.errors=Xe,He=at}else await q(n);if(c.disabled.size)for(const Xe of c.disabled)xs(He,Xe,void 0);if(Li(t.errors,"root"),cl(t.errors)){f.state.next({errors:{}});try{await pe(He,ge)}catch(Xe){De=Xe}}else ye&&await ye({...t.errors},ge),ee(),setTimeout(ee);if(f.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:cl(t.errors)&&!De,submitCount:t.submitCount+1,errors:t.errors}),De)throw De},ce=(pe,ye={})=>{Zr(n,pe)&&(vi(ye.defaultValue)?_(pe,ao(Zr(s,pe))):(_(pe,ye.defaultValue),xs(s,pe,ao(ye.defaultValue))),ye.keepTouched||Li(t.touchedFields,pe),ye.keepDirty||(Li(t.dirtyFields,pe),t.isDirty=ye.defaultValue?W(pe,ao(Zr(s,pe))):W()),ye.keepError||(Li(t.errors,pe),d.isValid&&g()),f.state.next({...t}))},fe=(pe,ye={})=>{const ge=pe?ao(pe):s,De=ao(ge),He=cl(pe),Xe=He?s:De;if(ye.keepDefaultValues||(s=ge),!ye.keepValues){if(ye.keepDirtyValues){const at=new Set([...c.mount,...Object.keys(B1(s,o))]);for(const dt of Array.from(at))Zr(t.dirtyFields,dt)?xs(Xe,dt,Zr(o,dt)):_(dt,Zr(Xe,dt))}else{if(H6&&vi(pe))for(const at of c.mount){const dt=Zr(n,at);if(dt&&dt._f){const wt=Array.isArray(dt._f.refs)?dt._f.refs[0]:dt._f.ref;if(w2(wt)){const $t=wt.closest("form");if($t){$t.reset();break}}}}for(const at of c.mount)_(at,Zr(Xe,at))}o=ao(Xe),f.array.next({values:{...Xe}}),f.state.next({values:{...Xe}})}c={mount:ye.keepDirtyValues?c.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},i.mount=!d.isValid||!!ye.keepIsValid||!!ye.keepDirtyValues,i.watch=!!r.shouldUnregister,f.state.next({submitCount:ye.keepSubmitCount?t.submitCount:0,isDirty:He?!1:ye.keepDirty?t.isDirty:!!(ye.keepDefaultValues&&!If(pe,s)),isSubmitted:ye.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:He?{}:ye.keepDirtyValues?ye.keepDefaultValues&&o?B1(s,o):t.dirtyFields:ye.keepDefaultValues&&pe?B1(s,pe):ye.keepDirty?t.dirtyFields:{},touchedFields:ye.keepTouched?t.touchedFields:{},errors:ye.keepErrors?t.errors:{},isSubmitSuccessful:ye.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1})},ve=(pe,ye)=>fe(Wc(pe)?pe(o):pe,ye),_e=(pe,ye={})=>{const ge=Zr(n,pe),De=ge&&ge._f;if(De){const He=De.refs?De.refs[0]:De.ref;He.focus&&(He.focus(),ye.shouldSelect&&Wc(He.select)&&He.select())}},le=pe=>{t={...t,...pe}},Te={control:{register:K,unregister:ne,getFieldState:V,handleSubmit:se,setError:Z,_subscribe:re,_runSchema:H,_focusError:ee,_getWatch:P,_getDirty:W,_setValid:g,_setFieldArray:b,_setDisabledField:Y,_setErrors:S,_getFieldArray:I,_reset:fe,_resetDefaultValues:()=>Wc(r.defaultValues)&&r.defaultValues().then(pe=>{ve(pe,r.resetOptions),f.state.next({isLoading:!1})}),_removeUnmounted:D,_disableForm:ue,_subjects:f,_proxyFormState:d,get _fields(){return n},get _formValues(){return o},get _state(){return i},set _state(pe){i=pe},get _defaultValues(){return s},get _names(){return c},set _names(pe){c=pe},get _formState(){return t},get _options(){return r},set _options(pe){r={...r,...pe}}},subscribe:X,trigger:A,register:K,handleSubmit:se,watch:J,setValue:_,getValues:N,reset:ve,resetField:ce,clearErrors:M,unregister:ne,setError:Z,setFocus:_e,getFieldState:V};return{...Te,formControl:Te}}function Gl(e={}){const r=vr.useRef(void 0),t=vr.useRef(void 0),[n,s]=vr.useState({isDirty:!1,isValidating:!1,isLoading:Wc(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:Wc(e.defaultValues)?void 0:e.defaultValues});r.current||(r.current={...e.formControl?e.formControl:DW(e),formState:n},e.formControl&&e.defaultValues&&!Wc(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions));const o=r.current.control;return o._options=e,q6(()=>{const i=o._subscribe({formState:o._proxyFormState,callback:()=>s({...o._formState}),reRenderRoot:!0});return s(c=>({...c,isReady:!0})),o._formState.isReady=!0,i},[o]),vr.useEffect(()=>o._disableForm(e.disabled),[o,e.disabled]),vr.useEffect(()=>{e.mode&&(o._options.mode=e.mode),e.reValidateMode&&(o._options.reValidateMode=e.reValidateMode)},[o,e.mode,e.reValidateMode]),vr.useEffect(()=>{e.errors&&(o._setErrors(e.errors),o._focusError())},[o,e.errors]),vr.useEffect(()=>{e.shouldUnregister&&o._subjects.state.next({values:o._getWatch()})},[o,e.shouldUnregister]),vr.useEffect(()=>{if(o._proxyFormState.isDirty){const i=o._getDirty();i!==n.isDirty&&o._subjects.state.next({isDirty:i})}},[o,n.isDirty]),vr.useEffect(()=>{e.values&&!If(e.values,t.current)?(o._reset(e.values,o._options.resetOptions),t.current=e.values,s(i=>({...i}))):o._resetDefaultValues()},[o,e.values]),vr.useEffect(()=>{o._state.mount||(o._setValid(),o._state.mount=!0),o._state.watch&&(o._state.watch=!1,o._subjects.state.next({...o._formState})),o._removeUnmounted()}),r.current.formState=M7(n,o),r.current}function $7(e,r){return function(){return e.apply(r,arguments)}}const{toString:IW}=Object.prototype,{getPrototypeOf:X6}=Object,{iterator:Aw,toStringTag:U7}=Symbol,Cw=(e=>r=>{const t=IW.call(r);return e[t]||(e[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),ru=e=>(e=e.toLowerCase(),r=>Cw(r)===e),jw=e=>r=>typeof r===e,{isArray:Jm}=Array,Iv=jw("undefined");function OW(e){return e!==null&&!Iv(e)&&e.constructor!==null&&!Iv(e.constructor)&&hl(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const H7=ru("ArrayBuffer");function PW(e){let r;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?r=ArrayBuffer.isView(e):r=e&&e.buffer&&H7(e.buffer),r}const FW=jw("string"),hl=jw("function"),V7=jw("number"),kw=e=>e!==null&&typeof e=="object",BW=e=>e===!0||e===!1,Jy=e=>{if(Cw(e)!=="object")return!1;const r=X6(e);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(U7 in e)&&!(Aw in e)},zW=ru("Date"),$W=ru("File"),UW=ru("Blob"),HW=ru("FileList"),VW=e=>kw(e)&&hl(e.pipe),WW=e=>{let r;return e&&(typeof FormData=="function"&&e instanceof FormData||hl(e.append)&&((r=Cw(e))==="formdata"||r==="object"&&hl(e.toString)&&e.toString()==="[object FormData]"))},qW=ru("URLSearchParams"),[GW,KW,XW,YW]=["ReadableStream","Request","Response","Headers"].map(ru),ZW=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function lx(e,r,{allOwnKeys:t=!1}={}){if(e===null||typeof e>"u")return;let n,s;if(typeof e!="object"&&(e=[e]),Jm(e))for(n=0,s=e.length;n<s;n++)r.call(null,e[n],n,e);else{const o=t?Object.getOwnPropertyNames(e):Object.keys(e),i=o.length;let c;for(n=0;n<i;n++)c=o[n],r.call(null,e[c],c,e)}}function W7(e,r){r=r.toLowerCase();const t=Object.keys(e);let n=t.length,s;for(;n-- >0;)if(s=t[n],r===s.toLowerCase())return s;return null}const w0=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,q7=e=>!Iv(e)&&e!==w0;function kS(){const{caseless:e}=q7(this)&&this||{},r={},t=(n,s)=>{const o=e&&W7(r,s)||s;Jy(r[o])&&Jy(n)?r[o]=kS(r[o],n):Jy(n)?r[o]=kS({},n):Jm(n)?r[o]=n.slice():r[o]=n};for(let n=0,s=arguments.length;n<s;n++)arguments[n]&&lx(arguments[n],t);return r}const JW=(e,r,t,{allOwnKeys:n}={})=>(lx(r,(s,o)=>{t&&hl(s)?e[o]=$7(s,t):e[o]=s},{allOwnKeys:n}),e),QW=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),eq=(e,r,t,n)=>{e.prototype=Object.create(r.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:r.prototype}),t&&Object.assign(e.prototype,t)},tq=(e,r,t,n)=>{let s,o,i;const c={};if(r=r||{},e==null)return r;do{for(s=Object.getOwnPropertyNames(e),o=s.length;o-- >0;)i=s[o],(!n||n(i,e,r))&&!c[i]&&(r[i]=e[i],c[i]=!0);e=t!==!1&&X6(e)}while(e&&(!t||t(e,r))&&e!==Object.prototype);return r},rq=(e,r,t)=>{e=String(e),(t===void 0||t>e.length)&&(t=e.length),t-=r.length;const n=e.indexOf(r,t);return n!==-1&&n===t},nq=e=>{if(!e)return null;if(Jm(e))return e;let r=e.length;if(!V7(r))return null;const t=new Array(r);for(;r-- >0;)t[r]=e[r];return t},aq=(e=>r=>e&&r instanceof e)(typeof Uint8Array<"u"&&X6(Uint8Array)),sq=(e,r)=>{const n=(e&&e[Aw]).call(e);let s;for(;(s=n.next())&&!s.done;){const o=s.value;r.call(e,o[0],o[1])}},iq=(e,r)=>{let t;const n=[];for(;(t=e.exec(r))!==null;)n.push(t);return n},oq=ru("HTMLFormElement"),lq=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,n,s){return n.toUpperCase()+s}),uA=(({hasOwnProperty:e})=>(r,t)=>e.call(r,t))(Object.prototype),cq=ru("RegExp"),G7=(e,r)=>{const t=Object.getOwnPropertyDescriptors(e),n={};lx(t,(s,o)=>{let i;(i=r(s,o,e))!==!1&&(n[o]=i||s)}),Object.defineProperties(e,n)},uq=e=>{G7(e,(r,t)=>{if(hl(e)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const n=e[t];if(hl(n)){if(r.enumerable=!1,"writable"in r){r.writable=!1;return}r.set||(r.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},dq=(e,r)=>{const t={},n=s=>{s.forEach(o=>{t[o]=!0})};return Jm(e)?n(e):n(String(e).split(r)),t},fq=()=>{},hq=(e,r)=>e!=null&&Number.isFinite(e=+e)?e:r;function pq(e){return!!(e&&hl(e.append)&&e[U7]==="FormData"&&e[Aw])}const mq=e=>{const r=new Array(10),t=(n,s)=>{if(kw(n)){if(r.indexOf(n)>=0)return;if(!("toJSON"in n)){r[s]=n;const o=Jm(n)?[]:{};return lx(n,(i,c)=>{const u=t(i,s+1);!Iv(u)&&(o[c]=u)}),r[s]=void 0,o}}return n};return t(e,0)},gq=ru("AsyncFunction"),vq=e=>e&&(kw(e)||hl(e))&&hl(e.then)&&hl(e.catch),K7=((e,r)=>e?setImmediate:r?((t,n)=>(w0.addEventListener("message",({source:s,data:o})=>{s===w0&&o===t&&n.length&&n.shift()()},!1),s=>{n.push(s),w0.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",hl(w0.postMessage)),xq=typeof queueMicrotask<"u"?queueMicrotask.bind(w0):typeof process<"u"&&process.nextTick||K7,bq=e=>e!=null&&hl(e[Aw]),ir={isArray:Jm,isArrayBuffer:H7,isBuffer:OW,isFormData:WW,isArrayBufferView:PW,isString:FW,isNumber:V7,isBoolean:BW,isObject:kw,isPlainObject:Jy,isReadableStream:GW,isRequest:KW,isResponse:XW,isHeaders:YW,isUndefined:Iv,isDate:zW,isFile:$W,isBlob:UW,isRegExp:cq,isFunction:hl,isStream:VW,isURLSearchParams:qW,isTypedArray:aq,isFileList:HW,forEach:lx,merge:kS,extend:JW,trim:ZW,stripBOM:QW,inherits:eq,toFlatObject:tq,kindOf:Cw,kindOfTest:ru,endsWith:rq,toArray:nq,forEachEntry:sq,matchAll:iq,isHTMLForm:oq,hasOwnProperty:uA,hasOwnProp:uA,reduceDescriptors:G7,freezeMethods:uq,toObjectSet:dq,toCamelCase:lq,noop:fq,toFiniteNumber:hq,findKey:W7,global:w0,isContextDefined:q7,isSpecCompliantForm:pq,toJSONObject:mq,isAsyncFn:gq,isThenable:vq,setImmediate:K7,asap:xq,isIterable:bq};function Zn(e,r,t,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",r&&(this.code=r),t&&(this.config=t),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}ir.inherits(Zn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ir.toJSONObject(this.config),code:this.code,status:this.status}}});const X7=Zn.prototype,Y7={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Y7[e]={value:e}});Object.defineProperties(Zn,Y7);Object.defineProperty(X7,"isAxiosError",{value:!0});Zn.from=(e,r,t,n,s,o)=>{const i=Object.create(X7);return ir.toFlatObject(e,i,function(u){return u!==Error.prototype},c=>c!=="isAxiosError"),Zn.call(i,e.message,r,t,n,s),i.cause=e,i.name=e.name,o&&Object.assign(i,o),i};const yq=null;function RS(e){return ir.isPlainObject(e)||ir.isArray(e)}function Z7(e){return ir.endsWith(e,"[]")?e.slice(0,-2):e}function dA(e,r,t){return e?e.concat(r).map(function(s,o){return s=Z7(s),!t&&o?"["+s+"]":s}).join(t?".":""):r}function wq(e){return ir.isArray(e)&&!e.some(RS)}const Sq=ir.toFlatObject(ir,{},null,function(r){return/^is[A-Z]/.test(r)});function Rw(e,r,t){if(!ir.isObject(e))throw new TypeError("target must be an object");r=r||new FormData,t=ir.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,m){return!ir.isUndefined(m[g])});const n=t.metaTokens,s=t.visitor||d,o=t.dots,i=t.indexes,u=(t.Blob||typeof Blob<"u"&&Blob)&&ir.isSpecCompliantForm(r);if(!ir.isFunction(s))throw new TypeError("visitor must be a function");function l(v){if(v===null)return"";if(ir.isDate(v))return v.toISOString();if(!u&&ir.isBlob(v))throw new Zn("Blob is not supported. Use a Buffer instead.");return ir.isArrayBuffer(v)||ir.isTypedArray(v)?u&&typeof Blob=="function"?new Blob([v]):Buffer.from(v):v}function d(v,g,m){let b=v;if(v&&!m&&typeof v=="object"){if(ir.endsWith(g,"{}"))g=n?g:g.slice(0,-2),v=JSON.stringify(v);else if(ir.isArray(v)&&wq(v)||(ir.isFileList(v)||ir.endsWith(g,"[]"))&&(b=ir.toArray(v)))return g=Z7(g),b.forEach(function(S,C){!(ir.isUndefined(S)||S===null)&&r.append(i===!0?dA([g],C,o):i===null?g:g+"[]",l(S))}),!1}return RS(v)?!0:(r.append(dA(m,g,o),l(v)),!1)}const h=[],f=Object.assign(Sq,{defaultVisitor:d,convertValue:l,isVisitable:RS});function p(v,g){if(!ir.isUndefined(v)){if(h.indexOf(v)!==-1)throw Error("Circular reference detected in "+g.join("."));h.push(v),ir.forEach(v,function(b,y){(!(ir.isUndefined(b)||b===null)&&s.call(r,b,ir.isString(y)?y.trim():y,g,f))===!0&&p(b,g?g.concat(y):[y])}),h.pop()}}if(!ir.isObject(e))throw new TypeError("data must be an object");return p(e),r}function fA(e){const r={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return r[n]})}function Y6(e,r){this._pairs=[],e&&Rw(e,this,r)}const J7=Y6.prototype;J7.append=function(r,t){this._pairs.push([r,t])};J7.toString=function(r){const t=r?function(n){return r.call(this,n,fA)}:fA;return this._pairs.map(function(s){return t(s[0])+"="+t(s[1])},"").join("&")};function _q(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Q7(e,r,t){if(!r)return e;const n=t&&t.encode||_q;ir.isFunction(t)&&(t={serialize:t});const s=t&&t.serialize;let o;if(s?o=s(r,t):o=ir.isURLSearchParams(r)?r.toString():new Y6(r,t).toString(n),o){const i=e.indexOf("#");i!==-1&&(e=e.slice(0,i)),e+=(e.indexOf("?")===-1?"?":"&")+o}return e}class hA{constructor(){this.handlers=[]}use(r,t,n){return this.handlers.push({fulfilled:r,rejected:t,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(r){this.handlers[r]&&(this.handlers[r]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(r){ir.forEach(this.handlers,function(n){n!==null&&r(n)})}}const eR={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Aq=typeof URLSearchParams<"u"?URLSearchParams:Y6,Cq=typeof FormData<"u"?FormData:null,jq=typeof Blob<"u"?Blob:null,kq={isBrowser:!0,classes:{URLSearchParams:Aq,FormData:Cq,Blob:jq},protocols:["http","https","file","blob","url","data"]},Z6=typeof window<"u"&&typeof document<"u",ES=typeof navigator=="object"&&navigator||void 0,Rq=Z6&&(!ES||["ReactNative","NativeScript","NS"].indexOf(ES.product)<0),Eq=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Nq=Z6&&window.location.href||"http://localhost",Tq=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Z6,hasStandardBrowserEnv:Rq,hasStandardBrowserWebWorkerEnv:Eq,navigator:ES,origin:Nq},Symbol.toStringTag,{value:"Module"})),Eo={...Tq,...kq};function Lq(e,r){return Rw(e,new Eo.classes.URLSearchParams,Object.assign({visitor:function(t,n,s,o){return Eo.isNode&&ir.isBuffer(t)?(this.append(n,t.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},r))}function Mq(e){return ir.matchAll(/\w+|\[(\w*)]/g,e).map(r=>r[0]==="[]"?"":r[1]||r[0])}function Dq(e){const r={},t=Object.keys(e);let n;const s=t.length;let o;for(n=0;n<s;n++)o=t[n],r[o]=e[o];return r}function tR(e){function r(t,n,s,o){let i=t[o++];if(i==="__proto__")return!0;const c=Number.isFinite(+i),u=o>=t.length;return i=!i&&ir.isArray(s)?s.length:i,u?(ir.hasOwnProp(s,i)?s[i]=[s[i],n]:s[i]=n,!c):((!s[i]||!ir.isObject(s[i]))&&(s[i]=[]),r(t,n,s[i],o)&&ir.isArray(s[i])&&(s[i]=Dq(s[i])),!c)}if(ir.isFormData(e)&&ir.isFunction(e.entries)){const t={};return ir.forEachEntry(e,(n,s)=>{r(Mq(n),s,t,0)}),t}return null}function Iq(e,r,t){if(ir.isString(e))try{return(r||JSON.parse)(e),ir.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(t||JSON.stringify)(e)}const cx={transitional:eR,adapter:["xhr","http","fetch"],transformRequest:[function(r,t){const n=t.getContentType()||"",s=n.indexOf("application/json")>-1,o=ir.isObject(r);if(o&&ir.isHTMLForm(r)&&(r=new FormData(r)),ir.isFormData(r))return s?JSON.stringify(tR(r)):r;if(ir.isArrayBuffer(r)||ir.isBuffer(r)||ir.isStream(r)||ir.isFile(r)||ir.isBlob(r)||ir.isReadableStream(r))return r;if(ir.isArrayBufferView(r))return r.buffer;if(ir.isURLSearchParams(r))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),r.toString();let c;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Lq(r,this.formSerializer).toString();if((c=ir.isFileList(r))||n.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return Rw(c?{"files[]":r}:r,u&&new u,this.formSerializer)}}return o||s?(t.setContentType("application/json",!1),Iq(r)):r}],transformResponse:[function(r){const t=this.transitional||cx.transitional,n=t&&t.forcedJSONParsing,s=this.responseType==="json";if(ir.isResponse(r)||ir.isReadableStream(r))return r;if(r&&ir.isString(r)&&(n&&!this.responseType||s)){const i=!(t&&t.silentJSONParsing)&&s;try{return JSON.parse(r)}catch(c){if(i)throw c.name==="SyntaxError"?Zn.from(c,Zn.ERR_BAD_RESPONSE,this,null,this.response):c}}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Eo.classes.FormData,Blob:Eo.classes.Blob},validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ir.forEach(["delete","get","head","post","put","patch"],e=>{cx.headers[e]={}});const Oq=ir.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Pq=e=>{const r={};let t,n,s;return e&&e.split(`
`).forEach(function(i){s=i.indexOf(":"),t=i.substring(0,s).trim().toLowerCase(),n=i.substring(s+1).trim(),!(!t||r[t]&&Oq[t])&&(t==="set-cookie"?r[t]?r[t].push(n):r[t]=[n]:r[t]=r[t]?r[t]+", "+n:n)}),r},pA=Symbol("internals");function $1(e){return e&&String(e).trim().toLowerCase()}function Qy(e){return e===!1||e==null?e:ir.isArray(e)?e.map(Qy):String(e)}function Fq(e){const r=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=t.exec(e);)r[n[1]]=n[2];return r}const Bq=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function c3(e,r,t,n,s){if(ir.isFunction(n))return n.call(this,r,t);if(s&&(r=t),!!ir.isString(r)){if(ir.isString(n))return r.indexOf(n)!==-1;if(ir.isRegExp(n))return n.test(r)}}function zq(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(r,t,n)=>t.toUpperCase()+n)}function $q(e,r){const t=ir.toCamelCase(" "+r);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+t,{value:function(s,o,i){return this[n].call(this,r,s,o,i)},configurable:!0})})}let pl=class{constructor(r){r&&this.set(r)}set(r,t,n){const s=this;function o(c,u,l){const d=$1(u);if(!d)throw new Error("header name must be a non-empty string");const h=ir.findKey(s,d);(!h||s[h]===void 0||l===!0||l===void 0&&s[h]!==!1)&&(s[h||u]=Qy(c))}const i=(c,u)=>ir.forEach(c,(l,d)=>o(l,d,u));if(ir.isPlainObject(r)||r instanceof this.constructor)i(r,t);else if(ir.isString(r)&&(r=r.trim())&&!Bq(r))i(Pq(r),t);else if(ir.isObject(r)&&ir.isIterable(r)){let c={},u,l;for(const d of r){if(!ir.isArray(d))throw TypeError("Object iterator must return a key-value pair");c[l=d[0]]=(u=c[l])?ir.isArray(u)?[...u,d[1]]:[u,d[1]]:d[1]}i(c,t)}else r!=null&&o(t,r,n);return this}get(r,t){if(r=$1(r),r){const n=ir.findKey(this,r);if(n){const s=this[n];if(!t)return s;if(t===!0)return Fq(s);if(ir.isFunction(t))return t.call(this,s,n);if(ir.isRegExp(t))return t.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(r,t){if(r=$1(r),r){const n=ir.findKey(this,r);return!!(n&&this[n]!==void 0&&(!t||c3(this,this[n],n,t)))}return!1}delete(r,t){const n=this;let s=!1;function o(i){if(i=$1(i),i){const c=ir.findKey(n,i);c&&(!t||c3(n,n[c],c,t))&&(delete n[c],s=!0)}}return ir.isArray(r)?r.forEach(o):o(r),s}clear(r){const t=Object.keys(this);let n=t.length,s=!1;for(;n--;){const o=t[n];(!r||c3(this,this[o],o,r,!0))&&(delete this[o],s=!0)}return s}normalize(r){const t=this,n={};return ir.forEach(this,(s,o)=>{const i=ir.findKey(n,o);if(i){t[i]=Qy(s),delete t[o];return}const c=r?zq(o):String(o).trim();c!==o&&delete t[o],t[c]=Qy(s),n[c]=!0}),this}concat(...r){return this.constructor.concat(this,...r)}toJSON(r){const t=Object.create(null);return ir.forEach(this,(n,s)=>{n!=null&&n!==!1&&(t[s]=r&&ir.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([r,t])=>r+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(r){return r instanceof this?r:new this(r)}static concat(r,...t){const n=new this(r);return t.forEach(s=>n.set(s)),n}static accessor(r){const n=(this[pA]=this[pA]={accessors:{}}).accessors,s=this.prototype;function o(i){const c=$1(i);n[c]||($q(s,i),n[c]=!0)}return ir.isArray(r)?r.forEach(o):o(r),this}};pl.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ir.reduceDescriptors(pl.prototype,({value:e},r)=>{let t=r[0].toUpperCase()+r.slice(1);return{get:()=>e,set(n){this[t]=n}}});ir.freezeMethods(pl);function u3(e,r){const t=this||cx,n=r||t,s=pl.from(n.headers);let o=n.data;return ir.forEach(e,function(c){o=c.call(t,o,s.normalize(),r?r.status:void 0)}),s.normalize(),o}function rR(e){return!!(e&&e.__CANCEL__)}function Qm(e,r,t){Zn.call(this,e??"canceled",Zn.ERR_CANCELED,r,t),this.name="CanceledError"}ir.inherits(Qm,Zn,{__CANCEL__:!0});function nR(e,r,t){const n=t.config.validateStatus;!t.status||!n||n(t.status)?e(t):r(new Zn("Request failed with status code "+t.status,[Zn.ERR_BAD_REQUEST,Zn.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function Uq(e){const r=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return r&&r[1]||""}function Hq(e,r){e=e||10;const t=new Array(e),n=new Array(e);let s=0,o=0,i;return r=r!==void 0?r:1e3,function(u){const l=Date.now(),d=n[o];i||(i=l),t[s]=u,n[s]=l;let h=o,f=0;for(;h!==s;)f+=t[h++],h=h%e;if(s=(s+1)%e,s===o&&(o=(o+1)%e),l-i<r)return;const p=d&&l-d;return p?Math.round(f*1e3/p):void 0}}function Vq(e,r){let t=0,n=1e3/r,s,o;const i=(l,d=Date.now())=>{t=d,s=null,o&&(clearTimeout(o),o=null),e.apply(null,l)};return[(...l)=>{const d=Date.now(),h=d-t;h>=n?i(l,d):(s=l,o||(o=setTimeout(()=>{o=null,i(s)},n-h)))},()=>s&&i(s)]}const A2=(e,r,t=3)=>{let n=0;const s=Hq(50,250);return Vq(o=>{const i=o.loaded,c=o.lengthComputable?o.total:void 0,u=i-n,l=s(u),d=i<=c;n=i;const h={loaded:i,total:c,progress:c?i/c:void 0,bytes:u,rate:l||void 0,estimated:l&&c&&d?(c-i)/l:void 0,event:o,lengthComputable:c!=null,[r?"download":"upload"]:!0};e(h)},t)},mA=(e,r)=>{const t=e!=null;return[n=>r[0]({lengthComputable:t,total:e,loaded:n}),r[1]]},gA=e=>(...r)=>ir.asap(()=>e(...r)),Wq=Eo.hasStandardBrowserEnv?((e,r)=>t=>(t=new URL(t,Eo.origin),e.protocol===t.protocol&&e.host===t.host&&(r||e.port===t.port)))(new URL(Eo.origin),Eo.navigator&&/(msie|trident)/i.test(Eo.navigator.userAgent)):()=>!0,qq=Eo.hasStandardBrowserEnv?{write(e,r,t,n,s,o){const i=[e+"="+encodeURIComponent(r)];ir.isNumber(t)&&i.push("expires="+new Date(t).toGMTString()),ir.isString(n)&&i.push("path="+n),ir.isString(s)&&i.push("domain="+s),o===!0&&i.push("secure"),document.cookie=i.join("; ")},read(e){const r=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Gq(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Kq(e,r){return r?e.replace(/\/?\/$/,"")+"/"+r.replace(/^\/+/,""):e}function aR(e,r,t){let n=!Gq(r);return e&&(n||t==!1)?Kq(e,r):r}const vA=e=>e instanceof pl?{...e}:e;function I0(e,r){r=r||{};const t={};function n(l,d,h,f){return ir.isPlainObject(l)&&ir.isPlainObject(d)?ir.merge.call({caseless:f},l,d):ir.isPlainObject(d)?ir.merge({},d):ir.isArray(d)?d.slice():d}function s(l,d,h,f){if(ir.isUndefined(d)){if(!ir.isUndefined(l))return n(void 0,l,h,f)}else return n(l,d,h,f)}function o(l,d){if(!ir.isUndefined(d))return n(void 0,d)}function i(l,d){if(ir.isUndefined(d)){if(!ir.isUndefined(l))return n(void 0,l)}else return n(void 0,d)}function c(l,d,h){if(h in r)return n(l,d);if(h in e)return n(void 0,l)}const u={url:o,method:o,data:o,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:c,headers:(l,d,h)=>s(vA(l),vA(d),h,!0)};return ir.forEach(Object.keys(Object.assign({},e,r)),function(d){const h=u[d]||s,f=h(e[d],r[d],d);ir.isUndefined(f)&&h!==c||(t[d]=f)}),t}const sR=e=>{const r=I0({},e);let{data:t,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:o,headers:i,auth:c}=r;r.headers=i=pl.from(i),r.url=Q7(aR(r.baseURL,r.url,r.allowAbsoluteUrls),e.params,e.paramsSerializer),c&&i.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):"")));let u;if(ir.isFormData(t)){if(Eo.hasStandardBrowserEnv||Eo.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((u=i.getContentType())!==!1){const[l,...d]=u?u.split(";").map(h=>h.trim()).filter(Boolean):[];i.setContentType([l||"multipart/form-data",...d].join("; "))}}if(Eo.hasStandardBrowserEnv&&(n&&ir.isFunction(n)&&(n=n(r)),n||n!==!1&&Wq(r.url))){const l=s&&o&&qq.read(o);l&&i.set(s,l)}return r},Xq=typeof XMLHttpRequest<"u",Yq=Xq&&function(e){return new Promise(function(t,n){const s=sR(e);let o=s.data;const i=pl.from(s.headers).normalize();let{responseType:c,onUploadProgress:u,onDownloadProgress:l}=s,d,h,f,p,v;function g(){p&&p(),v&&v(),s.cancelToken&&s.cancelToken.unsubscribe(d),s.signal&&s.signal.removeEventListener("abort",d)}let m=new XMLHttpRequest;m.open(s.method.toUpperCase(),s.url,!0),m.timeout=s.timeout;function b(){if(!m)return;const S=pl.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders()),L={data:!c||c==="text"||c==="json"?m.responseText:m.response,status:m.status,statusText:m.statusText,headers:S,config:e,request:m};nR(function(H){t(H),g()},function(H){n(H),g()},L),m=null}"onloadend"in m?m.onloadend=b:m.onreadystatechange=function(){!m||m.readyState!==4||m.status===0&&!(m.responseURL&&m.responseURL.indexOf("file:")===0)||setTimeout(b)},m.onabort=function(){m&&(n(new Zn("Request aborted",Zn.ECONNABORTED,e,m)),m=null)},m.onerror=function(){n(new Zn("Network Error",Zn.ERR_NETWORK,e,m)),m=null},m.ontimeout=function(){let C=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const L=s.transitional||eR;s.timeoutErrorMessage&&(C=s.timeoutErrorMessage),n(new Zn(C,L.clarifyTimeoutError?Zn.ETIMEDOUT:Zn.ECONNABORTED,e,m)),m=null},o===void 0&&i.setContentType(null),"setRequestHeader"in m&&ir.forEach(i.toJSON(),function(C,L){m.setRequestHeader(L,C)}),ir.isUndefined(s.withCredentials)||(m.withCredentials=!!s.withCredentials),c&&c!=="json"&&(m.responseType=s.responseType),l&&([f,v]=A2(l,!0),m.addEventListener("progress",f)),u&&m.upload&&([h,p]=A2(u),m.upload.addEventListener("progress",h),m.upload.addEventListener("loadend",p)),(s.cancelToken||s.signal)&&(d=S=>{m&&(n(!S||S.type?new Qm(null,e,m):S),m.abort(),m=null)},s.cancelToken&&s.cancelToken.subscribe(d),s.signal&&(s.signal.aborted?d():s.signal.addEventListener("abort",d)));const y=Uq(s.url);if(y&&Eo.protocols.indexOf(y)===-1){n(new Zn("Unsupported protocol "+y+":",Zn.ERR_BAD_REQUEST,e));return}m.send(o||null)})},Zq=(e,r)=>{const{length:t}=e=e?e.filter(Boolean):[];if(r||t){let n=new AbortController,s;const o=function(l){if(!s){s=!0,c();const d=l instanceof Error?l:this.reason;n.abort(d instanceof Zn?d:new Qm(d instanceof Error?d.message:d))}};let i=r&&setTimeout(()=>{i=null,o(new Zn(`timeout ${r} of ms exceeded`,Zn.ETIMEDOUT))},r);const c=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(l=>{l.unsubscribe?l.unsubscribe(o):l.removeEventListener("abort",o)}),e=null)};e.forEach(l=>l.addEventListener("abort",o));const{signal:u}=n;return u.unsubscribe=()=>ir.asap(c),u}},Jq=function*(e,r){let t=e.byteLength;if(t<r){yield e;return}let n=0,s;for(;n<t;)s=n+r,yield e.slice(n,s),n=s},Qq=async function*(e,r){for await(const t of eG(e))yield*Jq(t,r)},eG=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const r=e.getReader();try{for(;;){const{done:t,value:n}=await r.read();if(t)break;yield n}}finally{await r.cancel()}},xA=(e,r,t,n)=>{const s=Qq(e,r);let o=0,i,c=u=>{i||(i=!0,n&&n(u))};return new ReadableStream({async pull(u){try{const{done:l,value:d}=await s.next();if(l){c(),u.close();return}let h=d.byteLength;if(t){let f=o+=h;t(f)}u.enqueue(new Uint8Array(d))}catch(l){throw c(l),l}},cancel(u){return c(u),s.return()}},{highWaterMark:2})},Ew=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",iR=Ew&&typeof ReadableStream=="function",tG=Ew&&(typeof TextEncoder=="function"?(e=>r=>e.encode(r))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),oR=(e,...r)=>{try{return!!e(...r)}catch{return!1}},rG=iR&&oR(()=>{let e=!1;const r=new Request(Eo.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!r}),bA=64*1024,NS=iR&&oR(()=>ir.isReadableStream(new Response("").body)),C2={stream:NS&&(e=>e.body)};Ew&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(r=>{!C2[r]&&(C2[r]=ir.isFunction(e[r])?t=>t[r]():(t,n)=>{throw new Zn(`Response type '${r}' is not supported`,Zn.ERR_NOT_SUPPORT,n)})})})(new Response);const nG=async e=>{if(e==null)return 0;if(ir.isBlob(e))return e.size;if(ir.isSpecCompliantForm(e))return(await new Request(Eo.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(ir.isArrayBufferView(e)||ir.isArrayBuffer(e))return e.byteLength;if(ir.isURLSearchParams(e)&&(e=e+""),ir.isString(e))return(await tG(e)).byteLength},aG=async(e,r)=>{const t=ir.toFiniteNumber(e.getContentLength());return t??nG(r)},sG=Ew&&(async e=>{let{url:r,method:t,data:n,signal:s,cancelToken:o,timeout:i,onDownloadProgress:c,onUploadProgress:u,responseType:l,headers:d,withCredentials:h="same-origin",fetchOptions:f}=sR(e);l=l?(l+"").toLowerCase():"text";let p=Zq([s,o&&o.toAbortSignal()],i),v;const g=p&&p.unsubscribe&&(()=>{p.unsubscribe()});let m;try{if(u&&rG&&t!=="get"&&t!=="head"&&(m=await aG(d,n))!==0){let L=new Request(r,{method:"POST",body:n,duplex:"half"}),O;if(ir.isFormData(n)&&(O=L.headers.get("content-type"))&&d.setContentType(O),L.body){const[H,z]=mA(m,A2(gA(u)));n=xA(L.body,bA,H,z)}}ir.isString(h)||(h=h?"include":"omit");const b="credentials"in Request.prototype;v=new Request(r,{...f,signal:p,method:t.toUpperCase(),headers:d.normalize().toJSON(),body:n,duplex:"half",credentials:b?h:void 0});let y=await fetch(v);const S=NS&&(l==="stream"||l==="response");if(NS&&(c||S&&g)){const L={};["status","statusText","headers"].forEach(q=>{L[q]=y[q]});const O=ir.toFiniteNumber(y.headers.get("content-length")),[H,z]=c&&mA(O,A2(gA(c),!0))||[];y=new Response(xA(y.body,bA,H,()=>{z&&z(),g&&g()}),L)}l=l||"text";let C=await C2[ir.findKey(C2,l)||"text"](y,e);return!S&&g&&g(),await new Promise((L,O)=>{nR(L,O,{data:C,headers:pl.from(y.headers),status:y.status,statusText:y.statusText,config:e,request:v})})}catch(b){throw g&&g(),b&&b.name==="TypeError"&&/Load failed|fetch/i.test(b.message)?Object.assign(new Zn("Network Error",Zn.ERR_NETWORK,e,v),{cause:b.cause||b}):Zn.from(b,b&&b.code,e,v)}}),TS={http:yq,xhr:Yq,fetch:sG};ir.forEach(TS,(e,r)=>{if(e){try{Object.defineProperty(e,"name",{value:r})}catch{}Object.defineProperty(e,"adapterName",{value:r})}});const yA=e=>`- ${e}`,iG=e=>ir.isFunction(e)||e===null||e===!1,lR={getAdapter:e=>{e=ir.isArray(e)?e:[e];const{length:r}=e;let t,n;const s={};for(let o=0;o<r;o++){t=e[o];let i;if(n=t,!iG(t)&&(n=TS[(i=String(t)).toLowerCase()],n===void 0))throw new Zn(`Unknown adapter '${i}'`);if(n)break;s[i||"#"+o]=n}if(!n){const o=Object.entries(s).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let i=r?o.length>1?`since :
`+o.map(yA).join(`
`):" "+yA(o[0]):"as no adapter specified";throw new Zn("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return n},adapters:TS};function d3(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Qm(null,e)}function wA(e){return d3(e),e.headers=pl.from(e.headers),e.data=u3.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),lR.getAdapter(e.adapter||cx.adapter)(e).then(function(n){return d3(e),n.data=u3.call(e,e.transformResponse,n),n.headers=pl.from(n.headers),n},function(n){return rR(n)||(d3(e),n&&n.response&&(n.response.data=u3.call(e,e.transformResponse,n.response),n.response.headers=pl.from(n.response.headers))),Promise.reject(n)})}const cR="1.9.0",Nw={};["object","boolean","number","function","string","symbol"].forEach((e,r)=>{Nw[e]=function(n){return typeof n===e||"a"+(r<1?"n ":" ")+e}});const SA={};Nw.transitional=function(r,t,n){function s(o,i){return"[Axios v"+cR+"] Transitional option '"+o+"'"+i+(n?". "+n:"")}return(o,i,c)=>{if(r===!1)throw new Zn(s(i," has been removed"+(t?" in "+t:"")),Zn.ERR_DEPRECATED);return t&&!SA[i]&&(SA[i]=!0,console.warn(s(i," has been deprecated since v"+t+" and will be removed in the near future"))),r?r(o,i,c):!0}};Nw.spelling=function(r){return(t,n)=>(console.warn(`${n} is likely a misspelling of ${r}`),!0)};function oG(e,r,t){if(typeof e!="object")throw new Zn("options must be an object",Zn.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let s=n.length;for(;s-- >0;){const o=n[s],i=r[o];if(i){const c=e[o],u=c===void 0||i(c,o,e);if(u!==!0)throw new Zn("option "+o+" must be "+u,Zn.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Zn("Unknown option "+o,Zn.ERR_BAD_OPTION)}}const e2={assertOptions:oG,validators:Nw},Nu=e2.validators;let k0=class{constructor(r){this.defaults=r||{},this.interceptors={request:new hA,response:new hA}}async request(r,t){try{return await this._request(r,t)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const o=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?o&&!String(n.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+o):n.stack=o}catch{}}throw n}}_request(r,t){typeof r=="string"?(t=t||{},t.url=r):t=r||{},t=I0(this.defaults,t);const{transitional:n,paramsSerializer:s,headers:o}=t;n!==void 0&&e2.assertOptions(n,{silentJSONParsing:Nu.transitional(Nu.boolean),forcedJSONParsing:Nu.transitional(Nu.boolean),clarifyTimeoutError:Nu.transitional(Nu.boolean)},!1),s!=null&&(ir.isFunction(s)?t.paramsSerializer={serialize:s}:e2.assertOptions(s,{encode:Nu.function,serialize:Nu.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),e2.assertOptions(t,{baseUrl:Nu.spelling("baseURL"),withXsrfToken:Nu.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let i=o&&ir.merge(o.common,o[t.method]);o&&ir.forEach(["delete","get","head","post","put","patch","common"],v=>{delete o[v]}),t.headers=pl.concat(i,o);const c=[];let u=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(t)===!1||(u=u&&g.synchronous,c.unshift(g.fulfilled,g.rejected))});const l=[];this.interceptors.response.forEach(function(g){l.push(g.fulfilled,g.rejected)});let d,h=0,f;if(!u){const v=[wA.bind(this),void 0];for(v.unshift.apply(v,c),v.push.apply(v,l),f=v.length,d=Promise.resolve(t);h<f;)d=d.then(v[h++],v[h++]);return d}f=c.length;let p=t;for(h=0;h<f;){const v=c[h++],g=c[h++];try{p=v(p)}catch(m){g.call(this,m);break}}try{d=wA.call(this,p)}catch(v){return Promise.reject(v)}for(h=0,f=l.length;h<f;)d=d.then(l[h++],l[h++]);return d}getUri(r){r=I0(this.defaults,r);const t=aR(r.baseURL,r.url,r.allowAbsoluteUrls);return Q7(t,r.params,r.paramsSerializer)}};ir.forEach(["delete","get","head","options"],function(r){k0.prototype[r]=function(t,n){return this.request(I0(n||{},{method:r,url:t,data:(n||{}).data}))}});ir.forEach(["post","put","patch"],function(r){function t(n){return function(o,i,c){return this.request(I0(c||{},{method:r,headers:n?{"Content-Type":"multipart/form-data"}:{},url:o,data:i}))}}k0.prototype[r]=t(),k0.prototype[r+"Form"]=t(!0)});let lG=class uR{constructor(r){if(typeof r!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(o){t=o});const n=this;this.promise.then(s=>{if(!n._listeners)return;let o=n._listeners.length;for(;o-- >0;)n._listeners[o](s);n._listeners=null}),this.promise.then=s=>{let o;const i=new Promise(c=>{n.subscribe(c),o=c}).then(s);return i.cancel=function(){n.unsubscribe(o)},i},r(function(o,i,c){n.reason||(n.reason=new Qm(o,i,c),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(r){if(this.reason){r(this.reason);return}this._listeners?this._listeners.push(r):this._listeners=[r]}unsubscribe(r){if(!this._listeners)return;const t=this._listeners.indexOf(r);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const r=new AbortController,t=n=>{r.abort(n)};return this.subscribe(t),r.signal.unsubscribe=()=>this.unsubscribe(t),r.signal}static source(){let r;return{token:new uR(function(s){r=s}),cancel:r}}};function cG(e){return function(t){return e.apply(null,t)}}function uG(e){return ir.isObject(e)&&e.isAxiosError===!0}const LS={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(LS).forEach(([e,r])=>{LS[r]=e});function dR(e){const r=new k0(e),t=$7(k0.prototype.request,r);return ir.extend(t,k0.prototype,r,{allOwnKeys:!0}),ir.extend(t,r,null,{allOwnKeys:!0}),t.create=function(s){return dR(I0(e,s))},t}const ut=dR(cx);ut.Axios=k0;ut.CanceledError=Qm;ut.CancelToken=lG;ut.isCancel=rR;ut.VERSION=cR;ut.toFormData=Rw;ut.AxiosError=Zn;ut.Cancel=ut.CanceledError;ut.all=function(r){return Promise.all(r)};ut.spread=cG;ut.isAxiosError=uG;ut.mergeConfig=I0;ut.AxiosHeaders=pl;ut.formToJSON=e=>tR(ir.isHTMLForm(e)?new FormData(e):e);ut.getAdapter=lR.getAdapter;ut.HttpStatusCode=LS;ut.default=ut;const{Axios:gde,AxiosError:vde,CanceledError:xde,isCancel:bde,CancelToken:yde,VERSION:wde,all:Sde,Cancel:_de,isAxiosError:Ade,spread:Cde,toFormData:jde,AxiosHeaders:kde,HttpStatusCode:Rde,formToJSON:Ede,getAdapter:Nde,mergeConfig:Tde}=ut;function dG({open:e,onClose:r,category:t,onSuccess:n}){const{control:s,handleSubmit:o,reset:i,setValue:c}=Gl(),[u,l]=G.useState([]),[d,h]=G.useState(!1),[f,p]=G.useState(!1);G.useEffect(()=>{e&&(async()=>{h(!0);try{const m=await ut.get(`${Je}/api/categories`);console.log("API Raw Response:",m);let b=[];Array.isArray(m.data)?b=m.data:m.data&&typeof m.data=="object"&&(Array.isArray(m.data.data)?b=m.data.data:Array.isArray(m.data.categories)?b=m.data.categories:Object.values(m.data).forEach(y=>{Array.isArray(y)&&(b=y)})),console.log("Processed categories:",b),l(b)}catch(m){console.error("Error fetching categories:",m),l([])}finally{h(!1)}})()},[e]),G.useEffect(()=>{t?c("name",t.Name):c("name","")},[t,c]);const v=async g=>{try{t!=null&&t.ID?await ut.put(`${Je}/api/categories/${t.ID}`,g):await ut.post(`${Je}/api/categories`,g),n()}catch{alert("Error saving category.")}};return a.jsxs(Oa,{open:e,onClose:r,fullWidth:!0,maxWidth:"xs",children:[a.jsx(Wa,{children:t?"Edit Category":"Add Category"}),a.jsxs("form",{onSubmit:o(v),children:[a.jsx(Pa,{children:a.jsx(En,{name:"name",control:s,rules:{required:!0},render:({field:{onChange:g,value:m,ref:b}})=>{const y=Array.isArray(u)?u.map(S=>(S==null?void 0:S.Name)||(S==null?void 0:S.name)||(S==null?void 0:S.Title)||(S==null?void 0:S.title)||"").filter(S=>S!==""):[];return console.log("Category options for dropdown:",y),a.jsx(bc,{options:y,freeSolo:!0,loading:d,open:f,onOpen:()=>p(!0),onClose:()=>p(!1),autoSelect:!0,value:m||"",onChange:(S,C)=>g(C),filterOptions:(S,C)=>{const L=S.filter(O=>O.toLowerCase().includes(C.inputValue.toLowerCase()));return C.inputValue!==""&&(L.some(O=>O.toLowerCase()===C.inputValue.toLowerCase())||L.push(C.inputValue)),L},renderInput:S=>a.jsx(ri,{...S,autoFocus:!0,inputRef:b,label:"Category Name",fullWidth:!0,margin:"dense",size:"small",required:!0,onClick:()=>p(!0),InputProps:{...S.InputProps,endAdornment:a.jsxs(a.Fragment,{children:[S.InputProps.endAdornment,a.jsx(Qf,{position:"end",children:a.jsx(bs,{title:f?"Close suggestions":"Open suggestions",children:a.jsx(sn,{size:"small",onClick:C=>{C.stopPropagation(),p(L=>!L)},sx:{color:"primary.main"},children:f?a.jsx(q0,{fontSize:"small"}):a.jsx(W0,{fontSize:"small"})})})})]})}})})}})}),a.jsxs(Va,{children:[a.jsx(Br,{onClick:r,children:"Cancel"}),a.jsx(Br,{type:"submit",variant:"contained",children:"Save"})]})]})]})}function fG({open:e,title:r,message:t,onCancel:n,onConfirm:s}){return a.jsxs(Oa,{open:e,onClose:n,children:[a.jsx(Wa,{children:r}),a.jsx(Pa,{children:a.jsx(Et,{children:t})}),a.jsxs(Va,{children:[a.jsx(Br,{onClick:n,children:"Cancel"}),a.jsx(Br,{onClick:s,variant:"contained",color:"error",children:"Delete"})]})]})}function hG(){const[e,r]=G.useState([]),[t,n]=G.useState(!1),[s,o]=G.useState(null),[i,c]=G.useState(!1),[u,l]=G.useState(null),[d,h]=G.useState({open:!1,message:"",severity:"success"}),[f,p]=G.useState(0),[v,g]=G.useState(0),[m,b]=G.useState(10),[y,S]=G.useState(""),[C,L]=G.useState([]),O=async()=>{try{const D=await ut.get(`${Je}/api/categories`,{params:{page:v+1,limit:m,filter:y}});r(D.data.data),p(D.data.total)}catch{z("Failed to load categories","error")}},H=async()=>{try{const D=await ut.get(`${Je}/api/categories`),W=[...new Set(D.data.data.map(P=>P.Name))];L(W.sort())}catch{h({open:!0,message:"Failed to load filter options",severity:"error"})}};G.useEffect(()=>{H()},[]),G.useEffect(()=>{O()},[v,m,y]);const z=(D,W="success")=>{h({open:!0,message:D,severity:W})},q=async()=>{var D,W,P,I;try{await ut.delete(`${Je}/api/categories/${u.ID}`),z("Deleted"),O()}catch(U){console.error("Failed to delete category:",U);const _=((W=(D=U==null?void 0:U.response)==null?void 0:D.data)==null?void 0:W.error)||((I=(P=U==null?void 0:U.response)==null?void 0:P.data)==null?void 0:I.message)||(U==null?void 0:U.message)||"Failed to delete";h({open:!0,message:_,severity:"error"})}finally{c(!1),l(null)}};return a.jsxs("section",{className:"right-content",children:[a.jsxs("div",{className:"category-page-header",children:[a.jsx("h6",{children:"Category Management"}),a.jsx("div",{className:"search-field-wrapper",children:a.jsx("input",{type:"text",className:"search-input",placeholder:"Filter by Name",value:y,onChange:D=>{S(D.target.value),g(0)}})}),a.jsx("div",{className:"add-button-wrapper",children:a.jsx("button",{className:"btn-add",onClick:()=>n(!0),type:"button",children:"Add Category"})})]}),a.jsx("div",{className:"table-wrapper",children:a.jsx(mW,{categories:e,page:v,rowsPerPage:m,onEdit:D=>{o(D),n(!0)},onDelete:D=>{l(D),c(!0)}})}),a.jsxs("div",{className:"pagination-wrapper",children:[a.jsxs("div",{className:"pagination-info",children:[a.jsx("span",{children:"Rows per page:"}),a.jsxs("select",{value:m,onChange:D=>{b(parseInt(D.target.value,10)),g(0)},children:[a.jsx("option",{value:5,children:"5"}),a.jsx("option",{value:10,children:"10"}),a.jsx("option",{value:25,children:"25"})]}),a.jsxs("span",{children:[f>0?v*m+1:0,"",Math.min((v+1)*m,f)," of ",f]})]}),a.jsxs("div",{className:"pagination-buttons",children:[a.jsx("button",{onClick:()=>g(v-1),disabled:v===0,type:"button",children:"Previous"}),a.jsx("button",{onClick:()=>g(v+1),disabled:(v+1)*m>=f,type:"button",children:"Next"})]})]}),a.jsx(dG,{open:t,onClose:()=>{n(!1),o(null)},category:s,onSuccess:()=>{O(),n(!1),o(null),z("Category saved")}}),a.jsx(fG,{open:i,title:"Delete Category",message:`Are you sure you want to delete "${u==null?void 0:u.Name}"?`,onCancel:()=>c(!1),onConfirm:q}),a.jsx(tu,{open:d.open,autoHideDuration:3e3,onClose:()=>h({...d,open:!1}),children:a.jsx(eu,{severity:d.severity,children:d.message})})]})}const pG=({open:e,onClose:r,onSubmit:t,formData:n,setFormData:s})=>{const[o,i]=G.useState([]),[c,u]=G.useState({open:!1,message:"",severity:"success"}),[l,d]=G.useState(!1),[h,f]=G.useState(!1),[p,v]=G.useState(!1),[g,m]=G.useState([]),[b,y]=G.useState(!1),S=async()=>{d(!0);try{const H=await ut.get(`${Je}/api/categories`);let z=[];Array.isArray(H.data)?z=H.data:H.data&&typeof H.data=="object"&&(Array.isArray(H.data.data)?z=H.data.data:Array.isArray(H.data.categories)?z=H.data.categories:Object.values(H.data).forEach(q=>{Array.isArray(q)&&(z=q)})),i(z)}catch(H){C("Failed to load categories","error"),console.error("Axios error:",H),i([])}finally{d(!1)}},C=(H,z="success")=>{u({open:!0,message:H,severity:z})};G.useEffect(()=>{e&&(S(),L())},[e]);const L=async H=>{y(!0);try{const z=await ut.get(`${Je}/api/subcategories`,{params:H?{category_id:H}:{}});let q=[];Array.isArray(z.data)?q=z.data:z.data&&typeof z.data=="object"&&(Array.isArray(z.data.data)?q=z.data.data:Array.isArray(z.data.subcategories)?q=z.data.subcategories:Object.values(z.data).forEach(D=>{Array.isArray(D)&&(q=D)})),m(q)}catch(z){C("Failed to load subcategories","error"),console.error("Axios error (subcategories):",z),m([])}finally{y(!1)}};G.useEffect(()=>{var z;const H=((z=n==null?void 0:n.category)==null?void 0:z.ID)||(n==null?void 0:n.category_id)||null;e&&L(H)},[n==null?void 0:n.category,n==null?void 0:n.category_id,e]);const O=()=>{var D;const H=(n.name||"").toString().trim(),z=((D=n==null?void 0:n.category)==null?void 0:D.ID)||(n==null?void 0:n.category_id)||null;if(!H){C("Please enter a subcategory name","error");return}if(!z){C("Please select a category","error");return}if(Array.isArray(g)&&g.find(W=>{var k,_;const P=((W==null?void 0:W.Name)||(W==null?void 0:W.name)||"").toString().trim();if(!P||P.toLowerCase()!==H.toLowerCase())return!1;const I=(W==null?void 0:W.ID)||(W==null?void 0:W.id)||null;if(n.id&&I&&Number(I)===Number(n.id))return!1;const U=((k=W==null?void 0:W.Category)==null?void 0:k.ID)||(W==null?void 0:W.category_id)||(W==null?void 0:W.CategoryID)||((_=W==null?void 0:W.category)==null?void 0:_.ID)||null;return U?Number(U)===Number(z):!0})){C("A subcategory with this name already exists for the selected category.","error");return}t()};return a.jsxs(Oa,{open:e,onClose:r,fullWidth:!0,maxWidth:"xs",children:[a.jsxs(Wa,{children:[n.id?"Edit":"Add"," Subcategory"]}),a.jsxs(Pa,{children:[a.jsx(bc,{options:Array.isArray(o)?o.map(H=>H):[],getOptionLabel:H=>(H==null?void 0:H.Name)||(H==null?void 0:H.name)||"",loading:l,open:h,onOpen:()=>f(!0),onClose:()=>f(!1),value:n.category||null,onChange:(H,z)=>{s({...n,category:z,category_id:(z==null?void 0:z.ID)||null}),f(!1)},renderInput:H=>a.jsx(ri,{...H,label:"Category",margin:"normal",fullWidth:!0,onClick:()=>f(!0),InputProps:{...H.InputProps,endAdornment:a.jsx(a.Fragment,{children:H.InputProps.endAdornment})}})}),a.jsx(bc,{freeSolo:!0,autoSelect:!0,options:Array.isArray(g)?g.map(H=>H.Name||H.name||""):[],loading:b,open:p,onOpen:()=>v(!0),onClose:()=>v(!1),value:n.name||"",onChange:(H,z)=>{s({...n,name:z}),v(!1)},renderInput:H=>a.jsx(ri,{...H,fullWidth:!0,label:"Subcategory Name",margin:"normal",onClick:()=>v(!0),InputProps:{...H.InputProps,endAdornment:a.jsxs(a.Fragment,{children:[H.InputProps.endAdornment,a.jsx(Qf,{position:"end",children:a.jsx(bs,{title:p?"Close suggestions":"Open suggestions",children:a.jsx(sn,{size:"small",onClick:z=>{z.stopPropagation(),v(q=>!q)},sx:{color:"primary.main"},children:p?a.jsx(q0,{fontSize:"small"}):a.jsx(W0,{fontSize:"small"})})})})]})}})})]}),a.jsxs(Va,{children:[a.jsx(Br,{onClick:r,children:"Cancel"}),a.jsx(Br,{onClick:O,variant:"contained",children:"Save"})]})]})},mG=({data:e,page:r,limit:t,total:n,onPageChange:s,onRowsPerPageChange:o,onEdit:i,onDelete:c})=>a.jsxs(a.Fragment,{children:[a.jsx(Ws,{component:sa,children:a.jsxs(Cs,{children:[a.jsx(js,{children:a.jsxs(pn,{children:[a.jsx(qe,{children:"S No."}),a.jsx(qe,{children:"Cat. Name"}),a.jsx(qe,{children:"Sub. Name"}),a.jsx(qe,{align:"right",children:"Actions"})]})}),a.jsx(fs,{children:e.map((u,l)=>a.jsxs(pn,{children:[a.jsx(qe,{children:((r||1)-1)*(t||1)+l+1}),a.jsx(qe,{children:u.Category.Name}),a.jsx(qe,{children:u.Name}),a.jsxs(qe,{align:"right",children:[a.jsx(sn,{size:"small",onClick:()=>i(u),children:a.jsx(bl,{fontSize:"small"})}),a.jsx(sn,{size:"small",onClick:()=>c(u.ID),children:a.jsx(ql,{fontSize:"small"})})]})]},u.ID))})]})}),a.jsx(Zm,{component:"div",count:n,page:Math.max(0,r-1),onPageChange:(u,l)=>s(l+1),rowsPerPage:t,onRowsPerPageChange:u=>o(parseInt(u.target.value,10)),rowsPerPageOptions:[5,10,20]})]}),gG=({open:e,title:r,content:t,onCancel:n,onConfirm:s})=>a.jsxs(Oa,{open:e,onClose:n,children:[a.jsx(Wa,{children:r}),a.jsx(Pa,{children:a.jsx(Et,{children:t})}),a.jsxs(Va,{children:[a.jsx(Br,{onClick:n,children:"Cancel"}),a.jsx(Br,{variant:"contained",color:"error",onClick:s,children:"Delete"})]})]}),vG=()=>{const[e,r]=G.useState([]),[t,n]=G.useState(""),[s,o]=G.useState({id:null,name:""}),[i,c]=G.useState(1),[u,l]=G.useState(10),[d,h]=G.useState(0),[f,p]=G.useState(!1),[v,g]=G.useState({open:!1,id:null}),[m,b]=G.useState({open:!1,message:"",severity:"success"});G.useEffect(()=>{y()},[i,u,t]);const y=async()=>{try{const H=await ut.get(`${Je}/api/subcategories`,{params:{page:i,limit:u,filter:t}});r(H.data.data),h(H.data.total)}catch(H){console.error("Failed to fetch subcategories:",H)}},S=async(H={id:null,name:""})=>{var z;if(console.log(H),H.ID)try{o({id:H.ID,name:H.Name,category:H.Category||null,category_id:((z=H.Category)==null?void 0:z.ID)||null}),console.log(s)}catch(q){console.error("Failed to load subcategory details",q),showSnackbar("Failed to load subcategory","error");return}else o({id:null,name:"",category:null,category_id:null});p(!0)},C=()=>{p(!1),o({id:null,name:""})},L=async()=>{try{s.id?await ut.put(`${Je}/api/subcategories/${s.id}`,s):await ut.post(`${Je}/api/subcategories`,s),C(),y()}catch(H){console.error("Failed to save subcategory:",H)}},O=async()=>{var H,z,q,D;try{await ut.delete(`${Je}/api/subcategories/${v.id}`),b({open:!0,message:"Deleted",severity:"success"}),g({open:!1,id:null}),y()}catch(W){console.error("Failed to delete subcategory:",W);const I=((z=(H=W==null?void 0:W.response)==null?void 0:H.data)==null?void 0:z.error)||((D=(q=W==null?void 0:W.response)==null?void 0:q.data)==null?void 0:D.message)||(W==null?void 0:W.message)||"Failed to delete";b({open:!0,message:I,severity:"error"}),g({open:!1,id:null})}};return a.jsxs("section",{className:"right-content",children:[a.jsxs("div",{className:"subcategory-page-header",children:[a.jsx("h6",{children:"Manage Subcategories"}),a.jsx("div",{className:"search-field-wrapper",children:a.jsx("input",{type:"text",className:"search-input",placeholder:"Filter by Name",value:t,onChange:H=>{n(H.target.value),c(1)}})}),a.jsx("div",{className:"add-button-wrapper",children:a.jsx("button",{className:"btn-add",onClick:()=>S(),type:"button",children:"Add Subcategory"})})]}),a.jsx(mG,{data:e,page:i,limit:u,total:d,onPageChange:H=>c(H),onRowsPerPageChange:H=>{l(H),c(1)},onEdit:H=>S(H),onDelete:H=>g({open:!0,id:H})}),a.jsx(pG,{open:f,onClose:C,onSubmit:L,formData:s,setFormData:o}),a.jsx(gG,{open:v.open,title:"Delete Subcategory",content:"Are you sure you want to delete this subcategory?",onCancel:()=>g({open:!1,id:null}),onConfirm:O}),a.jsx(tu,{open:m.open,autoHideDuration:3e3,onClose:()=>b({...m,open:!1}),children:a.jsx(eu,{severity:m.severity,children:m.message})})]})};function xG({open:e,onClose:r,tag:t,onSuccess:n,onError:s}){const{control:o,handleSubmit:i,reset:c,setValue:u}=Gl(),[l,d]=G.useState([]),[h,f]=G.useState(!1),[p,v]=G.useState(!1);G.useEffect(()=>{e&&(async()=>{f(!0);try{const b=await ut.get(`${Je}/api/tags`);let y=[];Array.isArray(b.data)?y=b.data:b.data&&Array.isArray(b.data.data)&&(y=b.data.data);const S=y.map(C=>C.Name).filter(Boolean);d([...new Set(S)].sort())}catch{d([])}finally{f(!1)}})()},[e]),G.useEffect(()=>{t?u("name",t.Name||""):u("name","")},[t,u,e]);const g=async m=>{try{t!=null&&t.ID?await ut.put(`${Je}/api/tags/${t.ID}`,m):await ut.post(`${Je}/api/tags`,m),n()}catch(b){console.error("Error saving Tag:",b),s?s("Error saving Tag."):alert("Error saving Tag.")}};return a.jsxs(Oa,{open:e,onClose:r,maxWidth:"xs",fullWidth:!0,children:[a.jsx(Wa,{children:t?"Edit Tag":"Add Tag"}),a.jsxs("form",{onSubmit:i(g),children:[a.jsx(Pa,{children:a.jsx(En,{name:"name",control:o,rules:{required:!0},render:({field:{onChange:m,value:b,ref:y}})=>a.jsx(bc,{options:l,freeSolo:!0,loading:h,open:p,onOpen:()=>v(!0),onClose:()=>v(!1),inputValue:b||"",onInputChange:(S,C)=>m(C),renderInput:S=>a.jsx(ri,{...S,inputRef:y,autoFocus:!0,label:"Tag Name",fullWidth:!0,margin:"dense",size:"small",required:!0,onClick:()=>v(!0),InputProps:{...S.InputProps,endAdornment:a.jsxs(a.Fragment,{children:[S.InputProps.endAdornment,a.jsx(Qf,{position:"end",children:a.jsx(bs,{title:p?"Close suggestions":"Open suggestions",children:a.jsx(sn,{size:"small","aria-label":p?"close suggestions":"open suggestions",onClick:C=>{C.stopPropagation(),v(L=>!L)},sx:{color:"primary.main"},children:p?a.jsx(q0,{fontSize:"small"}):a.jsx(W0,{fontSize:"small"})})})})]})}})})})}),a.jsxs(Va,{children:[a.jsx(Br,{onClick:r,children:"Cancel"}),a.jsx(Br,{type:"submit",variant:"contained",children:"Save"})]})]})]})}function bG({tags:e,onEdit:r,onDelete:t,page:n,rowsPerPage:s}){return a.jsx(Ws,{component:sa,children:a.jsxs(Cs,{size:"small",children:[a.jsx(js,{children:a.jsxs(pn,{children:[a.jsx(qe,{children:"S.No."}),a.jsx(qe,{children:"Tag Name"}),a.jsx(qe,{align:"right",children:"Actions"})]})}),a.jsx(fs,{children:e.map((o,i)=>a.jsxs(pn,{sx:{height:36},children:[a.jsx(qe,{sx:{py:.5},children:n*s+i+1}),a.jsx(qe,{sx:{py:.5},children:o.Name}),a.jsxs(qe,{align:"right",sx:{py:.5},children:[a.jsx(sn,{size:"small",onClick:()=>r(o),children:a.jsx(bl,{fontSize:"small"})}),a.jsx(sn,{size:"small",onClick:()=>t(o),children:a.jsx(ql,{fontSize:"small"})})]})]},o.ID))})]})})}function G0({open:e,title:r,message:t,onCancel:n,onConfirm:s}){return a.jsxs(Oa,{open:e,onClose:n,children:[a.jsx(Wa,{children:r}),a.jsx(Pa,{children:a.jsx(Et,{children:t})}),a.jsxs(Va,{children:[a.jsx(Br,{onClick:n,children:"Cancel"}),a.jsx(Br,{onClick:s,variant:"contained",color:"error",children:"Delete"})]})]})}function yG(){const[e,r]=G.useState([]),[t,n]=G.useState(!1),[s,o]=G.useState(null),[i,c]=G.useState(!1),[u,l]=G.useState(null),[d,h]=G.useState({open:!1,message:"",severity:"success"}),[f,p]=G.useState(0),[v,g]=G.useState(0),[m,b]=G.useState(10),[y,S]=G.useState(""),[C,L]=G.useState([]),O=async()=>{try{const D=await ut.get(`${Je}/api/tags`,{params:{page:v+1,limit:m,filter:y}});r(D.data.data),p(D.data.total)}catch{z("Failed to load categories","error")}},H=async()=>{try{const D=await ut.get(`${Je}/api/tags`),W=[...new Set(D.data.data.map(P=>P.Name))];L(W.sort())}catch{h({open:!0,message:"Failed to load filter options",severity:"error"})}};G.useEffect(()=>{H()},[]),G.useEffect(()=>{O()},[v,m,y]);const z=(D,W="success")=>{h({open:!0,message:D,severity:W})},q=async()=>{var D,W,P,I;try{await ut.delete(`${Je}/api/tags/${u.ID}`),z("Deleted"),O()}catch(U){console.error("Failed to delete tag:",U);const _=((W=(D=U==null?void 0:U.response)==null?void 0:D.data)==null?void 0:W.error)||((I=(P=U==null?void 0:U.response)==null?void 0:P.data)==null?void 0:I.message)||(U==null?void 0:U.message)||"Failed to delete";h({open:!0,message:_,severity:"error"})}finally{c(!1),l(null)}};return a.jsxs("section",{className:"right-content",children:[a.jsxs("div",{className:"tag-page-header",children:[a.jsx("h6",{children:"Tags Management"}),a.jsx("div",{className:"search-field-wrapper",children:a.jsx("input",{type:"text",className:"search-input",placeholder:"Filter by Name",value:y,onChange:D=>{S(D.target.value),g(0)}})}),a.jsx("div",{className:"add-button-wrapper",children:a.jsx("button",{className:"btn-add",onClick:()=>n(!0),type:"button",children:"Add Tag"})})]}),a.jsx("div",{className:"table-wrapper",children:a.jsx(bG,{tags:e,page:v,rowsPerPage:m,onEdit:D=>{o(D),n(!0)},onDelete:D=>{l(D),c(!0)}})}),a.jsxs("div",{className:"pagination-wrapper",children:[a.jsxs("div",{className:"pagination-info",children:[a.jsx("span",{children:"Rows per page:"}),a.jsxs("select",{value:m,onChange:D=>{b(parseInt(D.target.value,10)),g(0)},children:[a.jsx("option",{value:5,children:"5"}),a.jsx("option",{value:10,children:"10"}),a.jsx("option",{value:25,children:"25"})]}),a.jsxs("span",{children:[f>0?v*m+1:0,"",Math.min((v+1)*m,f)," of ",f]})]}),a.jsxs("div",{className:"pagination-buttons",children:[a.jsx("button",{onClick:()=>g(v-1),disabled:v===0,type:"button",children:"Previous"}),a.jsx("button",{onClick:()=>g(v+1),disabled:(v+1)*m>=f,type:"button",children:"Next"})]})]}),a.jsx(xG,{open:t,onClose:()=>{n(!1),o(null)},tag:s,onSuccess:()=>{O(),n(!1),o(null),z("Tag saved")}}),a.jsx(G0,{open:i,title:"Delete Category",message:`Are you sure you want to delete "${u==null?void 0:u.Name}"?`,onCancel:()=>c(!1),onConfirm:q}),a.jsx(tu,{open:d.open,autoHideDuration:3e3,onClose:()=>h({...d,open:!1}),children:a.jsx(eu,{severity:d.severity,children:d.message})})]})}function wG({units:e,onEdit:r,onDelete:t,page:n,rowsPerPage:s}){return a.jsx(Ws,{component:sa,children:a.jsxs(Cs,{size:"small",children:[a.jsx(js,{children:a.jsxs(pn,{children:[a.jsx(qe,{children:"S.No."}),a.jsx(qe,{children:"Unit"}),a.jsx(qe,{children:"Description"}),a.jsx(qe,{align:"right",children:"Actions"})]})}),a.jsx(fs,{children:e.map((o,i)=>a.jsxs(pn,{sx:{height:36},children:[a.jsx(qe,{sx:{py:.5},children:n*s+i+1}),a.jsx(qe,{sx:{py:.5},children:o.name||o.Name}),a.jsx(qe,{sx:{py:.5},children:o.description||o.Description}),a.jsxs(qe,{align:"right",sx:{py:.5},children:[a.jsx(sn,{size:"small",onClick:()=>r(o),children:a.jsx(bl,{fontSize:"small"})}),a.jsx(sn,{size:"small",onClick:()=>t(o),children:a.jsx(ql,{fontSize:"small"})})]})]},o.ID||i))})]})})}function SG({open:e,onClose:r,unit:t,onSuccess:n}){const{control:s,handleSubmit:o,setValue:i}=Gl({defaultValues:{name:"",description:""}}),[c,u]=G.useState([]),[l,d]=G.useState(!1),[h,f]=G.useState(!1);G.useEffect(()=>{e&&(async()=>{d(!0);try{const g=await ut.get(`${Je}/api/units`);console.log("API Units Response:",g);let m=[];Array.isArray(g.data)?m=g.data:g.data&&typeof g.data=="object"&&(Array.isArray(g.data.data)?m=g.data.data:Object.values(g.data).forEach(b=>{Array.isArray(b)&&(m=b)})),console.log("Processed units:",m),u(m)}catch(g){console.error("Error fetching units:",g),u([])}finally{d(!1)}})()},[e]),G.useEffect(()=>{e&&(t?(i("name",t.name??t.Name??""),i("description",t.description??t.Description??"")):(i("name",""),i("description","")))},[t,e,i]);const p=async v=>{try{const g=(t==null?void 0:t.ID)??(t==null?void 0:t.id);g?await ut.put(`${Je}/api/units/${g}`,v):await ut.post(`${Je}/api/units`,v),n()}catch{alert("Error saving unit.")}};return a.jsxs(Oa,{open:e,onClose:r,fullWidth:!0,maxWidth:"xs",children:[a.jsx(Wa,{children:t?"Edit Unit":"Add Unit"}),a.jsxs("form",{onSubmit:o(p),children:[a.jsxs(Pa,{children:[a.jsx(En,{name:"name",control:s,rules:{required:!0},render:({field:{onChange:v,value:g,ref:m}})=>{const b=Array.isArray(c)?c.map(y=>(y==null?void 0:y.name)||(y==null?void 0:y.Name)||"").filter(y=>y!==""):[];return a.jsx(bc,{options:b,freeSolo:!0,loading:l,open:h,onOpen:()=>f(!0),onClose:()=>f(!1),autoSelect:!0,value:g||"",onChange:(y,S)=>v(S),renderInput:y=>a.jsx(ri,{...y,autoFocus:!0,inputRef:m,label:"Unit",fullWidth:!0,margin:"dense",size:"small",required:!0,onClick:()=>f(!0),InputProps:{...y.InputProps,endAdornment:a.jsxs(a.Fragment,{children:[y.InputProps.endAdornment,a.jsx(Qf,{position:"end",children:a.jsx(bs,{title:h?"Close suggestions":"Open suggestions",children:a.jsx(sn,{size:"small",onClick:S=>{S.stopPropagation(),f(C=>!C)},sx:{color:"primary.main"},children:h?a.jsx(q0,{fontSize:"small"}):a.jsx(W0,{fontSize:"small"})})})})]})}})})}}),a.jsx(En,{name:"description",control:s,render:({field:v})=>a.jsx(ri,{...v,label:"Description",fullWidth:!0,margin:"dense",size:"small",multiline:!0,minRows:2})})]}),a.jsxs(Va,{children:[a.jsx(Br,{onClick:r,children:"Cancel"}),a.jsx(Br,{type:"submit",variant:"contained",children:"Save"})]})]})]})}function _G(){const[e,r]=G.useState([]),[t,n]=G.useState(""),[s,o]=G.useState(0),[i,c]=G.useState(10),[u,l]=G.useState(0),[d,h]=G.useState(!1),[f,p]=G.useState(null),[v,g]=G.useState({open:!1,message:"",severity:"success"}),m=async()=>{try{const S=await ut.get(`${Je}/api/units`,{params:{page:s+1,limit:i,filter:t}});r(S.data.data),l(S.data.total)}catch{g({open:!0,message:"Failed to fetch units",severity:"error"})}};G.useEffect(()=>{m()},[s,i,t]);const b=S=>{p(S),h(!0)},y=async S=>{var C,L;if(console.log("Deleting unit:",S),!!window.confirm("Are you sure?"))try{const O=await ut.delete(`${Je}/api/units/${S.id||S.ID}`);console.log("Delete response:",O),g({open:!0,message:"Deleted",severity:"success"}),m()}catch(O){console.error("Delete error:",O.response||O),g({open:!0,message:`Failed to delete: ${((L=(C=O.response)==null?void 0:C.data)==null?void 0:L.error)||O.message}`,severity:"error"})}};return a.jsxs("div",{className:"section-container",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("h6",{children:"Unit Master"}),a.jsx("div",{className:"search-field-wrapper",children:a.jsx("input",{type:"text",className:"search-input",placeholder:"Search Unit",value:t,onChange:S=>{n(S.target.value),o(0)}})}),a.jsx("div",{className:"add-button-wrapper",children:a.jsx("button",{className:"btn-add",onClick:()=>h(!0),type:"button",children:"Add Unit"})})]}),a.jsx("div",{className:"table-wrapper",children:a.jsx(wG,{units:e,onEdit:b,onDelete:y,page:s,rowsPerPage:i})}),a.jsxs("div",{className:"pagination-wrapper",children:[a.jsxs("div",{className:"pagination-info",children:[a.jsx("span",{children:"Rows per page:"}),a.jsxs("select",{value:i,onChange:S=>{c(parseInt(S.target.value)),o(0)},children:[a.jsx("option",{value:10,children:"10"}),a.jsx("option",{value:25,children:"25"}),a.jsx("option",{value:50,children:"50"}),a.jsx("option",{value:100,children:"100"})]}),a.jsxs("span",{children:[u>0?s*i+1:0,"",Math.min((s+1)*i,u)," of ",u]})]}),a.jsxs("div",{className:"pagination-buttons",children:[a.jsx("button",{onClick:()=>o(s-1),disabled:s===0,type:"button",children:"Previous"}),a.jsx("button",{onClick:()=>o(s+1),disabled:(s+1)*i>=u,type:"button",children:"Next"})]})]}),a.jsx(SG,{open:d,unit:f,onClose:()=>{h(!1),p(null)},onSuccess:()=>{h(!1),m()}}),a.jsx(tu,{open:v.open,autoHideDuration:3e3,onClose:()=>g({...v,open:!1}),children:a.jsx(eu,{severity:v.severity,children:v.message})})]})}function AG({open:e,onClose:r,tax:t,onSuccess:n}){const{control:s,handleSubmit:o,setValue:i}=Gl(),[c,u]=G.useState([]),[l,d]=G.useState(!1),[h,f]=G.useState(!1);G.useEffect(()=>{e&&(async()=>{d(!0);try{const g=await ut.get(`${Je}/api/taxes`);let m=[];Array.isArray(g.data)?m=g.data:g.data&&typeof g.data=="object"&&(Array.isArray(g.data.data)?m=g.data.data:Object.values(g.data).forEach(b=>{Array.isArray(b)&&(m=b)})),u(m)}catch(g){console.error("Error fetching taxes:",g),u([])}finally{d(!1)}})()},[e]),G.useEffect(()=>{t?(i("name",t.Name||""),i("percentage",parseFloat(t.Percentage)||"")):(i("name",""),i("percentage",""))},[t,i]);const p=async v=>{var g,m,b;try{const y={name:v.name,percentage:Number(v.percentage)};t!=null&&t.ID?await ut.put(`${Je}/api/taxes/${t.ID}`,y):await ut.post(`${Je}/api/taxes`,y),n()}catch(y){console.error("Error saving Tax:",y);const S=((m=(g=y==null?void 0:y.response)==null?void 0:g.data)==null?void 0:m.error)||((b=y==null?void 0:y.response)==null?void 0:b.data)||y.message;alert("Error saving Tax: "+JSON.stringify(S))}};return a.jsxs(Oa,{open:e,onClose:r,fullWidth:!0,maxWidth:"xs",children:[a.jsx(Wa,{children:t?"Edit Tax":"Add Tax"}),a.jsxs("form",{onSubmit:o(p),children:[a.jsxs(Pa,{children:[a.jsx(En,{name:"name",control:s,rules:{required:!0},render:({field:{onChange:v,value:g,ref:m}})=>{const b=Array.isArray(c)?c.map(y=>(y==null?void 0:y.Name)||(y==null?void 0:y.name)||"").filter(y=>y!==""):[];return a.jsx(bc,{options:b,freeSolo:!0,loading:l,open:h,onOpen:()=>f(!0),onClose:()=>f(!1),autoSelect:!0,value:g||"",onChange:(y,S)=>v(S),renderInput:y=>a.jsx(ri,{...y,autoFocus:!0,inputRef:m,label:"Tax Name",fullWidth:!0,margin:"dense",size:"small",required:!0,onClick:()=>f(!0),InputProps:{...y.InputProps,endAdornment:a.jsxs(a.Fragment,{children:[y.InputProps.endAdornment,a.jsx(Qf,{position:"end",children:a.jsx(bs,{title:h?"Close suggestions":"Open suggestions",children:a.jsx(sn,{size:"small",onClick:S=>{S.stopPropagation(),f(C=>!C)},sx:{color:"primary.main"},children:h?a.jsx(q0,{fontSize:"small"}):a.jsx(W0,{fontSize:"small"})})})})]})}})})}}),a.jsx(En,{name:"percentage",control:s,rules:{required:!0,valueAsNumber:!0},render:({field:v})=>a.jsx(ri,{...v,label:"Percentage (%)",type:"number",fullWidth:!0,margin:"dense",size:"small",required:!0})})]}),a.jsxs(Va,{children:[a.jsx(Br,{onClick:r,children:"Cancel"}),a.jsx(Br,{type:"submit",variant:"contained",children:"Save"})]})]})]})}function CG({taxes:e,onEdit:r,onDelete:t,page:n,rowsPerPage:s}){return console.log("TAXES DATA:",e),a.jsx(Ws,{component:sa,children:a.jsxs(Cs,{size:"small",children:[a.jsx(js,{children:a.jsxs(pn,{children:[a.jsx(qe,{children:"S.No."}),a.jsx(qe,{children:"Tax Name"}),a.jsx(qe,{children:"Percentage"}),a.jsx(qe,{align:"right",children:"Actions"})]})}),a.jsx(fs,{children:e.map((o,i)=>a.jsxs(pn,{sx:{height:36},children:[a.jsx(qe,{sx:{py:.5},children:n*s+i+1}),a.jsx(qe,{sx:{py:.5},children:o.Name||o.name||o.tax_name||"-"}),a.jsxs(qe,{sx:{py:.5},children:[o.Percentage??o.percentage??o.tax_percentage??"-",o.Percentage||o.percentage||o.tax_percentage?"%":""]}),a.jsxs(qe,{align:"right",sx:{py:.5},children:[a.jsx(sn,{size:"small",onClick:()=>r(o),children:a.jsx(bl,{fontSize:"small"})}),a.jsx(sn,{size:"small",onClick:()=>t(o),children:a.jsx(ql,{fontSize:"small"})})]})]},o.ID))})]})})}function jG(){const[e,r]=G.useState([]),[t,n]=G.useState(!1),[s,o]=G.useState(null),[i,c]=G.useState(!1),[u,l]=G.useState(null),[d,h]=G.useState({open:!1,message:"",severity:"success"}),[f,p]=G.useState(0),[v,g]=G.useState(10),[m,b]=G.useState(0),[y,S]=G.useState(""),C=async()=>{try{const H=await ut.get(`${Je}/api/taxes`,{params:{page:f+1,limit:v,filter:y}});console.log(H),r(H.data.data),b(H.data.total),console.log(e)}catch{L("Failed to load taxes","error")}};G.useEffect(()=>{C()},[f,v,y]);const L=(H,z="success")=>{h({open:!0,message:H,severity:z})},O=async()=>{var H,z,q,D;try{await ut.delete(`${Je}/api/taxes/${u.ID}`),L("Deleted"),C()}catch(W){console.error("Failed to delete tax:",W);const I=((z=(H=W==null?void 0:W.response)==null?void 0:H.data)==null?void 0:z.error)||((D=(q=W==null?void 0:W.response)==null?void 0:q.data)==null?void 0:D.message)||(W==null?void 0:W.message)||"Failed to delete";h({open:!0,message:I,severity:"error"})}finally{c(!1),l(null)}};return a.jsxs("div",{className:"section-container",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("h6",{children:"Tax Management"}),a.jsx("div",{className:"search-field-wrapper",children:a.jsx("input",{type:"text",className:"search-input",placeholder:"Filter by Name",value:y,onChange:H=>{S(H.target.value),p(0)}})}),a.jsx("div",{className:"add-button-wrapper",children:a.jsx("button",{className:"btn-add",onClick:()=>n(!0),type:"button",children:"Add Tax"})})]}),a.jsx("div",{className:"table-wrapper",children:a.jsx(CG,{taxes:e,page:f,rowsPerPage:v,onEdit:H=>{o(H),n(!0)},onDelete:H=>{l(H),c(!0)}})}),a.jsxs("div",{className:"pagination-wrapper",children:[a.jsxs("div",{className:"pagination-info",children:[a.jsx("span",{children:"Rows per page:"}),a.jsxs("select",{value:v,onChange:H=>{g(parseInt(H.target.value,10)),p(0)},children:[a.jsx("option",{value:5,children:"5"}),a.jsx("option",{value:10,children:"10"}),a.jsx("option",{value:25,children:"25"})]}),a.jsxs("span",{children:[m>0?f*v+1:0,"",Math.min((f+1)*v,m)," of ",m]})]}),a.jsxs("div",{className:"pagination-buttons",children:[a.jsx("button",{onClick:()=>p(f-1),disabled:f===0,type:"button",children:"Previous"}),a.jsx("button",{onClick:()=>p(f+1),disabled:(f+1)*v>=m,type:"button",children:"Next"})]})]}),a.jsx(AG,{open:t,onClose:()=>{n(!1),o(null)},tax:s,onSuccess:()=>{C(),n(!1),o(null),L("Tax saved")}}),a.jsx(G0,{open:i,title:"Delete Tax",message:`Are you sure you want to delete "${u==null?void 0:u.Name}"?`,onCancel:()=>c(!1),onConfirm:O}),a.jsx(tu,{open:d.open,autoHideDuration:3e3,onClose:()=>h({...d,open:!1}),children:a.jsx(eu,{severity:d.severity,children:d.message})})]})}function kG({stores:e,onEdit:r,onDelete:t,page:n,rowsPerPage:s}){return a.jsx(Ws,{component:sa,children:a.jsxs(Cs,{size:"small",children:[a.jsx(js,{children:a.jsxs(pn,{children:[a.jsx(qe,{children:"S.No."}),a.jsx(qe,{children:"Store Name"}),a.jsx(qe,{align:"right",children:"Actions"})]})}),a.jsx(fs,{children:e.map((o,i)=>a.jsxs(pn,{sx:{height:36},children:[a.jsx(qe,{sx:{py:.5},children:n*s+i+1}),a.jsx(qe,{sx:{py:.5},children:o.Name}),a.jsxs(qe,{align:"right",sx:{py:.5},children:[a.jsx(sn,{size:"small",onClick:()=>r(o),children:a.jsx(bl,{fontSize:"small"})}),a.jsx(sn,{size:"small",onClick:()=>t(o),children:a.jsx(ql,{fontSize:"small"})})]})]},o.ID))})]})})}function RG({open:e,onClose:r,store:t,onSuccess:n}){const{control:s,handleSubmit:o,setValue:i}=Gl(),[c,u]=G.useState([]),[l,d]=G.useState(!1),[h,f]=G.useState(!1);G.useEffect(()=>{e&&(async()=>{d(!0);try{const g=await ut.get(`${Je}/api/stores`);let m=[];Array.isArray(g.data)?m=g.data:g.data&&typeof g.data=="object"&&(Array.isArray(g.data.data)?m=g.data.data:Object.values(g.data).forEach(b=>{Array.isArray(b)&&(m=b)})),u(m)}catch(g){console.error("Error fetching stores:",g),u([])}finally{d(!1)}})()},[e]),G.useEffect(()=>{t?i("name",t.Name||""):i("name","")},[t,i]);const p=async v=>{var g,m;try{t!=null&&t.ID?await ut.put(`${Je}/api/stores/${t.ID}`,v):await ut.post(`${Je}/api/stores`,v),n()}catch(b){alert(((m=(g=b.response)==null?void 0:g.data)==null?void 0:m.error)||"Error saving store.")}};return a.jsxs(Oa,{open:e,onClose:r,fullWidth:!0,maxWidth:"xs",children:[a.jsx(Wa,{children:t?"Edit Store":"Add Store"}),a.jsxs("form",{onSubmit:o(p),children:[a.jsx(Pa,{children:a.jsx(En,{name:"name",control:s,rules:{required:!0},render:({field:{onChange:v,value:g,ref:m}})=>{const b=Array.isArray(c)?c.map(y=>(y==null?void 0:y.Name)||(y==null?void 0:y.name)||"").filter(y=>y!==""):[];return a.jsx(bc,{options:b,freeSolo:!0,loading:l,open:h,onOpen:()=>f(!0),onClose:()=>f(!1),autoSelect:!0,value:g??"",onChange:(y,S)=>v(S),onInputChange:(y,S)=>{v(S),f(!0)},filterOptions:(y,{inputValue:S})=>{if(!S)return y;const C=S.toLowerCase();return y.filter(L=>(L||"").toLowerCase().includes(C))},renderInput:y=>a.jsx(ri,{...y,autoFocus:!0,inputRef:m,label:"Store Name",fullWidth:!0,margin:"dense",size:"small",required:!0,onClick:()=>f(!0),InputProps:{...y.InputProps,endAdornment:a.jsxs(a.Fragment,{children:[y.InputProps.endAdornment,a.jsx(Qf,{position:"end",children:a.jsx(bs,{title:h?"Close suggestions":"Open suggestions",children:a.jsx(sn,{size:"small",onClick:S=>{S.stopPropagation(),f(C=>!C)},sx:{color:"primary.main"},children:h?a.jsx(q0,{fontSize:"small"}):a.jsx(W0,{fontSize:"small"})})})})]})}})})}})}),a.jsxs(Va,{children:[a.jsx(Br,{onClick:r,children:"Cancel"}),a.jsx(Br,{type:"submit",variant:"contained",children:"Save"})]})]})]})}function EG(){const[e,r]=G.useState([]),[t,n]=G.useState(!1),[s,o]=G.useState(null),[i,c]=G.useState(!1),[u,l]=G.useState(null),[d,h]=G.useState({open:!1,message:"",severity:"success"}),[f,p]=G.useState(0),[v,g]=G.useState(0),[m,b]=G.useState(10),[y,S]=G.useState(""),C=async()=>{try{const H=await ut.get(`${Je}/api/stores`,{params:{page:v+1,limit:m,filter:y}});r(H.data.data),p(H.data.total)}catch{L("Failed to load stores","error")}};G.useEffect(()=>{C()},[v,m,y]);const L=(H,z="success")=>{h({open:!0,message:H,severity:z})},O=async()=>{var H,z;try{await ut.delete(`${Je}/api/stores/${u.ID}`),L("Store deleted"),C()}catch(q){L(((z=(H=q.response)==null?void 0:H.data)==null?void 0:z.error)||"Delete failed","error")}finally{c(!1),l(null)}};return a.jsx("section",{className:"right-content",children:a.jsxs("div",{className:"section-container",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("h6",{children:"Store Management"}),a.jsx("div",{className:"search-field-wrapper",children:a.jsx("input",{type:"text",className:"search-input",placeholder:"Filter by Name",value:y,onChange:H=>{S(H.target.value),g(0)}})}),a.jsx("div",{className:"add-button-wrapper",children:a.jsx("button",{className:"btn-add",onClick:()=>n(!0),type:"button",children:"Add Store"})})]}),a.jsx("div",{className:"table-wrapper",children:a.jsx(kG,{stores:e,page:v,rowsPerPage:m,onEdit:H=>{o(H),n(!0)},onDelete:H=>{l(H),c(!0)}})}),a.jsxs("div",{className:"pagination-wrapper",children:[a.jsxs("div",{className:"pagination-info",children:[a.jsx("span",{children:"Rows per page:"}),a.jsxs("select",{value:m,onChange:H=>{b(parseInt(H.target.value,10)),g(0)},children:[a.jsx("option",{value:5,children:"5"}),a.jsx("option",{value:10,children:"10"}),a.jsx("option",{value:25,children:"25"})]}),a.jsxs("span",{children:[f>0?v*m+1:0,"",Math.min((v+1)*m,f)," of ",f]})]}),a.jsxs("div",{className:"pagination-buttons",children:[a.jsx("button",{onClick:()=>g(v-1),disabled:v===0,type:"button",children:"Previous"}),a.jsx("button",{onClick:()=>g(v+1),disabled:(v+1)*m>=f,type:"button",children:"Next"})]})]}),a.jsx(RG,{open:t,onClose:()=>{n(!1),o(null)},store:s,onSuccess:()=>{C(),n(!1),o(null),L("Store saved")}}),a.jsx(G0,{open:i,title:"Delete Store",message:`Are you sure you want to delete "${u==null?void 0:u.Name}"?`,onCancel:()=>c(!1),onConfirm:O}),a.jsx(tu,{open:d.open,autoHideDuration:3e3,onClose:()=>h({...d,open:!1}),children:a.jsx(eu,{severity:d.severity,children:d.message})})]})})}function NG({data:e,onEdit:r,onDelete:t,page:n=0,rowsPerPage:s=5}){return a.jsx(Ws,{component:sa,children:a.jsxs(Cs,{size:"small",children:[a.jsx(js,{children:a.jsxs(pn,{children:[a.jsx(qe,{children:"S.No."}),a.jsx(qe,{children:"HSN Code"}),a.jsx(qe,{children:"Tax (%)"}),a.jsx(qe,{align:"right",children:"Actions"})]})}),a.jsx(fs,{children:e.map((o,i)=>a.jsxs(pn,{sx:{height:36},children:[a.jsx(qe,{sx:{py:.5},children:n*s+i+1}),a.jsx(qe,{sx:{py:.5},children:o.code}),a.jsx(qe,{sx:{py:.5},children:(()=>{const c=o.tax;if(c&&typeof c=="object"){const u=c.Name||c.name||"-",l=c.Percentage??c.percentage;return l!=null&&l!==""?`${u} (${l}%)`:u}else return c||"-"})()}),a.jsxs(qe,{align:"right",sx:{py:.5},children:[a.jsx(sn,{size:"small",onClick:()=>r(o),children:a.jsx(bl,{fontSize:"small"})}),a.jsx(sn,{size:"small",onClick:()=>t(o),children:a.jsx(ql,{fontSize:"small"})})]})]},o.id))})]})})}function TG({open:e,onClose:r,hsn:t,onSuccess:n,onError:s}){const{register:o,handleSubmit:i,reset:c,control:u}=Gl(),[l,d]=G.useState([]),[h,f]=G.useState([]),[p,v]=G.useState(""),[g,m]=G.useState(!1),[b,y]=G.useState(!1);G.useEffect(()=>{e&&ut.get(`${Je}/api/taxes`,{params:{page:1,limit:100}}).then(L=>d(L.data.data||[])).catch(()=>d([]))},[e]),G.useEffect(()=>{if(p.length>0){const L=setTimeout(()=>{S(p).then(O=>{console.log("Setting HSN options:",O),f(O)})},300);return()=>clearTimeout(L)}else e&&S("").then(L=>{console.log("Setting initial HSN options:",L),f(L)})},[p,e]);const S=async L=>{try{y(!0),console.log("Fetching HSN codes for:",L);const O=await ut.get(`${Je}/api/hsncode`,{params:{search:L,limit:20}});console.log("HSN API response:",O);let H=[];Array.isArray(O.data)?H=O.data:O.data&&typeof O.data=="object"&&(Array.isArray(O.data.data)?H=O.data.data:Object.values(O.data).forEach(q=>{Array.isArray(q)&&(H=q)}));const z=Array.isArray(H)?H.map(q=>q.code||"").filter(Boolean):[];return console.log("Processed HSN options:",z),z}catch(O){return console.error("Error fetching HSN codes:",O),[]}finally{y(!1)}};G.useEffect(()=>{t?(c({code:t.code||"",tax_id:t.tax_id||""}),v(t.code||"")):(c({code:"",tax_id:""}),v(""))},[t,e]);const C=async L=>{console.log("Saving HSN:",L);try{t!=null&&t.id?await ut.put(`${Je}/api/hsncode/${t.id}`,L):await ut.post(`${Je}/api/hsncode`,L),n()}catch(O){console.error("Error saving HSN:",O),s("Error saving HSN.")}};return a.jsxs(Oa,{open:e,onClose:r,fullWidth:!0,maxWidth:"xs",children:[a.jsx(Wa,{children:t?"Edit HSN":"Add HSN"}),a.jsxs("form",{onSubmit:i(C),children:[a.jsxs(Pa,{children:[a.jsx(En,{name:"code",control:u,rules:{required:!0},render:({field:{onChange:L,value:O,ref:H}})=>a.jsx(bc,{freeSolo:!0,autoSelect:!0,options:h,loading:b,loadingText:"Loading HSN codes...",noOptionsText:"No HSN codes found",open:g,onOpen:()=>m(!0),onClose:()=>m(!1),value:O||"",inputValue:p,onInputChange:(z,q,D)=>{console.log("Input changed to:",q,D),v(q),(D==="input"||D==="clear")&&m(!0)},onChange:(z,q)=>{console.log("Selection changed to:",q),L(q),v(q||"")},filterOptions:(z,q)=>{try{const D=(p||"").toString().trim().toLowerCase();return D?z.filter(W=>(W||"").toString().toLowerCase().includes(D)):z}catch{return z}},renderInput:z=>a.jsx(ri,{...z,autoFocus:!0,inputRef:H,label:"HSN Code",fullWidth:!0,margin:"dense",size:"small",required:!0,onClick:()=>m(!0),InputProps:{...z.InputProps,endAdornment:a.jsxs(a.Fragment,{children:[z.InputProps.endAdornment,a.jsx(Qf,{position:"end",children:a.jsx(bs,{title:g?"Close suggestions":"Open suggestions",children:a.jsx(sn,{size:"small",onClick:q=>{q.stopPropagation(),m(D=>!D)},sx:{color:"primary.main"},children:g?a.jsx(q0,{fontSize:"small"}):a.jsx(W0,{fontSize:"small"})})})})]})}})})}),a.jsxs(O6,{fullWidth:!0,margin:"dense",size:"small",children:[a.jsx(F6,{id:"tax-select-label",children:"Tax (%)"}),a.jsx(En,{name:"tax_id",control:u,rules:{required:!0},render:({field:L})=>a.jsx(eh,{labelId:"tax-select-label",label:"Tax (%)",value:L.value||"",onChange:O=>L.onChange(Number(O.target.value)),children:l.map(O=>a.jsxs(zl,{value:O.ID,children:[O.Name," (",O.Percentage,"%)"]},O.ID))})})]})]}),a.jsxs(Va,{children:[a.jsx(Br,{onClick:r,children:"Cancel"}),a.jsx(Br,{type:"submit",variant:"contained",children:"Save"})]})]})]})}function LG(){const[e,r]=G.useState([]),[t,n]=G.useState(""),[s,o]=G.useState(""),[i,c]=G.useState(0),[u,l]=G.useState(10),[d,h]=G.useState(0),[f,p]=G.useState(!1),[v,g]=G.useState(!1),[m,b]=G.useState(null),[y,S]=G.useState({open:!1,message:"",severity:"success"}),[C,L]=G.useState(!1),[O,H]=G.useState(null),[z,q]=G.useState([]);G.useEffect(()=>{const k=setTimeout(()=>{n(s)},500);return()=>clearTimeout(k)},[s]),G.useEffect(()=>{ut.get(`${Je}/api/taxes`,{params:{page:1,limit:100}}).then(k=>q(k.data.data||[])).catch(()=>q([]))},[]);const D=async()=>{p(!0);try{const k=await ut.get(`${Je}/api/hsncode`,{params:{page:i+1,limit:u,filter:t}});r(k.data.data||[]),h(k.data.total||0)}catch(k){console.error("Failed to fetch HSNs:",k),S({open:!0,message:"Failed to fetch HSNs",severity:"error"})}finally{p(!1)}};G.useEffect(()=>{D()},[i,u,t]);const W=k=>{b(k),g(!0)},P=k=>{H(k),L(!0)},I=async()=>{var k,_,R,j;if(O)try{await ut.delete(`${Je}/api/hsncode/${O.id}`),S({open:!0,message:"Deleted",severity:"success"}),D()}catch(A){console.error("Failed to delete HSN:",A);const V=((_=(k=A==null?void 0:A.response)==null?void 0:k.data)==null?void 0:_.error)||((j=(R=A==null?void 0:A.response)==null?void 0:R.data)==null?void 0:j.message)||(A==null?void 0:A.message)||"Failed to delete";S({open:!0,message:V,severity:"error"})}finally{L(!1),H(null)}},U=e.map(k=>({...k,tax:z.find(_=>_.ID===k.tax_id)||null}));return a.jsxs("div",{className:"section-container",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("h6",{children:"HSN Master"}),a.jsx("div",{className:"search-field-wrapper",children:a.jsx("input",{type:"text",className:"search-input",placeholder:"Search HSN",value:s,onChange:k=>{o(k.target.value),c(0)}})}),a.jsx("div",{className:"add-button-wrapper",children:a.jsx("button",{className:"btn-add",onClick:()=>g(!0),type:"button",children:"Add HSN"})})]}),f?a.jsx("div",{className:"loading-container",children:a.jsx("div",{className:"spinner"})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"table-wrapper",children:a.jsx(NG,{data:U,onEdit:W,onDelete:P,page:i,rowsPerPage:u})}),a.jsxs("div",{className:"pagination-wrapper",children:[a.jsxs("div",{className:"pagination-info",children:[a.jsx("span",{children:"Rows per page:"}),a.jsxs("select",{value:u,onChange:k=>{l(parseInt(k.target.value)),c(0)},children:[a.jsx("option",{value:5,children:"5"}),a.jsx("option",{value:10,children:"10"}),a.jsx("option",{value:25,children:"25"})]}),a.jsxs("span",{children:[d>0?i*u+1:0,"",Math.min((i+1)*u,d)," of ",d]})]}),a.jsxs("div",{className:"pagination-buttons",children:[a.jsx("button",{onClick:()=>c(i-1),disabled:i===0,type:"button",children:"Previous"}),a.jsx("button",{onClick:()=>c(i+1),disabled:(i+1)*u>=d,type:"button",children:"Next"})]})]})]}),a.jsx(TG,{open:v,hsn:m,onClose:()=>{g(!1),b(null)},onSuccess:()=>{g(!1),b(null),D()},onError:k=>{S({open:!0,message:k,severity:"error"})}}),a.jsx(G0,{open:C,title:"Delete HSN",message:`Are you sure you want to delete HSN code "${O==null?void 0:O.code}"?`,onCancel:()=>L(!1),onConfirm:I}),a.jsx(tu,{open:y.open,autoHideDuration:3e3,onClose:()=>S({...y,open:!1}),children:a.jsx(eu,{severity:y.severity,children:y.message})})]})}function MG({data:e,onEdit:r,onDelete:t,page:n=0,rowsPerPage:s=5}){return a.jsx(Ws,{component:sa,children:a.jsxs(Cs,{size:"small",children:[a.jsx(js,{children:a.jsxs(pn,{children:[a.jsx(qe,{children:"S.No."}),a.jsx(qe,{children:"Size Code"}),a.jsx(qe,{children:"Description"}),a.jsx(qe,{align:"right",children:"Actions"})]})}),a.jsx(fs,{children:e.map((o,i)=>a.jsxs(pn,{sx:{height:36},children:[a.jsx(qe,{sx:{py:.5},children:n*s+i+1}),a.jsx(qe,{sx:{py:.5},children:o.code}),a.jsx(qe,{sx:{py:.5},children:o.description}),a.jsxs(qe,{align:"right",sx:{py:.5},children:[a.jsx(sn,{size:"small",onClick:()=>r(o),children:a.jsx(bl,{fontSize:"small"})}),a.jsx(sn,{size:"small",onClick:()=>t(o),children:a.jsx(ql,{fontSize:"small"})})]})]},o.id))})]})})}function DG({open:e,onClose:r,size:t,onSuccess:n,onError:s}){const{control:o,handleSubmit:i,setValue:c}=Gl(),[u,l]=G.useState([]),[d,h]=G.useState(!1),[f,p]=G.useState(!1);G.useEffect(()=>{e&&(async()=>{h(!0);try{const m=await ut.get(`${Je}/api/sizes`);let b=[];Array.isArray(m.data)?b=m.data:m.data&&typeof m.data=="object"&&(Array.isArray(m.data.data)?b=m.data.data:Object.values(m.data).forEach(y=>{Array.isArray(y)&&(b=y)})),l(b)}catch(m){console.error("Error fetching sizes:",m),l([])}finally{h(!1)}})()},[e]),G.useEffect(()=>{t?(c("code",t.code||""),c("description",t.description||"")):(c("code",""),c("description",""))},[t,c,e]);const v=async g=>{try{t!=null&&t.id?await ut.put(`${Je}/api/sizes/${t.id}`,g):await ut.post(`${Je}/api/sizes`,g),n()}catch(m){console.error("Error saving size:",m),s("Error saving size.")}};return a.jsxs(Oa,{open:e,onClose:r,maxWidth:"xs",fullWidth:!0,children:[a.jsx(Wa,{children:t?"Edit Size":"Add Size"}),a.jsxs("form",{onSubmit:i(v),children:[a.jsxs(Pa,{children:[a.jsx(En,{name:"code",control:o,rules:{required:!0},render:({field:{onChange:g,value:m,ref:b}})=>{const y=Array.isArray(u)?u.map(S=>(S==null?void 0:S.code)||"").filter(S=>S!==""):[];return a.jsxs("div",{className:"size-dialog__field",children:[a.jsx("input",{list:"sizeCodes",className:"size-dialog__input",placeholder:"Size Code",autoFocus:!0,ref:b,value:m||"",onChange:S=>g(S.target.value),required:!0}),a.jsx("datalist",{id:"sizeCodes",children:y.map((S,C)=>a.jsx("option",{value:S},C))})]})}}),a.jsx(En,{name:"description",control:o,render:({field:g})=>a.jsx("input",{...g,className:"size-dialog__input",placeholder:"Description"})})]}),a.jsxs(Va,{children:[a.jsx(Br,{onClick:r,children:"Cancel"}),a.jsx(Br,{type:"submit",variant:"contained",children:"Save"})]})]})]})}function IG(){const[e,r]=G.useState([]),[t,n]=G.useState(""),[s,o]=G.useState(""),[i,c]=G.useState(0),[u,l]=G.useState(10),[d,h]=G.useState(0),[f,p]=G.useState(!1),[v,g]=G.useState(!1),[m,b]=G.useState(null),[y,S]=G.useState({open:!1,message:"",severity:"success"}),[C,L]=G.useState(!1),[O,H]=G.useState(null);G.useEffect(()=>{const P=setTimeout(()=>{n(s)},500);return()=>clearTimeout(P)},[s]);const z=async()=>{p(!0);try{const P=await ut.get(`${Je}/api/sizes`,{params:{page:i+1,limit:u,filter:t}});r(P.data.data||[]),h(P.data.total||0)}catch(P){console.error("Failed to fetch sizes:",P),S({open:!0,message:"Failed to fetch sizes",severity:"error"})}finally{p(!1)}};G.useEffect(()=>{z()},[i,u,t]);const q=P=>{b(P),g(!0)},D=P=>{H(P),L(!0)},W=async()=>{var P,I,U,k;if(O)try{await ut.delete(`${Je}/api/sizes/${O.id}`),S({open:!0,message:"Deleted",severity:"success"}),z()}catch(_){console.error("Failed to delete size:",_);const j=((I=(P=_==null?void 0:_.response)==null?void 0:P.data)==null?void 0:I.error)||((k=(U=_==null?void 0:_.response)==null?void 0:U.data)==null?void 0:k.message)||(_==null?void 0:_.message)||"Failed to delete";S({open:!0,message:j,severity:"error"})}finally{L(!1),H(null)}};return a.jsxs("div",{className:"section-container",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("h6",{children:"Size Master"}),a.jsx("div",{className:"search-field-wrapper",children:a.jsx("input",{type:"text",className:"search-input",placeholder:"Search Size",value:s,onChange:P=>{o(P.target.value),c(0)}})}),a.jsx("div",{className:"add-button-wrapper",children:a.jsx("button",{className:"btn-add",onClick:()=>g(!0),type:"button",children:"Add Size"})})]}),f?a.jsx("div",{className:"loading-container",children:a.jsx("div",{className:"spinner"})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"table-wrapper",children:a.jsx(MG,{data:e,onEdit:q,onDelete:D,page:i,rowsPerPage:u})}),a.jsxs("div",{className:"pagination-wrapper",children:[a.jsxs("div",{className:"pagination-info",children:[a.jsx("span",{children:"Rows per page:"}),a.jsxs("select",{value:u,onChange:P=>{l(parseInt(P.target.value)),c(0)},children:[a.jsx("option",{value:5,children:"5"}),a.jsx("option",{value:10,children:"10"}),a.jsx("option",{value:25,children:"25"})]}),a.jsxs("span",{children:[d>0?i*u+1:0,"",Math.min((i+1)*u,d)," of ",d]})]}),a.jsxs("div",{className:"pagination-buttons",children:[a.jsx("button",{onClick:()=>c(i-1),disabled:i===0,type:"button",children:"Previous"}),a.jsx("button",{onClick:()=>c(i+1),disabled:(i+1)*u>=d,type:"button",children:"Next"})]})]})]}),a.jsx(DG,{open:v,size:m,onClose:()=>{g(!1),b(null)},onSuccess:()=>{g(!1),b(null),z()},onError:P=>{S({open:!0,message:P,severity:"error"})}}),a.jsx(G0,{open:C,title:"Delete Size",message:`Are you sure you want to delete size "${O==null?void 0:O.name}"?`,onCancel:()=>L(!1),onConfirm:W}),a.jsx(tu,{open:y.open,autoHideDuration:3e3,onClose:()=>S({...y,open:!1}),children:a.jsx(eu,{severity:y.severity,children:y.message})})]})}function OG(){const[e,r]=G.useState(0);return a.jsx("section",{className:"right-content",children:a.jsxs(Ut,{p:4,children:[a.jsxs(uW,{value:e,onChange:(t,n)=>r(n),children:[a.jsx(F1,{label:"Unit"}),a.jsx(F1,{label:"Tax"}),a.jsx(F1,{label:"Store"}),a.jsx(F1,{label:"HSN"}),a.jsx(F1,{label:"Size"})]}),e===0&&a.jsx(_G,{}),e===1&&a.jsx(jG,{}),e===2&&a.jsx(EG,{}),e===3&&a.jsx(LG,{}),e===4&&a.jsx(IG,{})]})})}function PG({tags:e,selectedTagIDs:r,setValue:t,getValues:n}){const s=G.useRef(null),[o,i]=G.useState(!1);G.useEffect(()=>{const h=f=>{s.current&&!s.current.contains(f.target)&&i(!1)};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[]);const c=()=>i(h=>!h),u=h=>{const f=h.ID??h.id,p=n("tagIDs")||[];if(p.map(String).includes(String(f))){const g=p.filter(m=>String(m)!==String(f));t("tagIDs",g)}else t("tagIDs",[...p,f])},l=h=>{const f=n("tagIDs")||[];t("tagIDs",f.filter(p=>String(p)!==String(h)))},d=(r||[]).map(h=>e.find(f=>String(f.ID??f.id)===String(h))).filter(Boolean);return a.jsxs("div",{className:"autocomplete-wrapper",ref:s,children:[a.jsx("div",{className:"selected-items",onClick:c,role:"button",tabIndex:0,children:d.length===0?a.jsx("div",{className:"placeholder",children:"Select tags"}):d.map(h=>a.jsxs("div",{className:"chip",children:[a.jsx("span",{children:h.Name??h.name}),a.jsx("button",{type:"button",className:"remove-btn",onClick:f=>{f.stopPropagation(),l(h.ID??h.id)},children:""})]},h.ID??h.id))}),a.jsx("div",{className:"dropdown-menu",style:{display:o?"block":"none"},children:e.length>0?e.map(h=>{const f=h.ID??h.id,p=(r||[]).map(String).includes(String(f));return a.jsx("div",{className:`dropdown-item ${p?"selected":""}`,onClick:()=>u(h),children:h.Name??h.name},f)}):a.jsx("div",{className:"dropdown-item disabled",children:"No Tags Available"})})]})}function _A({options:e,value:r,onChange:t,onSelect:n,placeholder:s}){const o=G.useRef(null),[i,c]=G.useState(!1),[u,l]=G.useState([]);G.useEffect(()=>{const p=v=>{o.current&&!o.current.contains(v.target)&&c(!1)};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[]);const d=p=>{const v=p.target.value;t(v);const g=e.filter(m=>m.toLowerCase().includes(v.toLowerCase()));l(g),c(g.length>0&&v!=="")},h=p=>{t(p),c(!1),n&&n(p)},f=()=>{l(e),c(e.length>0)};return a.jsxs("div",{className:"autocomplete-wrapper",ref:o,children:[a.jsx("input",{type:"text",value:r,onChange:d,onFocus:f,placeholder:s}),a.jsx("div",{className:"dropdown-menu",style:{display:i?"block":"none"},children:u.map(p=>a.jsx("div",{className:"dropdown-item",onClick:()=>h(p),children:p},p))})]})}function FG({defaultValues:e,onNext:r,resetForm:t}){const{register:n,handleSubmit:s,watch:o,setValue:i,reset:c,getValues:u}=Gl({});G.useEffect(()=>{n("tagIDs")},[n]);const[l,d]=G.useState([]),[h,f]=G.useState([]),[p,v]=G.useState([]),[g,m]=G.useState([]),[b,y]=G.useState([]),[S,C]=G.useState([]),[L,O]=G.useState([]),[H,z]=G.useState(!0),[q,D]=G.useState([]),[W,P]=G.useState([]),[I,U]=G.useState("");G.useEffect(()=>{c(e?{name:e.name||e.Name||"",code:e.code||e.Code||"",hsnID:e.hsnID||e.HsnID||"",hsnSacCode:e.hsnSacCode||e.HsnSacCode||"",importance:e.importance||e.Importance||"Normal",productType:e.productType||e.ProductType||"All",minimumStock:e.minimumStock||e.MinimumStock||"",categoryID:e.categoryID||e.CategoryID||"",subcategoryID:e.subcategoryID||e.SubcategoryID||"",unitID:e.unitID||e.UnitID||"",product_mode:e.product_mode||e.ProductMode||"",storeID:e.storeID||e.StoreID||"",tagIDs:(()=>{const Z=e.tagIDs??e.TagIDs??e.tagID??e.TagID;return Z==null||Z===""?[]:Array.isArray(Z)?Z:[Z]})(),taxID:e.taxID||e.TaxID||"",gstPercent:e.gstPercent||e.GstPercent||"",description:e.description||e.Description||"",internalNotes:e.internalNotes||e.InternalNotes||"",isActive:typeof e.isActive<"u"?e.isActive:!0,moq:e.moq||e.MOQ||""}:{name:"",code:"",hsnID:"",hsnSacCode:"",importance:"Normal",productType:"All",minimumStock:"",categoryID:"",subcategoryID:"",unitID:"",product_mode:"",storeID:"",tagIDs:[],taxID:"",gstPercent:"",description:"",internalNotes:"",isActive:!0,moq:""})},[e,c]);const k=o("categoryID"),_=o("taxID"),R=o("hsnID"),j=o("name"),A=o("code");o("tagIDs"),G.useEffect(()=>{(async()=>{try{const[J,re,X,ne,Y,K,ee]=await Promise.all([ut.get(`${Je}/api/categories`,{params:{page:1,limit:1e3}}),ut.get(`${Je}/api/units`,{params:{page:1,limit:1e3}}),ut.get(`${Je}/api/stores`,{params:{page:1,limit:1e3}}),ut.get(`${Je}/api/taxes`,{params:{page:1,limit:1e3}}),ut.get(`${Je}/api/products`,{params:{page:1,limit:1e4}}),ut.get(`${Je}/api/hsncode`,{params:{page:1,limit:1e3}}),ut.get(`${Je}/api/tags`,{params:{page:1,limit:1e3}})]);d(J.data.data||[]),v(re.data.data||[]),m(X.data.data||[]),y(ne.data.data||[]);const ue=Y.data.data||[];P(ue),D(ue.map(se=>se.code||se.Code)),O(K.data.data||[]),C(ee.data.data||[])}catch(J){console.error("Error loading dropdowns/products",J)}finally{z(!1)}})()},[]);const N=[...new Set(W.map(Z=>Z.name||Z.Name).filter(Z=>Z))],V=[...new Set(W.map(Z=>Z.code||Z.Code).filter(Z=>Z))];if(G.useEffect(()=>{k?ut.get(`${Je}/api/subcategories`,{params:{category_id:k,page:1,limit:1e3}}).then(Z=>f(Z.data.data||[])).catch(()=>f([])):f([])},[k]),G.useEffect(()=>{if(_){const Z=b.find(J=>String(J.ID||J.id)===String(_));Z&&i("gstPercent",Z.Percentage??Z.percentage??"")}else i("gstPercent","")},[_,b,i]),G.useEffect(()=>{if(!R)return;const Z=L.find(J=>String(J.id||J.ID)===String(R));if(Z){let J=null;if(Z.tax?J=Z.tax:Z.tax_id&&(J=b.find(re=>String(re.ID||re.id)===String(Z.tax_id))),J){const re=J.ID||J.id;i("taxID",re,{shouldValidate:!0}),i("gstPercent",J.Percentage??J.percentage??"",{shouldValidate:!0})}Z.code&&i("hsnSacCode",Z.code)}},[R,L,b,i]),G.useEffect(()=>{if(!W||W.length===0){U("");return}const Z=Y=>(Y||"").toString().trim().toLowerCase(),J=Z(j),re=Z(A),X=J!==""&&W.some(Y=>Z(Y.name||Y.Name)===J),ne=re!==""&&W.some(Y=>Z(Y.code||Y.Code)===re);U(X&&ne?"A product with this name and code already exists. Please use unique values.":X?"A product with this name already exists.":ne?"A product with this code already exists.":"")},[j,A,W]),H)return a.jsx("div",{className:"loading-wrapper",children:a.jsxs("div",{className:"spinner",children:[a.jsx(Vs,{}),a.jsx("div",{className:"loading-text",children:"Loading form data..."})]})});const M=Z=>{U("");const J=K=>(K||"").toString().trim().toLowerCase(),re=J(Z.name),X=J(Z.code),ne=re!==""&&W.some(K=>J(K.name||K.Name)===re),Y=X!==""&&W.some(K=>J(K.code||K.Code)===X);if(ne&&Y){U("A product with this name and code already exists. Please use unique values.");return}if(ne){U("A product with this name already exists.");return}if(Y){U("A product with this code already exists.");return}r(Z)};return a.jsxs("div",{className:"product-step-form",children:[I&&a.jsx("div",{className:"form-error",children:I}),a.jsxs("form",{onSubmit:s(M),children:[a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"field-label",children:"Product Name"}),a.jsx(_A,{options:N,value:u("name")||"",onChange:Z=>i("name",Z),onSelect:Z=>{const J=W.find(re=>(re.name||re.Name)===Z);J&&i("code",J.code||J.Code||"")},placeholder:"Enter product name"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"field-label",children:"Code"}),a.jsx(_A,{options:V,value:u("code")||"",onChange:Z=>i("code",Z),onSelect:Z=>{const J=W.find(re=>(re.code||re.Code)===Z);J&&i("name",J.name||J.Name||"")},placeholder:"Enter product code"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"field-label",children:"HSN Code"}),a.jsxs("select",{value:o("hsnID")||"",...n("hsnID"),onChange:Z=>i("hsnID",Z.target.value),children:[a.jsx("option",{value:"",children:"Select HSN Code"}),L.map(Z=>a.jsx("option",{value:Z.id||Z.ID,children:Z.code},Z.id||Z.ID))]})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"field-label",children:"Importance"}),a.jsx("select",{...n("importance",{required:!0}),defaultValue:"Normal",children:["Normal","High","Critical"].map(Z=>a.jsx("option",{value:Z,children:Z},Z))})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"field-label",children:"Product Type"}),a.jsx("select",{...n("productType",{required:!0}),defaultValue:"All",children:["All","Finished Goods","Semi-Finished Goods","Raw Materials"].map(Z=>a.jsx("option",{value:Z,children:Z},Z))})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"field-label",children:"Minimum Stock"}),a.jsx("input",{type:"number",placeholder:"0",...n("minimumStock",{valueAsNumber:!0})})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"field-label required",children:"Category"}),a.jsxs("select",{value:o("categoryID")||"",...n("categoryID",{required:!0}),children:[a.jsx("option",{value:"",children:"Select Category"}),l.map(Z=>a.jsx("option",{value:Z.ID||Z.id,children:Z.Name||Z.name},Z.ID||Z.id))]})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"field-label",children:"Subcategory"}),a.jsxs("select",{value:o("subcategoryID")||"",...n("subcategoryID"),children:[a.jsx("option",{value:"",children:"Select Subcategory"}),h.length>0?h.map(Z=>a.jsx("option",{value:Z.ID||Z.id,children:Z.Name||Z.name},Z.ID||Z.id)):a.jsx("option",{disabled:!0,children:"No Subcategories Available"})]})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"field-label",children:"Unit"}),a.jsxs("select",{value:o("unitID")||"",...n("unitID"),children:[a.jsx("option",{value:"",children:"Select Unit"}),p.map(Z=>a.jsx("option",{value:Z.ID||Z.id,children:Z.Name||Z.name},Z.ID||Z.id))]})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"field-label",children:"Product Mode"}),a.jsxs("select",{value:o("product_mode")||"",...n("product_mode"),onChange:Z=>i("product_mode",Z.target.value),children:[a.jsx("option",{value:"",children:"Select Mode"}),a.jsx("option",{value:"Purchase",children:"Purchase"}),a.jsx("option",{value:"Internal Manufacturing",children:"Internal Manufacturing"}),a.jsx("option",{value:"Both",children:"Both"})]})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"field-label",children:"MOQ"}),a.jsx("input",{type:"number",placeholder:"0",...n("moq",{valueAsNumber:!0})})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"field-label",children:"Store"}),a.jsxs("select",{value:o("storeID")||"",...n("storeID"),children:[a.jsx("option",{value:"",children:"Select Store"}),g.map(Z=>a.jsx("option",{value:Z.ID||Z.id,children:Z.Name||Z.name},Z.ID||Z.id))]})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"field-label",children:"Tax"}),a.jsxs("select",{value:o("taxID")||"",...n("taxID"),children:[a.jsx("option",{value:"",children:"Select Tax"}),b.map(Z=>a.jsx("option",{value:Z.ID||Z.id,children:Z.Name||Z.name},Z.ID||Z.id))]})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"field-label",children:"GST %"}),a.jsx("input",{type:"number",readOnly:!0,...n("gstPercent")})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"field-label",children:"Tag"}),a.jsx(PG,{tags:S,selectedTagIDs:o("tagIDs")||[],setValue:i,getValues:u})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"field-label",children:"Description"}),a.jsx("textarea",{placeholder:"Enter product description",...n("description")})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"field-label",children:"Internal Notes"}),a.jsx("textarea",{placeholder:"Enter internal notes",...n("internalNotes")})]}),a.jsx("div",{className:"form-field",children:a.jsxs("div",{className:"checkbox-wrapper",children:[a.jsx("input",{type:"checkbox",id:"isActive",defaultChecked:!0,...n("isActive")}),a.jsx("label",{htmlFor:"isActive",children:"Is Active"})]})})]}),a.jsx("div",{className:"form-actions",children:a.jsx("button",{type:"submit",className:"btn-primary",children:"Next"})})]})]})}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var MS=function(e,r){return MS=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])},MS(e,r)};function BG(e,r){MS(e,r);function t(){this.constructor=e}e.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var Co=function(){return Co=Object.assign||function(r){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Co.apply(this,arguments)},f3,AA;function zG(){if(AA)return f3;AA=1;var e=!1,r,t,n,s,o,i,c,u,l,d,h,f,p,v,g;function m(){if(!e){e=!0;var y=navigator.userAgent,S=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(y),C=/(Mac OS X)|(Windows)|(Linux)/.exec(y);if(f=/\b(iPhone|iP[ao]d)/.exec(y),p=/\b(iP[ao]d)/.exec(y),d=/Android/i.exec(y),v=/FBAN\/\w+;/i.exec(y),g=/Mobile/i.exec(y),h=!!/Win64/.exec(y),S){r=S[1]?parseFloat(S[1]):S[5]?parseFloat(S[5]):NaN,r&&document&&document.documentMode&&(r=document.documentMode);var L=/(?:Trident\/(\d+.\d+))/.exec(y);i=L?parseFloat(L[1])+4:r,t=S[2]?parseFloat(S[2]):NaN,n=S[3]?parseFloat(S[3]):NaN,s=S[4]?parseFloat(S[4]):NaN,s?(S=/(?:Chrome\/(\d+\.\d+))/.exec(y),o=S&&S[1]?parseFloat(S[1]):NaN):o=NaN}else r=t=n=o=s=NaN;if(C){if(C[1]){var O=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(y);c=O?parseFloat(O[1].replace("_",".")):!0}else c=!1;u=!!C[2],l=!!C[3]}else c=u=l=!1}}var b={ie:function(){return m()||r},ieCompatibilityMode:function(){return m()||i>r},ie64:function(){return b.ie()&&h},firefox:function(){return m()||t},opera:function(){return m()||n},webkit:function(){return m()||s},safari:function(){return b.webkit()},chrome:function(){return m()||o},windows:function(){return m()||u},osx:function(){return m()||c},linux:function(){return m()||l},iphone:function(){return m()||f},mobile:function(){return m()||f||p||d||g},nativeApp:function(){return m()||v},android:function(){return m()||d},ipad:function(){return m()||p}};return f3=b,f3}var h3,CA;function $G(){if(CA)return h3;CA=1;var e=!!(typeof window<"u"&&window.document&&window.document.createElement),r={canUseDOM:e,canUseWorkers:typeof Worker<"u",canUseEventListeners:e&&!!(window.addEventListener||window.attachEvent),canUseViewport:e&&!!window.screen,isInWorker:!e};return h3=r,h3}var p3,jA;function UG(){if(jA)return p3;jA=1;var e=$G(),r;e.canUseDOM&&(r=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);/**
 * Checks if an event is supported in the current execution environment.
 *
 * NOTE: This will not work correctly for non-generic events such as `change`,
 * `reset`, `load`, `error`, and `select`.
 *
 * Borrows from Modernizr.
 *
 * @param {string} eventNameSuffix Event name, e.g. "click".
 * @param {?boolean} capture Check if the capture phase is supported.
 * @return {boolean} True if the event is supported.
 * @internal
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 */function t(n,s){if(!e.canUseDOM||s&&!("addEventListener"in document))return!1;var o="on"+n,i=o in document;if(!i){var c=document.createElement("div");c.setAttribute(o,"return;"),i=typeof c[o]=="function"}return!i&&r&&n==="wheel"&&(i=document.implementation.hasFeature("Events.wheel","3.0")),i}return p3=t,p3}var m3,kA;function HG(){if(kA)return m3;kA=1;var e=zG(),r=UG(),t=10,n=40,s=800;function o(i){var c=0,u=0,l=0,d=0;return"detail"in i&&(u=i.detail),"wheelDelta"in i&&(u=-i.wheelDelta/120),"wheelDeltaY"in i&&(u=-i.wheelDeltaY/120),"wheelDeltaX"in i&&(c=-i.wheelDeltaX/120),"axis"in i&&i.axis===i.HORIZONTAL_AXIS&&(c=u,u=0),l=c*t,d=u*t,"deltaY"in i&&(d=i.deltaY),"deltaX"in i&&(l=i.deltaX),(l||d)&&i.deltaMode&&(i.deltaMode==1?(l*=n,d*=n):(l*=s,d*=s)),l&&!c&&(c=l<1?-1:1),d&&!u&&(u=d<1?-1:1),{spinX:c,spinY:u,pixelX:l,pixelY:d}}return o.getEventType=function(){return e.firefox()?"DOMMouseScroll":r("wheel")?"wheel":"mousewheel"},m3=o,m3}var g3,RA;function VG(){return RA||(RA=1,g3=HG()),g3}var WG=VG();const qG=Xv(WG);function GG(e,r,t,n,s,o){o===void 0&&(o=0);var i=$m(e,r,o),c=i.width,u=i.height,l=Math.min(c,t),d=Math.min(u,n);return l>d*s?{width:d*s,height:d}:{width:l,height:l/s}}function KG(e){return e.width>e.height?e.width/e.naturalWidth:e.height/e.naturalHeight}function Ay(e,r,t,n,s){s===void 0&&(s=0);var o=$m(r.width,r.height,s),i=o.width,c=o.height;return{x:EA(e.x,i,t.width,n),y:EA(e.y,c,t.height,n)}}function EA(e,r,t,n){var s=r*n/2-t/2;return Tw(e,-s,s)}function NA(e,r){return Math.sqrt(Math.pow(e.y-r.y,2)+Math.pow(e.x-r.x,2))}function TA(e,r){return Math.atan2(r.y-e.y,r.x-e.x)*180/Math.PI}function XG(e,r,t,n,s,o,i){o===void 0&&(o=0),i===void 0&&(i=!0);var c=i?YG:ZG,u=$m(r.width,r.height,o),l=$m(r.naturalWidth,r.naturalHeight,o),d={x:c(100,((u.width-t.width/s)/2-e.x/s)/u.width*100),y:c(100,((u.height-t.height/s)/2-e.y/s)/u.height*100),width:c(100,t.width/u.width*100/s),height:c(100,t.height/u.height*100/s)},h=Math.round(c(l.width,d.width*l.width/100)),f=Math.round(c(l.height,d.height*l.height/100)),p=l.width>=l.height*n,v=p?{width:Math.round(f*n),height:f}:{width:h,height:Math.round(h/n)},g=Co(Co({},v),{x:Math.round(c(l.width-v.width,d.x*l.width/100)),y:Math.round(c(l.height-v.height,d.y*l.height/100))});return{croppedAreaPercentages:d,croppedAreaPixels:g}}function YG(e,r){return Math.min(e,Math.max(0,r))}function ZG(e,r){return r}function JG(e,r,t,n,s,o){var i=$m(r.width,r.height,t),c=Tw(n.width/i.width*(100/e.width),s,o),u={x:c*i.width/2-n.width/2-i.width*c*(e.x/100),y:c*i.height/2-n.height/2-i.height*c*(e.y/100)};return{crop:u,zoom:c}}function QG(e,r,t){var n=KG(r);return t.height>t.width?t.height/(e.height*n):t.width/(e.width*n)}function eK(e,r,t,n,s,o){t===void 0&&(t=0);var i=$m(r.naturalWidth,r.naturalHeight,t),c=Tw(QG(e,r,n),s,o),u=n.height>n.width?n.height/e.height:n.width/e.width,l={x:((i.width-e.width)/2-e.x)*u,y:((i.height-e.height)/2-e.y)*u};return{crop:l,zoom:c}}function LA(e,r){return{x:(r.x+e.x)/2,y:(r.y+e.y)/2}}function tK(e){return e*Math.PI/180}function $m(e,r,t){var n=tK(t);return{width:Math.abs(Math.cos(n)*e)+Math.abs(Math.sin(n)*r),height:Math.abs(Math.sin(n)*e)+Math.abs(Math.cos(n)*r)}}function Tw(e,r,t){return Math.min(Math.max(e,r),t)}function Cy(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e.filter(function(t){return typeof t=="string"&&t.length>0}).join(" ").trim()}var rK=`.reactEasyCrop_Container {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: hidden;
  user-select: none;
  touch-action: none;
  cursor: move;
  display: flex;
  justify-content: center;
  align-items: center;
}

.reactEasyCrop_Image,
.reactEasyCrop_Video {
  will-change: transform; /* this improves performances and prevent painting issues on iOS Chrome */
}

.reactEasyCrop_Contain {
  max-width: 100%;
  max-height: 100%;
  margin: auto;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
}
.reactEasyCrop_Cover_Horizontal {
  width: 100%;
  height: auto;
}
.reactEasyCrop_Cover_Vertical {
  width: auto;
  height: 100%;
}

.reactEasyCrop_CropArea {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  border: 1px solid rgba(255, 255, 255, 0.5);
  box-sizing: border-box;
  box-shadow: 0 0 0 9999em;
  color: rgba(0, 0, 0, 0.5);
  overflow: hidden;
}

.reactEasyCrop_CropAreaRound {
  border-radius: 50%;
}

.reactEasyCrop_CropAreaGrid::before {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 0;
  bottom: 0;
  left: 33.33%;
  right: 33.33%;
  border-top: 0;
  border-bottom: 0;
}

.reactEasyCrop_CropAreaGrid::after {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 33.33%;
  bottom: 33.33%;
  left: 0;
  right: 0;
  border-left: 0;
  border-right: 0;
}
`,nK=1,aK=3,Lw=function(e){BG(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.imageRef=vr.createRef(),t.videoRef=vr.createRef(),t.containerRef=null,t.styleRef=null,t.containerRect=null,t.mediaSize={width:0,height:0,naturalWidth:0,naturalHeight:0},t.dragStartPosition={x:0,y:0},t.dragStartCrop={x:0,y:0},t.gestureZoomStart=0,t.gestureRotationStart=0,t.isTouching=!1,t.lastPinchDistance=0,t.lastPinchRotation=0,t.rafDragTimeout=null,t.rafPinchTimeout=null,t.wheelTimer=null,t.currentDoc=typeof document<"u"?document:null,t.currentWindow=typeof window<"u"?window:null,t.resizeObserver=null,t.state={cropSize:null,hasWheelJustStarted:!1},t.initResizeObserver=function(){if(!(typeof window.ResizeObserver>"u"||!t.containerRef)){var n=!0;t.resizeObserver=new window.ResizeObserver(function(s){if(n){n=!1;return}t.computeSizes()}),t.resizeObserver.observe(t.containerRef)}},t.preventZoomSafari=function(n){return n.preventDefault()},t.cleanEvents=function(){t.currentDoc&&(t.currentDoc.removeEventListener("mousemove",t.onMouseMove),t.currentDoc.removeEventListener("mouseup",t.onDragStopped),t.currentDoc.removeEventListener("touchmove",t.onTouchMove),t.currentDoc.removeEventListener("touchend",t.onDragStopped),t.currentDoc.removeEventListener("gesturemove",t.onGestureMove),t.currentDoc.removeEventListener("gestureend",t.onGestureEnd))},t.clearScrollEvent=function(){t.containerRef&&t.containerRef.removeEventListener("wheel",t.onWheel),t.wheelTimer&&clearTimeout(t.wheelTimer)},t.onMediaLoad=function(){var n=t.computeSizes();n&&(t.emitCropData(),t.setInitialCrop(n)),t.props.onMediaLoaded&&t.props.onMediaLoaded(t.mediaSize)},t.setInitialCrop=function(n){if(t.props.initialCroppedAreaPercentages){var s=JG(t.props.initialCroppedAreaPercentages,t.mediaSize,t.props.rotation,n,t.props.minZoom,t.props.maxZoom),o=s.crop,i=s.zoom;t.props.onCropChange(o),t.props.onZoomChange&&t.props.onZoomChange(i)}else if(t.props.initialCroppedAreaPixels){var c=eK(t.props.initialCroppedAreaPixels,t.mediaSize,t.props.rotation,n,t.props.minZoom,t.props.maxZoom),o=c.crop,i=c.zoom;t.props.onCropChange(o),t.props.onZoomChange&&t.props.onZoomChange(i)}},t.computeSizes=function(){var n,s,o,i,c,u,l=t.imageRef.current||t.videoRef.current;if(l&&t.containerRef){t.containerRect=t.containerRef.getBoundingClientRect();var d=t.containerRect.width/t.containerRect.height,h=((n=t.imageRef.current)===null||n===void 0?void 0:n.naturalWidth)||((s=t.videoRef.current)===null||s===void 0?void 0:s.videoWidth)||0,f=((o=t.imageRef.current)===null||o===void 0?void 0:o.naturalHeight)||((i=t.videoRef.current)===null||i===void 0?void 0:i.videoHeight)||0,p=l.offsetWidth<h||l.offsetHeight<f,v=h/f,g=void 0;if(p)switch(t.props.objectFit){default:case"contain":g=d>v?{width:t.containerRect.height*v,height:t.containerRect.height}:{width:t.containerRect.width,height:t.containerRect.width/v};break;case"horizontal-cover":g={width:t.containerRect.width,height:t.containerRect.width/v};break;case"vertical-cover":g={width:t.containerRect.height*v,height:t.containerRect.height};break;case"auto-cover":g=h>f?{width:t.containerRect.width,height:t.containerRect.width/v}:{width:t.containerRect.height*v,height:t.containerRect.height};break}else g={width:l.offsetWidth,height:l.offsetHeight};t.mediaSize=Co(Co({},g),{naturalWidth:h,naturalHeight:f}),t.props.setMediaSize&&t.props.setMediaSize(t.mediaSize);var m=t.props.cropSize?t.props.cropSize:GG(t.mediaSize.width,t.mediaSize.height,t.containerRect.width,t.containerRect.height,t.props.aspect,t.props.rotation);return(((c=t.state.cropSize)===null||c===void 0?void 0:c.height)!==m.height||((u=t.state.cropSize)===null||u===void 0?void 0:u.width)!==m.width)&&t.props.onCropSizeChange&&t.props.onCropSizeChange(m),t.setState({cropSize:m},t.recomputeCropPosition),t.props.setCropSize&&t.props.setCropSize(m),m}},t.onMouseDown=function(n){t.currentDoc&&(n.preventDefault(),t.currentDoc.addEventListener("mousemove",t.onMouseMove),t.currentDoc.addEventListener("mouseup",t.onDragStopped),t.onDragStart(r.getMousePoint(n)))},t.onMouseMove=function(n){return t.onDrag(r.getMousePoint(n))},t.onTouchStart=function(n){t.currentDoc&&(t.isTouching=!0,!(t.props.onTouchRequest&&!t.props.onTouchRequest(n))&&(t.currentDoc.addEventListener("touchmove",t.onTouchMove,{passive:!1}),t.currentDoc.addEventListener("touchend",t.onDragStopped),n.touches.length===2?t.onPinchStart(n):n.touches.length===1&&t.onDragStart(r.getTouchPoint(n.touches[0]))))},t.onTouchMove=function(n){n.preventDefault(),n.touches.length===2?t.onPinchMove(n):n.touches.length===1&&t.onDrag(r.getTouchPoint(n.touches[0]))},t.onGestureStart=function(n){t.currentDoc&&(n.preventDefault(),t.currentDoc.addEventListener("gesturechange",t.onGestureMove),t.currentDoc.addEventListener("gestureend",t.onGestureEnd),t.gestureZoomStart=t.props.zoom,t.gestureRotationStart=t.props.rotation)},t.onGestureMove=function(n){if(n.preventDefault(),!t.isTouching){var s=r.getMousePoint(n),o=t.gestureZoomStart-1+n.scale;if(t.setNewZoom(o,s,{shouldUpdatePosition:!0}),t.props.onRotationChange){var i=t.gestureRotationStart+n.rotation;t.props.onRotationChange(i)}}},t.onGestureEnd=function(n){t.cleanEvents()},t.onDragStart=function(n){var s,o,i=n.x,c=n.y;t.dragStartPosition={x:i,y:c},t.dragStartCrop=Co({},t.props.crop),(o=(s=t.props).onInteractionStart)===null||o===void 0||o.call(s)},t.onDrag=function(n){var s=n.x,o=n.y;t.currentWindow&&(t.rafDragTimeout&&t.currentWindow.cancelAnimationFrame(t.rafDragTimeout),t.rafDragTimeout=t.currentWindow.requestAnimationFrame(function(){if(t.state.cropSize&&!(s===void 0||o===void 0)){var i=s-t.dragStartPosition.x,c=o-t.dragStartPosition.y,u={x:t.dragStartCrop.x+i,y:t.dragStartCrop.y+c},l=t.props.restrictPosition?Ay(u,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):u;t.props.onCropChange(l)}}))},t.onDragStopped=function(){var n,s;t.isTouching=!1,t.cleanEvents(),t.emitCropData(),(s=(n=t.props).onInteractionEnd)===null||s===void 0||s.call(n)},t.onWheel=function(n){if(t.currentWindow&&!(t.props.onWheelRequest&&!t.props.onWheelRequest(n))){n.preventDefault();var s=r.getMousePoint(n),o=qG(n).pixelY,i=t.props.zoom-o*t.props.zoomSpeed/200;t.setNewZoom(i,s,{shouldUpdatePosition:!0}),t.state.hasWheelJustStarted||t.setState({hasWheelJustStarted:!0},function(){var c,u;return(u=(c=t.props).onInteractionStart)===null||u===void 0?void 0:u.call(c)}),t.wheelTimer&&clearTimeout(t.wheelTimer),t.wheelTimer=t.currentWindow.setTimeout(function(){return t.setState({hasWheelJustStarted:!1},function(){var c,u;return(u=(c=t.props).onInteractionEnd)===null||u===void 0?void 0:u.call(c)})},250)}},t.getPointOnContainer=function(n){var s=n.x,o=n.y;if(!t.containerRect)throw new Error("The Cropper is not mounted");return{x:t.containerRect.width/2-(s-t.containerRect.left),y:t.containerRect.height/2-(o-t.containerRect.top)}},t.getPointOnMedia=function(n){var s=n.x,o=n.y,i=t.props,c=i.crop,u=i.zoom;return{x:(s+c.x)/u,y:(o+c.y)/u}},t.setNewZoom=function(n,s,o){var i=o===void 0?{}:o,c=i.shouldUpdatePosition,u=c===void 0?!0:c;if(!(!t.state.cropSize||!t.props.onZoomChange)){var l=Tw(n,t.props.minZoom,t.props.maxZoom);if(u){var d=t.getPointOnContainer(s),h=t.getPointOnMedia(d),f={x:h.x*l-d.x,y:h.y*l-d.y},p=t.props.restrictPosition?Ay(f,t.mediaSize,t.state.cropSize,l,t.props.rotation):f;t.props.onCropChange(p)}t.props.onZoomChange(l)}},t.getCropData=function(){if(!t.state.cropSize)return null;var n=t.props.restrictPosition?Ay(t.props.crop,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):t.props.crop;return XG(n,t.mediaSize,t.state.cropSize,t.getAspect(),t.props.zoom,t.props.rotation,t.props.restrictPosition)},t.emitCropData=function(){var n=t.getCropData();if(n){var s=n.croppedAreaPercentages,o=n.croppedAreaPixels;t.props.onCropComplete&&t.props.onCropComplete(s,o),t.props.onCropAreaChange&&t.props.onCropAreaChange(s,o)}},t.emitCropAreaChange=function(){var n=t.getCropData();if(n){var s=n.croppedAreaPercentages,o=n.croppedAreaPixels;t.props.onCropAreaChange&&t.props.onCropAreaChange(s,o)}},t.recomputeCropPosition=function(){if(t.state.cropSize){var n=t.props.restrictPosition?Ay(t.props.crop,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):t.props.crop;t.props.onCropChange(n),t.emitCropData()}},t}return r.prototype.componentDidMount=function(){!this.currentDoc||!this.currentWindow||(this.containerRef&&(this.containerRef.ownerDocument&&(this.currentDoc=this.containerRef.ownerDocument),this.currentDoc.defaultView&&(this.currentWindow=this.currentDoc.defaultView),this.initResizeObserver(),typeof window.ResizeObserver>"u"&&this.currentWindow.addEventListener("resize",this.computeSizes),this.props.zoomWithScroll&&this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}),this.containerRef.addEventListener("gesturestart",this.onGestureStart)),this.props.disableAutomaticStylesInjection||(this.styleRef=this.currentDoc.createElement("style"),this.styleRef.setAttribute("type","text/css"),this.props.nonce&&this.styleRef.setAttribute("nonce",this.props.nonce),this.styleRef.innerHTML=rK,this.currentDoc.head.appendChild(this.styleRef)),this.imageRef.current&&this.imageRef.current.complete&&this.onMediaLoad(),this.props.setImageRef&&this.props.setImageRef(this.imageRef),this.props.setVideoRef&&this.props.setVideoRef(this.videoRef))},r.prototype.componentWillUnmount=function(){var t,n;!this.currentDoc||!this.currentWindow||(typeof window.ResizeObserver>"u"&&this.currentWindow.removeEventListener("resize",this.computeSizes),(t=this.resizeObserver)===null||t===void 0||t.disconnect(),this.containerRef&&this.containerRef.removeEventListener("gesturestart",this.preventZoomSafari),this.styleRef&&((n=this.styleRef.parentNode)===null||n===void 0||n.removeChild(this.styleRef)),this.cleanEvents(),this.props.zoomWithScroll&&this.clearScrollEvent())},r.prototype.componentDidUpdate=function(t){var n,s,o,i,c,u,l,d,h;t.rotation!==this.props.rotation?(this.computeSizes(),this.recomputeCropPosition()):t.aspect!==this.props.aspect?this.computeSizes():t.zoom!==this.props.zoom?this.recomputeCropPosition():((n=t.cropSize)===null||n===void 0?void 0:n.height)!==((s=this.props.cropSize)===null||s===void 0?void 0:s.height)||((o=t.cropSize)===null||o===void 0?void 0:o.width)!==((i=this.props.cropSize)===null||i===void 0?void 0:i.width)?this.computeSizes():(((c=t.crop)===null||c===void 0?void 0:c.x)!==((u=this.props.crop)===null||u===void 0?void 0:u.x)||((l=t.crop)===null||l===void 0?void 0:l.y)!==((d=this.props.crop)===null||d===void 0?void 0:d.y))&&this.emitCropAreaChange(),t.zoomWithScroll!==this.props.zoomWithScroll&&this.containerRef&&(this.props.zoomWithScroll?this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}):this.clearScrollEvent()),t.video!==this.props.video&&((h=this.videoRef.current)===null||h===void 0||h.load())},r.prototype.getAspect=function(){var t=this.props,n=t.cropSize,s=t.aspect;return n?n.width/n.height:s},r.prototype.onPinchStart=function(t){var n=r.getTouchPoint(t.touches[0]),s=r.getTouchPoint(t.touches[1]);this.lastPinchDistance=NA(n,s),this.lastPinchRotation=TA(n,s),this.onDragStart(LA(n,s))},r.prototype.onPinchMove=function(t){var n=this;if(!(!this.currentDoc||!this.currentWindow)){var s=r.getTouchPoint(t.touches[0]),o=r.getTouchPoint(t.touches[1]),i=LA(s,o);this.onDrag(i),this.rafPinchTimeout&&this.currentWindow.cancelAnimationFrame(this.rafPinchTimeout),this.rafPinchTimeout=this.currentWindow.requestAnimationFrame(function(){var c=NA(s,o),u=n.props.zoom*(c/n.lastPinchDistance);n.setNewZoom(u,i,{shouldUpdatePosition:!1}),n.lastPinchDistance=c;var l=TA(s,o),d=n.props.rotation+(l-n.lastPinchRotation);n.props.onRotationChange&&n.props.onRotationChange(d),n.lastPinchRotation=l})}},r.prototype.render=function(){var t=this,n=this.props,s=n.image,o=n.video,i=n.mediaProps,c=n.transform,u=n.crop,l=u.x,d=u.y,h=n.rotation,f=n.zoom,p=n.cropShape,v=n.showGrid,g=n.style,m=g.containerStyle,b=g.cropAreaStyle,y=g.mediaStyle,S=n.classes,C=S.containerClassName,L=S.cropAreaClassName,O=S.mediaClassName,H=n.objectFit;return vr.createElement("div",{onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,ref:function(q){return t.containerRef=q},"data-testid":"container",style:m,className:Cy("reactEasyCrop_Container",C)},s?vr.createElement("img",Co({alt:"",className:Cy("reactEasyCrop_Image",H==="contain"&&"reactEasyCrop_Contain",H==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",H==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",H==="auto-cover"&&(this.mediaSize.naturalWidth>this.mediaSize.naturalHeight?"reactEasyCrop_Cover_Horizontal":"reactEasyCrop_Cover_Vertical"),O)},i,{src:s,ref:this.imageRef,style:Co(Co({},y),{transform:c||"translate(".concat(l,"px, ").concat(d,"px) rotate(").concat(h,"deg) scale(").concat(f,")")}),onLoad:this.onMediaLoad})):o&&vr.createElement("video",Co({autoPlay:!0,loop:!0,muted:!0,className:Cy("reactEasyCrop_Video",H==="contain"&&"reactEasyCrop_Contain",H==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",H==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",H==="auto-cover"&&(this.mediaSize.naturalWidth>this.mediaSize.naturalHeight?"reactEasyCrop_Cover_Horizontal":"reactEasyCrop_Cover_Vertical"),O)},i,{ref:this.videoRef,onLoadedMetadata:this.onMediaLoad,style:Co(Co({},y),{transform:c||"translate(".concat(l,"px, ").concat(d,"px) rotate(").concat(h,"deg) scale(").concat(f,")")}),controls:!1}),(Array.isArray(o)?o:[{src:o}]).map(function(z){return vr.createElement("source",Co({key:z.src},z))})),this.state.cropSize&&vr.createElement("div",{style:Co(Co({},b),{width:this.state.cropSize.width,height:this.state.cropSize.height}),"data-testid":"cropper",className:Cy("reactEasyCrop_CropArea",p==="round"&&"reactEasyCrop_CropAreaRound",v&&"reactEasyCrop_CropAreaGrid",L)}))},r.defaultProps={zoom:1,rotation:0,aspect:4/3,maxZoom:aK,minZoom:nK,cropShape:"rect",objectFit:"contain",showGrid:!0,style:{},classes:{},mediaProps:{},zoomSpeed:1,restrictPosition:!0,zoomWithScroll:!0},r.getMousePoint=function(t){return{x:Number(t.clientX),y:Number(t.clientY)}},r.getTouchPoint=function(t){return{x:Number(t.clientX),y:Number(t.clientY)}},r}(vr.Component);function sK({open:e,onClose:r,onSave:t,initialData:n=null,sizes:s=[]}){const{register:o,handleSubmit:i,reset:c,setValue:u,formState:{errors:l}}=Gl({mode:"onSubmit",defaultValues:{sku:"",barcode:"",purchaseCost:"",stdSalesPrice:"",stock:"",leadTime:"",isActive:!0}}),[d,h]=G.useState([]),[f,p]=G.useState([]),[v,g]=G.useState([]),[m,b]=G.useState(!1),[y,S]=G.useState(null),[C,L]=G.useState(null),[O,H]=G.useState(""),[z,q]=G.useState(!1),D=G.useRef(null),[W,P]=G.useState(""),[I,U]=G.useState(!1),[k,_]=G.useState(null),[R,j]=G.useState(null),[A,N]=G.useState({x:0,y:0}),[V,M]=G.useState(1),[Z,J]=G.useState(null),[re,X]=G.useState(null),[ne,Y]=G.useState(""),[K,ee]=G.useState(!1);G.useEffect(()=>{if(!e)return;(async()=>{var pe;b(!0),S(null);try{if(Array.isArray(s)&&s.length>0)g(s);else{const ye=await ut.get(`${Je}/api/sizes`,{params:{page:1,limit:500,filter:""}});g(((pe=ye.data)==null?void 0:pe.data)||[])}}catch{S("Failed to load sizes"),g([])}finally{b(!1)}})()},[e,s]),G.useEffect(()=>{if(n){const Te={...n};c(Te);const pe=(n.images||[]).map(De=>{if(typeof De=="string"){const He=De.replace(/\\/g,"/");return{file:null,preview:He.startsWith("http://")||He.startsWith("https://")?He:`${Je}/${He.startsWith("uploads/")?He:`uploads/${He}`}`,original:De,name:He.split("/").pop()}}return{file:De,preview:URL.createObjectURL(De),original:null,name:De.name}});p(pe),h(pe.map(De=>De.preview));const ye=ke.find(De=>De.value===n.color);L(ye||null),H(ye?ye.name:""),P(n.size||"");let ge=null;if(n.mainImage){const De=pe.findIndex(He=>He.original&&He.original===n.mainImage||He.name===n.mainImage);De>=0&&(ge=De)}ge===null&&pe.length>0&&(ge=0),X(ge)}else c(),h([]),L(null),H(""),P(""),X(null)},[n,e,c]),G.useEffect(()=>{H(C?C.name:"")},[C]),G.useEffect(()=>{const Te=pe=>{z&&D.current&&!D.current.contains(pe.target)&&q(!1)};return document.addEventListener("mousedown",Te),()=>document.removeEventListener("mousedown",Te)},[z]);const ue=Te=>{const pe=f.map(at=>at.file?at.file:at.original),ye=f.filter(at=>at.file).map(at=>at.file),ge=at=>{if(at==null)return null;if(typeof at=="number")return at;const dt=String(at).trim();return dt===""?null:Number(dt)},De=()=>`SKU-${Date.now().toString(36).toUpperCase()}-${Math.random().toString(36).slice(2,8).toUpperCase()}`,Xe={sku:Te.sku&&String(Te.sku).trim()!==""?Te.sku:De(),barcode:Te.barcode||"",purchaseCost:ge(Te.purchaseCost),stdSalesPrice:ge(Te.stdSalesPrice),stock:ge(Te.stock),leadTime:ge(Te.leadTime),size:W||"",color:(C==null?void 0:C.value)||"",images:pe,files:ye,mainImage:re!=null?pe[re]:null,mainImageIndex:re,isActive:!!Te.isActive};try{t(Xe),f.forEach(at=>{try{at.preview&&at.file&&URL.revokeObjectURL(at.preview)}catch{}}),c(),p([]),h([]),L(null),P("")}catch(at){console.error("Error saving variant:",at),Y("Failed to save variant. Please try again."),ee(!0)}},se=Te=>{const ye=Array.from(Te.target.files||[]).map(ge=>({file:ge,preview:URL.createObjectURL(ge),original:null,name:ge.name}));p(ge=>{const De=[...ge,...ye];return re==null&&De.length>0&&X(0),De}),h(ge=>[...ge,...ye.map(De=>De.preview)])},ce=Te=>{const pe=f[Te];!pe||!(pe.preview&&(pe.file?pe.file.type&&pe.file.type.startsWith("image/"):/\.(jpg|jpeg|png|gif|webp)$/i.test(pe.preview)||pe.preview.startsWith("data:")))||(j(Te),_(pe.preview),U(!0))},fe=G.useCallback((Te,pe)=>{J(pe)},[]),ve=async(Te,pe)=>{try{const ge=await(await fetch(Te)).blob(),De=await createImageBitmap(ge),He=document.createElement("canvas");return He.width=Math.max(1,Math.round(pe.width)),He.height=Math.max(1,Math.round(pe.height)),He.getContext("2d").drawImage(De,Math.round(pe.x),Math.round(pe.y),Math.round(pe.width),Math.round(pe.height),0,0,He.width,He.height),await new Promise(at=>{He.toBlob(dt=>{if(!dt)return at(null);const wt=new File([dt],`cropped_${Date.now()}.png`,{type:dt.type});at(wt)},"image/png")})}catch(ye){return console.error("getCroppedImg error",ye),null}},_e=async()=>{if(R==null||!Z)return;const Te=f[R].preview,pe=await ve(Te,Z);if(pe){const ye={file:pe,preview:URL.createObjectURL(pe)};p(ge=>ge.map((De,He)=>He===R?ye:De)),h(ge=>ge.map((De,He)=>He===R?ye.preview:De))}U(!1),j(null),_(null),M(1)},le=Te=>{const pe=f[Te];if(pe&&pe.file&&pe.preview)try{URL.revokeObjectURL(pe.preview)}catch{}p(ye=>{const ge=ye.filter((De,He)=>He!==Te);return X(De=>De==null?null:Te===De?ge.length>0?0:null:Te<De?De-1:De),ge}),h(ye=>ye.filter((ge,De)=>De!==Te))},ke=[{name:"RAL 1000 - Green beige",value:"RAL 1000",hex:"#CDBA88"},{name:"RAL 1001 - Beige",value:"RAL 1001",hex:"#D0B084"},{name:"RAL 1002 - Sand yellow",value:"RAL 1002",hex:"#D2AA6D"},{name:"RAL 1003 - Signal yellow",value:"RAL 1003",hex:"#F9A900"},{name:"RAL 1004 - Golden yellow",value:"RAL 1004",hex:"#E49E00"},{name:"RAL 1005 - Honey yellow",value:"RAL 1005",hex:"#CB8F00"},{name:"RAL 1006 - Maize yellow",value:"RAL 1006",hex:"#E19000"},{name:"RAL 1007 - Daffodil yellow",value:"RAL 1007",hex:"#E88C00"},{name:"RAL 1011 - Brown beige",value:"RAL 1011",hex:"#AF8050"},{name:"RAL 1012 - Lemon yellow",value:"RAL 1012",hex:"#DDAF28"},{name:"RAL 1013 - Oyster white",value:"RAL 1013",hex:"#E3D9C7"},{name:"RAL 1014 - Ivory",value:"RAL 1014",hex:"#DDC49B"},{name:"RAL 1015 - Light ivory",value:"RAL 1015",hex:"#E6D2B5"},{name:"RAL 1016 - Sulfur yellow",value:"RAL 1016",hex:"#F1DD39"},{name:"RAL 1017 - Saffron yellow",value:"RAL 1017",hex:"#F6A951"},{name:"RAL 1018 - Zinc yellow",value:"RAL 1018",hex:"#FACA31"},{name:"RAL 1019 - Grey beige",value:"RAL 1019",hex:"#A48F7A"},{name:"RAL 1020 - Olive yellow",value:"RAL 1020",hex:"#A08F65"},{name:"RAL 1021 - Colza yellow",value:"RAL 1021",hex:"#F6B600"},{name:"RAL 1023 - Traffic yellow",value:"RAL 1023",hex:"#F7B500"},{name:"RAL 1024 - Ochre yellow",value:"RAL 1024",hex:"#BA8F4C"},{name:"RAL 1026 - Luminous yellow",value:"RAL 1026",hex:"#FFFF00"},{name:"RAL 1027 - Curry",value:"RAL 1027",hex:"#A77F0F"},{name:"RAL 1028 - Melon yellow",value:"RAL 1028",hex:"#FF9C00"},{name:"RAL 1032 - Broom yellow",value:"RAL 1032",hex:"#E2A300"},{name:"RAL 1033 - Dahlia yellow",value:"RAL 1033",hex:"#F99A1D"},{name:"RAL 1034 - Pastel yellow",value:"RAL 1034",hex:"#EB9C52"},{name:"RAL 1035 - Pearl beige",value:"RAL 1035",hex:"#8F8370"},{name:"RAL 1036 - Pearl gold",value:"RAL 1036",hex:"#806440"},{name:"RAL 1037 - Sun yellow",value:"RAL 1037",hex:"#F09200"},{name:"RAL 2000 - Yellow orange",value:"RAL 2000",hex:"#DA6E00"},{name:"RAL 2001 - Red orange",value:"RAL 2001",hex:"#BA481C"},{name:"RAL 2002 - Vermilion",value:"RAL 2002",hex:"#BF3922"},{name:"RAL 2003 - Pastel orange",value:"RAL 2003",hex:"#F67829"},{name:"RAL 2004 - Pure orange",value:"RAL 2004",hex:"#E25304"},{name:"RAL 2005 - Luminous orange",value:"RAL 2005",hex:"#FF4D08"},{name:"RAL 2007 - Luminous bright orange",value:"RAL 2007",hex:"#FFB200"},{name:"RAL 2008 - Bright red orange",value:"RAL 2008",hex:"#EC6B22"},{name:"RAL 2009 - Traffic orange",value:"RAL 2009",hex:"#DE5308"},{name:"RAL 2010 - Signal orange",value:"RAL 2010",hex:"#D05D29"},{name:"RAL 2011 - Deep orange",value:"RAL 2011",hex:"#E26E0F"},{name:"RAL 2012 - Salmon orange",value:"RAL 2012",hex:"#D5654E"},{name:"RAL 2013 - Pearl orange",value:"RAL 2013",hex:"#923E25"},{name:"RAL 2017 - RAL orange",value:"RAL 2017",hex:"#FC5500"},{name:"RAL 3000 - Flame red",value:"RAL 3000",hex:"#A72920"},{name:"RAL 3001 - Signal red",value:"RAL 3001",hex:"#9B2423"},{name:"RAL 3002 - Carmine red",value:"RAL 3002",hex:"#9B2321"},{name:"RAL 3003 - Ruby red",value:"RAL 3003",hex:"#861A22"},{name:"RAL 3004 - Purple red",value:"RAL 3004",hex:"#6B1C23"},{name:"RAL 3005 - Wine red",value:"RAL 3005",hex:"#59191F"},{name:"RAL 3007 - Black red",value:"RAL 3007",hex:"#3E2022"},{name:"RAL 3009 - Oxide red",value:"RAL 3009",hex:"#6D342D"},{name:"RAL 3011 - Brown red",value:"RAL 3011",hex:"#782423"},{name:"RAL 3012 - Beige red",value:"RAL 3012",hex:"#C5856D"},{name:"RAL 3013 - Tomato red",value:"RAL 3013",hex:"#972E25"},{name:"RAL 3014 - Antique pink",value:"RAL 3014",hex:"#CB7375"},{name:"RAL 3015 - Light pink",value:"RAL 3015",hex:"#D8A0A6"},{name:"RAL 3016 - Coral red",value:"RAL 3016",hex:"#A63D30"},{name:"RAL 3017 - Rose",value:"RAL 3017",hex:"#CA555D"},{name:"RAL 3018 - Strawberry red",value:"RAL 3018",hex:"#C63F4A"},{name:"RAL 3020 - Traffic red",value:"RAL 3020",hex:"#BB1F11"},{name:"RAL 3022 - Salmon pink",value:"RAL 3022",hex:"#CF6955"},{name:"RAL 3024 - Luminous red",value:"RAL 3024",hex:"#FF2D21"},{name:"RAL 3026 - Luminous bright red",value:"RAL 3026",hex:"#FF2A1C"},{name:"RAL 3027 - Raspberry red",value:"RAL 3027",hex:"#AB273C"},{name:"RAL 3028 - Pure red",value:"RAL 3028",hex:"#CC2C24"},{name:"RAL 3031 - Orient red",value:"RAL 3031",hex:"#A63437"},{name:"RAL 3032 - Pearl ruby red",value:"RAL 3032",hex:"#701D24"},{name:"RAL 3033 - Pearl pink",value:"RAL 3033",hex:"#A53A2E"},{name:"RAL 4001 - Red lilac",value:"RAL 4001",hex:"#816183"},{name:"RAL 4002 - Red violet",value:"RAL 4002",hex:"#8D3C4B"},{name:"RAL 4003 - Heather violet",value:"RAL 4003",hex:"#C4618C"},{name:"RAL 4004 - Claret violet",value:"RAL 4004",hex:"#651E38"},{name:"RAL 4005 - Blue lilac",value:"RAL 4005",hex:"#76689A"},{name:"RAL 4006 - Traffic purple",value:"RAL 4006",hex:"#903373"},{name:"RAL 4007 - Purple violet",value:"RAL 4007",hex:"#47243C"},{name:"RAL 4008 - Signal violet",value:"RAL 4008",hex:"#844C82"},{name:"RAL 4009 - Pastel violet",value:"RAL 4009",hex:"#9D8692"},{name:"RAL 4010 - Telemagenta",value:"RAL 4010",hex:"#BB4077"},{name:"RAL 4011 - Pearl violet",value:"RAL 4011",hex:"#6E6387"},{name:"RAL 4012 - Pearl blackberry",value:"RAL 4012",hex:"#6A6B7F"},{name:"RAL 5000 - Violet blue",value:"RAL 5000",hex:"#304F6E"},{name:"RAL 5001 - Green blue",value:"RAL 5001",hex:"#0E4C64"},{name:"RAL 5002 - Ultramarine blue",value:"RAL 5002",hex:"#00387A"},{name:"RAL 5003 - Sapphire blue",value:"RAL 5003",hex:"#1F3855"},{name:"RAL 5004 - Black blue",value:"RAL 5004",hex:"#191E28"},{name:"RAL 5005 - Signal blue",value:"RAL 5005",hex:"#005387"},{name:"RAL 5007 - Brillant blue",value:"RAL 5007",hex:"#376B8C"},{name:"RAL 5008 - Grey blue",value:"RAL 5008",hex:"#2B3A44"},{name:"RAL 5009 - Azure blue",value:"RAL 5009",hex:"#215F78"},{name:"RAL 5010 - Gentian blue",value:"RAL 5010",hex:"#004F7C"},{name:"RAL 5011 - Steel blue",value:"RAL 5011",hex:"#1A2B3C"},{name:"RAL 5012 - Light blue",value:"RAL 5012",hex:"#0089B6"},{name:"RAL 5013 - Cobalt blue",value:"RAL 5013",hex:"#193153"},{name:"RAL 5014 - Pigeon blue",value:"RAL 5014",hex:"#637D96"},{name:"RAL 5015 - Sky blue",value:"RAL 5015",hex:"#007CAF"},{name:"RAL 5017 - Traffic blue",value:"RAL 5017",hex:"#005B8C"},{name:"RAL 5018 - Turquoise blue",value:"RAL 5018",hex:"#048B8C"},{name:"RAL 5019 - Capri blue",value:"RAL 5019",hex:"#005E83"},{name:"RAL 5020 - Ocean blue",value:"RAL 5020",hex:"#00414B"},{name:"RAL 5021 - Water blue",value:"RAL 5021",hex:"#007577"},{name:"RAL 5022 - Night blue",value:"RAL 5022",hex:"#222D5A"},{name:"RAL 5023 - Distant blue",value:"RAL 5023",hex:"#41698C"},{name:"RAL 5024 - Pastel blue",value:"RAL 5024",hex:"#6093AC"},{name:"RAL 5025 - Pearl gentian blue",value:"RAL 5025",hex:"#20697C"},{name:"RAL 5026 - Pearl night blue",value:"RAL 5026",hex:"#0F3052"},{name:"RAL 6000 - Patina green",value:"RAL 6000",hex:"#3C7460"},{name:"RAL 6001 - Emerald green",value:"RAL 6001",hex:"#366735"},{name:"RAL 6002 - Leaf green",value:"RAL 6002",hex:"#325928"},{name:"RAL 6003 - Olive green",value:"RAL 6003",hex:"#50533C"},{name:"RAL 6004 - Blue green",value:"RAL 6004",hex:"#024442"},{name:"RAL 6005 - Moss green",value:"RAL 6005",hex:"#114232"},{name:"RAL 6006 - Grey olive",value:"RAL 6006",hex:"#3C392E"},{name:"RAL 6007 - Bottle green",value:"RAL 6007",hex:"#2C3222"},{name:"RAL 6008 - Brown green",value:"RAL 6008",hex:"#36342A"},{name:"RAL 6009 - Fir green",value:"RAL 6009",hex:"#27352A"},{name:"RAL 6010 - Grass green",value:"RAL 6010",hex:"#4D6F39"},{name:"RAL 6011 - Reseda green",value:"RAL 6011",hex:"#6B7C59"},{name:"RAL 6012 - Black green",value:"RAL 6012",hex:"#2F3D3A"},{name:"RAL 6013 - Reed green",value:"RAL 6013",hex:"#7C765A"},{name:"RAL 6014 - Yellow olive",value:"RAL 6014",hex:"#474135"},{name:"RAL 6015 - Black olive",value:"RAL 6015",hex:"#3D3D36"},{name:"RAL 6016 - Turquoise green",value:"RAL 6016",hex:"#00694C"},{name:"RAL 6017 - May green",value:"RAL 6017",hex:"#587F40"},{name:"RAL 6018 - Yellow green",value:"RAL 6018",hex:"#60993B"},{name:"RAL 6019 - Pastel green",value:"RAL 6019",hex:"#B9CEAC"},{name:"RAL 6020 - Chrome green",value:"RAL 6020",hex:"#37422F"},{name:"RAL 6021 - Pale green",value:"RAL 6021",hex:"#8A9977"},{name:"RAL 6022 - Olive drab",value:"RAL 6022",hex:"#3A3327"},{name:"RAL 6024 - Traffic green",value:"RAL 6024",hex:"#008351"},{name:"RAL 6025 - Fern green",value:"RAL 6025",hex:"#5E6E3B"},{name:"RAL 6026 - Opal green",value:"RAL 6026",hex:"#005F4E"},{name:"RAL 6027 - Light green",value:"RAL 6027",hex:"#7EBAB5"},{name:"RAL 6028 - Pine green",value:"RAL 6028",hex:"#315442"},{name:"RAL 6029 - Mint green",value:"RAL 6029",hex:"#006F3D"},{name:"RAL 6032 - Signal green",value:"RAL 6032",hex:"#237F52"},{name:"RAL 6033 - Mint turquoise",value:"RAL 6033",hex:"#45877F"},{name:"RAL 6034 - Pastel turquoise",value:"RAL 6034",hex:"#7AADAC"},{name:"RAL 6035 - Pearl green",value:"RAL 6035",hex:"#194D25"},{name:"RAL 6036 - Pearl opal green",value:"RAL 6036",hex:"#04574B"},{name:"RAL 6037 - Pure green",value:"RAL 6037",hex:"#008B29"},{name:"RAL 6038 - Luminous green",value:"RAL 6038",hex:"#00B51B"},{name:"RAL 6039 - Fibrous green",value:"RAL 6039",hex:"#B3C43E"},{name:"RAL 7000 - Squirrel grey",value:"RAL 7000",hex:"#7A888E"},{name:"RAL 7001 - Silver grey",value:"RAL 7001",hex:"#8C979C"},{name:"RAL 7002 - Olive grey",value:"RAL 7002",hex:"#817863"},{name:"RAL 7003 - Moss grey",value:"RAL 7003",hex:"#797669"},{name:"RAL 7004 - Signal grey",value:"RAL 7004",hex:"#9A9B9B"},{name:"RAL 7005 - Mouse grey",value:"RAL 7005",hex:"#6B6E6B"},{name:"RAL 7006 - Beige grey",value:"RAL 7006",hex:"#766A5E"},{name:"RAL 7008 - Khaki grey",value:"RAL 7008",hex:"#745F3D"},{name:"RAL 7009 - Green grey",value:"RAL 7009",hex:"#5D6058"},{name:"RAL 7010 - Tarpaulin grey",value:"RAL 7010",hex:"#585C56"},{name:"RAL 7011 - Iron grey",value:"RAL 7011",hex:"#52595D"},{name:"RAL 7012 - Basalt grey",value:"RAL 7012",hex:"#575D5E"},{name:"RAL 7013 - Brown grey",value:"RAL 7013",hex:"#575044"},{name:"RAL 7015 - Slate grey",value:"RAL 7015",hex:"#4F5358"},{name:"RAL 7016 - Anthracite grey",value:"RAL 7016",hex:"#383E42"},{name:"RAL 7021 - Black grey",value:"RAL 7021",hex:"#2F3234"},{name:"RAL 7022 - Umbra grey",value:"RAL 7022",hex:"#4C4A44"},{name:"RAL 7023 - Concrete grey",value:"RAL 7023",hex:"#808076"},{name:"RAL 7024 - Graphite grey",value:"RAL 7024",hex:"#45494E"},{name:"RAL 7026 - Granite grey",value:"RAL 7026",hex:"#374345"},{name:"RAL 7030 - Stone grey",value:"RAL 7030",hex:"#928E85"},{name:"RAL 7031 - Blue grey",value:"RAL 7031",hex:"#5B686D"},{name:"RAL 7032 - Pebble grey",value:"RAL 7032",hex:"#B5B0A1"},{name:"RAL 7033 - Cement grey",value:"RAL 7033",hex:"#7F8274"},{name:"RAL 7034 - Yellow grey",value:"RAL 7034",hex:"#92886F"},{name:"RAL 7035 - Light grey",value:"RAL 7035",hex:"#C5C7C4"},{name:"RAL 7036 - Platinum grey",value:"RAL 7036",hex:"#979392"},{name:"RAL 7037 - Dusty grey",value:"RAL 7037",hex:"#7A7B7A"},{name:"RAL 7038 - Agate grey",value:"RAL 7038",hex:"#B0B0A9"},{name:"RAL 7039 - Quartz grey",value:"RAL 7039",hex:"#6B665E"},{name:"RAL 7040 - Window grey",value:"RAL 7040",hex:"#989EA1"},{name:"RAL 7042 - Traffic grey A",value:"RAL 7042",hex:"#8E9291"},{name:"RAL 7043 - Traffic grey B",value:"RAL 7043",hex:"#4F5250"},{name:"RAL 7044 - Silk grey",value:"RAL 7044",hex:"#B7B3A8"},{name:"RAL 7045 - Telegrey 1",value:"RAL 7045",hex:"#8D9295"},{name:"RAL 7046 - Telegrey 2",value:"RAL 7046",hex:"#7E868A"},{name:"RAL 7047 - Telegrey 4",value:"RAL 7047",hex:"#C8C8C7"},{name:"RAL 7048 - Pearl mouse grey",value:"RAL 7048",hex:"#817B73"},{name:"RAL 8000 - Green brown",value:"RAL 8000",hex:"#89693F"},{name:"RAL 8001 - Ochre brown",value:"RAL 8001",hex:"#9D622B"},{name:"RAL 8002 - Signal brown",value:"RAL 8002",hex:"#794D3E"},{name:"RAL 8003 - Clay brown",value:"RAL 8003",hex:"#7E4B27"},{name:"RAL 8004 - Copper brown",value:"RAL 8004",hex:"#8D4931"},{name:"RAL 8007 - Fawn brown",value:"RAL 8007",hex:"#70462B"},{name:"RAL 8008 - Olive brown",value:"RAL 8008",hex:"#724A25"},{name:"RAL 8011 - Nut brown",value:"RAL 8011",hex:"#5A3827"},{name:"RAL 8012 - Red brown",value:"RAL 8012",hex:"#66332B"},{name:"RAL 8014 - Sepia brown",value:"RAL 8014",hex:"#4A3526"},{name:"RAL 8015 - Chestnut brown",value:"RAL 8015",hex:"#5E2F26"},{name:"RAL 8016 - Mahogany brown",value:"RAL 8016",hex:"#4C2B20"},{name:"RAL 8017 - Chocolate brown",value:"RAL 8017",hex:"#442F29"},{name:"RAL 8019 - Grey brown",value:"RAL 8019",hex:"#3D3635"},{name:"RAL 8022 - Black brown",value:"RAL 8022",hex:"#1A1719"},{name:"RAL 8023 - Orange brown",value:"RAL 8023",hex:"#A45729"},{name:"RAL 8024 - Beige brown",value:"RAL 8024",hex:"#795038"},{name:"RAL 8025 - Pale brown",value:"RAL 8025",hex:"#755847"},{name:"RAL 8028 - Terra brown",value:"RAL 8028",hex:"#513A2A"},{name:"RAL 8029 - Pearl copper",value:"RAL 8029",hex:"#7F4031"},{name:"RAL 9001 - Cream",value:"RAL 9001",hex:"#E9E0D2"},{name:"RAL 9002 - Grey white",value:"RAL 9002",hex:"#D6D5CB"},{name:"RAL 9003 - Signal white",value:"RAL 9003",hex:"#ECECE7"},{name:"RAL 9004 - Signal black",value:"RAL 9004",hex:"#2B2B2C"},{name:"RAL 9005 - Jet black",value:"RAL 9005",hex:"#0E0E10"},{name:"RAL 9006 - White aluminium",value:"RAL 9006",hex:"#A1A1A0"},{name:"RAL 9007 - Grey aluminium",value:"RAL 9007",hex:"#868581"},{name:"RAL 9010 - Pure white",value:"RAL 9010",hex:"#F1EDE1"},{name:"RAL 9011 - Graphite black",value:"RAL 9011",hex:"#27292B"},{name:"RAL 9012 - Cleanroom white",value:"RAL 9012",hex:"#F8F2E1"},{name:"RAL 9016 - Traffic white",value:"RAL 9016",hex:"#F1F1EA"},{name:"RAL 9017 - Traffic black",value:"RAL 9017",hex:"#29292A"},{name:"RAL 9018 - Papyrus white",value:"RAL 9018",hex:"#C8CBC4"},{name:"RAL 9022 - Pearl light grey",value:"RAL 9022",hex:"#858583"},{name:"RAL 9023 - Pearl dark grey",value:"RAL 9023",hex:"#787B7A"}];return a.jsx("div",{className:"variant-form-dialog",children:e&&a.jsx("div",{className:"crop-dialog-overlay",onClick:r,children:a.jsxs("div",{className:"dialog-wrapper",onClick:Te=>Te.stopPropagation(),children:[a.jsx("div",{className:"dialog-header",children:a.jsx("h2",{children:n?"Edit Variant":"Add Variant"})}),ne&&a.jsx("div",{className:"error-message show",children:ne}),a.jsxs("form",{onSubmit:i(ue),children:[a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"Color"}),a.jsxs("div",{ref:D,className:"color-picker-wrapper",children:[a.jsxs("div",{className:"color-input-wrapper",children:[a.jsx("input",{type:"text",className:"color-search-input",placeholder:"Search color...",value:O,onChange:Te=>{H(Te.target.value),q(!0)},onClick:()=>q(Te=>!Te)}),a.jsx("div",{className:"color-selected-preview",children:C?a.jsx("div",{className:"color-preview",style:{backgroundColor:C.hex}}):null})]}),z&&a.jsxs("div",{className:"color-dropdown",children:[a.jsx("div",{className:"color-option clear-option",onClick:()=>{L(null),H(""),q(!1)},children:a.jsx("div",{className:"color-name",children:"Clear selection"})},"__clear__"),ke.filter(Te=>(Te.name+" "+Te.value).toLowerCase().includes((O||"").toLowerCase())).map(Te=>a.jsxs("div",{className:`color-option ${(C==null?void 0:C.value)===Te.value?"selected":""}`,onClick:()=>{L(Te),H(Te.name),q(!1)},children:[a.jsx("div",{className:"color-box",style:{backgroundColor:Te.hex}}),a.jsx("div",{className:"color-name",children:Te.name})]},Te.value))]})]})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"Size"}),a.jsxs("select",{value:W,onChange:Te=>P(Te.target.value),children:[a.jsx("option",{value:"",children:m?"Loading sizes...":"None (Clear selection)"}),!m&&v.map(Te=>a.jsx("option",{value:Te.code,children:Te.code},Te.id))]}),y&&a.jsx("div",{className:"size-error",children:y})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"SKU"}),a.jsx("input",{type:"text",...o("sku",{required:!1})})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"Barcode"}),a.jsx("input",{type:"text",...o("barcode")})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"Purchase Cost"}),a.jsx("input",{type:"number",...o("purchaseCost")})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"Sales Price"}),a.jsx("input",{type:"number",...o("stdSalesPrice")})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"Stock"}),a.jsx("input",{type:"number",...o("stock")})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"Lead Time (days)"}),a.jsx("input",{type:"number",...o("leadTime")})]}),a.jsxs("div",{className:"form-field full-width image-upload-section",children:[a.jsx("div",{className:"upload-button-wrapper",children:a.jsxs("label",{className:"upload-button",children:["Upload Files",a.jsx("input",{type:"file",multiple:!0,onChange:se})]})}),a.jsx("div",{className:"images-preview",children:f.map((Te,pe)=>{const ye=Te.preview&&(Te.file?Te.file.type&&Te.file.type.startsWith("image/"):/\.(jpg|jpeg|png|gif|webp)$/i.test(Te.preview));return a.jsxs("div",{className:"image-item",children:[ye?a.jsx("img",{src:Te.preview,alt:Te.name||"file",className:"image-preview"}):a.jsx("div",{className:"file-preview",children:Te.name||"file"}),ye&&a.jsx("button",{type:"button",className:`main-image-badge ${pe===re?"active":"inactive"}`,onClick:()=>X(pe),title:pe===re?"Main image":"Set as main image",children:""}),a.jsxs("div",{className:"image-actions",children:[ye&&Te.file&&a.jsx("button",{type:"button",className:"image-action-btn edit-btn",onClick:()=>ce(pe),children:"Edit"}),a.jsx("button",{type:"button",className:"image-action-btn remove-btn",onClick:()=>le(pe),children:"Remove"})]}),a.jsx("div",{className:"image-name",children:Te.name||Te.file&&Te.file.name})]},pe)})})]}),I&&a.jsx("div",{className:"crop-dialog-overlay",onClick:()=>U(!1),children:a.jsxs("div",{className:"crop-dialog",onClick:Te=>Te.stopPropagation(),children:[a.jsxs("div",{className:"crop-header",children:[a.jsx("div",{className:"crop-title",children:"Edit Image"}),a.jsx("button",{type:"button",className:"close-btn",onClick:()=>U(!1),"aria-label":"close",children:""})]}),a.jsx("div",{className:"crop-content",children:k&&a.jsx("div",{style:{position:"relative",width:"100%",height:"60vh",maxHeight:600},children:a.jsx(Lw,{image:k,crop:A,zoom:V,aspect:1,minZoom:.1,maxZoom:3,onCropChange:N,onZoomChange:M,onCropComplete:fe})})}),a.jsxs("div",{className:"crop-actions",children:[a.jsxs("div",{className:"zoom-slider",children:[a.jsx("label",{children:"Zoom"}),a.jsx("input",{type:"range",min:"0.1",max:"3",step:"0.1",value:V,onChange:Te=>M(parseFloat(Te.target.value))})]}),a.jsxs("div",{className:"button-group",children:[a.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>U(!1),children:"Cancel"}),a.jsx("button",{type:"button",className:"apply-btn",onClick:_e,children:"Apply"})]})]})]})}),a.jsx("div",{className:"form-field col-33",children:a.jsxs("div",{className:"checkbox-wrapper",children:[a.jsx("input",{type:"checkbox",id:"isActive",...o("isActive"),defaultChecked:!0}),a.jsx("label",{htmlFor:"isActive",children:"Is Active"})]})})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{type:"button",className:"btn-secondary",onClick:r,children:"Cancel"}),a.jsx("button",{type:"submit",className:"btn-primary",children:n?"Update Variant":"Add Variant"})]})]})]})})})}function iK({variants:e,setVariants:r,onBack:t,onNext:n,editIndex:s,setEditIndex:o,sizes:i=[]}){const[c,u]=G.useState(!1),[l,d]=G.useState(null),h=[{name:"RAL 1000 - Green beige",value:"RAL 1000",hex:"#CDBA88"},{name:"RAL 1001 - Beige",value:"RAL 1001",hex:"#D0B084"},{name:"RAL 1002 - Sand yellow",value:"RAL 1002",hex:"#D2AA6D"},{name:"RAL 1003 - Signal yellow",value:"RAL 1003",hex:"#F9A900"},{name:"RAL 1004 - Golden yellow",value:"RAL 1004",hex:"#E49E00"},{name:"RAL 1005 - Honey yellow",value:"RAL 1005",hex:"#CB8F00"},{name:"RAL 1006 - Maize yellow",value:"RAL 1006",hex:"#E19000"},{name:"RAL 1007 - Daffodil yellow",value:"RAL 1007",hex:"#E88C00"},{name:"RAL 1011 - Brown beige",value:"RAL 1011",hex:"#AF8050"},{name:"RAL 1012 - Lemon yellow",value:"RAL 1012",hex:"#DDAF28"},{name:"RAL 1013 - Oyster white",value:"RAL 1013",hex:"#E3D9C7"},{name:"RAL 1014 - Ivory",value:"RAL 1014",hex:"#DDC49B"},{name:"RAL 1015 - Light ivory",value:"RAL 1015",hex:"#E6D2B5"},{name:"RAL 1016 - Sulfur yellow",value:"RAL 1016",hex:"#F1DD39"},{name:"RAL 1017 - Saffron yellow",value:"RAL 1017",hex:"#F6A951"},{name:"RAL 1018 - Zinc yellow",value:"RAL 1018",hex:"#FACA31"},{name:"RAL 1019 - Grey beige",value:"RAL 1019",hex:"#A48F7A"},{name:"RAL 1020 - Olive yellow",value:"RAL 1020",hex:"#A08F65"},{name:"RAL 1021 - Colza yellow",value:"RAL 1021",hex:"#F6B600"},{name:"RAL 1023 - Traffic yellow",value:"RAL 1023",hex:"#F7B500"},{name:"RAL 1024 - Ochre yellow",value:"RAL 1024",hex:"#BA8F4C"},{name:"RAL 1026 - Luminous yellow",value:"RAL 1026",hex:"#FFFF00"},{name:"RAL 1027 - Curry",value:"RAL 1027",hex:"#A77F0F"},{name:"RAL 1028 - Melon yellow",value:"RAL 1028",hex:"#FF9C00"},{name:"RAL 1032 - Broom yellow",value:"RAL 1032",hex:"#E2A300"},{name:"RAL 1033 - Dahlia yellow",value:"RAL 1033",hex:"#F99A1D"},{name:"RAL 1034 - Pastel yellow",value:"RAL 1034",hex:"#EB9C52"},{name:"RAL 1035 - Pearl beige",value:"RAL 1035",hex:"#8F8370"},{name:"RAL 1036 - Pearl gold",value:"RAL 1036",hex:"#806440"},{name:"RAL 1037 - Sun yellow",value:"RAL 1037",hex:"#F09200"},{name:"RAL 2000 - Yellow orange",value:"RAL 2000",hex:"#DA6E00"},{name:"RAL 2001 - Red orange",value:"RAL 2001",hex:"#BA481C"},{name:"RAL 2002 - Vermilion",value:"RAL 2002",hex:"#BF3922"},{name:"RAL 2003 - Pastel orange",value:"RAL 2003",hex:"#F67829"},{name:"RAL 2004 - Pure orange",value:"RAL 2004",hex:"#E25304"},{name:"RAL 2005 - Luminous orange",value:"RAL 2005",hex:"#FF4D08"},{name:"RAL 2007 - Luminous bright orange",value:"RAL 2007",hex:"#FFB200"},{name:"RAL 2008 - Bright red orange",value:"RAL 2008",hex:"#EC6B22"},{name:"RAL 2009 - Traffic orange",value:"RAL 2009",hex:"#DE5308"},{name:"RAL 2010 - Signal orange",value:"RAL 2010",hex:"#D05D29"},{name:"RAL 2011 - Deep orange",value:"RAL 2011",hex:"#E26E0F"},{name:"RAL 2012 - Salmon orange",value:"RAL 2012",hex:"#D5654E"},{name:"RAL 2013 - Pearl orange",value:"RAL 2013",hex:"#923E25"},{name:"RAL 2017 - RAL orange",value:"RAL 2017",hex:"#FC5500"},{name:"RAL 3000 - Flame red",value:"RAL 3000",hex:"#A72920"},{name:"RAL 3001 - Signal red",value:"RAL 3001",hex:"#9B2423"},{name:"RAL 3002 - Carmine red",value:"RAL 3002",hex:"#9B2321"},{name:"RAL 3003 - Ruby red",value:"RAL 3003",hex:"#861A22"},{name:"RAL 3004 - Purple red",value:"RAL 3004",hex:"#6B1C23"},{name:"RAL 3005 - Wine red",value:"RAL 3005",hex:"#59191F"},{name:"RAL 3007 - Black red",value:"RAL 3007",hex:"#3E2022"},{name:"RAL 3009 - Oxide red",value:"RAL 3009",hex:"#6D342D"},{name:"RAL 3011 - Brown red",value:"RAL 3011",hex:"#782423"},{name:"RAL 3012 - Beige red",value:"RAL 3012",hex:"#C5856D"},{name:"RAL 3013 - Tomato red",value:"RAL 3013",hex:"#972E25"},{name:"RAL 3014 - Antique pink",value:"RAL 3014",hex:"#CB7375"},{name:"RAL 3015 - Light pink",value:"RAL 3015",hex:"#D8A0A6"},{name:"RAL 3016 - Coral red",value:"RAL 3016",hex:"#A63D30"},{name:"RAL 3017 - Rose",value:"RAL 3017",hex:"#CA555D"},{name:"RAL 3018 - Strawberry red",value:"RAL 3018",hex:"#C63F4A"},{name:"RAL 3020 - Traffic red",value:"RAL 3020",hex:"#BB1F11"},{name:"RAL 3022 - Salmon pink",value:"RAL 3022",hex:"#CF6955"},{name:"RAL 3024 - Luminous red",value:"RAL 3024",hex:"#FF2D21"},{name:"RAL 3026 - Luminous bright red",value:"RAL 3026",hex:"#FF2A1C"},{name:"RAL 3027 - Raspberry red",value:"RAL 3027",hex:"#AB273C"},{name:"RAL 3028 - Pure red",value:"RAL 3028",hex:"#CC2C24"},{name:"RAL 3031 - Orient red",value:"RAL 3031",hex:"#A63437"},{name:"RAL 3032 - Pearl ruby red",value:"RAL 3032",hex:"#701D24"},{name:"RAL 3033 - Pearl pink",value:"RAL 3033",hex:"#A53A2E"},{name:"RAL 4001 - Red lilac",value:"RAL 4001",hex:"#816183"},{name:"RAL 4002 - Red violet",value:"RAL 4002",hex:"#8D3C4B"},{name:"RAL 4003 - Heather violet",value:"RAL 4003",hex:"#C4618C"},{name:"RAL 4004 - Claret violet",value:"RAL 4004",hex:"#651E38"},{name:"RAL 4005 - Blue lilac",value:"RAL 4005",hex:"#76689A"},{name:"RAL 4006 - Traffic purple",value:"RAL 4006",hex:"#903373"},{name:"RAL 4007 - Purple violet",value:"RAL 4007",hex:"#47243C"},{name:"RAL 4008 - Signal violet",value:"RAL 4008",hex:"#844C82"},{name:"RAL 4009 - Pastel violet",value:"RAL 4009",hex:"#9D8692"},{name:"RAL 4010 - Telemagenta",value:"RAL 4010",hex:"#BB4077"},{name:"RAL 4011 - Pearl violet",value:"RAL 4011",hex:"#6E6387"},{name:"RAL 4012 - Pearl blackberry",value:"RAL 4012",hex:"#6A6B7F"},{name:"RAL 5000 - Violet blue",value:"RAL 5000",hex:"#304F6E"},{name:"RAL 5001 - Green blue",value:"RAL 5001",hex:"#0E4C64"},{name:"RAL 5002 - Ultramarine blue",value:"RAL 5002",hex:"#00387A"},{name:"RAL 5003 - Sapphire blue",value:"RAL 5003",hex:"#1F3855"},{name:"RAL 5004 - Black blue",value:"RAL 5004",hex:"#191E28"},{name:"RAL 5005 - Signal blue",value:"RAL 5005",hex:"#005387"},{name:"RAL 5007 - Brillant blue",value:"RAL 5007",hex:"#376B8C"},{name:"RAL 5008 - Grey blue",value:"RAL 5008",hex:"#2B3A44"},{name:"RAL 5009 - Azure blue",value:"RAL 5009",hex:"#215F78"},{name:"RAL 5010 - Gentian blue",value:"RAL 5010",hex:"#004F7C"},{name:"RAL 5011 - Steel blue",value:"RAL 5011",hex:"#1A2B3C"},{name:"RAL 5012 - Light blue",value:"RAL 5012",hex:"#0089B6"},{name:"RAL 5013 - Cobalt blue",value:"RAL 5013",hex:"#193153"},{name:"RAL 5014 - Pigeon blue",value:"RAL 5014",hex:"#637D96"},{name:"RAL 5015 - Sky blue",value:"RAL 5015",hex:"#007CAF"},{name:"RAL 5017 - Traffic blue",value:"RAL 5017",hex:"#005B8C"},{name:"RAL 5018 - Turquoise blue",value:"RAL 5018",hex:"#048B8C"},{name:"RAL 5019 - Capri blue",value:"RAL 5019",hex:"#005E83"},{name:"RAL 5020 - Ocean blue",value:"RAL 5020",hex:"#00414B"},{name:"RAL 5021 - Water blue",value:"RAL 5021",hex:"#007577"},{name:"RAL 5022 - Night blue",value:"RAL 5022",hex:"#222D5A"},{name:"RAL 5023 - Distant blue",value:"RAL 5023",hex:"#41698C"},{name:"RAL 5024 - Pastel blue",value:"RAL 5024",hex:"#6093AC"},{name:"RAL 5025 - Pearl gentian blue",value:"RAL 5025",hex:"#20697C"},{name:"RAL 5026 - Pearl night blue",value:"RAL 5026",hex:"#0F3052"},{name:"RAL 6000 - Patina green",value:"RAL 6000",hex:"#3C7460"},{name:"RAL 6001 - Emerald green",value:"RAL 6001",hex:"#366735"},{name:"RAL 6002 - Leaf green",value:"RAL 6002",hex:"#325928"},{name:"RAL 6003 - Olive green",value:"RAL 6003",hex:"#50533C"},{name:"RAL 6004 - Blue green",value:"RAL 6004",hex:"#024442"},{name:"RAL 6005 - Moss green",value:"RAL 6005",hex:"#114232"},{name:"RAL 6006 - Grey olive",value:"RAL 6006",hex:"#3C392E"},{name:"RAL 6007 - Bottle green",value:"RAL 6007",hex:"#2C3222"},{name:"RAL 6008 - Brown green",value:"RAL 6008",hex:"#36342A"},{name:"RAL 6009 - Fir green",value:"RAL 6009",hex:"#27352A"},{name:"RAL 6010 - Grass green",value:"RAL 6010",hex:"#4D6F39"},{name:"RAL 6011 - Reseda green",value:"RAL 6011",hex:"#6B7C59"},{name:"RAL 6012 - Black green",value:"RAL 6012",hex:"#2F3D3A"},{name:"RAL 6013 - Reed green",value:"RAL 6013",hex:"#7C765A"},{name:"RAL 6014 - Yellow olive",value:"RAL 6014",hex:"#474135"},{name:"RAL 6015 - Black olive",value:"RAL 6015",hex:"#3D3D36"},{name:"RAL 6016 - Turquoise green",value:"RAL 6016",hex:"#00694C"},{name:"RAL 6017 - May green",value:"RAL 6017",hex:"#587F40"},{name:"RAL 6018 - Yellow green",value:"RAL 6018",hex:"#60993B"},{name:"RAL 6019 - Pastel green",value:"RAL 6019",hex:"#B9CEAC"},{name:"RAL 6020 - Chrome green",value:"RAL 6020",hex:"#37422F"},{name:"RAL 6021 - Pale green",value:"RAL 6021",hex:"#8A9977"},{name:"RAL 6022 - Olive drab",value:"RAL 6022",hex:"#3A3327"},{name:"RAL 6024 - Traffic green",value:"RAL 6024",hex:"#008351"},{name:"RAL 6025 - Fern green",value:"RAL 6025",hex:"#5E6E3B"},{name:"RAL 6026 - Opal green",value:"RAL 6026",hex:"#005F4E"},{name:"RAL 6027 - Light green",value:"RAL 6027",hex:"#7EBAB5"},{name:"RAL 6028 - Pine green",value:"RAL 6028",hex:"#315442"},{name:"RAL 6029 - Mint green",value:"RAL 6029",hex:"#006F3D"},{name:"RAL 6032 - Signal green",value:"RAL 6032",hex:"#237F52"},{name:"RAL 6033 - Mint turquoise",value:"RAL 6033",hex:"#45877F"},{name:"RAL 6034 - Pastel turquoise",value:"RAL 6034",hex:"#7AADAC"},{name:"RAL 6035 - Pearl green",value:"RAL 6035",hex:"#194D25"},{name:"RAL 6036 - Pearl opal green",value:"RAL 6036",hex:"#04574B"},{name:"RAL 6037 - Pure green",value:"RAL 6037",hex:"#008B29"},{name:"RAL 6038 - Luminous green",value:"RAL 6038",hex:"#00B51B"},{name:"RAL 6039 - Fibrous green",value:"RAL 6039",hex:"#B3C43E"},{name:"RAL 7000 - Squirrel grey",value:"RAL 7000",hex:"#7A888E"},{name:"RAL 7001 - Silver grey",value:"RAL 7001",hex:"#8C979C"},{name:"RAL 7002 - Olive grey",value:"RAL 7002",hex:"#817863"},{name:"RAL 7003 - Moss grey",value:"RAL 7003",hex:"#797669"},{name:"RAL 7004 - Signal grey",value:"RAL 7004",hex:"#9A9B9B"},{name:"RAL 7005 - Mouse grey",value:"RAL 7005",hex:"#6B6E6B"},{name:"RAL 7006 - Beige grey",value:"RAL 7006",hex:"#766A5E"},{name:"RAL 7008 - Khaki grey",value:"RAL 7008",hex:"#745F3D"},{name:"RAL 7009 - Green grey",value:"RAL 7009",hex:"#5D6058"},{name:"RAL 7010 - Tarpaulin grey",value:"RAL 7010",hex:"#585C56"},{name:"RAL 7011 - Iron grey",value:"RAL 7011",hex:"#52595D"},{name:"RAL 7012 - Basalt grey",value:"RAL 7012",hex:"#575D5E"},{name:"RAL 7013 - Brown grey",value:"RAL 7013",hex:"#575044"},{name:"RAL 7015 - Slate grey",value:"RAL 7015",hex:"#4F5358"},{name:"RAL 7016 - Anthracite grey",value:"RAL 7016",hex:"#383E42"},{name:"RAL 7021 - Black grey",value:"RAL 7021",hex:"#2F3234"},{name:"RAL 7022 - Umbra grey",value:"RAL 7022",hex:"#4C4A44"},{name:"RAL 7023 - Concrete grey",value:"RAL 7023",hex:"#808076"},{name:"RAL 7024 - Graphite grey",value:"RAL 7024",hex:"#45494E"},{name:"RAL 7026 - Granite grey",value:"RAL 7026",hex:"#374345"},{name:"RAL 7030 - Stone grey",value:"RAL 7030",hex:"#928E85"},{name:"RAL 7031 - Blue grey",value:"RAL 7031",hex:"#5B686D"},{name:"RAL 7032 - Pebble grey",value:"RAL 7032",hex:"#B5B0A1"},{name:"RAL 7033 - Cement grey",value:"RAL 7033",hex:"#7F8274"},{name:"RAL 7034 - Yellow grey",value:"RAL 7034",hex:"#92886F"},{name:"RAL 7035 - Light grey",value:"RAL 7035",hex:"#C5C7C4"},{name:"RAL 7036 - Platinum grey",value:"RAL 7036",hex:"#979392"},{name:"RAL 7037 - Dusty grey",value:"RAL 7037",hex:"#7A7B7A"},{name:"RAL 7038 - Agate grey",value:"RAL 7038",hex:"#B0B0A9"},{name:"RAL 7039 - Quartz grey",value:"RAL 7039",hex:"#6B665E"},{name:"RAL 7040 - Window grey",value:"RAL 7040",hex:"#989EA1"},{name:"RAL 7042 - Traffic grey A",value:"RAL 7042",hex:"#8E9291"},{name:"RAL 7043 - Traffic grey B",value:"RAL 7043",hex:"#4F5250"},{name:"RAL 7044 - Silk grey",value:"RAL 7044",hex:"#B7B3A8"},{name:"RAL 7045 - Telegrey 1",value:"RAL 7045",hex:"#8D9295"},{name:"RAL 7046 - Telegrey 2",value:"RAL 7046",hex:"#7E868A"},{name:"RAL 7047 - Telegrey 4",value:"RAL 7047",hex:"#C8C8C7"},{name:"RAL 7048 - Pearl mouse grey",value:"RAL 7048",hex:"#817B73"},{name:"RAL 8000 - Green brown",value:"RAL 8000",hex:"#89693F"},{name:"RAL 8001 - Ochre brown",value:"RAL 8001",hex:"#9D622B"},{name:"RAL 8002 - Signal brown",value:"RAL 8002",hex:"#794D3E"},{name:"RAL 8003 - Clay brown",value:"RAL 8003",hex:"#7E4B27"},{name:"RAL 8004 - Copper brown",value:"RAL 8004",hex:"#8D4931"},{name:"RAL 8007 - Fawn brown",value:"RAL 8007",hex:"#70462B"},{name:"RAL 8008 - Olive brown",value:"RAL 8008",hex:"#724A25"},{name:"RAL 8011 - Nut brown",value:"RAL 8011",hex:"#5A3827"},{name:"RAL 8012 - Red brown",value:"RAL 8012",hex:"#66332B"},{name:"RAL 8014 - Sepia brown",value:"RAL 8014",hex:"#4A3526"},{name:"RAL 8015 - Chestnut brown",value:"RAL 8015",hex:"#5E2F26"},{name:"RAL 8016 - Mahogany brown",value:"RAL 8016",hex:"#4C2B20"},{name:"RAL 8017 - Chocolate brown",value:"RAL 8017",hex:"#442F29"},{name:"RAL 8019 - Grey brown",value:"RAL 8019",hex:"#3D3635"},{name:"RAL 8022 - Black brown",value:"RAL 8022",hex:"#1A1719"},{name:"RAL 8023 - Orange brown",value:"RAL 8023",hex:"#A45729"},{name:"RAL 8024 - Beige brown",value:"RAL 8024",hex:"#795038"},{name:"RAL 8025 - Pale brown",value:"RAL 8025",hex:"#755847"},{name:"RAL 8028 - Terra brown",value:"RAL 8028",hex:"#513A2A"},{name:"RAL 8029 - Pearl copper",value:"RAL 8029",hex:"#7F4031"},{name:"RAL 9001 - Cream",value:"RAL 9001",hex:"#E9E0D2"},{name:"RAL 9002 - Grey white",value:"RAL 9002",hex:"#D6D5CB"},{name:"RAL 9003 - Signal white",value:"RAL 9003",hex:"#ECECE7"},{name:"RAL 9004 - Signal black",value:"RAL 9004",hex:"#2B2B2C"},{name:"RAL 9005 - Jet black",value:"RAL 9005",hex:"#0E0E10"},{name:"RAL 9006 - White aluminium",value:"RAL 9006",hex:"#A1A1A0"},{name:"RAL 9007 - Grey aluminium",value:"RAL 9007",hex:"#868581"},{name:"RAL 9010 - Pure white",value:"RAL 9010",hex:"#F1EDE1"},{name:"RAL 9011 - Graphite black",value:"RAL 9011",hex:"#27292B"},{name:"RAL 9012 - Cleanroom white",value:"RAL 9012",hex:"#F8F2E1"},{name:"RAL 9016 - Traffic white",value:"RAL 9016",hex:"#F1F1EA"},{name:"RAL 9017 - Traffic black",value:"RAL 9017",hex:"#29292A"},{name:"RAL 9018 - Papyrus white",value:"RAL 9018",hex:"#C8CBC4"},{name:"RAL 9022 - Pearl light grey",value:"RAL 9022",hex:"#858583"},{name:"RAL 9023 - Pearl dark grey",value:"RAL 9023",hex:"#787B7A"}];G.useEffect(()=>{s!==null&&e[s]&&(d(e[s]),u(!0))},[s,e]),G.useEffect(()=>{s!==null&&e[s]&&(d(e[s]),u(!0))},[s,e]);const f=v=>{if(s!==null){const g=[...e];g[s]=v,r(g),o(null)}else r([...e,v]);d(null),u(!1)},p=v=>{o(v)};return a.jsxs(Ut,{children:[a.jsx(Et,{variant:"subtitle1",children:"Product Variants"}),a.jsx(Br,{onClick:()=>{d(null),u(!0)},variant:"outlined",sx:{mb:2},children:"+ Add Variant"}),a.jsxs(Cs,{size:"small",children:[a.jsx(js,{children:a.jsxs(pn,{children:[a.jsx(qe,{align:"center",children:"Color Code"}),a.jsx(qe,{align:"center",children:"Size"}),a.jsx(qe,{align:"center",children:"SKU"}),a.jsx(qe,{align:"center",children:"Barcode"}),a.jsx(qe,{align:"center",children:"Purchase Cost"}),a.jsx(qe,{align:"center",children:"Sales Price"}),a.jsx(qe,{align:"center",children:"Stock"}),a.jsx(qe,{align:"center",children:"Lead Time"}),a.jsx(qe,{align:"center",children:"Images"}),a.jsx(qe,{align:"center",children:"Status"}),a.jsx(qe,{align:"center",children:"Action"})]})}),a.jsx(fs,{children:e.map((v,g)=>{const m=h.find(b=>b.value===v.color);return a.jsxs(pn,{children:[a.jsx(qe,{align:"center",children:a.jsxs(Ut,{display:"flex",alignItems:"center",gap:1,children:[a.jsx(Ut,{sx:{width:20,height:20,backgroundColor:(m==null?void 0:m.hex)||v.color,border:"1px solid #ccc",borderRadius:"4px",flexShrink:0}}),a.jsx(Ut,{children:a.jsx(Et,{variant:"body2",children:(m==null?void 0:m.name)||"Unknown Color"})})]})}),a.jsx(qe,{align:"center",children:v.size}),a.jsx(qe,{align:"center",children:v.sku}),a.jsx(qe,{align:"center",children:v.barcode}),a.jsxs(qe,{align:"center",children:["",v.purchaseCost]}),a.jsxs(qe,{align:"center",children:["",v.stdSalesPrice]}),a.jsx(qe,{align:"center",children:v.stock}),a.jsxs(qe,{align:"center",children:[v.leadTime," days"]}),a.jsx(qe,{align:"center",children:Array.isArray(v.images)&&v.images.length>0?a.jsxs(Ut,{display:"flex",gap:.5,children:[v.images.slice(0,3).map((b,y)=>a.jsx(Ut,{component:"img",src:typeof b=="string"?`${Je}/uploads/${b}`:URL.createObjectURL(b),alt:`variant-${g}-img-${y}`,sx:{width:30,height:30,objectFit:"cover",borderRadius:1,border:"1px solid #ccc"},onError:S=>{S.target.src="https://via.placeholder.com/30?text=Error"}},y)),v.images.length>3&&a.jsxs(Et,{variant:"caption",sx:{alignSelf:"center",ml:.5},children:["+",v.images.length-3]})]}):""}),a.jsx(qe,{align:"center",children:a.jsx(Et,{variant:"body2",sx:{color:v.isActive!==!1?"success.main":"error.main",fontWeight:"medium"},children:v.isActive!==!1?"Active":"Inactive"})}),a.jsx(qe,{align:"center",children:a.jsx(sn,{size:"small",onClick:()=>p(g),children:a.jsx(bl,{fontSize:"small"})})})]},g)})})]}),a.jsxs(Ut,{mt:2,display:"flex",justifyContent:"space-between",children:[a.jsx(Br,{onClick:t,children:"Back"}),a.jsx(Br,{variant:"contained",onClick:n,children:"Next"})]}),a.jsx(sK,{open:c,onClose:()=>{u(!1),o(null),d(null)},onSave:v=>{(!v.sku||String(v.sku).trim()==="")&&(v.sku=null),f(v)},initialData:l,sizes:i})]})}const oK={success:a.jsx(Rz,{fontSize:"large",color:"success"}),error:a.jsx(Tz,{fontSize:"large",color:"error"}),info:a.jsx(Mz,{fontSize:"large",color:"info"}),warning:a.jsx(Bz,{fontSize:"large",color:"warning"})};function fR({open:e,onClose:r,type:t="success",title:n="",message:s="",actions:o=[]}){return a.jsxs(Oa,{open:e,onClose:r,maxWidth:"sm",fullWidth:!0,children:[a.jsxs(Wa,{sx:{display:"flex",alignItems:"center",gap:1},children:[oK[t]," ",n,a.jsx(sn,{"aria-label":"close",onClick:r,sx:{marginLeft:"auto"},children:a.jsx(Ez,{})})]}),a.jsx(Pa,{children:a.jsxs(Et,{variant:"body1",children:[" ",s]})}),a.jsx(Va,{children:o.map((i,c)=>a.jsx(Br,{onClick:i.onClick,variant:i.variant||"text",color:i.color||(t==="error"?"error":"primary"),children:i.label},c))})]})}const lK=[{name:"RAL 1000 - Green beige",value:"RAL 1000",hex:"#CDBA88"},{name:"RAL 1001 - Beige",value:"RAL 1001",hex:"#D0B084"},{name:"RAL 1002 - Sand yellow",value:"RAL 1002",hex:"#D2AA6D"},{name:"RAL 1003 - Signal yellow",value:"RAL 1003",hex:"#F9A900"},{name:"RAL 1004 - Golden yellow",value:"RAL 1004",hex:"#E49E00"},{name:"RAL 1005 - Honey yellow",value:"RAL 1005",hex:"#CB8F00"},{name:"RAL 1006 - Maize yellow",value:"RAL 1006",hex:"#E19000"},{name:"RAL 1007 - Daffodil yellow",value:"RAL 1007",hex:"#E88C00"},{name:"RAL 1011 - Brown beige",value:"RAL 1011",hex:"#AF8050"},{name:"RAL 1012 - Lemon yellow",value:"RAL 1012",hex:"#DDAF28"},{name:"RAL 1013 - Oyster white",value:"RAL 1013",hex:"#E3D9C7"},{name:"RAL 1014 - Ivory",value:"RAL 1014",hex:"#DDC49B"},{name:"RAL 1015 - Light ivory",value:"RAL 1015",hex:"#E6D2B5"},{name:"RAL 1016 - Sulfur yellow",value:"RAL 1016",hex:"#F1DD39"},{name:"RAL 1017 - Saffron yellow",value:"RAL 1017",hex:"#F6A951"},{name:"RAL 1018 - Zinc yellow",value:"RAL 1018",hex:"#FACA31"},{name:"RAL 1019 - Grey beige",value:"RAL 1019",hex:"#A48F7A"},{name:"RAL 1020 - Olive yellow",value:"RAL 1020",hex:"#A08F65"},{name:"RAL 1021 - Colza yellow",value:"RAL 1021",hex:"#F6B600"},{name:"RAL 1023 - Traffic yellow",value:"RAL 1023",hex:"#F7B500"},{name:"RAL 1024 - Ochre yellow",value:"RAL 1024",hex:"#BA8F4C"},{name:"RAL 1026 - Luminous yellow",value:"RAL 1026",hex:"#FFFF00"},{name:"RAL 1027 - Curry",value:"RAL 1027",hex:"#A77F0F"},{name:"RAL 1028 - Melon yellow",value:"RAL 1028",hex:"#FF9C00"},{name:"RAL 1032 - Broom yellow",value:"RAL 1032",hex:"#E2A300"},{name:"RAL 1033 - Dahlia yellow",value:"RAL 1033",hex:"#F99A1D"},{name:"RAL 1034 - Pastel yellow",value:"RAL 1034",hex:"#EB9C52"},{name:"RAL 1035 - Pearl beige",value:"RAL 1035",hex:"#8F8370"},{name:"RAL 1036 - Pearl gold",value:"RAL 1036",hex:"#806440"},{name:"RAL 1037 - Sun yellow",value:"RAL 1037",hex:"#F09200"},{name:"RAL 2000 - Yellow orange",value:"RAL 2000",hex:"#DA6E00"},{name:"RAL 2001 - Red orange",value:"RAL 2001",hex:"#BA481C"},{name:"RAL 2002 - Vermilion",value:"RAL 2002",hex:"#BF3922"},{name:"RAL 2003 - Pastel orange",value:"RAL 2003",hex:"#F67829"},{name:"RAL 2004 - Pure orange",value:"RAL 2004",hex:"#E25304"},{name:"RAL 2005 - Luminous orange",value:"RAL 2005",hex:"#FF4D08"},{name:"RAL 2007 - Luminous bright orange",value:"RAL 2007",hex:"#FFB200"},{name:"RAL 2008 - Bright red orange",value:"RAL 2008",hex:"#EC6B22"},{name:"RAL 2009 - Traffic orange",value:"RAL 2009",hex:"#DE5308"},{name:"RAL 2010 - Signal orange",value:"RAL 2010",hex:"#D05D29"},{name:"RAL 2011 - Deep orange",value:"RAL 2011",hex:"#E26E0F"},{name:"RAL 2012 - Salmon orange",value:"RAL 2012",hex:"#D5654E"},{name:"RAL 2013 - Pearl orange",value:"RAL 2013",hex:"#923E25"},{name:"RAL 2017 - RAL orange",value:"RAL 2017",hex:"#FC5500"},{name:"RAL 3000 - Flame red",value:"RAL 3000",hex:"#A72920"},{name:"RAL 3001 - Signal red",value:"RAL 3001",hex:"#9B2423"},{name:"RAL 3002 - Carmine red",value:"RAL 3002",hex:"#9B2321"},{name:"RAL 3003 - Ruby red",value:"RAL 3003",hex:"#861A22"},{name:"RAL 3004 - Purple red",value:"RAL 3004",hex:"#6B1C23"},{name:"RAL 3005 - Wine red",value:"RAL 3005",hex:"#59191F"},{name:"RAL 3007 - Black red",value:"RAL 3007",hex:"#3E2022"},{name:"RAL 3009 - Oxide red",value:"RAL 3009",hex:"#6D342D"},{name:"RAL 3011 - Brown red",value:"RAL 3011",hex:"#782423"},{name:"RAL 3012 - Beige red",value:"RAL 3012",hex:"#C5856D"},{name:"RAL 3013 - Tomato red",value:"RAL 3013",hex:"#972E25"},{name:"RAL 3014 - Antique pink",value:"RAL 3014",hex:"#CB7375"},{name:"RAL 3015 - Light pink",value:"RAL 3015",hex:"#D8A0A6"},{name:"RAL 3016 - Coral red",value:"RAL 3016",hex:"#A63D30"},{name:"RAL 3017 - Rose",value:"RAL 3017",hex:"#CA555D"},{name:"RAL 3018 - Strawberry red",value:"RAL 3018",hex:"#C63F4A"},{name:"RAL 3020 - Traffic red",value:"RAL 3020",hex:"#BB1F11"},{name:"RAL 3022 - Salmon pink",value:"RAL 3022",hex:"#CF6955"},{name:"RAL 3024 - Luminous red",value:"RAL 3024",hex:"#FF2D21"},{name:"RAL 3026 - Luminous bright red",value:"RAL 3026",hex:"#FF2A1C"},{name:"RAL 3027 - Raspberry red",value:"RAL 3027",hex:"#AB273C"},{name:"RAL 3028 - Pure red",value:"RAL 3028",hex:"#CC2C24"},{name:"RAL 3031 - Orient red",value:"RAL 3031",hex:"#A63437"},{name:"RAL 3032 - Pearl ruby red",value:"RAL 3032",hex:"#701D24"},{name:"RAL 3033 - Pearl pink",value:"RAL 3033",hex:"#A53A2E"},{name:"RAL 4001 - Red lilac",value:"RAL 4001",hex:"#816183"},{name:"RAL 4002 - Red violet",value:"RAL 4002",hex:"#8D3C4B"},{name:"RAL 4003 - Heather violet",value:"RAL 4003",hex:"#C4618C"},{name:"RAL 4004 - Claret violet",value:"RAL 4004",hex:"#651E38"},{name:"RAL 4005 - Blue lilac",value:"RAL 4005",hex:"#76689A"},{name:"RAL 4006 - Traffic purple",value:"RAL 4006",hex:"#903373"},{name:"RAL 4007 - Purple violet",value:"RAL 4007",hex:"#47243C"},{name:"RAL 4008 - Signal violet",value:"RAL 4008",hex:"#844C82"},{name:"RAL 4009 - Pastel violet",value:"RAL 4009",hex:"#9D8692"},{name:"RAL 4010 - Telemagenta",value:"RAL 4010",hex:"#BB4077"},{name:"RAL 4011 - Pearl violet",value:"RAL 4011",hex:"#6E6387"},{name:"RAL 4012 - Pearl blackberry",value:"RAL 4012",hex:"#6A6B7F"},{name:"RAL 5000 - Violet blue",value:"RAL 5000",hex:"#304F6E"},{name:"RAL 5001 - Green blue",value:"RAL 5001",hex:"#0E4C64"},{name:"RAL 5002 - Ultramarine blue",value:"RAL 5002",hex:"#00387A"},{name:"RAL 5003 - Sapphire blue",value:"RAL 5003",hex:"#1F3855"},{name:"RAL 5004 - Black blue",value:"RAL 5004",hex:"#191E28"},{name:"RAL 5005 - Signal blue",value:"RAL 5005",hex:"#005387"},{name:"RAL 5007 - Brillant blue",value:"RAL 5007",hex:"#376B8C"},{name:"RAL 5008 - Grey blue",value:"RAL 5008",hex:"#2B3A44"},{name:"RAL 5009 - Azure blue",value:"RAL 5009",hex:"#215F78"},{name:"RAL 5010 - Gentian blue",value:"RAL 5010",hex:"#004F7C"},{name:"RAL 5011 - Steel blue",value:"RAL 5011",hex:"#1A2B3C"},{name:"RAL 5012 - Light blue",value:"RAL 5012",hex:"#0089B6"},{name:"RAL 5013 - Cobalt blue",value:"RAL 5013",hex:"#193153"},{name:"RAL 5014 - Pigeon blue",value:"RAL 5014",hex:"#637D96"},{name:"RAL 5015 - Sky blue",value:"RAL 5015",hex:"#007CAF"},{name:"RAL 5017 - Traffic blue",value:"RAL 5017",hex:"#005B8C"},{name:"RAL 5018 - Turquoise blue",value:"RAL 5018",hex:"#048B8C"},{name:"RAL 5019 - Capri blue",value:"RAL 5019",hex:"#005E83"},{name:"RAL 5020 - Ocean blue",value:"RAL 5020",hex:"#00414B"},{name:"RAL 5021 - Water blue",value:"RAL 5021",hex:"#007577"},{name:"RAL 5022 - Night blue",value:"RAL 5022",hex:"#222D5A"},{name:"RAL 5023 - Distant blue",value:"RAL 5023",hex:"#41698C"},{name:"RAL 5024 - Pastel blue",value:"RAL 5024",hex:"#6093AC"},{name:"RAL 5025 - Pearl gentian blue",value:"RAL 5025",hex:"#20697C"},{name:"RAL 5026 - Pearl night blue",value:"RAL 5026",hex:"#0F3052"},{name:"RAL 6000 - Patina green",value:"RAL 6000",hex:"#3C7460"},{name:"RAL 6001 - Emerald green",value:"RAL 6001",hex:"#366735"},{name:"RAL 6002 - Leaf green",value:"RAL 6002",hex:"#325928"},{name:"RAL 6003 - Olive green",value:"RAL 6003",hex:"#50533C"},{name:"RAL 6004 - Blue green",value:"RAL 6004",hex:"#024442"},{name:"RAL 6005 - Moss green",value:"RAL 6005",hex:"#114232"},{name:"RAL 6006 - Grey olive",value:"RAL 6006",hex:"#3C392E"},{name:"RAL 6007 - Bottle green",value:"RAL 6007",hex:"#2C3222"},{name:"RAL 6008 - Brown green",value:"RAL 6008",hex:"#36342A"},{name:"RAL 6009 - Fir green",value:"RAL 6009",hex:"#27352A"},{name:"RAL 6010 - Grass green",value:"RAL 6010",hex:"#4D6F39"},{name:"RAL 6011 - Reseda green",value:"RAL 6011",hex:"#6B7C59"},{name:"RAL 6012 - Black green",value:"RAL 6012",hex:"#2F3D3A"},{name:"RAL 6013 - Reed green",value:"RAL 6013",hex:"#7C765A"},{name:"RAL 6014 - Yellow olive",value:"RAL 6014",hex:"#474135"},{name:"RAL 6015 - Black olive",value:"RAL 6015",hex:"#3D3D36"},{name:"RAL 6016 - Turquoise green",value:"RAL 6016",hex:"#00694C"},{name:"RAL 6017 - May green",value:"RAL 6017",hex:"#587F40"},{name:"RAL 6018 - Yellow green",value:"RAL 6018",hex:"#60993B"},{name:"RAL 6019 - Pastel green",value:"RAL 6019",hex:"#B9CEAC"},{name:"RAL 6020 - Chrome green",value:"RAL 6020",hex:"#37422F"},{name:"RAL 6021 - Pale green",value:"RAL 6021",hex:"#8A9977"},{name:"RAL 6022 - Olive drab",value:"RAL 6022",hex:"#3A3327"},{name:"RAL 6024 - Traffic green",value:"RAL 6024",hex:"#008351"},{name:"RAL 6025 - Fern green",value:"RAL 6025",hex:"#5E6E3B"},{name:"RAL 6026 - Opal green",value:"RAL 6026",hex:"#005F4E"},{name:"RAL 6027 - Light green",value:"RAL 6027",hex:"#7EBAB5"},{name:"RAL 6028 - Pine green",value:"RAL 6028",hex:"#315442"},{name:"RAL 6029 - Mint green",value:"RAL 6029",hex:"#006F3D"},{name:"RAL 6032 - Signal green",value:"RAL 6032",hex:"#237F52"},{name:"RAL 6033 - Mint turquoise",value:"RAL 6033",hex:"#45877F"},{name:"RAL 6034 - Pastel turquoise",value:"RAL 6034",hex:"#7AADAC"},{name:"RAL 6035 - Pearl green",value:"RAL 6035",hex:"#194D25"},{name:"RAL 6036 - Pearl opal green",value:"RAL 6036",hex:"#04574B"},{name:"RAL 6037 - Pure green",value:"RAL 6037",hex:"#008B29"},{name:"RAL 6038 - Luminous green",value:"RAL 6038",hex:"#00B51B"},{name:"RAL 6039 - Fibrous green",value:"RAL 6039",hex:"#B3C43E"},{name:"RAL 7000 - Squirrel grey",value:"RAL 7000",hex:"#7A888E"},{name:"RAL 7001 - Silver grey",value:"RAL 7001",hex:"#8C979C"},{name:"RAL 7002 - Olive grey",value:"RAL 7002",hex:"#817863"},{name:"RAL 7003 - Moss grey",value:"RAL 7003",hex:"#797669"},{name:"RAL 7004 - Signal grey",value:"RAL 7004",hex:"#9A9B9B"},{name:"RAL 7005 - Mouse grey",value:"RAL 7005",hex:"#6B6E6B"},{name:"RAL 7006 - Beige grey",value:"RAL 7006",hex:"#766A5E"},{name:"RAL 7008 - Khaki grey",value:"RAL 7008",hex:"#745F3D"},{name:"RAL 7009 - Green grey",value:"RAL 7009",hex:"#5D6058"},{name:"RAL 7010 - Tarpaulin grey",value:"RAL 7010",hex:"#585C56"},{name:"RAL 7011 - Iron grey",value:"RAL 7011",hex:"#52595D"},{name:"RAL 7012 - Basalt grey",value:"RAL 7012",hex:"#575D5E"},{name:"RAL 7013 - Brown grey",value:"RAL 7013",hex:"#575044"},{name:"RAL 7015 - Slate grey",value:"RAL 7015",hex:"#4F5358"},{name:"RAL 7016 - Anthracite grey",value:"RAL 7016",hex:"#383E42"},{name:"RAL 7021 - Black grey",value:"RAL 7021",hex:"#2F3234"},{name:"RAL 7022 - Umbra grey",value:"RAL 7022",hex:"#4C4A44"},{name:"RAL 7023 - Concrete grey",value:"RAL 7023",hex:"#808076"},{name:"RAL 7024 - Graphite grey",value:"RAL 7024",hex:"#45494E"},{name:"RAL 7026 - Granite grey",value:"RAL 7026",hex:"#374345"},{name:"RAL 7030 - Stone grey",value:"RAL 7030",hex:"#928E85"},{name:"RAL 7031 - Blue grey",value:"RAL 7031",hex:"#5B686D"},{name:"RAL 7032 - Pebble grey",value:"RAL 7032",hex:"#B5B0A1"},{name:"RAL 7033 - Cement grey",value:"RAL 7033",hex:"#7F8274"},{name:"RAL 7034 - Yellow grey",value:"RAL 7034",hex:"#92886F"},{name:"RAL 7035 - Light grey",value:"RAL 7035",hex:"#C5C7C4"},{name:"RAL 7036 - Platinum grey",value:"RAL 7036",hex:"#979392"},{name:"RAL 7037 - Dusty grey",value:"RAL 7037",hex:"#7A7B7A"},{name:"RAL 7038 - Agate grey",value:"RAL 7038",hex:"#B0B0A9"},{name:"RAL 7039 - Quartz grey",value:"RAL 7039",hex:"#6B665E"},{name:"RAL 7040 - Window grey",value:"RAL 7040",hex:"#989EA1"},{name:"RAL 7042 - Traffic grey A",value:"RAL 7042",hex:"#8E9291"},{name:"RAL 7043 - Traffic grey B",value:"RAL 7043",hex:"#4F5250"},{name:"RAL 7044 - Silk grey",value:"RAL 7044",hex:"#B7B3A8"},{name:"RAL 7045 - Telegrey 1",value:"RAL 7045",hex:"#8D9295"},{name:"RAL 7046 - Telegrey 2",value:"RAL 7046",hex:"#7E868A"},{name:"RAL 7047 - Telegrey 4",value:"RAL 7047",hex:"#C8C8C7"},{name:"RAL 7048 - Pearl mouse grey",value:"RAL 7048",hex:"#817B73"},{name:"RAL 8000 - Green brown",value:"RAL 8000",hex:"#89693F"},{name:"RAL 8001 - Ochre brown",value:"RAL 8001",hex:"#9D622B"},{name:"RAL 8002 - Signal brown",value:"RAL 8002",hex:"#794D3E"},{name:"RAL 8003 - Clay brown",value:"RAL 8003",hex:"#7E4B27"},{name:"RAL 8004 - Copper brown",value:"RAL 8004",hex:"#8D4931"},{name:"RAL 8007 - Fawn brown",value:"RAL 8007",hex:"#70462B"},{name:"RAL 8008 - Olive brown",value:"RAL 8008",hex:"#724A25"},{name:"RAL 8011 - Nut brown",value:"RAL 8011",hex:"#5A3827"},{name:"RAL 8012 - Red brown",value:"RAL 8012",hex:"#66332B"},{name:"RAL 8014 - Sepia brown",value:"RAL 8014",hex:"#4A3526"},{name:"RAL 8015 - Chestnut brown",value:"RAL 8015",hex:"#5E2F26"},{name:"RAL 8016 - Mahogany brown",value:"RAL 8016",hex:"#4C2B20"},{name:"RAL 8017 - Chocolate brown",value:"RAL 8017",hex:"#442F29"},{name:"RAL 8019 - Grey brown",value:"RAL 8019",hex:"#3D3635"},{name:"RAL 8022 - Black brown",value:"RAL 8022",hex:"#1A1719"},{name:"RAL 8023 - Orange brown",value:"RAL 8023",hex:"#A45729"},{name:"RAL 8024 - Beige brown",value:"RAL 8024",hex:"#795038"},{name:"RAL 8025 - Pale brown",value:"RAL 8025",hex:"#755847"},{name:"RAL 8028 - Terra brown",value:"RAL 8028",hex:"#513A2A"},{name:"RAL 8029 - Pearl copper",value:"RAL 8029",hex:"#7F4031"},{name:"RAL 9001 - Cream",value:"RAL 9001",hex:"#E9E0D2"},{name:"RAL 9002 - Grey white",value:"RAL 9002",hex:"#D6D5CB"},{name:"RAL 9003 - Signal white",value:"RAL 9003",hex:"#ECECE7"},{name:"RAL 9004 - Signal black",value:"RAL 9004",hex:"#2B2B2C"},{name:"RAL 9005 - Jet black",value:"RAL 9005",hex:"#0E0E10"},{name:"RAL 9006 - White aluminium",value:"RAL 9006",hex:"#A1A1A0"},{name:"RAL 9007 - Grey aluminium",value:"RAL 9007",hex:"#868581"},{name:"RAL 9010 - Pure white",value:"RAL 9010",hex:"#F1EDE1"},{name:"RAL 9011 - Graphite black",value:"RAL 9011",hex:"#27292B"},{name:"RAL 9012 - Cleanroom white",value:"RAL 9012",hex:"#F8F2E1"},{name:"RAL 9016 - Traffic white",value:"RAL 9016",hex:"#F1F1EA"},{name:"RAL 9017 - Traffic black",value:"RAL 9017",hex:"#29292A"},{name:"RAL 9018 - Papyrus white",value:"RAL 9018",hex:"#C8CBC4"},{name:"RAL 9022 - Pearl light grey",value:"RAL 9022",hex:"#858583"},{name:"RAL 9023 - Pearl dark grey",value:"RAL 9023",hex:"#787B7A"}];function cK({product:e={},variants:r=[],onBack:t,onSubmit:n,onEditVariant:s,onRemoveVariant:o,onReset:i}){const[c,u]=G.useState(!1),l=ii(),[d,h]=G.useState(!1),[f,p]=G.useState(""),[v,g]=G.useState(""),[m,b]=G.useState(""),[y,S]=G.useState(""),[C,L]=G.useState(""),[O,H]=G.useState("");G.useEffect(()=>{e&&(async()=>{var D,W,P,I,U,k,_,R,j,A,N;try{const V=[];e.categoryID?V.push(ut.get(`${Je}/api/categories/${e.categoryID}`)):V.push(Promise.resolve({data:{name:""}})),e.subcategoryID?V.push(ut.get(`${Je}/api/subcategories/${e.subcategoryID}`)):V.push(Promise.resolve({data:{name:""}})),e.taxID?V.push(ut.get(`${Je}/api/taxes/${e.taxID}`)):V.push(Promise.resolve({data:{name:""}})),e.unitID?V.push(ut.get(`${Je}/api/units/${e.unitID}`)):V.push(Promise.resolve({data:{name:""}})),e.storeID?V.push(ut.get(`${Je}/api/stores/${e.storeID}`)):V.push(Promise.resolve({data:{name:""}}));const[M,Z,J,re,X]=await Promise.all(V);if(p(((D=M.data)==null?void 0:D.name)||((W=M.data)==null?void 0:W.Name)||""),g(((P=Z.data)==null?void 0:P.name)||((I=Z.data)==null?void 0:I.Name)||""),b(((U=J.data)==null?void 0:U.name)||((k=J.data)==null?void 0:k.Name)||""),S(((_=re.data)==null?void 0:_.name)||((R=re.data)==null?void 0:R.Name)||""),L(((j=X.data)==null?void 0:j.name)||((A=X.data)==null?void 0:A.Name)||""),e.tagIDs&&Array.isArray(e.tagIDs)&&e.tagIDs.length>0)try{const K=(((N=(await ut.get(`${Je}/api/tags`,{params:{page:1,limit:1e3}})).data)==null?void 0:N.data)||[]).filter(ee=>(e.tagIDs||[]).includes(ee.ID||ee.id)).map(ee=>ee.Name||ee.name).filter(Boolean);H(K.join(", "))}catch(ne){console.warn("Failed to fetch tags for review:",ne),H("")}else H("")}catch(V){console.error("Error fetching display names:",V),p(""),g(""),b(""),S(""),L("")}})()},[e]);const z=async()=>{var q,D,W,P,I;if(!d){h(!0);try{const U=new FormData,k={...e};delete k.variants,delete k.tagIDs;const _={Name:k.name||"",Code:k.code||"",HsnID:k.hsnID?Number(k.hsnID):null,HsnSacCode:k.hsnSacCode||"",Importance:k.importance||"",ProductType:k.productType||"",MinimumStock:k.minimumStock?Number(k.minimumStock):0,MOQ:k.MOQ!=null&&k.MOQ!==""?Number(k.MOQ):k.moq!=null&&k.moq!==""?Number(k.moq):k.MinimumOrderQuantity!=null&&k.MinimumOrderQuantity!==""?Number(k.MinimumOrderQuantity):k.minimumOrderQuantity!=null&&k.minimumOrderQuantity!==""?Number(k.minimumOrderQuantity):(k.minimumOrderQuantity??k.MOQ??k.moq)||0,CategoryID:k.categoryID?Number(k.categoryID):null,SubcategoryID:k.subcategoryID?Number(k.subcategoryID):null,UnitID:k.unitID?Number(k.unitID):null,ProductMode:k.product_mode||"",StoreID:k.storeID?Number(k.storeID):null,TaxID:k.taxID?Number(k.taxID):null,GstPercent:k.gstPercent?Number(k.gstPercent):0,Description:k.description||"",InternalNotes:k.internalNotes||"",IsActive:k.isActive!==void 0?!!k.isActive:!0};U.append("product",JSON.stringify(_));const R=r.map(({images:N,mainImage:V,mainImageIndex:M,...Z},J)=>{let re=null;try{typeof V=="string"?re=V:V instanceof File?re=V.name||null:re=null}catch{re=V&&typeof V=="object"&&V.name?V.name:null}const X={Color:Z.color||"",Size:Z.size||"",Barcode:Z.barcode||"",PurchaseCost:Z.purchaseCost!==void 0&&Z.purchaseCost!==null&&Z.purchaseCost!==""?Number(Z.purchaseCost):0,StdSalesPrice:Z.stdSalesPrice!==void 0&&Z.stdSalesPrice!==null&&Z.stdSalesPrice!==""?Number(Z.stdSalesPrice):0,Stock:Z.stock!==void 0&&Z.stock!==null&&Z.stock!==""?Number(Z.stock):0,LeadTime:Z.leadTime!==void 0&&Z.leadTime!==null&&Z.leadTime!==""?Number(Z.leadTime):0,IsActive:Z.isActive!==void 0?!!Z.isActive:!0,MainImage:re,MainImageIndex:typeof M=="number"?M:null};return!Z.sku||Z.sku.toString().trim()===""?X.SKU=`TEMP_SKU_${Date.now()}_${J}_${Math.random().toString(36).substr(2,9)}`:X.SKU=Z.sku,X}),j=R.map(N=>N.SKU).filter(N=>N&&N.toString().trim()!=="");if(j.length>0){const N=j.reduce((M,Z)=>(M[Z]=(M[Z]||0)+1,M),{}),V=Object.keys(N).filter(M=>N[M]>1);if(V.length>0){alert(`Duplicate SKUs found in variants: ${V.join(", ")}. Please ensure each variant has a unique SKU.`);return}}U.append("variants",JSON.stringify(R)),U.append("tagIDs",JSON.stringify(e.tagIDs||[])),console.log("Appending images to FormData:"),r.forEach((N,V)=>{if(Array.isArray(N.images)){const M=R[V].SKU;console.log(`Variant ${M} has ${N.images.length} images`),N.images.forEach((Z,J)=>{if(Z instanceof File){const re=`images_${M}`;console.log(`Adding File: ${re}, name: ${Z.name}, size: ${Z.size}, type: ${Z.type}`),U.append(re,Z)}else typeof Z=="string"?(console.log(`String image for ${M}: ${Z}`),U.append("variant_images",JSON.stringify({sku:M,image:Z}))):console.log(`Unknown image type for ${M}:`,typeof Z,Z)})}}),console.log("Debug product submission:"),console.log("- Product data:",_),console.log("- Variants:",R),console.log("- Variants JSON:",JSON.stringify(R,null,2)),U.append("_debug","true"),console.log("Submitting product with FormData");const A=await ut.post(`${Je}/api/products`,U);console.log("Submitted successfully:",A.data),u(!0)}catch(U){console.error("Submission failed:",U),console.error("Error details:",((q=U.response)==null?void 0:q.data)||U.message);const k=(D=U.response)==null?void 0:D.data;let _=`Product submission failed: ${U.message}`;if(k){const R=typeof k=="string"?k:k.error||k.message||JSON.stringify(k);k==="Invalid multipart form"||R.toLowerCase().includes("invalid multipart")?_="Upload failed: The submitted form data is malformed. Please ensure files are attached correctly and try again.":R==="Invalid variants JSON"||R.toLowerCase().includes("invalid variants json")?_="Submission failed: The variant data is invalid. Please review variant fields (SKU, numeric fields, and main image) and try again.":k.error==="duplicate_skus"&&Array.isArray(k.skus)?_=`Submission failed: The following SKUs already exist: ${k.skus.join(", ")}. Use unique SKUs or leave blank to auto-generate.`:k.error==="duplicate_key"||R&&(R.toLowerCase().includes("unique constraint")||R.includes("sqlstate 23505")||R.toLowerCase().includes("duplicate key"))?R.includes("products_pkey")?_='Submission failed due to a database sequence issue. Click "Fix Database Sequence" and try again.':_="Submission failed because a unique constraint failed (likely a duplicate SKU). Please ensure SKUs are unique.":((W=U.response)==null?void 0:W.status)===400?_=`Submission failed (400): ${R||"Bad request - please check inputs."}`:((P=U.response)==null?void 0:P.status)===409?_=`Conflict: ${R||"A resource conflict occurred."}`:((I=U.response)==null?void 0:I.status)>=500?_="Server error: Please try again later or contact support.":R&&(_=`Submission failed: ${R}`)}else U.request&&(_="Network error: No response from server. Check your connection or backend server.");alert(_)}finally{h(!1)}}};return a.jsxs(Ut,{children:[a.jsx("h5",{style:{marginBottom:"20px"},children:"Review Product"}),a.jsx(Ut,{mb:2,children:a.jsx(is,{container:!0,spacing:0,children:[{label:"Name",value:e.name},{label:"Code",value:e.code},{label:"Tags",value:O},{label:"HSN Code",value:e.hsnSacCode},{label:"Importance",value:e.importance},{label:"Product Type",value:e.productType},{label:"Minimum Stock",value:e.minimumStock},{label:"Category",value:f},{label:"Subcategory",value:v},{label:"Unit",value:y},{label:"Product Mode",value:e.product_mode},{label:"MOQ",value:e.moq??e.MOQ??e.minimumStock},{label:"Store",value:C},{label:"Tax",value:m},{label:"GST %",value:`${e.gstPercent}%`},{label:"Description",value:e.description},{label:"Internal Notes",value:e.internalNotes},{label:"Status",value:e.isActive?"Active":"Inactive"}].map((q,D)=>a.jsx(is,{item:!0,xs:12,sm:6,children:a.jsx(Ut,{border:1,borderColor:"grey.300",borderRadius:1,p:1.5,children:a.jsxs(Et,{children:[a.jsxs("strong",{children:[q.label,":"]})," ",q.value]})})},D))})}),a.jsx(Tv,{sx:{my:2}}),a.jsx("h5",{style:{marginBottom:"20px"},children:"Product Variants"}),a.jsxs(Cs,{size:"small",children:[a.jsx(js,{children:a.jsxs(pn,{children:[a.jsx(qe,{align:"center",children:"Color Code"}),a.jsx(qe,{align:"center",children:"Size"}),a.jsx(qe,{align:"center",children:"SKU"}),a.jsx(qe,{align:"center",children:"Barcode"}),a.jsx(qe,{align:"center",children:"Purchase Cost"}),a.jsx(qe,{align:"center",children:"Sales Price"}),a.jsx(qe,{align:"center",children:"Stock"}),a.jsx(qe,{align:"center",children:"Lead Time"}),a.jsx(qe,{align:"center",children:"Images"}),a.jsx(qe,{align:"center",children:"Status"}),a.jsx(qe,{align:"center",children:"Actions"})]})}),a.jsx(fs,{children:(r||[]).map((q,D)=>a.jsxs(pn,{sx:{opacity:q.isActive===!1?.5:1},children:[a.jsx(qe,{align:"center",children:(()=>{const W=lK.find(I=>I.value===q.color),P=W!=null&&W.name?W.name.split(" - ")[1]:null;return a.jsxs(Ut,{display:"flex",alignItems:"center",gap:1,children:[a.jsx(Ut,{sx:{width:20,height:20,borderRadius:"5%",backgroundColor:W?W.hex:q.color,border:"1px solid #ccc"}}),a.jsx(Ut,{children:a.jsxs(Et,{variant:"body2",children:[q.color,P?` - ${P}`:""]})})]})})()}),a.jsx(qe,{align:"center",children:q.size}),a.jsx(qe,{align:"center",children:q.sku}),a.jsx(qe,{align:"center",children:q.barcode}),a.jsxs(qe,{align:"center",children:["",q.purchaseCost]}),a.jsxs(qe,{align:"center",children:["",q.stdSalesPrice]}),a.jsx(qe,{align:"center",children:q.stock}),a.jsxs(qe,{align:"center",children:[q.leadTime," days"]}),a.jsx(qe,{align:"center",children:Array.isArray(q.images)&&q.images.length>0?a.jsx(IH,{direction:"row",spacing:1,children:q.images.map((W,P)=>{const I=typeof W=="string"?`${Je}/uploads/${W}`:URL.createObjectURL(W);console.log(`Image ${P} for variant ${q.sku}:`,{original:W,type:typeof W,fullPath:I,isFile:W instanceof File});const U=typeof W=="string"&&(W.startsWith("http://")||W.startsWith("https://")||W.startsWith("data:"));return a.jsx(Ut,{position:"relative",children:a.jsx("img",{src:U?W:I,alt:`variant-${D}-img-${P}`,style:{width:40,height:40,objectFit:"cover",borderRadius:4,border:"1px solid #ccc"},onError:k=>{console.error("Failed to load image:",{src:k.target.src,originalImg:W}),k.target.src="https://via.placeholder.com/40?text=Error"}})},P)})}):""}),a.jsx(qe,{align:"center",children:a.jsx(Et,{variant:"body2",sx:{color:q.isActive!==!1?"success.main":"error.main",fontWeight:"medium"},children:q.isActive!==!1?"Active":"Inactive"})}),a.jsxs(qe,{align:"center",children:[a.jsx(sn,{size:"small",color:"primary",onClick:()=>s(D),children:a.jsx(bl,{fontSize:"small"})}),a.jsx(sn,{size:"small",color:"error",onClick:()=>o(D),children:a.jsx(ql,{fontSize:"small"})})]})]},D))})]}),a.jsxs(Ut,{mt:4,display:"flex",justifyContent:"space-between",children:[a.jsx(Br,{onClick:t,children:"Back"}),a.jsx(Br,{variant:"contained",onClick:z,children:"Submit"})]}),a.jsx(fR,{open:c,type:"success",title:"Product Added",message:"The product and its variants were successfully saved.",onClose:()=>u(!1),actions:[{label:" Add Another",onClick:()=>{u(!1),i()},variant:"outlined"},{label:"View Products",onClick:()=>{u(!1),l("/ProductMaster")},variant:"contained"}]})]})}const uK=["Product Info","Variants","Review"];function dK({onSuccess:e}){const r=ii(),[t,n]=G.useState(0),[s,o]=G.useState(null),[i,c]=G.useState([]),[u,l]=G.useState(null),d=()=>n(g=>g+1),h=()=>n(g=>g-1),f=g=>{l(g),n(1)},p=g=>{const m=[...i];m.splice(g,1),c(m)},v=()=>{o(null),c([]),n(0)};return a.jsxs("section",{className:"right-content",children:[a.jsx(sa,{sx:{p:3},children:a.jsx(Ut,{display:"flex",justifyContent:"end",gap:2,alignItems:"center",children:a.jsx(Br,{variant:"contained",color:"warning",onClick:()=>r("/ProductMaster"),sx:{mr:2},children:"View Products"})})}),a.jsxs(sa,{sx:{p:3},children:[a.jsx(Et,{variant:"h6",children:"Add New Product"}),a.jsx(oV,{activeStep:t,sx:{my:2},children:uK.map(g=>a.jsx(BH,{children:a.jsx(C7,{children:g})},g))}),t===0&&a.jsx(FG,{defaultValues:s,onNext:g=>{o(g),d()}}),t===1&&a.jsx(iK,{variants:i,setVariants:c,onBack:()=>{l(null),h()},onNext:()=>{l(null),d()},editIndex:u,setEditIndex:l}),t===2&&a.jsx(cK,{product:s,variants:i,onBack:h,onSubmit:e,onEditVariant:f,onRemoveVariant:p,onReset:v})]})]})}const fK="modulepreload",hK=function(e){return"/"+e},MA={},hR=function(r,t,n){let s=Promise.resolve();if(t&&t.length>0){let i=function(l){return Promise.all(l.map(d=>Promise.resolve(d).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),u=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));s=i(t.map(l=>{if(l=hK(l),l in MA)return;MA[l]=!0;const d=l.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":fK,d||(f.as="script"),f.crossOrigin="",f.href=l,u&&f.setAttribute("nonce",u),document.head.appendChild(f),d)return new Promise((p,v)=>{f.addEventListener("load",p),f.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${l}`)))})}))}function o(i){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=i,window.dispatchEvent(c),!c.defaultPrevented)throw i}return s.then(i=>{for(const c of i||[])c.status==="rejected"&&o(c.reason);return r().catch(o)})},pK=({value:e,rowIndex:r,columnKey:t,row:n,onUpdate:s,categories:o,allSubcategories:i,stores:c,hsnCodes:u,units:l,sizes:d,tags:h,taxes:f,error:p,errorMessages:v})=>{const[g,m]=G.useState(!1),[b,y]=G.useState(e),C=t.toLowerCase().trim().replace(/\s+/g,"").replace(/[^\w]/g,"");let L=C;/^hsn/.test(C)||C==="hsncode"?L="hsn":C==="category"?L="category":C==="subcategory"?L="subcategory":C==="store"?L="store":C==="unit"?L="unit":C==="size"?L="size":C==="producttype"?L="producttype":C==="productmode"?L="productmode":C==="status"?L="status":C==="importance"?L="importance":C==="tax"?L="tax":(C==="tag"||C==="tags")&&(L="tag"),console.log(`Column: "${t}"  Normalized: "${C}"  Standardized: "${L}"`);const O=C==="category",H=C==="subcategory",z=C==="store",q=C==="producttype",D=C==="status",W=C==="importance",P=L==="hsn",I=C==="unit",U=C==="productmode",k=C==="tag"||C==="tags",_=C==="size",R=C==="tax",A=["minstock","minimumstock","min_stock","minimum_stock","moq","tax","gst","purchasecost","salesprice","stock","leadtime"].includes(C);G.useEffect(()=>{g&&(console.log(`Editing cell "${t}" (normalized: "${C}"):`,{isCategory:O,isSubcategory:H,isStore:z,isProductType:q,isStatus:D,isImportance:W,isHsnCode:P,isUnit:I,isProductMode:U,isSize:_,isTax:R}),console.log("Available data for dropdowns:",{categories:Array.isArray(o)?`${o.length} items`:o,subcategories:Array.isArray(i)?`${i.length} items`:i,stores:Array.isArray(c)?`${c.length} items`:c,hsnCodes:Array.isArray(u)?`${u.length} items`:u,units:Array.isArray(l)?`${l.length} items`:l,sizes:Array.isArray(d)?`${d.length} items`:d,tags:Array.isArray(h)?`${h.length} items`:h,taxes:Array.isArray(f)?`${f.length} items`:f}),O&&(o==null?void 0:o.length)>0&&console.log("Sample category data:",o[0]),H&&(i==null?void 0:i.length)>0&&console.log("Sample subcategory data:",i[0]),z&&(c==null?void 0:c.length)>0&&console.log("Sample store data:",c[0]),P&&(u==null?void 0:u.length)>0&&console.log("Sample HSN code data:",u[0]),I&&(l==null?void 0:l.length)>0&&console.log("Sample unit data:",l[0]),_&&(d==null?void 0:d.length)>0&&console.log("Sample size data:",d[0]),k&&(h==null?void 0:h.length)>0&&console.log("Sample tag data:",h[0]),R&&(f==null?void 0:f.length)>0&&console.log("Sample tax data:",f[0]))},[g,t,C,o,i,c,u,l,d,h,f,O,H,z,q,D,W,P,I,U,_,k,R]);let N=[];if(O)Array.isArray(o)&&(N=o.map(J=>{const re=J.Name||J.name||"";return{value:re,label:re}}).filter(J=>J.value));else if(H){if(Array.isArray(i)){const J=["Category","category","CategoryName","categoryName","category_name","CATEGORY","Category *"];let re=null;for(const X of J)if(n[X]!==void 0&&n[X]!==null&&n[X]!==""){re=n[X];break}if(re&&Array.isArray(o)){const X=o.find(ne=>{const Y=ne.Name||ne.name||"",K=String(ne.ID||ne.id||"");return Y===re||K===String(re)});if(X){const ne=X.ID||X.id;N=i.filter(K=>{const ee=K.CategoryID||K.categoryID||K.category_id;return String(ee)===String(ne)}).map(K=>{const ee=K.Name||K.name||"";return{value:ee,label:ee}}).filter(K=>K.value),console.log(`Subcategory options for category '${re}': ${N.length} items`)}else console.warn(`Category '${re}' not found, showing all subcategories`),N=i.map(ne=>{const Y=ne.Name||ne.name||"";return{value:Y,label:Y}}).filter(ne=>ne.value)}else console.log("No category selected, showing all subcategories as suggestions"),N=i.map(X=>{const ne=X.Name||X.name||"";return{value:ne,label:ne}}).filter(X=>X.value)}}else z&&Array.isArray(c)?N=c.map(J=>{const re=J.Name||J.name||"";return{value:re,label:re}}).filter(J=>J.value):k&&Array.isArray(h)?N=h.map(J=>{const re=J.Name||J.name||"";return{value:re,label:re}}).filter(J=>J.value):q?N=[{value:"All",label:"All"},{value:"Finished Goods",label:"Finished Goods"},{value:"Semi-Finished Goods",label:"Semi-Finished Goods"},{value:"Raw Materials",label:"Raw Materials"}]:D?N=[{value:"Active",label:"Active"},{value:"Inactive",label:"Inactive"}]:W?N=[{value:"Normal",label:"Normal"},{value:"High",label:"High"},{value:"Critical",label:"Critical"}]:P&&Array.isArray(u)?(console.log("Generating HSN dropdown options from:",u.length,"HSN codes"),u.length>0&&(console.log("Sample HSN code item:",u[0]),console.log("HSN code properties:",Object.keys(u[0])),u[0].Tax&&console.log("Tax properties:",Object.keys(u[0].Tax))),N=u.map(J=>{const re=String(J.Code||J.code||"").trim();return J.Tax&&typeof J.Tax.Percentage=="number"?J.Tax.Percentage:J.tax&&typeof J.tax.Percentage=="number"?J.tax.Percentage:J.Tax&&typeof J.Tax.percentage=="number"?J.Tax.percentage:J.tax&&typeof J.tax.percentage=="number"&&J.tax.percentage,{value:re,label:re}}).filter(J=>J.value&&J.value.length>0),console.log("Generated HSN options:",N.length>0?N.slice(0,5):"No options")):I&&Array.isArray(l)?N=l.map(J=>{const re=J.Name||J.name||"";return{value:re,label:re}}).filter(J=>J.value):U?N=[{value:"Purchase",label:"Purchase"},{value:"Internal Manufacturing",label:"Internal Manufacturing"},{value:"Both",label:"Both"}]:_&&Array.isArray(d)?N=d.map(J=>{const re=J.Name||J.name||"";return{value:re,label:re}}).filter(J=>J.value):R&&Array.isArray(f)&&(console.log("Generating Tax dropdown options from:",f.length,"taxes"),f.length>0&&(console.log("Sample tax item:",f[0]),console.log("Tax properties:",Object.keys(f[0]))),N=f.map(J=>{const re=J.Name||J.name||"";return{value:re,label:re}}).filter(J=>J.value&&J.value.length>0),console.log("Generated Tax options:",N.length>0?N.slice(0,5):"No options"));(z||P||I||R)&&N.length===0&&console.warn(`No options found for dropdown field: ${t} (${C})`);const V=O||H||_||N.length>0,M=()=>{s(r,t,b),m(!1)},Z=J=>{J.key==="Enter"?M():J.key==="Escape"&&(y(e),m(!1))};return G.useEffect(()=>{y(e)},[e]),a.jsx(qe,{onClick:()=>!g&&m(!0),sx:{cursor:g?"default":"pointer",padding:g?"4px":void 0,minWidth:"140px",textAlign:A?"center":void 0,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",borderLeft:p?"4px solid rgba(244,67,54,0.6)":void 0,backgroundColor:p?"rgba(255,235,238,0.6)":void 0,"&:hover":g?{}:{backgroundColor:p?"rgba(255,235,238,0.65)":"rgba(0, 0, 0, 0.04)"}},children:g?V?a.jsx(Ut,{sx:{display:"flex",alignItems:"center",position:"relative"},children:O||H||_?a.jsx(bc,{freeSolo:!0,autoFocus:!0,options:N.map(J=>J.value),value:b||"",onChange:(J,re)=>{y(re||"")},onInputChange:(J,re)=>{y(re)},onBlur:M,onKeyDown:Z,renderInput:J=>a.jsx(ri,{...J,inputProps:{...J.inputProps||{},style:{textAlign:A?"center":"left"}},placeholder:N.length>0?`Type new or select ${O?"category":H?"subcategory":"size"}`:`Type ${O?"category":H?"subcategory":"size"} name`,variant:"outlined",size:"small",sx:{minWidth:"120px",width:"100%","& .MuiOutlinedInput-root":{backgroundColor:"#f1f8e9","& fieldset":{borderColor:"#4caf50",borderWidth:"2px"},"&:hover fieldset":{borderColor:"#4caf50"},"&.Mui-focused fieldset":{borderColor:"#4caf50"}},"& .MuiInputBase-input":{padding:"8px !important",fontSize:"14px"}}}),sx:{minWidth:"120px",width:"100%","& .MuiAutocomplete-inputRoot":{padding:"0 !important"}},ListboxProps:{style:{maxHeight:"200px"}}}):a.jsxs("select",{autoFocus:!0,value:b||"",onChange:J=>y(J.target.value),onKeyDown:Z,onBlur:M,style:{minWidth:"120px",width:"100%",textAlign:A?"center":"left",padding:"8px",border:"1px solid #1976d2",borderRadius:"4px",backgroundColor:"#f5f9ff",fontSize:"14px",color:"#333"},children:[a.jsx("option",{value:"",children:"-- Select --"}),N.map((J,re)=>a.jsx("option",{value:J.value,children:J.label},re))]})}):a.jsx(ri,{autoFocus:!0,fullWidth:!0,size:"small",variant:"outlined",value:b||"",onChange:J=>y(J.target.value),inputProps:{style:{textAlign:A?"center":"left"}},onKeyDown:Z,onBlur:M,sx:{margin:"-8px 0"}}):e})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var j2={};j2.version="0.18.5";var pR=1252,mK=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],J6={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Q6=function(e){mK.indexOf(e)!=-1&&(pR=J6[0]=e)};function gK(){Q6(1252)}var qc=function(e){Q6(e)};function e_(){qc(1200),gK()}function DA(e){for(var r=[],t=0,n=e.length;t<n;++t)r[t]=e.charCodeAt(t);return r}function vK(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function mR(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var Q1=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?vK(e.slice(2)):r==254&&t==255?mR(e.slice(2)):r==65279?e.slice(1):e},jy=function(r){return String.fromCharCode(r)},IA=function(r){return String.fromCharCode(r)},DS,Pf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ov(e){for(var r="",t=0,n=0,s=0,o=0,i=0,c=0,u=0,l=0;l<e.length;)t=e.charCodeAt(l++),o=t>>2,n=e.charCodeAt(l++),i=(t&3)<<4|n>>4,s=e.charCodeAt(l++),c=(n&15)<<2|s>>6,u=s&63,isNaN(n)?c=u=64:isNaN(s)&&(u=64),r+=Pf.charAt(o)+Pf.charAt(i)+Pf.charAt(c)+Pf.charAt(u);return r}function Wl(e){var r="",t=0,n=0,s=0,o=0,i=0,c=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)o=Pf.indexOf(e.charAt(l++)),i=Pf.indexOf(e.charAt(l++)),t=o<<2|i>>4,r+=String.fromCharCode(t),c=Pf.indexOf(e.charAt(l++)),n=(i&15)<<4|c>>2,c!==64&&(r+=String.fromCharCode(n)),u=Pf.indexOf(e.charAt(l++)),s=(c&3)<<6|u,u!==64&&(r+=String.fromCharCode(s));return r}var ma=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),zd=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function Uf(e){return ma?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function OA(e){return ma?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var $l=function(r){return ma?zd(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function Mw(e){if(typeof ArrayBuffer>"u")return $l(e);for(var r=new ArrayBuffer(e.length),t=new Uint8Array(r),n=0;n!=e.length;++n)t[n]=e.charCodeAt(n)&255;return r}function th(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function xK(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function t_(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return t_(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var Vi=ma?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:zd(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),s=0;for(r=0,t=0;r<e.length;t+=s,++r)if(s=e[r].length,e[r]instanceof Uint8Array)n.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";n.set(new Uint8Array(e[r]),t)}return n}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function bK(e){for(var r=[],t=0,n=e.length+250,s=Uf(e.length+255),o=0;o<e.length;++o){var i=e.charCodeAt(o);if(i<128)s[t++]=i;else if(i<2048)s[t++]=192|i>>6&31,s[t++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var c=e.charCodeAt(++o)&1023;s[t++]=240|i>>8&7,s[t++]=128|i>>2&63,s[t++]=128|c>>6&15|(i&3)<<4,s[t++]=128|c&63}else s[t++]=224|i>>12&15,s[t++]=128|i>>6&63,s[t++]=128|i&63;t>n&&(r.push(s.slice(0,t)),t=0,s=Uf(65535),n=65530)}return r.push(s.slice(0,t)),Vi(r)}var Ko=/\u0000/g,ev=/[\u0001-\u0006]/g;function Em(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function Gc(e,r){var t=""+e;return t.length>=r?t:ti("0",r-t.length)+t}function r_(e,r){var t=""+e;return t.length>=r?t:ti(" ",r-t.length)+t}function k2(e,r){var t=""+e;return t.length>=r?t:t+ti(" ",r-t.length)}function yK(e,r){var t=""+Math.round(e);return t.length>=r?t:ti("0",r-t.length)+t}function wK(e,r){var t=""+e;return t.length>=r?t:ti("0",r-t.length)+t}var PA=Math.pow(2,32);function xm(e,r){if(e>PA||e<-PA)return yK(e,r);var t=Math.round(e);return wK(t,r)}function R2(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var FA=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],v3=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function SK(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var On={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},BA={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},_K={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function E2(e,r,t){for(var n=e<0?-1:1,s=e*n,o=0,i=1,c=0,u=1,l=0,d=0,h=Math.floor(s);l<r&&(h=Math.floor(s),c=h*i+o,d=h*l+u,!(s-h<5e-8));)s=1/(s-h),o=i,i=c,u=l,l=d;if(d>r&&(l>r?(d=u,c=o):(d=l,c=i)),!t)return[0,n*c,d];var f=Math.floor(n*c/d);return[f,n*c-f*d,d]}function S0(e,r,t){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),o=0,i=[],c={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),r&&r.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++s==86400&&(c.T=s=0,++n,++c.D)),n===60)i=t?[1317,10,29]:[1900,2,29],o=3;else if(n===0)i=t?[1317,8,29]:[1900,1,0],o=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),i=[u.getFullYear(),u.getMonth()+1,u.getDate()],o=u.getDay(),n<60&&(o=(o+6)%7),t&&(o=EK(u,i))}return c.y=i[0],c.m=i[1],c.d=i[2],c.S=s%60,s=Math.floor(s/60),c.M=s%60,s=Math.floor(s/60),c.H=s,c.q=o,c}var gR=new Date(1899,11,31,0,0,0),AK=gR.getTime(),CK=new Date(1900,2,1,0,0,0);function vR(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=CK&&(t+=24*60*60*1e3),(t-(AK+(e.getTimezoneOffset()-gR.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function n_(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function jK(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function kK(e){var r=e<0?12:11,t=n_(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function RK(e){var r=n_(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function Pv(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=kK(e):r===10?t=e.toFixed(10).substr(0,12):t=RK(e),n_(jK(t.toUpperCase()))}function O0(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Pv(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return yc(14,vR(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function EK(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function NK(e,r,t,n){var s="",o=0,i=0,c=t.y,u,l=0;switch(e){case 98:c=t.y+543;case 121:switch(r.length){case 1:case 2:u=c%100,l=2;break;default:u=c%1e4,l=4;break}break;case 109:switch(r.length){case 1:case 2:u=t.m,l=r.length;break;case 3:return v3[t.m-1][1];case 5:return v3[t.m-1][0];default:return v3[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:u=t.d,l=r.length;break;case 3:return FA[t.q][0];default:return FA[t.q][1]}break;case 104:switch(r.length){case 1:case 2:u=1+(t.H+11)%12,l=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:u=t.H,l=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:u=t.M,l=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?Gc(t.S,r.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,o=Math.round(i*(t.S+t.u)),o>=60*i&&(o=0),r==="s"?o===0?"0":""+o/i:(s=Gc(o,2+n),r==="ss"?s.substr(0,2):"."+s.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":u=t.D*24+t.H;break;case"[m]":case"[mm]":u=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":u=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}l=r.length===3?1:2;break;case 101:u=c,l=1;break}var d=l>0?Gc(u,l):"";return d}function Ff(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var xR=/%/g;function TK(e,r,t){var n=r.replace(xR,""),s=r.length-n.length;return Nd(e,n,t*Math.pow(10,2*s))+ti("%",s)}function LK(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Nd(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function bR(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+bR(e,-r);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%s;if(o<0&&(o+=s),t=(r/Math.pow(10,o)).toPrecision(n+1+(s+o)%s),t.indexOf("e")===-1){var i=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(i-t.length+o):t+="E+"+(i-o);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,s)+"."+t.substr(2+s),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,u,l,d){return u+l+d.substr(0,(s+o)%s)+"."+d.substr(o)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var yR=/# (\?+)( ?)\/( ?)(\d+)/;function MK(e,r,t){var n=parseInt(e[4],10),s=Math.round(r*n),o=Math.floor(s/n),i=s-o*n,c=n;return t+(o===0?"":""+o)+" "+(i===0?ti(" ",e[1].length+1+e[4].length):r_(i,e[1].length)+e[2]+"/"+e[3]+Gc(c,e[4].length))}function DK(e,r,t){return t+(r===0?"":""+r)+ti(" ",e[1].length+2+e[4].length)}var wR=/^#*0*\.([0#]+)/,SR=/\).*[0#]/,_R=/\(###\) ###\\?-####/;function qo(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function zA(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function $A(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function IK(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function OK(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function oc(e,r,t){if(e.charCodeAt(0)===40&&!r.match(SR)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?oc("n",n,t):"("+oc("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return LK(e,r,t);if(r.indexOf("%")!==-1)return TK(e,r,t);if(r.indexOf("E")!==-1)return bR(r,t);if(r.charCodeAt(0)===36)return"$"+oc(e,r.substr(r.charAt(1)==" "?2:1),t);var s,o,i,c,u=Math.abs(t),l=t<0?"-":"";if(r.match(/^00+$/))return l+xm(u,r.length);if(r.match(/^[#?]+$/))return s=xm(t,0),s==="0"&&(s=""),s.length>r.length?s:qo(r.substr(0,r.length-s.length))+s;if(o=r.match(yR))return MK(o,u,l);if(r.match(/^#+0+$/))return l+xm(u,r.length-r.indexOf("0"));if(o=r.match(wR))return s=zA(t,o[1].length).replace(/^([^\.]+)$/,"$1."+qo(o[1])).replace(/\.$/,"."+qo(o[1])).replace(/\.(\d*)$/,function(v,g){return"."+g+ti("0",qo(o[1]).length-g.length)}),r.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return l+zA(u,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return l+Ff(xm(u,0));if(o=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+oc(e,r,-t):Ff(""+(Math.floor(t)+IK(t,o[1].length)))+"."+Gc($A(t,o[1].length),o[1].length);if(o=r.match(/^#,#*,#0/))return oc(e,r.replace(/^#,#*,/,""),t);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Em(oc(e,r.replace(/[\\-]/g,""),t)),i=0,Em(Em(r.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<s.length?s.charAt(i++):v==="0"?"0":""}));if(r.match(_R))return s=oc(e,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(o[4].length,7),c=E2(u,Math.pow(10,i)-1,!1),s=""+l,d=Nd("n",o[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+o[2]+"/"+o[3],d=k2(c[2],i),d.length<o[4].length&&(d=qo(o[4].substr(o[4].length-d.length))+d),s+=d,s;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(o[1].length,o[4].length),7),c=E2(u,Math.pow(10,i)-1,!0),l+(c[0]||(c[1]?"":"0"))+" "+(c[1]?r_(c[1],i)+o[2]+"/"+o[3]+k2(c[2],i):ti(" ",2*i+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return s=xm(t,0),r.length<=s.length?s:qo(r.substr(0,r.length-s.length))+s;if(o=r.match(/^([#0?]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=r.indexOf(".")-i,f=r.length-s.length-h;return qo(r.substr(0,h)+s+r.substr(r.length-f))}if(o=r.match(/^00,000\.([#0]*0)$/))return i=$A(t,o[1].length),t<0?"-"+oc(e,r,-t):Ff(OK(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Gc(0,3-v.length):"")+v})+"."+Gc(i,o[1].length);switch(r){case"###,##0.00":return oc(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var p=Ff(xm(u,0));return p!=="0"?l+p:"";case"###,###.00":return oc(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return oc(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function PK(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Nd(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function FK(e,r,t){var n=r.replace(xR,""),s=r.length-n.length;return Nd(e,n,t*Math.pow(10,2*s))+ti("%",s)}function AR(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+AR(e,-r);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%s;if(o<0&&(o+=s),t=(r/Math.pow(10,o)).toPrecision(n+1+(s+o)%s),!t.match(/[Ee]/)){var i=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(i-t.length+o):t+="E+"+(i-o),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,u,l,d){return u+l+d.substr(0,(s+o)%s)+"."+d.substr(o)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Mu(e,r,t){if(e.charCodeAt(0)===40&&!r.match(SR)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Mu("n",n,t):"("+Mu("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return PK(e,r,t);if(r.indexOf("%")!==-1)return FK(e,r,t);if(r.indexOf("E")!==-1)return AR(r,t);if(r.charCodeAt(0)===36)return"$"+Mu(e,r.substr(r.charAt(1)==" "?2:1),t);var s,o,i,c,u=Math.abs(t),l=t<0?"-":"";if(r.match(/^00+$/))return l+Gc(u,r.length);if(r.match(/^[#?]+$/))return s=""+t,t===0&&(s=""),s.length>r.length?s:qo(r.substr(0,r.length-s.length))+s;if(o=r.match(yR))return DK(o,u,l);if(r.match(/^#+0+$/))return l+Gc(u,r.length-r.indexOf("0"));if(o=r.match(wR))return s=(""+t).replace(/^([^\.]+)$/,"$1."+qo(o[1])).replace(/\.$/,"."+qo(o[1])),s=s.replace(/\.(\d*)$/,function(v,g){return"."+g+ti("0",qo(o[1]).length-g.length)}),r.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return l+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return l+Ff(""+u);if(o=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Mu(e,r,-t):Ff(""+t)+"."+ti("0",o[1].length);if(o=r.match(/^#,#*,#0/))return Mu(e,r.replace(/^#,#*,/,""),t);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Em(Mu(e,r.replace(/[\\-]/g,""),t)),i=0,Em(Em(r.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<s.length?s.charAt(i++):v==="0"?"0":""}));if(r.match(_R))return s=Mu(e,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(o[4].length,7),c=E2(u,Math.pow(10,i)-1,!1),s=""+l,d=Nd("n",o[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+o[2]+"/"+o[3],d=k2(c[2],i),d.length<o[4].length&&(d=qo(o[4].substr(o[4].length-d.length))+d),s+=d,s;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(o[1].length,o[4].length),7),c=E2(u,Math.pow(10,i)-1,!0),l+(c[0]||(c[1]?"":"0"))+" "+(c[1]?r_(c[1],i)+o[2]+"/"+o[3]+k2(c[2],i):ti(" ",2*i+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return s=""+t,r.length<=s.length?s:qo(r.substr(0,r.length-s.length))+s;if(o=r.match(/^([#0]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=r.indexOf(".")-i,f=r.length-s.length-h;return qo(r.substr(0,h)+s+r.substr(r.length-f))}if(o=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Mu(e,r,-t):Ff(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Gc(0,3-v.length):"")+v})+"."+Gc(0,o[1].length);switch(r){case"###,###":case"##,###":case"#,###":var p=Ff(""+u);return p!=="0"?l+p:"";default:if(r.match(/\.[0#?]*$/))return Mu(e,r.slice(0,r.lastIndexOf(".")),t)+qo(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Nd(e,r,t){return(t|0)===t?Mu(e,r,t):oc(e,r,t)}function BK(e){for(var r=[],t=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(s,n-s),s=n+1}if(r[r.length]=e.substr(s),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var CR=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function eg(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":R2(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="/")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match(CR))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function zK(e,r,t,n){for(var s=[],o="",i=0,c="",u="t",l,d,h,f="H";i<e.length;)switch(c=e.charAt(i)){case"G":if(!R2(e,i))throw new Error("unrecognized character "+c+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(o="";(h=e.charCodeAt(++i))!==34&&i<e.length;)o+=String.fromCharCode(h);s[s.length]={t:"t",v:o},++i;break;case"\\":var p=e.charAt(++i),v=p==="("||p===")"?p:"t";s[s.length]={t:v,v:p},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:r},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(l==null&&(l=S0(r,t,e.charAt(i+1)==="2"),l==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},u=c,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||l==null&&(l=S0(r,t),l==null))return"";for(o=c;++i<e.length&&e.charAt(i).toLowerCase()===c;)o+=c;c==="m"&&u.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=f),s[s.length]={t:c,v:o},u=c;break;case"A":case"a":case"":var g={t:c,v:c};if(l==null&&(l=S0(r,t)),e.substr(i,3).toUpperCase()==="A/P"?(l!=null&&(g.v=l.H>=12?"P":"A"),g.t="T",f="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(l!=null&&(g.v=l.H>=12?"PM":"AM"),g.t="T",i+=5,f="h"):e.substr(i,5).toUpperCase()==="/"?(l!=null&&(g.v=l.H>=12?"":""),g.t="T",i+=5,f="h"):(g.t="t",++i),l==null&&g.t==="T")return"";s[s.length]=g,u=c;break;case"[":for(o=c;e.charAt(i++)!=="]"&&i<e.length;)o+=e.charAt(i);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(CR)){if(l==null&&(l=S0(r,t),l==null))return"";s[s.length]={t:"Z",v:o.toLowerCase()},u=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",eg(e)||(s[s.length]={t:"t",v:o}));break;case".":if(l!=null){for(o=c;++i<e.length&&(c=e.charAt(i))==="0";)o+=c;s[s.length]={t:"s",v:o};break}case"0":case"#":for(o=c;++i<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(i))>-1;)o+=c;s[s.length]={t:"n",v:o};break;case"?":for(o=c;e.charAt(++i)===c;)o+=c;s[s.length]={t:c,v:o},u=c;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":c,v:c},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=c;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)o+=e.charAt(i);s[s.length]={t:"D",v:o};break;case" ":s[s.length]={t:c,v:c},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);s[s.length]={t:"t",v:c},++i;break}var m=0,b=0,y;for(i=s.length-1,u="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=f,u="h",m<1&&(m=1);break;case"s":(y=s[i].v.match(/\.0+$/))&&(b=Math.max(b,y[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":u=s[i].t;break;case"m":u==="s"&&(s[i].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&s[i].v.match(/[Hh]/)&&(m=1),m<2&&s[i].v.match(/[Mm]/)&&(m=2),m<3&&s[i].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var S="",C;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=NK(s[i].t.charCodeAt(0),s[i].v,l,b),s[i].t="t";break;case"n":case"?":for(C=i+1;s[C]!=null&&((c=s[C].t)==="?"||c==="D"||(c===" "||c==="t")&&s[C+1]!=null&&(s[C+1].t==="?"||s[C+1].t==="t"&&s[C+1].v==="/")||s[i].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(s[C].v==="/"||s[C].v===" "&&s[C+1]!=null&&s[C+1].t=="?"));)s[i].v+=s[C].v,s[C]={v:"",t:";"},++C;S+=s[i].v,i=C-1;break;case"G":s[i].t="t",s[i].v=O0(r,t);break}var L="",O,H;if(S.length>0){S.charCodeAt(0)==40?(O=r<0&&S.charCodeAt(0)===45?-r:r,H=Nd("n",S,O)):(O=r<0&&n>1?-r:r,H=Nd("n",S,O),O<0&&s[0]&&s[0].t=="t"&&(H=H.substr(1),s[0].v="-"+s[0].v)),C=H.length-1;var z=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){z=i;break}var q=s.length;if(z===s.length&&H.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(C>=s[i].v.length-1?(C-=s[i].v.length,s[i].v=H.substr(C+1,s[i].v.length)):C<0?s[i].v="":(s[i].v=H.substr(0,C+1),C=-1),s[i].t="t",q=i);C>=0&&q<s.length&&(s[q].v=H.substr(0,C+1)+s[q].v)}else if(z!==s.length&&H.indexOf("E")===-1){for(C=H.indexOf(".")-1,i=z;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(d=s[i].v.indexOf(".")>-1&&i===z?s[i].v.indexOf(".")-1:s[i].v.length-1,L=s[i].v.substr(d+1);d>=0;--d)C>=0&&(s[i].v.charAt(d)==="0"||s[i].v.charAt(d)==="#")&&(L=H.charAt(C--)+L);s[i].v=L,s[i].t="t",q=i}for(C>=0&&q<s.length&&(s[q].v=H.substr(0,C+1)+s[q].v),C=H.indexOf(".")+1,i=z;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==z)){for(d=s[i].v.indexOf(".")>-1&&i===z?s[i].v.indexOf(".")+1:0,L=s[i].v.substr(0,d);d<s[i].v.length;++d)C<H.length&&(L+=H.charAt(C++));s[i].v=L,s[i].t="t",q=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(O=n>1&&r<0&&i>0&&s[i-1].v==="-"?-r:r,s[i].v=Nd(s[i].t,s[i].v,O),s[i].t="t");var D="";for(i=0;i!==s.length;++i)s[i]!=null&&(D+=s[i].v);return D}var UA=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function HA(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function $K(e,r){var t=BK(e),n=t.length,s=t[n-1].indexOf("@");if(n<4&&s>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||s>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=s>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=s>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=s>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var o=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,o];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var i=t[0].match(UA),c=t[1].match(UA);return HA(r,i)?[n,t[0]]:HA(r,c)?[n,t[1]]:[n,t[i!=null&&c!=null?2:1]]}return[n,o]}function yc(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:On)[e],n==null&&(n=t.table&&t.table[BA[e]]||On[BA[e]]),n==null&&(n=_K[e]||"General");break}if(R2(n,0))return O0(r,t);r instanceof Date&&(r=vR(r,t.date1904));var s=$K(n,r);if(R2(s[1]))return O0(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return zK(s[1],r,t,s[0])}function Td(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(On[t]==null){r<0&&(r=t);continue}if(On[t]==e){r=t;break}}r<0&&(r=391)}return On[r]=e,r}function Dw(e){for(var r=0;r!=392;++r)e[r]!==void 0&&Td(e[r],r)}function tg(){On=SK()}var UK={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},jR=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function HK(e){var r=typeof e=="number"?On[e]:e;return r=r.replace(jR,"(\\d+)"),new RegExp("^"+r+"$")}function VK(e,r,t){var n=-1,s=-1,o=-1,i=-1,c=-1,u=-1;(r.match(jR)||[]).forEach(function(h,f){var p=parseInt(t[f+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=p;break;case"d":o=p;break;case"h":i=p;break;case"s":u=p;break;case"m":i>=0?c=p:s=p;break}}),u>=0&&c==-1&&s>=0&&(c=s,s=-1);var l=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return i==-1&&c==-1&&u==-1?l:n==-1&&s==-1&&o==-1?d:l+"T"+d}var WK=function(){var e={};e.version="1.2.0";function r(){for(var H=0,z=new Array(256),q=0;q!=256;++q)H=q,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,z[q]=H;return typeof Int32Array<"u"?new Int32Array(z):z}var t=r();function n(H){var z=0,q=0,D=0,W=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(D=0;D!=256;++D)W[D]=H[D];for(D=0;D!=256;++D)for(q=H[D],z=256+D;z<4096;z+=256)q=W[z]=q>>>8^H[q&255];var P=[];for(D=1;D!=16;++D)P[D-1]=typeof Int32Array<"u"?W.subarray(D*256,D*256+256):W.slice(D*256,D*256+256);return P}var s=n(t),o=s[0],i=s[1],c=s[2],u=s[3],l=s[4],d=s[5],h=s[6],f=s[7],p=s[8],v=s[9],g=s[10],m=s[11],b=s[12],y=s[13],S=s[14];function C(H,z){for(var q=z^-1,D=0,W=H.length;D<W;)q=q>>>8^t[(q^H.charCodeAt(D++))&255];return~q}function L(H,z){for(var q=z^-1,D=H.length-15,W=0;W<D;)q=S[H[W++]^q&255]^y[H[W++]^q>>8&255]^b[H[W++]^q>>16&255]^m[H[W++]^q>>>24]^g[H[W++]]^v[H[W++]]^p[H[W++]]^f[H[W++]]^h[H[W++]]^d[H[W++]]^l[H[W++]]^u[H[W++]]^c[H[W++]]^i[H[W++]]^o[H[W++]]^t[H[W++]];for(D+=15;W<D;)q=q>>>8^t[(q^H[W++])&255];return~q}function O(H,z){for(var q=z^-1,D=0,W=H.length,P=0,I=0;D<W;)P=H.charCodeAt(D++),P<128?q=q>>>8^t[(q^P)&255]:P<2048?(q=q>>>8^t[(q^(192|P>>6&31))&255],q=q>>>8^t[(q^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,I=H.charCodeAt(D++)&1023,q=q>>>8^t[(q^(240|P>>8&7))&255],q=q>>>8^t[(q^(128|P>>2&63))&255],q=q>>>8^t[(q^(128|I>>6&15|(P&3)<<4))&255],q=q>>>8^t[(q^(128|I&63))&255]):(q=q>>>8^t[(q^(224|P>>12&15))&255],q=q>>>8^t[(q^(128|P>>6&63))&255],q=q>>>8^t[(q^(128|P&63))&255]);return~q}return e.table=t,e.bstr=C,e.buf=L,e.str=O,e}(),An=function(){var r={};r.version="1.2.1";function t(xe,Oe){for(var Ce=xe.split("/"),de=Oe.split("/"),be=0,Se=0,Ne=Math.min(Ce.length,de.length);be<Ne;++be){if(Se=Ce[be].length-de[be].length)return Se;if(Ce[be]!=de[be])return Ce[be]<de[be]?-1:1}return Ce.length-de.length}function n(xe){if(xe.charAt(xe.length-1)=="/")return xe.slice(0,-1).indexOf("/")===-1?xe:n(xe.slice(0,-1));var Oe=xe.lastIndexOf("/");return Oe===-1?xe:xe.slice(0,Oe+1)}function s(xe){if(xe.charAt(xe.length-1)=="/")return s(xe.slice(0,-1));var Oe=xe.lastIndexOf("/");return Oe===-1?xe:xe.slice(Oe+1)}function o(xe,Oe){typeof Oe=="string"&&(Oe=new Date(Oe));var Ce=Oe.getHours();Ce=Ce<<6|Oe.getMinutes(),Ce=Ce<<5|Oe.getSeconds()>>>1,xe.write_shift(2,Ce);var de=Oe.getFullYear()-1980;de=de<<4|Oe.getMonth()+1,de=de<<5|Oe.getDate(),xe.write_shift(2,de)}function i(xe){var Oe=xe.read_shift(2)&65535,Ce=xe.read_shift(2)&65535,de=new Date,be=Ce&31;Ce>>>=5;var Se=Ce&15;Ce>>>=4,de.setMilliseconds(0),de.setFullYear(Ce+1980),de.setMonth(Se-1),de.setDate(be);var Ne=Oe&31;Oe>>>=5;var ze=Oe&63;return Oe>>>=6,de.setHours(Oe),de.setMinutes(ze),de.setSeconds(Ne<<1),de}function c(xe){oo(xe,0);for(var Oe={},Ce=0;xe.l<=xe.length-4;){var de=xe.read_shift(2),be=xe.read_shift(2),Se=xe.l+be,Ne={};switch(de){case 21589:Ce=xe.read_shift(1),Ce&1&&(Ne.mtime=xe.read_shift(4)),be>5&&(Ce&2&&(Ne.atime=xe.read_shift(4)),Ce&4&&(Ne.ctime=xe.read_shift(4))),Ne.mtime&&(Ne.mt=new Date(Ne.mtime*1e3));break}xe.l=Se,Oe[de]=Ne}return Oe}var u;function l(){return u||(u={})}function d(xe,Oe){if(xe[0]==80&&xe[1]==75)return kt(xe,Oe);if((xe[0]|32)==109&&(xe[1]|32)==105)return Dt(xe,Oe);if(xe.length<512)throw new Error("CFB file size "+xe.length+" < 512");var Ce=3,de=512,be=0,Se=0,Ne=0,ze=0,Re=0,Ie=[],ae=xe.slice(0,512);oo(ae,0);var we=h(ae);switch(Ce=we[0],Ce){case 3:de=512;break;case 4:de=4096;break;case 0:if(we[1]==0)return kt(xe,Oe);default:throw new Error("Major Version: Expected 3 or 4 saw "+Ce)}de!==512&&(ae=xe.slice(0,de),oo(ae,28));var Fe=xe.slice(0,de);f(ae,Ce);var Ye=ae.read_shift(4,"i");if(Ce===3&&Ye!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ye);ae.l+=4,Ne=ae.read_shift(4,"i"),ae.l+=4,ae.chk("00100000","Mini Stream Cutoff Size: "),ze=ae.read_shift(4,"i"),be=ae.read_shift(4,"i"),Re=ae.read_shift(4,"i"),Se=ae.read_shift(4,"i");for(var me=-1,Be=0;Be<109&&(me=ae.read_shift(4,"i"),!(me<0));++Be)Ie[Be]=me;var Ge=p(xe,de);m(Re,Se,Ge,de,Ie);var mt=y(Ge,Ne,Ie,de);mt[Ne].name="!Directory",be>0&&ze!==I&&(mt[ze].name="!MiniFAT"),mt[Ie[0]].name="!FAT",mt.fat_addrs=Ie,mt.ssz=de;var _t={},ot=[],xt=[],zt=[];S(Ne,mt,Ge,ot,be,_t,xt,ze),v(xt,zt,ot),ot.shift();var Vt={FileIndex:xt,FullPaths:zt};return Oe&&Oe.raw&&(Vt.raw={header:Fe,sectors:Ge}),Vt}function h(xe){if(xe[xe.l]==80&&xe[xe.l+1]==75)return[0,0];xe.chk(U,"Header Signature: "),xe.l+=16;var Oe=xe.read_shift(2,"u");return[xe.read_shift(2,"u"),Oe]}function f(xe,Oe){var Ce=9;switch(xe.l+=2,Ce=xe.read_shift(2)){case 9:if(Oe!=3)throw new Error("Sector Shift: Expected 9 saw "+Ce);break;case 12:if(Oe!=4)throw new Error("Sector Shift: Expected 12 saw "+Ce);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Ce)}xe.chk("0600","Mini Sector Shift: "),xe.chk("000000000000","Reserved: ")}function p(xe,Oe){for(var Ce=Math.ceil(xe.length/Oe)-1,de=[],be=1;be<Ce;++be)de[be-1]=xe.slice(be*Oe,(be+1)*Oe);return de[Ce-1]=xe.slice(Ce*Oe),de}function v(xe,Oe,Ce){for(var de=0,be=0,Se=0,Ne=0,ze=0,Re=Ce.length,Ie=[],ae=[];de<Re;++de)Ie[de]=ae[de]=de,Oe[de]=Ce[de];for(;ze<ae.length;++ze)de=ae[ze],be=xe[de].L,Se=xe[de].R,Ne=xe[de].C,Ie[de]===de&&(be!==-1&&Ie[be]!==be&&(Ie[de]=Ie[be]),Se!==-1&&Ie[Se]!==Se&&(Ie[de]=Ie[Se])),Ne!==-1&&(Ie[Ne]=de),be!==-1&&de!=Ie[de]&&(Ie[be]=Ie[de],ae.lastIndexOf(be)<ze&&ae.push(be)),Se!==-1&&de!=Ie[de]&&(Ie[Se]=Ie[de],ae.lastIndexOf(Se)<ze&&ae.push(Se));for(de=1;de<Re;++de)Ie[de]===de&&(Se!==-1&&Ie[Se]!==Se?Ie[de]=Ie[Se]:be!==-1&&Ie[be]!==be&&(Ie[de]=Ie[be]));for(de=1;de<Re;++de)if(xe[de].type!==0){if(ze=de,ze!=Ie[ze])do ze=Ie[ze],Oe[de]=Oe[ze]+"/"+Oe[de];while(ze!==0&&Ie[ze]!==-1&&ze!=Ie[ze]);Ie[de]=-1}for(Oe[0]+="/",de=1;de<Re;++de)xe[de].type!==2&&(Oe[de]+="/")}function g(xe,Oe,Ce){for(var de=xe.start,be=xe.size,Se=[],Ne=de;Ce&&be>0&&Ne>=0;)Se.push(Oe.slice(Ne*P,Ne*P+P)),be-=P,Ne=v0(Ce,Ne*4);return Se.length===0?dr(0):Vi(Se).slice(0,xe.size)}function m(xe,Oe,Ce,de,be){var Se=I;if(xe===I){if(Oe!==0)throw new Error("DIFAT chain shorter than expected")}else if(xe!==-1){var Ne=Ce[xe],ze=(de>>>2)-1;if(!Ne)return;for(var Re=0;Re<ze&&(Se=v0(Ne,Re*4))!==I;++Re)be.push(Se);m(v0(Ne,de-4),Oe-1,Ce,de,be)}}function b(xe,Oe,Ce,de,be){var Se=[],Ne=[];be||(be=[]);var ze=de-1,Re=0,Ie=0;for(Re=Oe;Re>=0;){be[Re]=!0,Se[Se.length]=Re,Ne.push(xe[Re]);var ae=Ce[Math.floor(Re*4/de)];if(Ie=Re*4&ze,de<4+Ie)throw new Error("FAT boundary crossed: "+Re+" 4 "+de);if(!xe[ae])break;Re=v0(xe[ae],Ie)}return{nodes:Se,data:tC([Ne])}}function y(xe,Oe,Ce,de){var be=xe.length,Se=[],Ne=[],ze=[],Re=[],Ie=de-1,ae=0,we=0,Fe=0,Ye=0;for(ae=0;ae<be;++ae)if(ze=[],Fe=ae+Oe,Fe>=be&&(Fe-=be),!Ne[Fe]){Re=[];var me=[];for(we=Fe;we>=0;){me[we]=!0,Ne[we]=!0,ze[ze.length]=we,Re.push(xe[we]);var Be=Ce[Math.floor(we*4/de)];if(Ye=we*4&Ie,de<4+Ye)throw new Error("FAT boundary crossed: "+we+" 4 "+de);if(!xe[Be]||(we=v0(xe[Be],Ye),me[we]))break}Se[Fe]={nodes:ze,data:tC([Re])}}return Se}function S(xe,Oe,Ce,de,be,Se,Ne,ze){for(var Re=0,Ie=de.length?2:0,ae=Oe[xe].data,we=0,Fe=0,Ye;we<ae.length;we+=128){var me=ae.slice(we,we+128);oo(me,64),Fe=me.read_shift(2),Ye=u_(me,0,Fe-Ie),de.push(Ye);var Be={name:Ye,type:me.read_shift(1),color:me.read_shift(1),L:me.read_shift(4,"i"),R:me.read_shift(4,"i"),C:me.read_shift(4,"i"),clsid:me.read_shift(16),state:me.read_shift(4,"i"),start:0,size:0},Ge=me.read_shift(2)+me.read_shift(2)+me.read_shift(2)+me.read_shift(2);Ge!==0&&(Be.ct=C(me,me.l-8));var mt=me.read_shift(2)+me.read_shift(2)+me.read_shift(2)+me.read_shift(2);mt!==0&&(Be.mt=C(me,me.l-8)),Be.start=me.read_shift(4,"i"),Be.size=me.read_shift(4,"i"),Be.size<0&&Be.start<0&&(Be.size=Be.type=0,Be.start=I,Be.name=""),Be.type===5?(Re=Be.start,be>0&&Re!==I&&(Oe[Re].name="!StreamData")):Be.size>=4096?(Be.storage="fat",Oe[Be.start]===void 0&&(Oe[Be.start]=b(Ce,Be.start,Oe.fat_addrs,Oe.ssz)),Oe[Be.start].name=Be.name,Be.content=Oe[Be.start].data.slice(0,Be.size)):(Be.storage="minifat",Be.size<0?Be.size=0:Re!==I&&Be.start!==I&&Oe[Re]&&(Be.content=g(Be,Oe[Re].data,(Oe[ze]||{}).data))),Be.content&&oo(Be.content,0),Se[Ye]=Be,Ne.push(Be)}}function C(xe,Oe){return new Date((Fl(xe,Oe+4)/1e7*Math.pow(2,32)+Fl(xe,Oe)/1e7-11644473600)*1e3)}function L(xe,Oe){return l(),d(u.readFileSync(xe),Oe)}function O(xe,Oe){var Ce=Oe&&Oe.type;switch(Ce||ma&&Buffer.isBuffer(xe)&&(Ce="buffer"),Ce||"base64"){case"file":return L(xe,Oe);case"base64":return d($l(Wl(xe)),Oe);case"binary":return d($l(xe),Oe)}return d(xe,Oe)}function H(xe,Oe){var Ce=Oe||{},de=Ce.root||"Root Entry";if(xe.FullPaths||(xe.FullPaths=[]),xe.FileIndex||(xe.FileIndex=[]),xe.FullPaths.length!==xe.FileIndex.length)throw new Error("inconsistent CFB structure");xe.FullPaths.length===0&&(xe.FullPaths[0]=de+"/",xe.FileIndex[0]={name:de,type:5}),Ce.CLSID&&(xe.FileIndex[0].clsid=Ce.CLSID),z(xe)}function z(xe){var Oe="Sh33tJ5";if(!An.find(xe,"/"+Oe)){var Ce=dr(4);Ce[0]=55,Ce[1]=Ce[3]=50,Ce[2]=54,xe.FileIndex.push({name:Oe,type:2,content:Ce,size:4,L:69,R:69,C:69}),xe.FullPaths.push(xe.FullPaths[0]+Oe),q(xe)}}function q(xe,Oe){H(xe);for(var Ce=!1,de=!1,be=xe.FullPaths.length-1;be>=0;--be){var Se=xe.FileIndex[be];switch(Se.type){case 0:de?Ce=!0:(xe.FileIndex.pop(),xe.FullPaths.pop());break;case 1:case 2:case 5:de=!0,isNaN(Se.R*Se.L*Se.C)&&(Ce=!0),Se.R>-1&&Se.L>-1&&Se.R==Se.L&&(Ce=!0);break;default:Ce=!0;break}}if(!(!Ce&&!Oe)){var Ne=new Date(1987,1,19),ze=0,Re=Object.create?Object.create(null):{},Ie=[];for(be=0;be<xe.FullPaths.length;++be)Re[xe.FullPaths[be]]=!0,xe.FileIndex[be].type!==0&&Ie.push([xe.FullPaths[be],xe.FileIndex[be]]);for(be=0;be<Ie.length;++be){var ae=n(Ie[be][0]);de=Re[ae],de||(Ie.push([ae,{name:s(ae).replace("/",""),type:1,clsid:_,ct:Ne,mt:Ne,content:null}]),Re[ae]=!0)}for(Ie.sort(function(Ye,me){return t(Ye[0],me[0])}),xe.FullPaths=[],xe.FileIndex=[],be=0;be<Ie.length;++be)xe.FullPaths[be]=Ie[be][0],xe.FileIndex[be]=Ie[be][1];for(be=0;be<Ie.length;++be){var we=xe.FileIndex[be],Fe=xe.FullPaths[be];if(we.name=s(Fe).replace("/",""),we.L=we.R=we.C=-(we.color=1),we.size=we.content?we.content.length:0,we.start=0,we.clsid=we.clsid||_,be===0)we.C=Ie.length>1?1:-1,we.size=0,we.type=5;else if(Fe.slice(-1)=="/"){for(ze=be+1;ze<Ie.length&&n(xe.FullPaths[ze])!=Fe;++ze);for(we.C=ze>=Ie.length?-1:ze,ze=be+1;ze<Ie.length&&n(xe.FullPaths[ze])!=n(Fe);++ze);we.R=ze>=Ie.length?-1:ze,we.type=1}else n(xe.FullPaths[be+1]||"")==n(Fe)&&(we.R=be+1),we.type=2}}}function D(xe,Oe){var Ce=Oe||{};if(Ce.fileType=="mad")return je(xe,Ce);switch(q(xe),Ce.fileType){case"zip":return Jt(xe,Ce)}var de=function(Ye){for(var me=0,Be=0,Ge=0;Ge<Ye.FileIndex.length;++Ge){var mt=Ye.FileIndex[Ge];if(mt.content){var _t=mt.content.length;_t>0&&(_t<4096?me+=_t+63>>6:Be+=_t+511>>9)}}for(var ot=Ye.FullPaths.length+3>>2,xt=me+7>>3,zt=me+127>>7,Vt=xt+Be+ot+zt,Ar=Vt+127>>7,wr=Ar<=109?0:Math.ceil((Ar-109)/127);Vt+Ar+wr+127>>7>Ar;)wr=++Ar<=109?0:Math.ceil((Ar-109)/127);var Nr=[1,wr,Ar,zt,ot,Be,me,0];return Ye.FileIndex[0].size=me<<6,Nr[7]=(Ye.FileIndex[0].start=Nr[0]+Nr[1]+Nr[2]+Nr[3]+Nr[4]+Nr[5])+(Nr[6]+7>>3),Nr}(xe),be=dr(de[7]<<9),Se=0,Ne=0;{for(Se=0;Se<8;++Se)be.write_shift(1,k[Se]);for(Se=0;Se<8;++Se)be.write_shift(2,0);for(be.write_shift(2,62),be.write_shift(2,3),be.write_shift(2,65534),be.write_shift(2,9),be.write_shift(2,6),Se=0;Se<3;++Se)be.write_shift(2,0);for(be.write_shift(4,0),be.write_shift(4,de[2]),be.write_shift(4,de[0]+de[1]+de[2]+de[3]-1),be.write_shift(4,0),be.write_shift(4,4096),be.write_shift(4,de[3]?de[0]+de[1]+de[2]-1:I),be.write_shift(4,de[3]),be.write_shift(-4,de[1]?de[0]-1:I),be.write_shift(4,de[1]),Se=0;Se<109;++Se)be.write_shift(-4,Se<de[2]?de[1]+Se:-1)}if(de[1])for(Ne=0;Ne<de[1];++Ne){for(;Se<236+Ne*127;++Se)be.write_shift(-4,Se<de[2]?de[1]+Se:-1);be.write_shift(-4,Ne===de[1]-1?I:Ne+1)}var ze=function(Ye){for(Ne+=Ye;Se<Ne-1;++Se)be.write_shift(-4,Se+1);Ye&&(++Se,be.write_shift(-4,I))};for(Ne=Se=0,Ne+=de[1];Se<Ne;++Se)be.write_shift(-4,R.DIFSECT);for(Ne+=de[2];Se<Ne;++Se)be.write_shift(-4,R.FATSECT);ze(de[3]),ze(de[4]);for(var Re=0,Ie=0,ae=xe.FileIndex[0];Re<xe.FileIndex.length;++Re)ae=xe.FileIndex[Re],ae.content&&(Ie=ae.content.length,!(Ie<4096)&&(ae.start=Ne,ze(Ie+511>>9)));for(ze(de[6]+7>>3);be.l&511;)be.write_shift(-4,R.ENDOFCHAIN);for(Ne=Se=0,Re=0;Re<xe.FileIndex.length;++Re)ae=xe.FileIndex[Re],ae.content&&(Ie=ae.content.length,!(!Ie||Ie>=4096)&&(ae.start=Ne,ze(Ie+63>>6)));for(;be.l&511;)be.write_shift(-4,R.ENDOFCHAIN);for(Se=0;Se<de[4]<<2;++Se){var we=xe.FullPaths[Se];if(!we||we.length===0){for(Re=0;Re<17;++Re)be.write_shift(4,0);for(Re=0;Re<3;++Re)be.write_shift(4,-1);for(Re=0;Re<12;++Re)be.write_shift(4,0);continue}ae=xe.FileIndex[Se],Se===0&&(ae.start=ae.size?ae.start-1:I);var Fe=Se===0&&Ce.root||ae.name;if(Ie=2*(Fe.length+1),be.write_shift(64,Fe,"utf16le"),be.write_shift(2,Ie),be.write_shift(1,ae.type),be.write_shift(1,ae.color),be.write_shift(-4,ae.L),be.write_shift(-4,ae.R),be.write_shift(-4,ae.C),ae.clsid)be.write_shift(16,ae.clsid,"hex");else for(Re=0;Re<4;++Re)be.write_shift(4,0);be.write_shift(4,ae.state||0),be.write_shift(4,0),be.write_shift(4,0),be.write_shift(4,0),be.write_shift(4,0),be.write_shift(4,ae.start),be.write_shift(4,ae.size),be.write_shift(4,0)}for(Se=1;Se<xe.FileIndex.length;++Se)if(ae=xe.FileIndex[Se],ae.size>=4096)if(be.l=ae.start+1<<9,ma&&Buffer.isBuffer(ae.content))ae.content.copy(be,be.l,0,ae.size),be.l+=ae.size+511&-512;else{for(Re=0;Re<ae.size;++Re)be.write_shift(1,ae.content[Re]);for(;Re&511;++Re)be.write_shift(1,0)}for(Se=1;Se<xe.FileIndex.length;++Se)if(ae=xe.FileIndex[Se],ae.size>0&&ae.size<4096)if(ma&&Buffer.isBuffer(ae.content))ae.content.copy(be,be.l,0,ae.size),be.l+=ae.size+63&-64;else{for(Re=0;Re<ae.size;++Re)be.write_shift(1,ae.content[Re]);for(;Re&63;++Re)be.write_shift(1,0)}if(ma)be.l=be.length;else for(;be.l<be.length;)be.write_shift(1,0);return be}function W(xe,Oe){var Ce=xe.FullPaths.map(function(Re){return Re.toUpperCase()}),de=Ce.map(function(Re){var Ie=Re.split("/");return Ie[Ie.length-(Re.slice(-1)=="/"?2:1)]}),be=!1;Oe.charCodeAt(0)===47?(be=!0,Oe=Ce[0].slice(0,-1)+Oe):be=Oe.indexOf("/")!==-1;var Se=Oe.toUpperCase(),Ne=be===!0?Ce.indexOf(Se):de.indexOf(Se);if(Ne!==-1)return xe.FileIndex[Ne];var ze=!Se.match(ev);for(Se=Se.replace(Ko,""),ze&&(Se=Se.replace(ev,"!")),Ne=0;Ne<Ce.length;++Ne)if((ze?Ce[Ne].replace(ev,"!"):Ce[Ne]).replace(Ko,"")==Se||(ze?de[Ne].replace(ev,"!"):de[Ne]).replace(Ko,"")==Se)return xe.FileIndex[Ne];return null}var P=64,I=-2,U="d0cf11e0a1b11ae1",k=[208,207,17,224,161,177,26,225],_="00000000000000000000000000000000",R={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:I,FREESECT:-1,HEADER_SIGNATURE:U,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:_,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function j(xe,Oe,Ce){l();var de=D(xe,Ce);u.writeFileSync(Oe,de)}function A(xe){for(var Oe=new Array(xe.length),Ce=0;Ce<xe.length;++Ce)Oe[Ce]=String.fromCharCode(xe[Ce]);return Oe.join("")}function N(xe,Oe){var Ce=D(xe,Oe);switch(Oe&&Oe.type||"buffer"){case"file":return l(),u.writeFileSync(Oe.filename,Ce),Ce;case"binary":return typeof Ce=="string"?Ce:A(Ce);case"base64":return Ov(typeof Ce=="string"?Ce:A(Ce));case"buffer":if(ma)return Buffer.isBuffer(Ce)?Ce:zd(Ce);case"array":return typeof Ce=="string"?$l(Ce):Ce}return Ce}var V;function M(xe){try{var Oe=xe.InflateRaw,Ce=new Oe;if(Ce._processChunk(new Uint8Array([3,0]),Ce._finishFlushFlag),Ce.bytesRead)V=xe;else throw new Error("zlib does not expose bytesRead")}catch(de){console.error("cannot use native zlib: "+(de.message||de))}}function Z(xe,Oe){if(!V)return Ht(xe,Oe);var Ce=V.InflateRaw,de=new Ce,be=de._processChunk(xe.slice(xe.l),de._finishFlushFlag);return xe.l+=de.bytesRead,be}function J(xe){return V?V.deflateRawSync(xe):Bt(xe)}var re=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ne=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Y(xe){var Oe=(xe<<1|xe<<11)&139536|(xe<<5|xe<<15)&558144;return(Oe>>16|Oe>>8|Oe)&255}for(var K=typeof Uint8Array<"u",ee=K?new Uint8Array(256):[],ue=0;ue<256;++ue)ee[ue]=Y(ue);function se(xe,Oe){var Ce=ee[xe&255];return Oe<=8?Ce>>>8-Oe:(Ce=Ce<<8|ee[xe>>8&255],Oe<=16?Ce>>>16-Oe:(Ce=Ce<<8|ee[xe>>16&255],Ce>>>24-Oe))}function ce(xe,Oe){var Ce=Oe&7,de=Oe>>>3;return(xe[de]|(Ce<=6?0:xe[de+1]<<8))>>>Ce&3}function fe(xe,Oe){var Ce=Oe&7,de=Oe>>>3;return(xe[de]|(Ce<=5?0:xe[de+1]<<8))>>>Ce&7}function ve(xe,Oe){var Ce=Oe&7,de=Oe>>>3;return(xe[de]|(Ce<=4?0:xe[de+1]<<8))>>>Ce&15}function _e(xe,Oe){var Ce=Oe&7,de=Oe>>>3;return(xe[de]|(Ce<=3?0:xe[de+1]<<8))>>>Ce&31}function le(xe,Oe){var Ce=Oe&7,de=Oe>>>3;return(xe[de]|(Ce<=1?0:xe[de+1]<<8))>>>Ce&127}function ke(xe,Oe,Ce){var de=Oe&7,be=Oe>>>3,Se=(1<<Ce)-1,Ne=xe[be]>>>de;return Ce<8-de||(Ne|=xe[be+1]<<8-de,Ce<16-de)||(Ne|=xe[be+2]<<16-de,Ce<24-de)||(Ne|=xe[be+3]<<24-de),Ne&Se}function Te(xe,Oe,Ce){var de=Oe&7,be=Oe>>>3;return de<=5?xe[be]|=(Ce&7)<<de:(xe[be]|=Ce<<de&255,xe[be+1]=(Ce&7)>>8-de),Oe+3}function pe(xe,Oe,Ce){var de=Oe&7,be=Oe>>>3;return Ce=(Ce&1)<<de,xe[be]|=Ce,Oe+1}function ye(xe,Oe,Ce){var de=Oe&7,be=Oe>>>3;return Ce<<=de,xe[be]|=Ce&255,Ce>>>=8,xe[be+1]=Ce,Oe+8}function ge(xe,Oe,Ce){var de=Oe&7,be=Oe>>>3;return Ce<<=de,xe[be]|=Ce&255,Ce>>>=8,xe[be+1]=Ce&255,xe[be+2]=Ce>>>8,Oe+16}function De(xe,Oe){var Ce=xe.length,de=2*Ce>Oe?2*Ce:Oe+5,be=0;if(Ce>=Oe)return xe;if(ma){var Se=OA(de);if(xe.copy)xe.copy(Se);else for(;be<xe.length;++be)Se[be]=xe[be];return Se}else if(K){var Ne=new Uint8Array(de);if(Ne.set)Ne.set(xe);else for(;be<Ce;++be)Ne[be]=xe[be];return Ne}return xe.length=de,xe}function He(xe){for(var Oe=new Array(xe),Ce=0;Ce<xe;++Ce)Oe[Ce]=0;return Oe}function Xe(xe,Oe,Ce){var de=1,be=0,Se=0,Ne=0,ze=0,Re=xe.length,Ie=K?new Uint16Array(32):He(32);for(Se=0;Se<32;++Se)Ie[Se]=0;for(Se=Re;Se<Ce;++Se)xe[Se]=0;Re=xe.length;var ae=K?new Uint16Array(Re):He(Re);for(Se=0;Se<Re;++Se)Ie[be=xe[Se]]++,de<be&&(de=be),ae[Se]=0;for(Ie[0]=0,Se=1;Se<=de;++Se)Ie[Se+16]=ze=ze+Ie[Se-1]<<1;for(Se=0;Se<Re;++Se)ze=xe[Se],ze!=0&&(ae[Se]=Ie[ze+16]++);var we=0;for(Se=0;Se<Re;++Se)if(we=xe[Se],we!=0)for(ze=se(ae[Se],de)>>de-we,Ne=(1<<de+4-we)-1;Ne>=0;--Ne)Oe[ze|Ne<<we]=we&15|Se<<4;return de}var at=K?new Uint16Array(512):He(512),dt=K?new Uint16Array(32):He(32);if(!K){for(var wt=0;wt<512;++wt)at[wt]=0;for(wt=0;wt<32;++wt)dt[wt]=0}(function(){for(var xe=[],Oe=0;Oe<32;Oe++)xe.push(5);Xe(xe,dt,32);var Ce=[];for(Oe=0;Oe<=143;Oe++)Ce.push(8);for(;Oe<=255;Oe++)Ce.push(9);for(;Oe<=279;Oe++)Ce.push(7);for(;Oe<=287;Oe++)Ce.push(8);Xe(Ce,at,288)})();var $t=function(){for(var Oe=K?new Uint8Array(32768):[],Ce=0,de=0;Ce<ne.length-1;++Ce)for(;de<ne[Ce+1];++de)Oe[de]=Ce;for(;de<32768;++de)Oe[de]=29;var be=K?new Uint8Array(259):[];for(Ce=0,de=0;Ce<X.length-1;++Ce)for(;de<X[Ce+1];++de)be[de]=Ce;function Se(ze,Re){for(var Ie=0;Ie<ze.length;){var ae=Math.min(65535,ze.length-Ie),we=Ie+ae==ze.length;for(Re.write_shift(1,+we),Re.write_shift(2,ae),Re.write_shift(2,~ae&65535);ae-- >0;)Re[Re.l++]=ze[Ie++]}return Re.l}function Ne(ze,Re){for(var Ie=0,ae=0,we=K?new Uint16Array(32768):[];ae<ze.length;){var Fe=Math.min(65535,ze.length-ae);if(Fe<10){for(Ie=Te(Re,Ie,+(ae+Fe==ze.length)),Ie&7&&(Ie+=8-(Ie&7)),Re.l=Ie/8|0,Re.write_shift(2,Fe),Re.write_shift(2,~Fe&65535);Fe-- >0;)Re[Re.l++]=ze[ae++];Ie=Re.l*8;continue}Ie=Te(Re,Ie,+(ae+Fe==ze.length)+2);for(var Ye=0;Fe-- >0;){var me=ze[ae];Ye=(Ye<<5^me)&32767;var Be=-1,Ge=0;if((Be=we[Ye])&&(Be|=ae&-32768,Be>ae&&(Be-=32768),Be<ae))for(;ze[Be+Ge]==ze[ae+Ge]&&Ge<250;)++Ge;if(Ge>2){me=be[Ge],me<=22?Ie=ye(Re,Ie,ee[me+1]>>1)-1:(ye(Re,Ie,3),Ie+=5,ye(Re,Ie,ee[me-23]>>5),Ie+=3);var mt=me<8?0:me-4>>2;mt>0&&(ge(Re,Ie,Ge-X[me]),Ie+=mt),me=Oe[ae-Be],Ie=ye(Re,Ie,ee[me]>>3),Ie-=3;var _t=me<4?0:me-2>>1;_t>0&&(ge(Re,Ie,ae-Be-ne[me]),Ie+=_t);for(var ot=0;ot<Ge;++ot)we[Ye]=ae&32767,Ye=(Ye<<5^ze[ae])&32767,++ae;Fe-=Ge-1}else me<=143?me=me+48:Ie=pe(Re,Ie,1),Ie=ye(Re,Ie,ee[me]),we[Ye]=ae&32767,++ae}Ie=ye(Re,Ie,0)-1}return Re.l=(Ie+7)/8|0,Re.l}return function(Re,Ie){return Re.length<8?Se(Re,Ie):Ne(Re,Ie)}}();function Bt(xe){var Oe=dr(50+Math.floor(xe.length*1.1)),Ce=$t(xe,Oe);return Oe.slice(0,Ce)}var ft=K?new Uint16Array(32768):He(32768),tr=K?new Uint16Array(32768):He(32768),Me=K?new Uint16Array(128):He(128),tt=1,Ze=1;function St(xe,Oe){var Ce=_e(xe,Oe)+257;Oe+=5;var de=_e(xe,Oe)+1;Oe+=5;var be=ve(xe,Oe)+4;Oe+=4;for(var Se=0,Ne=K?new Uint8Array(19):He(19),ze=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Re=1,Ie=K?new Uint8Array(8):He(8),ae=K?new Uint8Array(8):He(8),we=Ne.length,Fe=0;Fe<be;++Fe)Ne[re[Fe]]=Se=fe(xe,Oe),Re<Se&&(Re=Se),Ie[Se]++,Oe+=3;var Ye=0;for(Ie[0]=0,Fe=1;Fe<=Re;++Fe)ae[Fe]=Ye=Ye+Ie[Fe-1]<<1;for(Fe=0;Fe<we;++Fe)(Ye=Ne[Fe])!=0&&(ze[Fe]=ae[Ye]++);var me=0;for(Fe=0;Fe<we;++Fe)if(me=Ne[Fe],me!=0){Ye=ee[ze[Fe]]>>8-me;for(var Be=(1<<7-me)-1;Be>=0;--Be)Me[Ye|Be<<me]=me&7|Fe<<3}var Ge=[];for(Re=1;Ge.length<Ce+de;)switch(Ye=Me[le(xe,Oe)],Oe+=Ye&7,Ye>>>=3){case 16:for(Se=3+ce(xe,Oe),Oe+=2,Ye=Ge[Ge.length-1];Se-- >0;)Ge.push(Ye);break;case 17:for(Se=3+fe(xe,Oe),Oe+=3;Se-- >0;)Ge.push(0);break;case 18:for(Se=11+le(xe,Oe),Oe+=7;Se-- >0;)Ge.push(0);break;default:Ge.push(Ye),Re<Ye&&(Re=Ye);break}var mt=Ge.slice(0,Ce),_t=Ge.slice(Ce);for(Fe=Ce;Fe<286;++Fe)mt[Fe]=0;for(Fe=de;Fe<30;++Fe)_t[Fe]=0;return tt=Xe(mt,ft,286),Ze=Xe(_t,tr,30),Oe}function et(xe,Oe){if(xe[0]==3&&!(xe[1]&3))return[Uf(Oe),2];for(var Ce=0,de=0,be=OA(Oe||1<<18),Se=0,Ne=be.length>>>0,ze=0,Re=0;(de&1)==0;){if(de=fe(xe,Ce),Ce+=3,de>>>1)de>>1==1?(ze=9,Re=5):(Ce=St(xe,Ce),ze=tt,Re=Ze);else{Ce&7&&(Ce+=8-(Ce&7));var Ie=xe[Ce>>>3]|xe[(Ce>>>3)+1]<<8;if(Ce+=32,Ie>0)for(!Oe&&Ne<Se+Ie&&(be=De(be,Se+Ie),Ne=be.length);Ie-- >0;)be[Se++]=xe[Ce>>>3],Ce+=8;continue}for(;;){!Oe&&Ne<Se+32767&&(be=De(be,Se+32767),Ne=be.length);var ae=ke(xe,Ce,ze),we=de>>>1==1?at[ae]:ft[ae];if(Ce+=we&15,we>>>=4,(we>>>8&255)===0)be[Se++]=we;else{if(we==256)break;we-=257;var Fe=we<8?0:we-4>>2;Fe>5&&(Fe=0);var Ye=Se+X[we];Fe>0&&(Ye+=ke(xe,Ce,Fe),Ce+=Fe),ae=ke(xe,Ce,Re),we=de>>>1==1?dt[ae]:tr[ae],Ce+=we&15,we>>>=4;var me=we<4?0:we-2>>1,Be=ne[we];for(me>0&&(Be+=ke(xe,Ce,me),Ce+=me),!Oe&&Ne<Ye&&(be=De(be,Ye+100),Ne=be.length);Se<Ye;)be[Se]=be[Se-Be],++Se}}}return Oe?[be,Ce+7>>>3]:[be.slice(0,Se),Ce+7>>>3]}function Ht(xe,Oe){var Ce=xe.slice(xe.l||0),de=et(Ce,Oe);return xe.l+=de[1],de[0]}function Nt(xe,Oe){if(xe)typeof console<"u"&&console.error(Oe);else throw new Error(Oe)}function kt(xe,Oe){var Ce=xe;oo(Ce,0);var de=[],be=[],Se={FileIndex:de,FullPaths:be};H(Se,{root:Oe.root});for(var Ne=Ce.length-4;(Ce[Ne]!=80||Ce[Ne+1]!=75||Ce[Ne+2]!=5||Ce[Ne+3]!=6)&&Ne>=0;)--Ne;Ce.l=Ne+4,Ce.l+=4;var ze=Ce.read_shift(2);Ce.l+=6;var Re=Ce.read_shift(4);for(Ce.l=Re,Ne=0;Ne<ze;++Ne){Ce.l+=20;var Ie=Ce.read_shift(4),ae=Ce.read_shift(4),we=Ce.read_shift(2),Fe=Ce.read_shift(2),Ye=Ce.read_shift(2);Ce.l+=8;var me=Ce.read_shift(4),Be=c(Ce.slice(Ce.l+we,Ce.l+we+Fe));Ce.l+=we+Fe+Ye;var Ge=Ce.l;Ce.l=me+4,kr(Ce,Ie,ae,Se,Be),Ce.l=Ge}return Se}function kr(xe,Oe,Ce,de,be){xe.l+=2;var Se=xe.read_shift(2),Ne=xe.read_shift(2),ze=i(xe);if(Se&8257)throw new Error("Unsupported ZIP encryption");for(var Re=xe.read_shift(4),Ie=xe.read_shift(4),ae=xe.read_shift(4),we=xe.read_shift(2),Fe=xe.read_shift(2),Ye="",me=0;me<we;++me)Ye+=String.fromCharCode(xe[xe.l++]);if(Fe){var Be=c(xe.slice(xe.l,xe.l+Fe));(Be[21589]||{}).mt&&(ze=Be[21589].mt),((be||{})[21589]||{}).mt&&(ze=be[21589].mt)}xe.l+=Fe;var Ge=xe.slice(xe.l,xe.l+Ie);switch(Ne){case 8:Ge=Z(xe,ae);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ne)}var mt=!1;Se&8&&(Re=xe.read_shift(4),Re==134695760&&(Re=xe.read_shift(4),mt=!0),Ie=xe.read_shift(4),ae=xe.read_shift(4)),Ie!=Oe&&Nt(mt,"Bad compressed size: "+Oe+" != "+Ie),ae!=Ce&&Nt(mt,"Bad uncompressed size: "+Ce+" != "+ae),nt(de,Ye,Ge,{unsafe:!0,mt:ze})}function Jt(xe,Oe){var Ce=Oe||{},de=[],be=[],Se=dr(1),Ne=Ce.compression?8:0,ze=0,Re=0,Ie=0,ae=0,we=0,Fe=xe.FullPaths[0],Ye=Fe,me=xe.FileIndex[0],Be=[],Ge=0;for(Re=1;Re<xe.FullPaths.length;++Re)if(Ye=xe.FullPaths[Re].slice(Fe.length),me=xe.FileIndex[Re],!(!me.size||!me.content||Ye=="Sh33tJ5")){var mt=ae,_t=dr(Ye.length);for(Ie=0;Ie<Ye.length;++Ie)_t.write_shift(1,Ye.charCodeAt(Ie)&127);_t=_t.slice(0,_t.l),Be[we]=WK.buf(me.content,0);var ot=me.content;Ne==8&&(ot=J(ot)),Se=dr(30),Se.write_shift(4,67324752),Se.write_shift(2,20),Se.write_shift(2,ze),Se.write_shift(2,Ne),me.mt?o(Se,me.mt):Se.write_shift(4,0),Se.write_shift(-4,Be[we]),Se.write_shift(4,ot.length),Se.write_shift(4,me.content.length),Se.write_shift(2,_t.length),Se.write_shift(2,0),ae+=Se.length,de.push(Se),ae+=_t.length,de.push(_t),ae+=ot.length,de.push(ot),Se=dr(46),Se.write_shift(4,33639248),Se.write_shift(2,0),Se.write_shift(2,20),Se.write_shift(2,ze),Se.write_shift(2,Ne),Se.write_shift(4,0),Se.write_shift(-4,Be[we]),Se.write_shift(4,ot.length),Se.write_shift(4,me.content.length),Se.write_shift(2,_t.length),Se.write_shift(2,0),Se.write_shift(2,0),Se.write_shift(2,0),Se.write_shift(2,0),Se.write_shift(4,0),Se.write_shift(4,mt),Ge+=Se.l,be.push(Se),Ge+=_t.length,be.push(_t),++we}return Se=dr(22),Se.write_shift(4,101010256),Se.write_shift(2,0),Se.write_shift(2,0),Se.write_shift(2,we),Se.write_shift(2,we),Se.write_shift(4,Ge),Se.write_shift(4,ae),Se.write_shift(2,0),Vi([Vi(de),Vi(be),Se])}var Pt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ur(xe,Oe){if(xe.ctype)return xe.ctype;var Ce=xe.name||"",de=Ce.match(/\.([^\.]+)$/);return de&&Pt[de[1]]||Oe&&(de=(Ce=Oe).match(/[\.\\]([^\.\\])+$/),de&&Pt[de[1]])?Pt[de[1]]:"application/octet-stream"}function Lr(xe){for(var Oe=Ov(xe),Ce=[],de=0;de<Oe.length;de+=76)Ce.push(Oe.slice(de,de+76));return Ce.join(`\r
`)+`\r
`}function vt(xe){var Oe=xe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ie){var ae=Ie.charCodeAt(0).toString(16).toUpperCase();return"="+(ae.length==1?"0"+ae:ae)});Oe=Oe.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Oe.charAt(0)==`
`&&(Oe="=0D"+Oe.slice(1)),Oe=Oe.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Ce=[],de=Oe.split(`\r
`),be=0;be<de.length;++be){var Se=de[be];if(Se.length==0){Ce.push("");continue}for(var Ne=0;Ne<Se.length;){var ze=76,Re=Se.slice(Ne,Ne+ze);Re.charAt(ze-1)=="="?ze--:Re.charAt(ze-2)=="="?ze-=2:Re.charAt(ze-3)=="="&&(ze-=3),Re=Se.slice(Ne,Ne+ze),Ne+=ze,Ne<Se.length&&(Re+="="),Ce.push(Re)}}return Ce.join(`\r
`)}function nr(xe){for(var Oe=[],Ce=0;Ce<xe.length;++Ce){for(var de=xe[Ce];Ce<=xe.length&&de.charAt(de.length-1)=="=";)de=de.slice(0,de.length-1)+xe[++Ce];Oe.push(de)}for(var be=0;be<Oe.length;++be)Oe[be]=Oe[be].replace(/[=][0-9A-Fa-f]{2}/g,function(Se){return String.fromCharCode(parseInt(Se.slice(1),16))});return $l(Oe.join(`\r
`))}function Cr(xe,Oe,Ce){for(var de="",be="",Se="",Ne,ze=0;ze<10;++ze){var Re=Oe[ze];if(!Re||Re.match(/^\s*$/))break;var Ie=Re.match(/^(.*?):\s*([^\s].*)$/);if(Ie)switch(Ie[1].toLowerCase()){case"content-location":de=Ie[2].trim();break;case"content-type":Se=Ie[2].trim();break;case"content-transfer-encoding":be=Ie[2].trim();break}}switch(++ze,be.toLowerCase()){case"base64":Ne=$l(Wl(Oe.slice(ze).join("")));break;case"quoted-printable":Ne=nr(Oe.slice(ze));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+be)}var ae=nt(xe,de.slice(Ce.length),Ne,{unsafe:!0});Se&&(ae.ctype=Se)}function Dt(xe,Oe){if(A(xe.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Ce=Oe&&Oe.root||"",de=(ma&&Buffer.isBuffer(xe)?xe.toString("binary"):A(xe)).split(`\r
`),be=0,Se="";for(be=0;be<de.length;++be)if(Se=de[be],!!/^Content-Location:/i.test(Se)&&(Se=Se.slice(Se.indexOf("file")),Ce||(Ce=Se.slice(0,Se.lastIndexOf("/")+1)),Se.slice(0,Ce.length)!=Ce))for(;Ce.length>0&&(Ce=Ce.slice(0,Ce.length-1),Ce=Ce.slice(0,Ce.lastIndexOf("/")+1),Se.slice(0,Ce.length)!=Ce););var Ne=(de[1]||"").match(/boundary="(.*?)"/);if(!Ne)throw new Error("MAD cannot find boundary");var ze="--"+(Ne[1]||""),Re=[],Ie=[],ae={FileIndex:Re,FullPaths:Ie};H(ae);var we,Fe=0;for(be=0;be<de.length;++be){var Ye=de[be];Ye!==ze&&Ye!==ze+"--"||(Fe++&&Cr(ae,de.slice(we,be),Ce),we=be)}return ae}function je(xe,Oe){var Ce=Oe||{},de=Ce.boundary||"SheetJS";de="------="+de;for(var be=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+de.slice(2)+'"',"","",""],Se=xe.FullPaths[0],Ne=Se,ze=xe.FileIndex[0],Re=1;Re<xe.FullPaths.length;++Re)if(Ne=xe.FullPaths[Re].slice(Se.length),ze=xe.FileIndex[Re],!(!ze.size||!ze.content||Ne=="Sh33tJ5")){Ne=Ne.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ge){return"_x"+Ge.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ge){return"_u"+Ge.charCodeAt(0).toString(16)+"_"});for(var Ie=ze.content,ae=ma&&Buffer.isBuffer(Ie)?Ie.toString("binary"):A(Ie),we=0,Fe=Math.min(1024,ae.length),Ye=0,me=0;me<=Fe;++me)(Ye=ae.charCodeAt(me))>=32&&Ye<128&&++we;var Be=we>=Fe*4/5;be.push(de),be.push("Content-Location: "+(Ce.root||"file:///C:/SheetJS/")+Ne),be.push("Content-Transfer-Encoding: "+(Be?"quoted-printable":"base64")),be.push("Content-Type: "+Ur(ze,Ne)),be.push(""),be.push(Be?vt(ae):Lr(ae))}return be.push(de+`--\r
`),be.join(`\r
`)}function ct(xe){var Oe={};return H(Oe,xe),Oe}function nt(xe,Oe,Ce,de){var be=de&&de.unsafe;be||H(xe);var Se=!be&&An.find(xe,Oe);if(!Se){var Ne=xe.FullPaths[0];Oe.slice(0,Ne.length)==Ne?Ne=Oe:(Ne.slice(-1)!="/"&&(Ne+="/"),Ne=(Ne+Oe).replace("//","/")),Se={name:s(Oe),type:2},xe.FileIndex.push(Se),xe.FullPaths.push(Ne),be||An.utils.cfb_gc(xe)}return Se.content=Ce,Se.size=Ce?Ce.length:0,de&&(de.CLSID&&(Se.clsid=de.CLSID),de.mt&&(Se.mt=de.mt),de.ct&&(Se.ct=de.ct)),Se}function Pe(xe,Oe){H(xe);var Ce=An.find(xe,Oe);if(Ce){for(var de=0;de<xe.FileIndex.length;++de)if(xe.FileIndex[de]==Ce)return xe.FileIndex.splice(de,1),xe.FullPaths.splice(de,1),!0}return!1}function Qe(xe,Oe,Ce){H(xe);var de=An.find(xe,Oe);if(de){for(var be=0;be<xe.FileIndex.length;++be)if(xe.FileIndex[be]==de)return xe.FileIndex[be].name=s(Ce),xe.FullPaths[be]=Ce,!0}return!1}function gt(xe){q(xe,!0)}return r.find=W,r.read=O,r.parse=d,r.write=N,r.writeFile=j,r.utils={cfb_new:ct,cfb_add:nt,cfb_del:Pe,cfb_mov:Qe,cfb_gc:gt,ReadShift:pv,CheckField:KR,prep_blob:oo,bconcat:Vi,use_zlib:M,_deflateRaw:Bt,_inflateRaw:Ht,consts:R},r}();function qK(e){return typeof e=="string"?Mw(e):Array.isArray(e)?xK(e):e}function ux(e,r,t){if(typeof Deno<"u"){if(t&&typeof r=="string")switch(t){case"utf8":r=new TextEncoder(t).encode(r);break;case"binary":r=Mw(r);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,r)}var n=t=="utf8"?Bu(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([qK(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=o,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(e);return c.open("w"),c.encoding="binary",Array.isArray(r)&&(r=th(r)),c.write(r),c.close(),r}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+e)}function GK(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function si(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function VA(e,r){for(var t=[],n=si(e),s=0;s!==n.length;++s)t[e[n[s]][r]]==null&&(t[e[n[s]][r]]=n[s]);return t}function Iw(e){for(var r=[],t=si(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}function Ow(e){for(var r=[],t=si(e),n=0;n!==t.length;++n)r[e[t[n]]]=parseInt(t[n],10);return r}function KK(e){for(var r=[],t=si(e),n=0;n!==t.length;++n)r[e[t[n]]]==null&&(r[e[t[n]]]=[]),r[e[t[n]]].push(t[n]);return r}var N2=new Date(1899,11,30,0,0,0);function Ii(e,r){var t=e.getTime(),n=N2.getTime()+(e.getTimezoneOffset()-N2.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var kR=new Date,XK=N2.getTime()+(kR.getTimezoneOffset()-N2.getTimezoneOffset())*6e4,WA=kR.getTimezoneOffset();function Pw(e){var r=new Date;return r.setTime(e*24*60*60*1e3+XK),r.getTimezoneOffset()!==WA&&r.setTime(r.getTime()+(r.getTimezoneOffset()-WA)*6e4),r}function YK(e){var r=0,t=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=s.length;++o)if(s[o]){switch(t=1,o>3&&(n=!0),s[o].slice(s[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[o].slice(s[o].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=t*parseInt(s[o],10)}return r}var qA=new Date("2017-02-19T19:06:09.000Z"),RR=isNaN(qA.getFullYear())?new Date("2/19/17"):qA,ZK=RR.getFullYear()==2017;function Is(e,r){var t=new Date(e);if(ZK)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(RR.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return e.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function P0(e,r){if(ma&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return Bu(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Bu(mR(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return Bu(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Bu(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(o){return t[o]||o})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Os(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=Os(e[t]));return r}function ti(e,r){for(var t="";t.length<r;)t+=e;return t}function Xc(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,o){return t=-t,o}),!isNaN(r=Number(n)))?r/t:r}var JK=["january","february","march","april","may","june","july","august","september","october","november","december"];function Um(e){var r=new Date(e),t=new Date(NaN),n=r.getYear(),s=r.getMonth(),o=r.getDate();if(isNaN(o))return t;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&JK.indexOf(i)==-1)return t}else if(i.match(/[a-z]/))return t;return n<0||n>8099?t:(s>0||o>1)&&n!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var QK=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,n,s){if(e||typeof n=="string")return t.split(n);for(var o=t.split(n),i=[o[0]],c=1;c<o.length;++c)i.push(s),i.push(o[c]);return i}}();function ER(e){return e?e.content&&e.type?P0(e.content,!0):e.data?Q1(e.data):e.asNodeBuffer&&ma?Q1(e.asNodeBuffer().toString("binary")):e.asBinary?Q1(e.asBinary()):e._data&&e._data.getContent?Q1(P0(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function NR(e){if(!e)return null;if(e.data)return DA(e.data);if(e.asNodeBuffer&&ma)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?DA(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function eX(e){return e&&e.name.slice(-4)===".bin"?NR(e):ER(e)}function dc(e,r){for(var t=e.FullPaths||si(e.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),o=0;o<t.length;++o){var i=t[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return e.files?e.files[t[o]]:e.FileIndex[o]}return null}function a_(e,r){var t=dc(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function ki(e,r,t){if(!t)return eX(a_(e,r));if(!r)return null;try{return ki(e,r)}catch{return null}}function Ul(e,r,t){if(!t)return ER(a_(e,r));if(!r)return null;try{return Ul(e,r)}catch{return null}}function tX(e,r,t){return NR(a_(e,r))}function GA(e){for(var r=e.FullPaths||si(e.files),t=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&t.push(r[n].replace(/^Root Entry[\/]/,""));return t.sort()}function aa(e,r,t){if(e.FullPaths){if(typeof t=="string"){var n;return ma?n=zd(t):n=bK(t),An.utils.cfb_add(e,r,n)}An.utils.cfb_add(e,r,t)}else e.file(r,t)}function s_(){return An.utils.cfb_new()}function TR(e,r){switch(r.type){case"base64":return An.read(e,{type:"base64"});case"binary":return An.read(e,{type:"binary"});case"buffer":case"array":return An.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function tv(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?t.pop():s!=="."&&t.push(s)}return t.join("/")}var wi=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,rX=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,KA=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,nX=/<[^>]*>/g,Mo=wi.match(KA)?KA:nX,aX=/<\w*:/,sX=/<(\/?)\w+:/;function Bn(e,r,t){for(var n={},s=0,o=0;s!==e.length&&!((o=e.charCodeAt(s))===32||o===10||o===13);++s);if(r||(n[0]=e.slice(0,s)),s===e.length)return n;var i=e.match(rX),c=0,u="",l=0,d="",h="",f=1;if(i)for(l=0;l!=i.length;++l){for(h=i[l],o=0;o!=h.length&&h.charCodeAt(o)!==61;++o);for(d=h.slice(0,o).trim();h.charCodeAt(o+1)==32;)++o;for(f=(s=h.charCodeAt(o+1))==34||s==39?1:0,u=h.slice(o+1+f,h.length-f),c=0;c!=d.length&&d.charCodeAt(c)!==58;++c);if(c===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=u,n[d.toLowerCase()]=u;else{var p=(c===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(c+1);if(n[p]&&d.slice(c-3,c)=="ext")continue;n[p]=u,n[p.toLowerCase()]=u}}return n}function Xu(e){return e.replace(sX,"<$1")}var LR={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},i_=Iw(LR),Fa=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(n){var s=n+"",o=s.indexOf("<![CDATA[");if(o==-1)return s.replace(e,function(c,u){return LR[c]||String.fromCharCode(parseInt(u,c.indexOf("x")>-1?16:10))||c}).replace(r,function(c,u){return String.fromCharCode(parseInt(u,16))});var i=s.indexOf("]]>");return t(s.slice(0,o))+s.slice(o+9,i)+t(s.slice(i+3))}}(),o_=/[&<>'"]/g,iX=/[\u0000-\u0008\u000b-\u001f]/g;function os(e){var r=e+"";return r.replace(o_,function(t){return i_[t]}).replace(iX,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function XA(e){return os(e).replace(/ /g,"_x0020_")}var MR=/[\u0000-\u001f]/g;function l_(e){var r=e+"";return r.replace(o_,function(t){return i_[t]}).replace(/\n/g,"<br/>").replace(MR,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function oX(e){var r=e+"";return r.replace(o_,function(t){return i_[t]}).replace(MR,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}var YA=function(){var e=/&#(\d+);/g;function r(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,r)}}();function lX(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ds(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function x3(e){for(var r="",t=0,n=0,s=0,o=0,i=0,c=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(s=e.charCodeAt(t++),n>191&&n<224){i=(n&31)<<6,i|=s&63,r+=String.fromCharCode(i);continue}if(o=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(s&63)<<6|o&63);continue}i=e.charCodeAt(t++),c=((n&7)<<18|(s&63)<<12|(o&63)<<6|i&63)-65536,r+=String.fromCharCode(55296+(c>>>10&1023)),r+=String.fromCharCode(56320+(c&1023))}return r}function ZA(e){var r=Uf(2*e.length),t,n,s=1,o=0,i=0,c;for(n=0;n<e.length;n+=s)s=1,(c=e.charCodeAt(n))<128?t=c:c<224?(t=(c&31)*64+(e.charCodeAt(n+1)&63),s=2):c<240?(t=(c&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,t=(c&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,i=55296+(t>>>10&1023),t=56320+(t&1023)),i!==0&&(r[o++]=i&255,r[o++]=i>>>8,i=0),r[o++]=t%256,r[o++]=t>>>8;return r.slice(0,o).toString("ucs2")}function JA(e){return zd(e,"binary").toString("utf8")}var ky="foo bar baz",hs=ma&&(JA(ky)==x3(ky)&&JA||ZA(ky)==x3(ky)&&ZA)||x3,Bu=ma?function(e){return zd(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,s=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(s>>18&7))),r.push(String.fromCharCode(144+(s>>12&63))),r.push(String.fromCharCode(128+(s>>6&63))),r.push(String.fromCharCode(128+(s&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},Fv=function(){var e={};return function(t,n){var s=t+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),DR=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),cX=function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),uX=/<\/?(?:vt:)?variant>/g,dX=/<(?:vt:)([^>]*)>([\s\S]*)</;function QA(e,r){var t=Bn(e),n=e.match(cX(t.baseType))||[],s=[];if(n.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return s}return n.forEach(function(o){var i=o.replace(uX,"").match(dX);i&&s.push({v:hs(i[2]),t:i[1]})}),s}var IR=/(^\s|\s$|\n)/;function lo(e,r){return"<"+e+(r.match(IR)?' xml:space="preserve"':"")+">"+r+"</"+e+">"}function Bv(e){return si(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function zr(e,r,t){return"<"+e+(t!=null?Bv(t):"")+(r!=null?(r.match(IR)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function IS(e,r){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(r)throw t}return""}function fX(e,r){switch(typeof e){case"string":var t=zr("vt:lpwstr",os(e));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return zr((e|0)==e?"vt:i4":"vt:r8",os(String(e)));case"boolean":return zr("vt:bool",e?"true":"false")}if(e instanceof Date)return zr("vt:filetime",IS(e));throw new Error("Unable to serialize "+e)}function c_(e){if(ma&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return hs(th(t_(e)));throw new Error("Bad input format: expected Buffer or string")}var zv=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Mi={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},K0=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Pl={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function hX(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),s=e[r+6]&15,o=5;o>=0;--o)s=s*256+e[r+o];return n==2047?s==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),t*Math.pow(2,n-52)*s)}function pX(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,s=0,o=0,i=n?-r:r;isFinite(i)?i==0?s=o=0:(s=Math.floor(Math.log(i)/Math.LN2),o=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?s=-1022:(o-=Math.pow(2,52),s+=1023)):(s=2047,o=isNaN(r)?26985:0);for(var c=0;c<=5;++c,o/=256)e[t+c]=o&255;e[t+6]=(s&15)<<4|o&15,e[t+7]=s>>4|n}var eC=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,o=e[0][n].length;s<o;s+=t)r.push.apply(r,e[0][n].slice(s,s+t));return r},tC=ma?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:zd(r)})):eC(e)}:eC,rC=function(e,r,t){for(var n=[],s=r;s<t;s+=2)n.push(String.fromCharCode(Rd(e,s)));return n.join("").replace(Ko,"")},u_=ma?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(Ko,""):rC(e,r,t)}:rC,nC=function(e,r,t){for(var n=[],s=r;s<r+t;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},OR=ma?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):nC(e,r,t)}:nC,aC=function(e,r,t){for(var n=[],s=r;s<t;s++)n.push(String.fromCharCode(_m(e,s)));return n.join("")},dx=ma?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):aC(r,t,n)}:aC,PR=function(e,r){var t=Fl(e,r);return t>0?dx(e,r+4,r+4+t-1):""},FR=PR,BR=function(e,r){var t=Fl(e,r);return t>0?dx(e,r+4,r+4+t-1):""},zR=BR,$R=function(e,r){var t=2*Fl(e,r);return t>0?dx(e,r+4,r+4+t-1):""},UR=$R,HR=function(r,t){var n=Fl(r,t);return n>0?u_(r,t+4,t+4+n):""},VR=HR,WR=function(e,r){var t=Fl(e,r);return t>0?dx(e,r+4,r+4+t):""},qR=WR,GR=function(e,r){return hX(e,r)},T2=GR,d_=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};ma&&(FR=function(r,t){if(!Buffer.isBuffer(r))return PR(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},zR=function(r,t){if(!Buffer.isBuffer(r))return BR(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},UR=function(r,t){if(!Buffer.isBuffer(r))return $R(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},VR=function(r,t){if(!Buffer.isBuffer(r))return HR(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},qR=function(r,t){if(!Buffer.isBuffer(r))return WR(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},T2=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):GR(r,t)},d_=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var _m=function(e,r){return e[r]},Rd=function(e,r){return e[r+1]*256+e[r]},mX=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},Fl=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},v0=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},gX=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function pv(e,r){var t="",n,s,o=[],i,c,u,l;switch(r){case"dbcs":if(l=this.l,ma&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)t+=String.fromCharCode(Rd(this,l)),l+=2;e*=2;break;case"utf8":t=dx(this,this.l,this.l+e);break;case"utf16le":e*=2,t=u_(this,this.l,this.l+e);break;case"wstr":return pv.call(this,e,"dbcs");case"lpstr-ansi":t=FR(this,this.l),e=4+Fl(this,this.l);break;case"lpstr-cp":t=zR(this,this.l),e=4+Fl(this,this.l);break;case"lpwstr":t=UR(this,this.l),e=4+2*Fl(this,this.l);break;case"lpp4":e=4+Fl(this,this.l),t=VR(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Fl(this,this.l),t=qR(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(i=_m(this,this.l+e++))!==0;)o.push(jy(i));t=o.join("");break;case"_wstr":for(e=0,t="";(i=Rd(this,this.l+e))!==0;)o.push(jy(i)),e+=2;e+=2,t=o.join("");break;case"dbcs-cont":for(t="",l=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(l)!==-1)return i=_m(this,l),this.l=l+1,c=pv.call(this,e-u,i?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(jy(Rd(this,l))),l+=2}t=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",l=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(l)!==-1)return i=_m(this,l),this.l=l+1,c=pv.call(this,e-u,i?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(jy(_m(this,l))),l+=1}t=o.join("");break;default:switch(e){case 1:return n=_m(this,this.l),this.l++,n;case 2:return n=(r==="i"?mX:Rd)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(n=(e>0?v0:gX)(this,this.l),this.l+=4,n):(s=Fl(this,this.l),this.l+=4,s);case 8:case-8:if(r==="f")return e==8?s=T2(this,this.l):s=T2([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:t=OR(this,this.l,e);break}}return this.l+=e,t}var vX=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},xX=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},bX=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function yX(e,r,t){var n=0,s=0;if(t==="dbcs"){for(s=0;s!=r.length;++s)bX(this,r.charCodeAt(s),this.l+2*s);n=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=r.length;++s)this[this.l+s]=r.charCodeAt(s)&255;n=r.length}else if(t==="hex"){for(;s<e;++s)this[this.l++]=parseInt(r.slice(2*s,2*s+2),16)||0;return this}else if(t==="utf16le"){var o=Math.min(this.l+e,this.length);for(s=0;s<Math.min(r.length,e);++s){var i=r.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,vX(this,r,this.l);break;case 8:if(n=8,t==="f"){pX(this,r,this.l);break}case 16:break;case-4:n=4,xX(this,r,this.l);break}return this.l+=n,this}function KR(e,r){var t=OR(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function oo(e,r){e.l=r,e.read_shift=pv,e.chk=KR,e.write_shift=yX}function Lo(e,r){e.l+=r}function dr(e){var r=Uf(e);return oo(r,0),r}function $d(e,r,t){if(e){var n,s,o;oo(e,e.l||0);for(var i=e.length,c=0,u=0;e.l<i;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var l=qv[c]||qv[65535];for(n=e.read_shift(1),o=n&127,s=1;s<4&&n&128;++s)o+=((n=e.read_shift(1))&127)<<7*s;u=e.l+o;var d=l.f&&l.f(e,o,t);if(e.l=u,r(d,l,c))return}}}function ml(){var e=[],r=ma?256:2048,t=function(l){var d=dr(l);return oo(d,0),d},n=t(r),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},o=function(l){return n&&l<n.length-n.l?n:(s(),n=t(Math.max(l+1,r)))},i=function(){return s(),Vi(e)},c=function(l){s(),n=l,n.l==null&&(n.l=n.length),o(r)};return{next:o,push:c,end:i,_bufs:e}}function Er(e,r,t,n){var s=+r,o;if(!isNaN(s)){n||(n=qv[s].p||(t||[]).length||0),o=1+(s>=128?1:0)+1,n>=128&&++o,n>=16384&&++o,n>=2097152&&++o;var i=e.next(o);s<=127?i.write_shift(1,s):(i.write_shift(1,(s&127)+128),i.write_shift(1,s>>7));for(var c=0;c!=4;++c)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&d_(t)&&e.push(t)}}function mv(e,r,t){var n=Os(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function sC(e,r,t){var n=Os(e);return n.s=mv(n.s,r.s,t),n.e=mv(n.e,r.s,t),n}function gv(e,r){if(e.cRel&&e.c<0)for(e=Os(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=Os(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=Fn(e);return!e.cRel&&e.cRel!=null&&(t=_X(t)),!e.rRel&&e.rRel!=null&&(t=wX(t)),t}function b3(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+qs(e.s.c)+":"+(e.e.cRel?"":"$")+qs(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+bi(e.s.r)+":"+(e.e.rRel?"":"$")+bi(e.e.r):gv(e.s,r.biff)+":"+gv(e.e,r.biff)}function f_(e){return parseInt(SX(e),10)-1}function bi(e){return""+(e+1)}function wX(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function SX(e){return e.replace(/\$(\d+)$/,"$1")}function h_(e){for(var r=AX(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function qs(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function _X(e){return e.replace(/^([A-Z])/,"$$$1")}function AX(e){return e.replace(/^\$([A-Z])/,"$1")}function CX(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Gs(e){for(var r=0,t=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?r=10*r+(s-48):s>=65&&s<=90&&(t=26*t+(s-64))}return{c:t-1,r:r-1}}function Fn(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function vl(e){var r=e.indexOf(":");return r==-1?{s:Gs(e),e:Gs(e)}:{s:Gs(e.slice(0,r)),e:Gs(e.slice(r+1))}}function Jn(e,r){return typeof r>"u"||typeof r=="number"?Jn(e.s,e.e):(typeof e!="string"&&(e=Fn(e)),typeof r!="string"&&(r=Fn(r)),e==r?e:e+":"+r)}function Ba(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,s=0,o=e.length;for(t=0;n<o&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)t=26*t+s;for(r.s.c=--t,t=0;n<o&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)t=10*t+s;if(r.s.r=--t,n===o||s!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=o&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)t=26*t+s;for(r.e.c=--t,t=0;n!=o&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)t=10*t+s;return r.e.r=--t,r}function iC(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=yc(e.z,t?Ii(r):r)}catch{}try{return e.w=yc((e.XF||{}).numFmtId||(t?14:0),t?Ii(r):r)}catch{return""+r}}function Fd(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?Ud[e.v]||e.v:r==null?iC(e,e.v):iC(e,r))}function rh(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function XR(e,r,t){var n=t||{},s=e?Array.isArray(e):n.dense,o=e||(s?[]:{}),i=0,c=0;if(o&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var u=typeof n.origin=="string"?Gs(n.origin):n.origin;i=u.r,c=u.c}o["!ref"]||(o["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var d=Ba(o["!ref"]);l.s.c=d.s.c,l.s.r=d.s.r,l.e.c=Math.max(l.e.c,d.e.c),l.e.r=Math.max(l.e.r,d.e.r),i==-1&&(l.e.r=i=d.e.r+1)}for(var h=0;h!=r.length;++h)if(r[h]){if(!Array.isArray(r[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=r[h].length;++f)if(!(typeof r[h][f]>"u")){var p={v:r[h][f]},v=i+h,g=c+f;if(l.s.r>v&&(l.s.r=v),l.s.c>g&&(l.s.c=g),l.e.r<v&&(l.e.r=v),l.e.c<g&&(l.e.c=g),r[h][f]&&typeof r[h][f]=="object"&&!Array.isArray(r[h][f])&&!(r[h][f]instanceof Date))p=r[h][f];else if(Array.isArray(p.v)&&(p.f=r[h][f][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||On[14],n.cellDates?(p.t="d",p.w=yc(p.z,Ii(p.v))):(p.t="n",p.v=Ii(p.v),p.w=yc(p.z,p.v))):p.t="s";if(s)o[v]||(o[v]=[]),o[v][g]&&o[v][g].z&&(p.z=o[v][g].z),o[v][g]=p;else{var m=Fn({c:g,r:v});o[m]&&o[m].z&&(p.z=o[m].z),o[m]=p}}}return l.s.c<1e7&&(o["!ref"]=Jn(l)),o}function rg(e,r){return XR(null,e,r)}function jX(e){return e.read_shift(4,"i")}function Yc(e,r){return r||(r=dr(4)),r.write_shift(4,e),r}function To(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function Gi(e,r){var t=!1;return r==null&&(t=!0,r=dr(4+2*e.length)),r.write_shift(4,e.length),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}function kX(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function RX(e,r){return r||(r=dr(4)),r.write_shift(2,0),r.write_shift(2,0),r}function p_(e,r){var t=e.l,n=e.read_shift(1),s=To(e),o=[],i={t:s,h:s};if((n&1)!==0){for(var c=e.read_shift(4),u=0;u!=c;++u)o.push(kX(e));i.r=o}else i.r=[{ich:0,ifnt:0}];return e.l=t+r,i}function EX(e,r){var t=!1;return r==null&&(t=!0,r=dr(15+4*e.t.length)),r.write_shift(1,0),Gi(e.t,r),t?r.slice(0,r.l):r}var NX=p_;function TX(e,r){var t=!1;return r==null&&(t=!0,r=dr(23+4*e.t.length)),r.write_shift(1,1),Gi(e.t,r),r.write_shift(4,1),RX({},r),t?r.slice(0,r.l):r}function Sc(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function X0(e,r){return r==null&&(r=dr(8)),r.write_shift(-4,e.c),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}function Y0(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}function Z0(e,r){return r==null&&(r=dr(4)),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}var LX=To,YR=Gi;function m_(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}function L2(e,r){var t=!1;return r==null&&(t=!0,r=dr(127)),r.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}var MX=To,OS=m_,g_=L2;function v_(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var s=n===0?T2([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):v0(r,0)>>2;return t?s/100:s}function ZR(e,r){r==null&&(r=dr(4));var t=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,t=1),n)r.write_shift(-4,((t?s:e)<<2)+(t+2));else throw new Error("unsupported RkNumber "+e)}function JR(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}function DX(e,r){return r||(r=dr(16)),r.write_shift(4,e.s.r),r.write_shift(4,e.e.r),r.write_shift(4,e.s.c),r.write_shift(4,e.e.c),r}var J0=JR,ng=DX;function No(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function F0(e,r){return(r||dr(8)).write_shift(8,e,"f")}function IX(e){var r={},t=e.read_shift(1),n=t>>>1,s=e.read_shift(1),o=e.read_shift(2,"i"),i=e.read_shift(1),c=e.read_shift(1),u=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=s;var l=R0[s];l&&(r.rgb=Uv(l));break;case 2:r.rgb=Uv([i,c,u]);break;case 3:r.theme=s;break}return o!=0&&(r.tint=o>0?o/32767:o/32768),r}function M2(e,r){if(r||(r=dr(8)),!e||e.auto)return r.write_shift(4,0),r.write_shift(4,0),r;e.index!=null?(r.write_shift(1,2),r.write_shift(1,e.index)):e.theme!=null?(r.write_shift(1,6),r.write_shift(1,e.theme)):(r.write_shift(1,5),r.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),r.write_shift(2,t),!e.rgb||e.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),r.write_shift(1,parseInt(n.slice(0,2),16)),r.write_shift(1,parseInt(n.slice(2,4),16)),r.write_shift(1,parseInt(n.slice(4,6),16)),r.write_shift(1,255)}return r}function OX(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function PX(e,r){r||(r=dr(2));var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return r.write_shift(1,t),r.write_shift(1,0),r}function QR(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function FX(e){return QR(e,1)}function BX(e){return QR(e,2)}var x_=2,ul=3,Ry=11,oC=12,D2=19,Ey=64,zX=65,$X=71,UX=4108,HX=4126,Hi=80,e9=81,VX=[Hi,e9],PS={1:{n:"CodePage",t:x_},2:{n:"Category",t:Hi},3:{n:"PresentationFormat",t:Hi},4:{n:"ByteCount",t:ul},5:{n:"LineCount",t:ul},6:{n:"ParagraphCount",t:ul},7:{n:"SlideCount",t:ul},8:{n:"NoteCount",t:ul},9:{n:"HiddenCount",t:ul},10:{n:"MultimediaClipCount",t:ul},11:{n:"ScaleCrop",t:Ry},12:{n:"HeadingPairs",t:UX},13:{n:"TitlesOfParts",t:HX},14:{n:"Manager",t:Hi},15:{n:"Company",t:Hi},16:{n:"LinksUpToDate",t:Ry},17:{n:"CharacterCount",t:ul},19:{n:"SharedDoc",t:Ry},22:{n:"HyperlinksChanged",t:Ry},23:{n:"AppVersion",t:ul,p:"version"},24:{n:"DigSig",t:zX},26:{n:"ContentType",t:Hi},27:{n:"ContentStatus",t:Hi},28:{n:"Language",t:Hi},29:{n:"Version",t:Hi},255:{},2147483648:{n:"Locale",t:D2},2147483651:{n:"Behavior",t:D2},1919054434:{}},FS={1:{n:"CodePage",t:x_},2:{n:"Title",t:Hi},3:{n:"Subject",t:Hi},4:{n:"Author",t:Hi},5:{n:"Keywords",t:Hi},6:{n:"Comments",t:Hi},7:{n:"Template",t:Hi},8:{n:"LastAuthor",t:Hi},9:{n:"RevNumber",t:Hi},10:{n:"EditTime",t:Ey},11:{n:"LastPrinted",t:Ey},12:{n:"CreatedDate",t:Ey},13:{n:"ModifiedDate",t:Ey},14:{n:"PageCount",t:ul},15:{n:"WordCount",t:ul},16:{n:"CharCount",t:ul},17:{n:"Thumbnail",t:$X},18:{n:"Application",t:Hi},19:{n:"DocSecurity",t:ul},255:{},2147483648:{n:"Locale",t:D2},2147483651:{n:"Behavior",t:D2},1919054434:{}},lC={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},WX=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function qX(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var GX=qX([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),R0=Os(GX),Ud={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},t9={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},BS={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Ny={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function b_(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function KX(e){var r=b_();if(!e||!e.match)return r;var t={};if((e.match(Mo)||[]).forEach(function(n){var s=Bn(n);switch(s[0].replace(aX,"<")){case"<?xml":break;case"<Types":r.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[s.Extension]=s.ContentType;break;case"<Override":r[BS[s.ContentType]]!==void 0&&r[BS[s.ContentType]].push(s.PartName);break}}),r.xmlns!==Mi.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}function r9(e,r){var t=KK(BS),n=[],s;n[n.length]=wi,n[n.length]=zr("Types",null,{xmlns:Mi.CT,"xmlns:xsd":Mi.xsd,"xmlns:xsi":Mi.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return zr("Default",null,{Extension:u[0],ContentType:u[1]})}));var o=function(u){e[u]&&e[u].length>0&&(s=e[u][0],n[n.length]=zr("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Ny[u][r.bookType]||Ny[u].xlsx}))},i=function(u){(e[u]||[]).forEach(function(l){n[n.length]=zr("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:Ny[u][r.bookType]||Ny[u].xlsx})})},c=function(u){(e[u]||[]).forEach(function(l){n[n.length]=zr("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:t[u][0]})})};return o("workbooks"),i("sheets"),i("charts"),c("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),i("metadata"),c("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var ya={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function $v(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function vv(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(e.match(Mo)||[]).forEach(function(s){var o=Bn(s);if(o[0]==="<Relationship"){var i={};i.Type=o.Type,i.Target=o.Target,i.Id=o.Id,o.TargetMode&&(i.TargetMode=o.TargetMode);var c=o.TargetMode==="External"?o.Target:tv(o.Target,r);t[c]=i,n[o.Id]=i}}),t["!id"]=n,t}function Nm(e){var r=[wi,zr("Relationships",null,{xmlns:Mi.RELS})];return si(e["!id"]).forEach(function(t){r[r.length]=zr("Relationship",null,e["!id"][t])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function ss(e,r,t,n,s,o){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),r<0)for(r=e["!idx"];e["!id"]["rId"+r];++r);if(e["!idx"]=r+1,s.Id="rId"+r,s.Type=n,s.Target=t,[ya.HLINK,ya.XPATH,ya.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+r);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,r}var XX="application/vnd.oasis.opendocument.spreadsheet";function YX(e,r){for(var t=c_(e),n,s;n=zv.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Bn(n[0],!1),s.path=="/"&&s.type!==XX)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}function ZX(e){var r=[wi];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<e.length;++t)r.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function cC(e,r,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function JX(e,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function QX(e){var r=[wi];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=e.length;++t)r.push(cC(e[t][0],e[t][1])),r.push(JX("",e[t][0]));return r.push(cC("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function n9(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+j2.version+"</meta:generator></office:meta></office:document-meta>"}var gc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],eY=function(){for(var e=new Array(gc.length),r=0;r<gc.length;++r){var t=gc[r],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function a9(e){var r={};e=hs(e);for(var t=0;t<gc.length;++t){var n=gc[t],s=e.match(eY[t]);s!=null&&s.length>0&&(r[n[1]]=Fa(s[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=Is(r[n[1]]))}return r}function y3(e,r,t,n,s){s[e]!=null||r==null||r===""||(s[e]=r,r=os(r),n[n.length]=t?zr(e,r,t):lo(e,r))}function s9(e,r){var t=r||{},n=[wi,zr("cp:coreProperties",null,{"xmlns:cp":Mi.CORE_PROPS,"xmlns:dc":Mi.dc,"xmlns:dcterms":Mi.dcterms,"xmlns:dcmitype":Mi.dcmitype,"xmlns:xsi":Mi.xsi})],s={};if(!e&&!t.Props)return n.join("");e&&(e.CreatedDate!=null&&y3("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:IS(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&y3("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:IS(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var o=0;o!=gc.length;++o){var i=gc[o],c=t.Props&&t.Props[i[1]]!=null?t.Props[i[1]]:e?e[i[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&y3(i[0],c,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var E0=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],i9=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function o9(e,r,t,n){var s=[];if(typeof e=="string")s=QA(e,n);else for(var o=0;o<e.length;++o)s=s.concat(e[o].map(function(d){return{v:d}}));var i=typeof r=="string"?QA(r,n).map(function(d){return d.v}):r,c=0,u=0;if(i.length>0)for(var l=0;l!==s.length;l+=2){switch(u=+s[l+1].v,s[l].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=u,t.SheetNames=i.slice(c,c+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=u,t.DefinedNames=i.slice(c,c+u);break;case"Charts":case"Diagramme":t.Chartsheets=u,t.ChartNames=i.slice(c,c+u);break}c+=u}}function tY(e,r,t){var n={};return r||(r={}),e=hs(e),E0.forEach(function(s){var o=(e.match(Fv(s[0]))||[])[1];switch(s[2]){case"string":o&&(r[s[1]]=Fa(o));break;case"bool":r[s[1]]=o==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&o9(n.HeadingPairs,n.TitlesOfParts,r,t),r}function l9(e){var r=[],t=zr;return e||(e={}),e.Application="SheetJS",r[r.length]=wi,r[r.length]=zr("Properties",null,{xmlns:Mi.EXT_PROPS,"xmlns:vt":Mi.vt}),E0.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=os(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(r[r.length]=t(n[0],s))}}),r[r.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+os(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var rY=/<[^>]+>[^<]*/g;function nY(e,r){var t={},n="",s=e.match(rY);if(s)for(var o=0;o!=s.length;++o){var i=s[o],c=Bn(i);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Fa(c.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var u=i.split(">"),l=u[0].slice(4),d=u[1];switch(l){case"lpstr":case"bstr":case"lpwstr":t[n]=Fa(d);break;case"bool":t[n]=Ds(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(d);break;case"filetime":case"date":t[n]=Is(d);break;case"cy":case"error":t[n]=Fa(d);break;default:if(l.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",i,l,u)}}else if(i.slice(0,2)!=="</"){if(r.WTF)throw new Error(i)}}}return t}function c9(e){var r=[wi,zr("Properties",null,{xmlns:Mi.CUST_PROPS,"xmlns:vt":Mi.vt})];if(!e)return r.join("");var t=1;return si(e).forEach(function(s){++t,r[r.length]=zr("property",fX(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:os(s)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var zS={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},w3;function aY(e,r,t){w3||(w3=Iw(zS)),r=w3[r]||r,e[r]=t}function sY(e,r){var t=[];return si(zS).map(function(n){for(var s=0;s<gc.length;++s)if(gc[s][1]==n)return gc[s];for(s=0;s<E0.length;++s)if(E0[s][1]==n)return E0[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=r&&r.Props&&r.Props[n[1]]!=null?r.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),t.push(lo(zS[n[1]]||n[1],s))}}),zr("DocumentProperties",t.join(""),{xmlns:Pl.o})}function iY(e,r){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&si(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)){for(var i=0;i<gc.length;++i)if(o==gc[i][1])return;for(i=0;i<E0.length;++i)if(o==E0[i][1])return;for(i=0;i<t.length;++i)if(o==t[i])return;var c=e[o],u="string";typeof c=="number"?(u="float",c=String(c)):c===!0||c===!1?(u="boolean",c=c?"1":"0"):c=String(c),s.push(zr(XA(o),c,{"dt:dt":u}))}}),r&&si(r).forEach(function(o){if(Object.prototype.hasOwnProperty.call(r,o)&&!(e&&Object.prototype.hasOwnProperty.call(e,o))){var i=r[o],c="string";typeof i=="number"?(c="float",i=String(i)):i===!0||i===!1?(c="boolean",i=i?"1":"0"):i instanceof Date?(c="dateTime.tz",i=i.toISOString()):i=String(i),s.push(zr(XA(o),i,{"dt:dt":c}))}}),"<"+n+' xmlns="'+Pl.o+'">'+s.join("")+"</"+n+">"}function y_(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function oY(e){var r=typeof e=="string"?new Date(Date.parse(e)):e,t=r.getTime()/1e3+11644473600,n=t%Math.pow(2,32),s=(t-n)/Math.pow(2,32);n*=1e7,s*=1e7;var o=n/Math.pow(2,32)|0;o>0&&(n=n%Math.pow(2,32),s+=o);var i=dr(8);return i.write_shift(4,n),i.write_shift(4,s),i}function u9(e,r,t){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-n&3;)++e.l;return s}function d9(e,r,t){var n=e.read_shift(0,"lpwstr");return n}function f9(e,r,t){return r===31?d9(e):u9(e,r,t)}function $S(e,r,t){return f9(e,r,t===!1?0:4)}function lY(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return f9(e,r,0)}function cY(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n){var s=e.l;t[n]=e.read_shift(0,"lpwstr").replace(Ko,""),e.l-s&2&&(e.l+=2)}return t}function uY(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n)t[n]=e.read_shift(0,"lpstr-cp").replace(Ko,"");return t}function dY(e){var r=e.l,t=I2(e,e9);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var n=I2(e,ul);return[t,n]}function fY(e){for(var r=e.read_shift(4),t=[],n=0;n<r/2;++n)t.push(dY(e));return t}function uC(e,r){for(var t=e.read_shift(4),n={},s=0;s!=t;++s){var o=e.read_shift(4),i=e.read_shift(4);n[o]=e.read_shift(i,r===1200?"utf16le":"utf8").replace(Ko,"").replace(ev,"!"),r===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function h9(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function hY(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function I2(e,r,t){var n=e.read_shift(2),s,o=t||{};if(e.l+=2,r!==oC&&n!==r&&VX.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===oC?n:r){case 2:return s=e.read_shift(2,"i"),o.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return u9(e,n,4).replace(Ko,"");case 31:return d9(e);case 64:return y_(e);case 65:return h9(e);case 71:return hY(e);case 80:return $S(e,n,!o.raw).replace(Ko,"");case 81:return lY(e,n).replace(Ko,"");case 4108:return fY(e);case 4126:case 4127:return n==4127?cY(e):uY(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function dC(e,r){var t=dr(4),n=dr(4);switch(t.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,r);break;case 5:n=dr(8),n.write_shift(8,r,"f");break;case 11:n.write_shift(4,r?1:0);break;case 64:n=oY(r);break;case 31:case 80:for(n=dr(4+2*(r.length+1)+(r.length%2?0:2)),n.write_shift(4,r.length+1),n.write_shift(0,r,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}return Vi([t,n])}function fC(e,r){var t=e.l,n=e.read_shift(4),s=e.read_shift(4),o=[],i=0,c=0,u=-1,l={};for(i=0;i!=s;++i){var d=e.read_shift(4),h=e.read_shift(4);o[i]=[d,h+t]}o.sort(function(y,S){return y[1]-S[1]});var f={};for(i=0;i!=s;++i){if(e.l!==o[i][1]){var p=!0;if(i>0&&r)switch(r[o[i-1][0]].t){case 2:e.l+2===o[i][1]&&(e.l+=2,p=!1);break;case 80:e.l<=o[i][1]&&(e.l=o[i][1],p=!1);break;case 4108:e.l<=o[i][1]&&(e.l=o[i][1],p=!1);break}if((!r||i==0)&&e.l<=o[i][1]&&(p=!1,e.l=o[i][1]),p)throw new Error("Read Error: Expected address "+o[i][1]+" at "+e.l+" :"+i)}if(r){var v=r[o[i][0]];if(f[v.n]=I2(e,v.t,{raw:!0}),v.p==="version"&&(f[v.n]=String(f[v.n]>>16)+"."+("0000"+String(f[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(f[v.n]){case 0:f[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:qc(c=f[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[v.n])}}else if(o[i][0]===1){if(c=f.CodePage=I2(e,x_),qc(c),u!==-1){var g=e.l;e.l=o[u][1],l=uC(e,c),e.l=g}}else if(o[i][0]===0){if(c===0){u=i,e.l=o[i+1][1];continue}l=uC(e,c)}else{var m=l[o[i][0]],b;switch(e[e.l]){case 65:e.l+=4,b=h9(e);break;case 30:e.l+=4,b=$S(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,b=$S(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,b=e.read_shift(4,"i");break;case 19:e.l+=4,b=e.read_shift(4);break;case 5:e.l+=4,b=e.read_shift(8,"f");break;case 11:e.l+=4,b=gi(e,4);break;case 64:e.l+=4,b=Is(y_(e));break;default:throw new Error("unparsed value: "+e[e.l])}f[m]=b}}return e.l=t+n,f}var p9=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function pY(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function hC(e,r,t){var n=dr(8),s=[],o=[],i=8,c=0,u=dr(8),l=dr(8);if(u.write_shift(4,2),u.write_shift(4,1200),l.write_shift(4,1),o.push(u),s.push(l),i+=8+u.length,!r){l=dr(8),l.write_shift(4,0),s.unshift(l);var d=[dr(4)];for(d[0].write_shift(4,e.length),c=0;c<e.length;++c){var h=e[c][0];for(u=dr(8+2*(h.length+1)+(h.length%2?0:2)),u.write_shift(4,c+2),u.write_shift(4,h.length+1),u.write_shift(0,h,"dbcs");u.l!=u.length;)u.write_shift(1,0);d.push(u)}u=Vi(d),o.unshift(u),i+=8+u.length}for(c=0;c<e.length;++c)if(!(r&&!r[e[c][0]])&&!(p9.indexOf(e[c][0])>-1||i9.indexOf(e[c][0])>-1)&&e[c][1]!=null){var f=e[c][1],p=0;if(r){p=+r[e[c][0]];var v=t[p];if(v.p=="version"&&typeof f=="string"){var g=f.split(".");f=(+g[0]<<16)+(+g[1]||0)}u=dC(v.t,f)}else{var m=pY(f);m==-1&&(m=31,f=String(f)),u=dC(m,f)}o.push(u),l=dr(8),l.write_shift(4,r?p:2+c),s.push(l),i+=8+u.length}var b=8*(o.length+1);for(c=0;c<o.length;++c)s[c].write_shift(4,b),b+=o[c].length;return n.write_shift(4,i),n.write_shift(4,o.length),Vi([n].concat(s).concat(o))}function pC(e,r,t){var n=e.content;if(!n)return{};oo(n,0);var s,o,i,c,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var l=n.read_shift(4),d=n.read_shift(16);if(d!==An.utils.consts.HEADER_CLSID&&d!==t)throw new Error("Bad PropertySet CLSID "+d);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(o=n.read_shift(16),c=n.read_shift(4),s===1&&c!==n.l)throw new Error("Length mismatch: "+c+" !== "+n.l);s===2&&(i=n.read_shift(16),u=n.read_shift(4));var h=fC(n,r),f={SystemIdentifier:l};for(var p in h)f[p]=h[p];if(f.FMTID=o,s===1)return f;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var v;try{v=fC(n,null)}catch{}for(p in v)f[p]=v[p];return f.FMTID=[o,i],f}function mC(e,r,t,n,s,o){var i=dr(s?68:48),c=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,An.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,r,"hex"),i.write_shift(4,s?68:48);var u=hC(e,t,n);if(c.push(u),s){var l=hC(s,null,null);i.write_shift(16,o,"hex"),i.write_shift(4,68+u.length),c.push(l)}return Vi(c)}function Mf(e,r){return e.read_shift(r),null}function mY(e,r){r||(r=dr(e));for(var t=0;t<e;++t)r.write_shift(1,0);return r}function gY(e,r,t){for(var n=[],s=e.l+r;e.l<s;)n.push(t(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function gi(e,r){return e.read_shift(r)===1}function Go(e,r){return r||(r=dr(2)),r.write_shift(2,+!!e),r}function Ri(e){return e.read_shift(2,"u")}function fc(e,r){return r||(r=dr(2)),r.write_shift(2,e),r}function m9(e,r){return gY(e,r,Ri)}function vY(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function g9(e,r,t){return t||(t=dr(2)),t.write_shift(1,r=="e"?+e:+!!e),t.write_shift(1,r=="e"?1:0),t}function fx(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),s="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var o=e.read_shift(1);o&&(s="dbcs-cont")}else t.biff==12&&(s="wstr");t.biff>=2&&t.biff<=5&&(s="cpstr");var i=n?e.read_shift(n,s):"";return i}function xY(e){var r=e.read_shift(2),t=e.read_shift(1),n=t&4,s=t&8,o=1+(t&1),i=0,c,u={};s&&(i=e.read_shift(2)),n&&(c=e.read_shift(4));var l=o==2?"dbcs-cont":"sbcs-cont",d=r===0?"":e.read_shift(r,l);return s&&(e.l+=4*i),n&&(e.l+=c),u.t=d,s||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function bY(e){var r=e.t||"",t=dr(3);t.write_shift(2,r.length),t.write_shift(1,1);var n=dr(2*r.length);n.write_shift(2*r.length,r,"utf16le");var s=[t,n];return Vi(s)}function B0(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function hx(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):B0(e,n,t)}function Q0(e,r,t){if(t.biff>5)return hx(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function v9(e,r,t){return t||(t=dr(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function yY(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function wY(e){var r=e.read_shift(4),t=e.l,n=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=t);var s=e.read_shift((n?r-24:r)>>1,"utf16le").replace(Ko,"");return n&&(e.l+=24),s}function SY(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return t+n.replace(/\\/g,"/");var o=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(o>>1,"utf16le").replace(Ko,"");return t+i}function _Y(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return wY(e);case"0303000000000000c000000000000046":return SY(e);default:throw new Error("Unsupported Moniker "+t)}}function Ty(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(Ko,""):"";return t}function gC(e,r){r||(r=dr(6+e.length*2)),r.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)r.write_shift(2,e.charCodeAt(t));return r.write_shift(2,0),r}function AY(e,r){var t=e.l+r,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var o,i,c,u,l="",d,h;s&16&&(o=Ty(e,t-e.l)),s&128&&(i=Ty(e,t-e.l)),(s&257)===257&&(c=Ty(e,t-e.l)),(s&257)===1&&(u=_Y(e,t-e.l)),s&8&&(l=Ty(e,t-e.l)),s&32&&(d=e.read_shift(16)),s&64&&(h=y_(e)),e.l=t;var f=i||c||u||"";f&&l&&(f+="#"+l),f||(f="#"+l),s&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var p={Target:f};return d&&(p.guid=d),h&&(p.time=h),o&&(p.Tooltip=o),p}function CY(e){var r=dr(512),t=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),o=s>-1?31:23;switch(n.charAt(0)){case"#":o=28;break;case".":o&=-3;break}r.write_shift(4,2),r.write_shift(4,o);var i=[8,6815827,6619237,4849780,83];for(t=0;t<i.length;++t)r.write_shift(4,i[t]);if(o==28)n=n.slice(1),gC(n,r);else if(o&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<i.length;++t)r.write_shift(1,parseInt(i[t],16));var c=s>-1?n.slice(0,s):n;for(r.write_shift(4,2*(c.length+1)),t=0;t<c.length;++t)r.write_shift(2,c.charCodeAt(t));r.write_shift(2,0),o&8&&gC(s>-1?n.slice(s+1):"",r)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<i.length;++t)r.write_shift(1,parseInt(i[t],16));for(var u=0;n.slice(u*3,u*3+3)=="../"||n.slice(u*3,u*3+3)=="..\\";)++u;for(r.write_shift(2,u),r.write_shift(4,n.length-3*u+1),t=0;t<n.length-3*u;++t)r.write_shift(1,n.charCodeAt(t+3*u)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),t=0;t<6;++t)r.write_shift(4,0)}return r.slice(0,r.l)}function x9(e){var r=e.read_shift(1),t=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[r,t,n,s]}function b9(e,r){var t=x9(e);return t[3]=0,t}function Yu(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return{r,c:t,ixfe:n}}function z0(e,r,t,n){return n||(n=dr(6)),n.write_shift(2,e),n.write_shift(2,r),n.write_shift(2,t||0),n}function jY(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function kY(e,r,t){return r===0?"":Q0(e,r,t)}function RY(e,r,t){var n=t.biff>8?4:2,s=e.read_shift(n),o=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,o,i]}function y9(e){var r=e.read_shift(2),t=v_(e);return[r,t]}function EY(e,r,t){e.l+=4,r-=4;var n=e.l+r,s=fx(e,r,t),o=e.read_shift(2);if(n-=e.l,o!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+o);return e.l+=o,s}function Fw(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r},e:{c:s,r:t}}}function w9(e,r){return r||(r=dr(8)),r.write_shift(2,e.s.r),r.write_shift(2,e.e.r),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c),r}function S9(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r},e:{c:s,r:t}}}var NY=S9;function _9(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[t,r,n]}function TY(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function LY(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function _o(e){e.l+=2,e.l+=e.read_shift(2)}var MY={0:_o,4:_o,5:_o,6:_o,7:LY,8:_o,9:_o,10:_o,11:_o,12:_o,13:TY,14:_o,15:_o,16:_o,17:_o,18:_o,19:_o,20:_o,21:_9};function DY(e,r){for(var t=e.l+r,n=[];e.l<t;){var s=e.read_shift(2);e.l-=2;try{n.push(MY[s](e,t-e.l))}catch{return e.l=t,n}}return e.l!=t&&(e.l=t),n}function Ly(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function w_(e,r,t){var n=1536,s=16;switch(t.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=dr(s);return o.write_shift(2,n),o.write_shift(2,r),s>4&&o.write_shift(2,29282),s>6&&o.write_shift(2,1997),s>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function IY(e,r){return r===0||e.read_shift(2),1200}function OY(e,r,t){if(t.enc)return e.l+=r,"";var n=e.l,s=Q0(e,0,t);return e.read_shift(r+n-e.l),s}function PY(e,r){var t=!r||r.biff==8,n=dr(t?112:54);for(n.write_shift(r.biff==8?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}function FY(e,r,t){var n=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function BY(e,r,t){var n=e.read_shift(4),s=e.read_shift(1)&3,o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var i=fx(e,0,t);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:o,name:i}}function zY(e,r){var t=!r||r.biff>=8?2:1,n=dr(8+t*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),r.biff>=8&&n.write_shift(1,1),n.write_shift(t*e.name.length,e.name,r.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function $Y(e,r){for(var t=e.l+r,n=e.read_shift(4),s=e.read_shift(4),o=[],i=0;i!=s&&e.l<t;++i)o.push(xY(e));return o.Count=n,o.Unique=s,o}function UY(e,r){var t=dr(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=bY(e[s]);var o=Vi([t].concat(n));return o.parts=[t.length].concat(n.map(function(i){return i.length})),o}function HY(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function VY(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=t/20),r}function WY(e){var r=jY(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function qY(e){return e.read_shift(2),e.read_shift(4)}function vC(e,r,t){var n=0;t&&t.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);t&&t.biff==2&&(n=1-(s>>15),s&=32767);var o={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[o,s]}function GY(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),i=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2),l=e.read_shift(2);return{Pos:[r,t],Dim:[n,s],Flags:o,CurTab:i,FirstTab:c,Selected:u,TabRatio:l}}function KY(){var e=dr(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function XY(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function YY(e){var r=dr(18),t=1718;return e&&e.RTL&&(t|=64),r.write_shift(2,t),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function ZY(){}function JY(e,r,t){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=fx(e,0,t),n}function QY(e,r){var t=e.name||"Arial",n=r&&r.biff==5,s=n?15+t.length:16+2*t.length,o=dr(s);return o.write_shift(2,e.sz*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,t.length),n||o.write_shift(1,1),o.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),o}function eZ(e){var r=Yu(e);return r.isst=e.read_shift(4),r}function tZ(e,r,t,n){var s=dr(10);return z0(e,r,n,s),s.write_shift(4,t),s}function rZ(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=e.l+r,s=Yu(e);t.biff==2&&e.l++;var o=hx(e,n-e.l,t);return s.val=o,s}function nZ(e,r,t,n,s){var o=!s||s.biff==8,i=dr(8+ +o+(1+o)*t.length);return z0(e,r,n,i),i.write_shift(2,t.length),o&&i.write_shift(1,1),i.write_shift((1+o)*t.length,t,o?"utf16le":"sbcs"),i}function aZ(e,r,t){var n=e.read_shift(2),s=Q0(e,0,t);return[n,s]}function sZ(e,r,t,n){var s=t&&t.biff==5;n||(n=dr(s?3+r.length:5+2*r.length)),n.write_shift(2,e),n.write_shift(s?1:2,r.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*r.length,r,s?"sbcs":"utf16le");var o=n.length>n.l?n.slice(0,n.l):n;return o.l==null&&(o.l=o.length),o}var iZ=Q0;function xC(e,r,t){var n=e.l+r,s=t.biff==8||!t.biff?4:2,o=e.read_shift(s),i=e.read_shift(s),c=e.read_shift(2),u=e.read_shift(2);return e.l=n,{s:{r:o,c},e:{r:i,c:u}}}function oZ(e,r){var t=r.biff==8||!r.biff?4:2,n=dr(2*t+6);return n.write_shift(t,e.s.r),n.write_shift(t,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function lZ(e){var r=e.read_shift(2),t=e.read_shift(2),n=y9(e);return{r,c:t,ixfe:n[0],rknum:n[1]}}function cZ(e,r){for(var t=e.l+r-2,n=e.read_shift(2),s=e.read_shift(2),o=[];e.l<t;)o.push(y9(e));if(e.l!==t)throw new Error("MulRK read error");var i=e.read_shift(2);if(o.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:o}}function uZ(e,r){for(var t=e.l+r-2,n=e.read_shift(2),s=e.read_shift(2),o=[];e.l<t;)o.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var i=e.read_shift(2);if(o.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:o}}function dZ(e,r,t,n){var s={},o=e.read_shift(4),i=e.read_shift(4),c=e.read_shift(4),u=e.read_shift(2);return s.patternType=WX[c>>26],n.cellStyles&&(s.alc=o&7,s.fWrap=o>>3&1,s.alcV=o>>4&7,s.fJustLast=o>>7&1,s.trot=o>>8&255,s.cIndent=o>>16&15,s.fShrinkToFit=o>>20&1,s.iReadOrder=o>>22&2,s.fAtrNum=o>>26&1,s.fAtrFnt=o>>27&1,s.fAtrAlc=o>>28&1,s.fAtrBdr=o>>29&1,s.fAtrPat=o>>30&1,s.fAtrProt=o>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=c&127,s.icvBottom=c>>7&127,s.icvDiag=c>>14&127,s.dgDiag=c>>21&15,s.icvFore=u&127,s.icvBack=u>>7&127,s.fsxButton=u>>14&1),s}function fZ(e,r,t){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=dZ(e,r,n.fStyle,t),n}function bC(e,r,t,n){var s=t&&t.biff==5;n||(n=dr(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,r<<4));var o=0;return e.numFmtId>0&&s&&(o|=1024),n.write_shift(4,o),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function hZ(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function pZ(e){var r=dr(8);return r.write_shift(4,0),r.write_shift(2,0),r.write_shift(2,0),r}function yC(e,r,t){var n=Yu(e);(t.biff==2||r==9)&&++e.l;var s=vY(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function mZ(e,r,t,n,s,o){var i=dr(8);return z0(e,r,n,i),g9(t,o,i),i}function gZ(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=Yu(e),s=No(e);return n.val=s,n}function vZ(e,r,t,n){var s=dr(14);return z0(e,r,n,s),F0(t,s),s}var wC=kY;function xZ(e,r,t){var n=e.l+r,s=e.read_shift(2),o=e.read_shift(2);if(t.sbcch=o,o==1025||o==14849)return[o,s];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var i=B0(e,o),c=[];n>e.l;)c.push(hx(e));return[o,s,i,c]}function SC(e,r,t){var n=e.read_shift(2),s,o={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(s=EY(e,r-2,t)),o.body=s||e.read_shift(r-2),typeof s=="string"&&(o.Name=s),o}var bZ=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function _C(e,r,t){var n=e.l+r,s=e.read_shift(2),o=e.read_shift(1),i=e.read_shift(1),c=e.read_shift(t&&t.biff==2?1:2),u=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),u=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var l=B0(e,i,t);s&32&&(l=bZ[l.charCodeAt(0)]);var d=n-e.l;t&&t.biff==2&&--d;var h=n==e.l||c===0||!(d>0)?[]:Dte(e,d,t,c);return{chKey:o,Name:l,itab:u,rgce:h}}function A9(e,r,t){if(t.biff<8)return yZ(e,r,t);for(var n=[],s=e.l+r,o=e.read_shift(t.biff>8?4:2);o--!==0;)n.push(RY(e,t.biff>8?12:6,t));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function yZ(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=fx(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function wZ(e,r,t){if(t.biff<8){e.l+=r;return}var n=e.read_shift(2),s=e.read_shift(2),o=B0(e,n,t),i=B0(e,s,t);return[o,i]}function SZ(e,r,t){var n=S9(e);e.l++;var s=e.read_shift(1);return r-=8,[Ite(e,r,t),s,n]}function AC(e,r,t){var n=NY(e);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[n,Lte(e,r,t)]}function _Z(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,n=e.read_shift(4);return[r,t,n]}function AZ(e,r,t){if(!(t.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),i=e.read_shift(2),c=Q0(e,0,t);return t.biff<8&&e.read_shift(1),[{r:n,c:s},c,i,o]}}function CZ(e,r,t){return AZ(e,r,t)}function jZ(e,r){for(var t=[],n=e.read_shift(2);n--;)t.push(Fw(e));return t}function kZ(e){var r=dr(2+e.length*8);r.write_shift(2,e.length);for(var t=0;t<e.length;++t)w9(e[t],r);return r}function RZ(e,r,t){if(t&&t.biff<8)return NZ(e,r,t);var n=_9(e),s=DY(e,r-22,n[1]);return{cmo:n,ft:s}}var EZ={8:function(e,r){var t=e.l+r;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=t,{fmt:n}}};function NZ(e,r,t){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var i=[];return i.push((EZ[n]||Lo)(e,r,t)),{cmo:[s,n,o],ft:i}}function TZ(e,r,t){var n=e.l,s="";try{e.l+=4;var o=(t.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(o)==-1?e.l+=6:i=yY(e,6,t);var c=e.read_shift(2);e.read_shift(2),Ri(e,2);var u=e.read_shift(2);e.l+=u;for(var l=1;l<e.lens.length-1;++l){if(e.l-n!=e.lens[l])throw new Error("TxO: bad continue record");var d=e[e.l],h=B0(e,e.lens[l+1]-e.lens[l]-1);if(s+=h,s.length>=(d?c:2*c))break}if(s.length!==c&&s.length!==c*2)throw new Error("cchText: "+c+" != "+s.length);return e.l=n+r,{t:s}}catch{return e.l=n+r,{t:s}}}function LZ(e,r){var t=Fw(e);e.l+=16;var n=AY(e,r-24);return[t,n]}function MZ(e){var r=dr(24),t=Gs(e[0]);r.write_shift(2,t.r),r.write_shift(2,t.r),r.write_shift(2,t.c),r.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)r.write_shift(1,parseInt(n[s],16));return Vi([r,CY(e[1])])}function DZ(e,r){e.read_shift(2);var t=Fw(e),n=e.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(Ko,""),[t,n]}function IZ(e){var r=e[1].Tooltip,t=dr(10+2*(r.length+1));t.write_shift(2,2048);var n=Gs(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var s=0;s<r.length;++s)t.write_shift(2,r.charCodeAt(s));return t.write_shift(2,0),t}function OZ(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=lC[t]||t,t=e.read_shift(2),r[1]=lC[t]||t,r}function PZ(e){return e||(e=dr(4)),e.write_shift(2,1),e.write_shift(2,1),e}function FZ(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(b9(e));return t}function BZ(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(b9(e));return t}function zZ(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function C9(e,r,t){if(!t.cellStyles)return Lo(e,r);var n=t&&t.biff>=12?4:2,s=e.read_shift(n),o=e.read_shift(n),i=e.read_shift(n),c=e.read_shift(n),u=e.read_shift(2);n==2&&(e.l+=2);var l={s,e:o,w:i,ixfe:c,flags:u};return(t.biff>=5||!t.biff)&&(l.level=u>>8&7),l}function $Z(e,r){var t=dr(12);t.write_shift(2,r),t.write_shift(2,r),t.write_shift(2,e.width*256),t.write_shift(2,0);var n=0;return e.hidden&&(n|=1),t.write_shift(1,n),n=e.level||0,t.write_shift(1,n),t.write_shift(2,0),t}function UZ(e,r){var t={};return r<32||(e.l+=16,t.header=No(e),t.footer=No(e),e.l+=2),t}function HZ(e,r,t){var n={area:!1};if(t.biff!=5)return e.l+=r,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function VZ(e){for(var r=dr(2*e),t=0;t<e;++t)r.write_shift(2,t+1);return r}var WZ=Yu,qZ=m9,GZ=hx;function KZ(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),s={fmt:r,env:t,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function XZ(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=Yu(e);++e.l;var s=Q0(e,r-7,t);return n.t="str",n.val=s,n}function YZ(e){var r=Yu(e);++e.l;var t=No(e);return r.t="n",r.val=t,r}function ZZ(e,r,t){var n=dr(15);return vx(n,e,r),n.write_shift(8,t,"f"),n}function JZ(e){var r=Yu(e);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function QZ(e,r,t){var n=dr(9);return vx(n,e,r),n.write_shift(2,t),n}function eJ(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function tJ(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function rJ(e,r,t){var n=e.l+r,s=Yu(e),o=e.read_shift(2),i=B0(e,o,t);return e.l=n,s.t="str",s.val=i,s}var nJ=[2,3,48,49,131,139,140,245],US=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Iw({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(c,u){var l=[],d=Uf(1);switch(u.type){case"base64":d=$l(Wl(c));break;case"binary":d=$l(c);break;case"buffer":case"array":d=c;break}oo(d,0);var h=d.read_shift(1),f=!!(h&136),p=!1,v=!1;switch(h){case 2:break;case 3:break;case 48:p=!0,f=!0;break;case 49:p=!0,f=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var g=0,m=521;h==2&&(g=d.read_shift(2)),d.l+=3,h!=2&&(g=d.read_shift(4)),g>1048576&&(g=1e6),h!=2&&(m=d.read_shift(2));var b=d.read_shift(2),y=u.codepage||1252;h!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(y=e[d[d.l]]),d.l+=1,d.l+=2),v&&(d.l+=36);for(var S=[],C={},L=Math.min(d.length,h==2?521:m-10-(p?264:0)),O=v?32:11;d.l<L&&d[d.l]!=13;)switch(C={},C.name=DS.utils.decode(y,d.slice(d.l,d.l+O)).replace(/[\u0000\r\n].*$/g,""),d.l+=O,C.type=String.fromCharCode(d.read_shift(1)),h!=2&&!v&&(C.offset=d.read_shift(4)),C.len=d.read_shift(1),h==2&&(C.offset=d.read_shift(2)),C.dec=d.read_shift(1),C.name.length&&S.push(C),h!=2&&(d.l+=v?13:14),C.type){case"B":(!p||C.len!=8)&&u.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+C.type)}if(d[d.l]!==13&&(d.l=m-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=m;var H=0,z=0;for(l[0]=[],z=0;z!=S.length;++z)l[0][z]=S[z].name;for(;g-- >0;){if(d[d.l]===42){d.l+=b;continue}for(++d.l,l[++H]=[],z=0,z=0;z!=S.length;++z){var q=d.slice(d.l,d.l+S[z].len);d.l+=S[z].len,oo(q,0);var D=DS.utils.decode(y,q);switch(S[z].type){case"C":D.trim().length&&(l[H][z]=D.replace(/\s+$/,""));break;case"D":D.length===8?l[H][z]=new Date(+D.slice(0,4),+D.slice(4,6)-1,+D.slice(6,8)):l[H][z]=D;break;case"F":l[H][z]=parseFloat(D.trim());break;case"+":case"I":l[H][z]=v?q.read_shift(-4,"i")^2147483648:q.read_shift(4,"i");break;case"L":switch(D.trim().toUpperCase()){case"Y":case"T":l[H][z]=!0;break;case"N":case"F":l[H][z]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+D+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));l[H][z]="##MEMO##"+(v?parseInt(D.trim(),10):q.read_shift(4));break;case"N":D=D.replace(/\u0000/g,"").trim(),D&&D!="."&&(l[H][z]=+D||0);break;case"@":l[H][z]=new Date(q.read_shift(-8,"f")-621356832e5);break;case"T":l[H][z]=new Date((q.read_shift(4)-2440588)*864e5+q.read_shift(4));break;case"Y":l[H][z]=q.read_shift(4,"i")/1e4+q.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[H][z]=-q.read_shift(-8,"f");break;case"B":if(p&&S[z].len==8){l[H][z]=q.read_shift(8,"f");break}case"G":case"P":q.l+=S[z].len;break;case"0":if(S[z].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[z].type)}}}if(h!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return u&&u.sheetRows&&(l=l.slice(0,u.sheetRows)),u.DBF=S,l}function n(c,u){var l=u||{};l.dateNF||(l.dateNF="yyyymmdd");var d=rg(t(c,l),l);return d["!cols"]=l.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete l.DBF,d}function s(c,u){try{return rh(n(c,u),u)}catch(l){if(u&&u.WTF)throw l}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function i(c,u){var l=u||{};if(+l.codepage>=0&&qc(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var d=ml(),h=F2(c,{header:1,raw:!0,cellDates:!0}),f=h[0],p=h.slice(1),v=c["!cols"]||[],g=0,m=0,b=0,y=1;for(g=0;g<f.length;++g){if(((v[g]||{}).DBF||{}).name){f[g]=v[g].DBF.name,++b;continue}if(f[g]!=null){if(++b,typeof f[g]=="number"&&(f[g]=f[g].toString(10)),typeof f[g]!="string")throw new Error("DBF Invalid column name "+f[g]+" |"+typeof f[g]+"|");if(f.indexOf(f[g])!==g){for(m=0;m<1024;++m)if(f.indexOf(f[g]+"_"+m)==-1){f[g]+="_"+m;break}}}}var S=Ba(c["!ref"]),C=[],L=[],O=[];for(g=0;g<=S.e.c-S.s.c;++g){var H="",z="",q=0,D=[];for(m=0;m<p.length;++m)p[m][g]!=null&&D.push(p[m][g]);if(D.length==0||f[g]==null){C[g]="?";continue}for(m=0;m<D.length;++m){switch(typeof D[m]){case"number":z="B";break;case"string":z="C";break;case"boolean":z="L";break;case"object":z=D[m]instanceof Date?"D":"C";break;default:z="C"}q=Math.max(q,String(D[m]).length),H=H&&H!=z?"C":z}q>250&&(q=250),z=((v[g]||{}).DBF||{}).type,z=="C"&&v[g].DBF.len>q&&(q=v[g].DBF.len),H=="B"&&z=="N"&&(H="N",O[g]=v[g].DBF.dec,q=v[g].DBF.len),L[g]=H=="C"||z=="N"?q:o[H]||0,y+=L[g],C[g]=H}var W=d.next(32);for(W.write_shift(4,318902576),W.write_shift(4,p.length),W.write_shift(2,296+32*b),W.write_shift(2,y),g=0;g<4;++g)W.write_shift(4,0);for(W.write_shift(4,0|(+r[pR]||3)<<8),g=0,m=0;g<f.length;++g)if(f[g]!=null){var P=d.next(32),I=(f[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,I,"sbcs"),P.write_shift(1,C[g]=="?"?"C":C[g],"sbcs"),P.write_shift(4,m),P.write_shift(1,L[g]||o[C[g]]||0),P.write_shift(1,O[g]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),m+=L[g]||o[C[g]]||0}var U=d.next(264);for(U.write_shift(4,13),g=0;g<65;++g)U.write_shift(4,0);for(g=0;g<p.length;++g){var k=d.next(y);for(k.write_shift(1,0),m=0;m<f.length;++m)if(f[m]!=null)switch(C[m]){case"L":k.write_shift(1,p[g][m]==null?63:p[g][m]?84:70);break;case"B":k.write_shift(8,p[g][m]||0,"f");break;case"N":var _="0";for(typeof p[g][m]=="number"&&(_=p[g][m].toFixed(O[m]||0)),b=0;b<L[m]-_.length;++b)k.write_shift(1,32);k.write_shift(1,_,"sbcs");break;case"D":p[g][m]?(k.write_shift(4,("0000"+p[g][m].getFullYear()).slice(-4),"sbcs"),k.write_shift(2,("00"+(p[g][m].getMonth()+1)).slice(-2),"sbcs"),k.write_shift(2,("00"+p[g][m].getDate()).slice(-2),"sbcs")):k.write_shift(8,"00000000","sbcs");break;case"C":var R=String(p[g][m]!=null?p[g][m]:"").slice(0,L[m]);for(k.write_shift(1,R,"sbcs"),b=0;b<L[m]-R.length;++b)k.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}}(),j9=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+si(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(f,p){var v=e[p];return typeof v=="number"?IA(v):v},n=function(f,p,v){var g=p.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return g==59?f:IA(g)};e["|"]=254;function s(f,p){switch(p.type){case"base64":return o(Wl(f),p);case"binary":return o(f,p);case"buffer":return o(ma&&Buffer.isBuffer(f)?f.toString("binary"):th(f),p);case"array":return o(P0(f),p)}throw new Error("Unrecognized type "+p.type)}function o(f,p){var v=f.split(/[\n\r]+/),g=-1,m=-1,b=0,y=0,S=[],C=[],L=null,O={},H=[],z=[],q=[],D=0,W;for(+p.codepage>=0&&qc(+p.codepage);b!==v.length;++b){D=0;var P=v[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),I=P.replace(/;;/g,"\0").split(";").map(function(re){return re.replace(/\u0000/g,";")}),U=I[0],k;if(P.length>0)switch(U){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":I[1].charAt(0)=="P"&&C.push(P.slice(3).replace(/;;/g,";"));break;case"C":var _=!1,R=!1,j=!1,A=!1,N=-1,V=-1;for(y=1;y<I.length;++y)switch(I[y].charAt(0)){case"A":break;case"X":m=parseInt(I[y].slice(1))-1,R=!0;break;case"Y":for(g=parseInt(I[y].slice(1))-1,R||(m=0),W=S.length;W<=g;++W)S[W]=[];break;case"K":k=I[y].slice(1),k.charAt(0)==='"'?k=k.slice(1,k.length-1):k==="TRUE"?k=!0:k==="FALSE"?k=!1:isNaN(Xc(k))?isNaN(Um(k).getDate())||(k=Is(k)):(k=Xc(k),L!==null&&eg(L)&&(k=Pw(k))),_=!0;break;case"E":A=!0;var M=Tm(I[y].slice(1),{r:g,c:m});S[g][m]=[S[g][m],M];break;case"S":j=!0,S[g][m]=[S[g][m],"S5S"];break;case"G":break;case"R":N=parseInt(I[y].slice(1))-1;break;case"C":V=parseInt(I[y].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}if(_&&(S[g][m]&&S[g][m].length==2?S[g][m][0]=k:S[g][m]=k,L=null),j){if(A)throw new Error("SYLK shared formula cannot have own formula");var Z=N>-1&&S[N][V];if(!Z||!Z[1])throw new Error("SYLK shared formula cannot find base");S[g][m][1]=V9(Z[1],{r:g-N,c:m-V})}break;case"F":var J=0;for(y=1;y<I.length;++y)switch(I[y].charAt(0)){case"X":m=parseInt(I[y].slice(1))-1,++J;break;case"Y":for(g=parseInt(I[y].slice(1))-1,W=S.length;W<=g;++W)S[W]=[];break;case"M":D=parseInt(I[y].slice(1))/20;break;case"F":break;case"G":break;case"P":L=C[parseInt(I[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(q=I[y].slice(1).split(" "),W=parseInt(q[0],10);W<=parseInt(q[1],10);++W)D=parseInt(q[2],10),z[W-1]=D===0?{hidden:!0}:{wch:D},Hf(z[W-1]);break;case"C":m=parseInt(I[y].slice(1))-1,z[m]||(z[m]={});break;case"R":g=parseInt(I[y].slice(1))-1,H[g]||(H[g]={}),D>0?(H[g].hpt=D,H[g].hpx=Vm(D)):D===0&&(H[g].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}J<1&&(L=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}}return H.length>0&&(O["!rows"]=H),z.length>0&&(O["!cols"]=z),p&&p.sheetRows&&(S=S.slice(0,p.sheetRows)),[S,O]}function i(f,p){var v=s(f,p),g=v[0],m=v[1],b=rg(g,p);return si(m).forEach(function(y){b[y]=m[y]}),b}function c(f,p){return rh(i(f,p),p)}function u(f,p,v,g){var m="C;Y"+(v+1)+";X"+(g+1)+";K";switch(f.t){case"n":m+=f.v||0,f.f&&!f.F&&(m+=";E"+k_(f.f,{r:v,c:g}));break;case"b":m+=f.v?"TRUE":"FALSE";break;case"e":m+=f.w||f.v;break;case"d":m+='"'+(f.w||f.v)+'"';break;case"s":m+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return m}function l(f,p){p.forEach(function(v,g){var m="F;W"+(g+1)+" "+(g+1)+" ";v.hidden?m+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Hv(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=Vv(v.wpx)),typeof v.wch=="number"&&(m+=Math.round(v.wch))),m.charAt(m.length-1)!=" "&&f.push(m)})}function d(f,p){p.forEach(function(v,g){var m="F;";v.hidden?m+="M0;":v.hpt?m+="M"+20*v.hpt+";":v.hpx&&(m+="M"+20*Wv(v.hpx)+";"),m.length>2&&f.push(m+"R"+(g+1))})}function h(f,p){var v=["ID;PWXL;N;E"],g=[],m=Ba(f["!ref"]),b,y=Array.isArray(f),S=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),f["!cols"]&&l(v,f["!cols"]),f["!rows"]&&d(v,f["!rows"]),v.push("B;Y"+(m.e.r-m.s.r+1)+";X"+(m.e.c-m.s.c+1)+";D"+[m.s.c,m.s.r,m.e.c,m.e.r].join(" "));for(var C=m.s.r;C<=m.e.r;++C)for(var L=m.s.c;L<=m.e.c;++L){var O=Fn({r:C,c:L});b=y?(f[C]||[])[L]:f[O],!(!b||b.v==null&&(!b.f||b.F))&&g.push(u(b,f,C,L))}return v.join(S)+S+g.join(S)+S+"E"+S}return{to_workbook:c,to_sheet:i,from_sheet:h}}(),k9=function(){function e(o,i){switch(i.type){case"base64":return r(Wl(o),i);case"binary":return r(o,i);case"buffer":return r(ma&&Buffer.isBuffer(o)?o.toString("binary"):th(o),i);case"array":return r(P0(o),i)}throw new Error("Unrecognized type "+i.type)}function r(o,i){for(var c=o.split(`
`),u=-1,l=-1,d=0,h=[];d!==c.length;++d){if(c[d].trim()==="BOT"){h[++u]=[],l=0;continue}if(!(u<0)){var f=c[d].trim().split(","),p=f[0],v=f[1];++d;for(var g=c[d]||"";(g.match(/["]/g)||[]).length&1&&d<c.length-1;)g+=`
`+c[++d];switch(g=g.trim(),+p){case-1:if(g==="BOT"){h[++u]=[],l=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?h[u][l]=!0:g==="FALSE"?h[u][l]=!1:isNaN(Xc(v))?isNaN(Um(v).getDate())?h[u][l]=v:h[u][l]=Is(v):h[u][l]=Xc(v),++l;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),h[u][l++]=g!==""?g:null;break}if(g==="EOD")break}}return i&&i.sheetRows&&(h=h.slice(0,i.sheetRows)),h}function t(o,i){return rg(e(o,i),i)}function n(o,i){return rh(t(o,i),i)}var s=function(){var o=function(u,l,d,h,f){u.push(l),u.push(d+","+h),u.push('"'+f.replace(/"/g,'""')+'"')},i=function(u,l,d,h){u.push(l+","+d),u.push(l==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(u){var l=[],d=Ba(u["!ref"]),h,f=Array.isArray(u);o(l,"TABLE",0,1,"sheetjs"),o(l,"VECTORS",0,d.e.r-d.s.r+1,""),o(l,"TUPLES",0,d.e.c-d.s.c+1,""),o(l,"DATA",0,0,"");for(var p=d.s.r;p<=d.e.r;++p){i(l,-1,0,"BOT");for(var v=d.s.c;v<=d.e.c;++v){var g=Fn({r:p,c:v});if(h=f?(u[p]||[])[v]:u[g],!h){i(l,1,0,"");continue}switch(h.t){case"n":var m=h.w;!m&&h.v!=null&&(m=h.v),m==null?h.f&&!h.F?i(l,1,0,"="+h.f):i(l,1,0,""):i(l,0,m,"V");break;case"b":i(l,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":i(l,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=yc(h.z||On[14],Ii(Is(h.v)))),i(l,0,h.w,"V");break;default:i(l,1,0,"")}}}i(l,-1,0,"EOD");var b=`\r
`,y=l.join(b);return y}}();return{to_workbook:n,to_sheet:t,from_sheet:s}}(),R9=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(h,f){for(var p=h.split(`
`),v=-1,g=-1,m=0,b=[];m!==p.length;++m){var y=p[m].trim().split(":");if(y[0]==="cell"){var S=Gs(y[1]);if(b.length<=S.r)for(v=b.length;v<=S.r;++v)b[v]||(b[v]=[]);switch(v=S.r,g=S.c,y[2]){case"t":b[v][g]=e(y[3]);break;case"v":b[v][g]=+y[3];break;case"vtf":var C=y[y.length-1];case"vtc":switch(y[3]){case"nl":b[v][g]=!!+y[4];break;default:b[v][g]=+y[4];break}y[2]=="vtf"&&(b[v][g]=[b[v][g],C])}}}return f&&f.sheetRows&&(b=b.slice(0,f.sheetRows)),b}function n(h,f){return rg(t(h,f),f)}function s(h,f){return rh(n(h,f),f)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function l(h){if(!h||!h["!ref"])return"";for(var f=[],p=[],v,g="",m=vl(h["!ref"]),b=Array.isArray(h),y=m.s.r;y<=m.e.r;++y)for(var S=m.s.c;S<=m.e.c;++S)if(g=Fn({r:y,c:S}),v=b?(h[y]||[])[S]:h[g],!(!v||v.v==null||v.t==="z")){switch(p=["cell",g,"t"],v.t){case"s":case"str":p.push(r(v.v));break;case"n":v.f?(p[2]="vtf",p[3]="n",p[4]=v.v,p[5]=r(v.f)):(p[2]="v",p[3]=v.v);break;case"b":p[2]="vt"+(v.f?"f":"c"),p[3]="nl",p[4]=v.v?"1":"0",p[5]=r(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var C=Ii(Is(v.v));p[2]="vtc",p[3]="nd",p[4]=""+C,p[5]=v.w||yc(v.z||On[14],C);break;case"e":continue}f.push(p.join(":"))}return f.push("sheet:c:"+(m.e.c-m.s.c+1)+":r:"+(m.e.r-m.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function d(h){return[o,i,c,i,l(h),u].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}}(),Hm=function(){function e(d,h,f,p,v){v.raw?h[f][p]=d:d===""||(d==="TRUE"?h[f][p]=!0:d==="FALSE"?h[f][p]=!1:isNaN(Xc(d))?isNaN(Um(d).getDate())?h[f][p]=d:h[f][p]=Is(d):h[f][p]=Xc(d))}function r(d,h){var f=h||{},p=[];if(!d||d.length===0)return p;for(var v=d.split(/[\r\n]/),g=v.length-1;g>=0&&v[g].length===0;)--g;for(var m=10,b=0,y=0;y<=g;++y)b=v[y].indexOf(" "),b==-1?b=v[y].length:b++,m=Math.max(m,b);for(y=0;y<=g;++y){p[y]=[];var S=0;for(e(v[y].slice(0,m).trim(),p,y,S,f),S=1;S<=(v[y].length-m)/10+1;++S)e(v[y].slice(m+(S-1)*10,m+S*10).trim(),p,y,S,f)}return f.sheetRows&&(p=p.slice(0,f.sheetRows)),p}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var h={},f=!1,p=0,v=0;p<d.length;++p)(v=d.charCodeAt(p))==34?f=!f:!f&&v in t&&(h[v]=(h[v]||0)+1);v=[];for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&v.push([h[p],p]);if(!v.length){h=n;for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&v.push([h[p],p])}return v.sort(function(g,m){return g[0]-m[0]||n[g[1]]-n[m[1]]}),t[v.pop()[1]]||44}function o(d,h){var f=h||{},p="",v=f.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(p=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(p=d.charAt(4),d=d.slice(6)):p=s(d.slice(0,1024)):f&&f.FS?p=f.FS:p=s(d.slice(0,1024));var m=0,b=0,y=0,S=0,C=0,L=p.charCodeAt(0),O=!1,H=0,z=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var q=f.dateNF!=null?HK(f.dateNF):null;function D(){var W=d.slice(S,C),P={};if(W.charAt(0)=='"'&&W.charAt(W.length-1)=='"'&&(W=W.slice(1,-1).replace(/""/g,'"')),W.length===0)P.t="z";else if(f.raw)P.t="s",P.v=W;else if(W.trim().length===0)P.t="s",P.v=W;else if(W.charCodeAt(0)==61)W.charCodeAt(1)==34&&W.charCodeAt(W.length-1)==34?(P.t="s",P.v=W.slice(2,-1).replace(/""/g,'"')):xee(W)?(P.t="n",P.f=W.slice(1)):(P.t="s",P.v=W);else if(W=="TRUE")P.t="b",P.v=!0;else if(W=="FALSE")P.t="b",P.v=!1;else if(!isNaN(y=Xc(W)))P.t="n",f.cellText!==!1&&(P.w=W),P.v=y;else if(!isNaN(Um(W).getDate())||q&&W.match(q)){P.z=f.dateNF||On[14];var I=0;q&&W.match(q)&&(W=VK(W,f.dateNF,W.match(q)||[]),I=1),f.cellDates?(P.t="d",P.v=Is(W,I)):(P.t="n",P.v=Ii(Is(W,I))),f.cellText!==!1&&(P.w=yc(P.z,P.v instanceof Date?Ii(P.v):P.v)),f.cellNF||delete P.z}else P.t="s",P.v=W;if(P.t=="z"||(f.dense?(v[m]||(v[m]=[]),v[m][b]=P):v[Fn({c:b,r:m})]=P),S=C+1,z=d.charCodeAt(S),g.e.c<b&&(g.e.c=b),g.e.r<m&&(g.e.r=m),H==L)++b;else if(b=0,++m,f.sheetRows&&f.sheetRows<=m)return!0}e:for(;C<d.length;++C)switch(H=d.charCodeAt(C)){case 34:z===34&&(O=!O);break;case L:case 10:case 13:if(!O&&D())break e;break}return C-S>0&&D(),v["!ref"]=Jn(g),v}function i(d,h){return!(h&&h.PRN)||h.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?o(d,h):rg(r(d,h),h)}function c(d,h){var f="",p=h.type=="string"?[0,0,0,0]:I_(d,h);switch(h.type){case"base64":f=Wl(d);break;case"binary":f=d;break;case"buffer":h.codepage==65001?f=d.toString("utf8"):(h.codepage,f=ma&&Buffer.isBuffer(d)?d.toString("binary"):th(d));break;case"array":f=P0(d);break;case"string":f=d;break;default:throw new Error("Unrecognized type "+h.type)}return p[0]==239&&p[1]==187&&p[2]==191?f=hs(f.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?f=hs(f):h.type=="binary",f.slice(0,19)=="socialcalc:version:"?R9.to_sheet(h.type=="string"?f:hs(f),h):i(f,h)}function u(d,h){return rh(c(d,h),h)}function l(d){for(var h=[],f=Ba(d["!ref"]),p,v=Array.isArray(d),g=f.s.r;g<=f.e.r;++g){for(var m=[],b=f.s.c;b<=f.e.c;++b){var y=Fn({r:g,c:b});if(p=v?(d[g]||[])[b]:d[y],!p||p.v==null){m.push("          ");continue}for(var S=(p.w||(Fd(p),p.w)||"").slice(0,10);S.length<10;)S+=" ";m.push(S+(b===0?" ":""))}h.push(m.join(""))}return h.join(`
`)}return{to_workbook:u,to_sheet:c,from_sheet:l}}();function aJ(e,r){var t=r||{},n=!!t.WTF;t.WTF=!0;try{var s=j9.to_workbook(e,t);return t.WTF=n,s}catch(o){if(t.WTF=n,!o.message.match(/SYLK bad record ID/)&&n)throw o;return Hm.to_workbook(e,r)}}var N0=function(){function e(M,Z,J){if(M){oo(M,M.l||0);for(var re=J.Enum||N;M.l<M.length;){var X=M.read_shift(2),ne=re[X]||re[65535],Y=M.read_shift(2),K=M.l+Y,ee=ne.f&&ne.f(M,Y,J);if(M.l=K,Z(ee,ne,X))return}}}function r(M,Z){switch(Z.type){case"base64":return t($l(Wl(M)),Z);case"binary":return t($l(M),Z);case"buffer":case"array":return t(M,Z)}throw"Unsupported type "+Z.type}function t(M,Z){if(!M)return M;var J=Z||{},re=J.dense?[]:{},X="Sheet1",ne="",Y=0,K={},ee=[],ue=[],se={s:{r:0,c:0},e:{r:0,c:0}},ce=J.sheetRows||0;if(M[2]==0&&(M[3]==8||M[3]==9)&&M.length>=16&&M[14]==5&&M[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(M[2]==2)J.Enum=N,e(M,function(le,ke,Te){switch(Te){case 0:J.vers=le,le>=4096&&(J.qpro=!0);break;case 6:se=le;break;case 204:le&&(ne=le);break;case 222:ne=le;break;case 15:case 51:J.qpro||(le[1].v=le[1].v.slice(1));case 13:case 14:case 16:Te==14&&(le[2]&112)==112&&(le[2]&15)>1&&(le[2]&15)<15&&(le[1].z=J.dateNF||On[14],J.cellDates&&(le[1].t="d",le[1].v=Pw(le[1].v))),J.qpro&&le[3]>Y&&(re["!ref"]=Jn(se),K[X]=re,ee.push(X),re=J.dense?[]:{},se={s:{r:0,c:0},e:{r:0,c:0}},Y=le[3],X=ne||"Sheet"+(Y+1),ne="");var pe=J.dense?(re[le[0].r]||[])[le[0].c]:re[Fn(le[0])];if(pe){pe.t=le[1].t,pe.v=le[1].v,le[1].z!=null&&(pe.z=le[1].z),le[1].f!=null&&(pe.f=le[1].f);break}J.dense?(re[le[0].r]||(re[le[0].r]=[]),re[le[0].r][le[0].c]=le[1]):re[Fn(le[0])]=le[1];break}},J);else if(M[2]==26||M[2]==14)J.Enum=V,M[2]==14&&(J.qpro=!0,M.l=0),e(M,function(le,ke,Te){switch(Te){case 204:X=le;break;case 22:le[1].v=le[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(le[3]>Y&&(re["!ref"]=Jn(se),K[X]=re,ee.push(X),re=J.dense?[]:{},se={s:{r:0,c:0},e:{r:0,c:0}},Y=le[3],X="Sheet"+(Y+1)),ce>0&&le[0].r>=ce)break;J.dense?(re[le[0].r]||(re[le[0].r]=[]),re[le[0].r][le[0].c]=le[1]):re[Fn(le[0])]=le[1],se.e.c<le[0].c&&(se.e.c=le[0].c),se.e.r<le[0].r&&(se.e.r=le[0].r);break;case 27:le[14e3]&&(ue[le[14e3][0]]=le[14e3][1]);break;case 1537:ue[le[0]]=le[1],le[0]==Y&&(X=le[1]);break}},J);else throw new Error("Unrecognized LOTUS BOF "+M[2]);if(re["!ref"]=Jn(se),K[ne||X]=re,ee.push(ne||X),!ue.length)return{SheetNames:ee,Sheets:K};for(var fe={},ve=[],_e=0;_e<ue.length;++_e)K[ee[_e]]?(ve.push(ue[_e]||ee[_e]),fe[ue[_e]]=K[ue[_e]]||K[ee[_e]]):(ve.push(ue[_e]),fe[ue[_e]]={"!ref":"A1"});return{SheetNames:ve,Sheets:fe}}function n(M,Z){var J=Z||{};if(+J.codepage>=0&&qc(+J.codepage),J.type=="string")throw new Error("Cannot write WK1 to JS string");var re=ml(),X=Ba(M["!ref"]),ne=Array.isArray(M),Y=[];$r(re,0,o(1030)),$r(re,6,u(X));for(var K=Math.min(X.e.r,8191),ee=X.s.r;ee<=K;++ee)for(var ue=bi(ee),se=X.s.c;se<=X.e.c;++se){ee===X.s.r&&(Y[se]=qs(se));var ce=Y[se]+ue,fe=ne?(M[ee]||[])[se]:M[ce];if(!(!fe||fe.t=="z"))if(fe.t=="n")(fe.v|0)==fe.v&&fe.v>=-32768&&fe.v<=32767?$r(re,13,p(ee,se,fe.v)):$r(re,14,g(ee,se,fe.v));else{var ve=Fd(fe);$r(re,15,h(ee,se,ve.slice(0,239)))}}return $r(re,1),re.end()}function s(M,Z){var J=Z||{};if(+J.codepage>=0&&qc(+J.codepage),J.type=="string")throw new Error("Cannot write WK3 to JS string");var re=ml();$r(re,0,i(M));for(var X=0,ne=0;X<M.SheetNames.length;++X)(M.Sheets[M.SheetNames[X]]||{})["!ref"]&&$r(re,27,A(M.SheetNames[X],ne++));var Y=0;for(X=0;X<M.SheetNames.length;++X){var K=M.Sheets[M.SheetNames[X]];if(!(!K||!K["!ref"])){for(var ee=Ba(K["!ref"]),ue=Array.isArray(K),se=[],ce=Math.min(ee.e.r,8191),fe=ee.s.r;fe<=ce;++fe)for(var ve=bi(fe),_e=ee.s.c;_e<=ee.e.c;++_e){fe===ee.s.r&&(se[_e]=qs(_e));var le=se[_e]+ve,ke=ue?(K[fe]||[])[_e]:K[le];if(!(!ke||ke.t=="z"))if(ke.t=="n")$r(re,23,D(fe,_e,Y,ke.v));else{var Te=Fd(ke);$r(re,22,H(fe,_e,Y,Te.slice(0,239)))}}++Y}}return $r(re,1),re.end()}function o(M){var Z=dr(2);return Z.write_shift(2,M),Z}function i(M){var Z=dr(26);Z.write_shift(2,4096),Z.write_shift(2,4),Z.write_shift(4,0);for(var J=0,re=0,X=0,ne=0;ne<M.SheetNames.length;++ne){var Y=M.SheetNames[ne],K=M.Sheets[Y];if(!(!K||!K["!ref"])){++X;var ee=vl(K["!ref"]);J<ee.e.r&&(J=ee.e.r),re<ee.e.c&&(re=ee.e.c)}}return J>8191&&(J=8191),Z.write_shift(2,J),Z.write_shift(1,X),Z.write_shift(1,re),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(1,1),Z.write_shift(1,2),Z.write_shift(4,0),Z.write_shift(4,0),Z}function c(M,Z,J){var re={s:{c:0,r:0},e:{c:0,r:0}};return Z==8&&J.qpro?(re.s.c=M.read_shift(1),M.l++,re.s.r=M.read_shift(2),re.e.c=M.read_shift(1),M.l++,re.e.r=M.read_shift(2),re):(re.s.c=M.read_shift(2),re.s.r=M.read_shift(2),Z==12&&J.qpro&&(M.l+=2),re.e.c=M.read_shift(2),re.e.r=M.read_shift(2),Z==12&&J.qpro&&(M.l+=2),re.s.c==65535&&(re.s.c=re.e.c=re.s.r=re.e.r=0),re)}function u(M){var Z=dr(8);return Z.write_shift(2,M.s.c),Z.write_shift(2,M.s.r),Z.write_shift(2,M.e.c),Z.write_shift(2,M.e.r),Z}function l(M,Z,J){var re=[{c:0,r:0},{t:"n",v:0},0,0];return J.qpro&&J.vers!=20768?(re[0].c=M.read_shift(1),re[3]=M.read_shift(1),re[0].r=M.read_shift(2),M.l+=2):(re[2]=M.read_shift(1),re[0].c=M.read_shift(2),re[0].r=M.read_shift(2)),re}function d(M,Z,J){var re=M.l+Z,X=l(M,Z,J);if(X[1].t="s",J.vers==20768){M.l++;var ne=M.read_shift(1);return X[1].v=M.read_shift(ne,"utf8"),X}return J.qpro&&M.l++,X[1].v=M.read_shift(re-M.l,"cstr"),X}function h(M,Z,J){var re=dr(7+J.length);re.write_shift(1,255),re.write_shift(2,Z),re.write_shift(2,M),re.write_shift(1,39);for(var X=0;X<re.length;++X){var ne=J.charCodeAt(X);re.write_shift(1,ne>=128?95:ne)}return re.write_shift(1,0),re}function f(M,Z,J){var re=l(M,Z,J);return re[1].v=M.read_shift(2,"i"),re}function p(M,Z,J){var re=dr(7);return re.write_shift(1,255),re.write_shift(2,Z),re.write_shift(2,M),re.write_shift(2,J,"i"),re}function v(M,Z,J){var re=l(M,Z,J);return re[1].v=M.read_shift(8,"f"),re}function g(M,Z,J){var re=dr(13);return re.write_shift(1,255),re.write_shift(2,Z),re.write_shift(2,M),re.write_shift(8,J,"f"),re}function m(M,Z,J){var re=M.l+Z,X=l(M,Z,J);if(X[1].v=M.read_shift(8,"f"),J.qpro)M.l=re;else{var ne=M.read_shift(2);C(M.slice(M.l,M.l+ne),X),M.l+=ne}return X}function b(M,Z,J){var re=Z&32768;return Z&=-32769,Z=(re?M:0)+(Z>=8192?Z-16384:Z),(re?"":"$")+(J?qs(Z):bi(Z))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(M,Z){oo(M,0);for(var J=[],re=0,X="",ne="",Y="",K="";M.l<M.length;){var ee=M[M.l++];switch(ee){case 0:J.push(M.read_shift(8,"f"));break;case 1:ne=b(Z[0].c,M.read_shift(2),!0),X=b(Z[0].r,M.read_shift(2),!1),J.push(ne+X);break;case 2:{var ue=b(Z[0].c,M.read_shift(2),!0),se=b(Z[0].r,M.read_shift(2),!1);ne=b(Z[0].c,M.read_shift(2),!0),X=b(Z[0].r,M.read_shift(2),!1),J.push(ue+se+":"+ne+X)}break;case 3:if(M.l<M.length){console.error("WK1 premature formula end");return}break;case 4:J.push("("+J.pop()+")");break;case 5:J.push(M.read_shift(2));break;case 6:{for(var ce="";ee=M[M.l++];)ce+=String.fromCharCode(ee);J.push('"'+ce.replace(/"/g,'""')+'"')}break;case 8:J.push("-"+J.pop());break;case 23:J.push("+"+J.pop());break;case 22:J.push("NOT("+J.pop()+")");break;case 20:case 21:K=J.pop(),Y=J.pop(),J.push(["AND","OR"][ee-20]+"("+Y+","+K+")");break;default:if(ee<32&&S[ee])K=J.pop(),Y=J.pop(),J.push(Y+S[ee]+K);else if(y[ee]){if(re=y[ee][1],re==69&&(re=M[M.l++]),re>J.length){console.error("WK1 bad formula parse 0x"+ee.toString(16)+":|"+J.join("|")+"|");return}var fe=J.slice(-re);J.length-=re,J.push(y[ee][0]+"("+fe.join(",")+")")}else return ee<=7?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=24?console.error("WK1 unsupported op "+ee.toString(16)):ee<=30?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=115?console.error("WK1 unsupported function opcode "+ee.toString(16)):console.error("WK1 unrecognized opcode "+ee.toString(16))}}J.length==1?Z[1].f=""+J[0]:console.error("WK1 bad formula parse |"+J.join("|")+"|")}function L(M){var Z=[{c:0,r:0},{t:"n",v:0},0];return Z[0].r=M.read_shift(2),Z[3]=M[M.l++],Z[0].c=M[M.l++],Z}function O(M,Z){var J=L(M);return J[1].t="s",J[1].v=M.read_shift(Z-4,"cstr"),J}function H(M,Z,J,re){var X=dr(6+re.length);X.write_shift(2,M),X.write_shift(1,J),X.write_shift(1,Z),X.write_shift(1,39);for(var ne=0;ne<re.length;++ne){var Y=re.charCodeAt(ne);X.write_shift(1,Y>=128?95:Y)}return X.write_shift(1,0),X}function z(M,Z){var J=L(M);J[1].v=M.read_shift(2);var re=J[1].v>>1;if(J[1].v&1)switch(re&7){case 0:re=(re>>3)*5e3;break;case 1:re=(re>>3)*500;break;case 2:re=(re>>3)/20;break;case 3:re=(re>>3)/200;break;case 4:re=(re>>3)/2e3;break;case 5:re=(re>>3)/2e4;break;case 6:re=(re>>3)/16;break;case 7:re=(re>>3)/64;break}return J[1].v=re,J}function q(M,Z){var J=L(M),re=M.read_shift(4),X=M.read_shift(4),ne=M.read_shift(2);if(ne==65535)return re===0&&X===3221225472?(J[1].t="e",J[1].v=15):re===0&&X===3489660928?(J[1].t="e",J[1].v=42):J[1].v=0,J;var Y=ne&32768;return ne=(ne&32767)-16446,J[1].v=(1-Y*2)*(X*Math.pow(2,ne+32)+re*Math.pow(2,ne)),J}function D(M,Z,J,re){var X=dr(14);if(X.write_shift(2,M),X.write_shift(1,J),X.write_shift(1,Z),re==0)return X.write_shift(4,0),X.write_shift(4,0),X.write_shift(2,65535),X;var ne=0,Y=0,K=0,ee=0;return re<0&&(ne=1,re=-re),Y=Math.log2(re)|0,re/=Math.pow(2,Y-31),ee=re>>>0,(ee&2147483648)==0&&(re/=2,++Y,ee=re>>>0),re-=ee,ee|=2147483648,ee>>>=0,re*=Math.pow(2,32),K=re>>>0,X.write_shift(4,K),X.write_shift(4,ee),Y+=16383+(ne?32768:0),X.write_shift(2,Y),X}function W(M,Z){var J=q(M);return M.l+=Z-14,J}function P(M,Z){var J=L(M),re=M.read_shift(4);return J[1].v=re>>6,J}function I(M,Z){var J=L(M),re=M.read_shift(8,"f");return J[1].v=re,J}function U(M,Z){var J=I(M);return M.l+=Z-10,J}function k(M,Z){return M[M.l+Z-1]==0?M.read_shift(Z,"cstr"):""}function _(M,Z){var J=M[M.l++];J>Z-1&&(J=Z-1);for(var re="";re.length<J;)re+=String.fromCharCode(M[M.l++]);return re}function R(M,Z,J){if(!(!J.qpro||Z<21)){var re=M.read_shift(1);M.l+=17,M.l+=1,M.l+=2;var X=M.read_shift(Z-21,"cstr");return[re,X]}}function j(M,Z){for(var J={},re=M.l+Z;M.l<re;){var X=M.read_shift(2);if(X==14e3){for(J[X]=[0,""],J[X][0]=M.read_shift(2);M[M.l];)J[X][1]+=String.fromCharCode(M[M.l]),M.l++;M.l++}}return J}function A(M,Z){var J=dr(5+M.length);J.write_shift(2,14e3),J.write_shift(2,Z);for(var re=0;re<M.length;++re){var X=M.charCodeAt(re);J[J.l++]=X>127?95:X}return J[J.l++]=0,J}var N={0:{n:"BOF",f:Ri},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:m},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:k},222:{n:"SHEETNAMELP",f:_},65535:{n:""}},V={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:O},23:{n:"NUMBER17",f:q},24:{n:"NUMBER18",f:z},25:{n:"FORMULA19",f:W},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:j},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:I},40:{n:"FORMULA28",f:U},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:k},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:R},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:r}}();function sJ(e){var r={},t=e.match(Mo),n=0,s=!1;if(t)for(;n!=t.length;++n){var o=Bn(t[n]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;r.cp=J6[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=o.val;break;case"<sz":r.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":o.rgb&&(r.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(o[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+o[0])}}return r}var iJ=function(){var e=Fv("t"),r=Fv("rPr");function t(o){var i=o.match(e);if(!i)return{t:"s",v:""};var c={t:"s",v:Fa(i[1])},u=o.match(r);return u&&(c.s=sJ(u[1])),c}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(t).filter(function(c){return c.v})}}(),oJ=function(){var r=/(\r\n|\n)/g;function t(s,o,i){var c=[];s.u&&c.push("text-decoration: underline;"),s.uval&&c.push("text-underline-style:"+s.uval+";"),s.sz&&c.push("font-size:"+s.sz+"pt;"),s.outline&&c.push("text-effect: outline;"),s.shadow&&c.push("text-shadow: auto;"),o.push('<span style="'+c.join("")+'">'),s.b&&(o.push("<b>"),i.push("</b>")),s.i&&(o.push("<i>"),i.push("</i>")),s.strike&&(o.push("<s>"),i.push("</s>"));var u=s.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(o.push("<"+u+">"),i.push("</"+u+">")),i.push("</span>"),s}function n(s){var o=[[],s.v,[]];return s.v?(s.s&&t(s.s,o[0],o[2]),o[0].join("")+o[1].replace(r,"<br/>")+o[2].join("")):""}return function(o){return o.map(n).join("")}}(),lJ=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,cJ=/<(?:\w+:)?r>/,uJ=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function S_(e,r){var t=r?r.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Fa(hs(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=hs(e),t&&(n.h=l_(n.t))):e.match(cJ)&&(n.r=hs(e),n.t=Fa(hs((e.replace(uJ,"").match(lJ)||[]).join("").replace(Mo,""))),t&&(n.h=oJ(iJ(n.r)))),n):{t:""}}var dJ=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,fJ=/<(?:\w+:)?(?:si|sstItem)>/g,hJ=/<\/(?:\w+:)?(?:si|sstItem)>/;function pJ(e,r){var t=[],n="";if(!e)return t;var s=e.match(dJ);if(s){n=s[2].replace(fJ,"").split(hJ);for(var o=0;o!=n.length;++o){var i=S_(n[o].trim(),r);i!=null&&(t[t.length]=i)}s=Bn(s[1]),t.Count=s.count,t.Unique=s.uniqueCount}return t}var mJ=/^\s|\s$|[\t\n\r]/;function E9(e,r){if(!r.bookSST)return"";var t=[wi];t[t.length]=zr("sst",null,{xmlns:K0[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],o="<si>";s.r?o+=s.r:(o+="<t",s.t||(s.t=""),s.t.match(mJ)&&(o+=' xml:space="preserve"'),o+=">"+os(s.t)+"</t>"),o+="</si>",t[t.length]=o}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function gJ(e){return[e.read_shift(4),e.read_shift(4)]}function vJ(e,r){var t=[],n=!1;return $d(e,function(o,i,c){switch(c){case 159:t.Count=o[0],t.Unique=o[1];break;case 19:t.push(o);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||r.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),t}function xJ(e,r){return r||(r=dr(8)),r.write_shift(4,e.Count),r.write_shift(4,e.Unique),r}var bJ=EX;function yJ(e){var r=ml();Er(r,159,xJ(e));for(var t=0;t<e.length;++t)Er(r,19,bJ(e[t]));return Er(r,160),r.end()}function N9(e){for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function Ld(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function wJ(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=Ld(e,4),r.U=Ld(e,4),r.W=Ld(e,4),r}function SJ(e){for(var r=e.read_shift(4),t=e.l+r-4,n={},s=e.read_shift(4),o=[];s-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=o,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return n}function _J(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(SJ(e));return r}function AJ(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function CJ(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=Ld(e,4),r.U=Ld(e,4),r.W=Ld(e,4),r}function jJ(e){var r=CJ(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function T9(e,r){var t=e.l+r,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,n}function L9(e,r){var t={},n=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,n),e.l=n,t}function kJ(e){var r=Ld(e);switch(r.Minor){case 2:return[r.Minor,RJ(e)];case 3:return[r.Minor,EJ()];case 4:return[r.Minor,NJ(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function RJ(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),n=T9(e,t),s=L9(e,e.length-e.l);return{t:"Std",h:n,v:s}}function EJ(){throw new Error("File is password-protected: ECMA-376 Extensible")}function NJ(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),n={};return t.replace(Mo,function(o){var i=Bn(o);switch(Xu(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(c){n[c]=i[c]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function TJ(e,r){var t={},n=t.EncryptionVersionInfo=Ld(e,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=e.read_shift(4),r-=4;var s=e.read_shift(4);return r-=4,t.EncryptionHeader=T9(e,s),r-=s,t.EncryptionVerifier=L9(e,r),t}function LJ(e){var r={},t=r.EncryptionVersionInfo=Ld(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function __(e){var r=0,t,n=N9(e),s=n.length+1,o,i,c,u,l;for(t=Uf(s),t[0]=n.length,o=1;o!=s;++o)t[o]=n[o-1];for(o=s-1;o>=0;--o)i=t[o],c=(r&16384)===0?0:1,u=r<<1&32767,l=c|u,r=l^i;return r^52811}var M9=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,c){return n(i^c)},o=function(i){for(var c=r[i.length-1],u=104,l=i.length-1;l>=0;--l)for(var d=i[l],h=0;h!=7;++h)d&64&&(c^=t[u]),d*=2,--u;return c};return function(i){for(var c=N9(i),u=o(c),l=c.length,d=Uf(16),h=0;h!=16;++h)d[h]=0;var f,p,v;for((l&1)===1&&(f=u>>8,d[l]=s(e[0],f),--l,f=u&255,p=c[c.length-1],d[l]=s(p,f));l>0;)--l,f=u>>8,d[l]=s(c[l],f),--l,f=u&255,d[l]=s(c[l],f);for(l=15,v=15-c.length;v>0;)f=u>>8,d[l]=s(e[v],f),--l,--v,f=u&255,d[l]=s(c[l],f),--l,--v;return d}}(),MJ=function(e,r,t,n,s){s||(s=r),n||(n=M9(e));var o,i;for(o=0;o!=r.length;++o)i=r[o],i^=n[t],i=(i>>5|i<<3)&255,s[o]=i,++t;return[s,t,n]},DJ=function(e){var r=0,t=M9(e);return function(n){var s=MJ("",n,r,t);return r=s[1],s[0]}};function IJ(e,r,t,n){var s={key:Ri(e),verificationBytes:Ri(e)};return t.password&&(s.verifier=__(t.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=DJ(t.password)),s}function OJ(e,r,t){var n=t||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=LJ(e):n.Data=TJ(e,r),n}function PJ(e,r,t){var n={Type:t.biff>=8?e.read_shift(2):0};return n.Type?OJ(e,r-2,n):IJ(e,t.biff>=8?r:r-2,t,n),n}var D9=function(){function e(s,o){switch(o.type){case"base64":return r(Wl(s),o);case"binary":return r(s,o);case"buffer":return r(ma&&Buffer.isBuffer(s)?s.toString("binary"):th(s),o);case"array":return r(P0(s),o)}throw new Error("Unrecognized type "+o.type)}function r(s,o){var i=o||{},c=i.dense?[]:{},u=s.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(d,h){Array.isArray(c)&&(c[h]=[]);for(var f=/\\\w+\b/g,p=0,v,g=-1;v=f.exec(d);){switch(v[0]){case"\\cell":var m=d.slice(p,f.lastIndex-v[0].length);if(m[0]==" "&&(m=m.slice(1)),++g,m.length){var b={v:m,t:"s"};Array.isArray(c)?c[h][g]=b:c[Fn({r:h,c:g})]=b}break}p=f.lastIndex}g>l.e.c&&(l.e.c=g)}),c["!ref"]=Jn(l),c}function t(s,o){return rh(e(s,o),o)}function n(s){for(var o=["{\\rtf1\\ansi"],i=Ba(s["!ref"]),c,u=Array.isArray(s),l=i.s.r;l<=i.e.r;++l){o.push("\\trowd\\trautofit1");for(var d=i.s.c;d<=i.e.c;++d)o.push("\\cellx"+(d+1));for(o.push("\\pard\\intbl"),d=i.s.c;d<=i.e.c;++d){var h=Fn({r:l,c:d});c=u?(s[l]||[])[d]:s[h],!(!c||c.v==null&&(!c.f||c.F))&&(o.push(" "+(c.w||(Fd(c),c.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:n}}();function FJ(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Uv(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function BJ(e){var r=e[0]/255,t=e[1]/255,n=e[2]/255,s=Math.max(r,t,n),o=Math.min(r,t,n),i=s-o;if(i===0)return[0,0,r];var c=0,u=0,l=s+o;switch(u=i/(l>1?2-l:l),s){case r:c=((t-n)/i+6)%6;break;case t:c=(n-r)/i+2;break;case n:c=(r-t)/i+4;break}return[c/6,u,l/2]}function zJ(e){var r=e[0],t=e[1],n=e[2],s=t*2*(n<.5?n:1-n),o=n-s/2,i=[o,o,o],c=6*r,u;if(t!==0)switch(c|0){case 0:case 6:u=s*c,i[0]+=s,i[1]+=u;break;case 1:u=s*(2-c),i[0]+=u,i[1]+=s;break;case 2:u=s*(c-2),i[1]+=s,i[2]+=u;break;case 3:u=s*(4-c),i[1]+=u,i[2]+=s;break;case 4:u=s*(c-4),i[2]+=s,i[0]+=u;break;case 5:u=s*(6-c),i[2]+=u,i[0]+=s;break}for(var l=0;l!=3;++l)i[l]=Math.round(i[l]*255);return i}function O2(e,r){if(r===0)return e;var t=BJ(FJ(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),Uv(zJ(t))}var I9=6,$J=15,UJ=1,Ro=I9;function Hv(e){return Math.floor((e+Math.round(128/Ro)/256)*Ro)}function Vv(e){return Math.floor((e-5)/Ro*100+.5)/100}function P2(e){return Math.round((e*Ro+5)/Ro*256)/256}function S3(e){return P2(Vv(Hv(e)))}function A_(e){var r=Math.abs(e-S3(e)),t=Ro;if(r>.005)for(Ro=UJ;Ro<$J;++Ro)Math.abs(e-S3(e))<=r&&(r=Math.abs(e-S3(e)),t=Ro);Ro=t}function Hf(e){e.width?(e.wpx=Hv(e.width),e.wch=Vv(e.wpx),e.MDW=Ro):e.wpx?(e.wch=Vv(e.wpx),e.width=P2(e.wch),e.MDW=Ro):typeof e.wch=="number"&&(e.width=P2(e.wch),e.wpx=Hv(e.width),e.MDW=Ro),e.customWidth&&delete e.customWidth}var HJ=96,O9=HJ;function Wv(e){return e*96/O9}function Vm(e){return e*O9/96}var VJ={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function WJ(e,r,t,n){r.Borders=[];var s={},o=!1;(e[0].match(Mo)||[]).forEach(function(i){var c=Bn(i);switch(Xu(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},c.diagonalUp&&(s.diagonalUp=Ds(c.diagonalUp)),c.diagonalDown&&(s.diagonalDown=Ds(c.diagonalDown)),r.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+c[0]+" in borders")}})}function qJ(e,r,t,n){r.Fills=[];var s={},o=!1;(e[0].match(Mo)||[]).forEach(function(i){var c=Bn(i);switch(Xu(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},r.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":c.patternType&&(s.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),c.indexed&&(s.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(s.bgColor.theme=parseInt(c.theme,10)),c.tint&&(s.bgColor.tint=parseFloat(c.tint)),c.rgb&&(s.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),c.theme&&(s.fgColor.theme=parseInt(c.theme,10)),c.tint&&(s.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(s.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+c[0]+" in fills")}})}function GJ(e,r,t,n){r.Fonts=[];var s={},o=!1;(e[0].match(Mo)||[]).forEach(function(i){var c=Bn(i);switch(Xu(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(s),s={};break;case"<name":c.val&&(s.name=hs(c.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=c.val?Ds(c.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=c.val?Ds(c.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(c.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=c.val?Ds(c.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=c.val?Ds(c.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=c.val?Ds(c.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=c.val?Ds(c.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=c.val?Ds(c.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":c.val&&(s.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(s.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(s.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(s.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=J6[parseInt(c.val,10)];break;case"<color":if(s.color||(s.color={}),c.auto&&(s.color.auto=Ds(c.auto)),c.rgb)s.color.rgb=c.rgb.slice(-6);else if(c.indexed){s.color.index=parseInt(c.indexed,10);var u=R0[s.color.index];s.color.index==81&&(u=R0[1]),u||(u=R0[1]),s.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else c.theme&&(s.color.theme=parseInt(c.theme,10),c.tint&&(s.color.tint=parseFloat(c.tint)),c.theme&&t.themeElements&&t.themeElements.clrScheme&&(s.color.rgb=O2(t.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+c[0]+" in fonts")}})}function KJ(e,r,t){r.NumberFmt=[];for(var n=si(On),s=0;s<n.length;++s)r.NumberFmt[n[s]]=On[n[s]];var o=e[0].match(Mo);if(o)for(s=0;s<o.length;++s){var i=Bn(o[s]);switch(Xu(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Fa(hs(i.formatCode)),u=parseInt(i.numFmtId,10);if(r.NumberFmt[u]=c,u>0){if(u>392){for(u=392;u>60&&r.NumberFmt[u]!=null;--u);r.NumberFmt[u]=c}Td(c,u)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function XJ(e){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)e[n]!=null&&(r[r.length]=zr("numFmt",null,{numFmtId:n,formatCode:os(e[n])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=zr("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var My=["numFmtId","fillId","fontId","borderId","xfId"],Dy=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function YJ(e,r,t){r.CellXf=[];var n,s=!1;(e[0].match(Mo)||[]).forEach(function(o){var i=Bn(o),c=0;switch(Xu(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],c=0;c<My.length;++c)n[My[c]]&&(n[My[c]]=parseInt(n[My[c]],10));for(c=0;c<Dy.length;++c)n[Dy[c]]&&(n[Dy[c]]=Ds(n[Dy[c]]));if(r.NumberFmt&&n.numFmtId>392){for(c=392;c>60;--c)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[c]){n.numFmtId=c;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};i.vertical&&(u.vertical=i.vertical),i.horizontal&&(u.horizontal=i.horizontal),i.textRotation!=null&&(u.textRotation=i.textRotation),i.indent&&(u.indent=i.indent),i.wrapText&&(u.wrapText=Ds(i.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(t&&t.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function ZJ(e){var r=[];return r[r.length]=zr("cellXfs",null),e.forEach(function(t){r[r.length]=zr("xf",null,t)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=zr("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var JJ=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,u,l){var d={};if(!c)return d;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=c.match(r))&&KJ(h,d,l),(h=c.match(s))&&GJ(h,d,u,l),(h=c.match(n))&&qJ(h,d,u,l),(h=c.match(o))&&WJ(h,d,u,l),(h=c.match(t))&&YJ(h,d,l),d}}();function P9(e,r){var t=[wi,zr("styleSheet",null,{xmlns:K0[0],"xmlns:vt":Mi.vt})],n;return e.SSF&&(n=XJ(e.SSF))!=null&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=ZJ(r.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function QJ(e,r){var t=e.read_shift(2),n=To(e);return[t,n]}function eQ(e,r,t){t||(t=dr(6+4*r.length)),t.write_shift(2,e),Gi(r,t);var n=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),n}function tQ(e,r,t){var n={};n.sz=e.read_shift(2)/20;var s=OX(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var o=e.read_shift(2);switch(o===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var c=e.read_shift(1);c>0&&(n.family=c);var u=e.read_shift(1);switch(u>0&&(n.charset=u),e.l++,n.color=IX(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=To(e),n}function rQ(e,r){r||(r=dr(25+4*32)),r.write_shift(2,e.sz*20),PX(e,r),r.write_shift(2,e.bold?700:400);var t=0;e.vertAlign=="superscript"?t=1:e.vertAlign=="subscript"&&(t=2),r.write_shift(2,t),r.write_shift(1,e.underline||0),r.write_shift(1,e.family||0),r.write_shift(1,e.charset||0),r.write_shift(1,0),M2(e.color,r);var n=0;return n=2,r.write_shift(1,n),Gi(e.name,r),r.length>r.l?r.slice(0,r.l):r}var nQ=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],_3,aQ=Lo;function CC(e,r){r||(r=dr(4*3+8*7+16*1)),_3||(_3=Iw(nQ));var t=_3[e.patternType];t==null&&(t=40),r.write_shift(4,t);var n=0;if(t!=40)for(M2({auto:1},r),M2({auto:1},r);n<12;++n)r.write_shift(4,0);else{for(;n<4;++n)r.write_shift(4,0);for(;n<12;++n)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function sQ(e,r){var t=e.l+r,n=e.read_shift(2),s=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:s}}function F9(e,r,t){t||(t=dr(16)),t.write_shift(2,r||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var n=0;return t.write_shift(1,n),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function U1(e,r){return r||(r=dr(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var iQ=Lo;function oQ(e,r){return r||(r=dr(51)),r.write_shift(1,0),U1(null,r),U1(null,r),U1(null,r),U1(null,r),U1(null,r),r.length>r.l?r.slice(0,r.l):r}function lQ(e,r){return r||(r=dr(12+4*10)),r.write_shift(4,e.xfId),r.write_shift(2,1),r.write_shift(1,0),r.write_shift(1,0),L2(e.name||"",r),r.length>r.l?r.slice(0,r.l):r}function cQ(e,r,t){var n=dr(2052);return n.write_shift(4,e),L2(r,n),L2(t,n),n.length>n.l?n.slice(0,n.l):n}function uQ(e,r,t){var n={};n.NumberFmt=[];for(var s in On)n.NumberFmt[s]=On[s];n.CellXf=[],n.Fonts=[];var o=[],i=!1;return $d(e,function(u,l,d){switch(d){case 44:n.NumberFmt[u[0]]=u[1],Td(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(u.color.rgb=O2(r.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:o.push(d),i=!0;break;case 38:o.pop(),i=!1;break;default:if(l.T>0)o.push(d);else if(l.T<0)o.pop();else if(!i||t.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function dQ(e,r){if(r){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)r[s]!=null&&++t}),t!=0&&(Er(e,615,Yc(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)r[s]!=null&&Er(e,44,eQ(s,r[s]))}),Er(e,616))}}function fQ(e){var r=1;Er(e,611,Yc(r)),Er(e,43,rQ({sz:12,color:{theme:1},name:"Calibri",family:2})),Er(e,612)}function hQ(e){var r=2;Er(e,603,Yc(r)),Er(e,45,CC({patternType:"none"})),Er(e,45,CC({patternType:"gray125"})),Er(e,604)}function pQ(e){var r=1;Er(e,613,Yc(r)),Er(e,46,oQ()),Er(e,614)}function mQ(e){var r=1;Er(e,626,Yc(r)),Er(e,47,F9({numFmtId:0},65535)),Er(e,627)}function gQ(e,r){Er(e,617,Yc(r.length)),r.forEach(function(t){Er(e,47,F9(t,0))}),Er(e,618)}function vQ(e){var r=1;Er(e,619,Yc(r)),Er(e,48,lQ({xfId:0,name:"Normal"})),Er(e,620)}function xQ(e){var r=0;Er(e,505,Yc(r)),Er(e,506)}function bQ(e){var r=0;Er(e,508,cQ(r,"TableStyleMedium9","PivotStyleMedium4")),Er(e,509)}function yQ(e,r){var t=ml();return Er(t,278),dQ(t,e.SSF),fQ(t),hQ(t),pQ(t),mQ(t),gQ(t,r.cellXfs),vQ(t),xQ(t),bQ(t),Er(t,279),t.end()}var wQ=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function SQ(e,r,t){r.themeElements.clrScheme=[];var n={};(e[0].match(Mo)||[]).forEach(function(s){var o=Bn(s);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=o.val;break;case"<a:sysClr":n.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(r.themeElements.clrScheme[wQ.indexOf(o[0])]=n,n={}):n.name=o[0].slice(3,o[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function _Q(){}function AQ(){}var CQ=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,jQ=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,kQ=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function RQ(e,r,t){r.themeElements={};var n;[["clrScheme",CQ,SQ],["fontScheme",jQ,_Q],["fmtScheme",kQ,AQ]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,r,t)})}var EQ=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function B9(e,r){(!e||e.length===0)&&(e=C_());var t,n={};if(!(t=e.match(EQ)))throw new Error("themeElements not found in theme");return RQ(t[0],n,r),n.raw=e,n}function C_(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[wi];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function NQ(e,r,t){var n=e.l+r,s=e.read_shift(4);if(s!==124226){if(!t.cellStyles){e.l=n;return}var o=e.slice(e.l);e.l=n;var i;try{i=TR(o,{type:"array"})}catch{return}var c=Ul(i,"theme/theme/theme1.xml",!0);if(c)return B9(c,t)}}function TQ(e){return e.read_shift(4)}function LQ(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=MQ(e,4);break;case 2:r.xclrValue=x9(e);break;case 3:r.xclrValue=TQ(e);break;case 4:e.l+=4;break}return e.l+=8,r}function MQ(e,r){return Lo(e,r)}function DQ(e,r){return Lo(e,r)}function IQ(e){var r=e.read_shift(2),t=e.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=LQ(e);break;case 6:n[1]=DQ(e,t);break;case 14:case 15:n[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return n}function OQ(e,r){var t=e.l+r;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),o=[];s-- >0;)o.push(IQ(e,t-e.l));return{ixfe:n,ext:o}}function PQ(e,r){r.forEach(function(t){t[0]})}function FQ(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:To(e)}}function BQ(e){var r=dr(12+2*e.name.length);return r.write_shift(4,e.flags),r.write_shift(4,e.version),Gi(e.name,r),r.slice(0,r.l)}function zQ(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function $Q(e){var r=dr(4+8*e.length);r.write_shift(4,e.length);for(var t=0;t<e.length;++t)r.write_shift(4,e[t][0]),r.write_shift(4,e[t][1]);return r}function UQ(e,r){var t=dr(8+2*r.length);return t.write_shift(4,e),Gi(r,t),t.slice(0,t.l)}function HQ(e){return e.l+=4,e.read_shift(4)!=0}function VQ(e,r){var t=dr(8);return t.write_shift(4,e),t.write_shift(4,1),t}function WQ(e,r,t){var n={Types:[],Cell:[],Value:[]},s=t||{},o=[],i=!1,c=2;return $d(e,function(u,l,d){switch(d){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(h){c==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):c==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:c=u?1:0;break;case 338:c=2;break;case 35:o.push(d),i=!0;break;case 36:o.pop(),i=!1;break;default:if(!l.T){if(!i||s.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function qQ(){var e=ml();return Er(e,332),Er(e,334,Yc(1)),Er(e,335,BQ({name:"XLDAPR",version:12e4,flags:3496657072})),Er(e,336),Er(e,339,UQ(1,"XLDAPR")),Er(e,52),Er(e,35,Yc(514)),Er(e,4096,Yc(0)),Er(e,4097,fc(1)),Er(e,36),Er(e,53),Er(e,340),Er(e,337,VQ(1)),Er(e,51,$Q([[1,0]])),Er(e,338),Er(e,333),e.end()}function GQ(e,r,t){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,o=2,i;return e.replace(Mo,function(c){var u=Bn(c);switch(Xu(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<n.Types.length;++l)n.Types[l].name==u.name&&(i=n.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):o==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+u.i);break;default:if(!s&&t.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return c}),n}function z9(){var e=[wi];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function KQ(e){var r=[];if(!e)return r;var t=1;return(e.match(Mo)||[]).forEach(function(n){var s=Bn(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?t=s.i:s.i=t,r.push(s);break}}),r}function XQ(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=Fn(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function YQ(e,r,t){var n=[];return $d(e,function(o,i,c){switch(c){case 63:n.push(o);break;default:if(!i.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function ZQ(e,r,t,n){if(!e)return e;var s=n||{},o=!1;$d(e,function(c,u,l){switch(l){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!u.T){if(!o||s.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}},s)}function JQ(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}var Cm=1024;function $9(e,r){for(var t=[21600,21600],n=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),s=[zr("xml",null,{"xmlns:v":Pl.v,"xmlns:o":Pl.o,"xmlns:x":Pl.x,"xmlns:mv":Pl.mv}).replace(/\/>/,">"),zr("o:shapelayout",zr("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),zr("v:shapetype",[zr("v:stroke",null,{joinstyle:"miter"}),zr("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:n})];Cm<e*1e3;)Cm+=1e3;return r.forEach(function(o){var i=Gs(o[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var u=c.type=="gradient"?zr("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,l=zr("v:fill",u,c),d={on:"t",obscured:"t"};++Cm,s=s.concat(["<v:shape"+Bv({id:"_x0000_s"+Cm,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",l,zr("v:shadow",null,d),zr("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",lo("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),lo("x:AutoFill","False"),lo("x:Row",String(i.r)),lo("x:Column",String(i.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function jC(e,r,t,n){var s=Array.isArray(e),o;r.forEach(function(i){var c=Gs(i.ref);if(s?(e[c.r]||(e[c.r]=[]),o=e[c.r][c.c]):o=e[i.ref],!o){o={t:"z"},s?e[c.r][c.c]=o:e[i.ref]=o;var u=Ba(e["!ref"]||"BDWGO1000001:A1");u.s.r>c.r&&(u.s.r=c.r),u.e.r<c.r&&(u.e.r=c.r),u.s.c>c.c&&(u.s.c=c.c),u.e.c<c.c&&(u.e.c=c.c);var l=Jn(u);l!==e["!ref"]&&(e["!ref"]=l)}o.c||(o.c=[]);var d={a:i.author,t:i.t,r:i.r,T:t};i.h&&(d.h=i.h);for(var h=o.c.length-1;h>=0;--h){if(!t&&o.c[h].T)return;t&&!o.c[h].T&&o.c.splice(h,1)}if(t&&n){for(h=0;h<n.length;++h)if(d.a==n[h].id){d.a=n[h].name||d.a;break}}o.c.push(d)})}function QQ(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var c=i.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&t.push(c[1])}});var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var c=i.match(/<(?:\w+:)?comment[^>]*>/);if(c){var u=Bn(c[0]),l={author:u.authorId&&t[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},d=Gs(u.ref);if(!(r.sheetRows&&r.sheetRows<=d.r)){var h=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!h&&!!h[1]&&S_(h[1])||{r:"",t:"",h:""};l.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),l.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(l.h=f.h),n.push(l)}}}}),n}function U9(e){var r=[wi,zr("comments",null,{xmlns:K0[0]})],t=[];return r.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var o=os(s.a);t.indexOf(o)==-1&&(t.push(o),r.push("<author>"+o+"</author>")),s.T&&s.ID&&t.indexOf("tc="+s.ID)==-1&&(t.push("tc="+s.ID),r.push("<author>tc="+s.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),e.forEach(function(n){var s=0,o=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=t.indexOf("tc="+n[1][0].ID):n[1].forEach(function(u){u.a&&(s=t.indexOf(os(u.a))),o.push(u.t||"")}),r.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),o.length<=1)r.push(lo("t",os(o[0]||"")));else{for(var i=`Comment:
    `+o[0]+`
`,c=1;c<o.length;++c)i+=`Reply:
    `+o[c]+`
`;r.push(lo("t",os(i)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function eee(e,r){var t=[],n=!1,s={},o=0;return e.replace(Mo,function(c,u){var l=Bn(c);switch(Xu(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":s.t!=null&&t.push(s);break;case"<text>":case"<text":o=u+c.length;break;case"</text>":s.t=e.slice(o,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return c}),t}function tee(e,r,t){var n=[wi,zr("ThreadedComments",null,{xmlns:Mi.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var o="";(s[1]||[]).forEach(function(i,c){if(!i.T){delete i.ID;return}i.a&&r.indexOf(i.a)==-1&&r.push(i.a);var u={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};c==0?o=u.id:u.parentId=o,i.ID=u.id,i.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(i.a)).slice(-12)+"}"),n.push(zr("threadedComment",lo("text",i.t||""),u))})}),n.push("</ThreadedComments>"),n.join("")}function ree(e,r){var t=[],n=!1;return e.replace(Mo,function(o){var i=Bn(o);switch(Xu(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return o}),t}function nee(e){var r=[wi,zr("personList",null,{xmlns:Mi.TCMNT,"xmlns:x":K0[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,n){r.push(zr("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),r.push("</personList>"),r.join("")}function aee(e){var r={};r.iauthor=e.read_shift(4);var t=J0(e);return r.rfx=t.s,r.ref=Fn(t.s),e.l+=16,r}function see(e,r){return r==null&&(r=dr(36)),r.write_shift(4,e[1].iauthor),ng(e[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var iee=To;function oee(e){return Gi(e.slice(0,54))}function lee(e,r){var t=[],n=[],s={},o=!1;return $d(e,function(c,u,l){switch(l){case 632:n.push(c);break;case 635:s=c;break;case 637:s.t=c.t,s.h=c.h,s.r=c.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,r.sheetRows&&s.rfx&&r.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,t.push(s);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!o||r.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),t}function cee(e){var r=ml(),t=[];return Er(r,628),Er(r,630),e.forEach(function(n){n[1].forEach(function(s){t.indexOf(s.a)>-1||(t.push(s.a.slice(0,54)),Er(r,632,oee(s.a)))})}),Er(r,631),Er(r,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=t.indexOf(s.a);var o={s:Gs(n[0]),e:Gs(n[0])};Er(r,635,see([o,s])),s.t&&s.t.length>0&&Er(r,637,TX(s)),Er(r,636),delete s.iauthor})}),Er(r,634),Er(r,629),r.end()}var uee="application/vnd.ms-office.vbaProject";function dee(e){var r=An.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var s=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");An.utils.cfb_add(r,s,e.FileIndex[n].content)}}),An.write(r)}function fee(e,r){r.FullPaths.forEach(function(t,n){if(n!=0){var s=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&An.utils.cfb_add(e,s,r.FileIndex[n].content)}})}var H9=["xlsb","xlsm","xlam","biff8","xla"];function hee(){return{"!type":"dialog"}}function pee(){return{"!type":"dialog"}}function mee(){return{"!type":"macro"}}function gee(){return{"!type":"macro"}}var Tm=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,s,o,i){var c=!1,u=!1;o.length==0?u=!0:o.charAt(0)=="["&&(u=!0,o=o.slice(1,-1)),i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1));var l=o.length>0?parseInt(o,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return c?d+=r.c:--d,u?l+=r.r:--l,s+(c?"":"$")+qs(d)+(u?"":"$")+bi(l)}return function(s,o){return r=o,s.replace(e,t)}}(),j_=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,k_=function(){return function(r,t){return r.replace(j_,function(n,s,o,i,c,u){var l=h_(i)-(o?0:t.c),d=f_(u)-(c?0:t.r),h=d==0?"":c?d+1:"["+d+"]",f=l==0?"":o?l+1:"["+l+"]";return s+"R"+h+"C"+f})}}();function V9(e,r){return e.replace(j_,function(t,n,s,o,i,c){return n+(s=="$"?s+o:qs(h_(o)+r.c))+(i=="$"?i+c:bi(f_(c)+r.r))})}function vee(e,r,t){var n=vl(r),s=n.s,o=Gs(t),i={r:o.r-s.r,c:o.c-s.c};return V9(e,i)}function xee(e){return e.length!=1}function kC(e){return e.replace(/_xlfn\./g,"")}function ji(e){e.l+=1}function Vf(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function W9(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return q9(e);t.biff==12&&(n=4)}var s=e.read_shift(n),o=e.read_shift(n),i=Vf(e),c=Vf(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:o,c:c[0],cRel:c[1],rRel:c[2]}}}function q9(e){var r=Vf(e),t=Vf(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:s,cRel:t[1],rRel:t[2]}}}function bee(e,r,t){if(t.biff<8)return q9(e);var n=e.read_shift(t.biff==12?4:2),s=e.read_shift(t.biff==12?4:2),o=Vf(e),i=Vf(e);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function G9(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return yee(e);var n=e.read_shift(t&&t.biff==12?4:2),s=Vf(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function yee(e){var r=Vf(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function wee(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function See(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return _ee(e);var s=e.read_shift(n>=12?4:2),o=e.read_shift(2),i=(o&16384)>>14,c=(o&32768)>>15;if(o&=16383,c==1)for(;s>524287;)s-=1048576;if(i==1)for(;o>8191;)o=o-16384;return{r:s,c:o,cRel:i,rRel:c}}function _ee(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,s=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),s==1&&t>=128&&(t=t-256),{r,c:t,cRel:s,rRel:n}}function Aee(e,r,t){var n=(e[e.l++]&96)>>5,s=W9(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,s]}function Cee(e,r,t){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var i=W9(e,o,t);return[n,s,i]}function jee(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function kee(e,r,t){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[n,s]}function Ree(e,r,t){var n=(e[e.l++]&96)>>5,s=bee(e,r-1,t);return[n,s]}function Eee(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function RC(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function Nee(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),s=[],o=0;o<=n;++o)s.push(e.read_shift(t&&t.biff==2?1:2));return s}function Tee(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function Lee(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function Mee(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function Dee(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function K9(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function Iee(e){return e.read_shift(2),K9(e)}function Oee(e){return e.read_shift(2),K9(e)}function Pee(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=G9(e,0,t);return[n,s]}function Fee(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=See(e,0,t);return[n,s]}function Bee(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var o=G9(e,0,t);return[n,s,o]}function zee(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(t&&t.biff<=3?1:2);return[Hte[s],Z9[s],n]}function $ee(e,r,t){var n=e[e.l++],s=e.read_shift(1),o=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:Uee(e);return[s,(o[0]===0?Z9:Ute)[o[1]]]}function Uee(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Hee(e,r,t){e.l+=t&&t.biff==2?3:4}function Vee(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(t&&t.biff==2?1:2);return[n,s]}function Wee(e){return e.l++,Ud[e.read_shift(1)]}function qee(e){return e.l++,e.read_shift(2)}function Gee(e){return e.l++,e.read_shift(1)!==0}function Kee(e){return e.l++,No(e)}function Xee(e,r,t){return e.l++,fx(e,r-1,t)}function Yee(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=gi(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=Ud[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=No(e);break;case 2:t[1]=Q0(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function Zee(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),s=[],o=0;o!=n;++o)s.push((t.biff==12?J0:Fw)(e));return s}function Jee(e,r,t){var n=0,s=0;t.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--s==0&&(s=256));for(var o=0,i=[];o!=n&&(i[o]=[]);++o)for(var c=0;c!=s;++c)i[o][c]=Yee(e,t.biff);return i}function Qee(e,r,t){var n=e.read_shift(1)>>>5&3,s=!t||t.biff>=8?4:2,o=e.read_shift(s);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,o]}function ete(e,r,t){if(t.biff==5)return tte(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),o=e.read_shift(4);return[n,s,o]}function tte(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function rte(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var s=e.read_shift(t&&t.biff==2?1:2);return[n,s]}function nte(e,r,t){var n=e.read_shift(1)>>>5&3,s=e.read_shift(t&&t.biff==2?1:2);return[n,s]}function ate(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function ste(e,r,t){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),o=4;if(t)switch(t.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[n,s]}var ite=Lo,ote=Lo,lte=Lo;function px(e,r,t){return e.l+=2,[wee(e)]}function R_(e){return e.l+=6,[]}var cte=px,ute=R_,dte=R_,fte=px;function X9(e){return e.l+=2,[Ri(e),e.read_shift(2)&1]}var hte=px,pte=X9,mte=R_,gte=px,vte=px,xte=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function bte(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),o=e.read_shift(2),i=xte[t>>2&31];return{ixti:r,coltype:t&3,rt:i,idx:n,c:s,C:o}}function yte(e){return e.l+=2,[e.read_shift(4)]}function wte(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function Ste(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function _te(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function Ate(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function Cte(e){return e.l+=4,[0,0]}var EC={1:{n:"PtgExp",f:Vee},2:{n:"PtgTbl",f:lte},3:{n:"PtgAdd",f:ji},4:{n:"PtgSub",f:ji},5:{n:"PtgMul",f:ji},6:{n:"PtgDiv",f:ji},7:{n:"PtgPower",f:ji},8:{n:"PtgConcat",f:ji},9:{n:"PtgLt",f:ji},10:{n:"PtgLe",f:ji},11:{n:"PtgEq",f:ji},12:{n:"PtgGe",f:ji},13:{n:"PtgGt",f:ji},14:{n:"PtgNe",f:ji},15:{n:"PtgIsect",f:ji},16:{n:"PtgUnion",f:ji},17:{n:"PtgRange",f:ji},18:{n:"PtgUplus",f:ji},19:{n:"PtgUminus",f:ji},20:{n:"PtgPercent",f:ji},21:{n:"PtgParen",f:ji},22:{n:"PtgMissArg",f:ji},23:{n:"PtgStr",f:Xee},26:{n:"PtgSheet",f:wte},27:{n:"PtgEndSheet",f:Ste},28:{n:"PtgErr",f:Wee},29:{n:"PtgBool",f:Gee},30:{n:"PtgInt",f:qee},31:{n:"PtgNum",f:Kee},32:{n:"PtgArray",f:Eee},33:{n:"PtgFunc",f:zee},34:{n:"PtgFuncVar",f:$ee},35:{n:"PtgName",f:Qee},36:{n:"PtgRef",f:Pee},37:{n:"PtgArea",f:Aee},38:{n:"PtgMemArea",f:rte},39:{n:"PtgMemErr",f:ite},40:{n:"PtgMemNoMem",f:ote},41:{n:"PtgMemFunc",f:nte},42:{n:"PtgRefErr",f:ate},43:{n:"PtgAreaErr",f:jee},44:{n:"PtgRefN",f:Fee},45:{n:"PtgAreaN",f:Ree},46:{n:"PtgMemAreaN",f:_te},47:{n:"PtgMemNoMemN",f:Ate},57:{n:"PtgNameX",f:ete},58:{n:"PtgRef3d",f:Bee},59:{n:"PtgArea3d",f:Cee},60:{n:"PtgRefErr3d",f:ste},61:{n:"PtgAreaErr3d",f:kee},255:{}},jte={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},kte={1:{n:"PtgElfLel",f:X9},2:{n:"PtgElfRw",f:gte},3:{n:"PtgElfCol",f:cte},6:{n:"PtgElfRwV",f:vte},7:{n:"PtgElfColV",f:fte},10:{n:"PtgElfRadical",f:hte},11:{n:"PtgElfRadicalS",f:mte},13:{n:"PtgElfColS",f:ute},15:{n:"PtgElfColSV",f:dte},16:{n:"PtgElfRadicalLel",f:pte},25:{n:"PtgList",f:bte},29:{n:"PtgSxName",f:yte},255:{}},Rte={0:{n:"PtgAttrNoop",f:Cte},1:{n:"PtgAttrSemi",f:Dee},2:{n:"PtgAttrIf",f:Lee},4:{n:"PtgAttrChoose",f:Nee},8:{n:"PtgAttrGoto",f:Tee},16:{n:"PtgAttrSum",f:Hee},32:{n:"PtgAttrBaxcel",f:RC},33:{n:"PtgAttrBaxcel",f:RC},64:{n:"PtgAttrSpace",f:Iee},65:{n:"PtgAttrSpaceSemi",f:Oee},128:{n:"PtgAttrIfError",f:Mee},255:{}};function mx(e,r,t,n){if(n.biff<8)return Lo(e,r);for(var s=e.l+r,o=[],i=0;i!==t.length;++i)switch(t[i][0]){case"PtgArray":t[i][1]=Jee(e,0,n),o.push(t[i][1]);break;case"PtgMemArea":t[i][2]=Zee(e,t[i][1],n),o.push(t[i][2]);break;case"PtgExp":n&&n.biff==12&&(t[i][1][1]=e.read_shift(4),o.push(t[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[i][0]}return r=s-e.l,r!==0&&o.push(Lo(e,r)),o}function gx(e,r,t){for(var n=e.l+r,s,o,i=[];n!=e.l;)r=n-e.l,o=e[e.l],s=EC[o]||EC[jte[o]],(o===24||o===25)&&(s=(o===24?kte:Rte)[e[e.l+1]]),!s||!s.f?Lo(e,r):i.push([s.n,s.f(e,r,t)]);return i}function Ete(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],s=[],o=0;o<n.length;++o){var i=n[o];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}r.push(s.join(","))}return r.join(";")}var Nte={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Tte(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Y9(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var s="";if(t.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function NC(e,r,t){var n=Y9(e,r,t);return n=="#REF"?n:Tte(n,t)}function ko(e,r,t,n,s){var o=s&&s.biff||8,i={s:{c:0,r:0}},c=[],u,l,d,h=0,f=0,p,v="";if(!e[0]||!e[0][0])return"";for(var g=-1,m="",b=0,y=e[0].length;b<y;++b){var S=e[0][b];switch(S[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=c.pop(),l=c.pop(),g>=0){switch(e[0][g][1][0]){case 0:m=ti(" ",e[0][g][1][1]);break;case 1:m=ti("\r",e[0][g][1][1]);break;default:if(m="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}l=l+m,g=-1}c.push(l+Nte[S[0]]+u);break;case"PtgIsect":u=c.pop(),l=c.pop(),c.push(l+" "+u);break;case"PtgUnion":u=c.pop(),l=c.pop(),c.push(l+","+u);break;case"PtgRange":u=c.pop(),l=c.pop(),c.push(l+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=mv(S[1][1],i,s),c.push(gv(d,o));break;case"PtgRefN":d=t?mv(S[1][1],t,s):S[1][1],c.push(gv(d,o));break;case"PtgRef3d":h=S[1][1],d=mv(S[1][2],i,s),v=NC(n,h,s),c.push(v+"!"+gv(d,o));break;case"PtgFunc":case"PtgFuncVar":var C=S[1][0],L=S[1][1];C||(C=0),C&=127;var O=C==0?[]:c.slice(-C);c.length-=C,L==="User"&&(L=O.shift()),c.push(L+"("+O.join(",")+")");break;case"PtgBool":c.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(S[1]);break;case"PtgNum":c.push(String(S[1]));break;case"PtgStr":c.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(S[1]);break;case"PtgAreaN":p=sC(S[1][1],t?{s:t}:i,s),c.push(b3(p,s));break;case"PtgArea":p=sC(S[1][1],i,s),c.push(b3(p,s));break;case"PtgArea3d":h=S[1][1],p=S[1][2],v=NC(n,h,s),c.push(v+"!"+b3(p,s));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=S[1][2];var H=(n.names||[])[f-1]||(n[0]||[])[f],z=H?H.Name:"SH33TJSNAME"+String(f);z&&z.slice(0,6)=="_xlfn."&&!s.xlfn&&(z=z.slice(6)),c.push(z);break;case"PtgNameX":var q=S[1][1];f=S[1][2];var D;if(s.biff<=5)q<0&&(q=-q),n[q]&&(D=n[q][f]);else{var W="";if(((n[q]||[])[0]||[])[0]==14849||(((n[q]||[])[0]||[])[0]==1025?n[q][f]&&n[q][f].itab>0&&(W=n.SheetNames[n[q][f].itab-1]+"!"):W=n.SheetNames[f-1]+"!"),n[q]&&n[q][f])W+=n[q][f].Name;else if(n[0]&&n[0][f])W+=n[0][f].Name;else{var P=(Y9(n,q,s)||"").split(";;");P[f-1]?W=P[f-1]:W+="SH33TJSERRX"}c.push(W);break}D||(D={Name:"SH33TJSERRY"}),c.push(D.Name);break;case"PtgParen":var I="(",U=")";if(g>=0){switch(m="",e[0][g][1][0]){case 2:I=ti(" ",e[0][g][1][1])+I;break;case 3:I=ti("\r",e[0][g][1][1])+I;break;case 4:U=ti(" ",e[0][g][1][1])+U;break;case 5:U=ti("\r",e[0][g][1][1])+U;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}c.push(I+c.pop()+U);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":d={c:S[1][1],r:S[1][0]};var k={c:t.c,r:t.r};if(n.sharedf[Fn(d)]){var _=n.sharedf[Fn(d)];c.push(ko(_,i,k,n,s))}else{var R=!1;for(u=0;u!=n.arrayf.length;++u)if(l=n.arrayf[u],!(d.c<l[0].s.c||d.c>l[0].e.c)&&!(d.r<l[0].s.r||d.r>l[0].e.r)){c.push(ko(l[1],i,k,n,s)),R=!0;break}R||c.push(S[1])}break;case"PtgArray":c.push("{"+Ete(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var j=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&g>=0&&j.indexOf(e[0][b][0])==-1){S=e[0][g];var A=!0;switch(S[1][0]){case 4:A=!1;case 0:m=ti(" ",S[1][1]);break;case 5:A=!1;case 1:m=ti("\r",S[1][1]);break;default:if(m="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}c.push((A?m:"")+c.pop()+(A?"":m)),g=-1}}if(c.length>1&&s.WTF)throw new Error("bad formula stack");return c[0]}function Lte(e,r,t){var n=e.l+r,s=t.biff==2?1:2,o,i=e.read_shift(s);if(i==65535)return[[],Lo(e,r-2)];var c=gx(e,i,t);return r!==i+s&&(o=mx(e,r-i-s,c,t)),e.l=n,[c,o]}function Mte(e,r,t){var n=e.l+r,s=t.biff==2?1:2,o,i=e.read_shift(s);if(i==65535)return[[],Lo(e,r-2)];var c=gx(e,i,t);return r!==i+s&&(o=mx(e,r-i-s,c,t)),e.l=n,[c,o]}function Dte(e,r,t,n){var s=e.l+r,o=gx(e,n,t),i;return s!==e.l&&(i=mx(e,s-e.l,o,t)),[o,i]}function Ite(e,r,t){var n=e.l+r,s,o=e.read_shift(2),i=gx(e,o,t);return o==65535?[[],Lo(e,r-2)]:(r!==o+2&&(s=mx(e,n-o-2,i,t)),[i,s])}function Ote(e){var r;if(Rd(e,e.l+6)!==65535)return[No(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function Pte(e){if(e==null){var r=dr(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof e=="number")return F0(e);return F0(0)}function A3(e,r,t){var n=e.l+r,s=Yu(e);t.biff==2&&++e.l;var o=Ote(e),i=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var c=Mte(e,n-e.l,t);return{cell:s,val:o[0],formula:c,shared:i>>3&1,tt:o[1]}}function Fte(e,r,t,n,s){var o=z0(r,t,s),i=Pte(e.v),c=dr(6),u=33;c.write_shift(2,u),c.write_shift(4,0);for(var l=dr(e.bf.length),d=0;d<e.bf.length;++d)l[d]=e.bf[d];var h=Vi([o,i,c,l]);return h}function Bw(e,r,t){var n=e.read_shift(4),s=gx(e,n,t),o=e.read_shift(4),i=o>0?mx(e,o,s,t):null;return[s,i]}var Bte=Bw,zw=Bw,zte=Bw,$te=Bw,Ute={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Z9={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Hte={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function TC(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Vte(e){var r="of:="+e.replace(j_,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function C3(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}function Wte(e){return e.replace(/\./,"!")}var xv={},Lm={},bv=typeof Map<"u";function E_(e,r,t){var n=0,s=e.length;if(t){if(bv?t.has(r):Object.prototype.hasOwnProperty.call(t,r)){for(var o=bv?t.get(r):t[r];n<o.length;++n)if(e[o[n]].t===r)return e.Count++,o[n]}}else for(;n<s;++n)if(e[n].t===r)return e.Count++,n;return e[s]={t:r},e.Count++,e.Unique++,t&&(bv?(t.has(r)||t.set(r,[]),t.get(r).push(s)):(Object.prototype.hasOwnProperty.call(t,r)||(t[r]=[]),t[r].push(s))),s}function $w(e,r){var t={min:e+1,max:e+1},n=-1;return r.MDW&&(Ro=r.MDW),r.width!=null?t.customWidth=1:r.wpx!=null?n=Vv(r.wpx):r.wch!=null&&(n=r.wch),n>-1?(t.width=P2(n),t.customWidth=1):r.width!=null&&(t.width=r.width),r.hidden&&(t.hidden=!0),r.level!=null&&(t.outlineLevel=t.level=r.level),t}function T0(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function nh(e,r,t){var n=t.revssf[r.z!=null?r.z:"General"],s=60,o=e.length;if(n==null&&t.ssf){for(;s<392;++s)if(t.ssf[s]==null){Td(r.z,s),t.ssf[s]=r.z,t.revssf[r.z]=n=s;break}}for(s=0;s!=o;++s)if(e[s].numFmtId===n)return s;return e[o]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function J9(e,r,t,n,s,o){try{n.cellNF&&(e.z=On[r])}catch(c){if(n.WTF)throw c}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Is(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(On[r]==null&&Td(UK[r]||"General",r),e.t==="e")e.w=e.w||Ud[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Pv(e.v);else if(e.t==="d"){var i=Ii(e.v);(i|0)===i?e.w=i.toString(10):e.w=Pv(i)}else{if(e.v===void 0)return"";e.w=O0(e.v,Lm)}else e.t==="d"?e.w=yc(r,Ii(e.v),Lm):e.w=yc(r,e.v,Lm)}catch(c){if(n.WTF)throw c}if(n.cellStyles&&t!=null)try{e.s=o.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=O2(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=O2(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(n.WTF&&o.Fills)throw c}}}function qte(e,r,t){if(e&&e["!ref"]){var n=Ba(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}function Gte(e,r){var t=Ba(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=Jn(t))}var Kte=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Xte=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Yte=/<(?:\w:)?hyperlink [^>]*>/mg,Zte=/"(\w*:\w*)"/,Jte=/<(?:\w:)?col\b[^>]*[\/]?>/g,Qte=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,ere=/<(?:\w:)?pageMargins[^>]*\/>/g,Q9=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,tre=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,rre=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function nre(e,r,t,n,s,o,i){if(!e)return e;n||(n={"!id":{}});var c=r.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",d="",h=e.match(Xte);h?(l=e.slice(0,h.index),d=e.slice(h.index+h[0].length)):l=d=e;var f=l.match(Q9);f?N_(f[0],c,s,t):(f=l.match(tre))&&sre(f[0],f[1]||"",c,s,t);var p=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var v=l.slice(p,p+50).match(Zte);v&&Gte(c,v[1])}var g=l.match(rre);g&&g[1]&&xre(g[1],s);var m=[];if(r.cellStyles){var b=l.match(Jte);b&&hre(m,b)}h&&wre(h[1],c,r,u,o,i);var y=d.match(Qte);y&&(c["!autofilter"]=mre(y[0]));var S=[],C=d.match(Kte);if(C)for(p=0;p!=C.length;++p)S[p]=Ba(C[p].slice(C[p].indexOf('"')+1));var L=d.match(Yte);L&&ure(c,L,n);var O=d.match(ere);if(O&&(c["!margins"]=dre(Bn(O[0]))),!c["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(c["!ref"]=Jn(u)),r.sheetRows>0&&c["!ref"]){var H=Ba(c["!ref"]);r.sheetRows<=+H.e.r&&(H.e.r=r.sheetRows-1,H.e.r>u.e.r&&(H.e.r=u.e.r),H.e.r<H.s.r&&(H.s.r=H.e.r),H.e.c>u.e.c&&(H.e.c=u.e.c),H.e.c<H.s.c&&(H.s.c=H.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Jn(H))}return m.length>0&&(c["!cols"]=m),S.length>0&&(c["!merges"]=S),c}function are(e){if(e.length===0)return"";for(var r='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)r+='<mergeCell ref="'+Jn(e[t])+'"/>';return r+"</mergeCells>"}function N_(e,r,t,n){var s=Bn(e);t.Sheets[n]||(t.Sheets[n]={}),s.codeName&&(t.Sheets[n].CodeName=Fa(hs(s.codeName)))}function sre(e,r,t,n,s){N_(e.slice(0,e.indexOf(">")),t,n,s)}function ire(e,r,t,n,s){var o=!1,i={},c=null;if(n.bookType!=="xlsx"&&r.vbaraw){var u=r.SheetNames[t];try{r.Workbook&&(u=r.Workbook.Sheets[t].CodeName||u)}catch{}o=!0,i.codeName=Bu(os(u))}if(e&&e["!outline"]){var l={summaryBelow:1,summaryRight:1};e["!outline"].above&&(l.summaryBelow=0),e["!outline"].left&&(l.summaryRight=0),c=(c||"")+zr("outlinePr",null,l)}!o&&!c||(s[s.length]=zr("sheetPr",c,i))}var ore=["objects","scenarios","selectLockedCells","selectUnlockedCells"],lre=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function cre(e){var r={sheet:1};return ore.forEach(function(t){e[t]!=null&&e[t]&&(r[t]="1")}),lre.forEach(function(t){e[t]!=null&&!e[t]&&(r[t]="0")}),e.password&&(r.password=__(e.password).toString(16).toUpperCase()),zr("sheetProtection",null,r)}function ure(e,r,t){for(var n=Array.isArray(e),s=0;s!=r.length;++s){var o=Bn(hs(r[s]),!0);if(!o.ref)return;var i=((t||{})["!id"]||[])[o.id];i?(o.Target=i.Target,o.location&&(o.Target+="#"+Fa(o.location))):(o.Target="#"+Fa(o.location),i={Target:o.Target,TargetMode:"Internal"}),o.Rel=i,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var c=Ba(o.ref),u=c.s.r;u<=c.e.r;++u)for(var l=c.s.c;l<=c.e.c;++l){var d=Fn({c:l,r:u});n?(e[u]||(e[u]=[]),e[u][l]||(e[u][l]={t:"z",v:void 0}),e[u][l].l=o):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=o)}}}function dre(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function fre(e){return T0(e),zr("pageMargins",null,e)}function hre(e,r){for(var t=!1,n=0;n!=r.length;++n){var s=Bn(r[n],!0);s.hidden&&(s.hidden=Ds(s.hidden));var o=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!t&&s.width&&(t=!0,A_(s.width)),Hf(s);o<=i;)e[o++]=Os(s)}}function pre(e,r){for(var t=["<cols>"],n,s=0;s!=r.length;++s)(n=r[s])&&(t[t.length]=zr("col",null,$w(s,n)));return t[t.length]="</cols>",t.join("")}function mre(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}function gre(e,r,t,n){var s=typeof e.ref=="string"?e.ref:Jn(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var o=t.Workbook.Names,i=vl(s);i.s.r==i.e.r&&(i.e.r=vl(r["!ref"]).e.r,s=Jn(i));for(var c=0;c<o.length;++c){var u=o[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+t.SheetNames[n]+"'!"+s;break}}return c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+s}),zr("autoFilter",null,{ref:s})}var vre=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function xre(e,r){r.Views||(r.Views=[{}]),(e.match(vre)||[]).forEach(function(t,n){var s=Bn(t);r.Views[n]||(r.Views[n]={}),+s.zoomScale&&(r.Views[n].zoom=+s.zoomScale),Ds(s.rightToLeft)&&(r.Views[n].RTL=!0)})}function bre(e,r,t,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),zr("sheetViews",zr("sheetView",null,s),{})}function yre(e,r,t,n){if(e.c&&t["!comments"].push([r,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",o=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=Ud[e.v];break;case"d":n&&n.cellDates?s=Is(e.v,-1).toISOString():(e=Os(e),e.t="n",s=""+(e.v=Ii(Is(e.v)))),typeof e.z>"u"&&(e.z=On[14]);break;default:s=e.v;break}var c=lo("v",os(s)),u={r},l=nh(n.cellXfs,e,n);switch(l!==0&&(u.s=l),e.t){case"n":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){c=lo("v",""+E_(n.Strings,e.v,n.revStrings)),u.t="s";break}u.t="str";break}if(e.t!=o&&(e.t=o,e.v=i),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,r.length)==r?{t:"array",ref:e.F}:null;c=zr("f",os(e.f),d)+(e.v!=null?c:"")}return e.l&&t["!links"].push([r,e.l]),e.D&&(u.cm=1),zr("c",c,u)}var wre=function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,o=Fv("v"),i=Fv("f");return function(u,l,d,h,f,p){for(var v=0,g="",m=[],b=[],y=0,S=0,C=0,L="",O,H,z=0,q=0,D,W,P=0,I=0,U=Array.isArray(p.CellXf),k,_=[],R=[],j=Array.isArray(l),A=[],N={},V=!1,M=!!d.sheetStubs,Z=u.split(r),J=0,re=Z.length;J!=re;++J){g=Z[J].trim();var X=g.length;if(X!==0){var ne=0;e:for(v=0;v<X;++v)switch(g[v]){case">":if(g[v-1]!="/"){++v;break e}if(d&&d.cellStyles){if(H=Bn(g.slice(ne,v),!0),z=H.r!=null?parseInt(H.r,10):z+1,q=-1,d.sheetRows&&d.sheetRows<z)continue;N={},V=!1,H.ht&&(V=!0,N.hpt=parseFloat(H.ht),N.hpx=Vm(N.hpt)),H.hidden=="1"&&(V=!0,N.hidden=!0),H.outlineLevel!=null&&(V=!0,N.level=+H.outlineLevel),V&&(A[z-1]=N)}break;case"<":ne=v;break}if(ne>=v)break;if(H=Bn(g.slice(ne,v),!0),z=H.r!=null?parseInt(H.r,10):z+1,q=-1,!(d.sheetRows&&d.sheetRows<z)){h.s.r>z-1&&(h.s.r=z-1),h.e.r<z-1&&(h.e.r=z-1),d&&d.cellStyles&&(N={},V=!1,H.ht&&(V=!0,N.hpt=parseFloat(H.ht),N.hpx=Vm(N.hpt)),H.hidden=="1"&&(V=!0,N.hidden=!0),H.outlineLevel!=null&&(V=!0,N.level=+H.outlineLevel),V&&(A[z-1]=N)),m=g.slice(v).split(e);for(var Y=0;Y!=m.length&&m[Y].trim().charAt(0)=="<";++Y);for(m=m.slice(Y),v=0;v!=m.length;++v)if(g=m[v].trim(),g.length!==0){if(b=g.match(t),y=v,S=0,C=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,b!=null&&b.length===2){for(y=0,L=b[1],S=0;S!=L.length&&!((C=L.charCodeAt(S)-64)<1||C>26);++S)y=26*y+C;--y,q=y}else++q;for(S=0;S!=g.length&&g.charCodeAt(S)!==62;++S);if(++S,H=Bn(g.slice(0,S),!0),H.r||(H.r=Fn({r:z-1,c:q})),L=g.slice(S),O={t:""},(b=L.match(o))!=null&&b[1]!==""&&(O.v=Fa(b[1])),d.cellFormula){if((b=L.match(i))!=null&&b[1]!==""){if(O.f=Fa(hs(b[1])).replace(/\r\n/g,`
`),d.xlfn||(O.f=kC(O.f)),b[0].indexOf('t="array"')>-1)O.F=(L.match(s)||[])[1],O.F.indexOf(":")>-1&&_.push([Ba(O.F),O.F]);else if(b[0].indexOf('t="shared"')>-1){W=Bn(b[0]);var K=Fa(hs(b[1]));d.xlfn||(K=kC(K)),R[parseInt(W.si,10)]=[W,K,H.r]}}else(b=L.match(/<f[^>]*\/>/))&&(W=Bn(b[0]),R[W.si]&&(O.f=vee(R[W.si][1],R[W.si][2],H.r)));var ee=Gs(H.r);for(S=0;S<_.length;++S)ee.r>=_[S][0].s.r&&ee.r<=_[S][0].e.r&&ee.c>=_[S][0].s.c&&ee.c<=_[S][0].e.c&&(O.F=_[S][1])}if(H.t==null&&O.v===void 0)if(O.f||O.F)O.v=0,O.t="n";else if(M)O.t="z";else continue;else O.t=H.t||"n";switch(h.s.c>q&&(h.s.c=q),h.e.c<q&&(h.e.c=q),O.t){case"n":if(O.v==""||O.v==null){if(!M)continue;O.t="z"}else O.v=parseFloat(O.v);break;case"s":if(typeof O.v>"u"){if(!M)continue;O.t="z"}else D=xv[parseInt(O.v,10)],O.v=D.t,O.r=D.r,d.cellHTML&&(O.h=D.h);break;case"str":O.t="s",O.v=O.v!=null?hs(O.v):"",d.cellHTML&&(O.h=l_(O.v));break;case"inlineStr":b=L.match(n),O.t="s",b!=null&&(D=S_(b[1]))?(O.v=D.t,d.cellHTML&&(O.h=D.h)):O.v="";break;case"b":O.v=Ds(O.v);break;case"d":d.cellDates?O.v=Is(O.v,1):(O.v=Ii(Is(O.v,1)),O.t="n");break;case"e":(!d||d.cellText!==!1)&&(O.w=O.v),O.v=t9[O.v];break}if(P=I=0,k=null,U&&H.s!==void 0&&(k=p.CellXf[H.s],k!=null&&(k.numFmtId!=null&&(P=k.numFmtId),d.cellStyles&&k.fillId!=null&&(I=k.fillId))),J9(O,P,I,d,f,p),d.cellDates&&U&&O.t=="n"&&eg(On[P])&&(O.t="d",O.v=Pw(O.v)),H.cm&&d.xlmeta){var ue=(d.xlmeta.Cell||[])[+H.cm-1];ue&&ue.type=="XLDAPR"&&(O.D=!0)}if(j){var se=Gs(H.r);l[se.r]||(l[se.r]=[]),l[se.r][se.c]=O}else l[H.r]=O}}}}A.length>0&&(l["!rows"]=A)}}();function Sre(e,r,t,n){var s=[],o=[],i=Ba(e["!ref"]),c="",u,l="",d=[],h=0,f=0,p=e["!rows"],v=Array.isArray(e),g={r:l},m,b=-1;for(f=i.s.c;f<=i.e.c;++f)d[f]=qs(f);for(h=i.s.r;h<=i.e.r;++h){for(o=[],l=bi(h),f=i.s.c;f<=i.e.c;++f){u=d[f]+l;var y=v?(e[h]||[])[f]:e[u];y!==void 0&&(c=yre(y,u,e,r))!=null&&o.push(c)}(o.length>0||p&&p[h])&&(g={r:l},p&&p[h]&&(m=p[h],m.hidden&&(g.hidden=1),b=-1,m.hpx?b=Wv(m.hpx):m.hpt&&(b=m.hpt),b>-1&&(g.ht=b,g.customHeight=1),m.level&&(g.outlineLevel=m.level)),s[s.length]=zr("row",o.join(""),g))}if(p)for(;h<p.length;++h)p&&p[h]&&(g={r:h+1},m=p[h],m.hidden&&(g.hidden=1),b=-1,m.hpx?b=Wv(m.hpx):m.hpt&&(b=m.hpt),b>-1&&(g.ht=b,g.customHeight=1),m.level&&(g.outlineLevel=m.level),s[s.length]=zr("row","",g));return s.join("")}function eE(e,r,t,n){var s=[wi,zr("worksheet",null,{xmlns:K0[0],"xmlns:r":Mi.r})],o=t.SheetNames[e],i=0,c="",u=t.Sheets[o];u==null&&(u={});var l=u["!ref"]||"A1",d=Ba(l);if(d.e.c>16383||d.e.r>1048575){if(r.WTF)throw new Error("Range "+l+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),l=Jn(d)}n||(n={}),u["!comments"]=[];var h=[];ire(u,t,e,r,s),s[s.length]=zr("dimension",null,{ref:l}),s[s.length]=bre(u,r,e,t),r.sheetFormat&&(s[s.length]=zr("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(s[s.length]=pre(u,u["!cols"])),s[i=s.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(c=Sre(u,r),c.length>0&&(s[s.length]=c)),s.length>i+1&&(s[s.length]="</sheetData>",s[i]=s[i].replace("/>",">")),u["!protect"]&&(s[s.length]=cre(u["!protect"])),u["!autofilter"]!=null&&(s[s.length]=gre(u["!autofilter"],u,t,e)),u["!merges"]!=null&&u["!merges"].length>0&&(s[s.length]=are(u["!merges"]));var f=-1,p,v=-1;return u["!links"].length>0&&(s[s.length]="<hyperlinks>",u["!links"].forEach(function(g){g[1].Target&&(p={ref:g[0]},g[1].Target.charAt(0)!="#"&&(v=ss(n,-1,os(g[1].Target).replace(/#.*$/,""),ya.HLINK),p["r:id"]="rId"+v),(f=g[1].Target.indexOf("#"))>-1&&(p.location=os(g[1].Target.slice(f+1))),g[1].Tooltip&&(p.tooltip=os(g[1].Tooltip)),s[s.length]=zr("hyperlink",null,p))}),s[s.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(s[s.length]=fre(u["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(s[s.length]=lo("ignoredErrors",zr("ignoredError",null,{numberStoredAsText:1,sqref:l}))),h.length>0&&(v=ss(n,-1,"../drawings/drawing"+(e+1)+".xml",ya.DRAW),s[s.length]=zr("drawing",null,{"r:id":"rId"+v}),u["!drawing"]=h),u["!comments"].length>0&&(v=ss(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ya.VML),s[s.length]=zr("legacyDrawing",null,{"r:id":"rId"+v}),u["!legacy"]=v),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function _re(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=n,o&7&&(t.level=o&7),o&16&&(t.hidden=!0),o&32&&(t.hpt=s/20),t}function Are(e,r,t){var n=dr(145),s=(t["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var o=320;s.hpx?o=Wv(s.hpx)*20:s.hpt&&(o=s.hpt*20),n.write_shift(2,o),n.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var c=0,u=n.l;n.l+=4;for(var l={r:e,c:0},d=0;d<16;++d)if(!(r.s.c>d+1<<10||r.e.c<d<<10)){for(var h=-1,f=-1,p=d<<10;p<d+1<<10;++p){l.c=p;var v=Array.isArray(t)?(t[l.r]||[])[l.c]:t[Fn(l)];v&&(h<0&&(h=p),f=p)}h<0||(++c,n.write_shift(4,h),n.write_shift(4,f))}var g=n.l;return n.l=u,n.write_shift(4,c),n.l=g,n.length>n.l?n.slice(0,n.l):n}function Cre(e,r,t,n){var s=Are(n,t,r);(s.length>17||(r["!rows"]||[])[n])&&Er(e,0,s)}var jre=J0,kre=ng;function Rre(){}function Ere(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=LX(e),t}function Nre(e,r,t){t==null&&(t=dr(84+4*e.length));var n=192;r&&(r.above&&(n&=-65),r.left&&(n&=-129)),t.write_shift(1,n);for(var s=1;s<3;++s)t.write_shift(1,0);return M2({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),YR(e,t),t.slice(0,t.l)}function Tre(e){var r=Sc(e);return[r]}function Lre(e,r,t){return t==null&&(t=dr(8)),X0(r,t)}function Mre(e){var r=Y0(e);return[r]}function Dre(e,r,t){return t==null&&(t=dr(4)),Z0(r,t)}function Ire(e){var r=Sc(e),t=e.read_shift(1);return[r,t,"b"]}function Ore(e,r,t){return t==null&&(t=dr(9)),X0(r,t),t.write_shift(1,e.v?1:0),t}function Pre(e){var r=Y0(e),t=e.read_shift(1);return[r,t,"b"]}function Fre(e,r,t){return t==null&&(t=dr(5)),Z0(r,t),t.write_shift(1,e.v?1:0),t}function Bre(e){var r=Sc(e),t=e.read_shift(1);return[r,t,"e"]}function zre(e,r,t){return t==null&&(t=dr(9)),X0(r,t),t.write_shift(1,e.v),t}function $re(e){var r=Y0(e),t=e.read_shift(1);return[r,t,"e"]}function Ure(e,r,t){return t==null&&(t=dr(8)),Z0(r,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}function Hre(e){var r=Sc(e),t=e.read_shift(4);return[r,t,"s"]}function Vre(e,r,t){return t==null&&(t=dr(12)),X0(r,t),t.write_shift(4,r.v),t}function Wre(e){var r=Y0(e),t=e.read_shift(4);return[r,t,"s"]}function qre(e,r,t){return t==null&&(t=dr(8)),Z0(r,t),t.write_shift(4,r.v),t}function Gre(e){var r=Sc(e),t=No(e);return[r,t,"n"]}function Kre(e,r,t){return t==null&&(t=dr(16)),X0(r,t),F0(e.v,t),t}function tE(e){var r=Y0(e),t=No(e);return[r,t,"n"]}function Xre(e,r,t){return t==null&&(t=dr(12)),Z0(r,t),F0(e.v,t),t}function Yre(e){var r=Sc(e),t=v_(e);return[r,t,"n"]}function Zre(e,r,t){return t==null&&(t=dr(12)),X0(r,t),ZR(e.v,t),t}function Jre(e){var r=Y0(e),t=v_(e);return[r,t,"n"]}function Qre(e,r,t){return t==null&&(t=dr(8)),Z0(r,t),ZR(e.v,t),t}function ene(e){var r=Sc(e),t=p_(e);return[r,t,"is"]}function tne(e){var r=Sc(e),t=To(e);return[r,t,"str"]}function rne(e,r,t){return t==null&&(t=dr(12+4*e.v.length)),X0(r,t),Gi(e.v,t),t.length>t.l?t.slice(0,t.l):t}function nne(e){var r=Y0(e),t=To(e);return[r,t,"str"]}function ane(e,r,t){return t==null&&(t=dr(8+4*e.v.length)),Z0(r,t),Gi(e.v,t),t.length>t.l?t.slice(0,t.l):t}function sne(e,r,t){var n=e.l+r,s=Sc(e);s.r=t["!row"];var o=e.read_shift(1),i=[s,o,"b"];if(t.cellFormula){e.l+=2;var c=zw(e,n-e.l,t);i[3]=ko(c,null,s,t.supbooks,t)}else e.l=n;return i}function ine(e,r,t){var n=e.l+r,s=Sc(e);s.r=t["!row"];var o=e.read_shift(1),i=[s,o,"e"];if(t.cellFormula){e.l+=2;var c=zw(e,n-e.l,t);i[3]=ko(c,null,s,t.supbooks,t)}else e.l=n;return i}function one(e,r,t){var n=e.l+r,s=Sc(e);s.r=t["!row"];var o=No(e),i=[s,o,"n"];if(t.cellFormula){e.l+=2;var c=zw(e,n-e.l,t);i[3]=ko(c,null,s,t.supbooks,t)}else e.l=n;return i}function lne(e,r,t){var n=e.l+r,s=Sc(e);s.r=t["!row"];var o=To(e),i=[s,o,"str"];if(t.cellFormula){e.l+=2;var c=zw(e,n-e.l,t);i[3]=ko(c,null,s,t.supbooks,t)}else e.l=n;return i}var cne=J0,une=ng;function dne(e,r){return r==null&&(r=dr(4)),r.write_shift(4,e),r}function fne(e,r){var t=e.l+r,n=J0(e),s=m_(e),o=To(e),i=To(e),c=To(e);e.l=t;var u={rfx:n,relId:s,loc:o,display:c};return i&&(u.Tooltip=i),u}function hne(e,r){var t=dr(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));ng({s:Gs(e[0]),e:Gs(e[0])},t),g_("rId"+r,t);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return Gi(s||"",t),Gi(e[1].Tooltip||"",t),Gi("",t),t.slice(0,t.l)}function pne(){}function mne(e,r,t){var n=e.l+r,s=JR(e),o=e.read_shift(1),i=[s];if(i[2]=o,t.cellFormula){var c=Bte(e,n-e.l,t);i[1]=c}else e.l=n;return i}function gne(e,r,t){var n=e.l+r,s=J0(e),o=[s];if(t.cellFormula){var i=$te(e,n-e.l,t);o[1]=i,e.l=n}else e.l=n;return o}function vne(e,r,t){t==null&&(t=dr(18));var n=$w(e,r);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,(n.width||10)*256),t.write_shift(4,0);var s=0;return r.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),r.level&&(s|=r.level<<8),t.write_shift(2,s),t}var rE=["left","right","top","bottom","header","footer"];function xne(e){var r={};return rE.forEach(function(t){r[t]=No(e)}),r}function bne(e,r){return r==null&&(r=dr(6*8)),T0(e),rE.forEach(function(t){F0(e[t],r)}),r}function yne(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function wne(e,r,t){t==null&&(t=dr(30));var n=924;return(((r||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function Sne(e){var r=dr(24);return r.write_shift(4,4),r.write_shift(4,1),ng(e,r),r}function _ne(e,r){return r==null&&(r=dr(16*4+2)),r.write_shift(2,e.password?__(e.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?r.write_shift(4,e[t[0]]!=null&&!e[t[0]]?1:0):r.write_shift(4,e[t[0]]!=null&&e[t[0]]?0:1)}),r}function Ane(){}function Cne(){}function jne(e,r,t,n,s,o,i){if(!e)return e;var c=r||{};n||(n={"!id":{}});var u=c.dense?[]:{},l,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,f=!1,p,v,g,m,b,y,S,C,L,O=[];c.biff=12,c["!row"]=0;var H=0,z=!1,q=[],D={},W=c.supbooks||s.supbooks||[[]];if(W.sharedf=D,W.arrayf=q,W.SheetNames=s.SheetNames||s.Sheets.map(function(j){return j.name}),!c.supbooks&&(c.supbooks=W,s.Names))for(var P=0;P<s.Names.length;++P)W[0][P+1]=s.Names[P];var I=[],U=[],k=!1;qv[16]={n:"BrtShortReal",f:tE};var _;if($d(e,function(A,N,V){if(!f)switch(V){case 148:l=A;break;case 0:p=A,c.sheetRows&&c.sheetRows<=p.r&&(f=!0),C=bi(m=p.r),c["!row"]=p.r,(A.hidden||A.hpt||A.level!=null)&&(A.hpt&&(A.hpx=Vm(A.hpt)),U[A.r]=A);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:A[2]},A[2]){case"n":v.v=A[1];break;case"s":S=xv[A[1]],v.v=S.t,v.r=S.r;break;case"b":v.v=!!A[1];break;case"e":v.v=A[1],c.cellText!==!1&&(v.w=Ud[v.v]);break;case"str":v.t="s",v.v=A[1];break;case"is":v.t="s",v.v=A[1].t;break}if((g=i.CellXf[A[0].iStyleRef])&&J9(v,g.numFmtId,null,c,o,i),b=A[0].c==-1?b+1:A[0].c,c.dense?(u[m]||(u[m]=[]),u[m][b]=v):u[qs(b)+C]=v,c.cellFormula){for(z=!1,H=0;H<q.length;++H){var M=q[H];p.r>=M[0].s.r&&p.r<=M[0].e.r&&b>=M[0].s.c&&b<=M[0].e.c&&(v.F=Jn(M[0]),z=!0)}!z&&A.length>3&&(v.f=A[3])}if(d.s.r>p.r&&(d.s.r=p.r),d.s.c>b&&(d.s.c=b),d.e.r<p.r&&(d.e.r=p.r),d.e.c<b&&(d.e.c=b),c.cellDates&&g&&v.t=="n"&&eg(On[g.numFmtId])){var Z=S0(v.v);Z&&(v.t="d",v.v=new Date(Z.y,Z.m-1,Z.d,Z.H,Z.M,Z.S,Z.u))}_&&(_.type=="XLDAPR"&&(v.D=!0),_=void 0);break;case 1:case 12:if(!c.sheetStubs||h)break;v={t:"z",v:void 0},b=A[0].c==-1?b+1:A[0].c,c.dense?(u[m]||(u[m]=[]),u[m][b]=v):u[qs(b)+C]=v,d.s.r>p.r&&(d.s.r=p.r),d.s.c>b&&(d.s.c=b),d.e.r<p.r&&(d.e.r=p.r),d.e.c<b&&(d.e.c=b),_&&(_.type=="XLDAPR"&&(v.D=!0),_=void 0);break;case 176:O.push(A);break;case 49:_=((c.xlmeta||{}).Cell||[])[A-1];break;case 494:var J=n["!id"][A.relId];for(J?(A.Target=J.Target,A.loc&&(A.Target+="#"+A.loc),A.Rel=J):A.relId==""&&(A.Target="#"+A.loc),m=A.rfx.s.r;m<=A.rfx.e.r;++m)for(b=A.rfx.s.c;b<=A.rfx.e.c;++b)c.dense?(u[m]||(u[m]=[]),u[m][b]||(u[m][b]={t:"z",v:void 0}),u[m][b].l=A):(y=Fn({c:b,r:m}),u[y]||(u[y]={t:"z",v:void 0}),u[y].l=A);break;case 426:if(!c.cellFormula)break;q.push(A),L=c.dense?u[m][b]:u[qs(b)+C],L.f=ko(A[1],d,{r:p.r,c:b},W,c),L.F=Jn(A[0]);break;case 427:if(!c.cellFormula)break;D[Fn(A[0].s)]=A[1],L=c.dense?u[m][b]:u[qs(b)+C],L.f=ko(A[1],d,{r:p.r,c:b},W,c);break;case 60:if(!c.cellStyles)break;for(;A.e>=A.s;)I[A.e--]={width:A.w/256,hidden:!!(A.flags&1),level:A.level},k||(k=!0,A_(A.w/256)),Hf(I[A.e+1]);break;case 161:u["!autofilter"]={ref:Jn(A)};break;case 476:u["!margins"]=A;break;case 147:s.Sheets[t]||(s.Sheets[t]={}),A.name&&(s.Sheets[t].CodeName=A.name),(A.above||A.left)&&(u["!outline"]={above:A.above,left:A.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),A.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!N.T){if(!h||c.WTF)throw new Error("Unexpected record 0x"+V.toString(16))}}},c),delete c.supbooks,delete c["!row"],!u["!ref"]&&(d.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(u["!ref"]=Jn(l||d)),c.sheetRows&&u["!ref"]){var R=Ba(u["!ref"]);c.sheetRows<=+R.e.r&&(R.e.r=c.sheetRows-1,R.e.r>d.e.r&&(R.e.r=d.e.r),R.e.r<R.s.r&&(R.s.r=R.e.r),R.e.c>d.e.c&&(R.e.c=d.e.c),R.e.c<R.s.c&&(R.s.c=R.e.c),u["!fullref"]=u["!ref"],u["!ref"]=Jn(R))}return O.length>0&&(u["!merges"]=O),I.length>0&&(u["!cols"]=I),U.length>0&&(u["!rows"]=U),u}function kne(e,r,t,n,s,o,i){if(r.v===void 0)return!1;var c="";switch(r.t){case"b":c=r.v?"1":"0";break;case"d":r=Os(r),r.z=r.z||On[14],r.v=Ii(Is(r.v)),r.t="n";break;case"n":case"e":c=""+r.v;break;default:c=r.v;break}var u={r:t,c:n};switch(u.s=nh(s.cellXfs,r,s),r.l&&o["!links"].push([Fn(u),r.l]),r.c&&o["!comments"].push([Fn(u),r.c]),r.t){case"s":case"str":return s.bookSST?(c=E_(s.Strings,r.v,s.revStrings),u.t="s",u.v=c,i?Er(e,18,qre(r,u)):Er(e,7,Vre(r,u))):(u.t="str",i?Er(e,17,ane(r,u)):Er(e,6,rne(r,u))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?i?Er(e,13,Qre(r,u)):Er(e,2,Zre(r,u)):i?Er(e,16,Xre(r,u)):Er(e,5,Kre(r,u)),!0;case"b":return u.t="b",i?Er(e,15,Fre(r,u)):Er(e,4,Ore(r,u)),!0;case"e":return u.t="e",i?Er(e,14,Ure(r,u)):Er(e,3,zre(r,u)),!0}return i?Er(e,12,Dre(r,u)):Er(e,1,Lre(r,u)),!0}function Rne(e,r,t,n){var s=Ba(r["!ref"]||"A1"),o,i="",c=[];Er(e,145);var u=Array.isArray(r),l=s.e.r;r["!rows"]&&(l=Math.max(s.e.r,r["!rows"].length-1));for(var d=s.s.r;d<=l;++d){i=bi(d),Cre(e,r,s,d);var h=!1;if(d<=s.e.r)for(var f=s.s.c;f<=s.e.c;++f){d===s.s.r&&(c[f]=qs(f)),o=c[f]+i;var p=u?(r[d]||[])[f]:r[o];if(!p){h=!1;continue}h=kne(e,p,d,f,n,r,h)}}Er(e,146)}function Ene(e,r){!r||!r["!merges"]||(Er(e,177,dne(r["!merges"].length)),r["!merges"].forEach(function(t){Er(e,176,une(t))}),Er(e,178))}function Nne(e,r){!r||!r["!cols"]||(Er(e,390),r["!cols"].forEach(function(t,n){t&&Er(e,60,vne(n,t))}),Er(e,391))}function Tne(e,r){!r||!r["!ref"]||(Er(e,648),Er(e,649,Sne(Ba(r["!ref"]))),Er(e,650))}function Lne(e,r,t){r["!links"].forEach(function(n){if(n[1].Target){var s=ss(t,-1,n[1].Target.replace(/#.*$/,""),ya.HLINK);Er(e,494,hne(n,s))}}),delete r["!links"]}function Mne(e,r,t,n){if(r["!comments"].length>0){var s=ss(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",ya.VML);Er(e,551,g_("rId"+s)),r["!legacy"]=s}}function Dne(e,r,t,n){if(r["!autofilter"]){var s=r["!autofilter"],o=typeof s.ref=="string"?s.ref:Jn(s.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var i=t.Workbook.Names,c=vl(o);c.s.r==c.e.r&&(c.e.r=vl(r["!ref"]).e.r,o=Jn(c));for(var u=0;u<i.length;++u){var l=i[u];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+t.SheetNames[n]+"'!"+o;break}}u==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+o}),Er(e,161,ng(Ba(o))),Er(e,162)}}function Ine(e,r,t){Er(e,133),Er(e,137,wne(r,t)),Er(e,138),Er(e,134)}function One(e,r){r["!protect"]&&Er(e,535,_ne(r["!protect"]))}function Pne(e,r,t,n){var s=ml(),o=t.SheetNames[e],i=t.Sheets[o]||{},c=o;try{t&&t.Workbook&&(c=t.Workbook.Sheets[e].CodeName||c)}catch{}var u=Ba(i["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(r.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],Er(s,129),(t.vbaraw||i["!outline"])&&Er(s,147,Nre(c,i["!outline"])),Er(s,148,kre(u)),Ine(s,i,t.Workbook),Nne(s,i),Rne(s,i,e,r),One(s,i),Dne(s,i,t,e),Ene(s,i),Lne(s,i,n),i["!margins"]&&Er(s,476,bne(i["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&Tne(s,i),Mne(s,i,e,n),Er(s,130),s.end()}function Fne(e){var r=[],t=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var i=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(r[+i[1]]=t?+i[2]:i[2])});var s=Fa((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){n=o.replace(/<.*?>/g,"")}),[r,s,n]}function Bne(e,r,t,n,s,o){var i=o||{"!type":"chart"};if(!e)return o;var c=0,u=0,l="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var f=Fne(h);d.s.r=d.s.c=0,d.e.c=c,l=qs(c),f[0].forEach(function(p,v){i[l+bi(v)]={t:"n",v:p,z:f[1]},u=v}),d.e.r<u&&(d.e.r=u),++c}),c>0&&(i["!ref"]=Jn(d)),i}function zne(e,r,t,n,s){if(!e)return e;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},i,c=e.match(Q9);return c&&N_(c[0],o,s,t),(i=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=i[1]),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}function $ne(e,r){e.l+=10;var t=To(e);return{name:t}}function Une(e,r,t,n,s){if(!e)return e;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},i=!1;return $d(e,function(u,l,d){switch(d){case 550:o["!rel"]=u;break;case 651:s.Sheets[t]||(s.Sheets[t]={}),u.name&&(s.Sheets[t].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(l.T>0)){if(!(l.T<0)){if(!i||r.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},r),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}var T_=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Hne=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Vne=[],Wne=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function LC(e,r){for(var t=0;t!=e.length;++t)for(var n=e[t],s=0;s!=r.length;++s){var o=r[s];if(n[o[0]]==null)n[o[0]]=o[1];else switch(o[2]){case"bool":typeof n[o[0]]=="string"&&(n[o[0]]=Ds(n[o[0]]));break;case"int":typeof n[o[0]]=="string"&&(n[o[0]]=parseInt(n[o[0]],10));break}}}function MC(e,r){for(var t=0;t!=r.length;++t){var n=r[t];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Ds(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function nE(e){MC(e.WBProps,T_),MC(e.CalcPr,Wne),LC(e.WBView,Hne),LC(e.Sheets,Vne),Lm.date1904=Ds(e.WBProps.date1904)}function qne(e){return!e.Workbook||!e.Workbook.WBProps?"false":Ds(e.Workbook.WBProps.date1904)?"true":"false"}var Gne="][*?/\\".split("");function aE(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return Gne.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function Kne(e,r,t){e.forEach(function(n,s){aE(n);for(var o=0;o<s;++o)if(n==e[o])throw new Error("Duplicate Sheet Name: "+n);if(t){var i=r&&r[s]&&r[s].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function Xne(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var r=e.Workbook&&e.Workbook.Sheets||[];Kne(e.SheetNames,r,!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)qte(e.Sheets[e.SheetNames[t]],e.SheetNames[t],t)}var Yne=/<\w+:workbook/;function Zne(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",o={},i=0;if(e.replace(Mo,function(u,l){var d=Bn(u);switch(Xu(d[0])){case"<?xml":break;case"<workbook":u.match(Yne)&&(s="xmlns"+u.match(/<(\w+):/)[1]),t.xmlns=d[s];break;case"</workbook>":break;case"<fileVersion":delete d[0],t.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":T_.forEach(function(h){if(d[h[0]]!=null)switch(h[2]){case"bool":t.WBProps[h[0]]=Ds(d[h[0]]);break;case"int":t.WBProps[h[0]]=parseInt(d[h[0]],10);break;default:t.WBProps[h[0]]=d[h[0]]}}),d.codeName&&(t.WBProps.CodeName=hs(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],t.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Fa(hs(d.name)),delete d[0],t.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":o={},o.Name=hs(d.name),d.comment&&(o.Comment=d.comment),d.localSheetId&&(o.Sheet=+d.localSheetId),Ds(d.hidden||"0")&&(o.Hidden=!0),i=l+u.length;break;case"</definedName>":o.Ref=Fa(hs(e.slice(i,l))),t.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete d[0],t.CalcPr=d;break;case"<calcPr/>":delete d[0],t.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return u}),K0.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return nE(t),t}function sE(e){var r=[wi];r[r.length]=zr("workbook",null,{xmlns:K0[0],"xmlns:r":Mi.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(T_.forEach(function(c){e.Workbook.WBProps[c[0]]!=null&&e.Workbook.WBProps[c[0]]!=c[1]&&(n[c[0]]=e.Workbook.WBProps[c[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),r[r.length]=zr("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],o=0;if(s&&s[0]&&s[0].Hidden){for(r[r.length]="<bookViews>",o=0;o!=e.SheetNames.length&&!(!s[o]||!s[o].Hidden);++o);o==e.SheetNames.length&&(o=0),r[r.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",o=0;o!=e.SheetNames.length;++o){var i={name:os(e.SheetNames[o].slice(0,31))};if(i.sheetId=""+(o+1),i["r:id"]="rId"+(o+1),s[o])switch(s[o].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}r[r.length]=zr("sheet",null,i)}return r[r.length]="</sheets>",t&&(r[r.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(c){var u={name:c.Name};c.Comment&&(u.comment=c.Comment),c.Sheet!=null&&(u.localSheetId=""+c.Sheet),c.Hidden&&(u.hidden="1"),c.Ref&&(r[r.length]=zr("definedName",os(c.Ref),u))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function Jne(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=OS(e),t.name=To(e),t}function Qne(e,r){return r||(r=dr(127)),r.write_shift(4,e.Hidden),r.write_shift(4,e.iTabID),g_(e.strRelID,r),Gi(e.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function eae(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var s=r>8?To(e):"";return s.length>0&&(t.CodeName=s),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function tae(e,r){r||(r=dr(72));var t=0;return e&&e.filterPrivacy&&(t|=8),r.write_shift(4,t),r.write_shift(4,0),YR(e&&e.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function rae(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function nae(e,r,t){var n=e.l+r;e.l+=4,e.l+=1;var s=e.read_shift(4),o=MX(e),i=zte(e,0,t),c=m_(e);e.l=n;var u={Name:o,Ptg:i};return s<268435455&&(u.Sheet=s),c&&(u.Comment=c),u}function aae(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;r||(r={}),r.biff=12;var o=[],i=[[]];return i.SheetNames=[],i.XTI=[],qv[16]={n:"BrtFRTArchID$",f:rae},$d(e,function(u,l,d){switch(d){case 156:i.SheetNames.push(u.name),t.Sheets.push(u);break;case 153:t.WBProps=u;break;case 39:u.Sheet!=null&&(r.SID=u.Sheet),u.Ref=ko(u.Ptg,null,null,i,r),delete r.SID,delete u.Ptg,o.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([d,u]):i[0]=[d,u],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(u),i.XTI=i.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(d),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!l.T){if(!s||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},r),nE(t),t.Names=o,t.supbooks=i,t}function sae(e,r){Er(e,143);for(var t=0;t!=r.SheetNames.length;++t){var n=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t]&&r.Workbook.Sheets[t].Hidden||0,s={Hidden:n,iTabID:t+1,strRelID:"rId"+(t+1),name:r.SheetNames[t]};Er(e,156,Qne(s))}Er(e,144)}function iae(e,r){r||(r=dr(127));for(var t=0;t!=4;++t)r.write_shift(4,0);return Gi("SheetJS",r),Gi(j2.version,r),Gi(j2.version,r),Gi("7262",r),r.length>r.l?r.slice(0,r.l):r}function oae(e,r){r||(r=dr(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,e),r.write_shift(4,e);var t=120;return r.write_shift(1,t),r.length>r.l?r.slice(0,r.l):r}function lae(e,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var t=r.Workbook.Sheets,n=0,s=-1,o=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&s==-1?s=n:t[n].Hidden==1&&o==-1&&(o=n);o>s||(Er(e,135),Er(e,158,oae(s)),Er(e,136))}}function cae(e,r){var t=ml();return Er(t,131),Er(t,128,iae()),Er(t,153,tae(e.Workbook&&e.Workbook.WBProps||null)),lae(t,e),sae(t,e),Er(t,132),t.end()}function uae(e,r,t){return r.slice(-4)===".bin"?aae(e,t):Zne(e,t)}function dae(e,r,t,n,s,o,i,c){return r.slice(-4)===".bin"?jne(e,n,t,s,o,i,c):nre(e,n,t,s,o,i,c)}function fae(e,r,t,n,s,o,i,c){return r.slice(-4)===".bin"?Une(e,n,t,s,o):zne(e,n,t,s,o)}function hae(e,r,t,n,s,o,i,c){return r.slice(-4)===".bin"?mee():gee()}function pae(e,r,t,n,s,o,i,c){return r.slice(-4)===".bin"?hee():pee()}function mae(e,r,t,n){return r.slice(-4)===".bin"?uQ(e,t,n):JJ(e,t,n)}function gae(e,r,t){return B9(e,t)}function vae(e,r,t){return r.slice(-4)===".bin"?vJ(e,t):pJ(e,t)}function xae(e,r,t){return r.slice(-4)===".bin"?lee(e,t):QQ(e,t)}function bae(e,r,t){return r.slice(-4)===".bin"?YQ(e):KQ(e)}function yae(e,r,t,n){return t.slice(-4)===".bin"?ZQ(e,r,t,n):void 0}function wae(e,r,t){return r.slice(-4)===".bin"?WQ(e,r,t):GQ(e,r,t)}function Sae(e,r,t){return(r.slice(-4)===".bin"?cae:sE)(e)}function _ae(e,r,t,n,s){return(r.slice(-4)===".bin"?Pne:eE)(e,t,n,s)}function Aae(e,r,t){return(r.slice(-4)===".bin"?yQ:P9)(e,t)}function Cae(e,r,t){return(r.slice(-4)===".bin"?yJ:E9)(e,t)}function jae(e,r,t){return(r.slice(-4)===".bin"?cee:U9)(e)}function kae(e){return(e.slice(-4)===".bin"?qQ:z9)()}var iE=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,oE=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Hc(e,r){var t=e.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var s=e.match(iE),o,i,c,u;if(s)for(u=0;u!=s.length;++u)o=s[u].match(oE),(i=o[1].indexOf(":"))===-1?n[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?c="xmlns"+o[1].slice(6):c=o[1].slice(i+1),n[c]=o[2].slice(1,o[2].length-1));return n}function Rae(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var n=e.match(iE),s,o,i,c;if(n)for(c=0;c!=n.length;++c)s=n[c].match(oE),(o=s[1].indexOf(":"))===-1?t[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(o+1),t[i]=s[2].slice(1,s[2].length-1));return t}var yv;function Eae(e,r){var t=yv[e]||Fa(e);return t==="General"?O0(r):yc(t,r)}function Nae(e,r,t,n){var s=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Ds(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Is(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[Fa(r)]=s}function Tae(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ud[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Pv(e.v):e.w=O0(e.v):e.w=Eae(r||"General",e.v)}catch(o){if(t.WTF)throw o}try{var n=yv[r]||r||"General";if(t.cellNF&&(e.z=n),t.cellDates&&e.t=="n"&&eg(n)){var s=S0(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(o){if(t.WTF)throw o}}}function Lae(e,r,t){if(t.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=VJ[n.Pattern]||n.Pattern)}e[r.ID]=r}function Mae(e,r,t,n,s,o,i,c,u,l){var d="General",h=n.StyleID,f={};l=l||{};var p=[],v=0;for(h===void 0&&c&&(h=c.StyleID),h===void 0&&i&&(h=i.StyleID);o[h]!==void 0&&(o[h].nf&&(d=o[h].nf),o[h].Interior&&p.push(o[h].Interior),!!o[h].Parent);)h=o[h].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=Ds(e);break;case"String":n.t="s",n.r=YA(Fa(e)),n.v=e.indexOf("<")>-1?Fa(r||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Is(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Fa(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=t9[e],l.cellText!==!1&&(n.w=e);break;default:e==""&&r==""?n.t="z":(n.t="s",n.v=YA(r||e));break}if(Tae(n,d,l),l.cellFormula!==!1)if(n.Formula){var g=Fa(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=Tm(g,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Tm("RC:RC",s):n.ArrayRange&&(n.F=Tm(n.ArrayRange,s),u.push([Ba(n.F),n.F]))}else for(v=0;v<u.length;++v)s.r>=u[v][0].s.r&&s.r<=u[v][0].e.r&&s.c>=u[v][0].s.c&&s.c<=u[v][0].e.c&&(n.F=u[v][1]);l.cellStyles&&(p.forEach(function(m){!f.patternType&&m.patternType&&(f.patternType=m.patternType)}),n.s=f),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Dae(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function j3(e,r){var t=r||{};tg();var n=Q1(c_(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(n=hs(n));var s=n.slice(0,1024).toLowerCase(),o=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=Os(t);return i.type="string",Hm.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ke){s.indexOf("<"+ke)>=0&&(o=!0)}),o)return bse(n,t);yv={"General Number":"General","General Date":On[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":On[15],"Short Date":On[14],"Long Time":On[19],"Medium Time":On[18],"Short Time":On[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:On[2],Standard:On[4],Percent:On[10],Scientific:On[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,u=[],l,d={},h=[],f=t.dense?[]:{},p="",v={},g={},m=Hc('<Data ss:Type="String">'),b=0,y=0,S=0,C={s:{r:2e6,c:2e6},e:{r:0,c:0}},L={},O={},H="",z=0,q=[],D={},W={},P=0,I=[],U=[],k={},_=[],R,j=!1,A=[],N=[],V={},M=0,Z=0,J={Sheets:[],WBProps:{date1904:!1}},re={};zv.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var X="";c=zv.exec(n);)switch(c[3]=(X=c[3]).toLowerCase()){case"data":if(X=="data"){if(c[1]==="/"){if((l=u.pop())[0]!==c[3])throw new Error("Bad state: "+l.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break}if(u[u.length-1][1])break;c[1]==="/"?Mae(n.slice(b,c.index),H,m,u[u.length-1][0]=="comment"?k:v,{c:y,r:S},L,_[y],g,A,t):(H="",m=Hc(c[0]),b=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(U.length>0&&(v.c=U),(!t.sheetRows||t.sheetRows>S)&&v.v!==void 0&&(t.dense?(f[S]||(f[S]=[]),f[S][y]=v):f[qs(y)+bi(S)]=v),v.HRef&&(v.l={Target:Fa(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(M=y+(parseInt(v.MergeAcross,10)|0),Z=S+(parseInt(v.MergeDown,10)|0),q.push({s:{c:y,r:S},e:{c:M,r:Z}})),!t.sheetStubs)v.MergeAcross?y=M+1:++y;else if(v.MergeAcross||v.MergeDown){for(var ne=y;ne<=M;++ne)for(var Y=S;Y<=Z;++Y)(ne>y||Y>S)&&(t.dense?(f[Y]||(f[Y]=[]),f[Y][ne]={t:"z"}):f[qs(ne)+bi(Y)]={t:"z"});y=M+1}else++y;else v=Rae(c[0]),v.Index&&(y=+v.Index-1),y<C.s.c&&(C.s.c=y),y>C.e.c&&(C.e.c=y),c[0].slice(-2)==="/>"&&++y,U=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(S<C.s.r&&(C.s.r=S),S>C.e.r&&(C.e.r=S),c[0].slice(-2)==="/>"&&(g=Hc(c[0]),g.Index&&(S=+g.Index-1)),y=0,++S):(g=Hc(c[0]),g.Index&&(S=+g.Index-1),V={},(g.AutoFitHeight=="0"||g.Height)&&(V.hpx=parseInt(g.Height,10),V.hpt=Wv(V.hpx),N[S]=V),g.Hidden=="1"&&(V.hidden=!0,N[S]=V));break;case"worksheet":if(c[1]==="/"){if((l=u.pop())[0]!==c[3])throw new Error("Bad state: "+l.join("|"));h.push(p),C.s.r<=C.e.r&&C.s.c<=C.e.c&&(f["!ref"]=Jn(C),t.sheetRows&&t.sheetRows<=C.e.r&&(f["!fullref"]=f["!ref"],C.e.r=t.sheetRows-1,f["!ref"]=Jn(C))),q.length&&(f["!merges"]=q),_.length>0&&(f["!cols"]=_),N.length>0&&(f["!rows"]=N),d[p]=f}else C={s:{r:2e6,c:2e6},e:{r:0,c:0}},S=y=0,u.push([c[3],!1]),l=Hc(c[0]),p=Fa(l.Name),f=t.dense?[]:{},q=[],A=[],N=[],re={name:p,Hidden:0},J.Sheets.push(re);break;case"table":if(c[1]==="/"){if((l=u.pop())[0]!==c[3])throw new Error("Bad state: "+l.join("|"))}else{if(c[0].slice(-2)=="/>")break;u.push([c[3],!1]),_=[],j=!1}break;case"style":c[1]==="/"?Lae(L,O,t):O=Hc(c[0]);break;case"numberformat":O.nf=Fa(Hc(c[0]).Format||"General"),yv[O.nf]&&(O.nf=yv[O.nf]);for(var K=0;K!=392&&On[K]!=O.nf;++K);if(K==392){for(K=57;K!=392;++K)if(On[K]==null){Td(O.nf,K);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(R=Hc(c[0]),R.Hidden&&(R.hidden=!0,delete R.Hidden),R.Width&&(R.wpx=parseInt(R.Width,10)),!j&&R.wpx>10){j=!0,Ro=I9;for(var ee=0;ee<_.length;++ee)_[ee]&&Hf(_[ee])}j&&Hf(R),_[R.Index-1||_.length]=R;for(var ue=0;ue<+R.Span;++ue)_[_.length]=Os(R);break;case"namedrange":if(c[1]==="/")break;J.Names||(J.Names=[]);var se=Bn(c[0]),ce={Name:se.Name,Ref:Tm(se.RefersTo.slice(1),{r:0,c:0})};J.Sheets.length>0&&(ce.Sheet=J.Sheets.length-1),J.Names.push(ce);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?H+=n.slice(z,c.index):z=c.index+c[0].length;break;case"interior":if(!t.cellStyles)break;O.Interior=Hc(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?aY(D,X,n.slice(P,c.index)):P=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((l=u.pop())[0]!==c[3])throw new Error("Bad state: "+l.join("|"))}else u.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((l=u.pop())[0]!==c[3])throw new Error("Bad state: "+l.join("|"));Dae(k),U.push(k)}else u.push([c[3],!1]),l=Hc(c[0]),k={a:l.Author};break;case"autofilter":if(c[1]==="/"){if((l=u.pop())[0]!==c[3])throw new Error("Bad state: "+l.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var fe=Hc(c[0]);f["!autofilter"]={ref:Tm(fe.Range).replace(/\$/g,"")},u.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((l=u.pop())[0]!==c[3])throw new Error("Bad state: "+l.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((l=u.pop())[0]!==c[3])throw new Error("Bad state: "+l.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break;case"null":break;default:if(u.length==0&&c[3]=="document"||u.length==0&&c[3]=="uof")return FC(n,t);var ve=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ve=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ve=!1}break;case"excelworkbook":switch(c[3]){case"date1904":J.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ve=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:ve=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(n.slice(P,c.index)){case"SheetHidden":re.Hidden=1;break;case"SheetVeryHidden":re.Hidden=2;break}else P=c.index+c[0].length;break;case"header":f["!margins"]||T0(f["!margins"]={},"xlml"),isNaN(+Bn(c[0]).Margin)||(f["!margins"].header=+Bn(c[0]).Margin);break;case"footer":f["!margins"]||T0(f["!margins"]={},"xlml"),isNaN(+Bn(c[0]).Margin)||(f["!margins"].footer=+Bn(c[0]).Margin);break;case"pagemargins":var _e=Bn(c[0]);f["!margins"]||T0(f["!margins"]={},"xlml"),isNaN(+_e.Top)||(f["!margins"].top=+_e.Top),isNaN(+_e.Left)||(f["!margins"].left=+_e.Left),isNaN(+_e.Right)||(f["!margins"].right=+_e.Right),isNaN(+_e.Bottom)||(f["!margins"].bottom=+_e.Bottom);break;case"displayrighttoleft":J.Views||(J.Views=[]),J.Views[0]||(J.Views[0]={}),J.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ve=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ve=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ve=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ve=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ve=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ve=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ve=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ve=!1}break;case"smarttags":break;default:ve=!1;break}if(ve||c[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?Nae(W,X,I,n.slice(P,c.index)):(I=c,P=c.index+c[0].length);break}if(t.WTF)throw"Unrecognized tag: "+c[3]+"|"+u.join("|")}var le={};return!t.bookSheets&&!t.bookProps&&(le.Sheets=d),le.SheetNames=h,le.Workbook=J,le.SSF=Os(On),le.Props=D,le.Custprops=W,le}function HS(e,r){switch(M_(r=r||{}),r.type||"base64"){case"base64":return j3(Wl(e),r);case"binary":case"buffer":case"file":return j3(e,r);case"array":return j3(th(e),r)}}function Iae(e,r){var t=[];return e.Props&&t.push(sY(e.Props,r)),e.Custprops&&t.push(iY(e.Props,e.Custprops)),t.join("")}function Oae(){return""}function Pae(e,r){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(n,s){var o=[];o.push(zr("NumberFormat",null,{"ss:Format":os(On[n.numFmtId])}));var i={"ss:ID":"s"+(21+s)};t.push(zr("Style",o.join(""),i))}),zr("Styles",t.join(""))}function lE(e){return zr("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+k_(e.Ref,{r:0,c:0})})}function Fae(e){if(!((e||{}).Workbook||{}).Names)return"";for(var r=e.Workbook.Names,t=[],n=0;n<r.length;++n){var s=r[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||t.push(lE(s)))}return zr("Names",t.join(""))}function Bae(e,r,t,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,o=[],i=0;i<s.length;++i){var c=s[i];c.Sheet==t&&(c.Name.match(/^_xlfn\./)||o.push(lE(c)))}return o.join("")}function zae(e,r,t,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(zr("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(zr("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(zr("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)s.push(zr("Visible",n.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<t&&!(n.Workbook.Sheets[o]&&!n.Workbook.Sheets[o].Hidden);++o);o==t&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(lo("ProtectContents","True")),e["!protect"].objects&&s.push(lo("ProtectObjects","True")),e["!protect"].scenarios&&s.push(lo("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(lo("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(lo("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&s.push("<"+i[1]+"/>")})),s.length==0?"":zr("WorksheetOptions",s.join(""),{xmlns:Pl.x})}function $ae(e){return e.map(function(r){var t=lX(r.t||""),n=zr("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return zr("Comment",n,{"ss:Author":r.a})}).join("")}function Uae(e,r,t,n,s,o,i){if(!e||e.v==null&&e.f==null)return"";var c={};if(e.f&&(c["ss:Formula"]="="+os(k_(e.f,i))),e.F&&e.F.slice(0,r.length)==r){var u=Gs(e.F.slice(r.length+1));c["ss:ArrayRange"]="RC:R"+(u.r==i.r?"":"["+(u.r-i.r)+"]")+"C"+(u.c==i.c?"":"["+(u.c-i.c)+"]")}if(e.l&&e.l.Target&&(c["ss:HRef"]=os(e.l.Target),e.l.Tooltip&&(c["x:HRefScreenTip"]=os(e.l.Tooltip))),t["!merges"])for(var l=t["!merges"],d=0;d!=l.length;++d)l[d].s.c!=i.c||l[d].s.r!=i.r||(l[d].e.c>l[d].s.c&&(c["ss:MergeAcross"]=l[d].e.c-l[d].s.c),l[d].e.r>l[d].s.r&&(c["ss:MergeDown"]=l[d].e.r-l[d].s.r));var h="",f="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",f=String(e.v);break;case"b":h="Boolean",f=e.v?"1":"0";break;case"e":h="Error",f=Ud[e.v];break;case"d":h="DateTime",f=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||On[14]);break;case"s":h="String",f=oX(e.v||"");break}var p=nh(n.cellXfs,e,n);c["ss:StyleID"]="s"+(21+p),c["ss:Index"]=i.c+1;var v=e.v!=null?f:"",g=e.t=="z"?"":'<Data ss:Type="'+h+'">'+v+"</Data>";return(e.c||[]).length>0&&(g+=$ae(e.c)),zr("Cell",g,c)}function Hae(e,r){var t='<Row ss:Index="'+(e+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=Vm(r.hpt)),r.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(t+=' ss:Hidden="1"')),t+">"}function Vae(e,r,t,n){if(!e["!ref"])return"";var s=Ba(e["!ref"]),o=e["!merges"]||[],i=0,c=[];e["!cols"]&&e["!cols"].forEach(function(m,b){Hf(m);var y=!!m.width,S=$w(b,m),C={"ss:Index":b+1};y&&(C["ss:Width"]=Hv(S.width)),m.hidden&&(C["ss:Hidden"]="1"),c.push(zr("Column",null,C))});for(var u=Array.isArray(e),l=s.s.r;l<=s.e.r;++l){for(var d=[Hae(l,(e["!rows"]||[])[l])],h=s.s.c;h<=s.e.c;++h){var f=!1;for(i=0;i!=o.length;++i)if(!(o[i].s.c>h)&&!(o[i].s.r>l)&&!(o[i].e.c<h)&&!(o[i].e.r<l)){(o[i].s.c!=h||o[i].s.r!=l)&&(f=!0);break}if(!f){var p={r:l,c:h},v=Fn(p),g=u?(e[l]||[])[h]:e[v];d.push(Uae(g,v,e,r,t,n,p))}}d.push("</Row>"),d.length>2&&c.push(d.join(""))}return c.join("")}function Wae(e,r,t){var n=[],s=t.SheetNames[e],o=t.Sheets[s],i=o?Bae(o,r,e,t):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=o?Vae(o,r,e,t):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(zae(o,r,e,t)),n.join("")}function qae(e,r){r||(r={}),e.SSF||(e.SSF=Os(On)),e.SSF&&(tg(),Dw(e.SSF),r.revssf=Ow(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF,r.cellXfs=[],nh(r.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(Iae(e,r)),t.push(Oae()),t.push(""),t.push("");for(var n=0;n<e.SheetNames.length;++n)t.push(zr("Worksheet",Wae(n,r,e),{"ss:Name":os(e.SheetNames[n])}));return t[2]=Pae(e,r),t[3]=Fae(e),wi+zr("Workbook",t.join(""),{xmlns:Pl.ss,"xmlns:o":Pl.o,"xmlns:x":Pl.x,"xmlns:ss":Pl.ss,"xmlns:dt":Pl.dt,"xmlns:html":Pl.html})}function Gae(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=FX(t),t.length-t.l<=4)return r;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=BX(t),n=t.read_shift(4),n==0||n>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var Kae=[60,1084,2066,2165,2175];function Xae(e,r,t,n,s){var o=n,i=[],c=t.slice(t.l,t.l+o);if(s&&s.enc&&s.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(c)}i.push(c),t.l+=o;for(var u=Rd(t,t.l),l=VS[u],d=0;l!=null&&Kae.indexOf(u)>-1;)o=Rd(t,t.l+2),d=t.l+4,u==2066?d+=4:(u==2165||u==2175)&&(d+=12),c=t.slice(d,t.l+4+o),i.push(c),t.l+=4+o,l=VS[u=Rd(t,t.l)];var h=Vi(i);oo(h,0);var f=0;h.lens=[];for(var p=0;p<i.length;++p)h.lens.push(f),f+=i[p].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return r.f(h,h.length,s)}function Tu(e,r,t){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=On[n])}catch(o){if(r.WTF)throw o}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Ud[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Pv(e.v):e.w=O0(e.v):e.w=yc(n,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(o){if(r.WTF)throw o}if(r.cellDates&&n&&e.t=="n"&&eg(On[n]||String(n))){var s=S0(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Iy(e,r,t){return{v:e,ixfe:r,t}}function Yae(e,r){var t={opts:{}},n={},s=r.dense?[]:{},o={},i={},c=null,u=[],l="",d={},h,f="",p,v,g,m,b={},y=[],S,C,L=[],O=[],H={Sheets:[],WBProps:{date1904:!1},Views:[{}]},z={},q=function(Bt){return Bt<8?R0[Bt]:Bt<64&&O[Bt-8]||R0[Bt]},D=function(Bt,ft,tr){var Me=ft.XF.data;if(!(!Me||!Me.patternType||!tr||!tr.cellStyles)){ft.s={},ft.s.patternType=Me.patternType;var tt;(tt=Uv(q(Me.icvFore)))&&(ft.s.fgColor={rgb:tt}),(tt=Uv(q(Me.icvBack)))&&(ft.s.bgColor={rgb:tt})}},W=function(Bt,ft,tr){if(!(V>1)&&!(tr.sheetRows&&Bt.r>=tr.sheetRows)){if(tr.cellStyles&&ft.XF&&ft.XF.data&&D(Bt,ft,tr),delete ft.ixfe,delete ft.XF,h=Bt,f=Fn(Bt),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Bt.r<i.s.r&&(i.s.r=Bt.r),Bt.c<i.s.c&&(i.s.c=Bt.c),Bt.r+1>i.e.r&&(i.e.r=Bt.r+1),Bt.c+1>i.e.c&&(i.e.c=Bt.c+1),tr.cellFormula&&ft.f){for(var Me=0;Me<y.length;++Me)if(!(y[Me][0].s.c>Bt.c||y[Me][0].s.r>Bt.r)&&!(y[Me][0].e.c<Bt.c||y[Me][0].e.r<Bt.r)){ft.F=Jn(y[Me][0]),(y[Me][0].s.c!=Bt.c||y[Me][0].s.r!=Bt.r)&&delete ft.f,ft.f&&(ft.f=""+ko(y[Me][1],i,Bt,A,P));break}}tr.dense?(s[Bt.r]||(s[Bt.r]=[]),s[Bt.r][Bt.c]=ft):s[f]=ft}},P={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(P.password=r.password);var I,U=[],k=[],_=[],R=[],j=!1,A=[];A.SheetNames=P.snames,A.sharedf=P.sharedf,A.arrayf=P.arrayf,A.names=[],A.XTI=[];var N=0,V=0,M=0,Z=[],J=[],re;P.codepage=1200,qc(1200);for(var X=!1;e.l<e.length-1;){var ne=e.l,Y=e.read_shift(2);if(Y===0&&N===10)break;var K=e.l===e.length?0:e.read_shift(2),ee=VS[Y];if(ee&&ee.f){if(r.bookSheets&&N===133&&Y!==133)break;if(N=Y,ee.r===2||ee.r==12){var ue=e.read_shift(2);if(K-=2,!P.enc&&ue!==Y&&((ue&255)<<8|ue>>8)!==Y)throw new Error("rt mismatch: "+ue+"!="+Y);ee.r==12&&(e.l+=10,K-=10)}var se={};if(Y===10?se=ee.f(e,K,P):se=Xae(Y,ee,e,K,P),V==0&&[9,521,1033,2057].indexOf(N)===-1)continue;switch(Y){case 34:t.opts.Date1904=H.WBProps.date1904=se;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(P.enc||(e.l=0),P.enc=se,!r.password)throw new Error("File is password-protected");if(se.valid==null)throw new Error("Encryption scheme unsupported");if(!se.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=se;break;case 66:var ce=Number(se);switch(ce){case 21010:ce=1200;break;case 32768:ce=1e4;break;case 32769:ce=1252;break}qc(P.codepage=ce),X=!0;break;case 317:P.rrtabid=se;break;case 25:P.winlocked=se;break;case 439:t.opts.RefreshAll=se;break;case 12:t.opts.CalcCount=se;break;case 16:t.opts.CalcDelta=se;break;case 17:t.opts.CalcIter=se;break;case 13:t.opts.CalcMode=se;break;case 14:t.opts.CalcPrecision=se;break;case 95:t.opts.CalcSaveRecalc=se;break;case 15:P.CalcRefMode=se;break;case 2211:t.opts.FullCalc=se;break;case 129:se.fDialog&&(s["!type"]="dialog"),se.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),se.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:L.push(se);break;case 430:A.push([se]),A[A.length-1].XTI=[];break;case 35:case 547:A[A.length-1].push(se);break;case 24:case 536:re={Name:se.Name,Ref:ko(se.rgce,i,null,A,P)},se.itab>0&&(re.Sheet=se.itab-1),A.names.push(re),A[0]||(A[0]=[],A[0].XTI=[]),A[A.length-1].push(se),se.Name=="_xlnm._FilterDatabase"&&se.itab>0&&se.rgce&&se.rgce[0]&&se.rgce[0][0]&&se.rgce[0][0][0]=="PtgArea3d"&&(J[se.itab-1]={ref:Jn(se.rgce[0][0][1][2])});break;case 22:P.ExternCount=se;break;case 23:A.length==0&&(A[0]=[],A[0].XTI=[]),A[A.length-1].XTI=A[A.length-1].XTI.concat(se),A.XTI=A.XTI.concat(se);break;case 2196:if(P.biff<8)break;re!=null&&(re.Comment=se[1]);break;case 18:s["!protect"]=se;break;case 19:se!==0&&P.WTF&&console.error("Password verifier: "+se);break;case 133:o[se.pos]=se,P.snames.push(se.name);break;case 10:{if(--V)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=Jn(i),r.sheetRows&&r.sheetRows<=i.e.r){var fe=i.e.r;i.e.r=r.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Jn(i),i.e.r=fe}i.e.r++,i.e.c++}U.length>0&&(s["!merges"]=U),k.length>0&&(s["!objects"]=k),_.length>0&&(s["!cols"]=_),R.length>0&&(s["!rows"]=R),H.Sheets.push(z)}l===""?d=s:n[l]=s,s=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[Y]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[se.BIFFVer]||8),P.biffguess=se.BIFFVer==0,se.BIFFVer==0&&se.dt==4096&&(P.biff=5,X=!0,qc(P.codepage=28591)),P.biff==8&&se.BIFFVer==0&&se.dt==16&&(P.biff=2),V++)break;if(s=r.dense?[]:{},P.biff<8&&!X&&(X=!0,qc(P.codepage=r.codepage||1252)),P.biff<5||se.BIFFVer==0&&se.dt==4096){l===""&&(l="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var ve={pos:e.l-K,name:l};o[ve.pos]=ve,P.snames.push(l)}else l=(o[ne]||{name:""}).name;se.dt==32&&(s["!type"]="chart"),se.dt==64&&(s["!type"]="macro"),U=[],k=[],P.arrayf=y=[],_=[],R=[],j=!1,z={Hidden:(o[ne]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(r.dense?(s[se.r]||[])[se.c]:s[Fn({c:se.c,r:se.r})])&&++se.c,S={ixfe:se.ixfe,XF:L[se.ixfe]||{},v:se.val,t:"n"},M>0&&(S.z=Z[S.ixfe>>8&63]),Tu(S,r,t.opts.Date1904),W({c:se.c,r:se.r},S,r);break;case 5:case 517:S={ixfe:se.ixfe,XF:L[se.ixfe],v:se.val,t:se.t},M>0&&(S.z=Z[S.ixfe>>8&63]),Tu(S,r,t.opts.Date1904),W({c:se.c,r:se.r},S,r);break;case 638:S={ixfe:se.ixfe,XF:L[se.ixfe],v:se.rknum,t:"n"},M>0&&(S.z=Z[S.ixfe>>8&63]),Tu(S,r,t.opts.Date1904),W({c:se.c,r:se.r},S,r);break;case 189:for(var _e=se.c;_e<=se.C;++_e){var le=se.rkrec[_e-se.c][0];S={ixfe:le,XF:L[le],v:se.rkrec[_e-se.c][1],t:"n"},M>0&&(S.z=Z[S.ixfe>>8&63]),Tu(S,r,t.opts.Date1904),W({c:_e,r:se.r},S,r)}break;case 6:case 518:case 1030:{if(se.val=="String"){c=se;break}if(S=Iy(se.val,se.cell.ixfe,se.tt),S.XF=L[S.ixfe],r.cellFormula){var ke=se.formula;if(ke&&ke[0]&&ke[0][0]&&ke[0][0][0]=="PtgExp"){var Te=ke[0][0][1][0],pe=ke[0][0][1][1],ye=Fn({r:Te,c:pe});b[ye]?S.f=""+ko(se.formula,i,se.cell,A,P):S.F=((r.dense?(s[Te]||[])[pe]:s[ye])||{}).F}else S.f=""+ko(se.formula,i,se.cell,A,P)}M>0&&(S.z=Z[S.ixfe>>8&63]),Tu(S,r,t.opts.Date1904),W(se.cell,S,r),c=se}break;case 7:case 519:if(c)c.val=se,S=Iy(se,c.cell.ixfe,"s"),S.XF=L[S.ixfe],r.cellFormula&&(S.f=""+ko(c.formula,i,c.cell,A,P)),M>0&&(S.z=Z[S.ixfe>>8&63]),Tu(S,r,t.opts.Date1904),W(c.cell,S,r),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(se);var ge=Fn(se[0].s);if(p=r.dense?(s[se[0].s.r]||[])[se[0].s.c]:s[ge],r.cellFormula&&p){if(!c||!ge||!p)break;p.f=""+ko(se[1],i,se[0],A,P),p.F=Jn(se[0])}}break;case 1212:{if(!r.cellFormula)break;if(f){if(!c)break;b[Fn(c.cell)]=se[0],p=r.dense?(s[c.cell.r]||[])[c.cell.c]:s[Fn(c.cell)],(p||{}).f=""+ko(se[0],i,h,A,P)}}break;case 253:S=Iy(u[se.isst].t,se.ixfe,"s"),u[se.isst].h&&(S.h=u[se.isst].h),S.XF=L[S.ixfe],M>0&&(S.z=Z[S.ixfe>>8&63]),Tu(S,r,t.opts.Date1904),W({c:se.c,r:se.r},S,r);break;case 513:r.sheetStubs&&(S={ixfe:se.ixfe,XF:L[se.ixfe],t:"z"},M>0&&(S.z=Z[S.ixfe>>8&63]),Tu(S,r,t.opts.Date1904),W({c:se.c,r:se.r},S,r));break;case 190:if(r.sheetStubs)for(var De=se.c;De<=se.C;++De){var He=se.ixfe[De-se.c];S={ixfe:He,XF:L[He],t:"z"},M>0&&(S.z=Z[S.ixfe>>8&63]),Tu(S,r,t.opts.Date1904),W({c:De,r:se.r},S,r)}break;case 214:case 516:case 4:S=Iy(se.val,se.ixfe,"s"),S.XF=L[S.ixfe],M>0&&(S.z=Z[S.ixfe>>8&63]),Tu(S,r,t.opts.Date1904),W({c:se.c,r:se.r},S,r);break;case 0:case 512:V===1&&(i=se);break;case 252:u=se;break;case 1054:if(P.biff==4){Z[M++]=se[1];for(var Xe=0;Xe<M+163&&On[Xe]!=se[1];++Xe);Xe>=163&&Td(se[1],M+163)}else Td(se[1],se[0]);break;case 30:{Z[M++]=se;for(var at=0;at<M+163&&On[at]!=se;++at);at>=163&&Td(se,M+163)}break;case 229:U=U.concat(se);break;case 93:k[se.cmo[0]]=P.lastobj=se;break;case 438:P.lastobj.TxO=se;break;case 127:P.lastobj.ImData=se;break;case 440:for(m=se[0].s.r;m<=se[0].e.r;++m)for(g=se[0].s.c;g<=se[0].e.c;++g)p=r.dense?(s[m]||[])[g]:s[Fn({c:g,r:m})],p&&(p.l=se[1]);break;case 2048:for(m=se[0].s.r;m<=se[0].e.r;++m)for(g=se[0].s.c;g<=se[0].e.c;++g)p=r.dense?(s[m]||[])[g]:s[Fn({c:g,r:m})],p&&p.l&&(p.l.Tooltip=se[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;p=r.dense?(s[se[0].r]||[])[se[0].c]:s[Fn(se[0])];var dt=k[se[2]];p||(r.dense?(s[se[0].r]||(s[se[0].r]=[]),p=s[se[0].r][se[0].c]={t:"z"}):p=s[Fn(se[0])]={t:"z"},i.e.r=Math.max(i.e.r,se[0].r),i.s.r=Math.min(i.s.r,se[0].r),i.e.c=Math.max(i.e.c,se[0].c),i.s.c=Math.min(i.s.c,se[0].c)),p.c||(p.c=[]),v={a:se[1],t:dt.TxO.t},p.c.push(v)}break;case 2173:PQ(L[se.ixfe],se.ext);break;case 125:{if(!P.cellStyles)break;for(;se.e>=se.s;)_[se.e--]={width:se.w/256,level:se.level||0,hidden:!!(se.flags&1)},j||(j=!0,A_(se.w/256)),Hf(_[se.e+1])}break;case 520:{var wt={};se.level!=null&&(R[se.r]=wt,wt.level=se.level),se.hidden&&(R[se.r]=wt,wt.hidden=!0),se.hpt&&(R[se.r]=wt,wt.hpt=se.hpt,wt.hpx=Vm(se.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||T0(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Y]]=se;break;case 161:s["!margins"]||T0(s["!margins"]={}),s["!margins"].header=se.header,s["!margins"].footer=se.footer;break;case 574:se.RTL&&(H.Views[0].RTL=!0);break;case 146:O=se;break;case 2198:I=se;break;case 140:C=se;break;case 442:l?z.CodeName=se||z.name:H.WBProps.CodeName=se||"ThisWorkbook";break}}else ee||console.error("Missing Info for XLS Record 0x"+Y.toString(16)),e.l+=K}return t.SheetNames=si(o).sort(function($t,Bt){return Number($t)-Number(Bt)}).map(function($t){return o[$t].name}),r.bookSheets||(t.Sheets=n),!t.SheetNames.length&&d["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=d)):t.Preamble=d,t.Sheets&&J.forEach(function($t,Bt){t.Sheets[t.SheetNames[Bt]]["!autofilter"]=$t}),t.Strings=u,t.SSF=Os(On),P.enc&&(t.Encryption=P.enc),I&&(t.Themes=I),t.Metadata={},C!==void 0&&(t.Metadata.Country=C),A.names.length>0&&(H.Names=A.names),t.Workbook=H,t}var wv={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Zae(e,r,t){var n=An.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=pC(n,PS,wv.DSI);for(var o in s)r[o]=s[o]}catch(l){if(t.WTF)throw l}var i=An.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var c=pC(i,FS,wv.SI);for(var u in c)r[u]==null&&(r[u]=c[u])}catch(l){if(t.WTF)throw l}r.HeadingPairs&&r.TitlesOfParts&&(o9(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function Jae(e,r){var t=[],n=[],s=[],o=0,i,c=VA(PS,"n"),u=VA(FS,"n");if(e.Props)for(i=si(e.Props),o=0;o<i.length;++o)(Object.prototype.hasOwnProperty.call(c,i[o])?t:Object.prototype.hasOwnProperty.call(u,i[o])?n:s).push([i[o],e.Props[i[o]]]);if(e.Custprops)for(i=si(e.Custprops),o=0;o<i.length;++o)Object.prototype.hasOwnProperty.call(e.Props||{},i[o])||(Object.prototype.hasOwnProperty.call(c,i[o])?t:Object.prototype.hasOwnProperty.call(u,i[o])?n:s).push([i[o],e.Custprops[i[o]]]);var l=[];for(o=0;o<s.length;++o)p9.indexOf(s[o][0])>-1||i9.indexOf(s[o][0])>-1||s[o][1]!=null&&l.push(s[o]);n.length&&An.utils.cfb_add(r,"/SummaryInformation",mC(n,wv.SI,u,FS)),(t.length||l.length)&&An.utils.cfb_add(r,"/DocumentSummaryInformation",mC(t,wv.DSI,c,PS,l.length?l:null,wv.UDI))}function cE(e,r){r||(r={}),M_(r),e_(),r.codepage&&Q6(r.codepage);var t,n;if(e.FullPaths){if(An.find(e,"/encryption"))throw new Error("File is password-protected");t=An.find(e,"!CompObj"),n=An.find(e,"/Workbook")||An.find(e,"/Book")}else{switch(r.type){case"base64":e=$l(Wl(e));break;case"binary":e=$l(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}oo(e,0),n={content:e}}var s,o;if(t&&Gae(t),r.bookProps&&!r.bookSheets)s={};else{var i=ma?"buffer":"array";if(n&&n.content)s=Yae(n.content,r);else if((o=An.find(e,"PerfectOffice_MAIN"))&&o.content)s=N0.to_workbook(o.content,(r.type=i,r));else if((o=An.find(e,"NativeContent_MAIN"))&&o.content)s=N0.to_workbook(o.content,(r.type=i,r));else throw(o=An.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&An.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=dee(e))}var c={};return e.FullPaths&&Zae(e,c,r),s.Props=s.Custprops=c,r.bookFiles&&(s.cfb=e),s}function Qae(e,r){var t=r||{},n=An.utils.cfb_new({root:"R"}),s="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":s="/Workbook",t.biff=8;break;case"biff5":s="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return An.utils.cfb_add(n,s,uE(e,t)),t.biff==8&&(e.Props||e.Custprops)&&Jae(e,n),t.biff==8&&e.vbaraw&&fee(n,An.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var qv={0:{f:_re},1:{f:Tre},2:{f:Yre},3:{f:Bre},4:{f:Ire},5:{f:Gre},6:{f:tne},7:{f:Hre},8:{f:lne},9:{f:one},10:{f:sne},11:{f:ine},12:{f:Mre},13:{f:Jre},14:{f:$re},15:{f:Pre},16:{f:tE},17:{f:nne},18:{f:Wre},19:{f:p_},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:nae},40:{},42:{},43:{f:tQ},44:{f:QJ},45:{f:aQ},46:{f:iQ},47:{f:sQ},48:{},49:{f:jX},50:{},51:{f:zQ},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:C9},62:{f:ene},63:{f:XQ},64:{f:Ane},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Lo,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:yne},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Ere},148:{f:jre,p:16},151:{f:pne},152:{},153:{f:eae},154:{},155:{},156:{f:Jne},157:{},158:{},159:{T:1,f:gJ},160:{T:-1},161:{T:1,f:J0},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:cne},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:FQ},336:{T:-1},337:{f:HQ,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:OS},357:{},358:{},359:{},360:{T:1},361:{},362:{f:A9},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:mne},427:{f:gne},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:xne},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Rre},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:fne},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:OS},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:iee},633:{T:1},634:{T:-1},635:{T:1,f:aee},636:{T:-1},637:{f:NX},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:$ne},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Cne},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},VS={6:{f:A3},10:{f:Mf},12:{f:Ri},13:{f:Ri},14:{f:gi},15:{f:gi},16:{f:No},17:{f:gi},18:{f:gi},19:{f:Ri},20:{f:wC},21:{f:wC},23:{f:A9},24:{f:_C},25:{f:gi},26:{},27:{},28:{f:CZ},29:{},34:{f:gi},35:{f:SC},38:{f:No},39:{f:No},40:{f:No},41:{f:No},42:{f:gi},43:{f:gi},47:{f:PJ},49:{f:JY},51:{f:Ri},60:{},61:{f:GY},64:{f:gi},65:{f:ZY},66:{f:Ri},77:{},80:{},81:{},82:{},85:{f:Ri},89:{},90:{},91:{},92:{f:OY},93:{f:RZ},94:{},95:{f:gi},96:{},97:{},99:{f:gi},125:{f:C9},128:{f:hZ},129:{f:FY},130:{f:Ri},131:{f:gi},132:{f:gi},133:{f:BY},134:{},140:{f:OZ},141:{f:Ri},144:{},146:{f:BZ},151:{},152:{},153:{},154:{},155:{},156:{f:Ri},157:{},158:{},160:{f:qZ},161:{f:UZ},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:cZ},190:{f:uZ},193:{f:Mf},197:{},198:{},199:{},200:{},201:{},202:{f:gi},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ri},220:{},221:{f:gi},222:{},224:{f:fZ},225:{f:IY},226:{f:Mf},227:{},229:{f:jZ},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:$Y},253:{f:eZ},255:{f:HY},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:m9},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:gi},353:{f:Mf},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:xZ},431:{f:gi},432:{},433:{},434:{},437:{},438:{f:TZ},439:{f:gi},440:{f:LZ},441:{},442:{f:hx},443:{},444:{f:Ri},445:{},446:{},448:{f:Mf},449:{f:qY,r:2},450:{f:Mf},512:{f:xC},513:{f:WZ},515:{f:gZ},516:{f:rZ},517:{f:yC},519:{f:GZ},520:{f:VY},523:{},545:{f:AC},549:{f:vC},566:{},574:{f:XY},638:{f:lZ},659:{},1048:{},1054:{f:aZ},1084:{},1212:{f:SZ},2048:{f:DZ},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Ly},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Mf},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:zZ,r:12},2173:{f:OQ,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:gi,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:wZ,r:12},2197:{},2198:{f:NQ,r:12},2199:{},2200:{},2201:{},2202:{f:_Z,r:12},2203:{f:Mf},2204:{},2205:{},2206:{},2207:{},2211:{f:WY},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ri},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:HZ},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:FZ},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:xC},1:{},2:{f:JZ},3:{f:YZ},4:{f:XZ},5:{f:yC},7:{f:eJ},8:{},9:{f:Ly},11:{},22:{f:Ri},30:{f:iZ},31:{},32:{},33:{f:AC},36:{},37:{f:vC},50:{f:tJ},62:{},52:{},67:{},68:{f:Ri},69:{},86:{},126:{},127:{f:KZ},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:rJ},223:{},234:{},354:{},421:{},518:{f:A3},521:{f:Ly},536:{f:_C},547:{f:SC},561:{},579:{},1030:{f:A3},1033:{f:Ly},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function $r(e,r,t,n){var s=r;if(!isNaN(s)){var o=n||(t||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,o),o>0&&d_(t)&&e.push(t)}}function ese(e,r,t,n){var s=(t||[]).length||0;if(s<=8224)return $r(e,r,t,s);var o=r;if(!isNaN(o)){for(var i=t.parts||[],c=0,u=0,l=0;l+(i[c]||8224)<=8224;)l+=i[c]||8224,c++;var d=e.next(4);for(d.write_shift(2,o),d.write_shift(2,l),e.push(t.slice(u,u+l)),u+=l;u<s;){for(d=e.next(4),d.write_shift(2,60),l=0;l+(i[c]||8224)<=8224;)l+=i[c]||8224,c++;d.write_shift(2,l),e.push(t.slice(u,u+l)),u+=l}}}function vx(e,r,t){return e||(e=dr(7)),e.write_shift(2,r),e.write_shift(2,t),e.write_shift(2,0),e.write_shift(1,0),e}function tse(e,r,t,n){var s=dr(9);return vx(s,e,r),g9(t,n||"b",s),s}function rse(e,r,t){var n=dr(8+2*t.length);return vx(n,e,r),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function nse(e,r,t,n){if(r.v!=null)switch(r.t){case"d":case"n":var s=r.t=="d"?Ii(Is(r.v)):r.v;s==(s|0)&&s>=0&&s<65536?$r(e,2,QZ(t,n,s)):$r(e,3,ZZ(t,n,s));return;case"b":case"e":$r(e,5,tse(t,n,r.v,r.t));return;case"s":case"str":$r(e,4,rse(t,n,(r.v||"").slice(0,255)));return}$r(e,1,vx(null,t,n))}function ase(e,r,t,n){var s=Array.isArray(r),o=Ba(r["!ref"]||"A1"),i,c="",u=[];if(o.e.c>255||o.e.r>16383){if(n.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),i=Jn(o)}for(var l=o.s.r;l<=o.e.r;++l){c=bi(l);for(var d=o.s.c;d<=o.e.c;++d){l===o.s.r&&(u[d]=qs(d)),i=u[d]+c;var h=s?(r[l]||[])[d]:r[i];h&&nse(e,h,l,d)}}}function sse(e,r){for(var t=r||{},n=ml(),s=0,o=0;o<e.SheetNames.length;++o)e.SheetNames[o]==t.sheet&&(s=o);if(s==0&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return $r(n,t.biff==4?1033:t.biff==3?521:9,w_(e,16,t)),ase(n,e.Sheets[e.SheetNames[s]],s,t),$r(n,10),n.end()}function ise(e,r,t){$r(e,49,QY({sz:12,name:"Arial"},t))}function ose(e,r,t){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)r[s]!=null&&$r(e,1054,sZ(s,r[s],t))})}function lse(e,r){var t=dr(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),$r(e,2151,t),t=dr(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),w9(Ba(r["!ref"]||"A1"),t),t.write_shift(4,4),$r(e,2152,t)}function cse(e,r){for(var t=0;t<16;++t)$r(e,224,bC({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(n){$r(e,224,bC(n,0,r))})}function use(e,r){for(var t=0;t<r["!links"].length;++t){var n=r["!links"][t];$r(e,440,MZ(n)),n[1].Tooltip&&$r(e,2048,IZ(n))}delete r["!links"]}function dse(e,r){if(r){var t=0;r.forEach(function(n,s){++t<=256&&n&&$r(e,125,$Z($w(s,n),s))})}}function fse(e,r,t,n,s){var o=16+nh(s.cellXfs,r,s);if(r.v==null&&!r.bf){$r(e,513,z0(t,n,o));return}if(r.bf)$r(e,6,Fte(r,t,n,s,o));else switch(r.t){case"d":case"n":var i=r.t=="d"?Ii(Is(r.v)):r.v;$r(e,515,vZ(t,n,i,o));break;case"b":case"e":$r(e,517,mZ(t,n,r.v,o,s,r.t));break;case"s":case"str":if(s.bookSST){var c=E_(s.Strings,r.v,s.revStrings);$r(e,253,tZ(t,n,c,o))}else $r(e,516,nZ(t,n,(r.v||"").slice(0,255),o,s));break;default:$r(e,513,z0(t,n,o))}}function hse(e,r,t){var n=ml(),s=t.SheetNames[e],o=t.Sheets[s]||{},i=(t||{}).Workbook||{},c=(i.Sheets||[])[e]||{},u=Array.isArray(o),l=r.biff==8,d,h="",f=[],p=Ba(o["!ref"]||"A1"),v=l?65536:16384;if(p.e.c>255||p.e.r>=v){if(r.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,v-1)}$r(n,2057,w_(t,16,r)),$r(n,13,fc(1)),$r(n,12,fc(100)),$r(n,15,Go(!0)),$r(n,17,Go(!1)),$r(n,16,F0(.001)),$r(n,95,Go(!0)),$r(n,42,Go(!1)),$r(n,43,Go(!1)),$r(n,130,fc(1)),$r(n,128,pZ()),$r(n,131,Go(!1)),$r(n,132,Go(!1)),l&&dse(n,o["!cols"]),$r(n,512,oZ(p,r)),l&&(o["!links"]=[]);for(var g=p.s.r;g<=p.e.r;++g){h=bi(g);for(var m=p.s.c;m<=p.e.c;++m){g===p.s.r&&(f[m]=qs(m)),d=f[m]+h;var b=u?(o[g]||[])[m]:o[d];b&&(fse(n,b,g,m,r),l&&b.l&&o["!links"].push([d,b.l]))}}var y=c.CodeName||c.name||s;return l&&$r(n,574,YY((i.Views||[])[0])),l&&(o["!merges"]||[]).length&&$r(n,229,kZ(o["!merges"])),l&&use(n,o),$r(n,442,v9(y)),l&&lse(n,o),$r(n,10),n.end()}function pse(e,r,t){var n=ml(),s=(e||{}).Workbook||{},o=s.Sheets||[],i=s.WBProps||{},c=t.biff==8,u=t.biff==5;if($r(n,2057,w_(e,5,t)),t.bookType=="xla"&&$r(n,135),$r(n,225,c?fc(1200):null),$r(n,193,mY(2)),u&&$r(n,191),u&&$r(n,192),$r(n,226),$r(n,92,PY("SheetJS",t)),$r(n,66,fc(c?1200:1252)),c&&$r(n,353,fc(0)),c&&$r(n,448),$r(n,317,VZ(e.SheetNames.length)),c&&e.vbaraw&&$r(n,211),c&&e.vbaraw){var l=i.CodeName||"ThisWorkbook";$r(n,442,v9(l))}$r(n,156,fc(17)),$r(n,25,Go(!1)),$r(n,18,Go(!1)),$r(n,19,fc(0)),c&&$r(n,431,Go(!1)),c&&$r(n,444,fc(0)),$r(n,61,KY()),$r(n,64,Go(!1)),$r(n,141,fc(0)),$r(n,34,Go(qne(e)=="true")),$r(n,14,Go(!0)),c&&$r(n,439,Go(!1)),$r(n,218,fc(0)),ise(n,e,t),ose(n,e.SSF,t),cse(n,t),c&&$r(n,352,Go(!1));var d=n.end(),h=ml();c&&$r(h,140,PZ()),c&&t.Strings&&ese(h,252,UY(t.Strings)),$r(h,10);var f=h.end(),p=ml(),v=0,g=0;for(g=0;g<e.SheetNames.length;++g)v+=(c?12:11)+(c?2:1)*e.SheetNames[g].length;var m=d.length+v+f.length;for(g=0;g<e.SheetNames.length;++g){var b=o[g]||{};$r(p,133,zY({pos:m,hs:b.Hidden||0,dt:0,name:e.SheetNames[g]},t)),m+=r[g].length}var y=p.end();if(v!=y.length)throw new Error("BS8 "+v+" != "+y.length);var S=[];return d.length&&S.push(d),y.length&&S.push(y),f.length&&S.push(f),Vi(S)}function mse(e,r){var t=r||{},n=[];e&&!e.SSF&&(e.SSF=Os(On)),e&&e.SSF&&(tg(),Dw(e.SSF),t.revssf=Ow(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,D_(t),t.cellXfs=[],nh(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=hse(s,t,e);return n.unshift(pse(e,n,t)),Vi(n)}function uE(e,r){for(var t=0;t<=e.SheetNames.length;++t){var n=e.Sheets[e.SheetNames[t]];if(!(!n||!n["!ref"])){var s=vl(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var o=r||{};switch(o.biff||2){case 8:case 5:return mse(e,r);case 4:case 3:case 2:return sse(e,r)}throw new Error("invalid type "+o.bookType+" for BIFF")}function DC(e,r){var t=r||{},n=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),i=s.index,c=o&&o.index||e.length,u=QK(e.slice(i,c),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,d=0,h=0,f=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(i=0;i<u.length;++i){var g=u[i].trim(),m=g.slice(0,3).toLowerCase();if(m=="<tr"){if(++l,t.sheetRows&&t.sheetRows<=l){--l;break}d=0;continue}if(!(m!="<td"&&m!="<th")){var b=g.split(/<\/t[dh]>/i);for(c=0;c<b.length;++c){var y=b[c].trim();if(y.match(/<t[dh]/i)){for(var S=y,C=0;S.charAt(0)=="<"&&(C=S.indexOf(">"))>-1;)S=S.slice(C+1);for(var L=0;L<v.length;++L){var O=v[L];O.s.c==d&&O.s.r<l&&l<=O.e.r&&(d=O.e.c+1,L=-1)}var H=Bn(y.slice(0,y.indexOf(">")));f=H.colspan?+H.colspan:1,((h=+H.rowspan)>1||f>1)&&v.push({s:{r:l,c:d},e:{r:l+(h||1)-1,c:d+f-1}});var z=H.t||H["data-t"]||"";if(!S.length){d+=f;continue}if(S=DR(S),p.s.r>l&&(p.s.r=l),p.e.r<l&&(p.e.r=l),p.s.c>d&&(p.s.c=d),p.e.c<d&&(p.e.c=d),!S.length){d+=f;continue}var q={t:"s",v:S};t.raw||!S.trim().length||z=="s"||(S==="TRUE"?q={t:"b",v:!0}:S==="FALSE"?q={t:"b",v:!1}:isNaN(Xc(S))?isNaN(Um(S).getDate())||(q={t:"d",v:Is(S)},t.cellDates||(q={t:"n",v:Ii(q.v)}),q.z=t.dateNF||On[14]):q={t:"n",v:Xc(S)}),t.dense?(n[l]||(n[l]=[]),n[l][d]=q):n[Fn({r:l,c:d})]=q,d+=f}}}}return n["!ref"]=Jn(p),v.length&&(n["!merges"]=v),n}function gse(e,r,t,n){for(var s=e["!merges"]||[],o=[],i=r.s.c;i<=r.e.c;++i){for(var c=0,u=0,l=0;l<s.length;++l)if(!(s[l].s.r>t||s[l].s.c>i)&&!(s[l].e.r<t||s[l].e.c<i)){if(s[l].s.r<t||s[l].s.c<i){c=-1;break}c=s[l].e.r-s[l].s.r+1,u=s[l].e.c-s[l].s.c+1;break}if(!(c<0)){var d=Fn({r:t,c:i}),h=n.dense?(e[t]||[])[i]:e[d],f=h&&h.v!=null&&(h.h||l_(h.w||(Fd(h),h.w)||""))||"",p={};c>1&&(p.rowspan=c),u>1&&(p.colspan=u),n.editable?f='<span contenteditable="true">'+f+"</span>":h&&(p["data-t"]=h&&h.t||"z",h.v!=null&&(p["data-v"]=h.v),h.z!=null&&(p["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+h.l.Target+'">'+f+"</a>")),p.id=(n.id||"sjs")+"-"+d,o.push(zr("td",f,p))}}var v="<tr>";return v+o.join("")+"</tr>"}var vse='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',xse="</body></html>";function bse(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return rh(DC(t[0],r),r);var n=P_();return t.forEach(function(s,o){F_(n,DC(s,r),"Sheet"+(o+1))}),n}function yse(e,r,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function dE(e,r){var t=r||{},n=t.header!=null?t.header:vse,s=t.footer!=null?t.footer:xse,o=[n],i=vl(e["!ref"]);t.dense=Array.isArray(e),o.push(yse(e,i,t));for(var c=i.s.r;c<=i.e.r;++c)o.push(gse(e,i,c,t));return o.push("</table>"+s),o.join("")}function fE(e,r,t){var n=t||{},s=0,o=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?Gs(n.origin):n.origin;s=i.r,o=i.c}var c=r.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,c.length),l={s:{r:0,c:0},e:{r:s,c:o}};if(e["!ref"]){var d=vl(e["!ref"]);l.s.r=Math.min(l.s.r,d.s.r),l.s.c=Math.min(l.s.c,d.s.c),l.e.r=Math.max(l.e.r,d.e.r),l.e.c=Math.max(l.e.c,d.e.c),s==-1&&(l.e.r=s=d.e.r+1)}var h=[],f=0,p=e["!rows"]||(e["!rows"]=[]),v=0,g=0,m=0,b=0,y=0,S=0;for(e["!cols"]||(e["!cols"]=[]);v<c.length&&g<u;++v){var C=c[v];if(IC(C)){if(n.display)continue;p[g]={hidden:!0}}var L=C.children;for(m=b=0;m<L.length;++m){var O=L[m];if(!(n.display&&IC(O))){var H=O.hasAttribute("data-v")?O.getAttribute("data-v"):O.hasAttribute("v")?O.getAttribute("v"):DR(O.innerHTML),z=O.getAttribute("data-z")||O.getAttribute("z");for(f=0;f<h.length;++f){var q=h[f];q.s.c==b+o&&q.s.r<g+s&&g+s<=q.e.r&&(b=q.e.c+1-o,f=-1)}S=+O.getAttribute("colspan")||1,((y=+O.getAttribute("rowspan")||1)>1||S>1)&&h.push({s:{r:g+s,c:b+o},e:{r:g+s+(y||1)-1,c:b+o+(S||1)-1}});var D={t:"s",v:H},W=O.getAttribute("data-t")||O.getAttribute("t")||"";H!=null&&(H.length==0?D.t=W||"z":n.raw||H.trim().length==0||W=="s"||(H==="TRUE"?D={t:"b",v:!0}:H==="FALSE"?D={t:"b",v:!1}:isNaN(Xc(H))?isNaN(Um(H).getDate())||(D={t:"d",v:Is(H)},n.cellDates||(D={t:"n",v:Ii(D.v)}),D.z=n.dateNF||On[14]):D={t:"n",v:Xc(H)})),D.z===void 0&&z!=null&&(D.z=z);var P="",I=O.getElementsByTagName("A");if(I&&I.length)for(var U=0;U<I.length&&!(I[U].hasAttribute("href")&&(P=I[U].getAttribute("href"),P.charAt(0)!="#"));++U);P&&P.charAt(0)!="#"&&(D.l={Target:P}),n.dense?(e[g+s]||(e[g+s]=[]),e[g+s][b+o]=D):e[Fn({c:b+o,r:g+s})]=D,l.e.c<b+o&&(l.e.c=b+o),b+=S}}++g}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),l.e.r=Math.max(l.e.r,g-1+s),e["!ref"]=Jn(l),g>=u&&(e["!fullref"]=Jn((l.e.r=c.length-v+g-1+s,l))),e}function hE(e,r){var t=r||{},n=t.dense?[]:{};return fE(n,e,r)}function wse(e,r){return rh(hE(e,r),r)}function IC(e){var r="",t=Sse(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function Sse(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function _se(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=Fa(r.replace(/<[^>]*>/g,""));return[t]}var OC={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function pE(e,r){var t=r||{},n=c_(e),s=[],o,i,c={name:""},u="",l=0,d,h,f={},p=[],v=t.dense?[]:{},g,m,b={value:""},y="",S=0,C=[],L=-1,O=-1,H={s:{r:1e6,c:1e7},e:{r:0,c:0}},z=0,q={},D=[],W={},P=0,I=0,U=[],k=1,_=1,R=[],j={Names:[]},A={},N=["",""],V=[],M={},Z="",J=0,re=!1,X=!1,ne=0;for(zv.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=zv.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(H.e.c>=H.s.c&&H.e.r>=H.s.r?v["!ref"]=Jn(H):v["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=H.e.r&&(v["!fullref"]=v["!ref"],H.e.r=t.sheetRows-1,v["!ref"]=Jn(H)),D.length&&(v["!merges"]=D),U.length&&(v["!rows"]=U),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),p.push(d.name),f[d.name]=v,X=!1):g[0].charAt(g[0].length-2)!=="/"&&(d=Bn(g[0],!1),L=O=-1,H.s.r=H.s.c=1e7,H.e.r=H.e.c=0,v=t.dense?[]:{},D=[],U=[],X=!0);break;case"table-row-group":g[1]==="/"?--z:++z;break;case"table-row":case"":if(g[1]==="/"){L+=k,k=1;break}if(h=Bn(g[0],!1),h.?L=h.-1:L==-1&&(L=0),k=+h["number-rows-repeated"]||1,k<10)for(ne=0;ne<k;++ne)z>0&&(U[L+ne]={level:z});O=-1;break;case"covered-table-cell":g[1]!=="/"&&++O,t.sheetStubs&&(t.dense?(v[L]||(v[L]=[]),v[L][O]={t:"z"}):v[Fn({r:L,c:O})]={t:"z"}),y="",C=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++O,b=Bn(g[0],!1),_=parseInt(b["number-columns-repeated"]||"1",10),m={t:"z",v:null},b.formula&&t.cellFormula!=!1&&(m.f=TC(Fa(b.formula))),(b.||b["value-type"])=="string"&&(m.t="s",m.v=Fa(b["string-value"]||""),t.dense?(v[L]||(v[L]=[]),v[L][O]=m):v[Fn({r:L,c:O})]=m),O+=_-1;else if(g[1]!=="/"){++O,y="",S=0,C=[],_=1;var Y=k?L+k-1:L;if(O>H.e.c&&(H.e.c=O),O<H.s.c&&(H.s.c=O),L<H.s.r&&(H.s.r=L),Y>H.e.r&&(H.e.r=Y),b=Bn(g[0],!1),V=[],M={},m={t:b.||b["value-type"],v:null},t.cellFormula)if(b.formula&&(b.formula=Fa(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(P=parseInt(b["number-matrix-rows-spanned"],10)||0,I=parseInt(b["number-matrix-columns-spanned"],10)||0,W={s:{r:L,c:O},e:{r:L+P-1,c:O+I-1}},m.F=Jn(W),R.push([W,m.F])),b.formula)m.f=TC(b.formula);else for(ne=0;ne<R.length;++ne)L>=R[ne][0].s.r&&L<=R[ne][0].e.r&&O>=R[ne][0].s.c&&O<=R[ne][0].e.c&&(m.F=R[ne][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(P=parseInt(b["number-rows-spanned"],10)||0,I=parseInt(b["number-columns-spanned"],10)||0,W={s:{r:L,c:O},e:{r:L+P-1,c:O+I-1}},D.push(W)),b["number-columns-repeated"]&&(_=parseInt(b["number-columns-repeated"],10)),m.t){case"boolean":m.t="b",m.v=Ds(b["boolean-value"]);break;case"float":m.t="n",m.v=parseFloat(b.value);break;case"percentage":m.t="n",m.v=parseFloat(b.value);break;case"currency":m.t="n",m.v=parseFloat(b.value);break;case"date":m.t="d",m.v=Is(b["date-value"]),t.cellDates||(m.t="n",m.v=Ii(m.v)),m.z="m/d/yy";break;case"time":m.t="n",m.v=YK(b["time-value"])/86400,t.cellDates&&(m.t="d",m.v=Pw(m.v)),m.z="HH:MM:SS";break;case"number":m.t="n",m.v=parseFloat(b.);break;default:if(m.t==="string"||m.t==="text"||!m.t)m.t="s",b["string-value"]!=null&&(y=Fa(b["string-value"]),C=[]);else throw new Error("Unsupported value type "+m.t)}}else{if(re=!1,m.t==="s"&&(m.v=y||"",C.length&&(m.R=C),re=S==0),A.Target&&(m.l=A),V.length>0&&(m.c=V,V=[]),y&&t.cellText!==!1&&(m.w=y),re&&(m.t="z",delete m.v),(!re||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=L))for(var K=0;K<k;++K){if(_=parseInt(b["number-columns-repeated"]||"1",10),t.dense)for(v[L+K]||(v[L+K]=[]),v[L+K][O]=K==0?m:Os(m);--_>0;)v[L+K][O+_]=Os(m);else for(v[Fn({r:L+K,c:O})]=m;--_>0;)v[Fn({r:L+K,c:O+_})]=Os(m);H.e.c<=O&&(H.e.c=O)}_=parseInt(b["number-columns-repeated"]||"1",10),O+=_-1,_=0,m={},y="",C=[]}A={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((o=s.pop())[0]!==g[3])throw"Bad state: "+o}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((o=s.pop())[0]!==g[3])throw"Bad state: "+o;M.t=y,C.length&&(M.R=C),M.a=Z,V.push(M)}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);Z="",J=0,y="",S=0,C=[];break;case"creator":g[1]==="/"?Z=n.slice(J,g.index):J=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((o=s.pop())[0]!==g[3])throw"Bad state: "+o}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);y="",S=0,C=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(q[c.name]=u,(o=s.pop())[0]!==g[3])throw"Bad state: "+o}else g[0].charAt(g[0].length-2)!=="/"&&(u="",c=Bn(g[0],!1),s.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Bn(g[0],!1),u+=OC[g[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Bn(g[0],!1),u+=OC[g[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(l,g.index);break}else l=g.index+g[0].length;break;case"named-range":i=Bn(g[0],!1),N=C3(i["cell-range-address"]);var ee={Name:i.name,Ref:N[0]+"!"+N[1]};X&&(ee.Sheet=p.length),j.Names.push(ee);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(g[1]==="/"&&(!b||!b["string-value"])){var ue=_se(n.slice(S,g.index));y=(y.length>0?y+`
`:"")+ue[0]}else Bn(g[0],!1),S=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{N=C3(Bn(g[0])["target-range-address"]),f[N[0]]["!autofilter"]={ref:N[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(A=Bn(g[0],!1),!A.href)break;A.Target=Fa(A.href),delete A.href,A.Target.charAt(0)=="#"&&A.Target.indexOf(".")>-1?(N=C3(A.Target.slice(1)),A.Target="#"+N[0]+"!"+N[1]):A.Target.match(/^\.\.[\\\/]/)&&(A.Target=A.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(g)}}var se={Sheets:f,SheetNames:p,Workbook:j};return t.bookSheets&&delete se.Sheets,se}function PC(e,r){r=r||{},dc(e,"META-INF/manifest.xml")&&YX(ki(e,"META-INF/manifest.xml"),r);var t=Ul(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=pE(hs(t),r);return dc(e,"meta.xml")&&(n.Props=a9(ki(e,"meta.xml"))),n}function FC(e,r){return pE(e,r)}var Ase=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+Bv({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return wi+r}}(),BC=function(){var e=function(o){return os(o).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,n=function(o,i,c){var u=[];u.push('      <table:table table:name="'+os(i.SheetNames[c])+`" table:style-name="ta1">
`);var l=0,d=0,h=vl(o["!ref"]||"A1"),f=o["!merges"]||[],p=0,v=Array.isArray(o);if(o["!cols"])for(d=0;d<=h.e.c;++d)u.push("        <table:table-column"+(o["!cols"][d]?' table:style-name="co'+o["!cols"][d].ods+'"':"")+`></table:table-column>
`);var g="",m=o["!rows"]||[];for(l=0;l<h.s.r;++l)g=m[l]?' table:style-name="ro'+m[l].ods+'"':"",u.push("        <table:table-row"+g+`></table:table-row>
`);for(;l<=h.e.r;++l){for(g=m[l]?' table:style-name="ro'+m[l].ods+'"':"",u.push("        <table:table-row"+g+`>
`),d=0;d<h.s.c;++d)u.push(r);for(;d<=h.e.c;++d){var b=!1,y={},S="";for(p=0;p!=f.length;++p)if(!(f[p].s.c>d)&&!(f[p].s.r>l)&&!(f[p].e.c<d)&&!(f[p].e.r<l)){(f[p].s.c!=d||f[p].s.r!=l)&&(b=!0),y["table:number-columns-spanned"]=f[p].e.c-f[p].s.c+1,y["table:number-rows-spanned"]=f[p].e.r-f[p].s.r+1;break}if(b){u.push(t);continue}var C=Fn({r:l,c:d}),L=v?(o[l]||[])[d]:o[C];if(L&&L.f&&(y["table:formula"]=os(Vte(L.f)),L.F&&L.F.slice(0,C.length)==C)){var O=vl(L.F);y["table:number-matrix-columns-spanned"]=O.e.c-O.s.c+1,y["table:number-matrix-rows-spanned"]=O.e.r-O.s.r+1}if(!L){u.push(r);continue}switch(L.t){case"b":S=L.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=L.v?"true":"false";break;case"n":S=L.w||String(L.v||0),y["office:value-type"]="float",y["office:value"]=L.v||0;break;case"s":case"str":S=L.v==null?"":L.v,y["office:value-type"]="string";break;case"d":S=L.w||Is(L.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=Is(L.v).toISOString(),y["table:style-name"]="ce1";break;default:u.push(r);continue}var H=e(S);if(L.l&&L.l.Target){var z=L.l.Target;z=z.charAt(0)=="#"?"#"+Wte(z.slice(1)):z,z.charAt(0)!="#"&&!z.match(/^\w+:/)&&(z="../"+z),H=zr("text:a",H,{"xlink:href":z.replace(/&/g,"&amp;")})}u.push("          "+zr("table:table-cell",zr("text:p",H,{}),y)+`
`)}u.push(`        </table:table-row>
`)}return u.push(`      </table:table>
`),u.join("")},s=function(o,i){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var c=0;i.SheetNames.map(function(l){return i.Sheets[l]}).forEach(function(l){if(l&&l["!cols"]){for(var d=0;d<l["!cols"].length;++d)if(l["!cols"][d]){var h=l["!cols"][d];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Hf(h),h.ods=c;var f=l["!cols"][d].wpx+"px";o.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),o.push(`  </style:style>
`),++c}}});var u=0;i.SheetNames.map(function(l){return i.Sheets[l]}).forEach(function(l){if(l&&l["!rows"]){for(var d=0;d<l["!rows"].length;++d)if(l["!rows"][d]){l["!rows"][d].ods=u;var h=l["!rows"][d].hpx+"px";o.push('  <style:style style:name="ro'+u+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),o.push(`  </style:style>
`),++u}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(i,c){var u=[wi],l=Bv({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Bv({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(u.push("<office:document"+l+d+`>
`),u.push(n9().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+l+`>
`),s(u,i),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var h=0;h!=i.SheetNames.length;++h)u.push(n(i.Sheets[i.SheetNames[h]],i,h));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),c.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}}();function mE(e,r){if(r.bookType=="fods")return BC(e,r);var t=s_(),n="",s=[],o=[];return n="mimetype",aa(t,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",aa(t,n,BC(e,r)),s.push([n,"text/xml"]),o.push([n,"ContentFile"]),n="styles.xml",aa(t,n,Ase(e,r)),s.push([n,"text/xml"]),o.push([n,"StylesFile"]),n="meta.xml",aa(t,n,wi+n9()),s.push([n,"text/xml"]),o.push([n,"MetadataFile"]),n="manifest.rdf",aa(t,n,QX(o)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",aa(t,n,ZX(s)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function $0(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function WS(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):hs(th(e))}function Cse(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):$l(Bu(e))}function jse(e,r){e:for(var t=0;t<=e.length-r.length;++t){for(var n=0;n<r.length;++n)if(e[t+n]!=r[n])continue e;return!0}return!1}function Wf(e){var r=e.reduce(function(s,o){return s+o.length},0),t=new Uint8Array(r),n=0;return e.forEach(function(s){t.set(s,n),n+=s.length}),t}function zC(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function kse(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,n=e[r+14]&1,s=r+13;s>=r;--s)n=n*256+e[s];return(e[r+15]&128?-n:n)*Math.pow(10,t-6176)}function Rse(e,r,t){var n=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,s=t/Math.pow(10,n-6176);e[r+15]|=n>>7,e[r+14]|=(n&127)<<1;for(var o=0;s>=1;++o,s/=256)e[r+o]=s&255;e[r+15]|=t>=0?0:128}function Gv(e,r){var t=r?r[0]:0,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),n}function as(e){var r=new Uint8Array(7);r[0]=e&127;var t=1;e:if(e>127){if(r[t-1]|=128,r[t]=e>>7&127,++t,e<=16383||(r[t-1]|=128,r[t]=e>>14&127,++t,e<=2097151)||(r[t-1]|=128,r[t]=e>>21&127,++t,e<=268435455)||(r[t-1]|=128,r[t]=e/256>>>21&127,++t,e<=34359738367)||(r[t-1]|=128,r[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;r[t-1]|=128,r[t]=e/16777216>>>21&127,++t}return r.slice(0,t)}function ni(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function Ha(e){for(var r=[],t=[0];t[0]<e.length;){var n=t[0],s=Gv(e,t),o=s&7;s=Math.floor(s/8);var i=0,c;if(s==0)break;switch(o){case 0:{for(var u=t[0];e[t[0]++]>=128;);c=e.slice(u,t[0])}break;case 5:i=4,c=e.slice(t[0],t[0]+i),t[0]+=i;break;case 1:i=8,c=e.slice(t[0],t[0]+i),t[0]+=i;break;case 2:i=Gv(e,t),c=e.slice(t[0],t[0]+i),t[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(s," at offset ").concat(n))}var l={data:c,type:o};r[s]==null?r[s]=[l]:r[s].push(l)}return r}function so(e){var r=[];return e.forEach(function(t,n){t.forEach(function(s){s.data&&(r.push(as(n*8+s.type)),s.type==2&&r.push(as(s.data.length)),r.push(s.data))})}),Wf(r)}function L_(e,r){return(e==null?void 0:e.map(function(t){return r(t.data)}))||[]}function lc(e){for(var r,t=[],n=[0];n[0]<e.length;){var s=Gv(e,n),o=Ha(e.slice(n[0],n[0]+s));n[0]+=s;var i={id:ni(o[1][0].data),messages:[]};o[2].forEach(function(c){var u=Ha(c.data),l=ni(u[3][0].data);i.messages.push({meta:u,data:e.slice(n[0],n[0]+l)}),n[0]+=l}),(r=o[3])!=null&&r[0]&&(i.merge=ni(o[3][0].data)>>>0>0),t.push(i)}return t}function bm(e){var r=[];return e.forEach(function(t){var n=[];n[1]=[{data:as(t.id),type:0}],n[2]=[],t.merge!=null&&(n[3]=[{data:as(+!!t.merge),type:0}]);var s=[];t.messages.forEach(function(i){s.push(i.data),i.meta[3]=[{type:0,data:as(i.data.length)}],n[2].push({data:so(i.meta),type:2})});var o=so(n);r.push(as(o.length)),r.push(o),s.forEach(function(i){return r.push(i)})}),Wf(r)}function Ese(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],n=Gv(r,t),s=[];t[0]<r.length;){var o=r[t[0]]&3;if(o==0){var i=r[t[0]++]>>2;if(i<60)++i;else{var c=i-59;i=r[t[0]],c>1&&(i|=r[t[0]+1]<<8),c>2&&(i|=r[t[0]+2]<<16),c>3&&(i|=r[t[0]+3]<<24),i>>>=0,i++,t[0]+=c}s.push(r.slice(t[0],t[0]+i)),t[0]+=i;continue}else{var u=0,l=0;if(o==1?(l=(r[t[0]]>>2&7)+4,u=(r[t[0]++]&224)<<3,u|=r[t[0]++]):(l=(r[t[0]++]>>2)+1,o==2?(u=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(u=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),s=[Wf(s)],u==0)throw new Error("Invalid offset 0");if(u>s[0].length)throw new Error("Invalid offset beyond length");if(l>=u)for(s.push(s[0].slice(-u)),l-=u;l>=s[s.length-1].length;)s.push(s[s.length-1]),l-=s[s.length-1].length;s.push(s[0].slice(-u,-u+l))}}var d=Wf(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function cc(e){for(var r=[],t=0;t<e.length;){var n=e[t++],s=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(Ese(n,e.slice(t,t+s))),t+=s}if(t!==e.length)throw new Error("data is not a valid framed stream!");return Wf(r)}function ym(e){for(var r=[],t=0;t<e.length;){var n=Math.min(e.length-t,268435455),s=new Uint8Array(4);r.push(s);var o=as(n),i=o.length;r.push(o),n<=60?(i++,r.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,r.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,r.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,r.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,r.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),r.push(e.slice(t,t+n)),i+=n,s[0]=0,s[1]=i&255,s[2]=i>>8&255,s[3]=i>>16&255,t+=n}return Wf(r)}function Nse(e,r,t,n){var s=$0(e),o=s.getUint32(4,!0),i=(n>1?12:8)+zC(o&(n>1?3470:398))*4,c=-1,u=-1,l=NaN,d=new Date(2001,0,1);o&512&&(c=s.getUint32(i,!0),i+=4),i+=zC(o&(n>1?12288:4096))*4,o&16&&(u=s.getUint32(i,!0),i+=4),o&32&&(l=s.getFloat64(i,!0),i+=8),o&64&&(d.setTime(d.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:r[u]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:l>0};break;case 7:h={t:"n",v:l/86400};break;case 8:h={t:"e",v:0};break;case 9:if(c>-1)h={t:"s",v:t[c]};else if(u>-1)h={t:"s",v:r[u]};else if(!isNaN(l))h={t:"n",v:l};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function Tse(e,r,t){var n=$0(e),s=n.getUint32(8,!0),o=12,i=-1,c=-1,u=NaN,l=NaN,d=new Date(2001,0,1);s&1&&(u=kse(e,o),o+=16),s&2&&(l=n.getFloat64(o,!0),o+=8),s&4&&(d.setTime(d.getTime()+n.getFloat64(o,!0)*1e3),o+=8),s&8&&(c=n.getUint32(o,!0),o+=4),s&16&&(i=n.getUint32(o,!0),o+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:u};break;case 3:h={t:"s",v:r[c]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:l>0};break;case 7:h={t:"n",v:l/86400};break;case 8:h={t:"e",v:0};break;case 9:if(i>-1)h={t:"s",v:t[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return h}function k3(e,r){var t=new Uint8Array(32),n=$0(t),s=12,o=0;switch(t[0]=5,e.t){case"n":t[1]=2,Rse(t,s,e.v),o|=1,s+=16;break;case"b":t[1]=6,n.setFloat64(s,e.v?1:0,!0),o|=2,s+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[1]=3,n.setUint32(s,r.indexOf(e.v),!0),o|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,o,!0),t.slice(0,s)}function R3(e,r){var t=new Uint8Array(32),n=$0(t),s=12,o=0;switch(t[0]=3,e.t){case"n":t[2]=2,n.setFloat64(s,e.v,!0),o|=32,s+=8;break;case"b":t[2]=6,n.setFloat64(s,e.v?1:0,!0),o|=32,s+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[2]=3,n.setUint32(s,r.indexOf(e.v),!0),o|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,o,!0),t.slice(0,s)}function Lse(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return Nse(e,r,t,e[0]);case 5:return Tse(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function jo(e){var r=Ha(e);return Gv(r[1][0].data)}function $C(e,r){var t=Ha(r.data),n=ni(t[1][0].data),s=t[3],o=[];return(s||[]).forEach(function(i){var c=Ha(i.data),u=ni(c[1][0].data)>>>0;switch(n){case 1:o[u]=WS(c[3][0].data);break;case 8:{var l=e[jo(c[9][0].data)][0],d=Ha(l.data),h=e[jo(d[1][0].data)][0],f=ni(h.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var p=Ha(h.data);o[u]=p[3].map(function(v){return WS(v.data)}).join("")}break}}),o}function Mse(e,r){var t,n,s,o,i,c,u,l,d,h,f,p,v,g,m=Ha(e),b=ni(m[1][0].data)>>>0,y=ni(m[2][0].data)>>>0,S=((n=(t=m[8])==null?void 0:t[0])==null?void 0:n.data)&&ni(m[8][0].data)>0||!1,C,L;if((o=(s=m[7])==null?void 0:s[0])!=null&&o.data&&r!=0)C=(c=(i=m[7])==null?void 0:i[0])==null?void 0:c.data,L=(l=(u=m[6])==null?void 0:u[0])==null?void 0:l.data;else if((h=(d=m[4])==null?void 0:d[0])!=null&&h.data&&r!=1)C=(p=(f=m[4])==null?void 0:f[0])==null?void 0:p.data,L=(g=(v=m[3])==null?void 0:v[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var O=S?4:1,H=$0(C),z=[],q=0;q<C.length/2;++q){var D=H.getUint16(q*2,!0);D<65535&&z.push([q,D])}if(z.length!=y)throw"Expected ".concat(y," cells, found ").concat(z.length);var W=[];for(q=0;q<z.length-1;++q)W[z[q][0]]=L.subarray(z[q][1]*O,z[q+1][1]*O);return z.length>=1&&(W[z[z.length-1][0]]=L.subarray(z[z.length-1][1]*O)),{R:b,cells:W}}function Dse(e,r){var t,n=Ha(r.data),s=(t=n==null?void 0:n[7])!=null&&t[0]?ni(n[7][0].data)>>>0>0?1:0:-1,o=L_(n[5],function(i){return Mse(i,s)});return{nrows:ni(n[4][0].data)>>>0,data:o.reduce(function(i,c){return i[c.R]||(i[c.R]=[]),c.cells.forEach(function(u,l){if(i[c.R][l])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(l));i[c.R][l]=u}),i},[])}}function Ise(e,r,t){var n,s=Ha(r.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(ni(s[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(o.e.c=(ni(s[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));t["!ref"]=Jn(o);var i=Ha(s[4][0].data),c=$C(e,e[jo(i[4][0].data)][0]),u=(n=i[17])!=null&&n[0]?$C(e,e[jo(i[17][0].data)][0]):[],l=Ha(i[3][0].data),d=0;l[1].forEach(function(h){var f=Ha(h.data),p=e[jo(f[2][0].data)][0],v=ni(p.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var g=Dse(e,p);g.data.forEach(function(m,b){m.forEach(function(y,S){var C=Fn({r:d+b,c:S}),L=Lse(y,c,u);L&&(t[C]=L)})}),d+=g.nrows})}function Ose(e,r){var t=Ha(r.data),n={"!ref":"A1"},s=e[jo(t[2][0].data)],o=ni(s[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return Ise(e,s[0],n),n}function Pse(e,r){var t,n=Ha(r.data),s={name:(t=n[1])!=null&&t[0]?WS(n[1][0].data):"",sheets:[]},o=L_(n[2],jo);return o.forEach(function(i){e[i].forEach(function(c){var u=ni(c.meta[1][0].data);u==6e3&&s.sheets.push(Ose(e,c))})}),s}function Fse(e,r){var t=P_(),n=Ha(r.data),s=L_(n[1],jo);if(s.forEach(function(o){e[o].forEach(function(i){var c=ni(i.meta[1][0].data);if(c==2){var u=Pse(e,i);u.sheets.forEach(function(l,d){F_(t,l,d==0?u.name:u.name+"_"+d,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function E3(e){var r,t,n,s,o={},i=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var l;try{l=cc(u.content)}catch(h){return console.log("?? "+u.content.length+" "+(h.message||h))}var d;try{d=lc(l)}catch(h){return console.log("## "+(h.message||h))}d.forEach(function(h){o[h.id]=h.messages,i.push(h.id)})}}),!i.length)throw new Error("File has no messages");var c=((s=(n=(t=(r=o==null?void 0:o[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&ni(o[1][0].meta[1][0].data)==1&&o[1][0];if(c||i.forEach(function(u){o[u].forEach(function(l){var d=ni(l.meta[1][0].data)>>>0;if(d==1)if(!c)c=l;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return Fse(o,c)}function Bse(e,r,t){var n,s,o,i;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var c=((i=(o=e[8])==null?void 0:o[0])==null?void 0:i.data)&&ni(e[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var u=0,l=$0(e[7][0].data),d=0,h=[],f=$0(e[4][0].data),p=0,v=[],g=0;g<r.length;++g){if(r[g]==null){l.setUint16(g*2,65535,!0),f.setUint16(g*2,65535);continue}l.setUint16(g*2,d,!0),f.setUint16(g*2,p,!0);var m,b;switch(typeof r[g]){case"string":m=k3({t:"s",v:r[g]},t),b=R3({t:"s",v:r[g]},t);break;case"number":m=k3({t:"n",v:r[g]},t),b=R3({t:"n",v:r[g]},t);break;case"boolean":m=k3({t:"b",v:r[g]},t),b=R3({t:"b",v:r[g]},t);break;default:throw new Error("Unsupported value "+r[g])}h.push(m),d+=m.length,v.push(b),p+=b.length,++u}for(e[2][0].data=as(u);g<e[7][0].data.length/2;++g)l.setUint16(g*2,65535,!0),f.setUint16(g*2,65535,!0);return e[6][0].data=Wf(h),e[3][0].data=Wf(v),u}function zse(e,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=vl(t["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Jn(n)));var o=F2(t,{range:n,header:1}),i=["~Sh33tJ5~"];o.forEach(function(Z){return Z.forEach(function(J){typeof J=="string"&&i.push(J)})});var c={},u=[],l=An.read(r.numbers,{type:"base64"});l.FileIndex.map(function(Z,J){return[Z,l.FullPaths[J]]}).forEach(function(Z){var J=Z[0],re=Z[1];if(J.type==2&&J.name.match(/\.iwa/)){var X=J.content,ne=cc(X),Y=lc(ne);Y.forEach(function(K){u.push(K.id),c[K.id]={deps:[],location:re,type:ni(K.messages[0].meta[1][0].data)}})}}),u.sort(function(Z,J){return Z-J});var d=u.filter(function(Z){return Z>1}).map(function(Z){return[Z,as(Z)]});l.FileIndex.map(function(Z,J){return[Z,l.FullPaths[J]]}).forEach(function(Z){var J=Z[0];if(Z[1],!!J.name.match(/\.iwa/)){var re=lc(cc(J.content));re.forEach(function(X){X.messages.forEach(function(ne){d.forEach(function(Y){X.messages.some(function(K){return ni(K.meta[1][0].data)!=11006&&jse(K.data,Y[1])})&&c[Y[0]].deps.push(X.id)})})})}});for(var h=An.find(l,c[1].location),f=lc(cc(h.content)),p,v=0;v<f.length;++v){var g=f[v];g.id==1&&(p=g)}var m=jo(Ha(p.messages[0].data)[1][0].data);for(h=An.find(l,c[m].location),f=lc(cc(h.content)),v=0;v<f.length;++v)g=f[v],g.id==m&&(p=g);for(m=jo(Ha(p.messages[0].data)[2][0].data),h=An.find(l,c[m].location),f=lc(cc(h.content)),v=0;v<f.length;++v)g=f[v],g.id==m&&(p=g);for(m=jo(Ha(p.messages[0].data)[2][0].data),h=An.find(l,c[m].location),f=lc(cc(h.content)),v=0;v<f.length;++v)g=f[v],g.id==m&&(p=g);var b=Ha(p.messages[0].data);{b[6][0].data=as(n.e.r+1),b[7][0].data=as(n.e.c+1);var y=jo(b[46][0].data),S=An.find(l,c[y].location),C=lc(cc(S.content));{for(var L=0;L<C.length&&C[L].id!=y;++L);if(C[L].id!=y)throw"Bad ColumnRowUIDMapArchive";var O=Ha(C[L].messages[0].data);O[1]=[],O[2]=[],O[3]=[];for(var H=0;H<=n.e.c;++H){var z=[];z[1]=z[2]=[{type:0,data:as(H+420690)}],O[1].push({type:2,data:so(z)}),O[2].push({type:0,data:as(H)}),O[3].push({type:0,data:as(H)})}O[4]=[],O[5]=[],O[6]=[];for(var q=0;q<=n.e.r;++q)z=[],z[1]=z[2]=[{type:0,data:as(q+726270)}],O[4].push({type:2,data:so(z)}),O[5].push({type:0,data:as(q)}),O[6].push({type:0,data:as(q)});C[L].messages[0].data=so(O)}S.content=ym(bm(C)),S.size=S.content.length,delete b[46];var D=Ha(b[4][0].data);{D[7][0].data=as(n.e.r+1);var W=Ha(D[1][0].data),P=jo(W[2][0].data);S=An.find(l,c[P].location),C=lc(cc(S.content));{if(C[0].id!=P)throw"Bad HeaderStorageBucket";var I=Ha(C[0].messages[0].data);for(q=0;q<o.length;++q){var U=Ha(I[2][0].data);U[1][0].data=as(q),U[4][0].data=as(o[q].length),I[2][q]={type:I[2][0].type,data:so(U)}}C[0].messages[0].data=so(I)}S.content=ym(bm(C)),S.size=S.content.length;var k=jo(D[2][0].data);S=An.find(l,c[k].location),C=lc(cc(S.content));{if(C[0].id!=k)throw"Bad HeaderStorageBucket";for(I=Ha(C[0].messages[0].data),H=0;H<=n.e.c;++H)U=Ha(I[2][0].data),U[1][0].data=as(H),U[4][0].data=as(n.e.r+1),I[2][H]={type:I[2][0].type,data:so(U)};C[0].messages[0].data=so(I)}S.content=ym(bm(C)),S.size=S.content.length;var _=jo(D[4][0].data);(function(){for(var Z=An.find(l,c[_].location),J=lc(cc(Z.content)),re,X=0;X<J.length;++X){var ne=J[X];ne.id==_&&(re=ne)}var Y=Ha(re.messages[0].data);{Y[3]=[];var K=[];i.forEach(function(se,ce){K[1]=[{type:0,data:as(ce)}],K[2]=[{type:0,data:as(1)}],K[3]=[{type:2,data:Cse(se)}],Y[3].push({type:2,data:so(K)})})}re.messages[0].data=so(Y);var ee=bm(J),ue=ym(ee);Z.content=ue,Z.size=Z.content.length})();var R=Ha(D[3][0].data);{var j=R[1][0];delete R[2];var A=Ha(j.data);{var N=jo(A[2][0].data);(function(){for(var Z=An.find(l,c[N].location),J=lc(cc(Z.content)),re,X=0;X<J.length;++X){var ne=J[X];ne.id==N&&(re=ne)}var Y=Ha(re.messages[0].data);{delete Y[6],delete R[7];var K=new Uint8Array(Y[5][0].data);Y[5]=[];for(var ee=0,ue=0;ue<=n.e.r;++ue){var se=Ha(K);ee+=Bse(se,o[ue],i),se[1][0].data=as(ue),Y[5].push({data:so(se),type:2})}Y[1]=[{type:0,data:as(n.e.c+1)}],Y[2]=[{type:0,data:as(n.e.r+1)}],Y[3]=[{type:0,data:as(ee)}],Y[4]=[{type:0,data:as(n.e.r+1)}]}re.messages[0].data=so(Y);var ce=bm(J),fe=ym(ce);Z.content=fe,Z.size=Z.content.length})()}j.data=so(A)}D[3][0].data=so(R)}b[4][0].data=so(D)}p.messages[0].data=so(b);var V=bm(f),M=ym(V);return h.content=M,h.size=h.content.length,l}function gE(e){return function(t){for(var n=0;n!=e.length;++n){var s=e[n];t[s[0]]===void 0&&(t[s[0]]=s[1]),s[2]==="n"&&(t[s[0]]=Number(t[s[0]]))}}}function M_(e){gE([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function D_(e){gE([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function $se(e){return ya.WS.indexOf(e)>-1?"sheet":e==ya.CS?"chart":e==ya.DS?"dialog":e==ya.MS?"macro":e&&e.length?e:"sheet"}function Use(e,r){if(!e)return 0;try{e=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,$se(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Hse(e,r,t,n,s,o,i,c,u,l,d,h){try{o[n]=vv(Ul(e,t,!0),r);var f=ki(e,r),p;switch(c){case"sheet":p=dae(f,r,s,u,o[n],l,d,h);break;case"chart":if(p=fae(f,r,s,u,o[n],l,d,h),!p||!p["!drawel"])break;var v=tv(p["!drawel"].Target,r),g=$v(v),m=JQ(Ul(e,v,!0),vv(Ul(e,g,!0),v)),b=tv(m,v),y=$v(b);p=Bne(Ul(e,b,!0),b,u,vv(Ul(e,y,!0),b),l,p);break;case"macro":p=hae(f,r,s,u,o[n],l,d,h);break;case"dialog":p=pae(f,r,s,u,o[n],l,d,h);break;default:throw new Error("Unrecognized sheet type "+c)}i[n]=p;var S=[];o&&o[n]&&si(o[n]).forEach(function(C){var L="";if(o[n][C].Type==ya.CMNT){L=tv(o[n][C].Target,r);var O=xae(ki(e,L,!0),L,u);if(!O||!O.length)return;jC(p,O,!1)}o[n][C].Type==ya.TCMNT&&(L=tv(o[n][C].Target,r),S=S.concat(eee(ki(e,L,!0),u)))}),S&&S.length&&jC(p,S,!0,u.people||[])}catch(C){if(u.WTF)throw C}}function ic(e){return e.charAt(0)=="/"?e.slice(1):e}function Vse(e,r){if(tg(),r=r||{},M_(r),dc(e,"META-INF/manifest.xml")||dc(e,"objectdata.xml"))return PC(e,r);if(dc(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof E3<"u"){if(e.FileIndex)return E3(e);var t=An.utils.cfb_new();return GA(e).forEach(function(U){aa(t,U,tX(e,U))}),E3(t)}throw new Error("Unsupported NUMBERS file")}if(!dc(e,"[Content_Types].xml"))throw dc(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):dc(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=GA(e),s=KX(Ul(e,"[Content_Types].xml")),o=!1,i,c;if(s.workbooks.length===0&&(c="xl/workbook.xml",ki(e,c,!0)&&s.workbooks.push(c)),s.workbooks.length===0){if(c="xl/workbook.bin",!ki(e,c,!0))throw new Error("Could not find workbook");s.workbooks.push(c),o=!0}s.workbooks[0].slice(-3)=="bin"&&(o=!0);var u={},l={};if(!r.bookSheets&&!r.bookProps){if(xv=[],s.sst)try{xv=vae(ki(e,ic(s.sst)),s.sst,r)}catch(U){if(r.WTF)throw U}r.cellStyles&&s.themes.length&&(u=gae(Ul(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],r)),s.style&&(l=mae(ki(e,ic(s.style)),s.style,u,r))}s.links.map(function(U){try{var k=vv(Ul(e,$v(ic(U))),U);return yae(ki(e,ic(U)),k,U,r)}catch{}});var d=uae(ki(e,ic(s.workbooks[0])),s.workbooks[0],r),h={},f="";s.coreprops.length&&(f=ki(e,ic(s.coreprops[0]),!0),f&&(h=a9(f)),s.extprops.length!==0&&(f=ki(e,ic(s.extprops[0]),!0),f&&tY(f,h,r)));var p={};(!r.bookSheets||r.bookProps)&&s.custprops.length!==0&&(f=Ul(e,ic(s.custprops[0]),!0),f&&(p=nY(f,r)));var v={};if((r.bookSheets||r.bookProps)&&(d.Sheets?i=d.Sheets.map(function(k){return k.name}):h.Worksheets&&h.SheetNames.length>0&&(i=h.SheetNames),r.bookProps&&(v.Props=h,v.Custprops=p),r.bookSheets&&typeof i<"u"&&(v.SheetNames=i),r.bookSheets?v.SheetNames:r.bookProps))return v;i={};var g={};r.bookDeps&&s.calcchain&&(g=bae(ki(e,ic(s.calcchain)),s.calcchain));var m=0,b={},y,S;{var C=d.Sheets;h.Worksheets=C.length,h.SheetNames=[];for(var L=0;L!=C.length;++L)h.SheetNames[L]=C[L].name}var O=o?"bin":"xml",H=s.workbooks[0].lastIndexOf("/"),z=(s.workbooks[0].slice(0,H+1)+"_rels/"+s.workbooks[0].slice(H+1)+".rels").replace(/^\//,"");dc(e,z)||(z="xl/_rels/workbook."+O+".rels");var q=vv(Ul(e,z,!0),z.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(r.xlmeta=wae(ki(e,ic(s.metadata[0])),s.metadata[0],r)),(s.people||[]).length>=1&&(r.people=ree(ki(e,ic(s.people[0])),r)),q&&(q=Use(q,d.Sheets));var D=ki(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(m=0;m!=h.Worksheets;++m){var W="sheet";if(q&&q[m]?(y="xl/"+q[m][1].replace(/[\/]?xl\//,""),dc(e,y)||(y=q[m][1]),dc(e,y)||(y=z.replace(/_rels\/.*$/,"")+q[m][1]),W=q[m][2]):(y="xl/worksheets/sheet"+(m+1-D)+"."+O,y=y.replace(/sheet0\./,"sheet.")),S=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(m!=r.sheets)continue e;break;case"string":if(h.SheetNames[m].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var P=!1,I=0;I!=r.sheets.length;++I)typeof r.sheets[I]=="number"&&r.sheets[I]==m&&(P=1),typeof r.sheets[I]=="string"&&r.sheets[I].toLowerCase()==h.SheetNames[m].toLowerCase()&&(P=1);if(!P)continue e}}Hse(e,y,S,h.SheetNames[m],m,b,i,W,r,d,u,l)}return v={Directory:s,Workbook:d,Props:h,Custprops:p,Deps:g,Sheets:i,SheetNames:h.SheetNames,Strings:xv,Styles:l,Themes:u,SSF:Os(On)},r&&r.bookFiles&&(e.files?(v.keys=n,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(U,k){U=U.replace(/^Root Entry[\/]/,""),v.keys.push(U),v.files[U]=e.FileIndex[k]}))),r&&r.bookVBA&&(s.vba.length>0?v.vbaraw=ki(e,ic(s.vba[0]),!0):s.defaults&&s.defaults.bin===uee&&(v.vbaraw=ki(e,"xl/vbaProject.bin",!0))),v}function Wse(e,r){var t=r||{},n="Workbook",s=An.find(e,n);try{if(n="/!DataSpaces/Version",s=An.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(wJ(s.content),n="/!DataSpaces/DataSpaceMap",s=An.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=_J(s.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=An.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=AJ(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=An.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);jJ(s.content)}catch{}if(n="/EncryptionInfo",s=An.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=kJ(s.content);if(n="/EncryptedPackage",s=An.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],s.content,t.password||"",t);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],s.content,t.password||"",t);throw new Error("File is password-protected")}function qse(e,r){return r.bookType=="ods"?mE(e,r):r.bookType=="numbers"?zse(e,r):r.bookType=="xlsb"?Gse(e,r):Kse(e,r)}function Gse(e,r){Cm=1024,e&&!e.SSF&&(e.SSF=Os(On)),e&&e.SSF&&(tg(),Dw(e.SSF),r.revssf=Ow(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,bv?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t=r.bookType=="xlsb"?"bin":"xml",n=H9.indexOf(r.bookType)>-1,s=b_();D_(r=r||{});var o=s_(),i="",c=0;if(r.cellXfs=[],nh(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",aa(o,i,s9(e.Props,r)),s.coreprops.push(i),ss(r.rels,2,i,ya.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],l=0;l<e.SheetNames.length;++l)(e.Workbook.Sheets[l]||{}).Hidden!=2&&u.push(e.SheetNames[l]);e.Props.SheetNames=u}for(e.Props.Worksheets=e.Props.SheetNames.length,aa(o,i,l9(e.Props)),s.extprops.push(i),ss(r.rels,3,i,ya.EXT_PROPS),e.Custprops!==e.Props&&si(e.Custprops||{}).length>0&&(i="docProps/custom.xml",aa(o,i,c9(e.Custprops)),s.custprops.push(i),ss(r.rels,4,i,ya.CUST_PROPS)),c=1;c<=e.SheetNames.length;++c){var d={"!id":{}},h=e.Sheets[e.SheetNames[c-1]],f=(h||{})["!type"]||"sheet";switch(f){case"chart":default:i="xl/worksheets/sheet"+c+"."+t,aa(o,i,_ae(c-1,i,r,e,d)),s.sheets.push(i),ss(r.wbrels,-1,"worksheets/sheet"+c+"."+t,ya.WS[0])}if(h){var p=h["!comments"],v=!1,g="";p&&p.length>0&&(g="xl/comments"+c+"."+t,aa(o,g,jae(p,g)),s.comments.push(g),ss(d,-1,"../comments"+c+"."+t,ya.CMNT),v=!0),h["!legacy"]&&v&&aa(o,"xl/drawings/vmlDrawing"+c+".vml",$9(c,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&aa(o,$v(i),Nm(d))}return r.Strings!=null&&r.Strings.length>0&&(i="xl/sharedStrings."+t,aa(o,i,Cae(r.Strings,i,r)),s.strs.push(i),ss(r.wbrels,-1,"sharedStrings."+t,ya.SST)),i="xl/workbook."+t,aa(o,i,Sae(e,i)),s.workbooks.push(i),ss(r.rels,1,i,ya.WB),i="xl/theme/theme1.xml",aa(o,i,C_(e.Themes,r)),s.themes.push(i),ss(r.wbrels,-1,"theme/theme1.xml",ya.THEME),i="xl/styles."+t,aa(o,i,Aae(e,i,r)),s.styles.push(i),ss(r.wbrels,-1,"styles."+t,ya.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",aa(o,i,e.vbaraw),s.vba.push(i),ss(r.wbrels,-1,"vbaProject.bin",ya.VBA)),i="xl/metadata."+t,aa(o,i,kae(i)),s.metadata.push(i),ss(r.wbrels,-1,"metadata."+t,ya.XLMETA),aa(o,"[Content_Types].xml",r9(s,r)),aa(o,"_rels/.rels",Nm(r.rels)),aa(o,"xl/_rels/workbook."+t+".rels",Nm(r.wbrels)),delete r.revssf,delete r.ssf,o}function Kse(e,r){Cm=1024,e&&!e.SSF&&(e.SSF=Os(On)),e&&e.SSF&&(tg(),Dw(e.SSF),r.revssf=Ow(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,bv?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xml",n=H9.indexOf(r.bookType)>-1,s=b_();D_(r=r||{});var o=s_(),i="",c=0;if(r.cellXfs=[],nh(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",aa(o,i,s9(e.Props,r)),s.coreprops.push(i),ss(r.rels,2,i,ya.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],l=0;l<e.SheetNames.length;++l)(e.Workbook.Sheets[l]||{}).Hidden!=2&&u.push(e.SheetNames[l]);e.Props.SheetNames=u}e.Props.Worksheets=e.Props.SheetNames.length,aa(o,i,l9(e.Props)),s.extprops.push(i),ss(r.rels,3,i,ya.EXT_PROPS),e.Custprops!==e.Props&&si(e.Custprops||{}).length>0&&(i="docProps/custom.xml",aa(o,i,c9(e.Custprops)),s.custprops.push(i),ss(r.rels,4,i,ya.CUST_PROPS));var d=["SheetJ5"];for(r.tcid=0,c=1;c<=e.SheetNames.length;++c){var h={"!id":{}},f=e.Sheets[e.SheetNames[c-1]],p=(f||{})["!type"]||"sheet";switch(p){case"chart":default:i="xl/worksheets/sheet"+c+"."+t,aa(o,i,eE(c-1,r,e,h)),s.sheets.push(i),ss(r.wbrels,-1,"worksheets/sheet"+c+"."+t,ya.WS[0])}if(f){var v=f["!comments"],g=!1,m="";if(v&&v.length>0){var b=!1;v.forEach(function(y){y[1].forEach(function(S){S.T==!0&&(b=!0)})}),b&&(m="xl/threadedComments/threadedComment"+c+"."+t,aa(o,m,tee(v,d,r)),s.threadedcomments.push(m),ss(h,-1,"../threadedComments/threadedComment"+c+"."+t,ya.TCMNT)),m="xl/comments"+c+"."+t,aa(o,m,U9(v)),s.comments.push(m),ss(h,-1,"../comments"+c+"."+t,ya.CMNT),g=!0}f["!legacy"]&&g&&aa(o,"xl/drawings/vmlDrawing"+c+".vml",$9(c,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&aa(o,$v(i),Nm(h))}return r.Strings!=null&&r.Strings.length>0&&(i="xl/sharedStrings."+t,aa(o,i,E9(r.Strings,r)),s.strs.push(i),ss(r.wbrels,-1,"sharedStrings."+t,ya.SST)),i="xl/workbook."+t,aa(o,i,sE(e)),s.workbooks.push(i),ss(r.rels,1,i,ya.WB),i="xl/theme/theme1.xml",aa(o,i,C_(e.Themes,r)),s.themes.push(i),ss(r.wbrels,-1,"theme/theme1.xml",ya.THEME),i="xl/styles."+t,aa(o,i,P9(e,r)),s.styles.push(i),ss(r.wbrels,-1,"styles."+t,ya.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",aa(o,i,e.vbaraw),s.vba.push(i),ss(r.wbrels,-1,"vbaProject.bin",ya.VBA)),i="xl/metadata."+t,aa(o,i,z9()),s.metadata.push(i),ss(r.wbrels,-1,"metadata."+t,ya.XLMETA),d.length>1&&(i="xl/persons/person.xml",aa(o,i,nee(d)),s.people.push(i),ss(r.wbrels,-1,"persons/person.xml",ya.PEOPLE)),aa(o,"[Content_Types].xml",r9(s,r)),aa(o,"_rels/.rels",Nm(r.rels)),aa(o,"xl/_rels/workbook."+t+".rels",Nm(r.wbrels)),delete r.revssf,delete r.ssf,o}function I_(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Wl(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function Xse(e,r){return An.find(e,"EncryptedPackage")?Wse(e,r):cE(e,r)}function Yse(e,r){var t,n=e,s=r||{};return s.type||(s.type=ma&&Buffer.isBuffer(e)?"buffer":"base64"),t=TR(n,s),Vse(t,s)}function vE(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return HS(e.slice(t),r);default:break e}return Hm.to_workbook(e,r)}function Zse(e,r){var t="",n=I_(e,r);switch(r.type){case"base64":t=Wl(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=P0(e);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=hs(t)),r.type="binary",vE(t,r)}function Jse(e,r){var t=e;return r.type=="base64"&&(t=Wl(t)),t=DS.utils.decode(1200,t.slice(2),"str"),r.type="binary",vE(t,r)}function Qse(e){return e.match(/[^\x00-\x7F]/)?Bu(e):e}function N3(e,r,t,n){return n?(t.type="string",Hm.to_workbook(e,t)):Hm.to_workbook(r,t)}function qS(e,r){e_();var t=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return qS(new Uint8Array(e),(t=Os(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],o=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Lm={},t.dateNF&&(Lm.dateNF=t.dateNF),t.type||(t.type=ma&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=ma?"buffer":"binary",n=GK(e),typeof Uint8Array<"u"&&!ma&&(t.type="array")),t.type=="string"&&(o=!0,t.type="binary",t.codepage=65001,n=Qse(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),c=new Uint8Array(i);if(c.foo="bar",!c.foo)return t=Os(t),t.type="array",qS(t_(n),t)}switch((s=I_(n,t))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return Xse(An.read(n,t),t);break;case 9:if(s[1]<=8)return cE(n,t);break;case 60:return HS(n,t);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return aJ(n,t);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return k9.to_workbook(n,t);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?Yse(n,t):N3(e,n,t,o);case 239:return s[3]===60?HS(n,t):N3(e,n,t,o);case 255:if(s[1]===254)return Jse(n,t);if(s[1]===0&&s[2]===2&&s[3]===0)return N0.to_workbook(n,t);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return N0.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return US.to_workbook(n,t);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return D9.to_workbook(n,t);break;case 10:case 13:case 32:return Zse(n,t);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return nJ.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?US.to_workbook(n,t):N3(e,n,t,o)}function xE(e,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return ux(r.file,An.write(e,{type:ma?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return An.write(e,r)}function eie(e,r){var t=Os(r||{}),n=qse(e,t);return tie(n,t)}function tie(e,r){var t={},n=ma?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(t.compression="DEFLATE"),r.password)t.type=n;else switch(r.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+r.type)}var s=e.FullPaths?An.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!r.compression}):e.generate(t);if(typeof Deno<"u"&&typeof s=="string"){if(r.type=="binary"||r.type=="base64")return s;s=new Uint8Array(Mw(s))}return r.password&&typeof encrypt_agile<"u"?xE(encrypt_agile(s,r.password),r):r.type==="file"?ux(r.file,s):r.type=="string"?hs(s):s}function rie(e,r){var t=r||{},n=Qae(e,t);return xE(n,t)}function Du(e,r,t){t||(t="");var n=t+e;switch(r.type){case"base64":return Ov(Bu(n));case"binary":return Bu(n);case"string":return e;case"file":return ux(r.file,n,"utf8");case"buffer":return ma?zd(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Du(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function nie(e,r){switch(r.type){case"base64":return Ov(e);case"binary":return e;case"string":return e;case"file":return ux(r.file,e,"binary");case"buffer":return ma?zd(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function Oy(e,r){switch(r.type){case"string":case"base64":case"binary":for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return r.type=="base64"?Ov(t):r.type=="string"?hs(t):t;case"file":return ux(r.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+r.type)}}function bE(e,r){e_(),Xne(e);var t=Os(r||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=bE(e,t);return t.type="array",Mw(n)}var s=0;if(t.sheet&&(typeof t.sheet=="number"?s=t.sheet:s=e.SheetNames.indexOf(t.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Du(qae(e,t),t);case"slk":case"sylk":return Du(j9.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"htm":case"html":return Du(dE(e.Sheets[e.SheetNames[s]],t),t);case"txt":return nie(yE(e.Sheets[e.SheetNames[s]],t),t);case"csv":return Du(O_(e.Sheets[e.SheetNames[s]],t),t,"\uFEFF");case"dif":return Du(k9.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"dbf":return Oy(US.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"prn":return Du(Hm.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"rtf":return Du(D9.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"eth":return Du(R9.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"fods":return Du(mE(e,t),t);case"wk1":return Oy(N0.sheet_to_wk1(e.Sheets[e.SheetNames[s]],t),t);case"wk3":return Oy(N0.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Oy(uE(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),rie(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return eie(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function aie(e){if(!e.bookType){var r={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType=r[e.bookType]||e.bookType}}function xx(e,r,t){var n={};return n.type="file",n.file=r,aie(n),bE(e,n)}function sie(e,r,t,n,s,o,i,c){var u=bi(t),l=c.defval,d=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),h=!0,f=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:t,enumerable:!1})}catch{f.__rowNum__=t}else f.__rowNum__=t;if(!i||e[t])for(var p=r.s.c;p<=r.e.c;++p){var v=i?e[t][p]:e[n[p]+u];if(v===void 0||v.t===void 0){if(l===void 0)continue;o[p]!=null&&(f[o[p]]=l);continue}var g=v.v;switch(v.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(o[p]!=null){if(g==null)if(v.t=="e"&&g===null)f[o[p]]=null;else if(l!==void 0)f[o[p]]=l;else if(d&&g===null)f[o[p]]=null;else continue;else f[o[p]]=d&&(v.t!=="n"||v.t==="n"&&c.rawNumbers!==!1)?g:Fd(v,g,c);g!=null&&(h=!1)}}return{row:f,isempty:h}}function F2(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,s=1,o=[],i=0,c="",u={s:{r:0,c:0},e:{r:0,c:0}},l=r||{},d=l.range!=null?l.range:e["!ref"];switch(l.header===1?n=1:l.header==="A"?n=2:Array.isArray(l.header)?n=3:l.header==null&&(n=0),typeof d){case"string":u=Ba(d);break;case"number":u=Ba(e["!ref"]),u.s.r=d;break;default:u=d}n>0&&(s=0);var h=bi(u.s.r),f=[],p=[],v=0,g=0,m=Array.isArray(e),b=u.s.r,y=0,S={};m&&!e[b]&&(e[b]=[]);var C=l.skipHidden&&e["!cols"]||[],L=l.skipHidden&&e["!rows"]||[];for(y=u.s.c;y<=u.e.c;++y)if(!(C[y]||{}).hidden)switch(f[y]=qs(y),t=m?e[b][y]:e[f[y]+h],n){case 1:o[y]=y-u.s.c;break;case 2:o[y]=f[y];break;case 3:o[y]=l.header[y-u.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),c=i=Fd(t,null,l),g=S[i]||0,!g)S[i]=1;else{do c=i+"_"+g++;while(S[c]);S[i]=g,S[c]=1}o[y]=c}for(b=u.s.r+s;b<=u.e.r;++b)if(!(L[b]||{}).hidden){var O=sie(e,u,b,f,n,o,m,l);(O.isempty===!1||(n===1?l.blankrows!==!1:l.blankrows))&&(p[v++]=O.row)}return p.length=v,p}var UC=/"/g;function iie(e,r,t,n,s,o,i,c){for(var u=!0,l=[],d="",h=bi(t),f=r.s.c;f<=r.e.c;++f)if(n[f]){var p=c.dense?(e[t]||[])[f]:e[n[f]+h];if(p==null)d="";else if(p.v!=null){u=!1,d=""+(c.rawNumbers&&p.t=="n"?p.v:Fd(p,null,c));for(var v=0,g=0;v!==d.length;++v)if((g=d.charCodeAt(v))===s||g===o||g===34||c.forceQuotes){d='"'+d.replace(UC,'""')+'"';break}d=="ID"&&(d='"ID"')}else p.f!=null&&!p.F?(u=!1,d="="+p.f,d.indexOf(",")>=0&&(d='"'+d.replace(UC,'""')+'"')):d="";l.push(d)}return c.blankrows===!1&&u?null:l.join(i)}function O_(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";var s=Ba(e["!ref"]),o=n.FS!==void 0?n.FS:",",i=o.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,u=c.charCodeAt(0),l=new RegExp((o=="|"?"\\|":o)+"+$"),d="",h=[];n.dense=Array.isArray(e);for(var f=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],v=s.s.c;v<=s.e.c;++v)(f[v]||{}).hidden||(h[v]=qs(v));for(var g=0,m=s.s.r;m<=s.e.r;++m)(p[m]||{}).hidden||(d=iie(e,s,m,h,i,u,o,n),d!=null&&(n.strip&&(d=d.replace(l,"")),(d||n.blankrows!==!1)&&t.push((g++?c:"")+d)));return delete n.dense,t.join("")}function yE(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=O_(e,r);return t}function oie(e){var r="",t,n="";if(e==null||e["!ref"]==null)return[];var s=Ba(e["!ref"]),o="",i=[],c,u=[],l=Array.isArray(e);for(c=s.s.c;c<=s.e.c;++c)i[c]=qs(c);for(var d=s.s.r;d<=s.e.r;++d)for(o=bi(d),c=s.s.c;c<=s.e.c;++c)if(r=i[c]+o,t=l?(e[d]||[])[c]:e[r],n="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;n=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}u[u.length]=r+"="+n}return u}function wE(e,r,t){var n=t||{},s=+!n.skipHeader,o=e||{},i=0,c=0;if(o&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var u=typeof n.origin=="string"?Gs(n.origin):n.origin;i=u.r,c=u.c}var l,d={s:{c:0,r:0},e:{c,r:i+r.length-1+s}};if(o["!ref"]){var h=Ba(o["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),i==-1&&(i=h.e.r+1,d.e.r=i+r.length-1+s)}else i==-1&&(i=0,d.e.r=r.length-1+s);var f=n.header||[],p=0;r.forEach(function(g,m){si(g).forEach(function(b){(p=f.indexOf(b))==-1&&(f[p=f.length]=b);var y=g[b],S="z",C="",L=Fn({c:c+p,r:i+m+s});l=Kv(o,L),y&&typeof y=="object"&&!(y instanceof Date)?o[L]=y:(typeof y=="number"?S="n":typeof y=="boolean"?S="b":typeof y=="string"?S="s":y instanceof Date?(S="d",n.cellDates||(S="n",y=Ii(y)),C=n.dateNF||On[14]):y===null&&n.nullError&&(S="e",y=0),l?(l.t=S,l.v=y,delete l.w,delete l.R,C&&(l.z=C)):o[L]=l={t:S,v:y},C&&(l.z=C))})}),d.e.c=Math.max(d.e.c,c+f.length-1);var v=bi(i);if(s)for(p=0;p<f.length;++p)o[qs(p+c)+v]={t:"s",v:f[p]};return o["!ref"]=Jn(d),o}function lie(e,r){return wE(null,e,r)}function Kv(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var n=Gs(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Kv(e,Fn(r)):Kv(e,Fn({r,c:t||0}))}function cie(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function P_(){return{SheetNames:[],Sheets:{}}}function F_(e,r,t,n){var s=1;if(!t)for(;s<=65535&&e.SheetNames.indexOf(t="Sheet"+s)!=-1;++s,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0){var o=t.match(/(^.*?)(\d+)$/);s=o&&+o[2]||0;var i=o&&o[1]||t;for(++s;s<=65535&&e.SheetNames.indexOf(t=i+s)!=-1;++s);}if(aE(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function uie(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=cie(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function die(e,r){return e.z=r,e}function SE(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function fie(e,r,t){return SE(e,"#"+r,t)}function hie(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function pie(e,r,t,n){for(var s=typeof r!="string"?r:Ba(r),o=typeof r=="string"?r:Jn(r),i=s.s.r;i<=s.e.r;++i)for(var c=s.s.c;c<=s.e.c;++c){var u=Kv(e,i,c);u.t="n",u.F=o,delete u.v,i==s.s.r&&c==s.s.c&&(u.f=t,n&&(u.D=!0))}return e}var Wi={encode_col:qs,encode_row:bi,encode_cell:Fn,encode_range:Jn,decode_col:h_,decode_row:f_,split_cell:CX,decode_cell:Gs,decode_range:vl,format_cell:Fd,sheet_add_aoa:XR,sheet_add_json:wE,sheet_add_dom:fE,aoa_to_sheet:rg,json_to_sheet:lie,table_to_sheet:hE,table_to_book:wse,sheet_to_csv:O_,sheet_to_txt:yE,sheet_to_json:F2,sheet_to_html:dE,sheet_to_formulae:oie,sheet_to_row_object_array:F2,sheet_get_cell:Kv,book_new:P_,book_append_sheet:F_,book_set_sheet_visibility:uie,cell_set_number_format:die,cell_set_hyperlink:SE,cell_set_internal_link:fie,cell_add_comment:hie,sheet_set_array_formula:pie,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},T3,HC;function _E(){if(HC)return T3;HC=1;function e(r){var t=typeof r;return r!=null&&(t=="object"||t=="function")}return T3=e,T3}var L3,VC;function mie(){if(VC)return L3;VC=1;var e=typeof Kn=="object"&&Kn&&Kn.Object===Object&&Kn;return L3=e,L3}var M3,WC;function AE(){if(WC)return M3;WC=1;var e=mie(),r=typeof self=="object"&&self&&self.Object===Object&&self,t=e||r||Function("return this")();return M3=t,M3}var D3,qC;function gie(){if(qC)return D3;qC=1;var e=AE(),r=function(){return e.Date.now()};return D3=r,D3}var I3,GC;function vie(){if(GC)return I3;GC=1;var e=/\s/;function r(t){for(var n=t.length;n--&&e.test(t.charAt(n)););return n}return I3=r,I3}var O3,KC;function xie(){if(KC)return O3;KC=1;var e=vie(),r=/^\s+/;function t(n){return n&&n.slice(0,e(n)+1).replace(r,"")}return O3=t,O3}var P3,XC;function CE(){if(XC)return P3;XC=1;var e=AE(),r=e.Symbol;return P3=r,P3}var F3,YC;function bie(){if(YC)return F3;YC=1;var e=CE(),r=Object.prototype,t=r.hasOwnProperty,n=r.toString,s=e?e.toStringTag:void 0;function o(i){var c=t.call(i,s),u=i[s];try{i[s]=void 0;var l=!0}catch{}var d=n.call(i);return l&&(c?i[s]=u:delete i[s]),d}return F3=o,F3}var B3,ZC;function yie(){if(ZC)return B3;ZC=1;var e=Object.prototype,r=e.toString;function t(n){return r.call(n)}return B3=t,B3}var z3,JC;function wie(){if(JC)return z3;JC=1;var e=CE(),r=bie(),t=yie(),n="[object Null]",s="[object Undefined]",o=e?e.toStringTag:void 0;function i(c){return c==null?c===void 0?s:n:o&&o in Object(c)?r(c):t(c)}return z3=i,z3}var $3,QC;function Sie(){if(QC)return $3;QC=1;function e(r){return r!=null&&typeof r=="object"}return $3=e,$3}var U3,ej;function _ie(){if(ej)return U3;ej=1;var e=wie(),r=Sie(),t="[object Symbol]";function n(s){return typeof s=="symbol"||r(s)&&e(s)==t}return U3=n,U3}var H3,tj;function Aie(){if(tj)return H3;tj=1;var e=xie(),r=_E(),t=_ie(),n=NaN,s=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,i=/^0o[0-7]+$/i,c=parseInt;function u(l){if(typeof l=="number")return l;if(t(l))return n;if(r(l)){var d=typeof l.valueOf=="function"?l.valueOf():l;l=r(d)?d+"":d}if(typeof l!="string")return l===0?l:+l;l=e(l);var h=o.test(l);return h||i.test(l)?c(l.slice(2),h?2:8):s.test(l)?n:+l}return H3=u,H3}var V3,rj;function Cie(){if(rj)return V3;rj=1;var e=_E(),r=gie(),t=Aie(),n="Expected a function",s=Math.max,o=Math.min;function i(c,u,l){var d,h,f,p,v,g,m=0,b=!1,y=!1,S=!0;if(typeof c!="function")throw new TypeError(n);u=t(u)||0,e(l)&&(b=!!l.leading,y="maxWait"in l,f=y?s(t(l.maxWait)||0,u):f,S="trailing"in l?!!l.trailing:S);function C(I){var U=d,k=h;return d=h=void 0,m=I,p=c.apply(k,U),p}function L(I){return m=I,v=setTimeout(z,u),b?C(I):p}function O(I){var U=I-g,k=I-m,_=u-U;return y?o(_,f-k):_}function H(I){var U=I-g,k=I-m;return g===void 0||U>=u||U<0||y&&k>=f}function z(){var I=r();if(H(I))return q(I);v=setTimeout(z,O(I))}function q(I){return v=void 0,S&&d?C(I):(d=h=void 0,p)}function D(){v!==void 0&&clearTimeout(v),m=0,d=g=h=v=void 0}function W(){return v===void 0?p:q(r())}function P(){var I=r(),U=H(I);if(d=arguments,h=this,g=I,U){if(v===void 0)return L(g);if(y)return clearTimeout(v),v=setTimeout(z,u),C(g)}return v===void 0&&(v=setTimeout(z,u)),p}return P.cancel=D,P.flush=W,P}return V3=i,V3}var jie=Cie();const ll=Xv(jie),GS=[{name:"RAL 1000 - Green beige",value:"RAL 1000",hex:"#CDBA88"},{name:"RAL 1001 - Beige",value:"RAL 1001",hex:"#D0B084"},{name:"RAL 1002 - Sand yellow",value:"RAL 1002",hex:"#D2AA6D"},{name:"RAL 1003 - Signal yellow",value:"RAL 1003",hex:"#F9A900"},{name:"RAL 1004 - Golden yellow",value:"RAL 1004",hex:"#E49E00"},{name:"RAL 1005 - Honey yellow",value:"RAL 1005",hex:"#CB8F00"},{name:"RAL 1006 - Maize yellow",value:"RAL 1006",hex:"#E19000"},{name:"RAL 1007 - Daffodil yellow",value:"RAL 1007",hex:"#E88C00"},{name:"RAL 1011 - Brown beige",value:"RAL 1011",hex:"#AF8050"},{name:"RAL 1012 - Lemon yellow",value:"RAL 1012",hex:"#DDAF28"},{name:"RAL 1013 - Oyster white",value:"RAL 1013",hex:"#E3D9C7"},{name:"RAL 1014 - Ivory",value:"RAL 1014",hex:"#DDC49B"},{name:"RAL 1015 - Light ivory",value:"RAL 1015",hex:"#E6D2B5"},{name:"RAL 1016 - Sulfur yellow",value:"RAL 1016",hex:"#F1DD39"},{name:"RAL 1017 - Saffron yellow",value:"RAL 1017",hex:"#F6A951"},{name:"RAL 1018 - Zinc yellow",value:"RAL 1018",hex:"#FACA31"},{name:"RAL 1019 - Grey beige",value:"RAL 1019",hex:"#A48F7A"},{name:"RAL 1020 - Olive yellow",value:"RAL 1020",hex:"#A08F65"},{name:"RAL 1021 - Colza yellow",value:"RAL 1021",hex:"#F6B600"},{name:"RAL 1023 - Traffic yellow",value:"RAL 1023",hex:"#F7B500"},{name:"RAL 1024 - Ochre yellow",value:"RAL 1024",hex:"#BA8F4C"},{name:"RAL 1026 - Luminous yellow",value:"RAL 1026",hex:"#FFFF00"},{name:"RAL 1027 - Curry",value:"RAL 1027",hex:"#A77F0F"},{name:"RAL 1028 - Melon yellow",value:"RAL 1028",hex:"#FF9C00"},{name:"RAL 1032 - Broom yellow",value:"RAL 1032",hex:"#E2A300"},{name:"RAL 1033 - Dahlia yellow",value:"RAL 1033",hex:"#F99A1D"},{name:"RAL 1034 - Pastel yellow",value:"RAL 1034",hex:"#EB9C52"},{name:"RAL 1035 - Pearl beige",value:"RAL 1035",hex:"#8F8370"},{name:"RAL 1036 - Pearl gold",value:"RAL 1036",hex:"#806440"},{name:"RAL 1037 - Sun yellow",value:"RAL 1037",hex:"#F09200"},{name:"RAL 2000 - Yellow orange",value:"RAL 2000",hex:"#DA6E00"},{name:"RAL 2001 - Red orange",value:"RAL 2001",hex:"#BA481C"},{name:"RAL 2002 - Vermilion",value:"RAL 2002",hex:"#BF3922"},{name:"RAL 2003 - Pastel orange",value:"RAL 2003",hex:"#F67829"},{name:"RAL 2004 - Pure orange",value:"RAL 2004",hex:"#E25304"},{name:"RAL 2005 - Luminous orange",value:"RAL 2005",hex:"#FF4D08"},{name:"RAL 2007 - Luminous bright orange",value:"RAL 2007",hex:"#FFB200"},{name:"RAL 2008 - Bright red orange",value:"RAL 2008",hex:"#EC6B22"},{name:"RAL 2009 - Traffic orange",value:"RAL 2009",hex:"#DE5308"},{name:"RAL 2010 - Signal orange",value:"RAL 2010",hex:"#D05D29"},{name:"RAL 2011 - Deep orange",value:"RAL 2011",hex:"#E26E0F"},{name:"RAL 2012 - Salmon orange",value:"RAL 2012",hex:"#D5654E"},{name:"RAL 2013 - Pearl orange",value:"RAL 2013",hex:"#923E25"},{name:"RAL 2017 - RAL orange",value:"RAL 2017",hex:"#FC5500"},{name:"RAL 3000 - Flame red",value:"RAL 3000",hex:"#A72920"},{name:"RAL 3001 - Signal red",value:"RAL 3001",hex:"#9B2423"},{name:"RAL 3002 - Carmine red",value:"RAL 3002",hex:"#9B2321"},{name:"RAL 3003 - Ruby red",value:"RAL 3003",hex:"#861A22"},{name:"RAL 3004 - Purple red",value:"RAL 3004",hex:"#6B1C23"},{name:"RAL 3005 - Wine red",value:"RAL 3005",hex:"#59191F"},{name:"RAL 3007 - Black red",value:"RAL 3007",hex:"#3E2022"},{name:"RAL 3009 - Oxide red",value:"RAL 3009",hex:"#6D342D"},{name:"RAL 3011 - Brown red",value:"RAL 3011",hex:"#782423"},{name:"RAL 3012 - Beige red",value:"RAL 3012",hex:"#C5856D"},{name:"RAL 3013 - Tomato red",value:"RAL 3013",hex:"#972E25"},{name:"RAL 3014 - Antique pink",value:"RAL 3014",hex:"#CB7375"},{name:"RAL 3015 - Light pink",value:"RAL 3015",hex:"#D8A0A6"},{name:"RAL 3016 - Coral red",value:"RAL 3016",hex:"#A63D30"},{name:"RAL 3017 - Rose",value:"RAL 3017",hex:"#CA555D"},{name:"RAL 3018 - Strawberry red",value:"RAL 3018",hex:"#C63F4A"},{name:"RAL 3020 - Traffic red",value:"RAL 3020",hex:"#BB1F11"},{name:"RAL 3022 - Salmon pink",value:"RAL 3022",hex:"#CF6955"},{name:"RAL 3024 - Luminous red",value:"RAL 3024",hex:"#FF2D21"},{name:"RAL 3026 - Luminous bright red",value:"RAL 3026",hex:"#FF2A1C"},{name:"RAL 3027 - Raspberry red",value:"RAL 3027",hex:"#AB273C"},{name:"RAL 3028 - Pure red",value:"RAL 3028",hex:"#CC2C24"},{name:"RAL 3031 - Orient red",value:"RAL 3031",hex:"#A63437"},{name:"RAL 3032 - Pearl ruby red",value:"RAL 3032",hex:"#701D24"},{name:"RAL 3033 - Pearl pink",value:"RAL 3033",hex:"#A53A2E"},{name:"RAL 4001 - Red lilac",value:"RAL 4001",hex:"#816183"},{name:"RAL 4002 - Red violet",value:"RAL 4002",hex:"#8D3C4B"},{name:"RAL 4003 - Heather violet",value:"RAL 4003",hex:"#C4618C"},{name:"RAL 4004 - Claret violet",value:"RAL 4004",hex:"#651E38"},{name:"RAL 4005 - Blue lilac",value:"RAL 4005",hex:"#76689A"},{name:"RAL 4006 - Traffic purple",value:"RAL 4006",hex:"#903373"},{name:"RAL 4007 - Purple violet",value:"RAL 4007",hex:"#47243C"},{name:"RAL 4008 - Signal violet",value:"RAL 4008",hex:"#844C82"},{name:"RAL 4009 - Pastel violet",value:"RAL 4009",hex:"#9D8692"},{name:"RAL 4010 - Telemagenta",value:"RAL 4010",hex:"#BB4077"},{name:"RAL 4011 - Pearl violet",value:"RAL 4011",hex:"#6E6387"},{name:"RAL 4012 - Pearl blackberry",value:"RAL 4012",hex:"#6A6B7F"},{name:"RAL 5000 - Violet blue",value:"RAL 5000",hex:"#304F6E"},{name:"RAL 5001 - Green blue",value:"RAL 5001",hex:"#0E4C64"},{name:"RAL 5002 - Ultramarine blue",value:"RAL 5002",hex:"#00387A"},{name:"RAL 5003 - Sapphire blue",value:"RAL 5003",hex:"#1F3855"},{name:"RAL 5004 - Black blue",value:"RAL 5004",hex:"#191E28"},{name:"RAL 5005 - Signal blue",value:"RAL 5005",hex:"#005387"},{name:"RAL 5007 - Brillant blue",value:"RAL 5007",hex:"#376B8C"},{name:"RAL 5008 - Grey blue",value:"RAL 5008",hex:"#2B3A44"},{name:"RAL 5009 - Azure blue",value:"RAL 5009",hex:"#215F78"},{name:"RAL 5010 - Gentian blue",value:"RAL 5010",hex:"#004F7C"},{name:"RAL 5011 - Steel blue",value:"RAL 5011",hex:"#1A2B3C"},{name:"RAL 5012 - Light blue",value:"RAL 5012",hex:"#0089B6"},{name:"RAL 5013 - Cobalt blue",value:"RAL 5013",hex:"#193153"},{name:"RAL 5014 - Pigeon blue",value:"RAL 5014",hex:"#637D96"},{name:"RAL 5015 - Sky blue",value:"RAL 5015",hex:"#007CAF"},{name:"RAL 5017 - Traffic blue",value:"RAL 5017",hex:"#005B8C"},{name:"RAL 5018 - Turquoise blue",value:"RAL 5018",hex:"#048B8C"},{name:"RAL 5019 - Capri blue",value:"RAL 5019",hex:"#005E83"},{name:"RAL 5020 - Ocean blue",value:"RAL 5020",hex:"#00414B"},{name:"RAL 5021 - Water blue",value:"RAL 5021",hex:"#007577"},{name:"RAL 5022 - Night blue",value:"RAL 5022",hex:"#222D5A"},{name:"RAL 5023 - Distant blue",value:"RAL 5023",hex:"#41698C"},{name:"RAL 5024 - Pastel blue",value:"RAL 5024",hex:"#6093AC"},{name:"RAL 5025 - Pearl gentian blue",value:"RAL 5025",hex:"#20697C"},{name:"RAL 5026 - Pearl night blue",value:"RAL 5026",hex:"#0F3052"},{name:"RAL 6000 - Patina green",value:"RAL 6000",hex:"#3C7460"},{name:"RAL 6001 - Emerald green",value:"RAL 6001",hex:"#366735"},{name:"RAL 6002 - Leaf green",value:"RAL 6002",hex:"#325928"},{name:"RAL 6003 - Olive green",value:"RAL 6003",hex:"#50533C"},{name:"RAL 6004 - Blue green",value:"RAL 6004",hex:"#024442"},{name:"RAL 6005 - Moss green",value:"RAL 6005",hex:"#114232"},{name:"RAL 6006 - Grey olive",value:"RAL 6006",hex:"#3C392E"},{name:"RAL 6007 - Bottle green",value:"RAL 6007",hex:"#2C3222"},{name:"RAL 6008 - Brown green",value:"RAL 6008",hex:"#36342A"},{name:"RAL 6009 - Fir green",value:"RAL 6009",hex:"#27352A"},{name:"RAL 6010 - Grass green",value:"RAL 6010",hex:"#4D6F39"},{name:"RAL 6011 - Reseda green",value:"RAL 6011",hex:"#6B7C59"},{name:"RAL 6012 - Black green",value:"RAL 6012",hex:"#2F3D3A"},{name:"RAL 6013 - Reed green",value:"RAL 6013",hex:"#7C765A"},{name:"RAL 6014 - Yellow olive",value:"RAL 6014",hex:"#474135"},{name:"RAL 6015 - Black olive",value:"RAL 6015",hex:"#3D3D36"},{name:"RAL 6016 - Turquoise green",value:"RAL 6016",hex:"#00694C"},{name:"RAL 6017 - May green",value:"RAL 6017",hex:"#587F40"},{name:"RAL 6018 - Yellow green",value:"RAL 6018",hex:"#60993B"},{name:"RAL 6019 - Pastel green",value:"RAL 6019",hex:"#B9CEAC"},{name:"RAL 6020 - Chrome green",value:"RAL 6020",hex:"#37422F"},{name:"RAL 6021 - Pale green",value:"RAL 6021",hex:"#8A9977"},{name:"RAL 6022 - Olive drab",value:"RAL 6022",hex:"#3A3327"},{name:"RAL 6024 - Traffic green",value:"RAL 6024",hex:"#008351"},{name:"RAL 6025 - Fern green",value:"RAL 6025",hex:"#5E6E3B"},{name:"RAL 6026 - Opal green",value:"RAL 6026",hex:"#005F4E"},{name:"RAL 6027 - Light green",value:"RAL 6027",hex:"#7EBAB5"},{name:"RAL 6028 - Pine green",value:"RAL 6028",hex:"#315442"},{name:"RAL 6029 - Mint green",value:"RAL 6029",hex:"#006F3D"},{name:"RAL 6032 - Signal green",value:"RAL 6032",hex:"#237F52"},{name:"RAL 6033 - Mint turquoise",value:"RAL 6033",hex:"#45877F"},{name:"RAL 6034 - Pastel turquoise",value:"RAL 6034",hex:"#7AADAC"},{name:"RAL 6035 - Pearl green",value:"RAL 6035",hex:"#194D25"},{name:"RAL 6036 - Pearl opal green",value:"RAL 6036",hex:"#04574B"},{name:"RAL 6037 - Pure green",value:"RAL 6037",hex:"#008B29"},{name:"RAL 6038 - Luminous green",value:"RAL 6038",hex:"#00B51B"},{name:"RAL 6039 - Fibrous green",value:"RAL 6039",hex:"#B3C43E"},{name:"RAL 7000 - Squirrel grey",value:"RAL 7000",hex:"#7A888E"},{name:"RAL 7001 - Silver grey",value:"RAL 7001",hex:"#8C979C"},{name:"RAL 7002 - Olive grey",value:"RAL 7002",hex:"#817863"},{name:"RAL 7003 - Moss grey",value:"RAL 7003",hex:"#797669"},{name:"RAL 7004 - Signal grey",value:"RAL 7004",hex:"#9A9B9B"},{name:"RAL 7005 - Mouse grey",value:"RAL 7005",hex:"#6B6E6B"},{name:"RAL 7006 - Beige grey",value:"RAL 7006",hex:"#766A5E"},{name:"RAL 7008 - Khaki grey",value:"RAL 7008",hex:"#745F3D"},{name:"RAL 7009 - Green grey",value:"RAL 7009",hex:"#5D6058"},{name:"RAL 7010 - Tarpaulin grey",value:"RAL 7010",hex:"#585C56"},{name:"RAL 7011 - Iron grey",value:"RAL 7011",hex:"#52595D"},{name:"RAL 7012 - Basalt grey",value:"RAL 7012",hex:"#575D5E"},{name:"RAL 7013 - Brown grey",value:"RAL 7013",hex:"#575044"},{name:"RAL 7015 - Slate grey",value:"RAL 7015",hex:"#4F5358"},{name:"RAL 7016 - Anthracite grey",value:"RAL 7016",hex:"#383E42"},{name:"RAL 7021 - Black grey",value:"RAL 7021",hex:"#2F3234"},{name:"RAL 7022 - Umbra grey",value:"RAL 7022",hex:"#4C4A44"},{name:"RAL 7023 - Concrete grey",value:"RAL 7023",hex:"#808076"},{name:"RAL 7024 - Graphite grey",value:"RAL 7024",hex:"#45494E"},{name:"RAL 7026 - Granite grey",value:"RAL 7026",hex:"#374345"},{name:"RAL 7030 - Stone grey",value:"RAL 7030",hex:"#928E85"},{name:"RAL 7031 - Blue grey",value:"RAL 7031",hex:"#5B686D"},{name:"RAL 7032 - Pebble grey",value:"RAL 7032",hex:"#B5B0A1"},{name:"RAL 7033 - Cement grey",value:"RAL 7033",hex:"#7F8274"},{name:"RAL 7034 - Yellow grey",value:"RAL 7034",hex:"#92886F"},{name:"RAL 7035 - Light grey",value:"RAL 7035",hex:"#C5C7C4"},{name:"RAL 7036 - Platinum grey",value:"RAL 7036",hex:"#979392"},{name:"RAL 7037 - Dusty grey",value:"RAL 7037",hex:"#7A7B7A"},{name:"RAL 7038 - Agate grey",value:"RAL 7038",hex:"#B0B0A9"},{name:"RAL 7039 - Quartz grey",value:"RAL 7039",hex:"#6B665E"},{name:"RAL 7040 - Window grey",value:"RAL 7040",hex:"#989EA1"},{name:"RAL 7042 - Traffic grey A",value:"RAL 7042",hex:"#8E9291"},{name:"RAL 7043 - Traffic grey B",value:"RAL 7043",hex:"#4F5250"},{name:"RAL 7044 - Silk grey",value:"RAL 7044",hex:"#B7B3A8"},{name:"RAL 7045 - Telegrey 1",value:"RAL 7045",hex:"#8D9295"},{name:"RAL 7046 - Telegrey 2",value:"RAL 7046",hex:"#7E868A"},{name:"RAL 7047 - Telegrey 4",value:"RAL 7047",hex:"#C8C8C7"},{name:"RAL 7048 - Pearl mouse grey",value:"RAL 7048",hex:"#817B73"},{name:"RAL 8000 - Green brown",value:"RAL 8000",hex:"#89693F"},{name:"RAL 8001 - Ochre brown",value:"RAL 8001",hex:"#9D622B"},{name:"RAL 8002 - Signal brown",value:"RAL 8002",hex:"#794D3E"},{name:"RAL 8003 - Clay brown",value:"RAL 8003",hex:"#7E4B27"},{name:"RAL 8004 - Copper brown",value:"RAL 8004",hex:"#8D4931"},{name:"RAL 8007 - Fawn brown",value:"RAL 8007",hex:"#70462B"},{name:"RAL 8008 - Olive brown",value:"RAL 8008",hex:"#724A25"},{name:"RAL 8011 - Nut brown",value:"RAL 8011",hex:"#5A3827"},{name:"RAL 8012 - Red brown",value:"RAL 8012",hex:"#66332B"},{name:"RAL 8014 - Sepia brown",value:"RAL 8014",hex:"#4A3526"},{name:"RAL 8015 - Chestnut brown",value:"RAL 8015",hex:"#5E2F26"},{name:"RAL 8016 - Mahogany brown",value:"RAL 8016",hex:"#4C2B20"},{name:"RAL 8017 - Chocolate brown",value:"RAL 8017",hex:"#442F29"},{name:"RAL 8019 - Grey brown",value:"RAL 8019",hex:"#3D3635"},{name:"RAL 8022 - Black brown",value:"RAL 8022",hex:"#1A1719"},{name:"RAL 8023 - Orange brown",value:"RAL 8023",hex:"#A45729"},{name:"RAL 8024 - Beige brown",value:"RAL 8024",hex:"#795038"},{name:"RAL 8025 - Pale brown",value:"RAL 8025",hex:"#755847"},{name:"RAL 8028 - Terra brown",value:"RAL 8028",hex:"#513A2A"},{name:"RAL 8029 - Pearl copper",value:"RAL 8029",hex:"#7F4031"},{name:"RAL 9001 - Cream",value:"RAL 9001",hex:"#E9E0D2"},{name:"RAL 9002 - Grey white",value:"RAL 9002",hex:"#D6D5CB"},{name:"RAL 9003 - Signal white",value:"RAL 9003",hex:"#ECECE7"},{name:"RAL 9004 - Signal black",value:"RAL 9004",hex:"#2B2B2C"},{name:"RAL 9005 - Jet black",value:"RAL 9005",hex:"#0E0E10"},{name:"RAL 9006 - White aluminium",value:"RAL 9006",hex:"#A1A1A0"},{name:"RAL 9007 - Grey aluminium",value:"RAL 9007",hex:"#868581"},{name:"RAL 9010 - Pure white",value:"RAL 9010",hex:"#F1EDE1"},{name:"RAL 9011 - Graphite black",value:"RAL 9011",hex:"#27292B"},{name:"RAL 9012 - Cleanroom white",value:"RAL 9012",hex:"#F8F2E1"},{name:"RAL 9016 - Traffic white",value:"RAL 9016",hex:"#F1F1EA"},{name:"RAL 9017 - Traffic black",value:"RAL 9017",hex:"#29292A"},{name:"RAL 9018 - Papyrus white",value:"RAL 9018",hex:"#C8CBC4"},{name:"RAL 9022 - Pearl light grey",value:"RAL 9022",hex:"#858583"},{name:"RAL 9023 - Pearl dark grey",value:"RAL 9023",hex:"#787B7A"}],t2=e=>{if(!e||typeof e!="string")return null;const r=e.trim();if(!r)return null;const t=r.toLowerCase();if(t.startsWith("http://")||t.startsWith("https://")||t.startsWith("data:"))return r;const n=r.replace(/\\/g,"/");return n.startsWith("uploads/")?`${Je}/${n}`:`${Je}/uploads/${n}`},nj=e=>e&&GS.find(t=>t.value===e)||null,kie=e=>{if(!e||!Array.isArray(e.Variants)||e.Variants.length===0)return null;for(const r of e.Variants){const t=r==null?void 0:r.MainImageIndex,n=Array.isArray(r==null?void 0:r.Images)?r.Images:[];if(t!=null&&Number.isInteger(t)&&t>=0&&t<n.length){const s=t2(n[t]);if(s)return s}}for(const r of e.Variants){const t=r==null?void 0:r.MainImage,n=t2(t);if(n)return n}for(const r of e.Variants){const t=Array.isArray(r==null?void 0:r.Images)?r.Images:[];if(t.length>0){const n=t2(t[0]);if(n)return n}}return null},Rie=G.memo(function({columns:r,setColumns:t,anchorEl:n,open:s,onClose:o}){const i=d=>{if(d.target.checked){const h=Object.keys(r).reduce((f,p)=>(f[p]=!0,f),{});t(h)}else{const h=Object.keys(r).reduce((f,p)=>(f[p]=!1,f),{});h.name=!0,h.actions=!0,t(h)}},c=d=>h=>{const f=Object.values(r).filter(Boolean).length;!h.target.checked&&f<=1&&r[d]||t({...r,[d]:h.target.checked})},u=Object.values(r).every(Boolean),l=Object.values(r).some(Boolean)&&!u;return a.jsx(A6,{open:s,anchorEl:n,onClose:o,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},PaperProps:{sx:{boxShadow:"0 6px 20px rgba(0,0,0,0.12)",borderRadius:1}},children:a.jsxs(Ut,{className:"display-preferences-popover",sx:{p:2,width:900,maxWidth:"95vw"},children:[a.jsx(Et,{variant:"subtitle1",gutterBottom:!0,children:"Display Columns"}),a.jsxs(IU,{sx:{display:"grid",gridTemplateColumns:"repeat(6, minmax(110px, 1fr))",gap:1,alignItems:"center"},children:[a.jsx(Ut,{className:"select-all",sx:{gridColumn:"1 / -1"},children:a.jsx(As,{control:a.jsx(Wn,{size:"small",checked:u,indeterminate:l,onChange:i,color:"primary"}),label:"Select All"})}),a.jsx(As,{control:a.jsx(Wn,{size:"small",checked:r.name,onChange:c("name"),color:"primary"}),label:"Name"}),a.jsx(As,{control:a.jsx(Wn,{size:"small",checked:r.code,onChange:c("code"),color:"primary"}),label:"Code"}),a.jsx(As,{control:a.jsx(Wn,{size:"small",checked:r.category,onChange:c("category"),color:"primary"}),label:"Category"}),a.jsx(As,{control:a.jsx(Wn,{size:"small",checked:r.subcategory,onChange:c("subcategory"),color:"primary"}),label:"Subcategory"}),a.jsx(As,{control:a.jsx(Wn,{size:"small",checked:r.store,onChange:c("store"),color:"primary"}),label:"Store"}),a.jsx(As,{control:a.jsx(Wn,{size:"small",checked:r.productType,onChange:c("productType"),color:"primary"}),label:"Product Type"}),a.jsx(As,{control:a.jsx(Wn,{size:"small",checked:r.productMode,onChange:c("productMode"),color:"primary"}),label:"Product Mode"}),a.jsx(As,{control:a.jsx(Wn,{size:"small",checked:r.stock,onChange:c("stock"),color:"primary"}),label:"Stock"}),a.jsx(As,{control:a.jsx(Wn,{size:"small",checked:r.minimumStock,onChange:c("minimumStock"),color:"primary"}),label:"Minimum Stock"}),a.jsx(As,{control:a.jsx(Wn,{size:"small",checked:r.moq,onChange:c("moq"),color:"primary"}),label:"MOQ"}),a.jsx(As,{control:a.jsx(Wn,{size:"small",checked:r.leadTime,onChange:c("leadTime"),color:"primary"}),label:"Lead Time"}),a.jsx(As,{control:a.jsx(Wn,{size:"small",checked:r.note,onChange:c("note"),color:"primary"}),label:"Note"}),a.jsx(As,{control:a.jsx(Wn,{size:"small",checked:r.status,onChange:c("status"),color:"primary"}),label:"Status"}),a.jsx(As,{control:a.jsx(Wn,{size:"small",checked:r.importance,onChange:c("importance"),color:"primary"}),label:"Importance"}),a.jsx(As,{control:a.jsx(Wn,{size:"small",checked:r.tag,onChange:c("tag"),color:"primary"}),label:"Tag"}),a.jsx(As,{control:a.jsx(Wn,{size:"small",checked:r.description,onChange:c("description"),color:"primary"}),label:"Description"}),a.jsx(Et,{variant:"subtitle2",sx:{gridColumn:"1 / -1",mt:2,mb:1},children:"Variant Columns"}),a.jsx(As,{control:a.jsx(Wn,{size:"small",checked:r.color,onChange:c("color"),color:"primary"}),label:"Color Code"}),a.jsx(As,{control:a.jsx(Wn,{size:"small",checked:r.size,onChange:c("size"),color:"primary"}),label:"Size"}),a.jsx(As,{control:a.jsx(Wn,{size:"small",checked:r.sku,onChange:c("sku"),color:"primary"}),label:"SKU"}),a.jsx(As,{control:a.jsx(Wn,{size:"small",checked:r.barcode,onChange:c("barcode"),color:"primary"}),label:"Barcode"}),a.jsx(As,{control:a.jsx(Wn,{size:"small",checked:r.purchaseCost,onChange:c("purchaseCost"),color:"primary"}),label:"Purchase Cost"}),a.jsx(As,{control:a.jsx(Wn,{size:"small",checked:r.salesPrice,onChange:c("salesPrice"),color:"primary"}),label:"Sales Price"}),a.jsx(As,{control:a.jsx(Wn,{size:"small",checked:r.image,onChange:c("image"),color:"primary"}),label:"Image"})]})]})})}),Eie=G.memo(function({products:r,navigate:t,loading:n,visibleColumns:s,onView:o,page:i,limit:c,selectedIds:u,onToggleOne:l,onDelete:d,exportAnchorEl:h,setExportAnchorEl:f,exportMenuOpen:p,handleExport:v,commonSearch:g}){return r?n&&r.length===0?a.jsx(fs,{children:a.jsx(pn,{children:a.jsx(qe,{colSpan:Object.values(s).filter(Boolean).length+2,align:"center",sx:{py:4},children:a.jsx(Vs,{size:28})})})}):a.jsxs(fs,{children:[r.map((m,b)=>{var y,S,C;return a.jsxs(pn,{hover:!0,sx:{cursor:"pointer"},tabIndex:0,onClick:L=>{L.target.closest("button")||L.target.closest("input")||L.target.closest("a")||o&&o(m.ID)},onKeyDown:L=>{(L.key==="Enter"||L.key===" ")&&(L.preventDefault(),o&&o(m.ID))},children:[a.jsx(qe,{sx:{py:.5},children:a.jsx(Wn,{size:"small",checked:u.includes(m.ID),onChange:()=>l(m.ID)})}),a.jsx(qe,{sx:{py:.5,width:60,whiteSpace:"nowrap"},children:i*c+b+1}),s.name&&a.jsx(qe,{sx:{py:.5,width:150,whiteSpace:"nowrap"},children:Ui(m.Name,g)}),s.code&&a.jsx(qe,{sx:{py:.5,width:150,whiteSpace:"nowrap"},children:Ui(m.Code,g)}),s.category&&a.jsx(qe,{sx:{py:.5,width:120,whiteSpace:"nowrap"},children:Ui((y=m.Category)==null?void 0:y.Name,g)}),s.subcategory&&a.jsx(qe,{sx:{py:.5,width:120,whiteSpace:"nowrap"},children:Ui(((S=m.Subcategory)==null?void 0:S.Name)||"",g)}),s.store&&a.jsx(qe,{sx:{py:.5,width:120,whiteSpace:"nowrap"},children:Ui((C=m.Store)==null?void 0:C.Name,g)}),s.productType&&a.jsx(qe,{sx:{py:.5,width:120,whiteSpace:"nowrap"},children:Ui(m.ProductType||"",g)}),s.productMode&&a.jsx(qe,{sx:{py:.5,width:120,whiteSpace:"nowrap"},children:Ui(m.ProductMode??m.product_mode??"",g)}),s.stock&&a.jsx(qe,{align:"center",sx:{py:.5,width:100,whiteSpace:"nowrap"},children:(()=>{const L=m.Stock??m.StockQuantity??m.stock??m.quantity??m.qty??"",O=m.MinimumStock??m.MinStock??m.minimum_stock??m.min_stock??0,H=L!==""&&O!==""&&Number(L)<Number(O);return a.jsx("span",{style:{color:H?"#d32f2f":"inherit",fontWeight:H?"bold":"normal"},children:L})})()}),s.minimumStock&&a.jsx(qe,{align:"center",sx:{py:.5,width:100,whiteSpace:"nowrap"},children:m.MinimumStock??m.MinStock??m.minimum_stock??m.min_stock??""}),s.moq&&a.jsx(qe,{align:"center",sx:{py:.5,width:100,whiteSpace:"nowrap"},children:m.MOQ??m.MinimumOrderQuantity??m.moq??""}),s.leadTime&&a.jsx(qe,{align:"center",sx:{py:.5,width:120,whiteSpace:"nowrap"},children:m.LeadTime??m.lead_time??m.leadtime??""}),s.note&&a.jsx(qe,{sx:{py:.5,width:150,whiteSpace:"nowrap"},children:Ui(m.Note??m.note??m.Notes??m.notes??"",g)}),s.status&&a.jsx(qe,{sx:{py:.5,width:100,whiteSpace:"nowrap"},children:Ui(m.IsActive?"Active":"Inactive",g)}),s.importance&&a.jsx(qe,{sx:{py:.5,width:100,whiteSpace:"nowrap"},children:Ui(m.Importance??"Normal",g)}),s.tag&&a.jsx(qe,{sx:{py:.5,width:120,whiteSpace:"nowrap"},children:Ui(Array.isArray(m.Tags)&&m.Tags.length>0?m.Tags.map(L=>(L==null?void 0:L.Name)||"").filter(Boolean).join(", "):"",g)}),s.description&&a.jsx(qe,{sx:{py:.5,width:150,whiteSpace:"nowrap"},children:Ui(m.Description||"",g)}),s.color&&a.jsx(qe,{sx:{py:.5,width:120,whiteSpace:"nowrap"},children:m.Variants&&m.Variants.length>0?a.jsx(Ut,{display:"flex",flexWrap:"wrap",gap:.5,alignItems:"center",children:m.Variants.map((L,O)=>{let H=GS.find(z=>z.hex.toLowerCase()===(L.Color||"").toLowerCase());return H||(H=GS.find(z=>z.value.toLowerCase()===(L.Color||"").toLowerCase())),a.jsxs(Ut,{display:"flex",alignItems:"center",gap:.5,children:[a.jsx(Ut,{sx:{width:16,height:16,borderRadius:1,border:"1px solid #ccc",backgroundColor:H?H.hex:L.Color||"#ffffff",flexShrink:0}}),a.jsx(Et,{variant:"body2",sx:{fontSize:"0.75rem"},children:Ui(H?`${H.value} - ${H.name.split(" - ")[1]}`:L.Color||"N/A",g)})]},O)})}):a.jsx(Et,{variant:"caption",color:"textSecondary",children:Ui("No colors",g)})}),s.size&&a.jsx(qe,{align:"center",sx:{py:.5,width:120,whiteSpace:"nowrap"},children:Ui(m.Variants&&m.Variants.length>0?m.Variants.map(L=>{var O;return((O=L.Size)==null?void 0:O.Name)||L.Size}).join(", "):"",g)}),s.sku&&a.jsx(qe,{sx:{py:.5,width:120,whiteSpace:"nowrap"},children:Ui(m.Variants&&m.Variants.length>0?m.Variants.map(L=>L.SKU).join(", "):"",g)}),s.barcode&&a.jsx(qe,{sx:{py:.5,width:120,whiteSpace:"nowrap"},children:Ui(m.Variants&&m.Variants.length>0?m.Variants.map(L=>L.Barcode).join(", "):"",g)}),s.purchaseCost&&a.jsx(qe,{align:"center",sx:{py:.5,width:120,whiteSpace:"nowrap"},children:m.Variants&&m.Variants.length>0?m.Variants.map(L=>`${L.PurchaseCost||0}`).join(", "):""}),s.salesPrice&&a.jsx(qe,{align:"center",sx:{py:.5,width:120,whiteSpace:"nowrap"},children:m.Variants&&m.Variants.length>0?m.Variants.map(L=>`${L.StdSalesPrice||0}`).join(", "):""}),s.image&&a.jsx(qe,{sx:{py:.5,width:120,whiteSpace:"nowrap"},children:(()=>{const L=kie(m);return L?a.jsx("a",{href:L,target:"_blank",rel:"noopener noreferrer",style:{display:"inline-block"},title:"Open image in new tab",children:a.jsx("img",{src:L,alt:`product-main-${m.ID}`,style:{width:40,height:40,objectFit:"cover",borderRadius:4,border:"1px solid #ccc",cursor:"pointer"},onMouseEnter:()=>{setHoverImageSrc(L),setHoverImageOpen(!0)},onMouseLeave:()=>{setHoverImageOpen(!1),setHoverImageSrc(null)},onError:O=>{console.error("Failed to load main product image:",{src:O.target.src,productId:m.ID}),O.target.src='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><rect width="100%" height="100%" fill="%23eee"/><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" fill="%23999" font-size="8">No Img</text></svg>'}})}):a.jsx(Et,{variant:"caption",color:"textSecondary",children:Ui("No image",g)})})()}),s.actions&&a.jsx(qe,{align:"center",sx:{py:.5,width:150,whiteSpace:"nowrap"},children:a.jsxs(Ut,{display:"flex",justifyContent:"center",alignItems:"center",gap:1,className:"action-buttons",children:[a.jsx(bs,{title:"View",children:a.jsx(sn,{size:"small",onClick:()=>o&&o(m.ID),sx:{color:"#1976d2"},children:a.jsx(cv,{fontSize:"small"})})}),a.jsx(bs,{title:"Edit",children:a.jsx(sn,{size:"small",onClick:()=>t(`/products/${m.ID}/edit`),sx:{color:"#347539ff"},children:a.jsx(bl,{fontSize:"small"})})}),a.jsx(bs,{title:"Delete",children:a.jsx(sn,{size:"small",onClick:()=>d&&d(m.ID),sx:{color:"#d32f2f"},children:a.jsx(ql,{fontSize:"small"})})})]})})]},m.ID)}),n&&r.length>0&&a.jsx(pn,{children:a.jsx(qe,{colSpan:Object.values(s).filter(Boolean).length+2,align:"center",sx:{py:1},children:a.jsx(Vs,{size:20})})}),!n&&r.length===0&&a.jsx(pn,{children:a.jsx(qe,{colSpan:Object.values(s).filter(Boolean).length+2,align:"center",sx:{py:3},children:"No products found."})})]}):a.jsx(fs,{children:a.jsx(pn,{children:a.jsx(qe,{colSpan:Object.values(s).filter(Boolean).length+2,align:"center",sx:{py:3},children:a.jsx(Et,{color:"error",children:"Error loading products"})})})})}),Nie=G.memo(function({inputFilters:r,setInputFilters:t,filters:n,setFilters:s,categories:o,allSubcategories:i,stores:c,hsnCodes:u,units:l,sizes:d,setPage:h,visibleColumns:f,handleExport:p,setImportDialogOpen:v,autocompleteOptions:g,autocompleteLoading:m,autocompleteOpen:b,setAutocompleteOpen:y,setAutocompleteOptions:S,onAutocompleteInputChange:C,stockFilter:L,setStockFilter:O,exportAnchorEl:H,setExportAnchorEl:z,exportMenuOpen:q}){return a.jsxs(pn,{children:[a.jsx(qe,{sx:{width:60}}),a.jsx(qe,{sx:{width:60}}),f.name&&a.jsx(qe,{className:"filter-cell",sx:{width:150},children:a.jsxs("div",{className:"filter-control",children:[a.jsx("input",{className:"filter-input",placeholder:"Search Name",value:r.name||"",onChange:D=>{const W=D.target.value;t(P=>({...P,name:W})),C("names",W),W===""&&(s(P=>({...P,name:""})),h(0)),W&&W.length>=1&&y(P=>({...P,names:!0}))},onFocus:()=>{y(D=>({...D,names:!0})),C("names",r.name||"")},onBlur:()=>{setTimeout(()=>y(D=>({...D,names:!1})),120)},onKeyDown:D=>{D.key==="Enter"&&(s(W=>({...W,name:D.target.value})),h(0))}}),m.names&&a.jsx("span",{className:"filter-loading",children:"Loading..."}),b.names&&g.names&&g.names.length>0&&a.jsx("div",{className:"filter-dropdown",role:"listbox",children:(g.names||[]).map((D,W)=>a.jsx("div",{className:"filter-dropdown-item",onMouseDown:P=>{P.preventDefault(),t(I=>({...I,name:D})),s(I=>({...I,name:D})),h(0),y(I=>({...I,names:!1}))},children:D},W))})]})}),f.code&&a.jsx(qe,{className:"filter-cell",sx:{width:120},children:a.jsxs("div",{className:"filter-control",children:[a.jsx("input",{className:"filter-input",placeholder:"Code",value:r.code||"",onChange:D=>{const W=D.target.value;t(P=>({...P,code:W})),C("codes",W),W===""&&(s(P=>({...P,code:""})),h(0)),W&&W.length>=1&&y(P=>({...P,codes:!0}))},onFocus:()=>{y(D=>({...D,codes:!0})),C("codes",r.code||"")},onBlur:()=>{setTimeout(()=>y(D=>({...D,codes:!1})),120)},onKeyDown:D=>{D.key==="Enter"&&(s(W=>({...W,code:D.target.value})),h(0))}}),m.codes&&a.jsx("span",{className:"filter-loading",children:"Loading..."}),b.codes&&g.codes&&g.codes.length>0&&a.jsx("div",{className:"filter-dropdown",role:"listbox",children:(g.codes||[]).map((D,W)=>a.jsx("div",{className:"filter-dropdown-item",onMouseDown:P=>{P.preventDefault(),t(I=>({...I,code:D})),s(I=>({...I,code:D})),h(0),y(I=>({...I,codes:!1}))},children:D},W))})]})}),f.category&&a.jsx(qe,{className:"filter-cell",sx:{width:120},children:a.jsxs("select",{className:"filter-select",value:n.categoryID??"",onChange:D=>{const W=D.target.value?Number(D.target.value):null;s({...n,categoryID:W,subcategoryID:null}),h(0)},children:[a.jsx("option",{value:"",children:"All"}),o.map(D=>a.jsx("option",{value:D.ID,children:D.Name},D.ID))]})}),f.subcategory&&a.jsx(qe,{className:"filter-cell",sx:{width:120},children:a.jsxs("select",{className:"filter-select",value:n.subcategoryID??"",onChange:D=>{const W=D.target.value?Number(D.target.value):null;s({...n,subcategoryID:W}),h(0)},disabled:!n.categoryID,children:[a.jsx("option",{value:"",children:"All"}),i.filter(D=>{var I;if(!n.categoryID)return!1;const W=n.categoryID.toString(),P=(I=D.CategoryID)==null?void 0:I.toString();return W===P}).map(D=>a.jsx("option",{value:D.ID,children:D.Name},D.ID))]})}),f.store&&a.jsx(qe,{className:"filter-cell",sx:{width:120},children:a.jsxs("select",{className:"filter-select",value:n.storeID??"",onChange:D=>{const W=D.target.value?Number(D.target.value):null;s({...n,storeID:W}),h(0)},children:[a.jsx("option",{value:"",children:"All"}),c.map(D=>a.jsx("option",{value:D.ID,children:D.Name},D.ID))]})}),f.productType&&a.jsx(qe,{className:"filter-cell",sx:{width:120},children:a.jsxs("select",{className:"filter-select",value:n.productType??"",onChange:D=>{s({...n,productType:D.target.value}),h(0)},children:[a.jsx("option",{value:"",children:"All"}),a.jsx("option",{value:"Finished Goods",children:"Finished Goods"}),a.jsx("option",{value:"Semi-Finished Goods",children:"Semi-Finished Goods"}),a.jsx("option",{value:"Raw Materials",children:"Raw Materials"})]})}),f.productMode&&a.jsx(qe,{className:"filter-cell",sx:{width:120},children:a.jsxs("select",{className:"filter-select",value:n.productMode??"",onChange:D=>{s({...n,productMode:D.target.value}),h(0)},children:[a.jsx("option",{value:"",children:"All"}),a.jsx("option",{value:"Purchase",children:"Purchase"}),a.jsx("option",{value:"Internal Manufacturing",children:"Internal Manufacturing"}),a.jsx("option",{value:"Both",children:"Both"})]})}),f.stock&&a.jsx(qe,{className:"filter-cell",sx:{width:160},children:a.jsxs("select",{className:"filter-select",value:L||"all",onChange:D=>{const W=D.target.value;O(W),h(0)},"aria-label":"Stock Filter",children:[a.jsx("option",{value:"all",children:"All"}),a.jsx("option",{value:"less_than_minimum_stock",children:"Less than Minimum Stock"}),a.jsx("option",{value:"greater_than_minimum_stock",children:"Minimum Stock or More"})]})}),f.minimumStock&&a.jsx(qe,{className:"filter-cell",sx:{width:120},children:a.jsx("input",{className:"filter-input",type:"number",placeholder:"Min Stock",value:r.minimumStock||"",onChange:D=>{const W=D.target.value;t(P=>({...P,minimumStock:W})),W===""&&(s(P=>({...P,minimumStock:""})),h(0))},onKeyDown:D=>{D.key==="Enter"&&(s(W=>({...W,minimumStock:D.target.value})),h(0))}})}),f.moq&&a.jsx(qe,{className:"filter-cell",sx:{width:120},children:a.jsxs("div",{className:"filter-control",children:[a.jsx("input",{className:"filter-input",placeholder:"MOQ",value:r.moq||"",onChange:D=>{const W=D.target.value;t(P=>({...P,moq:W})),W&&W.length>=1?(C("moqs",W),y(P=>({...P,moqs:!0}))):(S(P=>({...P,moqs:[]})),W===""&&(s(P=>({...P,moq:""})),h(0)))},onFocus:()=>y(D=>({...D,moqs:!0})),onBlur:()=>{setTimeout(()=>y(D=>({...D,moqs:!1})),120)},onKeyDown:D=>{D.key==="Enter"&&(s(W=>({...W,moq:D.target.value})),h(0))}}),m.moqs&&a.jsx("span",{className:"filter-loading",children:"Loading..."}),b.moqs&&g.moqs&&g.moqs.length>0&&a.jsx("div",{className:"filter-dropdown",role:"listbox",children:(g.moqs||[]).map((D,W)=>a.jsx("div",{className:"filter-dropdown-item",onMouseDown:P=>{P.preventDefault(),t(I=>({...I,moq:D})),s(I=>({...I,moq:D})),h(0),y(I=>({...I,moqs:!1}))},children:D},W))})]})}),f.leadTime&&a.jsx(qe,{className:"filter-cell",sx:{width:120},children:a.jsxs("div",{className:"filter-control",children:[a.jsx("input",{className:"filter-input",placeholder:"Lead Time",value:r.leadTime||"",onChange:D=>{const W=D.target.value;t(P=>({...P,leadTime:W})),W&&W.length>=1?(C("leadTimes",W),y(P=>({...P,leadTimes:!0}))):(S(P=>({...P,leadTimes:[]})),W===""&&(s(P=>({...P,leadTime:""})),h(0)))},onFocus:()=>y(D=>({...D,leadTimes:!0})),onBlur:()=>{setTimeout(()=>y(D=>({...D,leadTimes:!1})),120)},onKeyDown:D=>{D.key==="Enter"&&(s(W=>({...W,leadTime:D.target.value})),h(0))}}),m.leadTimes&&a.jsx("span",{className:"filter-loading",children:"Loading..."}),b.leadTimes&&g.leadTimes&&g.leadTimes.length>0&&a.jsx("div",{className:"filter-dropdown",role:"listbox",children:(g.leadTimes||[]).map((D,W)=>a.jsx("div",{className:"filter-dropdown-item",onMouseDown:P=>{P.preventDefault(),t(I=>({...I,leadTime:D})),s(I=>({...I,leadTime:D})),h(0),y(I=>({...I,leadTimes:!1}))},children:D},W))})]})}),f.note&&a.jsx(qe,{className:"filter-cell",sx:{width:120},children:a.jsxs("div",{className:"filter-control",children:[a.jsx("input",{className:"filter-input",placeholder:"Note",value:r.note||"",onChange:D=>{const W=D.target.value;t(P=>({...P,note:W})),W&&W.length>=1?(C("notes",W),y(P=>({...P,notes:!0}))):(S(P=>({...P,notes:[]})),W===""&&(s(P=>({...P,note:""})),h(0)))},onFocus:()=>y(D=>({...D,notes:!0})),onBlur:()=>{setTimeout(()=>y(D=>({...D,notes:!1})),120)},onKeyDown:D=>{D.key==="Enter"&&(s(W=>({...W,note:D.target.value})),h(0))}}),m.notes&&a.jsx("span",{className:"filter-loading",children:"Loading..."}),b.notes&&g.notes&&g.notes.length>0&&a.jsx("div",{className:"filter-dropdown",role:"listbox",children:(g.notes||[]).map((D,W)=>a.jsx("div",{className:"filter-dropdown-item",onMouseDown:P=>{P.preventDefault(),t(I=>({...I,note:D})),s(I=>({...I,note:D})),h(0),y(I=>({...I,notes:!1}))},children:D},W))})]})}),f.status&&a.jsx(qe,{className:"filter-cell",sx:{width:120},children:a.jsxs("select",{className:"filter-select",value:n.status??"",onChange:D=>{s({...n,status:D.target.value||null}),h(0)},children:[a.jsx("option",{value:"",children:"All"}),a.jsx("option",{value:"true",children:"Active"}),a.jsx("option",{value:"false",children:"Inactive"})]})}),f.importance&&a.jsx(qe,{className:"filter-cell",sx:{width:120},children:a.jsxs("select",{className:"filter-select",value:n.importance??"",onChange:D=>{s({...n,importance:D.target.value||null}),h(0)},children:[a.jsx("option",{value:"",children:"All"}),a.jsx("option",{value:"Normal",children:"Normal"}),a.jsx("option",{value:"High",children:"High"}),a.jsx("option",{value:"Critical",children:"Critical"})]})}),f.tag&&a.jsx(qe,{className:"filter-cell",sx:{width:120},children:a.jsxs("div",{className:"filter-control",children:[a.jsx("input",{className:"filter-input",placeholder:"Tag",value:r.tag||"",onChange:D=>{const W=D.target.value;t(P=>({...P,tag:W})),W&&W.length>=1?(C("tags",W),y(P=>({...P,tags:!0}))):(S(P=>({...P,tags:[]})),W===""&&(s(P=>({...P,tag:""})),h(0)))},onFocus:()=>y(D=>({...D,tags:!0})),onBlur:()=>{setTimeout(()=>y(D=>({...D,tags:!1})),120)},onKeyDown:D=>{D.key==="Enter"&&(s(W=>({...W,tag:D.target.value})),h(0))}}),m.tags&&a.jsx("span",{className:"filter-loading",children:"Loading..."}),b.tags&&g.tags&&g.tags.length>0&&a.jsx("div",{className:"filter-dropdown",role:"listbox",children:(g.tags||[]).map((D,W)=>a.jsx("div",{className:"filter-dropdown-item",onMouseDown:P=>{P.preventDefault(),t(I=>({...I,tag:D})),s(I=>({...I,tag:D})),h(0),y(I=>({...I,tags:!1}))},children:D},W))})]})}),f.description&&a.jsx(qe,{className:"filter-cell",sx:{width:150},children:a.jsxs("div",{className:"filter-control",children:[a.jsx("input",{className:"filter-input",placeholder:"Description",value:r.description||"",onChange:D=>{const W=D.target.value;t(P=>({...P,description:W})),W&&W.length>=1?(C("descriptions",W),y(P=>({...P,descriptions:!0}))):(S(P=>({...P,descriptions:[]})),W===""&&(s(P=>({...P,description:""})),h(0)))},onFocus:()=>y(D=>({...D,descriptions:!0})),onBlur:()=>{setTimeout(()=>y(D=>({...D,descriptions:!1})),120)},onKeyDown:D=>{D.key==="Enter"&&(s(W=>({...W,description:D.target.value})),h(0))}}),m.descriptions&&a.jsx("span",{className:"filter-loading",children:"Loading..."}),b.descriptions&&g.descriptions&&g.descriptions.length>0&&a.jsx("div",{className:"filter-dropdown",role:"listbox",children:(g.descriptions||[]).map((D,W)=>a.jsx("div",{className:"filter-dropdown-item",onMouseDown:P=>{P.preventDefault(),t(I=>({...I,description:D})),s(I=>({...I,description:D})),h(0),y(I=>({...I,descriptions:!1}))},children:D},W))})]})}),f.color&&a.jsx(qe,{className:"filter-cell",sx:{width:120},children:a.jsxs("div",{className:"filter-control",children:[a.jsx("input",{className:"filter-input",placeholder:"Color Code",value:r.color||"",onChange:D=>{const W=D.target.value;t(P=>({...P,color:W})),W&&W.length>=1?(C("colors",W),y(P=>({...P,colors:!0}))):(S(P=>({...P,colors:[]})),W===""&&(s(P=>({...P,color:""})),h(0)))},onFocus:()=>y(D=>({...D,colors:!0})),onBlur:()=>{setTimeout(()=>y(D=>({...D,colors:!1})),120)},onKeyDown:D=>{D.key==="Enter"&&(s(W=>({...W,color:D.target.value})),h(0))}}),m.colors&&a.jsx("span",{className:"filter-loading",children:"Loading..."}),b.colors&&g.colors&&g.colors.length>0&&a.jsx("div",{className:"filter-dropdown",role:"listbox",children:(g.colors||[]).map((D,W)=>a.jsx("div",{className:"filter-dropdown-item",onMouseDown:P=>{P.preventDefault(),t(I=>({...I,color:D})),s(I=>({...I,color:D})),h(0),y(I=>({...I,colors:!1}))},children:D},W))})]})}),f.size&&a.jsx(qe,{className:"filter-cell",sx:{width:120},children:a.jsxs("div",{className:"filter-control",children:[a.jsx("input",{className:"filter-input",placeholder:"Size",value:r.size||"",onChange:D=>{const W=D.target.value;t(P=>({...P,size:W})),W&&W.length>=1?(C("sizes",W),y(P=>({...P,sizes:!0}))):(S(P=>({...P,sizes:[]})),W===""&&(s(P=>({...P,size:""})),h(0)))},onFocus:()=>y(D=>({...D,sizes:!0})),onBlur:()=>{setTimeout(()=>y(D=>({...D,sizes:!1})),120)},onKeyDown:D=>{D.key==="Enter"&&(s(W=>({...W,size:D.target.value})),h(0))}}),m.sizes&&a.jsx("span",{className:"filter-loading",children:"Loading..."}),b.sizes&&g.sizes&&g.sizes.length>0&&a.jsx("div",{className:"filter-dropdown",role:"listbox",children:(g.sizes||[]).map((D,W)=>a.jsx("div",{className:"filter-dropdown-item",onMouseDown:P=>{P.preventDefault(),t(I=>({...I,size:D})),s(I=>({...I,size:D})),h(0),y(I=>({...I,sizes:!1}))},children:D},W))})]})}),f.sku&&a.jsx(qe,{className:"filter-cell",sx:{width:120},children:a.jsxs("div",{className:"filter-control",children:[a.jsx("input",{className:"filter-input",placeholder:"SKU",value:r.sku||"",onChange:D=>{const W=D.target.value;t(P=>({...P,sku:W})),W&&W.length>=1?(C("skus",W),y(P=>({...P,skus:!0}))):(S(P=>({...P,skus:[]})),W===""&&(s(P=>({...P,sku:""})),h(0)))},onFocus:()=>y(D=>({...D,skus:!0})),onBlur:()=>{setTimeout(()=>y(D=>({...D,skus:!1})),120)},onKeyDown:D=>{D.key==="Enter"&&(s(W=>({...W,sku:D.target.value})),h(0))}}),m.skus&&a.jsx("span",{className:"filter-loading",children:"Loading..."}),b.skus&&g.skus&&g.skus.length>0&&a.jsx("div",{className:"filter-dropdown",role:"listbox",children:(g.skus||[]).map((D,W)=>a.jsx("div",{className:"filter-dropdown-item",onMouseDown:P=>{P.preventDefault(),t(I=>({...I,sku:D})),s(I=>({...I,sku:D})),h(0),y(I=>({...I,skus:!1}))},children:D},W))})]})}),f.barcode&&a.jsx(qe,{className:"filter-cell",sx:{width:120},children:a.jsxs("div",{className:"filter-control",children:[a.jsx("input",{className:"filter-input",placeholder:"Barcode",value:r.barcode||"",onChange:D=>{const W=D.target.value;t(P=>({...P,barcode:W})),W&&W.length>=1?(C("barcodes",W),y(P=>({...P,barcodes:!0}))):(S(P=>({...P,barcodes:[]})),W===""&&(s(P=>({...P,barcode:""})),h(0)))},onFocus:()=>y(D=>({...D,barcodes:!0})),onBlur:()=>{setTimeout(()=>y(D=>({...D,barcodes:!1})),120)},onKeyDown:D=>{D.key==="Enter"&&(s(W=>({...W,barcode:D.target.value})),h(0))}}),m.barcodes&&a.jsx("span",{className:"filter-loading",children:"Loading..."}),b.barcodes&&g.barcodes&&g.barcodes.length>0&&a.jsx("div",{className:"filter-dropdown",role:"listbox",children:(g.barcodes||[]).map((D,W)=>a.jsx("div",{className:"filter-dropdown-item",onMouseDown:P=>{P.preventDefault(),t(I=>({...I,barcode:D})),s(I=>({...I,barcode:D})),h(0),y(I=>({...I,barcodes:!1}))},children:D},W))})]})}),f.purchaseCost&&a.jsx(qe,{className:"filter-cell",sx:{width:120},children:a.jsxs("div",{className:"filter-control",children:[a.jsx("input",{className:"filter-input",placeholder:"Purchase Cost",type:"number",value:r.purchaseCost||"",onChange:D=>{const W=D.target.value;t(P=>({...P,purchaseCost:W})),W&&W.length>=1?(C("purchaseCosts",W),y(P=>({...P,purchaseCosts:!0}))):(S(P=>({...P,purchaseCosts:[]})),W===""&&(s(P=>({...P,purchaseCost:""})),h(0)))},onFocus:()=>y(D=>({...D,purchaseCosts:!0})),onBlur:()=>{setTimeout(()=>y(D=>({...D,purchaseCosts:!1})),120)},onKeyDown:D=>{D.key==="Enter"&&(s(W=>({...W,purchaseCost:D.target.value})),h(0))}}),m.purchaseCosts&&a.jsx("span",{className:"filter-loading",children:"Loading..."}),b.purchaseCosts&&g.purchaseCosts&&g.purchaseCosts.length>0&&a.jsx("div",{className:"filter-dropdown",role:"listbox",children:(g.purchaseCosts||[]).map((D,W)=>a.jsx("div",{className:"filter-dropdown-item",onMouseDown:P=>{P.preventDefault(),t(I=>({...I,purchaseCost:D})),s(I=>({...I,purchaseCost:D})),h(0),y(I=>({...I,purchaseCosts:!1}))},children:D},W))})]})}),f.salesPrice&&a.jsx(qe,{className:"filter-cell",sx:{width:120},children:a.jsxs("div",{className:"filter-control",children:[a.jsx("input",{className:"filter-input",placeholder:"Sales Price",type:"number",value:r.salesPrice||"",onChange:D=>{const W=D.target.value;t(P=>({...P,salesPrice:W})),W&&W.length>=1?(C("salesPrices",W),y(P=>({...P,salesPrices:!0}))):(S(P=>({...P,salesPrices:[]})),W===""&&(s(P=>({...P,salesPrice:""})),h(0)))},onFocus:()=>y(D=>({...D,salesPrices:!0})),onBlur:()=>{setTimeout(()=>y(D=>({...D,salesPrices:!1})),120)},onKeyDown:D=>{D.key==="Enter"&&(s(W=>({...W,salesPrice:D.target.value})),h(0))}}),m.salesPrices&&a.jsx("span",{className:"filter-loading",children:"Loading..."}),b.salesPrices&&g.salesPrices&&g.salesPrices.length>0&&a.jsx("div",{className:"filter-dropdown",role:"listbox",children:(g.salesPrices||[]).map((D,W)=>a.jsx("div",{className:"filter-dropdown-item",onMouseDown:P=>{P.preventDefault(),t(I=>({...I,salesPrice:D})),s(I=>({...I,salesPrice:D})),h(0),y(I=>({...I,salesPrices:!1}))},children:D},W))})]})}),f.image&&a.jsx(qe,{sx:{width:120},children:a.jsx(Et,{variant:"caption",color:"textSecondary",children:"Images"})}),f.actions&&a.jsx(qe,{sx:{width:150}})]})}),Ui=(e,r)=>{if(!r||!e)return e;const t=new RegExp(`(${r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return e.split(t).map((s,o)=>t.test(s)?a.jsx("span",{className:"search-highlight",children:s},o):s)};function Tie(){var Vn,Xs,Qr,qn,ks,wn,ka,Xn;const e=ii(),[r,t]=G.useState([]),[n,s]=G.useState([]),[o,i]=G.useState([]),[c,u]=G.useState([]),[l,d]=G.useState([]),[h,f]=G.useState([]),[p,v]=G.useState([]),[g,m]=G.useState([]),[b,y]=G.useState([]),S={name:"",code:"",categoryID:null,subcategoryID:null,storeID:null,productType:"",productMode:"",stock:"",moq:"",leadTime:"",note:"",status:null,importance:null,tag:"",description:"",color:"",size:"",sku:"",barcode:"",purchaseCost:"",salesPrice:""},[C,L]=G.useState(S),[O,H]=G.useState({name:"",code:"",productType:"",productMode:"",stock:"",minimumStock:"",moq:"",leadTime:"",note:"",tag:"",description:"",color:"",size:"",sku:"",barcode:"",purchaseCost:"",salesPrice:""}),[z,q]=G.useState(0),[D,W]=G.useState(10),[P,I]=G.useState(0),[U,k]=G.useState(0),[_,R]=G.useState(!1),[j,A]=G.useState(null),[N,V]=G.useState(null),[M,Z]=G.useState(null),[J,re]=G.useState(null),[X,ne]=G.useState(null),[Y,K]=G.useState(null),[ee,ue]=G.useState(0),[se,ce]=G.useState({...S}),[fe,ve]=G.useState(()=>{const st={name:!0,code:!0,category:!0,subcategory:!0,store:!0,productType:!0,productMode:!0,stock:!0,minimumStock:!0,moq:!0,leadTime:!0,note:!0,status:!0,importance:!0,tag:!0,description:!0,color:!0,size:!0,sku:!0,barcode:!0,purchaseCost:!0,salesPrice:!0,image:!0,actions:!0},Wt=localStorage.getItem("productListColumns");if(Wt)try{const At=JSON.parse(Wt);return{...st,...At}}catch(At){console.error("Error parsing saved column preferences",At)}return st}),[_e,le]=G.useState(null);G.useEffect(()=>{localStorage.setItem("productListColumns",JSON.stringify(fe))},[fe]);const[ke,Te]=G.useState([]),[pe,ye]=G.useState("all"),[ge,De]=G.useState(""),[He,Xe]=G.useState({names:[],codes:[],stocks:[],moqs:[],leadTimes:[],notes:[],tags:[],descriptions:[],colors:[],sizes:[],skus:[],barcodes:[],purchaseCosts:[],salesPrices:[]}),[at,dt]=G.useState({names:!1,codes:!1,stocks:!1,moqs:!1,leadTimes:!1,notes:!1,tags:!1,descriptions:!1,colors:!1,sizes:!1,skus:!1,barcodes:!1,purchaseCosts:!1,salesPrices:!1}),[wt,$t]=G.useState({names:"local",codes:"local",stocks:"local",moqs:"local",leadTimes:"local",notes:"local"}),[Bt,ft]=G.useState(null),tr=!!Bt,[Me,tt]=G.useState({names:!1,codes:!1,stocks:!1,moqs:!1,leadTimes:!1,notes:!1,tags:!1,descriptions:!1,colors:!1,sizes:!1,skus:!1,barcodes:!1,purchaseCosts:!1,salesPrices:!1}),Ze=st=>{Te(Wt=>Wt.includes(st)?Wt.filter(At=>At!==st):[...Wt,st])},St=()=>{const st=r.map(At=>At.ID),Wt=st.length>0&&st.every(At=>ke.includes(At));Te(Wt?At=>At.filter(Xt=>!st.includes(Xt)):At=>{const Xt=new Set(At);return st.forEach(ht=>Xt.add(ht)),Array.from(Xt)})};G.useEffect(()=>{Xe({names:[],codes:[],stocks:[],moqs:[],leadTimes:[],notes:[],colors:[],sizes:[],skus:[],barcodes:[],purchaseCosts:[],salesPrices:[]}),$t({names:"local",codes:"local",stocks:"local",moqs:"local",leadTimes:"local",notes:"local",colors:"local",sizes:"local",skus:"local",barcodes:"local",purchaseCosts:"local",salesPrices:"local"})},[r]),G.useEffect(()=>{H({name:C.name,code:C.code,productType:C.productType,productMode:C.productMode,stock:C.stock,moq:C.moq,leadTime:C.leadTime,note:C.note,tag:C.tag,description:C.description,color:C.color,size:C.size,sku:C.sku,barcode:C.barcode,purchaseCost:C.purchaseCost,salesPrice:C.salesPrice})},[]),G.useEffect(()=>{const st=setTimeout(()=>{L(Wt=>{const At={...Wt};let Xt=!1;return Wt.productType!==O.productType&&(At.productType=O.productType,Xt=!0),Wt.productMode!==O.productMode&&(At.productMode=O.productMode,Xt=!0),Wt.minimumStock!==O.minimumStock&&(At.minimumStock=O.minimumStock,Xt=!0),Xt?At:Wt}),q(0)},400);return()=>clearTimeout(st)},[O.productType,O.productMode,O.minimumStock]),G.useEffect(()=>{const st=setTimeout(()=>{const Wt=ge&&ge.trim()!==""?ge.trim():"";Wt.toLowerCase(),L(At=>{const Xt={...At};return Xt.filter=Wt,Xt.name="",Xt.code="",Xt.tag="",Xt.description="",Xt.sku="",Xt.barcode="",Xt.categoryID=null,Xt.subcategoryID=null,Xt.storeID=null,Xt}),q(0)},400);return()=>clearTimeout(st)},[ge,n,o,c]),G.useEffect(()=>{const st=setTimeout(()=>{ce(C)},500);return()=>clearTimeout(st)},[C]);const et=async()=>{try{console.log("Fetching dropdown data from backend...");const[st,Wt,At,Xt,ht,er,mr,ar]=await Promise.all([ut.get(`${Je}/api/categories`).catch(hn=>(console.error("Error fetching categories:",hn),{data:[]})),ut.get(`${Je}/api/subcategories`).catch(hn=>(console.error("Error fetching subcategories:",hn),{data:[]})),ut.get(`${Je}/api/stores`).catch(hn=>(console.error("Error fetching stores:",hn),{data:[]})),ut.get(`${Je}/api/hsncode`).catch(hn=>(console.error("Error fetching hsncodes:",hn),{data:[]})),ut.get(`${Je}/api/units`).catch(hn=>(console.error("Error fetching units:",hn),{data:[]})),ut.get(`${Je}/api/sizes`).catch(hn=>(console.error("Error fetching sizes:",hn),{data:[]})),ut.get(`${Je}/api/tags`).catch(hn=>(console.error("Error fetching tags:",hn),{data:[]})),ut.get(`${Je}/api/taxes`).catch(hn=>(console.error("Error fetching taxes:",hn),{data:[]}))]),Mr=hn=>{if(!hn||!hn.data)return[];const Oi=hn.data.data||hn.data;return Array.isArray(Oi)?Oi:[]},Wr=Mr(st),_n=Mr(Wt),en=Mr(At),Yt=Mr(Xt),xr=Mr(ht),Hr=Mr(er),Na=Mr(mr),Ra=Mr(ar);console.log("Dropdown data samples:"),Wr.length>0&&console.log("Category sample:",Wr[0]),_n.length>0&&console.log("Subcategory sample:",_n[0]),en.length>0&&console.log("Store sample:",en[0]),Yt.length>0&&console.log("HSN Code sample:",Yt[0]),xr.length>0&&console.log("Unit sample:",xr[0]),Hr.length>0&&console.log("Size sample:",Hr[0]),Ra.length>0&&console.log("Tax sample:",Ra[0]),console.log("Dropdown data counts:"),console.log("Categories:",Wr.length),console.log("Subcategories:",_n.length),console.log("Stores:",en.length),console.log("HSN Codes:",Yt.length),console.log("Units:",xr.length),console.log("Sizes:",Hr.length),console.log("Taxes:",Ra.length),console.log("Raw HSN codes data (first item):",Yt.length>0?Yt[0]:"No HSN data");const Xi=Yt.map(hn=>({id:hn.id||hn.ID,code:String(hn.code||hn.Code||""),tax_id:hn.tax_id||hn.taxId||hn.TaxID,Tax:hn.Tax||hn.tax||{},tax:hn.Tax||hn.tax||{}}));return console.log("Standardized HSN codes (first item):",Xi.length>0?Xi[0]:"No HSN data"),s(Wr),i(_n),u(en),d(Xi),f(xr),v(Hr),m(Na),y(Ra),{categories:Wr,subcategories:_n,stores:en,hsnCodes:Xi,units:xr,tags:Na,taxes:Ra,sizes:Hr}}catch(st){return console.error("Error fetching dropdown data:",st),null}};G.useEffect(()=>{et()},[]);const Ht=async(st,Wt="")=>{dt(At=>({...At,[st]:!0}));try{const At=Nt(st,Wt);if(At.length>0){Xe(Xt=>({...Xt,[st]:At})),$t(Xt=>({...Xt,[st]:"local"})),tt(Xt=>({...Xt,[st]:!0})),dt(Xt=>({...Xt,[st]:!1}));return}if(Wt.trim()){const ht=(await ut.get(`${Je}/api/products/autocomplete`,{params:{field:st,query:Wt,limit:10}})).data.data||[];Xe(er=>({...er,[st]:ht})),$t(er=>({...er,[st]:"api"})),ht&&ht.length>0&&tt(er=>({...er,[st]:!0}))}}catch(At){console.error(`Error fetching ${st} autocomplete:`,At);const Xt=Nt(st,Wt);Xe(ht=>({...ht,[st]:Xt})),$t(ht=>({...ht,[st]:"local"})),Xt&&Xt.length>0&&tt(ht=>({...ht,[st]:!0}))}finally{dt(At=>({...At,[st]:!1}))}},Nt=(st,Wt)=>{if(!r||r.length===0)return[];const At=Wt?Wt.toLowerCase():"",Xt=new Set;switch(st){case"names":r.forEach(ht=>{ht.Name&&(!Wt||ht.Name.toLowerCase().includes(At))&&Xt.add(ht.Name)});break;case"codes":r.forEach(ht=>{ht.Code&&(!Wt||ht.Code.toLowerCase().includes(At))&&Xt.add(ht.Code)});break;case"stocks":r.forEach(ht=>{let er=null;ht.Stock!==void 0&&ht.Stock!==null?er=ht.Stock:ht.Variants&&ht.Variants.length>0&&(er=ht.Variants.reduce((mr,ar)=>mr+(ar.Stock||0),0)),er!=null&&er.toString().includes(Wt)&&Xt.add(er.toString())});break;case"moqs":r.forEach(ht=>{ht.MOQ!==void 0&&ht.MOQ!==null&&ht.MOQ.toString().includes(Wt)&&Xt.add(ht.MOQ.toString())});break;case"leadTimes":r.forEach(ht=>{let er=null;ht.LeadTime!==void 0&&ht.LeadTime!==null?er=ht.LeadTime:ht.Variants&&ht.Variants.length>0&&ht.Variants[0].LeadTime&&(er=ht.Variants[0].LeadTime),er!=null&&er.toString().includes(Wt)&&Xt.add(er.toString())});break;case"notes":r.forEach(ht=>{const er=ht.Note||ht.InternalNotes||ht.internal_notes||"";er&&er.toLowerCase().includes(At)&&Xt.add(er)});break;case"tags":r.forEach(ht=>{Array.isArray(ht.Tags)&&ht.Tags.length>0&&ht.Tags.forEach(er=>{er&&er.Name&&er.Name.toLowerCase().includes(At)&&Xt.add(er.Name)})});break;case"descriptions":r.forEach(ht=>{const er=ht.Description||"";er&&typeof er=="string"&&er.toLowerCase().includes(At)&&Xt.add(er)});break;case"colors":r.forEach(ht=>{ht.Variants&&ht.Variants.length>0&&ht.Variants.forEach(er=>{er.Color&&er.Color.toLowerCase().includes(At)&&Xt.add(er.Color)})});break;case"sizes":r.forEach(ht=>{ht.Variants&&ht.Variants.length>0&&ht.Variants.forEach(er=>{var ar;const mr=((ar=er.Size)==null?void 0:ar.Name)||er.Size;mr&&mr.toLowerCase().includes(At)&&Xt.add(mr)})});break;case"skus":r.forEach(ht=>{ht.Variants&&ht.Variants.length>0&&ht.Variants.forEach(er=>{er.SKU&&er.SKU.toLowerCase().includes(At)&&Xt.add(er.SKU)})});break;case"barcodes":r.forEach(ht=>{ht.Variants&&ht.Variants.length>0&&ht.Variants.forEach(er=>{er.Barcode&&er.Barcode.toLowerCase().includes(At)&&Xt.add(er.Barcode)})});break;case"purchaseCosts":r.forEach(ht=>{ht.Variants&&ht.Variants.length>0&&ht.Variants.forEach(er=>{er.PurchaseCost!==void 0&&er.PurchaseCost!==null&&er.PurchaseCost.toString().includes(Wt)&&Xt.add(er.PurchaseCost.toString())})});break;case"salesPrices":r.forEach(ht=>{ht.Variants&&ht.Variants.length>0&&ht.Variants.forEach(er=>{er.StdSalesPrice!==void 0&&er.StdSalesPrice!==null&&er.StdSalesPrice.toString().includes(Wt)&&Xt.add(er.StdSalesPrice.toString())})});break;default:return[]}return Array.from(Xt).slice(0,10)},kt=G.useCallback(ll(st=>Ht("names",st),100),[r]),kr=G.useCallback(ll(st=>Ht("codes",st),100),[r]),Jt=G.useCallback(ll(st=>Ht("stocks",st),100),[r]),Pt=G.useCallback(ll(st=>Ht("moqs",st),100),[r]),Ur=G.useCallback(ll(st=>Ht("leadTimes",st),100),[r]),Lr=G.useCallback(ll(st=>Ht("notes",st),100),[r]),vt=G.useCallback(ll(st=>Ht("tags",st),100),[r]),nr=G.useCallback(ll(st=>Ht("descriptions",st),100),[r]),Cr=G.useCallback(ll(st=>Ht("colors",st),100),[r]),Dt=G.useCallback(ll(st=>Ht("sizes",st),100),[r]),je=G.useCallback(ll(st=>Ht("skus",st),100),[r]),ct=G.useCallback(ll(st=>Ht("barcodes",st),100),[r]),nt=G.useCallback(ll(st=>Ht("purchaseCosts",st),100),[r]),Pe=G.useCallback(ll(st=>Ht("salesPrices",st),100),[r]),Qe=async()=>{var st,Wt;R(!0);try{if(!se){console.error("debouncedFilters is undefined"),R(!1);return}console.log("fetchProducts called with filters:",se),console.log("Current page:",z,"limit:",D);const At=Object.entries({name:se.name||"",code:se.code||"",product_type:se.productType!==""?se.productType:void 0,product_mode:se.productMode!==""?se.productMode:void 0,category_id:se.categoryID!=null?se.categoryID:void 0,subcategory_id:se.subcategoryID!=null?se.subcategoryID:void 0,store_id:se.storeID!=null?se.storeID:void 0,stock:se.stock!==""&&!isNaN(Number(se.stock))?Number(se.stock):void 0,minimum_stock:se.minimumStock!==""&&!isNaN(Number(se.minimumStock))?Number(se.minimumStock):void 0,moq:se.moq!==""&&!isNaN(Number(se.moq))?Number(se.moq):void 0,lead_time:se.leadTime!==""?se.leadTime:void 0,note:se.note!==""?se.note:void 0,status:se.status!=null?se.status:void 0,importance:se.importance!=null?se.importance:void 0,tag:se.tag!==""?se.tag:void 0,description:se.description!==""?se.description:void 0,color:se.color!==""?se.color:void 0,size:se.size!==""?se.size:void 0,sku:se.sku!==""?se.sku:void 0,barcode:se.barcode!==""?se.barcode:void 0,purchase_cost:se.purchaseCost!==""&&!isNaN(Number(se.purchaseCost))?Number(se.purchaseCost):void 0,sales_price:se.salesPrice!==""&&!isNaN(Number(se.salesPrice))?Number(se.salesPrice):void 0,filter:se.filter!==""&&se.filter!==void 0?se.filter:void 0,stock_filter:pe!=="all"?pe:void 0}).reduce((ht,[er,mr])=>(mr!==""&&mr!==void 0&&mr!==null&&(ht[er]=mr),ht),{});let Xt={};N?Xt={sort_by:"name",sort_order:N}:M?Xt={sort_by:"stock",sort_order:M}:J?Xt={sort_by:"leadTime",sort_order:J}:X?Xt={sort_by:"purchaseCost",sort_order:X}:Y&&(Xt={sort_by:"salesPrice",sort_order:Y}),console.log("Fetching products with params:",{page:z+1,limit:D,...At,...Xt});try{const ht=await ut.get(`${Je}/api/products`,{params:{page:z+1,limit:D,...At,...Xt,_t:new Date().getTime()},timeout:15e3});console.log("fetchProducts API response status:",ht.status),console.log("fetchProducts API response data:",ht.data);const er=!ht||!ht.data?[]:Array.isArray(ht.data.data)?ht.data.data:ht.data.data==null?[]:Array.isArray(ht.data)?ht.data:[];console.log("Setting products to:",er.length,"items"),t(er),I(((st=ht==null?void 0:ht.data)==null?void 0:st.total)||0),k(((Wt=ht==null?void 0:ht.data)==null?void 0:Wt.totalCost)||0)}catch(ht){console.error("API request failed:",ht),t([]),I(0),k(0)}}catch(At){console.error("Error fetching products:",At),t([]),I(0),k(0),A(At.message||"Failed to load products. Please try again.")}finally{R(!1)}},gt=G.useCallback(st=>{V(Wt=>Wt===st?null:st),Z(null),re(null)},[]),xe=G.useCallback(st=>{Z(Wt=>Wt===st?null:st),V(null),re(null)},[]),Oe=G.useCallback(st=>{re(Wt=>Wt===st?null:st),V(null),Z(null),ne(null),K(null)},[]),Ce=G.useCallback(st=>{ne(Wt=>Wt===st?null:st),V(null),Z(null),re(null),K(null)},[]),de=G.useCallback(st=>{K(Wt=>Wt===st?null:st),V(null),Z(null),re(null),ne(null)},[]);G.useEffect(()=>{console.log("Effect triggered - fetchProducts will be called"),console.log("Current filters state:",{debouncedFilters:se,page:z,limit:D,sorts:{nameSort:N,stockSort:M,leadTimeSort:J,purchaseCostSort:X,salesPriceSort:Y},stockFilter:pe,forceRefresh:ee}),se?Qe():console.error("debouncedFilters is undefined in useEffect - cannot fetch products")},[se,z,D,N,M,J,X,Y,pe,ee]),G.useEffect(()=>{console.log("Products state changed:",(r==null?void 0:r.length)||0,"items")},[r]),G.useEffect(()=>(R(!0),A(null),t([]),wa(),()=>{console.log("Component unmounting - cleaning up")}),[]);const be=st=>{le(st.currentTarget)},Se=()=>{le(null)},[Ne,ze]=G.useState(null),[Re,Ie]=G.useState(!1),[ae,we]=G.useState(!1),[Fe,Ye]=G.useState(!1),[me,Be]=G.useState(null),[Ge,mt]=G.useState(!1),[_t,ot]=G.useState(!1),[xt]=G.useState(""),[zt,Vt]=G.useState(""),[Ar,wr]=G.useState(!1),[Nr,Dr]=G.useState(null),[Yr,Vr]=G.useState(!1),[on,xn]=G.useState([]),[ia,yn]=G.useState(!1),[oa,Qn]=G.useState(new Set),[za,pr]=G.useState({}),[Ir,$n]=G.useState(!1),[Fr,jr]=G.useState(null),[Le,rt]=G.useState(!1),[Ke,pt]=G.useState(null),rr=st=>String(st||"").toLowerCase().replace(/\s+/g,"").replace(/\*/g,"").replace(/[^a-z0-9]/g,""),ur=(st=[],Wt=[])=>{const At={};return Array.isArray(st)&&st.forEach(Xt=>{const ht=typeof Xt.row=="number"?Xt.row-1:Xt.rowIndex??null;if(ht===null||ht<0)return;const er=Xt.data||Wt[ht]||{},mr=Object.keys(er);At[ht]||(At[ht]={}),(Array.isArray(Xt.errors)?Xt.errors:[String(Xt.errors||"")]).forEach(Mr=>{const Wr=String(Mr||"").toLowerCase();let _n=!1;const en=[{key:"name",tags:["name"]},{key:"producttype",tags:["product type","producttype"]},{key:"store",tags:["store"]},{key:"hsn",tags:["hsn"]},{key:"unit",tags:["unit"]},{key:"status",tags:["status"]},{key:"importance",tags:["importance"]},{key:"code",tags:["code"]},{key:"tax",tags:["tax"]}];for(const Yt of en)if(Yt.tags.some(xr=>Wr.includes(xr))){const xr=mr.find(Hr=>rr(Hr).includes(Yt.key)||rr(Hr)===Yt.key);if(xr){At[ht][xr]=At[ht][xr]||[],At[ht][xr].push(Mr),_n=!0;break}}_n||mr.forEach(Yt=>{At[ht][Yt]=At[ht][Yt]||[],At[ht][Yt].push(Mr)})})}),At},Rr=async st=>{var Wt,At;try{we(!0);const Xt=await ut.get(`${Je}/api/products/${st}`);let ht=((Wt=Xt==null?void 0:Xt.data)==null?void 0:Wt.data)??(Xt==null?void 0:Xt.data)??null;console.log("Product data from API:",ht),console.log("Product Tags:",ht==null?void 0:ht.Tags);const er=Yt=>{if(Yt==null)return null;const xr=[Yt.Stock,Yt.StockQuantity,Yt.stock,Yt.quantity,Yt.qty,Yt.total_stock,Yt.TotalStock];for(const Hr of xr){if(Hr===0)return 0;if(Hr==null)continue;const Na=Number(Hr);if(!Number.isNaN(Na))return Na}return null},mr=Yt=>{const xr=Yt.Images??Yt.images??Yt.ImagesList??Yt.images_list??Yt.pictures??Yt.pictures_list??Yt.photos;if(!xr){const Hr=Yt.Image??Yt.image??Yt.thumbnail??Yt.thumb;return Hr?[Hr]:[]}return Array.isArray(xr)?xr.map(Hr=>Hr?typeof Hr=="string"?Hr:Hr.url??Hr.src??Hr.path??Hr.file??null:null).filter(Boolean):typeof xr=="object"&&xr!==null?[xr.url??xr.src??xr.path??null].filter(Boolean):[]};let ar=(ht==null?void 0:ht.Variants)??(ht==null?void 0:ht.variants)??(ht==null?void 0:ht.product_variants)??null;if(!Array.isArray(ar)||ar.length===0)try{const Yt=await ut.get(`${Je}/api/products/${st}/variants`);ar=((At=Yt==null?void 0:Yt.data)==null?void 0:At.data)??(Yt==null?void 0:Yt.data)??[]}catch(Yt){console.error("Error fetching variants separately:",Yt),ar=[]}ar=Array.isArray(ar)?ar.map((Yt,xr)=>{const Hr=Yt.SKU??Yt.Code??Yt.code??Yt.sku??Yt.id??Yt.ID??`#${xr+1}`,Na=Yt.Barcode??Yt.barcode??Yt.EAN??Yt.ean??Yt.UPC??Yt.upc??"",Ra=Yt.PurchaseCost??Yt.purchase_cost??Yt.Cost??Yt.cost_price??Yt.CostPrice??Yt.cost??null,Xi=Yt.Price??Yt.UnitPrice??Yt.price??Yt.unit_price??Yt.SalesPrice??Yt.sales_price??Yt.StdSalesPrice??Yt.std_sales_price??null,hn=er(Yt),Oi=Yt.LeadTime??Yt.lead_time??Yt.leadtime??Yt.delivery_days??Yt.lead??null,Rs=Yt.Attributes??Yt.attributes??Yt.options??Yt.Options??Yt.variables??{},Ys=Yt.Color??Yt.color??Rs.Color??Rs.color??Rs.color_name??"",Do=Yt.Size??Yt.size??Rs.Size??Rs.size??Rs.size_name??"",ea=mr(Yt);return{...Yt,SKU:Hr,Barcode:Na,PurchaseCost:Ra,SalesPrice:Xi,stock:hn,LeadTime:Oi,Color:Ys,Size:Do,Images:ea}}):[];let Mr=er(ht);Mr==null&&Array.isArray(ar)&&ar.length>0&&(Mr=ar.reduce((xr,Hr)=>{const Na=er(Hr);return xr+(Na??0)},0));const Wr=(ht==null?void 0:ht.MOQ)??(ht==null?void 0:ht.MinimumOrderQuantity)??(ht==null?void 0:ht.moq)??(ht==null?void 0:ht.Moq)??null;let _n=(ht==null?void 0:ht.Unit)??(ht==null?void 0:ht.unit)??null;const en={...ht,Variants:Array.isArray(ar)?ar:[],Stock:Mr,MOQ:Wr,Unit:_n};ze(en),Ie(!0)}catch(Xt){console.error("Error fetching product details:",Xt),ze(null),Ie(!0)}finally{we(!1)}},Kr=()=>{Ie(!1),ze(null)},sr=st=>{Be(st),Ye(!0)},jn=()=>{Ye(!1),Be(null),mt(!1)},Kt=async()=>{var st,Wt,At,Xt,ht,er,mr;if(me){mt(!0);try{await ut.delete(`${Je}/api/products/${me}`),Qe(),Te(ar=>ar.filter(Mr=>Mr!==me)),jn()}catch(ar){console.error("Failed to delete product:",((st=ar.response)==null?void 0:st.data)||ar.message),mt(!1);const Mr=((At=(Wt=ar.response)==null?void 0:Wt.data)==null?void 0:At.error)||((Xt=ar.response)==null?void 0:Xt.data)||ar.message||"",Wr=/violates foreign key constraint|SQLSTATE\s*23503|foreign key/i.test(String(Mr))||((er=(ht=ar.response)==null?void 0:ht.data)==null?void 0:er.code)==="23503";((mr=ar.response)==null?void 0:mr.status)===409||Wr?(Vt("Cannot Delete Product"),ot(!0)):(typeof Mr=="string"||JSON.stringify(Mr),Vt("Failed to Delete Product"),ot(!0))}}},qt=(st,Wt="products.csv",At=null)=>{const Xt=Array.isArray(At)&&At.length>0?At:Object.keys(st[0]||{}),ht=Xt.map(_n=>`"${_n}"`).join(","),er=st.map(_n=>Xt.map(en=>`"${(_n[en]??"").toString().replace(/"/g,'""')}"`).join(",")),mr=[ht,...er].join(`\r
`),ar=new Blob([mr],{type:"text/csv;charset=utf-8;"}),Mr=document.createElement("a"),Wr=URL.createObjectURL(ar);Mr.href=Wr,Mr.setAttribute("download",Wt),document.body.appendChild(Mr),Mr.click(),document.body.removeChild(Mr),URL.revokeObjectURL(Wr)},Gr=async(st="filtered")=>{try{let Wt=[];if(ke.length>0){const mr=ke.map(Mr=>ut.get(`${Je}/api/products/${Mr}`));Wt=(await Promise.all(mr)).map(Mr=>Mr.data.data||Mr.data)}else if(st==="all")Wt=(await ut.get(`${Je}/api/products`,{params:{limit:1e4}})).data.data||[];else{const mr=Object.entries({name:se.name||"",code:se.code||"",product_type:se.productType!==""?se.productType:void 0,product_mode:se.productMode!==""?se.productMode:void 0,category_id:se.categoryID!=null?se.categoryID:void 0,subcategory_id:se.subcategoryID!=null?se.subcategoryID:void 0,store_id:se.storeID!=null?se.storeID:void 0,stock:se.stock!==""&&!isNaN(Number(se.stock))?Number(se.stock):void 0,minimum_stock:se.minimumStock!==""&&!isNaN(Number(se.minimumStock))?Number(se.minimumStock):void 0,moq:se.moq!==""&&!isNaN(Number(se.moq))?Number(se.moq):void 0,lead_time:se.leadTime!==""?se.leadTime:void 0,note:se.note!==""?se.note:void 0,status:se.status!=null?se.status:void 0,importance:se.importance!=null?se.importance:void 0,tag:se.tag!==""?se.tag:void 0,description:se.description!==""?se.description:void 0,color:se.color!==""?se.color:void 0,size:se.size!==""?se.size:void 0,sku:se.sku!==""?se.sku:void 0,barcode:se.barcode!==""?se.barcode:void 0,purchase_cost:se.purchaseCost!==""&&!isNaN(Number(se.purchaseCost))?Number(se.purchaseCost):void 0,sales_price:se.salesPrice!==""&&!isNaN(Number(se.salesPrice))?Number(se.salesPrice):void 0,filter:se.filter!==""&&se.filter!==void 0?se.filter:void 0,stock_filter:pe!=="all"?pe:void 0}).reduce((Wr,[_n,en])=>(en!==""&&en!==void 0&&en!==null&&(Wr[_n]=en),Wr),{});let ar={};N?ar={sort_by:"name",sort_order:N}:M?ar={sort_by:"stock",sort_order:M}:J?ar={sort_by:"leadTime",sort_order:J}:X?ar={sort_by:"purchaseCost",sort_order:X}:Y&&(ar={sort_by:"salesPrice",sort_order:Y}),Wt=(await ut.get(`${Je}/api/products`,{params:{...mr,...ar,limit:1e4}})).data.data||[]}const At=st==="filtered",Xt=Wt.map(mr=>{var Mr,Wr,_n;const ar={};if((!At||fe.name)&&(ar.Name=mr.Name),(!At||fe.code)&&(ar.Code=mr.Code),(!At||fe.category)&&(ar.Category=(Mr=mr.Category)==null?void 0:Mr.Name),(!At||fe.subcategory)&&(ar.Subcategory=(Wr=mr.Subcategory)==null?void 0:Wr.Name),(!At||fe.store)&&(ar.Store=(_n=mr.Store)==null?void 0:_n.Name),(!At||fe.productType)&&(ar["Product Type"]=mr.ProductType??mr.productType??"Finished Goods"),(!At||fe.productMode)&&(ar["Product Mode"]=mr.ProductMode??mr.product_mode??"Purchase"),(!At||fe.minimumStock)&&(ar["Minimum Stock"]=mr.MinimumStock??mr.minimumStock??""),(!At||fe.moq)&&(ar.MOQ=mr.MOQ??mr.MinimumOrderQuantity??mr.moq??""),(!At||fe.leadTime)&&(ar["Lead Time (Days)"]=mr.LeadTime??mr.lead_time??mr.leadtime??""),(!At||fe.note)&&(ar["Internal Notes"]=mr.InternalNotes??mr.internalNotes??mr.Note??mr.note??mr.Notes??mr.notes??""),(!At||fe.status)&&(ar.Status=mr.IsActive?"Active":"Inactive"),(!At||fe.importance)&&(ar.Importance=mr.Importance??"Normal"),(!At||fe.tag)&&(ar.Tag=mr.Tag??""),(!At||fe.description)&&(ar.Description=mr.Description??mr.description??""),mr.Variants&&mr.Variants.length>0){if((!At||fe.color)&&(ar["Color Code"]=mr.Variants.map(en=>{const Yt=nj(en.Color||en.ColorCaption);return Yt?Yt.name:en.Color??en.ColorCaption??"N/A"}).join("; ")),(!At||fe.size)&&(ar.Size=mr.Variants.map(en=>{var Yt;return((Yt=en.Size)==null?void 0:Yt.Name)||en.Size||"N/A"}).join("; ")),(!At||fe.sku)&&(ar.SKU=mr.Variants.map(en=>en.SKU??"N/A").join("; ")),(!At||fe.barcode)&&(ar.Barcode=mr.Variants.map(en=>en.Barcode??"N/A").join("; ")),(!At||fe.purchaseCost)&&(ar["Purchase Cost"]=mr.Variants.map(en=>en.PurchaseCost??0).join("; ")),(!At||fe.salesPrice)&&(ar["Sales Price"]=mr.Variants.map(en=>en.StdSalesPrice??en.SalesPrice??0).join("; ")),(!At||fe.stock)&&(ar.Stock=mr.Variants.map(en=>en.Stock??en.stock??en.quantity??en.qty??0).join("; ")),!At||fe.image){const Yt=mr.Variants.flatMap(xr=>xr.Images||[]).map(xr=>{if(typeof xr=="string"&&(xr.startsWith("http://")||xr.startsWith("https://")||xr.startsWith("data:")))return xr;if(typeof xr=="string"&&xr.trim()!==""){const Hr=xr.replace(/\\/g,"/");return Hr.startsWith("uploads/")?`${Je}/${Hr}`:`${Je}/uploads/${Hr}`}return""}).filter(xr=>xr!=="");ar.Images=Yt.join("; ")}}else(!At||fe.color)&&(ar["Color Code"]=""),(!At||fe.size)&&(ar.Size=""),(!At||fe.sku)&&(ar.SKU=""),(!At||fe.barcode)&&(ar.Barcode=""),(!At||fe.purchaseCost)&&(ar["Purchase Cost"]=""),(!At||fe.salesPrice)&&(ar["Sales Price"]=""),(!At||fe.stock)&&(ar.Stock=""),(!At||fe.image)&&(ar.Images="");return ar}),er=[{key:"Name",visibleKey:"name"},{key:"Code",visibleKey:"code"},{key:"Category",visibleKey:"category"},{key:"Subcategory",visibleKey:"subcategory"},{key:"Store",visibleKey:"store"},{key:"Product Type",visibleKey:"productType"},{key:"Product Mode",visibleKey:"productMode"},{key:"Stock",visibleKey:"stock"},{key:"Minimum Stock",visibleKey:"minimumStock"},{key:"MOQ",visibleKey:"moq"},{key:"Lead Time (Days)",visibleKey:"leadTime"},{key:"Internal Notes",visibleKey:"note"},{key:"Status",visibleKey:"status"},{key:"Importance",visibleKey:"importance"},{key:"Tag",visibleKey:"tag"},{key:"Description",visibleKey:"description"},{key:"Color Code",visibleKey:"color"},{key:"Size",visibleKey:"size"},{key:"SKU",visibleKey:"sku"},{key:"Barcode",visibleKey:"barcode"},{key:"Purchase Cost",visibleKey:"purchaseCost"},{key:"Sales Price",visibleKey:"salesPrice"},{key:"Images",visibleKey:"image"}].reduce((mr,ar)=>((!At||fe[ar.visibleKey])&&mr.push(ar.key),mr),[]);qt(Xt,"products_export.csv",er),ft(null)}catch(Wt){console.error("Error exporting products:",Wt),alert("Failed to export products. Please try again.")}},fn=async()=>{const st=["Name *","Code *","HSN Code *","Importance *","Product Type *","Minimum Stock","Category *","Subcategory","Unit","Product Mode *","MOQ","Store","Tag","Tax","GST %","Description","Internal Notes","Status *","Size","SKU","Barcode","Purchase Cost","Sales Price","Stock","Lead Time"];st.join(",");const Wt=["Sample Product","PRD001","HSN123","High","Single","10","Electronics","Mobiles","Piece","Purchase","5","Main Store","Featured","GST","18","Product description","Internal notes","Active","","SKU001","BAR001","100","150","20","3"],At=["Normal","High","Critical"],Xt=["All","Finished Goods","Semi-Finished Goods","Raw Materials"],ht=["Purchase","Internal Manufacturing","Both"],er=["Active","Inactive"];let mr;try{const ar=await hR(()=>Promise.resolve().then(()=>kE),[]);mr=ar.default||ar}catch(ar){console.error("Failed to load exceljs dynamically:",ar),mr=null}if(mr){let ar=function(ls){let Es="";for(;ls>0;){const Ns=(ls-1)%26;Es=String.fromCharCode(65+Ns)+Es,ls=Math.floor((ls-1)/26)}return Es};const Mr=new mr.Workbook,Wr=Mr.addWorksheet("Template");Wr.addRow(st),Wr.addRow(Wt);try{const ls=Wr.getRow(2),Es={argb:"FF9E9E9E"};for(let Ns=1;Ns<=st.length;Ns++){const yl=ls.getCell(Ns);yl.font={color:Es,italic:!0},yl.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF9F9F9"}}}}catch(ls){console.warn("Could not apply sample row styling:",ls)}const _n=Mr.addWorksheet("Lists",{state:"hidden"}),en=["Importance",...At],Yt=["Product Type",...Xt],xr=["Product Mode",...ht],Hr=["Status",...er];_n.addRow(en),_n.addRow(Yt),_n.addRow(xr),_n.addRow(Hr);const Na=(ls,Es)=>{const yl=2+Es-1,_c=ar(yl);return`Lists!$B$${ls}:$${_c}$${ls}`},Ra=Na(1,At.length),Xi=Na(2,Xt.length),hn=Na(3,ht.length),Oi=Na(4,er.length),Rs={};st.forEach((ls,Es)=>{const Ns=ls.replace(/\*/g,"").trim().toLowerCase().replace(/\s+/g," ");Rs[Ns]=Es+1});const Ys=(ls,Es)=>{for(let Ns=2;Ns<=1e3;Ns++){const yl=Wr.getCell(Ns,ls);yl.dataValidation={type:"list",allowBlank:!0,showErrorMessage:!0,formulae:[Es]},yl.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF7F7E8"}}}},Do=Rs.importance,ea=Rs["product type"],Gn=Rs["product mode"],Za=Rs.status;Do&&Ys(Do,`=${Ra}`),ea&&Ys(ea,`=${Xi}`),Gn&&Ys(Gn,`=${hn}`),Za&&Ys(Za,`=${Oi}`);const Zu=Wr.getRow(1);[Do,ea,Gn,Za].forEach(ls=>{if(!ls)return;const Es=Zu.getCell(ls);Es.font={bold:!0},Es.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFEEE8BF"}}}),Mr.xlsx.writeBuffer().then(ls=>{const Es=new Blob([ls],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),Ns=document.createElement("a");Ns.href=URL.createObjectURL(Es),Ns.download="product_import_template.xlsx",document.body.appendChild(Ns),Ns.click(),document.body.removeChild(Ns)}).catch(ls=>{console.error("Failed to generate XLSX template with exceljs:",ls),mr=null})}if(!mr){const Mr=[st,Wt],Wr=Wi.aoa_to_sheet(Mr),_n=[["Importance",...At],["Product Type",...Xt],["Product Mode",...ht],["Status",...er]],en=Wi.aoa_to_sheet(_n),Yt=Wi.book_new();Wi.book_append_sheet(Yt,Wr,"Template"),Wi.book_append_sheet(Yt,en,"AllowedValues"),xx(Yt,"product_import_template.xlsx")}},rn=async()=>{if(!Nr){alert("Please select a file to import.");return}Vr(!0);try{const st=new FileReader;st.onload=async Wt=>{try{let At=Wt.target.result;if(At.charCodeAt(0)===65279&&(At=At.slice(1)),console.log("Raw CSV data:",At),!At.trim()){alert("The CSV file appears to be empty."),Vr(!1);return}let ht=At.split(/\r\n|\n|\r/).filter(xr=>xr?xr.replace(/[",;\s]/g,"").length>0:!1);if(ht.length===0){alert("The CSV file appears to be empty."),Vr(!1);return}const er=ht[0].includes(";")?";":",",mr=ht[0].split(er).map(xr=>xr.trim().replace(/^"|"$/g,"").replace(/""/g,'"')),ar=ht.slice(1);console.log("Headers:",mr),console.log("Data rows:",ar.length);const Mr=mr.map(xr=>String(xr).toLowerCase().replace(/[^a-z0-9]/g,"")),_n=["name","code"].filter(xr=>!Mr.includes(xr));if(_n.length>0){const xr=_n.map(Hr=>Hr.charAt(0).toUpperCase()+Hr.slice(1));alert(`Missing required headers: ${xr.join(", ")}. Please check your CSV file format.`),Vr(!1);return}const en=ar.map(xr=>{let Hr=[],Na=!1,Ra="";if(er===";")Hr=xr.split(er).map(hn=>hn.trim().replace(/^"|"$/g,"").replace(/""/g,'"'));else{for(let hn=0;hn<xr.length;hn++){const Oi=xr[hn];Oi==='"'&&(hn===0||xr[hn-1]!=="\\")?Na=!Na:Oi===er&&!Na?(Hr.push(Ra.trim().replace(/^"|"$/g,"").replace(/""/g,'"')),Ra=""):Ra+=Oi}Hr.push(Ra.trim().replace(/^"|"$/g,"").replace(/""/g,'"'))}const Xi={};return mr.forEach((hn,Oi)=>{Xi[hn]=Hr[Oi]||""}),Xi});if(console.log("Converted object data:",en),en.length===0){alert("The CSV file has headers but no data rows."),Vr(!1);return}const Yt=[];if(en.forEach((xr,Hr)=>{(!xr.Name||!xr.Code)&&Yt.push(`Row ${Hr+2}: Missing Name or Code`),xr["Minimum Stock"]&&xr["Minimum Stock"].toString().trim()!==""&&isNaN(Number(xr["Minimum Stock"]))&&Yt.push(`Row ${Hr+2}: Minimum Stock must be a number`),xr.MOQ&&xr.MOQ.toString().trim()!==""&&isNaN(Number(xr.MOQ))&&Yt.push(`Row ${Hr+2}: MOQ must be a number`),xr["GST %"]&&xr["GST %"].toString().trim()!==""&&isNaN(Number(xr["GST %"]))&&Yt.push(`Row ${Hr+2}: GST % must be a number`),xr["Purchase Cost"]&&xr["Purchase Cost"].toString().trim()!==""&&isNaN(Number(xr["Purchase Cost"]))&&Yt.push(`Row ${Hr+2}: Purchase Cost must be a number`),xr["Sales Price"]&&xr["Sales Price"].toString().trim()!==""&&isNaN(Number(xr["Sales Price"]))&&Yt.push(`Row ${Hr+2}: Sales Price must be a number`),xr.Stock&&xr.Stock.toString().trim()!==""&&isNaN(Number(xr.Stock))&&Yt.push(`Row ${Hr+2}: Stock must be a number`),xr["Lead Time"]&&xr["Lead Time"].toString().trim()!==""&&isNaN(Number(xr["Lead Time"]))&&Yt.push(`Row ${Hr+2}: Lead Time must be a number`),xr.Status&&xr.Status.toString().trim()!==""&&!["Active","Inactive"].includes(xr.Status)&&Yt.push(`Row ${Hr+2}: Status must be 'Active' or 'Inactive'`)}),Yt.length>0){const xr=`Found ${Yt.length} potential issue(s). You can review and fix them in the preview:

${Yt.slice(0,5).join(`
`)}${Yt.length>5?`

...and ${Yt.length-5} more issues.`:""}`;console.warn("CSV validation warnings:",xr)}console.log("Refreshing metadata before opening preview dialog...");try{await et()?console.log("Successfully fetched dropdown data for import preview"):(console.error("Failed to fetch dropdown data for import preview"),alert("Failed to load dropdown data for import preview. Some dropdown options may not work correctly.")),xn(en);const Hr=new Set(en.map((Na,Ra)=>Ra));Qn(Hr),wr(!1),yn(!0),Vr(!1)}catch(xr){console.error("Error preparing import preview:",xr),alert("Error preparing import preview: "+(xr.message||"Unknown error")),Vr(!1)}}catch(At){console.error("Error importing products:",At),alert(`Failed to import products: ${At.message}`),Vr(!1)}},st.readAsText(Nr)}catch(st){console.error("Error reading file:",st),alert("Failed to read the selected file."),Vr(!1)}},$a=r.map(st=>st.ID),la=$a.length>0&&$a.every(st=>ke.includes(st)),ja=$a.some(st=>ke.includes(st))&&!la,mn=st=>{const Wt=[],At=["Name","Code","HSN Code","Importance","Product Type","Category","Product Mode","Status"];return st.forEach((Xt,ht)=>{const er=[],mr=xr=>{if(Xt[xr]!==void 0)return Xt[xr];if(Xt[`${xr} *`]!==void 0)return Xt[`${xr} *`];const Hr=xr.toLowerCase().replace(/\s+/g,"").replace(/\*/g,"");for(const Na in Xt)if(Na.toLowerCase().replace(/\s+/g,"").replace(/\*/g,"")===Hr)return Xt[Na]};At.forEach(xr=>{const Hr=mr(xr);(!Hr||Hr.toString().trim()==="")&&er.push(`${xr} is mandatory and cannot be empty`)}),["Minimum Stock","MOQ","GST %","Purchase Cost","Sales Price","Stock","Lead Time"].forEach(xr=>{const Hr=mr(xr);Hr&&Hr.toString().trim()!==""&&isNaN(Number(Hr))&&er.push(`${xr} must be a valid number`)});const Mr=mr("Status");Mr&&!["Active","Inactive"].includes(Mr)&&er.push('Status must be "Active" or "Inactive"');const Wr=mr("Importance");Wr&&!["Normal","High","Critical"].includes(Wr)&&er.push('Importance must be "Normal", "High", or "Critical"');const _n=mr("Product Type");_n&&!["All","Finished Goods","Semi-Finished Goods","Raw Materials"].includes(_n)&&er.push('Product Type must be "All", "Finished Goods", "Semi-Finished Goods", or "Raw Materials"');const en=mr("Product Mode");en&&!["Purchase","Internal Manufacturing","Both"].includes(en)&&er.push('Product Mode must be "Purchase", "Internal Manufacturing", or "Both"');const Yt=mr("HSN Code");if(Yt&&!l.some(Hr=>String(Hr.Code||Hr.code||"").trim()===String(Yt).trim())){const Hr=l.map(Na=>Na.Code||Na.code).filter(Boolean).slice(0,10).join(", ");er.push(`HSN Code "${Yt}" does not exist. Available options include: ${Hr||"None"}...`)}er.length>0&&Wt.push({row:ht+1,data:Xt,errors:er})}),Wt},Or=async()=>{var st;Vr(!0);try{const Wt=on.filter((ar,Mr)=>oa.has(Mr));if(Wt.length===0){alert("No rows selected for import. Please select at least one row."),Vr(!1);return}const At=mn(Wt);if(At.length>0){try{pr(ur(At,Wt))}catch(ar){console.error("Failed to build field error map from validation errors",ar)}jr({type:"validation_error",totalRows:Wt.length,successCount:0,errorCount:At.length,errors:At,successes:[]}),$n(!0),Vr(!1);return}const Xt=Wt.map(ar=>{const Mr={};return Object.keys(ar).forEach(Wr=>{const _n=Wr.replace(/\s*\*\s*/g,"").trim();Mr[_n]=ar[Wr]}),Mr});console.log("Sending import data (selected rows):",Xt);const ht=await ut.post(`${Je}/api/products/import`,Xt,{headers:{"Content-Type":"application/json"}});console.log("Import response:",ht.data);const er=[];ht.data.errors&&Array.isArray(ht.data.errors)&&ht.data.errors.forEach(ar=>{const Mr=ar.match(/^Row (\d+):\s*(.+)$/);if(Mr){const Wr=parseInt(Mr[1],10),_n=Mr[2],en=Wr-1,Yt=Xt[en]||{};er.push({row:Wr,data:Yt,productName:Yt.Name||"N/A",code:Yt.Code||"N/A",errors:[_n]})}else er.push({row:"N/A",data:{},productName:"N/A",code:"N/A",errors:[ar]})});const mr={type:"import_complete",totalRows:Wt.length,successCount:ht.data.imported||0,errorCount:er.length,errors:er,successes:ht.data.successes||[],skipped:ht.data.skipped||0};try{pr(ur(er,Xt))}catch(ar){console.error("Failed to build field error map from backend errors",ar)}yn(!1),er.length===0&&(Dr(null),xn([]),Qn(new Set),pr({})),jr(mr),$n(!0),ht.data.imported>0&&(q(0),L(S),H({name:"",code:"",productType:"",productMode:"",stock:"",moq:"",leadTime:"",note:"",color:"",size:"",sku:"",barcode:"",purchaseCost:"",salesPrice:""}),V(null),Z(null),re(null),ne(null),K(null),ye("all"),console.log("Resetting filters and triggering product refresh after successful import..."),ce({...S}),ue(ar=>{const Mr=ar+1;return console.log("Force refresh triggered, new value:",Mr),Mr}),setTimeout(()=>{console.log("Explicitly fetching products after import..."),Qe()},300))}catch(Wt){console.error("Error importing products:",Wt),console.error("Error response:",Wt.response);let At="Unknown server error",Xt=[];(st=Wt.response)!=null&&st.data?(Wt.response.data.error?At=Wt.response.data.error:Wt.response.data.message&&(At=Wt.response.data.message),Wt.response.data.errors&&Array.isArray(Wt.response.data.errors)&&Wt.response.data.errors.forEach(ht=>{const er=ht.match(/^Row (\d+):\s*(.+)$/);if(er){const mr=parseInt(er[1],10),ar=er[2];Xt.push({row:mr,productName:"N/A",code:"N/A",errors:[ar]})}else Xt.push({row:"N/A",productName:"N/A",code:"N/A",errors:[ht]})})):Wt.message&&(At=Wt.message),jr({type:"import_failed",totalRows:on.filter((ht,er)=>oa.has(er)).length,successCount:0,errorCount:Xt.length>0?Xt.length:1,errors:Xt.length>0?Xt:[{row:"Server Error",productName:"N/A",code:"N/A",errors:[At]}],successes:[]}),$n(!0)}finally{Vr(!1)}},wa=async()=>{var st,Wt;try{console.log("Direct API check - fetching all products without filters"),R(!0);const At=await ut.get(`${Je}/api/products`,{params:{page:1,limit:50},timeout:15e3});console.log("Direct API check - Status:",At.status),console.log("Direct API check - Response:",At.data);const Xt=!At||!At.data?[]:Array.isArray(At.data.data)?At.data.data:At.data.data==null?[]:Array.isArray(At.data)?At.data:[];console.log("Direct API check - Products found:",Xt.length),t(Xt),I(((st=At==null?void 0:At.data)==null?void 0:st.total)||0),k(((Wt=At==null?void 0:At.data)==null?void 0:Wt.totalCost)||0)}catch(At){console.error("Error in direct API check:",At),t([]),alert("API check failed: "+(At.message||"Unknown error"))}finally{R(!1)}};return a.jsxs(Ut,{p:3,children:[a.jsxs(Ut,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[a.jsx(Et,{variant:"h5",children:" Product Master"}),a.jsxs(Ut,{display:"flex",gap:2,alignItems:"center",children:[_&&a.jsxs(Et,{variant:"body2",color:"text.secondary",sx:{display:"flex",alignItems:"center"},children:[a.jsx(Vs,{size:16,sx:{mr:1}}),"Loading..."]}),a.jsx(bs,{title:"Refresh Products",children:a.jsx(Br,{variant:"outlined",color:"primary",startIcon:a.jsx(Iz,{}),onClick:()=>{console.log("Manual refresh triggered"),A(null),Qe()},disabled:_,children:"Refresh"})}),a.jsx(Br,{variant:"outlined",color:"primary",onClick:wa,disabled:_,children:"Check API"})]})]}),console.log("Display prefs anchor:",_e,"Open:",!!_e),a.jsx(Rie,{columns:fe,setColumns:ve,anchorEl:_e,open:!!_e,onClose:Se}),a.jsx(G0,{open:Fe,title:"Delete product",message:(()=>{if(!me)return"Are you sure you want to delete this product? This action cannot be undone.";const st=r.find(Xt=>[Xt.ID,Xt.id,Xt.Code,Xt.code,Xt.SKU,Xt.sku].some(er=>er!=null&&(er===me||String(er)===String(me)))),Wt=(st==null?void 0:st.Name)??(st==null?void 0:st.name)??(st==null?void 0:st.ProductName)??"this product",At=(st==null?void 0:st.Code)??(st==null?void 0:st.code)??(st==null?void 0:st.SKU)??(st==null?void 0:st.sku)??"";return st?`Are you sure you want to delete product "${Wt}"${At?` (code: ${At})`:""}? This action cannot be undone.`:`Are you sure you want to delete product #${me}? This action cannot be undone.`})(),onCancel:jn,onConfirm:Kt}),a.jsxs(Oa,{open:_t,onClose:()=>ot(!1),maxWidth:"sm",fullWidth:!0,children:[a.jsx(Wa,{sx:{bgcolor:"#f44336",color:"white",fontWeight:"bold"},children:zt}),a.jsxs(Pa,{sx:{pt:2},children:[a.jsx(Et,{variant:"body1",sx:{mb:2},children:xt}),zt.includes("Cannot Delete")&&a.jsxs(Ut,{sx:{bgcolor:"#fff3cd",p:2,borderRadius:1,mt:2},children:[a.jsx(Et,{variant:"subtitle2",sx:{fontWeight:"bold",mb:1},children:"What you can do:"}),a.jsx(Et,{component:"div",variant:"body2",sx:{ml:1},children:a.jsxs("ul",{style:{margin:"0.5rem 0",paddingLeft:"1.5rem"},children:[a.jsx("li",{children:"Remove this product from any related inventory or stock records like Quotation, CRM etc"}),a.jsx("li",{children:"After removing references, try deleting the product again"})]})})]})]}),a.jsx(Va,{children:a.jsx(Br,{onClick:()=>ot(!1),variant:"contained",color:"primary",children:"OK"})})]}),a.jsxs(Oa,{open:Re,onClose:Kr,maxWidth:"xl",fullWidth:!0,children:[a.jsxs(Wa,{className:"product-header",children:[a.jsx(Et,{component:"h2",variant:"h6",className:"product-title",children:"Product Details (Read-only)"}),a.jsxs(Et,{component:"span",variant:"subtitle2",className:`product-status ${Ne!=null&&Ne.IsActive||Ne!=null&&Ne.isActive?"active":"inactive"}`,children:["Status: ",Ne!=null&&Ne.IsActive||Ne!=null&&Ne.isActive?"Active":"Inactive"]})]}),a.jsx(Pa,{dividers:!0,className:"product-details-container",sx:{backgroundColor:"white",color:"black","& .MuiTypography-root":{color:"black"},"& table":{backgroundColor:"transparent"}},children:ae?a.jsx(Ut,{className:"loading-state",display:"flex",justifyContent:"center",p:2,children:a.jsx(Vs,{})}):Ne?a.jsxs(Ut,{className:"product-form",children:[a.jsxs(Ut,{className:"form-grid",children:[a.jsxs(Ut,{className:"form-field col-60",children:[a.jsx("label",{className:"field-label",children:"Product Name"}),a.jsx("input",{type:"text",className:"field-input multiline",value:Ne.Name??"",disabled:!0,readOnly:!0,title:Ne.Name??""})]}),a.jsxs(Ut,{className:"form-field col-20",children:[a.jsx("label",{className:"field-label",children:"Code"}),a.jsx("input",{type:"text",className:"field-input",value:Ne.Code??"",disabled:!0,readOnly:!0})]}),a.jsxs(Ut,{className:"form-field col-20",children:[a.jsx("label",{className:"field-label",children:"HSN/SAC Code"}),a.jsx("input",{type:"text",className:"field-input",value:Ne.HsnSacCode??Ne.HSN??Ne.hsn??"",disabled:!0,readOnly:!0})]})]}),a.jsxs(Ut,{className:"form-grid",children:[a.jsxs(Ut,{className:"form-field col-20",children:[a.jsx("label",{className:"field-label",children:"Importance"}),a.jsx("input",{type:"text",className:"field-input",value:Ne.Importance??Ne.importance??"",disabled:!0,readOnly:!0})]}),a.jsxs(Ut,{className:"form-field col-20",children:[a.jsx("label",{className:"field-label",children:"Minimum Stock"}),a.jsx("input",{type:"text",className:"field-input",value:Ne.MinimumStock??Ne.minimumStock??"",disabled:!0,readOnly:!0})]}),a.jsxs(Ut,{className:"form-field col-60",children:[a.jsx("label",{className:"field-label",children:"Category"}),a.jsx("input",{type:"text",className:"field-input multiline",value:((Vn=Ne.Category)==null?void 0:Vn.Name)??"",disabled:!0,readOnly:!0,title:((Xs=Ne.Category)==null?void 0:Xs.Name)??""})]})]}),a.jsxs(Ut,{className:"form-grid",children:[a.jsxs(Ut,{className:"form-field col-40",children:[a.jsx("label",{className:"field-label",children:"Subcategory"}),a.jsx("input",{type:"text",className:"field-input",value:((Qr=Ne.Subcategory)==null?void 0:Qr.Name)??"",disabled:!0,readOnly:!0})]}),a.jsxs(Ut,{className:"form-field col-20",children:[a.jsx("label",{className:"field-label",children:"Unit"}),a.jsx("input",{type:"text",className:"field-input",value:((qn=Ne.Unit)==null?void 0:qn.Name)||((ks=Ne.Unit)==null?void 0:ks.name)||Ne.unit_name||"",disabled:!0,readOnly:!0})]}),a.jsxs(Ut,{className:"form-field col-20",children:[a.jsx("label",{className:"field-label",children:"Store"}),a.jsx("input",{type:"text",className:"field-input",value:((wn=Ne.Store)==null?void 0:wn.Name)??"",disabled:!0,readOnly:!0})]}),a.jsxs(Ut,{className:"form-field col-20",children:[a.jsx("label",{className:"field-label",children:"Product Mode"}),a.jsx("input",{type:"text",className:"field-input",value:Ne.ProductMode??Ne.product_mode??"",disabled:!0,readOnly:!0})]})]}),a.jsxs(Ut,{className:"form-grid",children:[a.jsxs(Ut,{className:"form-field col-20",children:[a.jsx("label",{className:"field-label",children:"Product Type"}),a.jsx("input",{type:"text",className:"field-input",value:Ne.ProductType??Ne.productType??"",disabled:!0,readOnly:!0})]}),a.jsxs(Ut,{className:"form-field col-20",children:[a.jsx("label",{className:"field-label",children:"MOQ"}),a.jsx("input",{type:"text",className:"field-input",value:Ne.MOQ??Ne.MinimumOrderQuantity??Ne.moq??Ne.Moq??"",disabled:!0,readOnly:!0})]}),a.jsxs(Ut,{className:"form-field col-20",children:[a.jsx("label",{className:"field-label",children:"Tax"}),a.jsx("input",{type:"text",className:"field-input",value:((ka=Ne.Tax)==null?void 0:ka.Name)??((Xn=Ne.Tax)==null?void 0:Xn.name)??(Ne.tax||""),disabled:!0,readOnly:!0})]}),a.jsxs(Ut,{className:"form-field col-20",children:[a.jsx("label",{className:"field-label",children:"GST %"}),a.jsx("input",{type:"text",className:"field-input",value:Ne.GstPercent??Ne.gstPercent??"",disabled:!0,readOnly:!0})]})]}),a.jsx(Ut,{className:"form-grid",children:a.jsxs(Ut,{className:"form-field col-100",children:[a.jsx("label",{className:"field-label",children:"Tags"}),a.jsx("input",{type:"text",className:"field-input multiline",value:Array.isArray(Ne.Tags)&&Ne.Tags.length>0?Ne.Tags.map(st=>(st==null?void 0:st.Name)||(st==null?void 0:st.name)||"").filter(Boolean).join(", "):Ne.tag||Ne.Tag||"",disabled:!0,readOnly:!0,placeholder:"No tags assigned"})]})}),a.jsxs(Ut,{className:"form-grid",children:[a.jsxs(Ut,{className:"form-field col-60",children:[a.jsx("label",{className:"field-label",children:"Description"}),a.jsx("textarea",{className:"field-input multiline",value:Ne.Description??Ne.description??"",disabled:!0,readOnly:!0,rows:"3"})]}),a.jsxs(Ut,{className:"form-field col-40",children:[a.jsx("label",{className:"field-label",children:"Internal Notes"}),a.jsx("textarea",{className:"field-input multiline",value:Ne.InternalNotes??Ne.internalNotes??"",disabled:!0,readOnly:!0,rows:"3"})]})]}),a.jsxs(Ut,{className:"variants-section",children:[a.jsxs(Ut,{className:"section-header",children:[a.jsx(Et,{variant:"subtitle2",className:"section-title",children:"Variants"}),Array.isArray(Ne.Variants)&&Ne.Variants.length>0&&a.jsxs(Ut,{className:"variant-count",children:[Ne.Variants.length," items"]})]}),Array.isArray(Ne.Variants)&&Ne.Variants.length>0?a.jsxs(Cs,{size:"small",className:"variants-table",children:[a.jsx(js,{children:a.jsxs(pn,{children:[a.jsx(qe,{align:"center",sx:{fontWeight:"bold"},children:"Color"}),a.jsx(qe,{align:"center",sx:{fontWeight:"bold"},children:"Size"}),a.jsx(qe,{align:"center",sx:{fontWeight:"bold"},children:"SKU"}),a.jsx(qe,{align:"center",sx:{fontWeight:"bold"},children:"Barcode"}),a.jsx(qe,{align:"center",sx:{fontWeight:"bold"},children:"Purchase Cost"}),a.jsx(qe,{align:"center",sx:{fontWeight:"bold"},children:"Sales Price"}),a.jsx(qe,{align:"center",sx:{fontWeight:"bold"},children:"Stock"}),a.jsx(qe,{align:"center",sx:{fontWeight:"bold"},children:"Lead Time"}),a.jsx(qe,{align:"center",sx:{fontWeight:"bold"},children:"Images"})]})}),a.jsx(fs,{children:Ne.Variants.map((st,Wt)=>{const At=nj(st.Color||st.ColorCaption);return a.jsxs(pn,{children:[a.jsx(qe,{align:"center",children:a.jsxs(Ut,{display:"flex",alignItems:"center",gap:1,children:[At&&a.jsxs(a.Fragment,{children:[a.jsx(Ut,{sx:{width:24,height:24,backgroundColor:At.hex,border:"1px solid #ccc",borderRadius:"4px",flexShrink:0},title:`Hex: ${At.hex}`}),a.jsx(Et,{variant:"body2",children:At.name})]}),!At&&a.jsx(Et,{variant:"body2",children:st.Color??st.ColorCaption??""})]})}),a.jsx(qe,{align:"center",children:st.Size??""}),a.jsx(qe,{align:"center",children:st.SKU??""}),a.jsx(qe,{align:"center",children:st.Barcode??""}),a.jsx(qe,{align:"center",children:st.PurchaseCost!=null?String(st.PurchaseCost):""}),a.jsx(qe,{align:"center",children:st.SalesPrice!=null?String(st.SalesPrice):""}),a.jsx(qe,{align:"center",children:st.stock!=null?String(st.stock):""}),a.jsx(qe,{align:"center",children:st.LeadTime??""}),a.jsx(qe,{align:"center",className:"images-cell",children:a.jsx(Ut,{display:"flex",flexWrap:"wrap",gap:1,alignItems:"center",justifyContent:"center",children:Array.isArray(st.Images)&&st.Images.length>0?st.Images.map((Xt,ht)=>{const er=t2(Xt)||"https://via.placeholder.com/60?text=No+Image",mr=typeof st.MainImageIndex=="number"&&st.MainImageIndex===ht||st.MainImage&&st.MainImage===Xt;return a.jsxs(Ut,{className:"image-container",children:[a.jsx("a",{href:er,target:"_blank",rel:"noopener noreferrer",title:"Open image in new tab",children:a.jsx("img",{src:er,alt:`img-${ht}`,style:{width:60,height:60,objectFit:"cover",borderRadius:4,border:"1px solid #ccc",cursor:"pointer"},onError:ar=>{ar.target.src="https://via.placeholder.com/60?text=No+Image"}})}),mr&&a.jsx(Ut,{className:"main-image-badge",title:"Main image",children:a.jsx(Pz,{fontSize:"small",color:"warning"})})]},ht)}):a.jsx(Et,{variant:"caption",color:"textSecondary",className:"no-images",children:"No images"})})})]},st.ID??st.SKU??Wt)})})]}):a.jsx(Ut,{className:"no-variants",children:a.jsx(Et,{color:"textSecondary",children:"No variants available for this product."})})]}),a.jsx(Tv,{})]}):a.jsx(Et,{color:"textSecondary",children:"No product data available."})}),a.jsxs(Va,{className:"dialog-actions",children:[a.jsx(Br,{onClick:Kr,className:"btn-secondary",children:"Close"}),a.jsx(Br,{onClick:()=>{Kr(),e(`/products/${Ne==null?void 0:Ne.ID}/edit`)},variant:"contained",color:"primary",children:"Edit Product"})]})]}),a.jsxs(Oa,{open:Ar,onClose:()=>{wr(!1),Dr(null),Vr(!1)},maxWidth:"md",fullWidth:!0,children:[a.jsx(Wa,{children:"Import Products"}),a.jsxs(Pa,{children:[a.jsxs(Ut,{sx:{mb:2},children:[a.jsx(Et,{variant:"subtitle2",sx:{fontWeight:600,mb:1},children:"Instructions:"}),a.jsxs("ul",{style:{marginTop:0,marginBottom:8,paddingLeft:"1.25rem"},children:[a.jsx("li",{children:a.jsx(Et,{component:"span",variant:"body2",children:"Download the template Excel file below"})}),a.jsx("li",{children:a.jsx(Et,{component:"span",variant:"body2",children:"Fill in your user data following the template format"})}),a.jsx("li",{children:a.jsx(Et,{component:"span",variant:"body2",children:"Required fields are marked with asterisk (*)"})}),a.jsx("li",{children:a.jsx(Et,{component:"span",variant:"body2",children:"Unit, Store, Size, and Tax will be auto-created if they don't exist"})}),a.jsx("li",{children:a.jsx(Et,{component:"span",variant:"body2",children:"You can edit the info after upload the CSV file"})}),a.jsx("li",{children:a.jsx(Et,{component:"span",variant:"body2",color:"error",children:"Upload the completed CSV file"})})]})]}),a.jsx(Et,{variant:"body2",color:"textSecondary",sx:{mb:2},children:"Import products from a CSV file. Make sure you have downloaded the template and filled it correctly."}),a.jsx("input",{type:"file",accept:".csv",onChange:st=>Dr(st.target.files[0]),style:{marginBottom:"16px"}}),Nr&&a.jsxs(Et,{variant:"body2",sx:{mb:2},children:["Selected file: ",Nr.name]}),a.jsx(Ut,{sx:{mb:2},children:a.jsx(Et,{variant:"body2",color:"primary",sx:{cursor:"pointer"},onClick:()=>fn(),children:" Download template Excel file"})})]}),a.jsxs(Va,{children:[a.jsx(Br,{onClick:()=>wr(!1),children:"Cancel"}),a.jsx(Br,{variant:"contained",color:"primary",onClick:rn,disabled:!Nr||Yr,children:Yr?a.jsx(Vs,{size:20}):"Import"})]})]}),a.jsx(Ut,{sx:{mb:2,p:2,bgcolor:"background.paper",borderRadius:1,boxShadow:1},children:a.jsxs(is,{container:!0,spacing:2,alignItems:"center",justifyContent:"space-between",children:[a.jsx(is,{item:!0,xs:"auto",children:a.jsxs(Et,{variant:"body1",children:["Total Products: ",P,a.jsx("br",{}),"Total Cost: ",U.toFixed(2)]})}),a.jsxs(is,{item:!0,xs:"auto",sx:{display:"flex",alignItems:"center",gap:1},children:[a.jsxs("div",{className:"search-wrapper",children:[a.jsx("input",{className:"custom-search",placeholder:"Search",value:ge,onChange:st=>De(st.target.value)}),ge?a.jsx("button",{type:"button",className:"search-clear",onClick:()=>De(""),children:"Clear"}):null]}),a.jsxs(Ut,{display:"flex",alignItems:"center",gap:1,ml:2,children:[a.jsx(Br,{variant:"outlined",startIcon:a.jsx(D6,{}),onClick:()=>wr(!0),sx:{minWidth:"auto",px:2},children:"Import"}),a.jsx(Br,{variant:"outlined",startIcon:a.jsx(Dz,{}),onClick:st=>ft(st.currentTarget),sx:{minWidth:"auto",px:2},children:"Export"})]})]})]})}),a.jsxs(sa,{children:[j&&a.jsx(Ut,{sx:{p:2,mb:2,bgcolor:"#ffebee",color:"#d32f2f",borderRadius:"4px"},children:a.jsxs(Et,{variant:"body1",sx:{display:"flex",alignItems:"center"},children:["Error: ",j,a.jsx(Br,{variant:"outlined",color:"error",size:"small",sx:{ml:2},onClick:()=>{A(null),wa()},children:"Try Again"})]})}),a.jsxs(Ws,{sx:{position:"relative"},children:[_&&a.jsx(Ut,{position:"absolute",top:4,right:8,zIndex:2,children:a.jsx(Vs,{size:18})}),a.jsxs(Cs,{size:"small",children:[a.jsxs(js,{children:[a.jsxs(pn,{children:[a.jsx(qe,{sx:{width:60},children:a.jsx(Wn,{size:"small",checked:la,indeterminate:ja,onChange:St})}),a.jsx(qe,{sx:{fontWeight:"bold",width:60},children:"SL"}),fe.name&&a.jsx(qe,{sx:{fontWeight:"bold",minWidth:200},children:a.jsxs(Ut,{display:"flex",alignItems:"center",gap:.5,children:["Name",a.jsx(sn,{size:"small",onClick:()=>gt("asc"),color:N==="asc"?"primary":"default",sx:{p:.25},children:a.jsx(O1,{fontSize:"inherit",sx:{color:N==="asc"?"primary.main":"inherit",opacity:N==="asc"?1:.5}})}),a.jsx(sn,{size:"small",onClick:()=>gt("desc"),color:N==="desc"?"primary":"default",sx:{p:.25},children:a.jsx(I1,{fontSize:"inherit",sx:{color:M==="desc"?"primary.main":"inherit",opacity:M==="desc"?1:.5}})})]})}),fe.code&&a.jsx(qe,{sx:{fontWeight:"bold",minWidth:200},children:"Code"}),fe.category&&a.jsx(qe,{sx:{fontWeight:"bold",minWidth:200},children:"Category"}),fe.subcategory&&a.jsx(qe,{sx:{fontWeight:"bold",minWidth:200},children:"Subcategory"}),fe.store&&a.jsx(qe,{sx:{fontWeight:"bold",minWidth:200},children:"Store"}),fe.productType&&a.jsx(qe,{sx:{fontWeight:"bold",minWidth:200},children:"Product Type"}),fe.productMode&&a.jsx(qe,{sx:{fontWeight:"bold",minWidth:200},children:"Product Mode"}),fe.stock&&a.jsx(qe,{align:"center",sx:{fontWeight:"bold",minWidth:150},children:a.jsxs(Ut,{display:"flex",justifyContent:"center",alignItems:"center",gap:.5,children:["Stock",a.jsx(sn,{size:"small",onClick:()=>xe("asc"),color:M==="asc"?"primary":"default",sx:{p:.25},"aria-label":"Sort stock ascending",children:a.jsx(O1,{fontSize:"inherit",sx:{color:M==="asc"?"primary.main":"inherit",opacity:M==="asc"?1:.5}})}),a.jsx(sn,{size:"small",onClick:()=>xe("desc"),color:M==="desc"?"primary":"default",sx:{p:.25},"aria-label":"Sort stock descending",children:a.jsx(I1,{fontSize:"inherit",sx:{color:M==="desc"?"primary.main":"inherit",opacity:M==="desc"?1:.5}})})]})}),fe.minimumStock&&a.jsx(qe,{align:"center",sx:{fontWeight:"bold",minWidth:150},children:"Minimum Stock"}),fe.moq&&a.jsx(qe,{align:"center",sx:{fontWeight:"bold",minWidth:150},children:"MOQ"}),fe.leadTime&&a.jsx(qe,{align:"center",sx:{fontWeight:"bold",minWidth:200},children:a.jsxs(Ut,{display:"flex",justifyContent:"center",alignItems:"center",gap:.5,children:["Lead Time",a.jsx(sn,{size:"small",onClick:()=>Oe("asc"),color:J==="asc"?"primary":"default",sx:{p:.25},"aria-label":"Sort lead time ascending",children:a.jsx(O1,{fontSize:"inherit",sx:{color:J==="asc"?"primary.main":"inherit",opacity:J==="asc"?1:.5}})}),a.jsx(sn,{size:"small",onClick:()=>Oe("desc"),color:J==="desc"?"primary":"default",sx:{p:.25},"aria-label":"Sort lead time descending",children:a.jsx(I1,{fontSize:"inherit",sx:{color:J==="desc"?"primary.main":"inherit",opacity:J==="desc"?1:.5}})})]})}),fe.note&&a.jsx(qe,{sx:{fontWeight:"bold",minWidth:150},children:"Note"}),fe.status&&a.jsx(qe,{sx:{fontWeight:"bold",minWidth:150},children:"Status"}),fe.importance&&a.jsx(qe,{sx:{fontWeight:"bold",minWidth:150},children:"Importance"}),fe.tag&&a.jsx(qe,{sx:{fontWeight:"bold",minWidth:200},children:"Tag"}),fe.description&&a.jsx(qe,{sx:{fontWeight:"bold",minWidth:200},children:"Description"}),fe.color&&a.jsx(qe,{align:"center",sx:{fontWeight:"bold",minWidth:200},children:"Color Code"}),fe.size&&a.jsx(qe,{align:"center",sx:{fontWeight:"bold",minWidth:200},children:"Size"}),fe.sku&&a.jsx(qe,{align:"center",sx:{fontWeight:"bold",minWidth:200},children:"SKU"}),fe.barcode&&a.jsx(qe,{sx:{fontWeight:"bold",minWidth:200},children:"Barcode"}),fe.purchaseCost&&a.jsx(qe,{align:"center",sx:{fontWeight:"bold",minWidth:200},children:a.jsxs(Ut,{display:"flex",justifyContent:"center",alignItems:"center",gap:.5,children:["Purchase Cost",a.jsx(sn,{size:"small",onClick:()=>Ce("asc"),color:X==="asc"?"primary":"default",sx:{p:.25},"aria-label":"Sort purchase cost ascending",children:a.jsx(O1,{fontSize:"inherit",sx:{color:X==="asc"?"primary.main":"inherit",opacity:X==="asc"?1:.5}})}),a.jsx(sn,{size:"small",onClick:()=>Ce("desc"),color:X==="desc"?"primary":"default",sx:{p:.25},"aria-label":"Sort purchase cost descending",children:a.jsx(I1,{fontSize:"inherit",sx:{color:X==="desc"?"primary.main":"inherit",opacity:X==="desc"?1:.5}})})]})}),fe.salesPrice&&a.jsx(qe,{align:"center",sx:{fontWeight:"bold",minWidth:200},children:a.jsxs(Ut,{display:"flex",justifyContent:"center",alignItems:"center",gap:.5,children:["Sales Price",a.jsx(sn,{size:"small",onClick:()=>de("asc"),color:Y==="asc"?"primary":"default",sx:{p:.25},"aria-label":"Sort sales price ascending",children:a.jsx(O1,{fontSize:"inherit",sx:{color:Y==="asc"?"primary.main":"inherit",opacity:Y==="asc"?1:.5}})}),a.jsx(sn,{size:"small",onClick:()=>de("desc"),color:Y==="desc"?"primary":"default",sx:{p:.25},"aria-label":"Sort sales price descending",children:a.jsx(I1,{fontSize:"inherit",sx:{color:Y==="desc"?"primary.main":"inherit",opacity:Y==="desc"?1:.5}})})]})}),fe.image&&a.jsx(qe,{sx:{fontWeight:"bold",width:120},children:"Image"}),fe.actions&&a.jsx(qe,{sx:{fontWeight:"bold",width:150,textAlign:"center"},children:"Actions"})]}),a.jsx(Nie,{inputFilters:O,setInputFilters:H,filters:C,setFilters:L,categories:n,allSubcategories:o,stores:c,setPage:q,stockFilter:pe,setStockFilter:ye,visibleColumns:fe,handleExport:Gr,setImportDialogOpen:wr,autocompleteOptions:He,autocompleteLoading:at,autocompleteOpen:Me,setAutocompleteOpen:tt,setAutocompleteOptions:Xe,onAutocompleteInputChange:(st,Wt)=>{switch(st){case"names":kt(Wt);break;case"codes":kr(Wt);break;case"stocks":Jt(Wt);break;case"moqs":Pt(Wt);break;case"leadTimes":Ur(Wt);break;case"notes":Lr(Wt);break;case"tags":vt(Wt);break;case"descriptions":nr(Wt);break;case"colors":Cr(Wt);break;case"sizes":Dt(Wt);break;case"skus":je(Wt);break;case"barcodes":ct(Wt);break;case"purchaseCosts":nt(Wt);break;case"salesPrices":Pe(Wt);break}},exportAnchorEl:Bt,setExportAnchorEl:ft,exportMenuOpen:tr})]}),a.jsx(Eie,{products:r,navigate:e,loading:_,visibleColumns:fe,onView:Rr,page:z,limit:D,selectedIds:ke,onToggleOne:Ze,onDelete:sr,exportAnchorEl:Bt,setExportAnchorEl:ft,exportMenuOpen:tr,handleExport:Gr,commonSearch:ge})]})]}),a.jsxs(Ut,{p:2,display:"flex",justifyContent:"space-between",alignItems:"center",children:[a.jsxs(Ut,{display:"flex",gap:2,children:[a.jsx(Br,{variant:"contained",color:"warning",onClick:()=>e("/ManageProduct"),children:"+ Add Product"}),a.jsx(Br,{variant:"outlined",color:"primary",startIcon:a.jsx(Fz,{}),onClick:be,"aria-label":"Display Preferences",size:"small",children:"Display Preferences"})]}),a.jsx(Zm,{component:"div",count:P,page:z,onPageChange:(st,Wt)=>q(Wt),rowsPerPage:D,onRowsPerPageChange:st=>{W(parseInt(st.target.value,10)),q(0)},rowsPerPageOptions:[5,10,25]})]})]}),a.jsxs(Oa,{open:ia,onClose:(st,Wt)=>{Wt==="backdropClick"||Wt==="escapeKeyDown"||yn(!1)},maxWidth:"xl",fullWidth:!0,onEnter:async()=>{var Wt,At,Xt,ht,er,mr,ar;console.log("Import Preview Dialog opened");const st=(n==null?void 0:n.length)>0&&(o==null?void 0:o.length)>0&&(c==null?void 0:c.length)>0&&(l==null?void 0:l.length)>0&&(h==null?void 0:h.length)>0&&(p==null?void 0:p.length)>0;if(console.log("Current dropdown data status:"),console.log("- Categories:",(n==null?void 0:n.length)||0),console.log("- Subcategories:",(o==null?void 0:o.length)||0),console.log("- Stores:",(c==null?void 0:c.length)||0),console.log("- HSN Codes:",(l==null?void 0:l.length)||0),console.log("- Units:",(h==null?void 0:h.length)||0),console.log("- Sizes:",(p==null?void 0:p.length)||0),on.length>0&&console.log("CSV Column Keys:",Object.keys(on[0])),!st){console.log("Some dropdown data is missing, fetching from backend...");try{if(!(l!=null&&l.length)){console.log("Directly fetching HSN codes...");const _n=((Wt=(await ut.get(`${Je}/api/hsncode`)).data)==null?void 0:Wt.data)||[];if(Array.isArray(_n)&&_n.length>0){console.log("Successfully fetched HSN codes:",_n.length),console.log("Sample HSN code:",_n[0]);const en=_n.map(Yt=>({id:Yt.id,code:String(Yt.code||""),tax_id:Yt.tax_id,Tax:Yt.Tax||{},tax:Yt.Tax||{}}));d(en)}}const Mr=await et();Mr?(console.log("Successfully fetched dropdown data in dialog open"),console.log("Updated dropdown data counts:"),console.log("- Categories:",((At=Mr.categories)==null?void 0:At.length)||0),console.log("- Subcategories:",((Xt=Mr.subcategories)==null?void 0:Xt.length)||0),console.log("- Stores:",((ht=Mr.stores)==null?void 0:ht.length)||0),console.log("- HSN Codes:",((er=Mr.hsnCodes)==null?void 0:er.length)||0),console.log("- Units:",((mr=Mr.units)==null?void 0:mr.length)||0),console.log("- Sizes:",((ar=Mr.sizes)==null?void 0:ar.length)||0)):console.error("Failed to fetch dropdown data in dialog open")}catch(Mr){console.error("Error fetching dropdown data in dialog:",Mr)}}},children:[a.jsx(Wa,{children:a.jsxs(Ut,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[a.jsx(Et,{variant:"h6",children:"Preview and Edit Import Data"}),a.jsxs(Et,{variant:"subtitle2",color:"textSecondary",children:[on.length," records to import"]})]})}),a.jsxs(Pa,{children:[a.jsx(Et,{variant:"body2",color:"textSecondary",sx:{mb:2},children:"Review and edit the data before finalizing the import. Click on any cell to edit directly in the table. New units, stores, sizes, and taxes will be automatically created if they don't exist."}),a.jsx(Ws,{component:sa,sx:{maxHeight:600},children:a.jsxs(Cs,{stickyHeader:!0,size:"small",children:[a.jsx(js,{children:a.jsxs(pn,{children:[a.jsx(qe,{sx:{width:60},children:a.jsx(Wn,{size:"small",checked:on.length>0&&oa.size===on.length,indeterminate:oa.size>0&&oa.size<on.length,onChange:st=>{st.target.checked?Qn(new Set(on.map((Wt,At)=>At))):Qn(new Set)}})}),a.jsx(qe,{sx:{fontWeight:"bold"},children:"No."}),on.length>0&&Object.keys(on[0]).map(st=>{const Wt=String(st).replace(/\s*\*\s*$/g,""),At=Wt.toLowerCase(),er=["name","code","hsn code","importance","product type","category","unit","product mode","store","status","tax"].includes(At)?`${Wt} *`:Wt,mr=At.replace(/\s+/g,"").replace(/[^\w]/g,""),Mr=["minstock","minimumstock","min_stock","minimum_stock","moq","tax","gst","purchasecost","salesprice","stock","leadtime"].includes(mr);return a.jsx(qe,{align:Mr?"center":void 0,sx:{fontWeight:"bold",textAlign:Mr?"center":void 0},children:er},st)})]})}),a.jsx(fs,{children:on.map((st,Wt)=>a.jsxs(pn,{hover:!0,children:[a.jsx(qe,{children:a.jsx(Wn,{size:"small",checked:oa.has(Wt),onChange:At=>{Qn(Xt=>{const ht=new Set(Xt);return At.target.checked?ht.add(Wt):ht.delete(Wt),ht})}})}),a.jsx(qe,{children:Wt+1}),Object.keys(st).map((At,Xt)=>{const er=At.toLowerCase().replace(/\s+/g,"").replace(/^hsn(code)?$/,"hsn").replace(/^hsnnum(ber)?$/,"hsn").replace(/^categoryname$/,"category").replace(/^subcategoryname$/,"subcategory").replace(/^storename$/,"store").replace(/^unitname$/,"unit").replace(/^sizename$/,"size"),mr=["category","subcategory","store","producttype","status","importance","hsn","unit","productmode","size"].includes(er);if(Wt===0&&(console.log(`Column "${At}": normalized="${er}", isDropdown=${mr}`),mr)){let ar=[],Mr=[];er==="category"&&Array.isArray(n)?(Mr=n,ar=n.map(Wr=>Wr.Name||Wr.name).filter(Boolean)):er==="subcategory"&&Array.isArray(o)?(Mr=o,ar=o.map(Wr=>Wr.Name||Wr.name).filter(Boolean)):er==="store"&&Array.isArray(c)?(Mr=c,ar=c.map(Wr=>Wr.Name||Wr.name).filter(Boolean)):er==="hsn"&&Array.isArray(l)?(Mr=l,ar=l.map(Wr=>Wr.code||Wr.Code||"").filter(Boolean)):er==="unit"&&Array.isArray(h)?(Mr=h,ar=h.map(Wr=>Wr.Name||Wr.name).filter(Boolean)):er==="size"&&Array.isArray(p)&&(Mr=p,ar=p.map(Wr=>Wr.Name||Wr.name).filter(Boolean)),console.log(`  - ${At}: ${Mr.length} items available, sample options:`,ar.slice(0,3))}return a.jsx(pK,{value:st[At],rowIndex:Wt,columnKey:At,row:st,onUpdate:(ar,Mr,Wr)=>{const _n=[...on];_n[ar]={..._n[ar],[Mr]:Wr},xn(_n);try{pr(en=>{if(!en)return en;const Yt={...en};if(Yt[ar]&&Yt[ar][Mr]){const{[Mr]:xr,...Hr}=Yt[ar];Object.keys(Hr).length===0?delete Yt[ar]:Yt[ar]=Hr}return Yt})}catch(en){console.error("Failed to clear import field error for",ar,Mr,en)}},categories:n,allSubcategories:o,stores:c,hsnCodes:l,units:h,sizes:p,tags:g,taxes:b,error:!!(za[Wt]&&za[Wt][At]),errorMessages:za[Wt]&&za[Wt][At]},`${Wt}-${Xt}`)})]},Wt))})]})})]}),a.jsxs(Va,{children:[a.jsx(Br,{onClick:()=>{yn(!1),xn([]),pr({})},children:"Cancel"}),a.jsx(Br,{variant:"contained",color:"primary",onClick:Or,disabled:Yr,children:Yr?a.jsx(Vs,{size:20}):"Finalize Import"})]})]}),a.jsxs(Oa,{open:Ir,onClose:()=>$n(!1),maxWidth:"md",fullWidth:!0,children:[a.jsx(Wa,{children:a.jsxs(Ut,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[a.jsx(Et,{variant:"h6",children:(Fr==null?void 0:Fr.type)==="validation_error"?"Validation Errors":(Fr==null?void 0:Fr.type)==="import_failed"?"Import Failed":"Import Report"}),a.jsx(Ut,{display:"flex",gap:2,children:(Fr==null?void 0:Fr.type)==="import_complete"&&a.jsxs(a.Fragment,{children:[a.jsxs(Et,{variant:"body2",color:"success.main",children:[" ",Fr.successCount," Imported"]}),Fr.errorCount>0&&a.jsxs(Et,{variant:"body2",color:"error.main",children:[" ",Fr.errorCount," Errors"]}),Fr.skipped>0&&a.jsxs(Et,{variant:"body2",color:"warning.main",children:[" ",Fr.skipped," Skipped"]})]})})]})}),a.jsx(Pa,{children:Fr&&a.jsxs(Ut,{children:[a.jsxs(Ut,{sx:{mb:3,p:2,bgcolor:"background.paper",borderRadius:1,border:"1px solid",borderColor:"divider"},children:[a.jsx(Et,{variant:"subtitle2",gutterBottom:!0,children:"Summary"}),a.jsxs(is,{container:!0,spacing:2,children:[a.jsxs(is,{item:!0,xs:3,children:[a.jsx(Et,{variant:"body2",color:"textSecondary",children:"Total Rows:"}),a.jsx(Et,{variant:"h6",children:Fr.totalRows})]}),a.jsxs(is,{item:!0,xs:3,children:[a.jsx(Et,{variant:"body2",color:"success.main",children:"Successful:"}),a.jsx(Et,{variant:"h6",color:"success.main",children:Fr.successCount})]}),a.jsxs(is,{item:!0,xs:3,children:[a.jsx(Et,{variant:"body2",color:"error.main",children:"Errors:"}),a.jsx(Et,{variant:"h6",color:"error.main",children:Fr.errorCount})]}),Fr.skipped>0&&a.jsxs(is,{item:!0,xs:3,children:[a.jsx(Et,{variant:"body2",color:"warning.main",children:"Skipped:"}),a.jsx(Et,{variant:"h6",color:"warning.main",children:Fr.skipped})]})]})]}),Fr.errors&&Fr.errors.length>0&&a.jsxs(Ut,{sx:{mb:3},children:[a.jsxs(Et,{variant:"subtitle2",color:"error.main",gutterBottom:!0,children:["Errors (",Fr.errors.length,")"]}),a.jsx(Ws,{component:sa,sx:{maxHeight:300},children:a.jsxs(Cs,{size:"small",children:[a.jsx(js,{children:a.jsxs(pn,{children:[a.jsx(qe,{sx:{fontWeight:"bold"},children:"Row"}),a.jsx(qe,{sx:{fontWeight:"bold"},children:"Product Name"}),a.jsx(qe,{sx:{fontWeight:"bold"},children:"Code"}),a.jsx(qe,{sx:{fontWeight:"bold"},children:"Error Details"})]})}),a.jsx(fs,{children:Fr.errors.map((st,Wt)=>{var At,Xt;return a.jsxs(pn,{children:[a.jsx(qe,{children:st.row||"N/A"}),a.jsx(qe,{children:st.productName||((At=st.data)==null?void 0:At.Name)||"N/A"}),a.jsx(qe,{children:st.code||((Xt=st.data)==null?void 0:Xt.Code)||"N/A"}),a.jsx(qe,{children:a.jsx(Ut,{children:Array.isArray(st.errors)?st.errors.map((ht,er)=>{const mr=ht.includes("mandatory")||ht.includes("required"),ar=ht.includes("not found")||ht.includes("does not exist"),Mr=ht.includes("already exists");return a.jsxs(Et,{variant:"body2",color:"error.main",sx:{mb:.5,fontWeight:mr||ar||Mr?600:400,bgcolor:mr?"rgba(255, 152, 0, 0.1)":ar?"rgba(244, 67, 54, 0.1)":Mr?"rgba(156, 39, 176, 0.1)":"transparent",px:mr||ar||Mr?1:0,py:mr||ar||Mr?.5:0,borderRadius:mr||ar||Mr?1:0},children:[mr?" ":ar?" ":Mr?" ":" ",ht]},er)}):a.jsx(Et,{variant:"body2",color:"error.main",children:st.errors||st.message||"Unknown error"})})})]},Wt)})})]})})]}),Fr.successes&&Fr.successes.length>0&&a.jsxs(Ut,{sx:{mb:3},children:[a.jsxs(Et,{variant:"subtitle2",color:"success.main",gutterBottom:!0,children:["Successfully Imported (",Fr.successes.length,")"]}),a.jsx(Ws,{component:sa,sx:{maxHeight:200},children:a.jsxs(Cs,{size:"small",children:[a.jsx(js,{children:a.jsxs(pn,{children:[a.jsx(qe,{sx:{fontWeight:"bold"},children:"Row"}),a.jsx(qe,{sx:{fontWeight:"bold"},children:"Product Name"}),a.jsx(qe,{sx:{fontWeight:"bold"},children:"Code"}),a.jsx(qe,{sx:{fontWeight:"bold"},children:"Status"})]})}),a.jsx(fs,{children:Fr.successes.map((st,Wt)=>{var At,Xt;return a.jsxs(pn,{children:[a.jsx(qe,{children:st.row}),a.jsx(qe,{children:((At=st.data)==null?void 0:At.Name)||st.name||"N/A"}),a.jsx(qe,{children:((Xt=st.data)==null?void 0:Xt.Code)||st.code||"N/A"}),a.jsx(qe,{children:a.jsxs(Et,{variant:"body2",color:"success.main",children:[" ",st.action||"Imported"]})})]},Wt)})})]})})]}),Fr.type==="validation_error"&&a.jsxs(Ut,{sx:{p:2,bgcolor:"warning.lighter",borderRadius:1,border:"1px solid",borderColor:"warning.main"},children:[a.jsx(Et,{variant:"subtitle2",color:"warning.dark",gutterBottom:!0,children:" How to Fix These Errors"}),a.jsx(Et,{variant:"body2",color:"warning.dark",sx:{mb:1},children:a.jsx("strong",{children:"Mandatory Fields (must be filled):"})}),a.jsx(Et,{variant:"body2",color:"warning.dark",sx:{mb:1,ml:2},children:" Name, Code, HSN Code, Importance, Category, Unit, Product Mode, Store, Status, Size"}),a.jsxs(Et,{variant:"body2",color:"warning.dark",children:[a.jsx("strong",{children:"Additional Checks:"}),a.jsx("br",{})," Numeric fields (Minimum Stock, GST %, etc.) must contain valid numbers",a.jsx("br",{}),' Status must be "Active" or "Inactive"',a.jsx("br",{}),' Importance must be "Normal", "High", or "Critical"',a.jsx("br",{}),' Product Type must be "All", "Finished Goods", "Semi-Finished Goods", or "Raw Materials"',a.jsx("br",{}),' Product Mode must be "Purchase", "Internal Manufacturing", or "Both"',a.jsx("br",{})," ",a.jsx("strong",{children:"Category, Subcategory, Store, HSN Code, Unit, and Size must match existing system entries (use dropdown options)"}),a.jsx("br",{}),' You can edit values directly in the preview table using the dropdowns, then click "Finalize Import" again']})]}),Fr.type==="import_complete"&&Fr.errorCount>0&&a.jsxs(Ut,{sx:{p:2,bgcolor:"error.lighter",borderRadius:1,border:"1px solid",borderColor:"error.main"},children:[a.jsx(Et,{variant:"subtitle2",color:"error.dark",gutterBottom:!0,children:" How to Fix Import Errors"}),a.jsxs(Et,{variant:"body2",color:"error.dark",sx:{mb:1},children:["Click the ",a.jsx("strong",{children:'"Back to Edit"'})," button below to return to the import preview where you can:"]}),a.jsxs(Et,{variant:"body2",color:"error.dark",sx:{ml:2},children:[" Edit field values directly in the editable table",a.jsx("br",{})," Use dropdown menus for Category, Subcategory, Store, HSN Code, Unit, Size, etc.",a.jsx("br",{})," Deselect rows with errors if you don't want to import them",a.jsx("br",{}),' After making changes, click "Finalize Import" again to retry']})]}),Fr.type==="import_failed"&&a.jsxs(Ut,{sx:{p:2,bgcolor:"error.lighter",borderRadius:1,border:"1px solid",borderColor:"error.main"},children:[a.jsx(Et,{variant:"subtitle2",color:"error.dark",gutterBottom:!0,children:" Import Failed"}),a.jsx(Et,{variant:"body2",color:"error.dark",children:"The import process encountered a server error. Please check the error details above and try again. If the problem persists, contact your system administrator."})]})]})}),a.jsxs(Va,{children:[((Fr==null?void 0:Fr.type)==="validation_error"||(Fr==null?void 0:Fr.type)==="import_complete"&&Fr.errorCount>0||(Fr==null?void 0:Fr.type)==="import_failed")&&a.jsx(Br,{variant:"outlined",color:"warning",startIcon:a.jsx(kz,{}),onClick:()=>{$n(!1),yn(!0)},children:"Back to Edit"}),a.jsx(Br,{onClick:()=>{$n(!1),(Fr==null?void 0:Fr.type)==="import_complete"&&Fr.errorCount===0&&(Dr(null),xn([]),Qn(new Set))},children:"Close"}),(Fr==null?void 0:Fr.type)==="validation_error"&&a.jsx(Br,{variant:"contained",color:"primary",onClick:()=>{$n(!1),yn(!0)},children:"Fix Errors"}),(Fr==null?void 0:Fr.type)==="import_complete"&&Fr.successCount>0&&a.jsx(Br,{variant:"contained",color:"success",onClick:()=>{$n(!1),Dr(null),xn([]),Qn(new Set)},children:"View Products"})]})]}),a.jsx(A6,{open:tr,anchorEl:Bt,onClose:()=>ft(null),anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:a.jsxs(Ut,{sx:{p:1},children:[a.jsx(Br,{fullWidth:!0,size:"small",onClick:()=>Gr("filtered"),sx:{mb:1,justifyContent:"flex-start"},children:"Only Filtered Items"}),a.jsx(Tv,{}),a.jsx(Br,{fullWidth:!0,size:"small",onClick:()=>Gr("all"),sx:{mt:1,justifyContent:"flex-start"},children:"All Items"})]})}),a.jsx(Oa,{open:Le,onClose:()=>rt(!1),maxWidth:"md",fullWidth:!0,children:a.jsx(Pa,{sx:{p:0,display:"flex",justifyContent:"center",alignItems:"center"},children:Ke&&a.jsx("img",{src:Ke,alt:"Product image",style:{maxWidth:"100%",maxHeight:"80vh",objectFit:"contain"}})})})]})}function Lie({product:e,onSubmit:r,navigate:t}){const{register:n,handleSubmit:s,watch:o,setValue:i,reset:c,control:u,formState:{errors:l}}=Gl({mode:"onTouched"}),[d,h]=G.useState([]),[f,p]=G.useState([]),[v,g]=G.useState([]),[m,b]=G.useState([]),[y,S]=G.useState([]),[C,L]=G.useState([]),[O,H]=G.useState([]),[z,q]=G.useState(!0),[D,W]=G.useState(!1),P=G.useRef(null);G.useEffect(()=>{const j=A=>{P.current&&!P.current.contains(A.target)&&W(!1)};return document.addEventListener("mousedown",j),()=>document.removeEventListener("mousedown",j)},[]);const I=G.useRef(e.CategoryID?String(e.CategoryID):""),U=j=>{if(j==null)return"";const A=String(j).trim().toLowerCase(),N=new Map([["purchase","Purchase"],["purchasing","Purchase"],["buy","Purchase"],["p","Purchase"],["internal manufacturing","Internal Manufacturing"],["internal_manufacturing","Internal Manufacturing"],["internalmanufacturing","Internal Manufacturing"],["internal","Internal Manufacturing"],["manufacturing","Internal Manufacturing"],["im","Internal Manufacturing"],["purchase & internal manufacturing","Both"],["purchase and internal manufacturing","Both"],["purchasing & internal manufacturing","Both"],["both","Both"],["purchase & internal","Both"],["purchase/internal","Both"]]);if(N.has(A))return N.get(A);const V=["Purchase","Internal Manufacturing","Both"];for(const M of V)if(A===M.toLowerCase())return M;return""},k=o("HsnID"),_=o("CategoryID");G.useEffect(()=>{if(!k)return;const j=C.find(A=>(A.id||A.ID)===(typeof k=="string"?Number(k):k)||String(A.id||A.ID)===String(k));if(j){let A=null;if(j.tax?A=j.tax:j.tax_id&&(A=y.find(N=>(N.ID||N.id)===j.tax_id)),A){const N=A.ID||A.id;i("TaxID",N!=null?String(N):"",{shouldValidate:!0}),i("GstPercent",A.Percentage??A.percentage??"",{shouldValidate:!0})}j.code&&i("HsnSacCode",j.code)}},[k,C,y,i]),G.useEffect(()=>{if(!z){if(!_){p([]),i("SubcategoryID","");return}ut.get(`${Je}/api/subcategories`,{params:{category_id:_}}).then(j=>{let A=j.data.data;const N=o("SubcategoryID");if(N){const V=f.find(M=>String(M.ID)===N);V&&!A.some(M=>String(M.ID)===N)&&(A=[...A,V])}p(A),_!==I.current&&i("SubcategoryID","")}).catch(()=>{p([]),_!==I.current&&i("SubcategoryID","")})}},[_,i,z]),G.useEffect(()=>{q(!0),(async()=>{try{const[A,N,V,M,Z,J,re]=await Promise.all([ut.get(`${Je}/api/categories`),ut.get(`${Je}/api/subcategories`,{params:e.CategoryID?{category_id:e.CategoryID}:{}}),ut.get(`${Je}/api/units`).catch(X=>(console.error("Error loading units:",X),{data:{data:[]}})),ut.get(`${Je}/api/stores`),ut.get(`${Je}/api/taxes`),ut.get(`${Je}/api/hsncode`).catch(()=>({data:{data:[]}})),ut.get(`${Je}/api/tags`).catch(()=>({data:{data:[]}}))]);return console.log("Units API response:",V.data),console.log("Tags API response:",re.data),h(A.data.data),p(N.data.data),g(V.data.data),b(M.data.data),S(Z.data.data),L(J.data.data),H(re.data.data||re.data||[]),console.log("Tags set to:",re.data.data||re.data||[]),{categories:A.data.data,subcategories:N.data.data,units:V.data.data,stores:M.data.data,taxes:Z.data.data,hsnCodes:J.data.data,tags:re.data.data||re.data||[]}}catch(A){return console.error("Error loading options:",A),h([]),p([]),g([]),b([]),S([]),L([]),H([]),null}})().then(A=>{if(!A)return;console.log("=== Product Edit Form - Initial Load ==="),console.log("Product CategoryID:",e.CategoryID),console.log("Product SubcategoryID:",e.SubcategoryID),console.log("Loaded subcategories:",A.subcategories);let N="";if(e.HsnSacCode&&A.hsnCodes.length>0){const re=A.hsnCodes.find(X=>X.code===e.HsnSacCode);re&&(N=String(re.id||re.ID))}console.log("Product data:",e),console.log("Units loaded:",A.units);let V="";if(e.UnitID&&A.units.length>0){const re=typeof e.UnitID=="number"?e.UnitID:Number(e.UnitID);A.units.some(ne=>ne.ID===re||ne.id===re)?(V=String(e.UnitID),console.log("Unit found and set:",V)):console.log("Unit not found in loaded data:",e.UnitID)}let M=[];Array.isArray(e.Tags)&&e.Tags.length>0&&(M=e.Tags.map(re=>String(re.ID||re.id)).filter(Boolean));const Z=e.SubcategoryID?String(e.SubcategoryID):e.Subcategory?String(e.Subcategory.ID):"";if(Z){const re=A.subcategories.some(X=>String(X.ID)===Z);console.log("Subcategory exists in loaded data:",re),re||console.warn("Subcategory ID",Z,"not found in loaded subcategories")}const J={Name:e.Name,Code:e.Code,HsnID:N,HsnSacCode:e.HsnSacCode||"",Importance:e.Importance||"Normal",GstPercent:e.GstPercent,CategoryID:e.CategoryID?String(e.CategoryID):"",SubcategoryID:Z,UnitID:V,StoreID:e.StoreID?String(e.StoreID):"",TaxID:e.TaxID?String(e.TaxID):"",ProductMode:U(e.ProductMode??e.product_mode??e.productMode??""),Description:e.Description||"",InternalNotes:e.InternalNotes||"",MinimumStock:e.MinimumStock??0,IsActive:typeof e.IsActive<"u"?e.IsActive:!0,ProductType:e.ProductType||"All",moq:e.moq??e.MOQ??e.Moq??"",TagIDs:M};console.log("Form data to reset:",J),c(J),setTimeout(()=>{console.log("Initial load complete, enabling category change effect"),q(!1)},100)})},[e,c]);const R=j=>{console.log("Form data before formatting:",j),console.log("IsActive value:",j.IsActive);const A={...j,CategoryID:j.CategoryID?Number(j.CategoryID):null,SubcategoryID:j.SubcategoryID?Number(j.SubcategoryID):null,UnitID:j.UnitID?Number(j.UnitID):null,StoreID:j.StoreID?Number(j.StoreID):null,TaxID:j.TaxID?Number(j.TaxID):null,HsnID:j.HsnID?Number(j.HsnID):null,MinimumStock:j.MinimumStock?Number(j.MinimumStock):0,GstPercent:j.GstPercent?Number(j.GstPercent):0,moq:j.moq?Number(j.moq):0,IsActive:!!j.IsActive,tagIDs:Array.isArray(j.TagIDs)?j.TagIDs.map(N=>Number(N)):Array.isArray(j.tagIDs)?j.tagids.map(N=>Number(N)):[],ID:e.ID};A.TagIDs&&delete A.TagIDs,A.tagIDs=(Array.isArray(A.tagIDs)?A.tagIDs:[]).map(N=>Number(N)).filter(N=>!Number.isNaN(N)),typeof j.ProductMode<"u"?A.ProductMode=U(j.ProductMode):(e.ProductMode||e.product_mode)&&(A.ProductMode=U(e.ProductMode??e.product_mode)),console.log("Formatted data being sent:",A),console.log("IsActive in formatted data:",A.IsActive),r(A)};return a.jsxs("form",{onSubmit:s(R),className:"product-edit-form",children:[a.jsx("h2",{className:"form-title",children:"Edit Product Info"}),a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label required",children:"Product Name"}),a.jsx("input",{type:"text",...n("Name",{required:!0})}),l.Name&&a.jsx("span",{className:"field-error",children:"Product Name is required"})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label required",children:"Code"}),a.jsx("input",{type:"text",...n("Code",{required:!0})}),l.Code&&a.jsx("span",{className:"field-error",children:"Code is required"})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"HSN Code"}),a.jsx(En,{name:"HsnID",control:u,render:({field:j})=>a.jsxs("select",{value:j.value||"",onChange:A=>j.onChange(A.target.value),children:[a.jsx("option",{value:"",children:"Select HSN Code"}),C.length>0?C.map(A=>a.jsx("option",{value:String(A.id||A.ID),children:A.code},A.id||A.ID)):a.jsx("option",{disabled:!0,value:"",children:"No HSN Codes Available"})]})}),l.CategoryID&&a.jsx("span",{className:"field-error",children:"Category is required"})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label required",children:"Importance"}),a.jsx(En,{name:"Importance",control:u,rules:{required:!0},render:({field:j})=>a.jsx("select",{value:j.value||"",onChange:A=>j.onChange(A.target.value),children:["Normal","High","Critical"].map(A=>a.jsx("option",{value:A,children:A},A))})})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label required",children:"Product Type"}),a.jsx(En,{name:"ProductType",control:u,rules:{required:!0},render:({field:j})=>a.jsx("select",{value:j.value||"",onChange:A=>j.onChange(A.target.value),children:["All","Finished Goods","Semi-Finished Goods","Raw Materials"].map(A=>a.jsx("option",{value:A,children:A},A))})})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"Minimum Stock"}),a.jsx("input",{type:"number",...n("MinimumStock",{valueAsNumber:!0})})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label required",children:"Category"}),a.jsx(En,{name:"CategoryID",control:u,rules:{required:!0},render:({field:j})=>a.jsxs("select",{value:j.value||"",onChange:A=>j.onChange(A.target.value),children:[a.jsx("option",{value:"",children:"Select Category"}),d.map(A=>a.jsx("option",{value:String(A.ID),children:A.Name},A.ID))]})})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"Subcategory"}),a.jsx(En,{name:"SubcategoryID",control:u,render:({field:j})=>(console.log("Subcategory field value:",j.value),console.log("Available subcategories:",f),a.jsxs("select",{value:j.value||"",onChange:A=>j.onChange(A.target.value),children:[a.jsx("option",{value:"",children:"Select Subcategory"}),f.length>0?f.map(A=>a.jsx("option",{value:String(A.ID),children:A.Name},A.ID)):a.jsx("option",{disabled:!0,value:"",children:"No Subcategories Available"})]}))}),l.SubcategoryID&&a.jsx("span",{className:"field-error",children:"Invalid subcategory"})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"Unit"}),a.jsx(En,{name:"UnitID",control:u,render:({field:j})=>(console.log("UnitID field value:",j.value),console.log("Available units:",v),a.jsxs("select",{value:j.value||"",onChange:A=>j.onChange(A.target.value),children:[a.jsx("option",{value:"",children:"Select Unit"}),v.length>0?v.map(A=>a.jsx("option",{value:String(A.ID||A.id),children:A.Name||A.name},A.ID||A.id)):a.jsx("option",{disabled:!0,value:"",children:"No Units Available"})]}))}),l.UnitID&&a.jsx("span",{className:"field-error",children:"Invalid unit"})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label required",children:"Product Mode"}),a.jsx(En,{name:"ProductMode",control:u,render:({field:j})=>a.jsxs("select",{value:j.value||"",onChange:A=>j.onChange(A.target.value),children:[a.jsx("option",{value:"",children:"Select Product Mode"}),["Purchase","Internal Manufacturing","Both"].map(A=>a.jsx("option",{value:A,children:A},A))]})})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"MOQ"}),a.jsx("input",{type:"number",...n("moq",{valueAsNumber:!0})})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"Store"}),a.jsx(En,{name:"StoreID",control:u,render:({field:j})=>a.jsxs("select",{value:j.value||"",onChange:A=>j.onChange(A.target.value),children:[a.jsx("option",{value:"",children:"Select Store"}),m.map(A=>a.jsx("option",{value:String(A.ID),children:A.Name},A.ID))]})})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"Tax"}),a.jsx(En,{name:"TaxID",control:u,render:({field:j})=>a.jsxs("select",{value:j.value||"",onChange:A=>j.onChange(A.target.value),children:[a.jsx("option",{value:"",children:"Select Tax"}),y.map(A=>a.jsx("option",{value:String(A.ID),children:A.Name},A.ID))]})})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"GST %"}),a.jsx("input",{type:"number",readOnly:!0,...n("GstPercent",{valueAsNumber:!0})})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"Tags"}),a.jsx(En,{name:"TagIDs",control:u,defaultValue:[],render:({field:j})=>{console.log("Rendering Tags field. Available tags:",O),console.log("Current TagIDs value:",j.value);const A=O.filter(N=>{const V=String(N.ID||N.id);return(j.value||[]).includes(V)});return a.jsxs("div",{className:"multi-select-wrapper",ref:P,children:[a.jsxs("div",{className:"multi-select-input",onClick:()=>W(!0),children:[A.map(N=>a.jsxs("div",{className:"tag-chip",children:[N.Name||N.name,a.jsx("span",{className:"chip-remove",onClick:()=>{const V=(j.value||[]).filter(M=>M!==String(N.ID||N.id));j.onChange(V)}})]},N.ID||N.id)),a.jsx("input",{type:"text",placeholder:"Select tags",onFocus:()=>W(!0),onKeyDown:N=>{if(N.key==="Backspace"&&!N.target.value){const M=(j.value||[]).slice(0,-1);j.onChange(M)}}})]}),D&&a.jsx("div",{className:"tag-dropdown",children:O.map(N=>{const V=String(N.ID||N.id),M=(j.value||[]).includes(V);return a.jsxs("div",{className:`tag-option ${M?"selected":""}`,onClick:()=>{const Z=j.value||[];let J;M?J=Z.filter(re=>re!==V):J=[...Z,V],j.onChange(J)},children:[a.jsx("input",{type:"checkbox",checked:M,readOnly:!0}),a.jsx("label",{children:N.Name||N.name})]},V)})})]})}})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"Description"}),a.jsx("textarea",{...n("Description")})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"Internal Notes"}),a.jsx("textarea",{...n("InternalNotes")})]}),a.jsx("div",{className:"form-field col-33",children:a.jsx("div",{className:"checkbox-wrapper",children:a.jsx(En,{name:"IsActive",control:u,render:({field:j})=>a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"checkbox",id:"isActive",checked:j.value||!1,onChange:A=>j.onChange(A.target.checked)}),a.jsx("label",{htmlFor:"isActive",children:"Is Active"})]})})})})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{type:"submit",className:"btn-primary",children:"Update Product"}),a.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>t(`/products/${e.ID}/variants`),children:"Update Product Variants"})]})]})}function Mie(){const{id:e}=Jv(),r=ii(),[t,n]=G.useState(null),[s,o]=G.useState(!0),[i,c]=G.useState(!1);G.useEffect(()=>{ut.get(`${Je}/api/products/${e}`).then(l=>{n(l.data),console.log("=== ProductEditPage - Product loaded ==="),console.log("Product data:",l.data),console.log("CategoryID:",l.data.CategoryID),console.log("SubcategoryID:",l.data.SubcategoryID),console.log("Subcategory object:",l.data.Subcategory),o(!1)}).catch(l=>{console.error("Error loading product",l),o(!1)})},[e]);const u=async l=>{console.log("Sending update data:",l),console.log("IsActive in data:",l.IsActive);const d={...l,ID:l.ID?Number(l.ID):l.ID,IsActive:!!l.IsActive,Stock:l.Stock!=null?Number(l.Stock):null,MOQ:l.MOQ!=null?Number(l.MOQ):null,LeadTime:l.LeadTime!=null?Number(l.LeadTime):null,Name:l.Name?l.Name.trim():l.Name,Code:l.Code?l.Code.trim():l.Code,Description:l.Description?l.Description.trim():l.Description,Note:l.Note?l.Note.trim():l.Note,CategoryID:l.CategoryID!=null?Number(l.CategoryID):null,StoreID:l.StoreID!=null?Number(l.StoreID):null,SubcategoryID:l.SubcategoryID!=null?Number(l.SubcategoryID):null,tagIDs:Array.isArray(l.TagIDs)?l.TagIDs.map(h=>Number(h)):Array.isArray(l.tagIDs)?l.tagIDs.map(h=>Number(h)):[]};console.log("Sanitized update data:",d);try{const h=await ut.put(`${Je}/api/products/${e}`,d);console.log("Update response:",h.data),console.log("IsActive in response:",h.data.IsActive);const p=(await ut.get(`${Je}/api/products/${e}`)).data;typeof p.IsActive!="boolean"&&(p.IsActive=!!p.IsActive),n(p),c(!0)}catch(h){console.error("Update failed",h),h.response&&h.response.data?(console.error("Backend error details:",h.response.data),alert("Failed to update product: "+(h.response.data.error||h.response.data.message||JSON.stringify(h.response.data)))):alert("Failed to update product: Network or server error")}};return s?a.jsx(Ut,{p:4,children:a.jsx(Vs,{})}):t?a.jsxs("section",{className:"right-content",children:[a.jsx(sa,{elevation:3,sx:{p:4,mb:2},children:a.jsx(Lie,{product:t,onSubmit:u,navigate:r})}),a.jsx(fR,{open:i,type:"success",title:"Product Updated",message:"The product has been successfully updated.",onClose:()=>c(!1),actions:[{label:"Update Variant",onClick:()=>{c(!1),r(`/products/${e}/variants`)},variant:"outlined"},{label:"Stay",onClick:()=>{c(!1)},variant:"outlined"},{label:"View Products",onClick:()=>{c(!1),r("/ProductMaster")},variant:"contained"}]})]}):a.jsx(Ut,{p:4,children:a.jsx(Et,{children:"Product not found"})})}function Die({open:e,onClose:r,onSave:t,defaultValues:n=null,sizes:s=[]}){const{register:o,handleSubmit:i,reset:c,setValue:u,formState:{errors:l}}=Gl({mode:"onSubmit",defaultValues:{sku:"",barcode:"",purchaseCost:"",stdSalesPrice:"",stock:"",leadTime:"",isActive:!0}}),[d,h]=G.useState([]),[f,p]=G.useState([]),[v,g]=G.useState(null),[m,b]=G.useState([]),[y,S]=G.useState(!1),[C,L]=G.useState(null),[O,H]=G.useState(null),[z,q]=G.useState(""),[D,W]=G.useState(!1),P=G.useRef(null),[I,U]=G.useState(""),[k,_]=G.useState(!1),[R,j]=G.useState(null),[A,N]=G.useState(null),[V,M]=G.useState({x:0,y:0}),[Z,J]=G.useState(1),[re,X]=G.useState(null),[ne,Y]=G.useState(null),[K,ee]=G.useState(""),[ue,se]=G.useState(!1),ce=[{name:"RAL 1000 - Green beige",value:"RAL 1000",hex:"#CDBA88"},{name:"RAL 1001 - Beige",value:"RAL 1001",hex:"#D0B084"},{name:"RAL 1002 - Sand yellow",value:"RAL 1002",hex:"#D2AA6D"},{name:"RAL 1003 - Signal yellow",value:"RAL 1003",hex:"#F9A900"},{name:"RAL 1004 - Golden yellow",value:"RAL 1004",hex:"#E49E00"},{name:"RAL 1005 - Honey yellow",value:"RAL 1005",hex:"#CB8F00"},{name:"RAL 1006 - Maize yellow",value:"RAL 1006",hex:"#E19000"},{name:"RAL 1007 - Daffodil yellow",value:"RAL 1007",hex:"#E88C00"},{name:"RAL 1011 - Brown beige",value:"RAL 1011",hex:"#AF8050"},{name:"RAL 1012 - Lemon yellow",value:"RAL 1012",hex:"#DDAF28"},{name:"RAL 1013 - Oyster white",value:"RAL 1013",hex:"#E3D9C7"},{name:"RAL 1014 - Ivory",value:"RAL 1014",hex:"#DDC49B"},{name:"RAL 1015 - Light ivory",value:"RAL 1015",hex:"#E6D2B5"},{name:"RAL 1016 - Sulfur yellow",value:"RAL 1016",hex:"#F1DD39"},{name:"RAL 1017 - Saffron yellow",value:"RAL 1017",hex:"#F6A951"},{name:"RAL 1018 - Zinc yellow",value:"RAL 1018",hex:"#FACA31"},{name:"RAL 1019 - Grey beige",value:"RAL 1019",hex:"#A48F7A"},{name:"RAL 1020 - Olive yellow",value:"RAL 1020",hex:"#A08F65"},{name:"RAL 1021 - Colza yellow",value:"RAL 1021",hex:"#F6B600"},{name:"RAL 1023 - Traffic yellow",value:"RAL 1023",hex:"#F7B500"},{name:"RAL 1024 - Ochre yellow",value:"RAL 1024",hex:"#BA8F4C"},{name:"RAL 1026 - Luminous yellow",value:"RAL 1026",hex:"#FFFF00"},{name:"RAL 1027 - Curry",value:"RAL 1027",hex:"#A77F0F"},{name:"RAL 1028 - Melon yellow",value:"RAL 1028",hex:"#FF9C00"},{name:"RAL 1032 - Broom yellow",value:"RAL 1032",hex:"#E2A300"},{name:"RAL 1033 - Dahlia yellow",value:"RAL 1033",hex:"#F99A1D"},{name:"RAL 1034 - Pastel yellow",value:"RAL 1034",hex:"#EB9C52"},{name:"RAL 1035 - Pearl beige",value:"RAL 1035",hex:"#8F8370"},{name:"RAL 1036 - Pearl gold",value:"RAL 1036",hex:"#806440"},{name:"RAL 1037 - Sun yellow",value:"RAL 1037",hex:"#F09200"},{name:"RAL 2000 - Yellow orange",value:"RAL 2000",hex:"#DA6E00"},{name:"RAL 2001 - Red orange",value:"RAL 2001",hex:"#BA481C"},{name:"RAL 2002 - Vermilion",value:"RAL 2002",hex:"#BF3922"},{name:"RAL 2003 - Pastel orange",value:"RAL 2003",hex:"#F67829"},{name:"RAL 2004 - Pure orange",value:"RAL 2004",hex:"#E25304"},{name:"RAL 2005 - Luminous orange",value:"RAL 2005",hex:"#FF4D08"},{name:"RAL 2007 - Luminous bright orange",value:"RAL 2007",hex:"#FFB200"},{name:"RAL 2008 - Bright red orange",value:"RAL 2008",hex:"#EC6B22"},{name:"RAL 2009 - Traffic orange",value:"RAL 2009",hex:"#DE5308"},{name:"RAL 2010 - Signal orange",value:"RAL 2010",hex:"#D05D29"},{name:"RAL 2011 - Deep orange",value:"RAL 2011",hex:"#E26E0F"},{name:"RAL 2012 - Salmon orange",value:"RAL 2012",hex:"#D5654E"},{name:"RAL 2013 - Pearl orange",value:"RAL 2013",hex:"#923E25"},{name:"RAL 2017 - RAL orange",value:"RAL 2017",hex:"#FC5500"},{name:"RAL 3000 - Flame red",value:"RAL 3000",hex:"#A72920"},{name:"RAL 3001 - Signal red",value:"RAL 3001",hex:"#9B2423"},{name:"RAL 3002 - Carmine red",value:"RAL 3002",hex:"#9B2321"},{name:"RAL 3003 - Ruby red",value:"RAL 3003",hex:"#861A22"},{name:"RAL 3004 - Purple red",value:"RAL 3004",hex:"#6B1C23"},{name:"RAL 3005 - Wine red",value:"RAL 3005",hex:"#59191F"},{name:"RAL 3007 - Black red",value:"RAL 3007",hex:"#3E2022"},{name:"RAL 3009 - Oxide red",value:"RAL 3009",hex:"#6D342D"},{name:"RAL 3011 - Brown red",value:"RAL 3011",hex:"#782423"},{name:"RAL 3012 - Beige red",value:"RAL 3012",hex:"#C5856D"},{name:"RAL 3013 - Tomato red",value:"RAL 3013",hex:"#972E25"},{name:"RAL 3014 - Antique pink",value:"RAL 3014",hex:"#CB7375"},{name:"RAL 3015 - Light pink",value:"RAL 3015",hex:"#D8A0A6"},{name:"RAL 3016 - Coral red",value:"RAL 3016",hex:"#A63D30"},{name:"RAL 3017 - Rose",value:"RAL 3017",hex:"#CA555D"},{name:"RAL 3018 - Strawberry red",value:"RAL 3018",hex:"#C63F4A"},{name:"RAL 3020 - Traffic red",value:"RAL 3020",hex:"#BB1F11"},{name:"RAL 3022 - Salmon pink",value:"RAL 3022",hex:"#CF6955"},{name:"RAL 3024 - Luminous red",value:"RAL 3024",hex:"#FF2D21"},{name:"RAL 3026 - Luminous bright red",value:"RAL 3026",hex:"#FF2A1C"},{name:"RAL 3027 - Raspberry red",value:"RAL 3027",hex:"#AB273C"},{name:"RAL 3028 - Pure red",value:"RAL 3028",hex:"#CC2C24"},{name:"RAL 3031 - Orient red",value:"RAL 3031",hex:"#A63437"},{name:"RAL 3032 - Pearl ruby red",value:"RAL 3032",hex:"#701D24"},{name:"RAL 3033 - Pearl pink",value:"RAL 3033",hex:"#A53A2E"},{name:"RAL 4001 - Red lilac",value:"RAL 4001",hex:"#816183"},{name:"RAL 4002 - Red violet",value:"RAL 4002",hex:"#8D3C4B"},{name:"RAL 4003 - Heather violet",value:"RAL 4003",hex:"#C4618C"},{name:"RAL 4004 - Claret violet",value:"RAL 4004",hex:"#651E38"},{name:"RAL 4005 - Blue lilac",value:"RAL 4005",hex:"#76689A"},{name:"RAL 4006 - Traffic purple",value:"RAL 4006",hex:"#903373"},{name:"RAL 4007 - Purple violet",value:"RAL 4007",hex:"#47243C"},{name:"RAL 4008 - Signal violet",value:"RAL 4008",hex:"#844C82"},{name:"RAL 4009 - Pastel violet",value:"RAL 4009",hex:"#9D8692"},{name:"RAL 4010 - Telemagenta",value:"RAL 4010",hex:"#BB4077"},{name:"RAL 4011 - Pearl violet",value:"RAL 4011",hex:"#6E6387"},{name:"RAL 4012 - Pearl blackberry",value:"RAL 4012",hex:"#6A6B7F"},{name:"RAL 5000 - Violet blue",value:"RAL 5000",hex:"#304F6E"},{name:"RAL 5001 - Green blue",value:"RAL 5001",hex:"#0E4C64"},{name:"RAL 5002 - Ultramarine blue",value:"RAL 5002",hex:"#00387A"},{name:"RAL 5003 - Sapphire blue",value:"RAL 5003",hex:"#1F3855"},{name:"RAL 5004 - Black blue",value:"RAL 5004",hex:"#191E28"},{name:"RAL 5005 - Signal blue",value:"RAL 5005",hex:"#005387"},{name:"RAL 5007 - Brillant blue",value:"RAL 5007",hex:"#376B8C"},{name:"RAL 5008 - Grey blue",value:"RAL 5008",hex:"#2B3A44"},{name:"RAL 5009 - Azure blue",value:"RAL 5009",hex:"#215F78"},{name:"RAL 5010 - Gentian blue",value:"RAL 5010",hex:"#004F7C"},{name:"RAL 5011 - Steel blue",value:"RAL 5011",hex:"#1A2B3C"},{name:"RAL 5012 - Light blue",value:"RAL 5012",hex:"#0089B6"},{name:"RAL 5013 - Cobalt blue",value:"RAL 5013",hex:"#193153"},{name:"RAL 5014 - Pigeon blue",value:"RAL 5014",hex:"#637D96"},{name:"RAL 5015 - Sky blue",value:"RAL 5015",hex:"#007CAF"},{name:"RAL 5017 - Traffic blue",value:"RAL 5017",hex:"#005B8C"},{name:"RAL 5018 - Turquoise blue",value:"RAL 5018",hex:"#048B8C"},{name:"RAL 5019 - Capri blue",value:"RAL 5019",hex:"#005E83"},{name:"RAL 5020 - Ocean blue",value:"RAL 5020",hex:"#00414B"},{name:"RAL 5021 - Water blue",value:"RAL 5021",hex:"#007577"},{name:"RAL 5022 - Night blue",value:"RAL 5022",hex:"#222D5A"},{name:"RAL 5023 - Distant blue",value:"RAL 5023",hex:"#41698C"},{name:"RAL 5024 - Pastel blue",value:"RAL 5024",hex:"#6093AC"},{name:"RAL 5025 - Pearl gentian blue",value:"RAL 5025",hex:"#20697C"},{name:"RAL 5026 - Pearl night blue",value:"RAL 5026",hex:"#0F3052"},{name:"RAL 6000 - Patina green",value:"RAL 6000",hex:"#3C7460"},{name:"RAL 6001 - Emerald green",value:"RAL 6001",hex:"#366735"},{name:"RAL 6002 - Leaf green",value:"RAL 6002",hex:"#325928"},{name:"RAL 6003 - Olive green",value:"RAL 6003",hex:"#50533C"},{name:"RAL 6004 - Blue green",value:"RAL 6004",hex:"#024442"},{name:"RAL 6005 - Moss green",value:"RAL 6005",hex:"#114232"},{name:"RAL 6006 - Grey olive",value:"RAL 6006",hex:"#3C392E"},{name:"RAL 6007 - Bottle green",value:"RAL 6007",hex:"#2C3222"},{name:"RAL 6008 - Brown green",value:"RAL 6008",hex:"#36342A"},{name:"RAL 6009 - Fir green",value:"RAL 6009",hex:"#27352A"},{name:"RAL 6010 - Grass green",value:"RAL 6010",hex:"#4D6F39"},{name:"RAL 6011 - Reseda green",value:"RAL 6011",hex:"#6B7C59"},{name:"RAL 6012 - Black green",value:"RAL 6012",hex:"#2F3D3A"},{name:"RAL 6013 - Reed green",value:"RAL 6013",hex:"#7C765A"},{name:"RAL 6014 - Yellow olive",value:"RAL 6014",hex:"#474135"},{name:"RAL 6015 - Black olive",value:"RAL 6015",hex:"#3D3D36"},{name:"RAL 6016 - Turquoise green",value:"RAL 6016",hex:"#00694C"},{name:"RAL 6017 - May green",value:"RAL 6017",hex:"#587F40"},{name:"RAL 6018 - Yellow green",value:"RAL 6018",hex:"#60993B"},{name:"RAL 6019 - Pastel green",value:"RAL 6019",hex:"#B9CEAC"},{name:"RAL 6020 - Chrome green",value:"RAL 6020",hex:"#37422F"},{name:"RAL 6021 - Pale green",value:"RAL 6021",hex:"#8A9977"},{name:"RAL 6022 - Olive drab",value:"RAL 6022",hex:"#3A3327"},{name:"RAL 6024 - Traffic green",value:"RAL 6024",hex:"#008351"},{name:"RAL 6025 - Fern green",value:"RAL 6025",hex:"#5E6E3B"},{name:"RAL 6026 - Opal green",value:"RAL 6026",hex:"#005F4E"},{name:"RAL 6027 - Light green",value:"RAL 6027",hex:"#7EBAB5"},{name:"RAL 6028 - Pine green",value:"RAL 6028",hex:"#315442"},{name:"RAL 6029 - Mint green",value:"RAL 6029",hex:"#006F3D"},{name:"RAL 6032 - Signal green",value:"RAL 6032",hex:"#237F52"},{name:"RAL 6033 - Mint turquoise",value:"RAL 6033",hex:"#45877F"},{name:"RAL 6034 - Pastel turquoise",value:"RAL 6034",hex:"#7AADAC"},{name:"RAL 6035 - Pearl green",value:"RAL 6035",hex:"#194D25"},{name:"RAL 6036 - Pearl opal green",value:"RAL 6036",hex:"#04574B"},{name:"RAL 6037 - Pure green",value:"RAL 6037",hex:"#008B29"},{name:"RAL 6038 - Luminous green",value:"RAL 6038",hex:"#00B51B"},{name:"RAL 6039 - Fibrous green",value:"RAL 6039",hex:"#B3C43E"},{name:"RAL 7000 - Squirrel grey",value:"RAL 7000",hex:"#7A888E"},{name:"RAL 7001 - Silver grey",value:"RAL 7001",hex:"#8C979C"},{name:"RAL 7002 - Olive grey",value:"RAL 7002",hex:"#817863"},{name:"RAL 7003 - Moss grey",value:"RAL 7003",hex:"#797669"},{name:"RAL 7004 - Signal grey",value:"RAL 7004",hex:"#9A9B9B"},{name:"RAL 7005 - Mouse grey",value:"RAL 7005",hex:"#6B6E6B"},{name:"RAL 7006 - Beige grey",value:"RAL 7006",hex:"#766A5E"},{name:"RAL 7008 - Khaki grey",value:"RAL 7008",hex:"#745F3D"},{name:"RAL 7009 - Green grey",value:"RAL 7009",hex:"#5D6058"},{name:"RAL 7010 - Tarpaulin grey",value:"RAL 7010",hex:"#585C56"},{name:"RAL 7011 - Iron grey",value:"RAL 7011",hex:"#52595D"},{name:"RAL 7012 - Basalt grey",value:"RAL 7012",hex:"#575D5E"},{name:"RAL 7013 - Brown grey",value:"RAL 7013",hex:"#575044"},{name:"RAL 7015 - Slate grey",value:"RAL 7015",hex:"#4F5358"},{name:"RAL 7016 - Anthracite grey",value:"RAL 7016",hex:"#383E42"},{name:"RAL 7021 - Black grey",value:"RAL 7021",hex:"#2F3234"},{name:"RAL 7022 - Umbra grey",value:"RAL 7022",hex:"#4C4A44"},{name:"RAL 7023 - Concrete grey",value:"RAL 7023",hex:"#808076"},{name:"RAL 7024 - Graphite grey",value:"RAL 7024",hex:"#45494E"},{name:"RAL 7026 - Granite grey",value:"RAL 7026",hex:"#374345"},{name:"RAL 7030 - Stone grey",value:"RAL 7030",hex:"#928E85"},{name:"RAL 7031 - Blue grey",value:"RAL 7031",hex:"#5B686D"},{name:"RAL 7032 - Pebble grey",value:"RAL 7032",hex:"#B5B0A1"},{name:"RAL 7033 - Cement grey",value:"RAL 7033",hex:"#7F8274"},{name:"RAL 7034 - Yellow grey",value:"RAL 7034",hex:"#92886F"},{name:"RAL 7035 - Light grey",value:"RAL 7035",hex:"#C5C7C4"},{name:"RAL 7036 - Platinum grey",value:"RAL 7036",hex:"#979392"},{name:"RAL 7037 - Dusty grey",value:"RAL 7037",hex:"#7A7B7A"},{name:"RAL 7038 - Agate grey",value:"RAL 7038",hex:"#B0B0A9"},{name:"RAL 7039 - Quartz grey",value:"RAL 7039",hex:"#6B665E"},{name:"RAL 7040 - Window grey",value:"RAL 7040",hex:"#989EA1"},{name:"RAL 7042 - Traffic grey A",value:"RAL 7042",hex:"#8E9291"},{name:"RAL 7043 - Traffic grey B",value:"RAL 7043",hex:"#4F5250"},{name:"RAL 7044 - Silk grey",value:"RAL 7044",hex:"#B7B3A8"},{name:"RAL 7045 - Telegrey 1",value:"RAL 7045",hex:"#8D9295"},{name:"RAL 7046 - Telegrey 2",value:"RAL 7046",hex:"#7E868A"},{name:"RAL 7047 - Telegrey 4",value:"RAL 7047",hex:"#C8C8C7"},{name:"RAL 7048 - Pearl mouse grey",value:"RAL 7048",hex:"#817B73"},{name:"RAL 8000 - Green brown",value:"RAL 8000",hex:"#89693F"},{name:"RAL 8001 - Ochre brown",value:"RAL 8001",hex:"#9D622B"},{name:"RAL 8002 - Signal brown",value:"RAL 8002",hex:"#794D3E"},{name:"RAL 8003 - Clay brown",value:"RAL 8003",hex:"#7E4B27"},{name:"RAL 8004 - Copper brown",value:"RAL 8004",hex:"#8D4931"},{name:"RAL 8007 - Fawn brown",value:"RAL 8007",hex:"#70462B"},{name:"RAL 8008 - Olive brown",value:"RAL 8008",hex:"#724A25"},{name:"RAL 8011 - Nut brown",value:"RAL 8011",hex:"#5A3827"},{name:"RAL 8012 - Red brown",value:"RAL 8012",hex:"#66332B"},{name:"RAL 8014 - Sepia brown",value:"RAL 8014",hex:"#4A3526"},{name:"RAL 8015 - Chestnut brown",value:"RAL 8015",hex:"#5E2F26"},{name:"RAL 8016 - Mahogany brown",value:"RAL 8016",hex:"#4C2B20"},{name:"RAL 8017 - Chocolate brown",value:"RAL 8017",hex:"#442F29"},{name:"RAL 8019 - Grey brown",value:"RAL 8019",hex:"#3D3635"},{name:"RAL 8022 - Black brown",value:"RAL 8022",hex:"#1A1719"},{name:"RAL 8023 - Orange brown",value:"RAL 8023",hex:"#A45729"},{name:"RAL 8024 - Beige brown",value:"RAL 8024",hex:"#795038"},{name:"RAL 8025 - Pale brown",value:"RAL 8025",hex:"#755847"},{name:"RAL 8028 - Terra brown",value:"RAL 8028",hex:"#513A2A"},{name:"RAL 8029 - Pearl copper",value:"RAL 8029",hex:"#7F4031"},{name:"RAL 9001 - Cream",value:"RAL 9001",hex:"#E9E0D2"},{name:"RAL 9002 - Grey white",value:"RAL 9002",hex:"#D6D5CB"},{name:"RAL 9003 - Signal white",value:"RAL 9003",hex:"#ECECE7"},{name:"RAL 9004 - Signal black",value:"RAL 9004",hex:"#2B2B2C"},{name:"RAL 9005 - Jet black",value:"RAL 9005",hex:"#0E0E10"},{name:"RAL 9006 - White aluminium",value:"RAL 9006",hex:"#A1A1A0"},{name:"RAL 9007 - Grey aluminium",value:"RAL 9007",hex:"#868581"},{name:"RAL 9010 - Pure white",value:"RAL 9010",hex:"#F1EDE1"},{name:"RAL 9011 - Graphite black",value:"RAL 9011",hex:"#27292B"},{name:"RAL 9012 - Cleanroom white",value:"RAL 9012",hex:"#F8F2E1"},{name:"RAL 9016 - Traffic white",value:"RAL 9016",hex:"#F1F1EA"},{name:"RAL 9017 - Traffic black",value:"RAL 9017",hex:"#29292A"},{name:"RAL 9018 - Papyrus white",value:"RAL 9018",hex:"#C8CBC4"},{name:"RAL 9022 - Pearl light grey",value:"RAL 9022",hex:"#858583"},{name:"RAL 9023 - Pearl dark grey",value:"RAL 9023",hex:"#787B7A"}];G.useEffect(()=>{if(!e)return;(async()=>{var De;S(!0),L(null);try{if(Array.isArray(s)&&s.length>0)b(s);else{const He=await ut.get(`${Je}/api/sizes`,{params:{page:1,limit:500,filter:""}});b(((De=He.data)==null?void 0:De.data)||[])}}catch{L("Failed to load sizes"),b([])}finally{S(!1)}})()},[e,s]),G.useEffect(()=>{const ge=!!(n&&(n.ID||n.id||n.SKU||n.sku));e&&!ge&&(c({sku:"",barcode:"",purchaseCost:"",stdSalesPrice:"",stock:"",leadTime:"",isActive:!0}),p([]),h([]),H(null),q(""),U(""),Y(null),g(null))},[e,n,c]),G.useEffect(()=>{if(n){const ge={sku:n.SKU||n.sku||"",barcode:n.Barcode||n.barcode||"",purchaseCost:n.PurchaseCost||n.purchaseCost||"",stdSalesPrice:n.StdSalesPrice||n.stdSalesPrice||"",stock:n.Stock||n.stock||"",leadTime:n.LeadTime||n.leadTime||"",isActive:n.IsActive??n.isActive??!0};c(ge),g(n.ID||n.id||null);const De=(n.images||n.Images||[]).map(at=>{if(typeof at=="string"){const dt=at.replace(/\\/g,"/");return{file:null,preview:dt.startsWith("http://")||dt.startsWith("https://")?dt:`${Je}/${dt.startsWith("uploads/")?dt:`uploads/${dt}`}`,original:at,name:dt.split("/").pop()}}return{file:at,preview:URL.createObjectURL(at),original:null,name:at.name}});p(De),h(De.map(at=>at.preview));const He=ce.find(at=>at.value===(n.color||n.Color));H(He||null),q(He?He.name:""),U(n.size||n.Size||"");let Xe=null;if(n.mainImage||n.MainImage){const at=n.mainImage||n.MainImage,dt=De.findIndex(wt=>wt.original&&wt.original===at||wt.name===at);dt>=0&&(Xe=dt)}Xe===null&&De.length>0&&(Xe=0),Y(Xe)}else c(),h([]),H(null),q(""),U(""),Y(null)},[n,e,c]);const fe=G.useCallback((ge,De)=>{X(De)},[]),ve=async(ge,De)=>{const He=await new Promise((dt,wt)=>{const $t=new Image;$t.crossOrigin="anonymous",$t.onload=()=>dt($t),$t.onerror=Bt=>wt(Bt),$t.src=ge}),Xe=document.createElement("canvas");return Xe.width=De.width,Xe.height=De.height,Xe.getContext("2d").drawImage(He,De.x,De.y,De.width,De.height,0,0,De.width,De.height),new Promise(dt=>{Xe.toBlob(wt=>{if(!wt)return dt(null);const $t=new File([wt],`cropped_${Date.now()}.png`,{type:wt.type});dt($t)},"image/png")})},_e=ge=>{Te(ge)},le=ge=>{const De=f[ge];!De||!(De.preview&&(De.file?De.file.type&&De.file.type.startsWith("image/"):/\.(jpg|jpeg|png|gif|webp)$/i.test(De.preview)||De.preview.startsWith("data:")))||(N(ge),j(De.preview),_(!0))},ke=async()=>{if(A==null||!re)return;const ge=f[A].preview,De=await ve(ge,re);if(De){const He={file:De,preview:URL.createObjectURL(De),original:null,name:De.name};p(Xe=>Xe.map((at,dt)=>dt===A?He:at)),h(Xe=>Xe.map((at,dt)=>dt===A?He.preview:at))}_(!1),N(null),j(null),J(1)},Te=ge=>{const He=Array.from(ge.target.files||[]).map(Xe=>({file:Xe,preview:URL.createObjectURL(Xe),original:null,name:Xe.name}));p(Xe=>{const at=[...Xe,...He];return ne==null&&at.length>0&&Y(0),at}),h(Xe=>[...Xe,...He.map(at=>at.preview)])},pe=ge=>{const De=f[ge];if(De&&De.file&&De.preview)try{URL.revokeObjectURL(De.preview)}catch{}p(He=>{const Xe=He.filter((at,dt)=>dt!==ge);return Y(at=>at==null?null:ge===at?Xe.length>0?0:null:ge<at?at-1:at),Xe}),h(He=>He.filter((Xe,at)=>at!==ge))},ye=ge=>{const De=f.map(dt=>dt.original).filter(Boolean),He=typeof ne=="number"&&f[ne]&&f[ne].original||null;let Xe=ge.sku;(!Xe||Xe.trim()==="")&&(Xe=`SKU-${Date.now()}-${Math.floor(Math.random()*1e3)}`);const at={ID:v,Color:(O==null?void 0:O.value)||(n==null?void 0:n.Color)||"",Size:I||"",SKU:Xe,Barcode:ge.barcode,PurchaseCost:typeof ge.purchaseCost=="number"?ge.purchaseCost:Number(ge.purchaseCost||0),StdSalesPrice:typeof ge.stdSalesPrice=="number"?ge.stdSalesPrice:Number(ge.stdSalesPrice||0),Stock:typeof ge.stock=="number"?ge.stock:Number(ge.stock||0),LeadTime:typeof ge.leadTime=="number"?ge.leadTime:Number(ge.leadTime||0),IsActive:!!ge.isActive,Images:De,Files:f.filter(dt=>dt.file instanceof File).map(dt=>dt.file),MainImage:He,MainImageIndex:typeof ne=="number"?ne:null};t(at),r()};return G.useEffect(()=>{q(O?O.name:"")},[O]),G.useEffect(()=>{const ge=De=>{D&&P.current&&!P.current.contains(De.target)&&W(!1)};return document.addEventListener("mousedown",ge),()=>document.removeEventListener("mousedown",ge)},[D]),a.jsx("div",{className:"variant-form-dialog",children:e&&a.jsx("div",{className:"crop-dialog-overlay",onClick:r,children:a.jsxs("div",{className:"dialog-wrapper",onClick:ge=>ge.stopPropagation(),children:[a.jsx("div",{className:"dialog-header",children:a.jsx("h2",{children:n?"Edit Variant":"Add Variant"})}),K&&a.jsx("div",{className:"error-message show",children:K}),a.jsxs("form",{onSubmit:i(ye),children:[a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"Color"}),a.jsxs("div",{ref:P,className:"color-picker-wrapper",children:[a.jsxs("div",{className:"color-input-wrapper",children:[a.jsx("input",{type:"text",className:"color-search-input",placeholder:"Search color...",value:z,onChange:ge=>{q(ge.target.value),W(!0)},onClick:()=>W(ge=>!ge)}),a.jsx("div",{className:"color-selected-preview",children:O?a.jsx("div",{className:"color-preview",style:{backgroundColor:O.hex}}):null})]}),D&&a.jsxs("div",{className:"color-dropdown",children:[a.jsx("div",{className:"color-option clear-option",onClick:()=>{H(null),q(""),W(!1)},children:a.jsx("div",{className:"color-name",children:"Clear selection"})},"__clear__"),ce.filter(ge=>(ge.name+" "+ge.value).toLowerCase().includes((z||"").toLowerCase())).map(ge=>a.jsxs("div",{className:`color-option ${(O==null?void 0:O.value)===ge.value?"selected":""}`,onClick:()=>{H(ge),q(ge.name),W(!1)},children:[a.jsx("div",{className:"color-box",style:{backgroundColor:ge.hex}}),a.jsx("div",{className:"color-name",children:ge.name})]},ge.value))]})]})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"Size"}),a.jsxs("select",{value:I,onChange:ge=>U(ge.target.value),children:[a.jsx("option",{value:"",children:y?"Loading sizes...":"None (Clear selection)"}),!y&&m.map(ge=>a.jsx("option",{value:ge.code,children:ge.code},ge.id))]}),C&&a.jsx("div",{className:"size-error",children:C})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"SKU"}),a.jsx("input",{type:"text",...o("sku",{required:!1})})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"Barcode"}),a.jsx("input",{type:"text",...o("barcode")})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"Purchase Cost"}),a.jsx("input",{type:"number",...o("purchaseCost")})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"Sales Price"}),a.jsx("input",{type:"number",...o("stdSalesPrice")})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"Stock"}),a.jsx("input",{type:"number",...o("stock")})]}),a.jsxs("div",{className:"form-field col-33",children:[a.jsx("label",{className:"field-label",children:"Lead Time (days)"}),a.jsx("input",{type:"number",...o("leadTime")})]}),a.jsxs("div",{className:"form-field full-width image-upload-section",children:[a.jsx("div",{className:"upload-button-wrapper",children:a.jsxs("label",{className:"upload-button",children:["Upload Files",a.jsx("input",{type:"file",multiple:!0,onChange:_e})]})}),a.jsx("div",{className:"images-preview",children:f.map((ge,De)=>{const He=ge.preview&&(ge.file?ge.file.type&&ge.file.type.startsWith("image/"):/\.(jpg|jpeg|png|gif|webp)$/i.test(ge.preview));return a.jsxs("div",{className:"image-item",children:[He?a.jsx("img",{src:ge.preview,alt:ge.name||"file",className:"image-preview"}):a.jsx("div",{className:"file-preview",children:ge.name||"file"}),He&&a.jsx("button",{type:"button",className:`main-image-badge ${De===ne?"active":"inactive"}`,onClick:()=>Y(De),title:De===ne?"Main image":"Set as main image",children:""}),a.jsxs("div",{className:"image-actions",children:[He&&a.jsx("button",{type:"button",className:"image-action-btn edit-btn",onClick:()=>le(De),children:"Edit"}),a.jsx("button",{type:"button",className:"image-action-btn remove-btn",onClick:()=>pe(De),children:"Remove"})]}),a.jsx("div",{className:"image-name",children:ge.name||ge.file&&ge.file.name})]},De)})})]}),k&&a.jsx("div",{className:"crop-dialog-overlay",onClick:()=>_(!1),children:a.jsxs("div",{className:"crop-dialog",onClick:ge=>ge.stopPropagation(),children:[a.jsxs("div",{className:"crop-header",children:[a.jsx("div",{className:"crop-title",children:"Edit Image"}),a.jsx("button",{type:"button",className:"close-btn",onClick:()=>_(!1),"aria-label":"close",children:""})]}),a.jsx("div",{className:"crop-content",children:R&&a.jsx("div",{style:{position:"relative",width:"100%",height:"40vh",maxHeight:600},children:a.jsx(Lw,{image:R,crop:V,zoom:Z,aspect:1,minZoom:.1,maxZoom:3,onCropChange:M,onZoomChange:J,onCropComplete:fe})})}),a.jsxs("div",{className:"crop-actions",children:[a.jsxs("div",{className:"zoom-slider",children:[a.jsx("label",{children:"Zoom"}),a.jsx("input",{type:"range",min:"0.1",max:"3",step:"0.1",value:Z,onChange:ge=>J(parseFloat(ge.target.value))})]}),a.jsxs("div",{className:"button-group",children:[a.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>_(!1),children:"Cancel"}),a.jsx("button",{type:"button",className:"apply-btn",onClick:ke,children:"Apply"})]})]})]})}),a.jsx("div",{className:"form-field col-33",children:a.jsxs("div",{className:"checkbox-wrapper",children:[a.jsx("input",{type:"checkbox",id:"isActive",...o("isActive")}),a.jsx("label",{htmlFor:"isActive",children:"Is Active"})]})})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{type:"button",className:"btn-secondary",onClick:r,children:"Cancel"}),a.jsx("button",{type:"submit",className:"btn-primary",children:n?"Update Variant":"Add Variant"})]})]})]})})})}function Iie(){var y;const{id:e}=Jv(),[r,t]=G.useState(null),[n,s]=G.useState(!1),[o,i]=G.useState(null),[c,u]=G.useState([]),[l,d]=G.useState(""),h=ii(),f=[{name:"RAL 1000 - Green beige",value:"RAL 1000",hex:"#CDBA88"},{name:"RAL 1001 - Beige",value:"RAL 1001",hex:"#D0B084"},{name:"RAL 1002 - Sand yellow",value:"RAL 1002",hex:"#D2AA6D"},{name:"RAL 1003 - Signal yellow",value:"RAL 1003",hex:"#F9A900"},{name:"RAL 1004 - Golden yellow",value:"RAL 1004",hex:"#E49E00"},{name:"RAL 1005 - Honey yellow",value:"RAL 1005",hex:"#CB8F00"},{name:"RAL 1006 - Maize yellow",value:"RAL 1006",hex:"#E19000"},{name:"RAL 1007 - Daffodil yellow",value:"RAL 1007",hex:"#E88C00"},{name:"RAL 1011 - Brown beige",value:"RAL 1011",hex:"#AF8050"},{name:"RAL 1012 - Lemon yellow",value:"RAL 1012",hex:"#DDAF28"},{name:"RAL 1013 - Oyster white",value:"RAL 1013",hex:"#E3D9C7"},{name:"RAL 1014 - Ivory",value:"RAL 1014",hex:"#DDC49B"},{name:"RAL 1015 - Light ivory",value:"RAL 1015",hex:"#E6D2B5"},{name:"RAL 1016 - Sulfur yellow",value:"RAL 1016",hex:"#F1DD39"},{name:"RAL 1017 - Saffron yellow",value:"RAL 1017",hex:"#F6A951"},{name:"RAL 1018 - Zinc yellow",value:"RAL 1018",hex:"#FACA31"},{name:"RAL 1019 - Grey beige",value:"RAL 1019",hex:"#A48F7A"},{name:"RAL 1020 - Olive yellow",value:"RAL 1020",hex:"#A08F65"},{name:"RAL 1021 - Colza yellow",value:"RAL 1021",hex:"#F6B600"},{name:"RAL 1023 - Traffic yellow",value:"RAL 1023",hex:"#F7B500"},{name:"RAL 1024 - Ochre yellow",value:"RAL 1024",hex:"#BA8F4C"},{name:"RAL 1026 - Luminous yellow",value:"RAL 1026",hex:"#FFFF00"},{name:"RAL 1027 - Curry",value:"RAL 1027",hex:"#A77F0F"},{name:"RAL 1028 - Melon yellow",value:"RAL 1028",hex:"#FF9C00"},{name:"RAL 1032 - Broom yellow",value:"RAL 1032",hex:"#E2A300"},{name:"RAL 1033 - Dahlia yellow",value:"RAL 1033",hex:"#F99A1D"},{name:"RAL 1034 - Pastel yellow",value:"RAL 1034",hex:"#EB9C52"},{name:"RAL 1035 - Pearl beige",value:"RAL 1035",hex:"#8F8370"},{name:"RAL 1036 - Pearl gold",value:"RAL 1036",hex:"#806440"},{name:"RAL 1037 - Sun yellow",value:"RAL 1037",hex:"#F09200"},{name:"RAL 2000 - Yellow orange",value:"RAL 2000",hex:"#DA6E00"},{name:"RAL 2001 - Red orange",value:"RAL 2001",hex:"#BA481C"},{name:"RAL 2002 - Vermilion",value:"RAL 2002",hex:"#BF3922"},{name:"RAL 2003 - Pastel orange",value:"RAL 2003",hex:"#F67829"},{name:"RAL 2004 - Pure orange",value:"RAL 2004",hex:"#E25304"},{name:"RAL 2005 - Luminous orange",value:"RAL 2005",hex:"#FF4D08"},{name:"RAL 2007 - Luminous bright orange",value:"RAL 2007",hex:"#FFB200"},{name:"RAL 2008 - Bright red orange",value:"RAL 2008",hex:"#EC6B22"},{name:"RAL 2009 - Traffic orange",value:"RAL 2009",hex:"#DE5308"},{name:"RAL 2010 - Signal orange",value:"RAL 2010",hex:"#D05D29"},{name:"RAL 2011 - Deep orange",value:"RAL 2011",hex:"#E26E0F"},{name:"RAL 2012 - Salmon orange",value:"RAL 2012",hex:"#D5654E"},{name:"RAL 2013 - Pearl orange",value:"RAL 2013",hex:"#923E25"},{name:"RAL 2017 - RAL orange",value:"RAL 2017",hex:"#FC5500"},{name:"RAL 3000 - Flame red",value:"RAL 3000",hex:"#A72920"},{name:"RAL 3001 - Signal red",value:"RAL 3001",hex:"#9B2423"},{name:"RAL 3002 - Carmine red",value:"RAL 3002",hex:"#9B2321"},{name:"RAL 3003 - Ruby red",value:"RAL 3003",hex:"#861A22"},{name:"RAL 3004 - Purple red",value:"RAL 3004",hex:"#6B1C23"},{name:"RAL 3005 - Wine red",value:"RAL 3005",hex:"#59191F"},{name:"RAL 3007 - Black red",value:"RAL 3007",hex:"#3E2022"},{name:"RAL 3009 - Oxide red",value:"RAL 3009",hex:"#6D342D"},{name:"RAL 3011 - Brown red",value:"RAL 3011",hex:"#782423"},{name:"RAL 3012 - Beige red",value:"RAL 3012",hex:"#C5856D"},{name:"RAL 3013 - Tomato red",value:"RAL 3013",hex:"#972E25"},{name:"RAL 3014 - Antique pink",value:"RAL 3014",hex:"#CB7375"},{name:"RAL 3015 - Light pink",value:"RAL 3015",hex:"#D8A0A6"},{name:"RAL 3016 - Coral red",value:"RAL 3016",hex:"#A63D30"},{name:"RAL 3017 - Rose",value:"RAL 3017",hex:"#CA555D"},{name:"RAL 3018 - Strawberry red",value:"RAL 3018",hex:"#C63F4A"},{name:"RAL 3020 - Traffic red",value:"RAL 3020",hex:"#BB1F11"},{name:"RAL 3022 - Salmon pink",value:"RAL 3022",hex:"#CF6955"},{name:"RAL 3024 - Luminous red",value:"RAL 3024",hex:"#FF2D21"},{name:"RAL 3026 - Luminous bright red",value:"RAL 3026",hex:"#FF2A1C"},{name:"RAL 3027 - Raspberry red",value:"RAL 3027",hex:"#AB273C"},{name:"RAL 3028 - Pure red",value:"RAL 3028",hex:"#CC2C24"},{name:"RAL 3031 - Orient red",value:"RAL 3031",hex:"#A63437"},{name:"RAL 3032 - Pearl ruby red",value:"RAL 3032",hex:"#701D24"},{name:"RAL 3033 - Pearl pink",value:"RAL 3033",hex:"#A53A2E"},{name:"RAL 4001 - Red lilac",value:"RAL 4001",hex:"#816183"},{name:"RAL 4002 - Red violet",value:"RAL 4002",hex:"#8D3C4B"},{name:"RAL 4003 - Heather violet",value:"RAL 4003",hex:"#C4618C"},{name:"RAL 4004 - Claret violet",value:"RAL 4004",hex:"#651E38"},{name:"RAL 4005 - Blue lilac",value:"RAL 4005",hex:"#76689A"},{name:"RAL 4006 - Traffic purple",value:"RAL 4006",hex:"#903373"},{name:"RAL 4007 - Purple violet",value:"RAL 4007",hex:"#47243C"},{name:"RAL 4008 - Signal violet",value:"RAL 4008",hex:"#844C82"},{name:"RAL 4009 - Pastel violet",value:"RAL 4009",hex:"#9D8692"},{name:"RAL 4010 - Telemagenta",value:"RAL 4010",hex:"#BB4077"},{name:"RAL 4011 - Pearl violet",value:"RAL 4011",hex:"#6E6387"},{name:"RAL 4012 - Pearl blackberry",value:"RAL 4012",hex:"#6A6B7F"},{name:"RAL 5000 - Violet blue",value:"RAL 5000",hex:"#304F6E"},{name:"RAL 5001 - Green blue",value:"RAL 5001",hex:"#0E4C64"},{name:"RAL 5002 - Ultramarine blue",value:"RAL 5002",hex:"#00387A"},{name:"RAL 5003 - Sapphire blue",value:"RAL 5003",hex:"#1F3855"},{name:"RAL 5004 - Black blue",value:"RAL 5004",hex:"#191E28"},{name:"RAL 5005 - Signal blue",value:"RAL 5005",hex:"#005387"},{name:"RAL 5007 - Brillant blue",value:"RAL 5007",hex:"#376B8C"},{name:"RAL 5008 - Grey blue",value:"RAL 5008",hex:"#2B3A44"},{name:"RAL 5009 - Azure blue",value:"RAL 5009",hex:"#215F78"},{name:"RAL 5010 - Gentian blue",value:"RAL 5010",hex:"#004F7C"},{name:"RAL 5011 - Steel blue",value:"RAL 5011",hex:"#1A2B3C"},{name:"RAL 5012 - Light blue",value:"RAL 5012",hex:"#0089B6"},{name:"RAL 5013 - Cobalt blue",value:"RAL 5013",hex:"#193153"},{name:"RAL 5014 - Pigeon blue",value:"RAL 5014",hex:"#637D96"},{name:"RAL 5015 - Sky blue",value:"RAL 5015",hex:"#007CAF"},{name:"RAL 5017 - Traffic blue",value:"RAL 5017",hex:"#005B8C"},{name:"RAL 5018 - Turquoise blue",value:"RAL 5018",hex:"#048B8C"},{name:"RAL 5019 - Capri blue",value:"RAL 5019",hex:"#005E83"},{name:"RAL 5020 - Ocean blue",value:"RAL 5020",hex:"#00414B"},{name:"RAL 5021 - Water blue",value:"RAL 5021",hex:"#007577"},{name:"RAL 5022 - Night blue",value:"RAL 5022",hex:"#222D5A"},{name:"RAL 5023 - Distant blue",value:"RAL 5023",hex:"#41698C"},{name:"RAL 5024 - Pastel blue",value:"RAL 5024",hex:"#6093AC"},{name:"RAL 5025 - Pearl gentian blue",value:"RAL 5025",hex:"#20697C"},{name:"RAL 5026 - Pearl night blue",value:"RAL 5026",hex:"#0F3052"},{name:"RAL 6000 - Patina green",value:"RAL 6000",hex:"#3C7460"},{name:"RAL 6001 - Emerald green",value:"RAL 6001",hex:"#366735"},{name:"RAL 6002 - Leaf green",value:"RAL 6002",hex:"#325928"},{name:"RAL 6003 - Olive green",value:"RAL 6003",hex:"#50533C"},{name:"RAL 6004 - Blue green",value:"RAL 6004",hex:"#024442"},{name:"RAL 6005 - Moss green",value:"RAL 6005",hex:"#114232"},{name:"RAL 6006 - Grey olive",value:"RAL 6006",hex:"#3C392E"},{name:"RAL 6007 - Bottle green",value:"RAL 6007",hex:"#2C3222"},{name:"RAL 6008 - Brown green",value:"RAL 6008",hex:"#36342A"},{name:"RAL 6009 - Fir green",value:"RAL 6009",hex:"#27352A"},{name:"RAL 6010 - Grass green",value:"RAL 6010",hex:"#4D6F39"},{name:"RAL 6011 - Reseda green",value:"RAL 6011",hex:"#6B7C59"},{name:"RAL 6012 - Black green",value:"RAL 6012",hex:"#2F3D3A"},{name:"RAL 6013 - Reed green",value:"RAL 6013",hex:"#7C765A"},{name:"RAL 6014 - Yellow olive",value:"RAL 6014",hex:"#474135"},{name:"RAL 6015 - Black olive",value:"RAL 6015",hex:"#3D3D36"},{name:"RAL 6016 - Turquoise green",value:"RAL 6016",hex:"#00694C"},{name:"RAL 6017 - May green",value:"RAL 6017",hex:"#587F40"},{name:"RAL 6018 - Yellow green",value:"RAL 6018",hex:"#60993B"},{name:"RAL 6019 - Pastel green",value:"RAL 6019",hex:"#B9CEAC"},{name:"RAL 6020 - Chrome green",value:"RAL 6020",hex:"#37422F"},{name:"RAL 6021 - Pale green",value:"RAL 6021",hex:"#8A9977"},{name:"RAL 6022 - Olive drab",value:"RAL 6022",hex:"#3A3327"},{name:"RAL 6024 - Traffic green",value:"RAL 6024",hex:"#008351"},{name:"RAL 6025 - Fern green",value:"RAL 6025",hex:"#5E6E3B"},{name:"RAL 6026 - Opal green",value:"RAL 6026",hex:"#005F4E"},{name:"RAL 6027 - Light green",value:"RAL 6027",hex:"#7EBAB5"},{name:"RAL 6028 - Pine green",value:"RAL 6028",hex:"#315442"},{name:"RAL 6029 - Mint green",value:"RAL 6029",hex:"#006F3D"},{name:"RAL 6032 - Signal green",value:"RAL 6032",hex:"#237F52"},{name:"RAL 6033 - Mint turquoise",value:"RAL 6033",hex:"#45877F"},{name:"RAL 6034 - Pastel turquoise",value:"RAL 6034",hex:"#7AADAC"},{name:"RAL 6035 - Pearl green",value:"RAL 6035",hex:"#194D25"},{name:"RAL 6036 - Pearl opal green",value:"RAL 6036",hex:"#04574B"},{name:"RAL 6037 - Pure green",value:"RAL 6037",hex:"#008B29"},{name:"RAL 6038 - Luminous green",value:"RAL 6038",hex:"#00B51B"},{name:"RAL 6039 - Fibrous green",value:"RAL 6039",hex:"#B3C43E"},{name:"RAL 7000 - Squirrel grey",value:"RAL 7000",hex:"#7A888E"},{name:"RAL 7001 - Silver grey",value:"RAL 7001",hex:"#8C979C"},{name:"RAL 7002 - Olive grey",value:"RAL 7002",hex:"#817863"},{name:"RAL 7003 - Moss grey",value:"RAL 7003",hex:"#797669"},{name:"RAL 7004 - Signal grey",value:"RAL 7004",hex:"#9A9B9B"},{name:"RAL 7005 - Mouse grey",value:"RAL 7005",hex:"#6B6E6B"},{name:"RAL 7006 - Beige grey",value:"RAL 7006",hex:"#766A5E"},{name:"RAL 7008 - Khaki grey",value:"RAL 7008",hex:"#745F3D"},{name:"RAL 7009 - Green grey",value:"RAL 7009",hex:"#5D6058"},{name:"RAL 7010 - Tarpaulin grey",value:"RAL 7010",hex:"#585C56"},{name:"RAL 7011 - Iron grey",value:"RAL 7011",hex:"#52595D"},{name:"RAL 7012 - Basalt grey",value:"RAL 7012",hex:"#575D5E"},{name:"RAL 7013 - Brown grey",value:"RAL 7013",hex:"#575044"},{name:"RAL 7015 - Slate grey",value:"RAL 7015",hex:"#4F5358"},{name:"RAL 7016 - Anthracite grey",value:"RAL 7016",hex:"#383E42"},{name:"RAL 7021 - Black grey",value:"RAL 7021",hex:"#2F3234"},{name:"RAL 7022 - Umbra grey",value:"RAL 7022",hex:"#4C4A44"},{name:"RAL 7023 - Concrete grey",value:"RAL 7023",hex:"#808076"},{name:"RAL 7024 - Graphite grey",value:"RAL 7024",hex:"#45494E"},{name:"RAL 7026 - Granite grey",value:"RAL 7026",hex:"#374345"},{name:"RAL 7030 - Stone grey",value:"RAL 7030",hex:"#928E85"},{name:"RAL 7031 - Blue grey",value:"RAL 7031",hex:"#5B686D"},{name:"RAL 7032 - Pebble grey",value:"RAL 7032",hex:"#B5B0A1"},{name:"RAL 7033 - Cement grey",value:"RAL 7033",hex:"#7F8274"},{name:"RAL 7034 - Yellow grey",value:"RAL 7034",hex:"#92886F"},{name:"RAL 7035 - Light grey",value:"RAL 7035",hex:"#C5C7C4"},{name:"RAL 7036 - Platinum grey",value:"RAL 7036",hex:"#979392"},{name:"RAL 7037 - Dusty grey",value:"RAL 7037",hex:"#7A7B7A"},{name:"RAL 7038 - Agate grey",value:"RAL 7038",hex:"#B0B0A9"},{name:"RAL 7039 - Quartz grey",value:"RAL 7039",hex:"#6B665E"},{name:"RAL 7040 - Window grey",value:"RAL 7040",hex:"#989EA1"},{name:"RAL 7042 - Traffic grey A",value:"RAL 7042",hex:"#8E9291"},{name:"RAL 7043 - Traffic grey B",value:"RAL 7043",hex:"#4F5250"},{name:"RAL 7044 - Silk grey",value:"RAL 7044",hex:"#B7B3A8"},{name:"RAL 7045 - Telegrey 1",value:"RAL 7045",hex:"#8D9295"},{name:"RAL 7046 - Telegrey 2",value:"RAL 7046",hex:"#7E868A"},{name:"RAL 7047 - Telegrey 4",value:"RAL 7047",hex:"#C8C8C7"},{name:"RAL 7048 - Pearl mouse grey",value:"RAL 7048",hex:"#817B73"},{name:"RAL 8000 - Green brown",value:"RAL 8000",hex:"#89693F"},{name:"RAL 8001 - Ochre brown",value:"RAL 8001",hex:"#9D622B"},{name:"RAL 8002 - Signal brown",value:"RAL 8002",hex:"#794D3E"},{name:"RAL 8003 - Clay brown",value:"RAL 8003",hex:"#7E4B27"},{name:"RAL 8004 - Copper brown",value:"RAL 8004",hex:"#8D4931"},{name:"RAL 8007 - Fawn brown",value:"RAL 8007",hex:"#70462B"},{name:"RAL 8008 - Olive brown",value:"RAL 8008",hex:"#724A25"},{name:"RAL 8011 - Nut brown",value:"RAL 8011",hex:"#5A3827"},{name:"RAL 8012 - Red brown",value:"RAL 8012",hex:"#66332B"},{name:"RAL 8014 - Sepia brown",value:"RAL 8014",hex:"#4A3526"},{name:"RAL 8015 - Chestnut brown",value:"RAL 8015",hex:"#5E2F26"},{name:"RAL 8016 - Mahogany brown",value:"RAL 8016",hex:"#4C2B20"},{name:"RAL 8017 - Chocolate brown",value:"RAL 8017",hex:"#442F29"},{name:"RAL 8019 - Grey brown",value:"RAL 8019",hex:"#3D3635"},{name:"RAL 8022 - Black brown",value:"RAL 8022",hex:"#1A1719"},{name:"RAL 8023 - Orange brown",value:"RAL 8023",hex:"#A45729"},{name:"RAL 8024 - Beige brown",value:"RAL 8024",hex:"#795038"},{name:"RAL 8025 - Pale brown",value:"RAL 8025",hex:"#755847"},{name:"RAL 8028 - Terra brown",value:"RAL 8028",hex:"#513A2A"},{name:"RAL 8029 - Pearl copper",value:"RAL 8029",hex:"#7F4031"},{name:"RAL 9001 - Cream",value:"RAL 9001",hex:"#E9E0D2"},{name:"RAL 9002 - Grey white",value:"RAL 9002",hex:"#D6D5CB"},{name:"RAL 9003 - Signal white",value:"RAL 9003",hex:"#ECECE7"},{name:"RAL 9004 - Signal black",value:"RAL 9004",hex:"#2B2B2C"},{name:"RAL 9005 - Jet black",value:"RAL 9005",hex:"#0E0E10"},{name:"RAL 9006 - White aluminium",value:"RAL 9006",hex:"#A1A1A0"},{name:"RAL 9007 - Grey aluminium",value:"RAL 9007",hex:"#868581"},{name:"RAL 9010 - Pure white",value:"RAL 9010",hex:"#F1EDE1"},{name:"RAL 9011 - Graphite black",value:"RAL 9011",hex:"#27292B"},{name:"RAL 9012 - Cleanroom white",value:"RAL 9012",hex:"#F8F2E1"},{name:"RAL 9016 - Traffic white",value:"RAL 9016",hex:"#F1F1EA"},{name:"RAL 9017 - Traffic black",value:"RAL 9017",hex:"#29292A"},{name:"RAL 9018 - Papyrus white",value:"RAL 9018",hex:"#C8CBC4"},{name:"RAL 9022 - Pearl light grey",value:"RAL 9022",hex:"#858583"},{name:"RAL 9023 - Pearl dark grey",value:"RAL 9023",hex:"#787B7A"}],p=S=>{!S||!S.Variants||(console.log(`Product ${S.ID} has ${S.Variants.length} variants`),S.Variants.forEach((C,L)=>{console.log(`Variant ${L} (${C.SKU}):`,{hasImages:Array.isArray(C.Images)&&C.Images.length>0,imageCount:Array.isArray(C.Images)?C.Images.length:0,images:C.Images})}))};G.useEffect(()=>{v(),ut.get(`${Je}/api/sizes`).then(S=>u(S.data.data||[])).catch(()=>alert("Failed to load sizes"))},[e]);const v=()=>{ut.get(`${Je}/api/products/${e}`).then(S=>{t(S.data),p(S.data)}).catch(S=>{console.error("Failed to load product:",S),alert("Failed to load product")})},g=async S=>{var L,O,H;if(d(""),r.Variants.filter((z,q)=>o===null||q!==o).map(z=>z.SKU).includes(S.SKU)){d("A variant with this SKU already exists. Please use a unique SKU.");return}try{console.log("Saving variant:",S);const z=Array.isArray(S.Files)&&S.Files.length>0;let q;if(S.ID)if(z){const D=new FormData,W={...S};D.append("variant",JSON.stringify(W)),S.Files.forEach(P=>D.append("images",P)),q=await ut.put(`${Je}/api/product_variants/${S.ID}`,D,{headers:{"Content-Type":"multipart/form-data"}})}else q=await ut.put(`${Je}/api/product_variants/${S.ID}`,S);else if(z){const D=new FormData,W={...S,ProductID:r.ID};D.append("variant",JSON.stringify(W)),S.Files.forEach(P=>D.append("images",P)),q=await ut.post(`${Je}/api/product_variants`,D,{headers:{"Content-Type":"multipart/form-data"}})}else q=await ut.post(`${Je}/api/product_variants`,{...S,ProductID:r.ID});s(!1),i(null),await v()}catch(z){(O=(L=z.response)==null?void 0:L.data)!=null&&O.error&&z.response.data.error.includes("duplicate key value")&&z.response.data.error.includes("uni_product_variants_sku")?d("A variant with this SKU already exists (backend check). Please use a unique SKU."):(console.error("Variant save failed:",((H=z.response)==null?void 0:H.data)||z.message),d("Failed to save variant"))}},m=async S=>{var L,O,H;const C=r.Variants[S];if(!C||!C.ID){console.error("Cannot delete variant: missing ID"),alert("Cannot delete variant: missing ID");return}if(window.confirm(`Are you sure you want to delete variant with SKU: ${C.SKU}?`))try{await ut.delete(`${Je}/api/product_variants/${C.ID}`);const z=[...r.Variants];z.splice(S,1),t({...r,Variants:z}),console.log(`Successfully deleted variant ${C.SKU}`)}catch(z){console.error("Failed to delete variant:",((L=z.response)==null?void 0:L.data)||z.message),alert(`Failed to delete variant: ${((H=(O=z.response)==null?void 0:O.data)==null?void 0:H.error)||z.message}`)}},b=()=>{i(null),console.log(o),s(!0)};return r?a.jsx("section",{className:"right-content",children:a.jsxs("div",{className:"variant-manager-paper",children:[l&&a.jsx("div",{className:"variant-error",children:l}),a.jsxs("h2",{className:"product-title",children:["Product: ",r.Name," (",r.Code,")"]}),a.jsxs("p",{className:"product-subtitle",children:["HSN: ",r.HsnSacCode,", GST: ",r.GstPercent,"%"]}),a.jsxs("p",{className:"product-info",children:["Importance: ",r.Importance," | Store: ",(y=r.Store)==null?void 0:y.Name]}),a.jsx("hr",{className:"divider"}),a.jsxs("div",{className:"header-section",children:[a.jsx("h3",{className:"variants-title",children:"Product Variants"}),a.jsxs("div",{className:"button-group",children:[a.jsx("button",{className:"btn btn-primary",onClick:b,children:"+ Add Variant"}),a.jsx("button",{className:"btn btn-warning",onClick:()=>{h("/ProductMaster")},children:"View Products"})]})]}),a.jsx("div",{className:"table-responsive",children:a.jsxs("table",{className:"variants-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:"col-color",children:"Color"}),a.jsx("th",{className:"col-size",children:"Size"}),a.jsx("th",{className:"col-sku",children:"SKU"}),a.jsx("th",{className:"col-barcode",children:"Barcode"}),a.jsx("th",{className:"col-purchase",children:"Purchase Cost"}),a.jsx("th",{className:"col-sales",children:"Sales Price"}),a.jsx("th",{className:"col-stock",children:"Stock"}),a.jsx("th",{className:"col-leadtime",children:"Lead Time"}),a.jsx("th",{className:"col-images",children:"Images"}),a.jsx("th",{className:"col-active",children:"Active"}),a.jsx("th",{className:"col-actions",children:"Actions"})]})}),a.jsx("tbody",{children:r.Variants.map((S,C)=>a.jsxs("tr",{children:[a.jsx("td",{className:"color-cell col-color",children:(()=>{let L=f.find(O=>O.hex.toLowerCase()===(S.Color||"").toLowerCase());return L||(L=f.find(O=>O.value.toLowerCase()===(S.Color||"").toLowerCase())),a.jsxs("div",{className:"color-display",children:[a.jsx("div",{className:"color-swatch",style:{backgroundColor:L?L.hex:S.Color||"#ffffff"}}),a.jsx("span",{className:"color-text",children:L?`${L.value} - ${L.name.split(" - ")[1]}`:S.Color||"N/A"})]})})()}),a.jsx("td",{className:"col-size",children:S.Size}),a.jsx("td",{className:"col-sku",children:S.SKU}),a.jsx("td",{className:"col-barcode",children:S.Barcode}),a.jsx("td",{className:"col-purchase",children:S.PurchaseCost}),a.jsx("td",{className:"col-sales",children:S.StdSalesPrice}),a.jsx("td",{className:"col-stock",children:S.Stock}),a.jsx("td",{className:"col-leadtime",children:S.LeadTime}),a.jsx("td",{className:"images-cell col-images",children:Array.isArray(S.Images)&&S.Images.length>0?a.jsxs("div",{className:"images-container",children:[S.Images.slice(0,3).map((L,O)=>{let H="";if(typeof L=="string"&&(L.startsWith("http://")||L.startsWith("https://")||L.startsWith("data:")))H=L;else if(typeof L=="string"&&L.trim()!==""){const q=L.replace(/\\/g,"/");q.startsWith("uploads/")?H=`${Je}/${q}`:H=`${Je}/uploads/${q}`}else H="https://via.placeholder.com/40?text=No+Image";console.log(`Rendering image ${O} for variant ${S.SKU}:`,{original:L,fullPath:H});const z=typeof S.MainImageIndex=="number"&&S.MainImageIndex===O||S.MainImage&&S.MainImage===L;return a.jsxs("div",{className:"image-wrapper",children:[a.jsx("img",{src:H,alt:`variant-${S.ID||O}-img-${O}`,className:"variant-image",onLoad:()=>console.log(`Successfully loaded image ${O} for ${S.SKU}`),onError:q=>{if(console.error(`Failed to load image for ${S.SKU}:`,{src:q.target.src,originalImg:L,variant:S.SKU}),typeof L=="string"&&!H.startsWith("http")&&!H.startsWith("data:")){const D=[`/uploads/${L.replace(/\\/g,"/")}`,`${window.location.origin}/uploads/${L.replace(/\\/g,"/")}`,`${Je}${L.startsWith("/")?"":"/"}${L.replace(/\\/g,"/")}`],W=P=>{if(P>=D.length){q.target.src="https://via.placeholder.com/40?text=Not+Found";return}console.log(`Trying alternative path ${P+1}/${D.length}: ${D[P]}`),q.target.src=D[P],q.target.onerror=()=>W(P+1)};W(0)}else q.target.src="https://via.placeholder.com/40?text=Error"}}),z&&a.jsx("div",{className:"main-image-indicator",title:"Main image",children:""})]},O)}),S.Images.length>3&&a.jsxs("span",{className:"more-images",children:["+",S.Images.length-3," more"]})]}):a.jsx("span",{className:"no-images",children:"No images"})}),a.jsx("td",{className:"col-active",children:S.IsActive?"Yes":"No"}),a.jsxs("td",{className:"actions-cell col-actions",children:[a.jsx("button",{type:"button",className:"btn btn-edit",title:`Edit ${S.SKU}`,"aria-label":`Edit ${S.SKU}`,onClick:()=>{i(C),s(!0)},children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,children:[a.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25z",fill:"currentColor"}),a.jsx("path",{d:"M20.71 7.04a1 1 0 0 0 0-1.41l-2.34-2.34a1 1 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z",fill:"currentColor"})]})}),a.jsx("button",{type:"button",className:"btn btn-delete",title:`Delete ${S.SKU}`,"aria-label":`Delete ${S.SKU}`,onClick:()=>m(C),children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,children:[a.jsx("path",{d:"M6 7h12v13a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2V7z",fill:"currentColor"}),a.jsx("path",{d:"M9 4h6l1 2H8l1-2z",fill:"currentColor"}),a.jsx("path",{d:"M10 11v6M14 11v6",stroke:"#fff",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round"})]})})]})]},C))})]})}),a.jsx(Die,{open:n,onClose:()=>{s(!1),i(null),v()},onSave:g,defaultValues:o!==null?r.Variants[o]:null,sizes:c})]})}):null}function Oie(){const[e,r]=G.useState([]),[t,n]=G.useState([]),[s,o]=G.useState(""),[i,c]=G.useState(!0),[u,l]=G.useState(null),[d,h]=G.useState({}),[f,p]=G.useState(!1),[v,g]=G.useState(null),[m,b]=G.useState({company_branch_id:"",bank_name:"",branch_name:"",branch_address:"",account_number:"",ifsc_code:"",balance:0});G.useEffect(()=>{y(),S()},[]);async function y(){try{const z=await ut.get(`${Je}/api/company-branches?limit=1000`),q=z.data&&z.data.data?z.data.data:z.data;Array.isArray(q)&&n(q)}catch(z){console.error("fetchBranches error",z),n([])}}async function S(){c(!0);try{const q=(await ut.get(`${Je}/api/company-branch-banks`)).data;Array.isArray(q)&&r(q)}catch(z){console.error("fetchBanks error",z),r([])}finally{c(!1)}}const C=e.filter(z=>{if(!s)return!0;const q=s.toLowerCase(),D=t.find(P=>P.id===z.company_branch_id),W=D?D.name:"";return String(W).toLowerCase().includes(q)||String(z.bank_name||"").toLowerCase().includes(q)||String(z.branch_name||"").toLowerCase().includes(q)||String(z.branch_address||"").toLowerCase().includes(q)||String(z.account_number||"").toLowerCase().includes(q)||String(z.ifsc_code||"").toLowerCase().includes(q)});function L(z){g(z.id),b({company_branch_id:z.company_branch_id||"",bank_name:z.bank_name||"",branch_name:z.branch_name||"",branch_address:z.branch_address||"",account_number:z.account_number||"",ifsc_code:z.ifsc_code||"",balance:z.balance||0}),p(!0)}async function O(z){var q,D;if(!z.id){alert("Cannot delete entries without ID");return}if(window.confirm("Are you sure you want to delete this bank record?"))try{await ut.delete(`${Je}/api/company-branch-banks/${z.id}`),r(W=>W.filter(P=>P.id!==z.id))}catch(W){console.error("Failed to delete bank",W),alert("Failed to delete bank: "+(((D=(q=W.response)==null?void 0:q.data)==null?void 0:D.error)||W.message))}}async function H(){var q,D;const z={company_branch_id:parseInt(m.company_branch_id),bank_name:m.bank_name,branch_name:m.branch_name,branch_address:m.branch_address,account_number:m.account_number,ifsc_code:m.ifsc_code,balance:parseFloat(m.balance)||0};if(!z.company_branch_id||!z.bank_name||!z.account_number){alert("Please fill company branch, bank name, and account number");return}try{if(v){const P=(await ut.put(`${Je}/api/company-branch-banks/${v}`,z)).data;r(I=>I.map(U=>U.id===v?P:U))}else{const P=(await ut.post(`${Je}/api/company-branch-banks`,z)).data;r(I=>[P,...I])}p(!1),g(null),b({company_branch_id:"",bank_name:"",branch_name:"",branch_address:"",account_number:"",ifsc_code:"",balance:0})}catch(W){console.error("Failed to create/update bank",W),alert("Failed to save bank: "+(((D=(q=W.response)==null?void 0:q.data)==null?void 0:D.error)||W.message))}}return a.jsxs("div",{className:"bank-root",children:[a.jsxs("div",{className:"bank-header",children:[a.jsx("h3",{children:"Manage Bank Accounts"}),a.jsx("div",{className:"bank-actions",children:a.jsx("button",{className:"btn primary",onClick:()=>{g(null),b({company_branch_id:"",bank_name:"",branch_name:"",branch_address:"",account_number:"",ifsc_code:"",balance:0}),p(!0)},children:"+ Add Bank"})})]}),a.jsx("div",{className:"bank-table-wrap",children:i?a.jsx("div",{className:"loading",children:"Loading..."}):a.jsxs("table",{className:"bank-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Company Branch"}),a.jsx("th",{children:"Bank Name"}),a.jsx("th",{children:"Account No."}),a.jsx("th",{children:"Branch"}),a.jsx("th",{children:"Branch Address"}),a.jsx("th",{children:"IFSC"}),a.jsx("th",{children:"Balance"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:C.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"muted",children:"No banks found"})}):C.map(z=>{const q=u===z.id,D=t.find(W=>W.id===z.company_branch_id);return a.jsxs("tr",{className:q?"editing":"",children:[a.jsx("td",{children:D?D.name:"-"}),a.jsx("td",{children:z.bank_name||""}),a.jsx("td",{children:z.account_number||""}),a.jsx("td",{children:z.branch_name||""}),a.jsx("td",{children:z.branch_address||""}),a.jsx("td",{children:z.ifsc_code||""}),a.jsx("td",{children:z.balance?`${z.balance.toLocaleString()}`:"0"}),a.jsxs("td",{children:[a.jsx("button",{className:"action-btn edit-btn",onClick:()=>L(z),title:"Edit",children:a.jsx(Yf,{})}),a.jsx("button",{className:"action-btn delete-btn",onClick:()=>O(z),title:"Delete",children:a.jsx(Zf,{})})]})]},z.id)})})]})}),f&&a.jsx("div",{className:"bank-modal",children:a.jsxs("div",{className:"bank-form",children:[a.jsx("h3",{children:v?"Edit Bank Detail":"Add a Bank Detail"}),a.jsxs("div",{className:"form-grid",children:[a.jsxs("label",{children:["Company Branch :",a.jsxs("select",{value:m.company_branch_id,onChange:z=>b(q=>({...q,company_branch_id:z.target.value})),children:[a.jsx("option",{value:"",children:"Select Branch"}),t.map(z=>a.jsx("option",{value:z.id,children:z.name},z.id))]})]}),a.jsxs("label",{children:["Bank Name :",a.jsx("input",{value:m.bank_name,onChange:z=>b(q=>({...q,bank_name:z.target.value}))})]}),a.jsxs("label",{children:["Account No. :",a.jsx("input",{value:m.account_number,onChange:z=>b(q=>({...q,account_number:z.target.value}))})]}),a.jsxs("label",{children:["Branch :",a.jsx("input",{value:m.branch_name,onChange:z=>b(q=>({...q,branch_name:z.target.value}))})]}),a.jsxs("label",{children:["Branch Address :",a.jsx("input",{value:m.branch_address,onChange:z=>b(q=>({...q,branch_address:z.target.value}))})]}),a.jsxs("label",{children:["IFSC :",a.jsx("input",{value:m.ifsc_code,onChange:z=>b(q=>({...q,ifsc_code:z.target.value}))})]}),a.jsxs("label",{children:["Balance :",a.jsx("input",{type:"number",step:"0.01",value:m.balance,onChange:z=>b(q=>({...q,balance:z.target.value}))})]})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{className:"btn primary",onClick:H,children:v?"Update":"Save"}),a.jsx("button",{className:"btn",onClick:()=>{p(!1),g(null),b({company_branch_id:"",bank_name:"",branch_name:"",branch_address:"",account_number:"",ifsc_code:"",balance:0})},children:"Cancel"})]})]})})]})}const Pie={"industry segments":["Accounting","Airlines/Aviation","Alternative Dispute Resolution","Alternative Medicine","Animation","Apparel & Fashion","Architecture & Planning","Arts & Crafts","Automotive","Aviation & Aerospace","Banking","Biotechnology","Broadcast Media","Building Materials","Business Supplies & Equipment","Capital Markets","Chemicals","Civic & Social Organization","Civil Engineering","Commercial Real Estate","Computer & Network Security","Computer Games","Computer Hardware","Computer Networking","Computer Software","Construction","Consumer Electronics","Consumer Goods","Consumer Services","Cosmetics","Dairy","Defense & Space","Design","Education Management","E-learning","Electrical & Electronic Manufacturing","Entertainment","Environmental Services","Events Services","Executive Office","Facilities Services","Farming","Financial Services","Fine Art","Fishery","Food & Beverages","Food Production","Fundraising","Furniture","Gambling & Casinos","Glass, Ceramics & Concrete","Government Administration","Government Relations","Graphic Design","Health, Wellness & Fitness","Higher Education","Hospital & Health Care","Hospitality","Human Resources","Import & Export","Individual & Family Services","Industrial Automation","Information Services","Information Technology & Services","Insurance","International Affairs","International Trade & Development","Internet","Investment Banking/Venture","Investment Management","Judiciary","Law Enforcement","Law Practice","Legal Services","Legislative Office","Leisure & Travel","Libraries","Logistics & Supply Chain","Luxury Goods & Jewelry","Machinery","Management Consulting","Maritime","Marketing & Advertising","Market Research","Mechanical or Industrial Engineering","Media Production","Medical Device","Medical Practice","Mental Health Care","Military","Mining & Metals","Motion Pictures & Film","Museums & Institutions","Music","Nanotechnology","Newspapers","Nonprofit Organization Management","Oil & Energy","Online Publishing","Outsourcing/Offshoring","Package/Freight Delivery","Packaging & Containers","Paper & Forest Products","Performing Arts","Pharmaceuticals","Philanthropy","Photography","Plastics","Political Organization","Primary/Secondary","Printing","Professional Training","Program Development","Public Policy","Public Relations","Public Safety","Publishing","Railroad Manufacture","Ranching","Real Estate","Recreational","Facilities & Services","Religious Institutions","Renewables & Environment","Research","Restaurants","Retail","Security & Investigations","Semiconductors","Shipbuilding","Sporting Goods","Sports","Staffing & Recruiting","Supermarkets","Telecommunications","Textiles","Think Tanks","Tobacco","Translation & Localization","Transportation/Trucking/Railroad","Utilities","Venture Capital","Veterinary","Warehousing","Wholesale","Wine & Spirits","Wireless","Writing & Editing"]},W3={1:"United States/Canada",7:"Russia/Kazakhstan",20:"Egypt",27:"South Africa",30:"Greece",31:"Netherlands",32:"Belgium",33:"France",34:"Spain",36:"Hungary",39:"Italy",40:"Romania",41:"Switzerland",43:"Austria",44:"United Kingdom",45:"Denmark",46:"Sweden",47:"Norway",48:"Poland",49:"Germany",51:"Peru",52:"Mexico",53:"Cuba",54:"Argentina",55:"Brazil",56:"Chile",57:"Colombia",58:"Venezuela",60:"Malaysia",61:"Australia",62:"Indonesia",63:"Philippines",64:"New Zealand",65:"Singapore",66:"Thailand",81:"Japan",82:"South Korea",84:"Vietnam",86:"China",90:"Turkey",91:"India",92:"Pakistan",93:"Afghanistan",94:"Sri Lanka",95:"Myanmar",98:"Iran",212:"Morocco",213:"Algeria",216:"Tunisia",218:"Libya",220:"Gambia",221:"Senegal",222:"Mauritania",223:"Mali",224:"Guinea",225:"Ivory Coast",226:"Burkina Faso",227:"Niger",228:"Togo",229:"Benin",230:"Mauritius",231:"Liberia",232:"Sierra Leone",233:"Ghana",234:"Nigeria",235:"Chad",236:"Central African Republic",237:"Cameroon",238:"Cape Verde",239:"Sao Tome and Principe",240:"Equatorial Guinea",241:"Gabon",242:"Congo",243:"DR Congo",244:"Angola",245:"Guinea-Bissau",246:"British Indian Ocean Territory",248:"Seychelles",249:"Sudan",250:"Rwanda",251:"Ethiopia",252:"Somalia",253:"Djibouti",254:"Kenya",255:"Tanzania",256:"Uganda",257:"Burundi",258:"Mozambique",260:"Zambia",261:"Madagascar",262:"Reunion",263:"Zimbabwe",264:"Namibia",265:"Malawi",266:"Lesotho",267:"Botswana",268:"Eswatini",269:"Comoros",290:"Saint Helena",291:"Eritrea",297:"Aruba",298:"Faroe Islands",299:"Greenland",350:"Gibraltar",351:"Portugal",352:"Luxembourg",353:"Ireland",354:"Iceland",355:"Albania",356:"Malta",357:"Cyprus",358:"Finland",359:"Bulgaria",370:"Lithuania",371:"Latvia",372:"Estonia",373:"Moldova",374:"Armenia",375:"Belarus",376:"Andorra",377:"Monaco",378:"San Marino",379:"Vatican City",380:"Ukraine",381:"Serbia",382:"Montenegro",383:"Kosovo",385:"Croatia",386:"Slovenia",387:"Bosnia and Herzegovina",389:"North Macedonia",420:"Czech Republic",421:"Slovakia",423:"Liechtenstein",500:"Falkland Islands",501:"Belize",502:"Guatemala",503:"El Salvador",504:"Honduras",505:"Nicaragua",506:"Costa Rica",507:"Panama",508:"Saint Pierre and Miquelon",509:"Haiti",590:"Guadeloupe",591:"Bolivia",592:"Guyana",593:"Ecuador",594:"French Guiana",595:"Paraguay",596:"Martinique",597:"Suriname",598:"Uruguay",599:"Netherlands Antilles",670:"East Timor",672:"Antarctica",673:"Brunei",674:"Nauru",675:"Papua New Guinea",676:"Tonga",677:"Solomon Islands",678:"Vanuatu",679:"Fiji",680:"Palau",681:"Wallis and Futuna",682:"Cook Islands",683:"Niue",685:"Samoa",686:"Kiribati",687:"New Caledonia",688:"Tuvalu",689:"French Polynesia",690:"Tokelau",691:"Micronesia",692:"Marshall Islands",850:"North Korea",852:"Hong Kong",853:"Macau",855:"Cambodia",856:"Laos",880:"Bangladesh",886:"Taiwan",960:"Maldives",961:"Lebanon",962:"Jordan",963:"Syria",964:"Iraq",965:"Kuwait",966:"Saudi Arabia",967:"Yemen",968:"Oman",970:"Palestine",971:"United Arab Emirates",972:"Israel",973:"Bahrain",974:"Qatar",975:"Bhutan",976:"Mongolia",977:"Nepal",992:"Tajikistan",993:"Turkmenistan",994:"Azerbaijan",995:"Georgia",996:"Kyrgyzstan",998:"Uzbekistan","1-242":"Bahamas","1-246":"Barbados","1-264":"Anguilla","1-268":"Antigua and Barbuda","1-284":"British Virgin Islands","1-340":"US Virgin Islands","1-345":"Cayman Islands","1-441":"Bermuda","1-473":"Grenada","1-649":"Turks and Caicos Islands","1-664":"Montserrat","1-670":"Northern Mariana Islands","1-671":"Guam","1-684":"American Samoa","1-721":"Sint Maarten","1-758":"Saint Lucia","1-767":"Dominica","1-784":"Saint Vincent and the Grenadines","1-787":"Puerto Rico","1-809":"Dominican Republic","1-829":"Dominican Republic","1-849":"Dominican Republic","1-868":"Trinidad and Tobago","1-869":"Saint Kitts and Nevis","1-876":"Jamaica"},zu={};Object.keys(W3).forEach(e=>{zu[e]=W3[e],zu["+"+e]=W3[e]});const Hs=[{name:"Afghanistan",code:"+93"},{name:"Albania",code:"+355"},{name:"Algeria",code:"+213"},{name:"Andorra",code:"+376"},{name:"Angola",code:"+244"},{name:"Argentina",code:"+54"},{name:"Armenia",code:"+374"},{name:"Australia",code:"+61"},{name:"Austria",code:"+43"},{name:"Azerbaijan",code:"+994"},{name:"Bahamas",code:"+1-242"},{name:"Bahrain",code:"+973"},{name:"Bangladesh",code:"+880"},{name:"Belarus",code:"+375"},{name:"Belgium",code:"+32"},{name:"Belize",code:"+501"},{name:"Benin",code:"+229"},{name:"Bhutan",code:"+975"},{name:"Bolivia",code:"+591"},{name:"Bosnia and Herzegovina",code:"+387"},{name:"Botswana",code:"+267"},{name:"Brazil",code:"+55"},{name:"Brunei",code:"+673"},{name:"Bulgaria",code:"+359"},{name:"Burkina Faso",code:"+226"},{name:"Burundi",code:"+257"},{name:"Cambodia",code:"+855"},{name:"Cameroon",code:"+237"},{name:"Canada",code:"+1"},{name:"Cape Verde",code:"+238"},{name:"Central African Republic",code:"+236"},{name:"Chad",code:"+235"},{name:"Chile",code:"+56"},{name:"China",code:"+86"},{name:"Colombia",code:"+57"},{name:"Comoros",code:"+269"},{name:"Congo",code:"+242"},{name:"Costa Rica",code:"+506"},{name:"Croatia",code:"+385"},{name:"Cuba",code:"+53"},{name:"Cyprus",code:"+357"},{name:"Czech Republic",code:"+420"},{name:"Denmark",code:"+45"},{name:"Djibouti",code:"+253"},{name:"Dominica",code:"+1-767"},{name:"Dominican Republic",code:"+1-809"},{name:"Ecuador",code:"+593"},{name:"Egypt",code:"+20"},{name:"El Salvador",code:"+503"},{name:"Equatorial Guinea",code:"+240"},{name:"Eritrea",code:"+291"},{name:"Estonia",code:"+372"},{name:"Eswatini",code:"+268"},{name:"Ethiopia",code:"+251"},{name:"Fiji",code:"+679"},{name:"Finland",code:"+358"},{name:"France",code:"+33"},{name:"Gabon",code:"+241"},{name:"Gambia",code:"+220"},{name:"Georgia",code:"+995"},{name:"Germany",code:"+49"},{name:"Ghana",code:"+233"},{name:"Greece",code:"+30"},{name:"Grenada",code:"+1-473"},{name:"Guatemala",code:"+502"},{name:"Guinea",code:"+224"},{name:"Guinea-Bissau",code:"+245"},{name:"Guyana",code:"+592"},{name:"Haiti",code:"+509"},{name:"Honduras",code:"+504"},{name:"Hungary",code:"+36"},{name:"Iceland",code:"+354"},{name:"India",code:"+91"},{name:"Indonesia",code:"+62"},{name:"Iran",code:"+98"},{name:"Iraq",code:"+964"},{name:"Ireland",code:"+353"},{name:"Israel",code:"+972"},{name:"Italy",code:"+39"},{name:"Jamaica",code:"+1-876"},{name:"Japan",code:"+81"},{name:"Jordan",code:"+962"},{name:"Kazakhstan",code:"+7"},{name:"Kenya",code:"+254"},{name:"Kiribati",code:"+686"},{name:"Kuwait",code:"+965"},{name:"Kyrgyzstan",code:"+996"},{name:"Laos",code:"+856"},{name:"Latvia",code:"+371"},{name:"Lebanon",code:"+961"},{name:"Lesotho",code:"+266"},{name:"Liberia",code:"+231"},{name:"Libya",code:"+218"},{name:"Liechtenstein",code:"+423"},{name:"Lithuania",code:"+370"},{name:"Luxembourg",code:"+352"},{name:"Madagascar",code:"+261"},{name:"Malawi",code:"+265"},{name:"Malaysia",code:"+60"},{name:"Maldives",code:"+960"},{name:"Mali",code:"+223"},{name:"Malta",code:"+356"},{name:"Marshall Islands",code:"+692"},{name:"Mauritania",code:"+222"},{name:"Mauritius",code:"+230"},{name:"Mexico",code:"+52"},{name:"Micronesia",code:"+691"},{name:"Moldova",code:"+373"},{name:"Monaco",code:"+377"},{name:"Mongolia",code:"+976"},{name:"Montenegro",code:"+382"},{name:"Morocco",code:"+212"},{name:"Mozambique",code:"+258"},{name:"Myanmar",code:"+95"},{name:"Namibia",code:"+264"},{name:"Nauru",code:"+674"},{name:"Nepal",code:"+977"},{name:"Netherlands",code:"+31"},{name:"New Zealand",code:"+64"},{name:"Nicaragua",code:"+505"},{name:"Niger",code:"+227"},{name:"Nigeria",code:"+234"},{name:"North Korea",code:"+850"},{name:"North Macedonia",code:"+389"},{name:"Norway",code:"+47"},{name:"Oman",code:"+968"},{name:"Pakistan",code:"+92"},{name:"Palau",code:"+680"},{name:"Palestine",code:"+970"},{name:"Panama",code:"+507"},{name:"Papua New Guinea",code:"+675"},{name:"Paraguay",code:"+595"},{name:"Peru",code:"+51"},{name:"Philippines",code:"+63"},{name:"Poland",code:"+48"},{name:"Portugal",code:"+351"},{name:"Qatar",code:"+974"},{name:"Romania",code:"+40"},{name:"Russia",code:"+7"},{name:"Rwanda",code:"+250"},{name:"Saint Kitts and Nevis",code:"+1-869"},{name:"Saint Lucia",code:"+1-758"},{name:"Saint Vincent and the Grenadines",code:"+1-784"},{name:"Samoa",code:"+685"},{name:"San Marino",code:"+378"},{name:"Sao Tome and Principe",code:"+239"},{name:"Saudi Arabia",code:"+966"},{name:"Senegal",code:"+221"},{name:"Serbia",code:"+381"},{name:"Seychelles",code:"+248"},{name:"Sierra Leone",code:"+232"},{name:"Singapore",code:"+65"},{name:"Slovakia",code:"+421"},{name:"Slovenia",code:"+386"},{name:"Solomon Islands",code:"+677"},{name:"Somalia",code:"+252"},{name:"South Africa",code:"+27"},{name:"South Korea",code:"+82"},{name:"South Sudan",code:"+211"},{name:"Spain",code:"+34"},{name:"Sri Lanka",code:"+94"},{name:"Sudan",code:"+249"},{name:"Suriname",code:"+597"},{name:"Sweden",code:"+46"},{name:"Switzerland",code:"+41"},{name:"Syria",code:"+963"},{name:"Taiwan",code:"+886"},{name:"Tajikistan",code:"+992"},{name:"Tanzania",code:"+255"},{name:"Thailand",code:"+66"},{name:"Togo",code:"+228"},{name:"Tonga",code:"+676"},{name:"Trinidad and Tobago",code:"+1-868"},{name:"Tunisia",code:"+216"},{name:"Turkey",code:"+90"},{name:"Turkmenistan",code:"+993"},{name:"Tuvalu",code:"+688"},{name:"Uganda",code:"+256"},{name:"Ukraine",code:"+380"},{name:"United Arab Emirates",code:"+971"},{name:"United Kingdom",code:"+44"},{name:"United States",code:"+1"},{name:"Uruguay",code:"+598"},{name:"Uzbekistan",code:"+998"},{name:"Vanuatu",code:"+678"},{name:"Vatican City",code:"+379"},{name:"Venezuela",code:"+58"},{name:"Vietnam",code:"+84"},{name:"Yemen",code:"+967"},{name:"Zambia",code:"+260"},{name:"Zimbabwe",code:"+263"}],Kc=JSON.parse(`["Achalpur","Achhnera","Adalaj","Adilabad","Adityapur","Adoni","Adoor","Adra","Adyar","Afzalpur","Agartala","Agra","Ahmedabad","Ahmednagar","Aizawl","Ajmer","Akola","Akot","Alappuzha","Aligarh","AlipurdUrban Agglomerationr","Alirajpur","Allahabad","Alwar","Amalapuram","Amalner","Ambejogai","Ambikapur","Amravati","Amreli","Amritsar","Amroha","Anakapalle","Anand","Anantapur","Anantnag","Anjangaon","Anjar","Ankleshwar","Arakkonam","Arambagh","Araria","Arrah","Arsikere","Aruppukkottai","Arvi","Arwal","Asansol","Asarganj","Ashok Nagar","Athni","Attingal","Aurangabad","Aurangabad","Azamgarh","Bagaha","Bageshwar","Bahadurgarh","Baharampur","Bahraich","Balaghat","Balangir","Baleshwar Town","Ballari","Balurghat","Bankura","Bapatla","Baramula","Barbil","Bargarh","Barh","Baripada Town","Barmer","Barnala","Barpeta","Batala","Bathinda","Begusarai","Belagavi","Bellampalle","Belonia","Bengaluru","Bettiah","BhabUrban Agglomeration","Bhadrachalam","Bhadrak","Bhagalpur","Bhainsa","Bharatpur","Bharuch","Bhatapara","Bhavnagar","Bhawanipatna","Bheemunipatnam","Bhilai Nagar","Bhilwara","Bhimavaram","Bhiwandi","Bhiwani","Bhongir","Bhopal","Bhubaneswar","Bhuj","Bikaner","Bilaspur","Bobbili","Bodhan","Bokaro Steel City","Bongaigaon City","Brahmapur","Buxar","Byasanagar","Chaibasa","Chalakudy","Chandausi","Chandigarh","Changanassery","Charkhi Dadri","Chatra","Chennai","Cherthala","Chhapra","Chhapra","Chikkamagaluru","Chilakaluripet","Chirala","Chirkunda","Chirmiri","Chittoor","Chittur-Thathamangalam","Coimbatore","Cuttack","Dalli-Rajhara","Darbhanga","Darjiling","Davanagere","Deesa","Dehradun","Dehri-on-Sone","Delhi","Deoghar","Dhamtari","Dhanbad","Dharmanagar","Dharmavaram","Dhenkanal","Dhoraji","Dhubri","Dhule","Dhuri","Dibrugarh","Dimapur","Diphu","Dumka","Dumraon","Durg","Eluru","English Bazar","Erode","Etawah","Faridabad","Faridkot","Farooqnagar","Fatehabad","Fatehpur Sikri","Fazilka","Firozabad","Firozpur Cantt.","Firozpur","Forbesganj","Gadwal","Gandhinagar","Gangarampur","Ganjbasoda","Gaya","Giridih","Goalpara","Gobichettipalayam","Gobindgarh","Godhra","Gohana","Gokak","Gooty","Gopalganj","Gudivada","Gudur","Gumia","Guntakal","Guntur","Gurdaspur","Gurgaon","Guruvayoor","Guwahati","Gwalior","Habra","Hajipur","Haldwani-cum-Kathgodam","Hansi","Hapur","Hardoi ","Hardwar","Hazaribag","Hindupur","Hisar","Hoshiarpur","Hubli-Dharwad","Hugli-Chinsurah","Hyderabad","Ichalkaranji","Imphal","Indore","Itarsi","Jabalpur","Jagdalpur","Jaggaiahpet","Jagraon","Jagtial","Jaipur","Jalandhar Cantt.","Jalandhar","Jalpaiguri","Jamalpur","Jammalamadugu","Jammu","Jamnagar","Jamshedpur","Jamui","Jangaon","Jatani","Jehanabad","Jhansi","Jhargram","Jharsuguda","Jhumri Tilaiya","Jind","Jodhpur","Jorhat","Kadapa","Kadi","Kadiri","Kagaznagar","Kailasahar","Kaithal","Kakinada","Kalimpong","Kalpi","Kalyan-Dombivali","Kamareddy","Kancheepuram","Kandukur","Kanhangad","Kannur","Kanpur","Kapadvanj","Kapurthala","Karaikal","Karimganj","Karimnagar","Karjat","Karnal","Karur","Karwar","Kasaragod","Kashipur","KathUrban Agglomeration","Katihar","Kavali","Kayamkulam","Kendrapara","Kendujhar","Keshod","Khair","Khambhat","Khammam","Khanna","Kharagpur","Kharar","Khowai","Kishanganj","Kochi","Kodungallur","Kohima","Kolar","Kolkata","Kollam","Koratla","Korba","Kot Kapura","Kota","Kothagudem","Kottayam","Kovvur","Koyilandy","Kozhikode","Kunnamkulam","Kurnool","Kyathampalle","Lachhmangarh","Ladnu","Ladwa","Lahar","Laharpur","Lakheri","Lakhimpur","Lakhisarai","Lakshmeshwar","Lal Gopalganj Nindaura","Lalganj","Lalganj","Lalgudi","Lalitpur","Lalsot","Lanka","Lar","Lathi","Latur","Lilong","Limbdi","Lingsugur","Loha","Lohardaga","Lonar","Lonavla","Longowal","Loni","Losal","Lucknow","Ludhiana","Lumding","Lunawada","Lunglei","Macherla","Machilipatnam","Madanapalle","Maddur","Madhepura","Madhubani","Madhugiri","Madhupur","Madikeri","Madurai","Magadi","Mahad","Mahalingapura","Maharajganj","Maharajpur","Mahasamund","Mahbubnagar","Mahe","Mahemdabad","Mahendragarh","Mahesana","Mahidpur","Mahnar Bazar","Mahuva","Maihar","Mainaguri","Makhdumpur","Makrana","Malaj Khand","Malappuram","Malavalli","Malda","Malegaon","Malerkotla","Malkangiri","Malkapur","Malout","Malpura","Malur","Manachanallur","Manasa","Manavadar","Manawar","Mancherial","Mandalgarh","Mandamarri","Mandapeta","Mandawa","Mandi Dabwali","Mandi","Mandideep","Mandla","Mandsaur","Mandvi","Mandya","Manendragarh","Maner","Mangaldoi","Mangaluru","Mangalvedhe","Manglaur","Mangrol","Mangrol","Mangrulpir","Manihari","Manjlegaon","Mankachar","Manmad","Mansa","Mansa","Manuguru","Manvi","Manwath","Mapusa","Margao","Margherita","Marhaura","Mariani","Marigaon","Markapur","Marmagao","Masaurhi","Mathabhanga","Mathura","Mattannur","Mauganj","Mavelikkara","Mavoor","Mayang Imphal","Medak","Medininagar (Daltonganj)","Medinipur","Meerut","Mehkar","Memari","Merta City","Mhaswad","Mhow Cantonment","Mhowgaon","Mihijam","Mira-Bhayandar","Mirganj","Miryalaguda","Modasa","Modinagar","Moga","Mohali","Mokameh","Mokokchung","Monoharpur","Moradabad","Morena","Morinda, India","Morshi","Morvi","Motihari","Motipur","Mount Abu","Mudabidri","Mudalagi","Muddebihal","Mudhol","Mukerian","Mukhed","Muktsar","Mul","Mulbagal","Multai","Mumbai","Mundargi","Mundi","Mungeli","Munger","Murliganj","Murshidabad","Murtijapur","Murwara (Katni)","Musabani","Mussoorie","Muvattupuzha","Muzaffarpur","Mysore","Nabadwip","Nabarangapur","Nabha","Nadbai","Nadiad","Nagaon","Nagapattinam","Nagar","Nagari","Nagarkurnool","Nagaur","Nagda","Nagercoil","Nagina","Nagla","Nagpur","Nahan","Naharlagun","Naidupet","Naihati","Naila Janjgir","Nainital","Nainpur","Najibabad","Nakodar","Nakur","Nalbari","Namagiripettai","Namakkal","Nanded-Waghala","Nandgaon","Nandivaram-Guduvancheri","Nandura","Nandurbar","Nandyal","Nangal","Nanjangud","Nanjikottai","Nanpara","Narasapuram","Narasaraopet","Naraura","Narayanpet","Nargund","Narkatiaganj","Narkhed","Narnaul","Narsinghgarh","Narsinghgarh","Narsipatnam","Narwana","Nashik","Nasirabad","Natham","Nathdwara","Naugachhia","Naugawan Sadat","Nautanwa","Navalgund","Navsari","Nawabganj","Nawada","Nawanshahr","Nawapur","Nedumangad","Neem-Ka-Thana","Neemuch","Nehtaur","Nelamangala","Nellikuppam","Nellore","Nepanagar","New Delhi","Neyveli (TS)","Neyyattinkara","Nidadavole","Nilambur","Nilanga","Nimbahera","Nirmal","Niwai","Niwari","Nizamabad","Nohar","Noida","Nokha","Nokha","Nongstoin","Noorpur","North Lakhimpur","Nowgong","Nowrozabad (Khodargama)","Nuzvid","O' Valley","Obra","Oddanchatram","Ongole","Orai","Osmanabad","Ottappalam","Ozar","P.N.Patti","Pachora","Pachore","Pacode","Padmanabhapuram","Padra","Padrauna","Paithan","Pakaur","Palacole","Palai","Palakkad","Palampur","Palani","Palanpur","Palasa Kasibugga","Palghar","Pali","Pali","Palia Kalan","Palitana","Palladam","Pallapatti","Pallikonda","Palwal","Palwancha","Panagar","Panagudi","Panaji","Panamattom","Panchkula","Panchla","Pandharkaoda","Pandharpur","Pandhurna","PandUrban Agglomeration","Panipat","Panna","Panniyannur","Panruti","Panvel","Pappinisseri","Paradip","Paramakudi","Parangipettai","Parasi","Paravoor","Parbhani","Pardi","Parlakhemundi","Parli","Partur","Parvathipuram","Pasan","Paschim Punropara","Pasighat","Patan","Pathanamthitta","Pathankot","Pathardi","Pathri","Patiala","Patna","Patratu","Pattamundai","Patti","Pattran","Pattukkottai","Patur","Pauni","Pauri","Pavagada","Pedana","Peddapuram","Pehowa","Pen","Perambalur","Peravurani","Peringathur","Perinthalmanna","Periyakulam","Periyasemur","Pernampattu","Perumbavoor","Petlad","Phagwara","Phalodi","Phaltan","Phillaur","Phulabani","Phulera","Phulpur","Phusro","Pihani","Pilani","Pilibanga","Pilibhit","Pilkhuwa","Pindwara","Pinjore","Pipar City","Pipariya","Piriyapatna","Piro","Pithampur","Pithapuram","Pithoragarh","Pollachi","Polur","Pondicherry","Ponnani","Ponneri","Ponnur","Porbandar","Porsa","Port Blair","Powayan","Prantij","Pratapgarh","Pratapgarh","Prithvipur","Proddatur","Pudukkottai","Pudupattinam","Pukhrayan","Pulgaon","Puliyankudi","Punalur","Punch","Pune","Punganur","Punjaipugalur","Puranpur","Puri","Purna","Purnia","PurqUrban Agglomerationzi","Purulia","Purwa","Pusad","Puthuppally","Puttur","Puttur","Qadian","Raayachuru","Rabkavi Banhatti","Radhanpur","Rae Bareli","Rafiganj","Raghogarh-Vijaypur","Raghunathganj","Raghunathpur","Rahatgarh","Rahuri","Raiganj","Raigarh","Raikot","Raipur","Rairangpur","Raisen","Raisinghnagar","Rajagangapur","Rajahmundry","Rajakhera","Rajaldesar","Rajam","Rajampet","Rajapalayam","Rajauri","Rajgarh (Alwar)","Rajgarh (Churu)","Rajgarh","Rajgir","Rajkot","Rajnandgaon","Rajpipla","Rajpura","Rajsamand","Rajula","Rajura","Ramachandrapuram","Ramagundam","Ramanagaram","Ramanathapuram","Ramdurg","Rameshwaram","Ramganj Mandi","Ramgarh","Ramnagar","Ramnagar","Ramngarh","Rampur Maniharan","Rampur","Rampura Phul","Rampurhat","Ramtek","Ranaghat","Ranavav","Ranchi","Ranebennuru","Rangia","Rania","Ranibennur","Ranipet","Rapar","Rasipuram","Rasra","Ratangarh","Rath","Ratia","Ratlam","Ratnagiri","Rau","Raurkela","Raver","Rawatbhata","Rawatsar","Raxaul Bazar","Rayachoti","Rayadurg","Rayagada","Reengus","Rehli","Renigunta","Renukoot","Reoti","Repalle","Revelganj","Rewa","Rewari","Rishikesh","Risod","Robertsganj","Robertson Pet","Rohtak","Ron","Roorkee","Rosera","Rudauli","Rudrapur","Rudrapur","Rupnagar","Sabalgarh","Sadabad","Sadalagi","Sadasivpet","Sadri","Sadulpur","Sadulshahar","Safidon","Safipur","Sagar","Sagara","Sagwara","Saharanpur","Saharsa","Sahaspur","Sahaswan","Sahawar","Sahibganj","Sahjanwa","Saidpur","Saiha","Sailu","Sainthia","Sakaleshapura","Sakti","Salaya","Salem","Salur","Samalkha","Samalkot","Samana","Samastipur","Sambalpur","Sambhal","Sambhar","Samdhan","Samthar","Sanand","Sanawad","Sanchore","Sandi","Sandila","Sanduru","Sangamner","Sangareddy","Sangaria","Sangli","Sangole","Sangrur","Sankarankovil","Sankari","Sankeshwara","Santipur","Sarangpur","Sardarshahar","Sardhana","Sarni","Sarsod","Sasaram","Sasvad","Satana","Satara","Sathyamangalam","Satna","Sattenapalle","Sattur","Saunda","Saundatti-Yellamma","Sausar","Savanur","Savarkundla","Savner","Sawai Madhopur","Sawantwadi","Sedam","Sehore","Sendhwa","Seohara","Seoni","Seoni-Malwa","Shahabad","Shahabad, Hardoi","Shahabad, Rampur","Shahade","Shahbad","Shahdol","Shahganj","Shahjahanpur","Shahpur","Shahpura","Shahpura","Shajapur","Shamgarh","Shamli","Shamsabad, Agra","Shamsabad, Farrukhabad","Shegaon","Sheikhpura","Shendurjana","Shenkottai","Sheoganj","Sheohar","Sheopur","Sherghati","Sherkot","Shiggaon","Shikaripur","Shikarpur, Bulandshahr","Shikohabad","Shillong","Shimla","Shirdi","Shirpur-Warwade","Shirur","Shishgarh","Shivamogga","Shivpuri","Sholavandan","Sholingur","Shoranur","Shrigonda","Shrirampur","Shrirangapattana","Shujalpur","Siana","Sibsagar","Siddipet","Sidhi","Sidhpur","Sidlaghatta","Sihor","Sihora","Sikanderpur","Sikandra Rao","Sikandrabad","Sikar","Silao","Silapathar","Silchar","Siliguri","Sillod","Silvassa","Simdega","Sindagi","Sindhagi","Sindhnur","Singrauli","Sinnar","Sira","Sircilla","Sirhind Fatehgarh Sahib","Sirkali","Sirohi","Sironj","Sirsa","Sirsaganj","Sirsi","Sirsi","Siruguppa","Sitamarhi","Sitapur","Sitarganj","Sivaganga","Sivagiri","Sivakasi","Siwan","Sohagpur","Sohna","Sojat","Solan","Solapur","Sonamukhi","Sonepur","Songadh","Sonipat","Sopore","Soro","Soron","Soyagaon","Sri Madhopur","Srikakulam","Srikalahasti","Srinagar","Srinagar","Srinivaspur","Srirampore","Srisailam Project (Right Flank Colony) Township","Srivilliputhur","Sugauli","Sujangarh","Sujanpur","Sullurpeta","Sultanganj","Sultanpur","Sumerpur","Sumerpur","Sunabeda","Sunam","Sundargarh","Sundarnagar","Supaul","Surandai","Surapura","Surat","Suratgarh","SUrban Agglomerationr","Suri","Suriyampalayam","Suryapet","Tadepalligudem","Tadpatri","Takhatgarh","Taki","Talaja","Talcher","Talegaon Dabhade","Talikota","Taliparamba","Talode","Talwara","Tamluk","Tanda","Tandur","Tanuku","Tarakeswar","Tarana","Taranagar","Taraori","Tarbha","Tarikere","Tarn Taran","Tasgaon","Tehri","Tekkalakote","Tenali","Tenkasi","Tenu dam-cum-Kathhara","Terdal","Tezpur","Thakurdwara","Thammampatti","Thana Bhawan","Thane","Thanesar","Thangadh","Thanjavur","Tharad","Tharamangalam","Tharangambadi","Theni Allinagaram","Thirumangalam","Thirupuvanam","Thiruthuraipoondi","Thiruvalla","Thiruvallur","Thiruvananthapuram","Thiruvarur","Thodupuzha","Thoubal","Thrissur","Thuraiyur","Tikamgarh","Tilda Newra","Tilhar","Tindivanam","Tinsukia","Tiptur","Tirora","Tiruchendur","Tiruchengode","Tiruchirappalli","Tirukalukundram","Tirukkoyilur","Tirunelveli","Tirupathur","Tirupathur","Tirupati","Tiruppur","Tirur","Tiruttani","Tiruvannamalai","Tiruvethipuram","Tiruvuru","Tirwaganj","Titlagarh","Tittakudi","Todabhim","Todaraisingh","Tohana","Tonk","Tuensang","Tuljapur","Tulsipur","Tumkur","Tumsar","Tundla","Tuni","Tura","Uchgaon","Udaipur","Udaipur","Udaipurwati","Udgir","Udhagamandalam","Udhampur","Udumalaipettai","Udupi","Ujhani","Ujjain","Umarga","Umaria","Umarkhed","Umbergaon","Umred","Umreth","Una","Unjha","Unnamalaikadai","Unnao","Upleta","Uran Islampur","Uran","Uravakonda","Urmar Tanda","Usilampatti","Uthamapalayam","Uthiramerur","Utraula","Vadakkuvalliyur","Vadalur","Vadgaon Kasba","Vadipatti","Vadnagar","Vadodara","Vaijapur","Vaikom","Valparai","Valsad","Vandavasi","Vaniyambadi","Vapi","Vapi","Varanasi","Varkala","Vasai-Virar","Vatakara","Vedaranyam","Vellakoil","Vellore","Venkatagiri","Veraval","Vidisha","Vijainagar, Ajmer","Vijapur","Vijayapura","Vijayawada","Vijaypur","Vikarabad","Vikramasingapuram","Viluppuram","Vinukonda","Viramgam","Virudhachalam","Virudhunagar","Visakhapatnam","Visnagar","Viswanatham","Vita","Vizianagaram","Vrindavan","Vyara","Wadgaon Road","Wadhwan","Wadi","Wai","Wanaparthy","Wani","Wankaner","Wara Seoni","Warangal","Wardha","Warhapur","Warisaliganj","Warora","Warud","Washim","Wokha","Yadgir","Yamunanagar","Yanam","Yavatmal","Yawal","Yellandu","Yemmiganur","Yerraguntla","Yevla","Zaidpur","Zamania","Zira","Zirakpur","Zunheboto"]`),Fie=["Mr","Mrs","Miss","Dr","Prof"],Bie=["Passport","Aadhaar Card","PAN Card","Driving License","Voter ID","Bank Statement","Address Proof","Photo","Certificate","Other"],H1=[{label:"Customer",value:"is_customer"},{label:"Supplier",value:"is_supplier"},{label:"Dealer",value:"is_dealer"},{label:"Distributor",value:"is_distributor"}],zie=({defaultValues:e=null,hierarchy:r=[],onSubmitUser:t})=>{const n=ii(),{register:s,handleSubmit:o,control:i,reset:c,watch:u,getValues:l,trigger:d,setValue:h,clearErrors:f,setError:p,formState:{isDirty:v,errors:g}}=Gl({mode:"onChange",defaultValues:{is_user:!1,is_customer:!1,is_supplier:!1,is_employee:!1,is_dealer:!1,is_distributor:!1,supplier_id:null,active:!0,salutation:"",gender:"",username:"",usercode:"",account_types:"",under_type:"",distributor_id:null,dealer_id:null,permanent_country:"",permanent_country_code:"",permanent_gstin:"",country:"",country_code:"",gstin:"",aadhar_number:"",pan_number:"",gstin_number:"",msme_no:""},shouldUnregister:!1}),m=vr.useRef(null);vr.useEffect(()=>{const Le=m.current;if(!Le)return;const rt=(ur,Rr,Kr)=>{const sr=document.createElement("input");return sr.type=ur,sr.name=Rr,sr.autocomplete=Kr,sr.style.position="absolute",sr.style.left="-9999px",sr.style.top="-9999px",sr.style.width="1px",sr.style.height="1px",sr.style.opacity="0",sr.setAttribute("aria-hidden","true"),sr},Ke=rt("text","prevent_autofill_username","username"),pt=rt("password","prevent_autofill_password","new-password");try{Le.prepend(pt),Le.prepend(Ke)}catch{}return Le.querySelectorAll("input, textarea, select").forEach(ur=>{try{ur.setAttribute("autocomplete","off"),ur.setAttribute("autocorrect","off"),ur.setAttribute("autocapitalize","off"),ur.setAttribute("spellcheck","false")}catch{}}),()=>{try{Ke.remove()}catch{}try{pt.remove()}catch{}}},[]);const[b,y]=vr.useState((e==null?void 0:e.additional_addresses)||[]),[S,C]=vr.useState([]),[L,O]=vr.useState([]),[H,z]=vr.useState([]),[q,D]=vr.useState([]),[W,P]=vr.useState([]),[I,U]=vr.useState(!1),[k,_]=vr.useState(null),[R,j]=vr.useState(null),[A,N]=vr.useState({x:0,y:0}),[V,M]=vr.useState(1),[Z,J]=vr.useState(null),[re,X]=vr.useState(!1),[ne,Y]=vr.useState(!1),[K,ee]=vr.useState(!1),ue=()=>Y(Le=>!Le),se=()=>ee(Le=>!Le),ce=Le=>{Le.preventDefault()},fe=()=>{y([...b,{}])},ve=Le=>{y(b.filter((rt,Ke)=>Ke!==Le))},_e=(Le,rt,Ke)=>{y(pt=>{const rr=[...pt];return rr[Le]={...rr[Le],[rt]:Ke},rr})},le=()=>{const Le=[u("account_types"),...L].filter(Boolean);if(H1.filter(Ke=>!Le.includes(Ke.value)).length===0){alert("All account types have already been selected.");return}O([...L,""]),z(Ke=>[...Ke,null]),D(Ke=>[...Ke,null])},ke=Le=>{const rt=L[Le];if(O(L.filter((Ke,pt)=>pt!==Le)),z(Ke=>Ke.filter((pt,rr)=>rr!==Le)),D(Ke=>Ke.filter((pt,rr)=>rr!==Le)),rt){const Ke=u("account_types"),pt=L.filter((ur,Rr)=>Rr!==Le);Ke===rt||pt.includes(rt)||h(rt,!1)}},Te=(Le,rt)=>{const Ke=L[Le];if(O(pt=>{const rr=[...pt];return rr[Le]=rt,rr}),rt&&h(rt,!0),Ke&&Ke!==rt){const pt=u("account_types"),rr=L.filter((Rr,Kr)=>Kr!==Le);pt===Ke||rr.includes(Ke)||h(Ke,!1)}rt!=="is_dealer"&&z(pt=>pt.map((rr,ur)=>ur===Le?null:rr)),rt!=="is_customer"&&D(pt=>pt.map((rr,ur)=>ur===Le?null:rr))};u("is_user",!1);const pe=u("account_types",""),ye=String(pe)==="is_dealer",ge=String(pe)==="is_distributor";u("same_as_permanent");const De=u("active",!0),He=u("permanent_country",""),[Xe,at]=vr.useState([]),[dt,wt]=vr.useState(!1),[$t,Bt]=vr.useState([]),[ft,tr]=vr.useState(!1),[Me,tt]=vr.useState([]),[Ze,St]=vr.useState(!1),[et,Ht]=vr.useState([]),[Nt,kt]=vr.useState(!1),[kr,Jt]=vr.useState([]),[Pt,Ur]=vr.useState(!1),[Lr,vt]=vr.useState([]),nr=u("assigned_department_id","");vr.useEffect(()=>{let Le=!1;return(async()=>{try{const Ke={page:1,limit:1e3},pt=await ut.get(`${Je}/departments`,{params:Ke}),rr=pt.data.departments||pt.data||[],ur=Array.isArray(rr)?rr:[];Le||vt(ur)}catch(Ke){console.warn("Failed to fetch departments for executive dropdown",Ke),Le||vt([])}})(),()=>{Le=!0}},[]);const Cr=vr.useMemo(()=>kr||[],[kr]),Dt=String(pe)==="is_customer",je=u("under_type",""),ct=u("distributor_id",null),nt=u("dealer_id",null);u("supplier_id",null),G.useEffect(()=>{Dt||(h("dealer_id",null),h("under_type",""))},[Dt,h]),G.useEffect(()=>{let Le=!1;const rt=async()=>{wt(!0);try{const Ke=await ut.get(`${Je}/api/users`,{params:{user_type:"distributor",limit:1e3}});if(!Le){const pt=Array.isArray(Ke.data.data)?Ke.data.data:Ke.data,ur=[{id:"direct",username:"Direct Dealer"}].concat(pt||[]);at(ur),je==="distributor"&&Ht(ur)}}catch(Ke){console.error("Failed to fetch distributors",Ke),at([{id:"direct",username:"Direct Dealer"}])}finally{Le||wt(!1)}};return(ye||Dt||L.includes("is_dealer")||L.includes("is_customer"))&&rt(),()=>{Le=!0}},[ye,Dt,L,je]),G.useEffect(()=>{let Le=!1;const rt=async()=>{St(!0);try{const Ke=await ut.get(`${Je}/api/users`,{params:{user_type:"supplier",limit:1e3}}),{data:pt}=Ke,rr=(pt==null?void 0:pt.data)||pt;Le||(tt(rr||[]),je==="supplier"&&Ht(rr||[]))}catch(Ke){console.error("Failed to fetch suppliers",Ke),tt([])}finally{Le||St(!1)}};return(ye||Dt||L.includes("is_dealer")||L.includes("is_customer"))&&rt(),()=>{Le=!0}},[ye,Dt,L,je]),G.useEffect(()=>{let Le=!1;const rt=async()=>{tr(!0);try{const Ke=await ut.get(`${Je}/api/users`,{params:{user_type:"dealer",limit:1e3}});if(!Le){const pt=Array.isArray(Ke.data.data)?Ke.data.data:Ke.data;Bt(pt||[]),je==="dealer"&&Ht(pt||[])}}catch(Ke){console.error("Failed to fetch dealers",Ke),Bt([])}finally{Le||tr(!1)}};return(ge||Dt||L.includes("is_distributor")||L.includes("is_customer"))&&rt(),()=>{Le=!0}},[ge,Dt,L,je]),G.useEffect(()=>{let Le=!1;const rt=async()=>{St(!0);try{const Ke=await ut.get(`${Je}/api/users`,{params:{user_type:"supplier",limit:1e3}});if(!Le){const pt=Array.isArray(Ke.data.data)?Ke.data.data:Ke.data;tt(pt||[]),je==="supplier"&&Ht(pt||[])}}catch(Ke){console.error("Failed to fetch suppliers",Ke),tt([])}finally{Le||St(!1)}};return(ye||L.includes("is_dealer"))&&je==="supplier"&&rt(),()=>{Le=!0}},[je,ye,L]),G.useEffect(()=>{if(!Dt){Ht([]);return}Ht(je==="distributor"?Xe||[]:je==="dealer"?$t||[]:je==="supplier"?Me||[]:[])},[je,Xe,$t,Me,Dt]),G.useEffect(()=>{let Le=!1;return(async()=>{if(!je){Ht([]);return}kt(!0);try{const Ke=await ut.get(`${Je}/api/users`,{params:{user_type:je,limit:1e3}});if(!Le){const pt=Array.isArray(Ke.data.data)?Ke.data.data:Ke.data;Ht(pt||[])}}catch(Ke){console.error("Failed to fetch under-type users",Ke),Le||Ht([])}finally{Le||kt(!1)}})(),()=>{Le=!0}},[je]),G.useEffect(()=>{let Le=!1;return nr?(async pt=>{var rr,ur,Rr,Kr,sr;Ur(!0);try{let jn=[];const Kt=[`${Je}/departments/${pt}/employees`,`${Je}/api/employees`,`${Je}/employees`];for(const Or of Kt)try{const wa=Or.includes("/departments/")?{}:{department_id:pt,limit:1e3},Vn=await ut.get(Or,{params:wa}),Xs=((rr=Vn.data)==null?void 0:rr.employees)||((ur=Vn.data)==null?void 0:ur.data)||Vn.data||[];if(jn=Array.isArray(Xs)?Xs:[],jn.length)break}catch{}const qt=(Lr||[]).find(Or=>String(Or.id)===String(pt));let Gr=null;qt&&(Gr=qt.head||qt.head_id||qt.headId||null);const fn=[];let rn=null;if(Gr&&typeof Gr=="object"&&Gr.id!=null?(rn=Gr.id,fn.push(Gr)):Gr&&(rn=Gr),rn&&!(jn||[]).some(Or=>String(Or.id)===String(rn))){const Or=[`${Je}/api/users/${rn}`,`${Je}/users/${rn}`,`${Je}/api/employees/${rn}`,`${Je}/api/employees/${rn}`];for(const wa of Or)try{const Vn=await ut.get(wa),Xs=((Rr=Vn.data)==null?void 0:Rr.data)||Vn.data;if(Xs&&Xs.id!=null){fn.push(Xs),rn=Xs.id;break}}catch{}}const $a=[];if(rn){const Or=["manager_id","reporting_to","reporting_to_id","supervisor_id","managerId","assigned_to","head_id"],wa=[`${Je}/api/employees`,`${Je}/api/employees`];for(const Vn of wa)for(const Xs of Or)try{const Qr={limit:1e3};Qr[Xs]=rn;const qn=await ut.get(Vn,{params:Qr}),ks=((Kr=qn.data)==null?void 0:Kr.employees)||((sr=qn.data)==null?void 0:sr.data)||qn.data||[],wn=Array.isArray(ks)?ks:[];if(wn.length){wn.forEach(ka=>{ka&&ka.id!=null&&$a.push(ka)});break}}catch{}}const la=[],ja=new Set,mn=Or=>{if(!Or||Or.id==null)return;const wa=String(Or.id);ja.has(wa)||(ja.add(wa),la.push(Or))};if(rn){const Or=fn.find(wa=>String(wa.id)===String(rn));Or&&mn(Or)}($a||[]).forEach(mn),(jn||[]).forEach(mn),Le||Jt(la)}catch(jn){console.error("Failed to fetch executives for department",jn),Le||Jt([])}finally{Le||Ur(!1)}})(nr):(async()=>{var pt;Ur(!0);try{const rr=await ut.get(`${Je}/api/employees/non-heads`),ur=((pt=rr.data)==null?void 0:pt.data)||rr.data;Le||Jt(Array.isArray(ur)?ur:[])}catch(rr){console.error("Failed to fetch executives (non-head employees)",rr),Le||Jt([])}finally{Le||Ur(!1)}})(),()=>{Le=!0}},[nr,Lr]),Dv({control:i,name:["address1","address2","address3","city","state","permanent_country","pincode"]}),G.useEffect(()=>{console.log("defaultValues:",e)},[e]),G.useEffect(()=>{if(e){const Le=(Kt=[])=>{const qt=e.documents||e.uploaded_documents||[],Gr=Kt.map(fn=>String(fn).toLowerCase());return qt.find(fn=>{const rn=String((fn==null?void 0:fn.doc_type)||(fn==null?void 0:fn.type)||"").toLowerCase();return Gr.some($a=>$a&&rn.includes($a))})||null},rt=(Kt=[],qt=[],Gr=["doc_number"])=>{for(const rn of qt)if(e[rn])return e[rn];const fn=Le(Kt);if(fn){for(const rn of Gr)if(fn[rn])return fn[rn]}return""},Ke=Kt=>Kt?typeof Kt=="string"?String(Kt).replace(/\s*\([^)]*\)\s*$/,"").trim():typeof Kt=="object"&&(Kt.name||Kt.country||Kt.label)||"":"",pt=Kt=>Kt?typeof Kt=="string"?/^\+/.test(Kt)||/^\d+$/.test(Kt)?Kt:"":typeof Kt=="object"&&(Kt.code||Kt.dial_code||Kt.dialCode||Kt.country_code)||"":"",rr=Kt=>{if(!Kt)return"";if(typeof Kt=="object"){const Gr=Ke(Kt);if(Gr)return Gr;const fn=pt(Kt);if(fn){const rn=fn.startsWith("+")?fn:"+"+fn.replace(/^\+/,"");return zu[rn]||zu[rn.replace(/^\+/,"")]||""}return""}const qt=String(Kt).trim();if(/^\+?\d[\d-]*$/.test(qt)){const Gr=qt.startsWith("+")?qt:"+"+qt.replace(/^\+/,"");return zu[Gr]||zu[Gr.replace(/^\+/,"")]||""}return qt},ur=Kt=>{if(!Kt)return"";if(typeof Kt=="object"){const fn=pt(Kt);if(fn)return fn.startsWith("+")?fn:"+"+fn.replace(/^\+/,"");const rn=Ke(Kt);if(rn){const $a=Hs.find(la=>la.name.toLowerCase()===rn.toLowerCase());if($a)return $a.code||""}return""}const qt=String(Kt).trim();if(/^\+?\d[\d-]*$/.test(qt))return qt.startsWith("+")?qt:"+"+qt.replace(/^\+/,"");const Gr=Hs.find(fn=>fn.name.toLowerCase()===qt.toLowerCase());return Gr&&Gr.code||""},Rr=Array.isArray(e.addresses)?e.addresses.find(Kt=>Kt.title==="Permanent"):null,Kr=Array.isArray(e.bank_accounts)&&e.bank_accounts.length>0?e.bank_accounts[0]:null;c({...e,dob:e.dob?e.dob.split("T")[0]:"",is_user:!!e.is_user,is_customer:!!e.is_customer,is_supplier:!!e.is_supplier,is_employee:!!e.is_employee,is_dealer:!!e.is_dealer,is_distributor:!!e.is_distributor,active:typeof e.active=="boolean"?e.active:!0,username:e.username||"",usercode:e.usercode||"",password:e.plain_password||"",confirmPassword:e.plain_password||"",distributor_id:e.distributor_id||null,dealer_id:e.dealer_id||null,business_name:e.business_name||"",companyname:e.company_name||"",industry_segment:e.industry_segment||"",designation:e.designation||"",title:e.title||"",address1:(Rr==null?void 0:Rr.address1)||e.permanent_address1||"",address2:(Rr==null?void 0:Rr.address2)||e.permanent_address2||"",address3:(Rr==null?void 0:Rr.address3)||e.permanent_address3||"",city:(Rr==null?void 0:Rr.city)||e.permanent_city||"",state:(Rr==null?void 0:Rr.state)||e.permanent_state||"",pincode:(Rr==null?void 0:Rr.pincode)||e.permanent_pincode||"",permanent_country:Ke((Rr==null?void 0:Rr.country)||e.permanent_country),permanent_country_code:ur((Rr==null?void 0:Rr.country_code)||(Rr==null?void 0:Rr.country)||e.permanent_country_code),permanent_gstin:(Rr==null?void 0:Rr.gstin)||(Rr==null?void 0:Rr.gstin_number)||e.permanent_gstin||"",country:Ke(e.country||e.country_code||e.permanent_country||(Rr==null?void 0:Rr.country)),country_code:ur(e.country_code||e.country||e.permanent_country_code||(Rr==null?void 0:Rr.country_code)||(Rr==null?void 0:Rr.country)),aadhar_number:rt(["aadhaar","aadhar","aadhaar card","aadhar card"],["aadhar_number","aadhaar"],["aadhar_number","doc_number"]),pan_number:rt(["pan","pan card","permanent account number"],["pan_number","pan"],["pan_number","doc_number"]),gstin_number:rt(["gstin","gst","goods and services tax"],["gstin_number","gstin"],["gstin_number","doc_number"]),msme_no:rt(["msme","micro small medium enterprise"],["msme_no","msmeno"],["msme_no","doc_number"]),bank_name:(Kr==null?void 0:Kr.bank_name)||"",branch_name:(Kr==null?void 0:Kr.branch_name)||"",branch_address:(Kr==null?void 0:Kr.branch_address)||"",account_number:(Kr==null?void 0:Kr.account_number)||"",ifsc_code:(Kr==null?void 0:Kr.ifsc_code)||""}),y(Array.isArray(e.addresses)?e.addresses.filter(Kt=>Kt.title!=="Permanent").map(Kt=>({id:Kt.id,address_type:Kt.title||"",address1:Kt.address1||"",address2:Kt.address2||"",address3:Kt.address3||"",city:Kt.city||"",state:Kt.state||"",country:rr(Kt.country),country_code:ur(Kt.country_code||Kt.country),pincode:Kt.pincode||"",gstin:Kt.gstin||Kt.gstin_number||"",keyValues:Kt.keyValues||Kt.key_values||Kt.key_value||[]})):[]),C(Array.isArray(e.bank_accounts)&&e.bank_accounts.length>1?e.bank_accounts.slice(1).map(Kt=>({id:Kt.id,bank_name:Kt.bank_name||"",branch_name:Kt.branch_name||"",branch_address:Kt.branch_address||"",account_number:Kt.account_number||"",ifsc_code:Kt.ifsc_code||"",keyValues:Kt.keyValues||Kt.key_values||Kt.key_value||[]})):[]),P(Array.isArray(e.documents)?e.documents.map(Kt=>{const qt=Kt.file_url?Kt.file_url.split(".").pop().toLowerCase():"";let Gr="";return["jpg","jpeg","png","gif","webp"].includes(qt)?Gr="image/"+(qt==="jpg"?"jpeg":qt):qt==="pdf"&&(Gr="application/pdf"),{id:Kt.id,document_type:Kt.doc_type||"",document_number:Kt.doc_number||"",file_url:Kt.file_url||"",type:Gr,name:Kt.doc_type||"Document",preview:ot(Kt)}}):[]);const sr=[];e.is_customer&&sr.push("is_customer"),e.is_supplier&&sr.push("is_supplier"),e.is_dealer&&sr.push("is_dealer"),e.is_distributor&&sr.push("is_distributor"),h("account_types",sr.length?sr[0]:"");const jn=sr.length>1?sr.slice(1):[];jn.length?(O(jn),z(jn.map(()=>null)),D(jn.map(()=>null))):(O([]),z([]),D([])),h("under_type",""),h("distributor_id",null),h("dealer_id",null)}},[e,c,h]),G.useEffect(()=>{if(!(e!=null&&e.id)||!r||r.length===0)return;const Le=sr=>({relationType:String(sr.relation_type||sr.RelationType||"").toLowerCase(),parentId:sr.parent_id||sr.ParentID||sr.parentId||null,childId:sr.child_id||sr.ChildID||sr.childId||null}),rt=r.filter(sr=>Le(sr).childId===e.id).map(Le),Ke=[],pt=[],rr=[];rt.forEach(sr=>{if(!sr||!sr.parentId)return;const jn=sr.relationType;(jn.includes("dealer-customer")||jn.includes("dealer_customer"))&&Ke.push(sr.parentId),(jn.includes("distributor-customer")||jn.includes("distributor_customer"))&&pt.push(sr.parentId),(jn.includes("distributor-dealer")||jn.includes("distributor_dealer"))&&rr.push(sr.parentId)});const ur=[];e.is_user&&ur.push("is_user"),e.is_customer&&ur.push("is_customer"),e.is_supplier&&ur.push("is_supplier"),e.is_dealer&&ur.push("is_dealer"),e.is_distributor&&ur.push("is_distributor");const Rr=ur.length>0?ur[0]:null,Kr=ur.length>1?ur.slice(1):[];if(Rr==="is_customer"&&(pt.length>0?(h("under_type","distributor",{shouldDirty:!1}),h("distributor_id",pt[0],{shouldDirty:!1}),h("dealer_id",null,{shouldDirty:!1})):Ke.length>0&&(h("under_type","dealer",{shouldDirty:!1}),h("dealer_id",Ke[0],{shouldDirty:!1}),h("distributor_id",null,{shouldDirty:!1}))),Rr==="is_dealer"&&rr.length>0&&(h("under_type","distributor",{shouldDirty:!1}),h("distributor_id",rr[0],{shouldDirty:!1})),Kr.length>0){const sr=[],jn=[];let Kt=Rr==="is_customer"&&Ke.length>0?1:0,qt=Rr==="is_customer"&&pt.length>0?1:0,Gr=Rr==="is_dealer"&&rr.length>0?1:0;Kr.forEach((fn,rn)=>{fn==="is_dealer"&&Gr<rr.length?(sr[rn]=rr[Gr],Gr++):sr[rn]=null,fn==="is_customer"?qt<pt.length?(jn[rn]="distributor",qt++):Kt<Ke.length?(jn[rn]=Ke[Kt],Kt++):jn[rn]=null:jn[rn]=null}),z(sr),D(jn)}},[e==null?void 0:e.id,r,h]),G.useEffect(()=>{if(!(e!=null&&e.id))return;let Le=!1;return(async()=>{try{const pt=(await ut.get(`${Je}/api/employee-user-mappings`)).data||[];if(Le)return;const rr=Array.isArray(pt)?pt.find(ur=>String(ur.user_id)===String(e.id)):null;rr&&h("assigned_executive_id",rr.employee_id,{shouldDirty:!1})}catch(Ke){console.error("Failed to fetch employee-user mappings for prefill",Ke)}})(),()=>{Le=!0}},[e==null?void 0:e.id,h]);const Pe=async(Le,rt,Ke=null)=>{try{const pt=await ut.get(`${Je}/api/users`),rr=Array.isArray(pt.data)?pt.data:pt.data.data||[],ur=Ke?rr.filter(sr=>sr.id!==Ke):rr;return ur.some(sr=>sr.email&&sr.email.toLowerCase()===Le.toLowerCase())?{isValid:!1,field:"email",message:"A user with this email already exists. Please use a different email address."}:ur.some(sr=>sr.mobile_number===rt)?{isValid:!1,field:"mobile_number",message:"A user with this mobile number already exists. Please use a different mobile number."}:{isValid:!0}}catch(pt){return console.error("Error validating unique fields:",pt),{isValid:!0}}},Qe=async Le=>await gt(Le,!1),gt=async(Le,rt=!1)=>{var Ke,pt,rr,ur,Rr;try{if(!(e!=null&&e.id)){const qt=await Pe(Le.email,Le.mobile_number);if(!qt.isValid)return alert(qt.message),!1}let Kr=null;if(Le.dob)try{const qt=new Date(Le.dob);isNaN(qt.getTime())||(Kr=qt.toISOString().split("T")[0])}catch(qt){console.error("Error formatting DOB:",qt)}const sr={usercode:Le.usercode||void 0,salutation:Le.salutation||void 0,firstname:Le.firstname||"",lastname:Le.lastname||"",dob:Kr,gender:Le.gender||"",country:Le.country||void 0,country_code:Le.country_code||"",account_types:Le.account_types||void 0,mobile_number:Le.mobile_number||"",whatsapp_number:Le.whatsapp_number||void 0,emergency_number:Le.emergency_number||void 0,alternate_number:Le.alternate_number||void 0,website:Le.website||void 0,email:Le.email||"",password:Le.password||void 0,username:Le.username||void 0,active:Le.active!==void 0?Le.active:!0,business_name:Le.business_name||void 0,company_name:Le.companyname||void 0,industry_segment:Le.industry_segment||void 0,designation:Le.designation||void 0,title:Le.title||void 0,is_user:Le.is_user||!1,is_customer:Le.is_customer||!1,is_supplier:Le.is_supplier||!1,is_employee:Le.is_employee||!1,is_dealer:Le.is_dealer||!1,is_distributor:Le.is_distributor||!1,permanent_address1:Le.address1||void 0,permanent_address2:Le.address2||void 0,permanent_address3:Le.address3||void 0,permanent_city:Le.city||void 0,permanent_state:Le.state||void 0,permanent_country:Le.permanent_country||void 0,permanent_country_code:Le.permanent_country_code||void 0,permanent_pincode:Le.pincode||void 0,permanent_gstin:Le.permanent_gstin||void 0,primary_bank_name:Le.bank_name||void 0,primary_branch_name:Le.branch_name||void 0,primary_branch_address:Le.branch_address||void 0,primary_account_number:Le.account_number||void 0,primary_ifsc_code:Le.ifsc_code||void 0,aadhar_number:Le.aadhar_number||void 0,pan_number:Le.pan_number||void 0,gstin_number:Le.gstin_number||Le.gstin||void 0,msme_no:Le.msme_no||void 0,assigned_executive_id:Le.assigned_executive_id||void 0},jn=[{field:"salutation",label:"Salutation"},{field:"firstname",label:"First name"},{field:"gender",label:"Gender"},{field:"country",label:"Country"},{field:"account_types",label:"Account type"},{field:"country_code",label:"Country code"},{field:"mobile_number",label:"Mobile number"},{field:"email",label:"Email"}];e!=null&&e.id||jn.push({field:"password",label:"Password"});for(const{field:qt,label:Gr}of jn)if(!sr[qt]){if(!rt){p(qt,{type:"manual",message:`${Gr} is required.`});const fn=Ir[qt]??0;oa(fn),alert(`${Gr} is required. Please fill it in the ${["Personal","User Type & Relation","Addresses / Bank / Docs","Authentication"][fn]} tab.`)}return!1}if(W&&W.length>0&&W.some(Gr=>!Gr.document_type||String(Gr.document_type).trim()===""))return rt||(p("documents",{type:"manual",message:"Please select a document type for all uploaded documents."}),oa(2),alert("Please select a document type for all uploaded documents.")),!1;let Kt;if(e!=null&&e.id){console.log("Updating user with payload:",sr);const qt=await ut.put(`${Je}/api/users/${e.id}`,sr);Kt=qt.data.user||qt.data}else{console.log("Creating new user with payload:",sr);const qt=await ut.post(`${Je}/api/users`,sr);Kt=qt.data.user||qt.data}try{if(Le.assigned_executive_id){try{await ut.delete(`${Je}/api/employees/remove-user`,{params:{user_id:Kt.id}})}catch(qt){console.debug("remove-user failed (may be none):",((Ke=qt==null?void 0:qt.response)==null?void 0:Ke.data)||qt.message||qt)}await ut.post(`${Je}/api/employees/assign-user`,{employee_id:Number(Le.assigned_executive_id),user_id:Kt.id})}else try{await ut.delete(`${Je}/api/employees/remove-user`,{params:{user_id:Kt.id}})}catch(qt){console.debug("remove-user failed when clearing mapping:",((pt=qt==null?void 0:qt.response)==null?void 0:pt.data)||qt.message||qt)}}catch(qt){console.error("Failed to sync employee-user mapping:",qt)}if(b&&b.length>0)try{for(const qt of b){const Gr={user_id:Kt.id,title:qt.address_type||"",address1:qt.address1||"",address2:qt.address2||"",address3:qt.address3||"",city:qt.city||"",state:qt.state||"",country:qt.country||"",country_code:qt.country_code||"",pincode:qt.pincode||"",gstin:qt.gstin||qt.gstin_number||qt.gst||qt.gst_number||void 0,keyValues:qt.keyValues||[]};qt.id?await ut.put(`${Je}/api/user-address/${qt.id}`,Gr):await ut.post(`${Je}/api/user-address`,Gr)}}catch(qt){console.error("Failed to save additional addresses:",qt)}if(S&&S.length>0)try{for(const qt of S){const Gr={user_id:Kt.id,bank_name:qt.bank_name||"",branch_name:qt.branch_name||"",branch_address:qt.branch_address||"",account_number:qt.account_number||"",ifsc_code:qt.ifsc_code||"",keyValues:qt.keyValues||[]};qt.id?await ut.put(`${Je}/api/user-bank/${qt.id}`,Gr):await ut.post(`${Je}/api/user-bank`,Gr)}}catch(qt){console.error("Failed to save additional bank accounts:",qt)}if(W&&W.length>0)try{for(const qt of W){const Gr=new FormData;Gr.append("user_id",Kt.id),Gr.append("doc_type",qt.document_type||qt.name||""),Gr.append("doc_number",qt.document_number||qt.documentNumber||""),qt.file&&Gr.append("file",qt.file);const fn=qt.id&&typeof qt.id=="number"&&qt.id<1e12&&(e==null?void 0:e.id);try{if(fn)await ut.put(`${Je}/api/document/${qt.id}`,Gr,{headers:{"Content-Type":"multipart/form-data"}});else{if(!qt.file){console.warn("Skipping creating document without file:",qt);continue}if(!qt.document_type&&!qt.name){console.warn("Skipping document upload - missing document_type:",qt);continue}await ut.post(`${Je}/api/document`,Gr,{headers:{"Content-Type":"multipart/form-data"}})}}catch(rn){console.error("Failed to save document:",qt.document_type||qt.name,((rr=rn.response)==null?void 0:rr.data)||rn.message)}}}catch(qt){console.error("Failed to save user documents:",qt)}try{const qt=Kt.id,Gr=[],fn=(ja,mn)=>{if(!mn)return;const Or=String(mn);if(Or==="direct"||Or==="none")return;const wa=Number(mn);!isNaN(wa)&&wa>0&&Gr.push({relation_type:ja,parent_id:wa,child_id:qt})},rn=String(pe),$a=String(je||"");rn==="is_customer"&&($a==="dealer"&&nt?fn("Dealer-Customer",nt):$a==="distributor"&&ct&&fn("Distributor-Customer",ct)),rn==="is_dealer"&&ct&&fn("Distributor-Dealer",ct),Array.isArray(L)&&L.length&&L.forEach((ja,mn)=>{if(ja==="is_dealer"){const Or=H[mn];fn("Distributor-Dealer",Or)}if(ja==="is_customer"){const Or=q[mn];Or==="distributor"?ct&&fn("Distributor-Customer",ct):fn("Dealer-Customer",Or)}});let la=[];try{const ja=await ut.get(`${Je}/api/hierarchical-users`,{params:{child_id:qt}});la=Array.isArray(ja.data)?ja.data:((ur=ja.data)==null?void 0:ur.data)||[]}catch{la=[]}if(Array.isArray(la)&&la.length){for(const ja of la)if(!(!ja||!ja.id))try{await ut.delete(`${Je}/api/hierarchical-users/${ja.id}`)}catch{}}for(const ja of Gr)try{await ut.post(`${Je}/api/hierarchical-users`,{parent_id:ja.parent_id,child_id:ja.child_id,relation_type:ja.relation_type})}catch(mn){console.error("Failed creating relation",ja,((Rr=mn==null?void 0:mn.response)==null?void 0:Rr.data)||mn.message)}}catch(qt){console.error("Failed to sync user relations",qt)}if(rt||(Yr(Kt),on(Kt.usercode||Kt.username||"")),t&&t(Kt),!rt)try{n("/users")}catch{}return Kt}catch(Kr){if(console.error("Error submitting user form:",Kr),Kr!=null&&Kr.response){console.error("Server responded with:",Kr.response.status,Kr.response.data);const sr=Kr.response.data,jn=Kr.response.status;if(jn===409){const Kt=(sr==null?void 0:sr.message)||(sr==null?void 0:sr.error)||"This information already exists",qt=sr==null?void 0:sr.field;alert(qt==="email"?"A user with this email already exists. Please use a different email address.":qt==="mobile_number"?"A user with this mobile number already exists. Please use a different mobile number.":qt==="usercode"?"A user with this usercode already exists. Please use a different usercode.":Kt)}else if(jn===400){const Kt=(sr==null?void 0:sr.message)||(sr==null?void 0:sr.error)||"Invalid request. Please check your input.";sr==null||sr.field;const qt=sr==null?void 0:sr.details;let Gr=Kt;qt&&(Gr+=`
Details: ${qt}`),alert(Gr)}else if(jn===500){const Kt=String((sr==null?void 0:sr.error)||(sr==null?void 0:sr.message)||"").toLowerCase();if(Kt.includes("duplicate key")||Kt.includes("unique constraint"))Kt.includes("email")?alert("A user with this email already exists. Please use a different email address."):Kt.includes("mobile_number")?alert("A user with this mobile number already exists. Please use a different mobile number."):Kt.includes("usercode")?alert("A user with this usercode already exists. Please use a different usercode."):alert("This information already exists for another user. Please check and try again with different values.");else{const qt=(sr==null?void 0:sr.details)||(sr==null?void 0:sr.error)||(sr==null?void 0:sr.message)||JSON.stringify(sr);alert(`Server error: ${qt}`)}}else{const Kt=(sr==null?void 0:sr.message)||(sr==null?void 0:sr.error)||`Server error (${jn})`;alert(Kt)}}else Kr!=null&&Kr.request?(console.error("No response received, request was:",Kr.request),alert("No response received from server. Please check if the backend is running.")):alert(`Error: ${Kr.message||"Something went wrong. Please try again."}`);return!1}},xe=Le=>{y(rt=>{const Ke=[...rt],pt=Array.isArray(Ke[Le].keyValues)?Ke[Le].keyValues:[];return Ke[Le]={...Ke[Le],keyValues:[...pt,{key:"",value:""}]},Ke})},Oe=(Le,rt)=>{y(Ke=>{const pt=[...Ke];return pt[Le].keyValues=(pt[Le].keyValues||[]).filter((rr,ur)=>ur!==rt),pt})},Ce=(Le,rt,Ke,pt)=>{y(rr=>{const ur=[...rr];return ur[Le].keyValues||(ur[Le].keyValues=[]),ur[Le].keyValues[rt]={...ur[Le].keyValues[rt],[Ke]:pt},ur})},de=()=>{C([...S,{}])},be=Le=>{C(S.filter((rt,Ke)=>Ke!==Le))},Se=(Le,rt,Ke)=>{C(pt=>{const rr=[...pt];return rr[Le]={...rr[Le],[rt]:Ke},rr})},Ne=Le=>{C(rt=>{const Ke=[...rt],pt=Array.isArray(Ke[Le].keyValues)?Ke[Le].keyValues:[];return Ke[Le]={...Ke[Le],keyValues:[...pt,{key:"",value:""}]},Ke})},ze=(Le,rt)=>{C(Ke=>{const pt=[...Ke];return pt[Le].keyValues=(pt[Le].keyValues||[]).filter((rr,ur)=>ur!==rt),pt})},Re=(Le,rt,Ke,pt)=>{C(rr=>{const ur=[...rr];return ur[Le].keyValues||(ur[Le].keyValues=[]),ur[Le].keyValues[rt]={...ur[Le].keyValues[rt],[Ke]:pt},ur})},Ie=Le=>{const Ke=Array.from(Le.target.files).map((pt,rr)=>({id:Date.now()+rr,file:pt,preview:URL.createObjectURL(pt),name:pt.name,type:pt.type,documentNumber:"",document_type:"",document_number:""}));P(pt=>[...pt,...Ke])},ae=Le=>{const rt=W.find(pt=>pt.id===Le);if(!rt)return;rt.id&&typeof rt.id=="number"&&rt.id<1e12?ut.delete(`${Je}/api/document/${rt.id}`).then(()=>{P(pt=>pt.filter(rr=>rr.id!==Le))}).catch(pt=>{var rr;console.error("Failed to delete document on server:",((rr=pt==null?void 0:pt.response)==null?void 0:rr.data)||pt.message),P(ur=>ur.filter(Rr=>Rr.id!==Le))}):(rt.preview&&URL.revokeObjectURL(rt.preview),P(pt=>pt.filter(rr=>rr.id!==Le)))},we=(Le,rt)=>{P(Ke=>Ke.map(pt=>pt.id===Le?{...pt,document_type:rt||"",name:rt||pt.name}:pt))},Fe=(Le,rt)=>{P(Ke=>Ke.map(pt=>pt.id===Le?{...pt,document_number:rt||"",documentNumber:rt||pt.documentNumber}:pt))},Ye=Le=>{const rt=Le.preview||(Le.file_url?Je+Le.file_url:null);if(!rt)return;X(!1);const Ke=new Image;Ke.crossOrigin="anonymous",Ke.onload=()=>{_(rt),j(Le.id),N({x:0,y:0}),M(1),J(null),X(!0),U(!0),console.log("AddOrEditUserForm: crop dialog opening (onload) for doc id=",Le.id,"src=",rt)},Ke.onerror=()=>{_(rt),j(Le.id),N({x:0,y:0}),M(1),J(null),X(!0),U(!0),console.log("AddOrEditUserForm: crop dialog opening (onerror) for doc id=",Le.id,"src=",rt)},Ke.src=rt};vr.useEffect(()=>{console.log("AddOrEditUserForm: cropDialogOpen=",I,"imageLoaded=",re,"cropImage=",!!k)},[I,re,k]);const me=(Le,rt)=>{J(rt)},Be=Le=>new Promise((rt,Ke)=>{const pt=new Image;pt.addEventListener("load",()=>rt(pt)),pt.addEventListener("error",rr=>Ke(rr)),pt.setAttribute("crossOrigin","anonymous"),pt.src=Le}),Ge=async(Le,rt)=>{const Ke=await Be(Le),pt=document.createElement("canvas"),rr=pt.getContext("2d");return pt.width=Math.max(1,Math.round(rt.width)),pt.height=Math.max(1,Math.round(rt.height)),rr.drawImage(Ke,Math.round(rt.x),Math.round(rt.y),Math.round(rt.width),Math.round(rt.height),0,0,pt.width,pt.height),new Promise(ur=>{pt.toBlob(Rr=>{ur(Rr)},"image/jpeg")})},mt=async()=>{if(!(!Z||!k))try{const Le=await Ge(k,Z),rt=new File([Le],"cropped-image.jpg",{type:"image/jpeg"}),Ke=URL.createObjectURL(rt);P(pt=>pt.map(rr=>rr.id===R?{...rr,file:rt,preview:Ke,name:"cropped-image.jpg"}:rr)),U(!1),_(null),j(null)}catch(Le){console.error("Error cropping image:",Le),alert("Failed to crop image. Please try again.")}},_t=()=>{U(!1),_(null),j(null)},ot=Le=>{if(!Le)return null;if(Le.preview)return Le.preview;if(Le.file_url)try{const rt=String(Je||"").replace(/\/$/,""),Ke=String(Le.file_url).replace(/^\.\//,"").replace(/^\/+/,"");return`${rt}/${Ke}`}catch{return Le.file_url}return null},xt=Le=>{const rt=ot(Le);if(!rt){alert("No file available to view");return}window.open(rt,"_blank","noopener,noreferrer")},zt=async Le=>{try{if(Le.file instanceof File){const Kr=URL.createObjectURL(Le.file),sr=document.createElement("a");sr.href=Kr,sr.download=Le.name||Le.file.name||"document",document.body.appendChild(sr),sr.click(),sr.remove(),URL.revokeObjectURL(Kr);return}const rt=ot(Le);if(!rt){alert("No file available to download");return}const Ke=await fetch(rt,{credentials:"include"});if(!Ke.ok)throw new Error("Failed to fetch file");const pt=await Ke.blob(),rr=URL.createObjectURL(pt),ur=document.createElement("a");ur.href=rr;const Rr=Le.name||Le.document_type||rt.split("/").pop()||"document";ur.download=Rr,document.body.appendChild(ur),ur.click(),ur.remove(),URL.revokeObjectURL(rr)}catch(rt){console.error("Download failed",rt),alert("Failed to download file")}},Vt=Pie["industry segments"]||[],Ar=Dv({control:i,name:"account_types",defaultValue:""});G.useEffect(()=>{typeof Ar=="string"&&H1.forEach(Le=>{h(Le.value,Ar===Le.value,{shouldDirty:!0,shouldTouch:!0})})},[Ar,h]);const[wr,Nr]=vr.useState(!1),[Dr,Yr]=vr.useState(null),[Vr,on]=vr.useState(""),xn=()=>Nr(!1),ia=async()=>{if(!Dr){xn(),n("/users");return}try{if(Vr&&Dr.usercode!==Vr){const Le={...Dr,usercode:Vr};await ut.put(`${Je}/api/users/${Dr.id}`,Le)}}catch(Le){console.error("Failed to update usercode:",Le)}xn(),n("/users")},[yn,oa]=vr.useState(0),Qn=()=>{let Le=[];yn===0?(()=>{const ur={salutation:"",firstname:"",lastname:"",dob:"",gender:"",mobile_number:"",email:"",country:"",country_code:"",website:"",address1:"",address2:"",address3:"",city:"",state:"",permanent_country:"",permanent_country_code:"",pincode:"",whatsapp_number:"",emergency_number:"",alternate_number:""};Object.entries(ur).forEach(([Rr,Kr])=>h(Rr,Kr,{shouldDirty:!0})),Le=Object.keys(ur)})():yn===1?(()=>{const ur={account_types:"",is_user:!1,is_customer:!1,is_supplier:!1,is_employee:!1,is_dealer:!1,is_distributor:!1,supplier_id:null,under_type:"",distributor_id:null,dealer_id:null,business_name:"",companyname:"",designation:"",title:"",industry_segment:""};Object.entries(ur).forEach(([Rr,Kr])=>h(Rr,Kr,{shouldDirty:!0})),Le=Object.keys(ur)})():yn===2?(()=>{const ur={bank_name:"",branch_name:"",branch_address:"",account_number:"",ifsc_code:"",address1:"",address2:"",address3:"",city:"",state:"",permanent_country:"",permanent_country_code:"",pincode:""};Object.entries(ur).forEach(([Rr,Kr])=>h(Rr,Kr,{shouldDirty:!0})),y([]),C([]),Le=Object.keys(ur).concat(["additional_addresses","additionalBankInfos"])})():yn===3&&(()=>{const ur={username:"",password:"",confirmPassword:"",usercode:"",aadhar_number:"",pan_number:"",gstin_number:"",msme_no:""};Object.entries(ur).forEach(([Rr,Kr])=>h(Rr,Kr,{shouldDirty:!0})),Le=Object.keys(ur)})();try{Le&&Le.length?f(Le):console.debug("No specific fields to clear errors for; skipping clearErrors()")}catch(ur){console.debug("clearErrors not available or failed",ur)}},za=()=>{oa(Le=>Math.max(Le-1,0))},pr={0:["salutation","firstname","gender","mobile_number","email","country"],1:["account_types"],2:[],3:["password","confirmPassword"]},Ir={salutation:0,firstname:0,lastname:0,dob:0,gender:0,country_code:0,country:0,mobile_number:0,whatsapp_number:0,emergency_number:0,alternate_number:0,website:0,email:0,business_name:0,company_name:0,industry_segment:0,designation:0,title:0,is_user:1,is_customer:1,is_supplier:1,is_employee:1,is_dealer:1,is_distributor:1,account_types:1,address1:2,address2:2,address3:2,city:2,state:2,permanent_country:2,permanent_country_code:2,pincode:2,permanent_gstin:2,bank_name:2,branch_name:2,branch_address:2,account_number:2,ifsc_code:2,aadhar_number:3,pan_number:3,gstin_number:3,msme_no:3,password:3,confirmPassword:3,username:3},$n=async()=>{const Le=pr[yn]||[];if(Le.length){const rt=await d(Le),Ke=l();if(console.debug("handleNextWithValidation",{tabIndex:yn,fields:Le,ok:rt,values:Ke,errors:g}),!rt){const pt=[{field:"salutation",label:"Salutation"},{field:"gender",label:"Gender"},{field:"country",label:"Country"},{field:"account_types",label:"Account type"}];for(const{field:rr,label:ur}of pt)if(Le.includes(rr)&&!Ke[rr]){p(rr,{type:"manual",message:`${ur} is required`});const Rr=Ir[rr]??yn;oa(Rr);break}return}try{Le.forEach(pt=>{g[pt]&&f(pt)})}catch(pt){console.warn("Error clearing field errors",pt)}}oa(rt=>Math.min(rt+1,3))},Fr=async()=>{if(console.log("handleFormSubmit called"),!await d()){const Ke=l(),pt=[{field:"salutation",label:"Salutation"},{field:"gender",label:"Gender"},{field:"country",label:"Country"},{field:"account_types",label:"Account type"}];for(const{field:ur,label:Rr}of pt)Ke[ur]||p(ur,{type:"manual",message:`${Rr} is required`});const rr=Object.keys(g);if(rr.length>0){const ur=rr[0],Rr=Ir[ur]??0;oa(Rr),alert(`Please fill in the required fields. The first error is in the ${["Personal","User Type & Relation","Addresses / Bank / Docs","Authentication"][Rr]} tab.`)}return}console.log("Form validation passed, calling handleSubmit");const rt=await o(Qe)();if(console.log("handleSubmit result:",rt),rt)try{const Ke=rt;console.log("Created user:",Ke),Ke&&(Ke.id||Ke.usercode||Ke.username)&&(Yr(Ke),on(Ke.usercode||Ke.username||""),n("/users"))}catch(Ke){console.error("Error in dialog setup:",Ke)}},jr=async()=>{const Le=pr[yn]||[];let rt=!0;if(Le.length&&(rt=await d(Le)),!rt){const pt=Object.keys(g);if(pt.length>0){const rr=pt[0],ur=Ir[rr]??0;oa(ur),alert(`Please fill in the required fields in the ${["Personal","User Type & Relation","Addresses / Bank / Docs","Authentication"][ur]} tab.`)}return}const Ke=l();yn<3?await gt(Ke,!0):await Fr()};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"user-form-container",children:a.jsxs("form",{onSubmitCapture:Le=>{Le.preventDefault(),Fr()},onKeyDown:Le=>{Le.key==="Enter"&&Le.preventDefault()},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[a.jsx("h2",{style:{margin:0,fontSize:"24px",fontWeight:600},children:e?"Edit User":"Add User"}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[a.jsxs("div",{className:"form-switch",children:[a.jsx("input",{type:"checkbox",id:"status-toggle",checked:De,onChange:Le=>h("active",Le.target.checked,{shouldDirty:!0,shouldTouch:!0})}),a.jsx("label",{htmlFor:"status-toggle",children:De?"Active":"Inactive"})]}),a.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>n("/users"),children:"View"})]})]}),a.jsxs("div",{className:"form-tabs-wrapper",children:[a.jsx("button",{type:"button",className:`form-tab ${yn===0?"active":""}`,onClick:()=>oa(0),children:"PERSONAL"}),a.jsx("button",{type:"button",className:`form-tab ${yn===1?"active":""}`,onClick:()=>oa(1),children:"USER TYPE & RELATION"}),a.jsx("button",{type:"button",className:`form-tab ${yn===2?"active":""}`,onClick:()=>oa(2),children:"ADDRESSES / BANK / DOCS"}),a.jsx("button",{type:"button",className:`form-tab ${yn===3?"active":""}`,onClick:()=>oa(3),children:"AUTHENTICATION"})]}),a.jsx("div",{className:"tab-content",style:{display:yn===0?"block":"none"},children:a.jsxs("div",{className:"form-grid",children:[a.jsx("h3",{className:"subsection-header",style:{gridColumn:"span 12"},children:"Personal Information"}),a.jsx("div",{className:"grid-col md-2 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsxs("label",{className:"form-label",children:["Salutation ",a.jsx("span",{className:"required",children:"*"})]}),a.jsx(En,{name:"salutation",control:i,rules:{required:"Salutation is required"},render:({field:Le})=>a.jsxs(a.Fragment,{children:[a.jsxs("select",{...Le,className:`form-select ${g.salutation?"error":""}`,children:[a.jsx("option",{value:"",children:"Select"}),Fie.map(rt=>a.jsx("option",{value:rt,children:rt},rt))]}),g.salutation&&a.jsx("span",{className:"form-helper-text error",children:g.salutation.message})]})})]})}),a.jsx("div",{className:"grid-col md-3 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsxs("label",{className:"form-label",children:["First Name ",a.jsx("span",{className:"required",children:"*"})]}),a.jsx("input",{type:"text",className:`form-input ${g.firstname?"error":""}`,...s("firstname",{required:"First name is required"})}),g.firstname&&a.jsx("span",{className:"form-helper-text error",children:g.firstname.message})]})}),a.jsx("div",{className:"grid-col md-3 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"form-label",children:"Last Name"}),a.jsx("input",{type:"text",className:`form-input ${g.lastname?"error":""}`,...s("lastname")}),g.lastname&&a.jsx("span",{className:"form-helper-text error",children:g.lastname.message})]})}),a.jsx("div",{className:"grid-col md-2 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"form-label",children:"Date of Birth"}),a.jsx("input",{type:"date",className:"form-input",...s("dob")})]})}),a.jsx("div",{className:"grid-col md-2 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsxs("label",{className:"form-label",children:["Gender ",a.jsx("span",{className:"required",children:"*"})]}),a.jsx(En,{name:"gender",control:i,rules:{required:"Gender is required"},render:({field:Le})=>a.jsxs(a.Fragment,{children:[a.jsxs("select",{...Le,className:`form-select ${g.gender?"error":""}`,children:[a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{value:"Male",children:"Male"}),a.jsx("option",{value:"Female",children:"Female"}),a.jsx("option",{value:"Other",children:"Other"})]}),g.gender&&a.jsx("span",{className:"form-helper-text error",children:g.gender.message})]})})]})}),a.jsx("h3",{className:"subsection-header",style:{gridColumn:"span 12"},children:"Contact Information"}),a.jsx("div",{className:"grid-col md-3 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsxs("label",{className:"form-label",children:["Country ",a.jsx("span",{className:"required",children:"*"})]}),a.jsx(En,{name:"country",control:i,rules:{required:"Country is required"},render:({field:Le})=>a.jsxs(a.Fragment,{children:[a.jsxs("select",{value:Le.value||"",onChange:rt=>{const Ke=rt.target.value||"";Le.onChange(Ke);const pt=Hs.find(rr=>rr.name===Ke);h("country_code",pt&&pt.code||"")},className:`form-select ${g.country?"error":""}`,children:[a.jsx("option",{value:"",children:"Select Country"}),Hs.map(rt=>a.jsxs("option",{value:rt.name,children:[rt.name," (",rt.code,")"]},rt.name))]}),g.country&&a.jsx("span",{className:"form-helper-text error",children:g.country.message})]})}),a.jsx(En,{name:"country_code",control:i,render:({field:Le})=>a.jsx("input",{type:"hidden",...Le})})]})}),a.jsx("div",{className:"grid-col md-3 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsxs("label",{className:"form-label",children:["Mobile Number ",a.jsx("span",{className:"required",children:"*"})]}),a.jsx("input",{type:"tel",className:`form-input ${g.mobile_number?"error":""}`,...s("mobile_number",{required:"Mobile number is required"})}),g.mobile_number&&a.jsx("span",{className:"form-helper-text error",children:g.mobile_number.message})]})}),a.jsx("div",{className:"grid-col md-3 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsxs("label",{className:"form-label",children:["Email ",a.jsx("span",{className:"required",children:"*"})]}),a.jsx("input",{type:"email",className:`form-input ${g.email?"error":""}`,...s("email",{required:"Email is required"})}),g.email&&a.jsx("span",{className:"form-helper-text error",children:g.email.message})]})}),a.jsx("div",{className:"grid-col md-3 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"form-label",children:"WhatsApp Number"}),a.jsx("input",{type:"tel",className:"form-input",...s("whatsapp_number")})]})}),a.jsx("div",{className:"grid-col md-3 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"form-label",children:"Emergency Number"}),a.jsx("input",{type:"tel",className:"form-input",...s("emergency_number")})]})}),a.jsxs("div",{style:{gridColumn:"1 / -1",display:"grid",gridTemplateColumns:"repeat(12, 1fr)",gap:"16px"},children:[a.jsx("div",{className:"grid-col md-3 xs-12",style:{gridColumn:"span 3"},children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"form-label",children:"Alternate Contact No"}),a.jsx("input",{type:"tel",className:"form-input",...s("alternate_number")})]})}),a.jsx("div",{className:"grid-col md-3 xs-12",style:{gridColumn:"span 3"},children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"form-label",children:"Website"}),a.jsx("input",{type:"url",className:"form-input",...s("website")})]})})]}),a.jsx("h3",{className:"subsection-header",style:{gridColumn:"span 12"},children:"Permanent Address"}),a.jsx("div",{className:"grid-col md-3 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"form-label",children:"GSTIN"}),a.jsxs("div",{className:"input-with-action",children:[a.jsx("input",{type:"text",className:"form-input",style:{flex:1},...s("permanent_gstin")}),a.jsx("button",{type:"button",className:"btn btn-secondary btn-small input-action-btn",children:"Get"})]})]})}),a.jsx("div",{className:"grid-col md-3 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"form-label",children:"Address 1"}),a.jsx("input",{type:"text",className:"form-input",...s("address1")})]})}),a.jsx("div",{className:"grid-col md-3 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"form-label",children:"Address 2"}),a.jsx("input",{type:"text",className:"form-input",...s("address2")})]})}),a.jsx("div",{className:"grid-col md-3 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"form-label",children:"Address 3"}),a.jsx("input",{type:"text",className:"form-input",...s("address3")})]})}),a.jsx("div",{className:"grid-col md-3 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"form-label",children:"City"}),String(He||"").toLowerCase()==="india"?a.jsx(En,{name:"city",control:i,render:({field:Le})=>a.jsxs("select",{...Le,className:"form-select",children:[a.jsx("option",{value:"",children:"Select City"}),Kc.map(rt=>a.jsx("option",{value:rt,children:rt},rt))]})}):a.jsx("input",{type:"text",className:"form-input",...s("city")})]})}),a.jsxs("div",{style:{gridColumn:"1 / -1",display:"grid",gridTemplateColumns:"repeat(12, 1fr)",gap:"16px"},children:[a.jsx("div",{className:"grid-col md-3 xs-12",style:{gridColumn:"span 3"},children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"form-label",children:"State"}),String(He||"").toLowerCase()==="india"?a.jsx(En,{name:"state",control:i,render:({field:Le})=>a.jsxs("select",{...Le,className:"form-select",children:[a.jsx("option",{value:"",children:"Select State"}),indiaStates.map(rt=>a.jsx("option",{value:rt,children:rt},rt))]})}):a.jsx("input",{type:"text",className:"form-input",...s("state")})]})}),a.jsx("div",{className:"grid-col md-3 xs-12",style:{gridColumn:"span 3"},children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"form-label",children:"Country"}),a.jsx(En,{name:"permanent_country",control:i,render:({field:Le})=>a.jsxs("select",{...Le,className:"form-select",onChange:rt=>{Le.onChange(rt.target.value);const Ke=Hs.find(pt=>pt.name===rt.target.value);h("permanent_country_code",Ke?Ke.code:"")},children:[a.jsx("option",{value:"",children:"Select Country"}),Hs.map(rt=>a.jsxs("option",{value:rt.name,children:[rt.name," (",rt.code,")"]},rt.name))]})}),a.jsx(En,{name:"permanent_country_code",control:i,render:({field:Le})=>a.jsx("input",{type:"hidden",...Le})})]})}),a.jsx("div",{className:"grid-col md-3 xs-12",style:{gridColumn:"span 3"},children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{className:"form-label",children:"Pincode"}),a.jsx("input",{type:"text",className:"form-input",...s("pincode")})]})})]})]})}),a.jsxs("div",{className:"tab-content",style:{display:yn===1?"block":"none"},children:[a.jsxs("div",{className:"form-grid",children:[a.jsx("div",{className:"grid-col md-2 xs-12",children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",height:"100%"},children:[a.jsx("h6",{className:"subsection-header",style:{marginTop:0},children:"Account Type"}),a.jsx("div",{className:"form-field",children:a.jsx(En,{name:"account_types",control:i,rules:{validate:Le=>typeof Le=="string"&&Le.length>0||"Account type is required"},render:({field:Le})=>a.jsxs(a.Fragment,{children:[a.jsxs("select",{...Le,className:`form-select ${g.account_types?"error":""}`,onChange:rt=>{const Ke=rt.target.value;Le.onChange(Ke),H1.forEach(pt=>{h(pt.value,Ke===pt.value)}),O(pt=>pt.filter(rr=>rr!==Ke)),Ke==="is_employee"?(h("under_type",""),h("under_entity",null),h("distributor_id",null),h("dealer_id",null),h("supplier_id",null)):Ke==="is_dealer"?h("distributor_id",null):Ke==="is_customer"&&(e!=null&&e.id||(h("dealer_id",null),h("under_type","",{shouldDirty:!0,shouldTouch:!0})))},children:[a.jsx("option",{value:"",children:"Select account type"}),H1.map(rt=>a.jsx("option",{value:rt.value,children:rt.label},rt.value))]}),g.account_types&&a.jsx("span",{className:"form-helper-text error",children:g.account_types.message})]})})})]})}),ye&&a.jsx("div",{className:"grid-col md-3 xs-12",children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",height:"100%"},children:[a.jsx("h6",{className:"subsection-header",style:{marginTop:0},children:"Select Distributor"}),a.jsx("div",{className:"form-field",children:a.jsx(En,{name:"distributor_id",control:i,render:({field:Le})=>a.jsxs(a.Fragment,{children:[a.jsx("select",{...Le,className:`form-select ${g.distributor_id?"error":""}`,disabled:dt,onChange:rt=>{Le.onChange(rt.target.value||null),h("under_type","distributor",{shouldDirty:!0,shouldTouch:!0})},children:Array.isArray(Xe)&&Xe.map(rt=>a.jsx("option",{value:rt.id,children:rt.company_name||`${rt.firstname||""} ${rt.lastname||""}`.trim()||rt.username||"Distributor"},rt.id))}),g.distributor_id&&a.jsx("span",{className:"form-helper-text error",children:g.distributor_id.message}),dt&&a.jsx("span",{className:"form-helper-text",children:"Loading distributors..."}),!dt&&(!Array.isArray(Xe)||Xe.length===0)&&a.jsx("span",{className:"form-helper-text",children:"No distributors found"})]})})})]})}),Dt&&a.jsx("div",{className:"grid-col md-3 xs-12",children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",height:"100%"},children:[a.jsx("h6",{className:"subsection-header",style:{marginTop:0},children:"Select Dealer"}),a.jsx("div",{className:"form-field",children:a.jsx(En,{name:"dealer_id",control:i,render:({field:Le})=>{const rt=[{id:"none",username:"Direct Customer"},{id:"distributor",username:"Under Distributor"}],Ke=Array.isArray($t)?rt.concat($t):rt;return a.jsxs(a.Fragment,{children:[a.jsx("select",{value:Le.value||"",onChange:pt=>{const rr=pt.target.value;rr==="none"?(Le.onChange(null),h("under_type","",{shouldDirty:!0,shouldTouch:!0})):rr==="distributor"?(Le.onChange(null),h("under_type","distributor",{shouldDirty:!0,shouldTouch:!0})):(Le.onChange(rr),h("under_type","dealer",{shouldDirty:!0,shouldTouch:!0}))},className:`form-select ${g.dealer_id?"error":""}`,disabled:ft,children:Ke.map(pt=>a.jsx("option",{value:pt.id,children:pt.id==="none"?"Direct Customer":pt.id==="distributor"?"Under Distributor":pt.company_name||`${pt.firstname||""} ${pt.lastname||""}`.trim()||pt.username||"Dealer"},pt.id))}),g.dealer_id&&a.jsx("span",{className:"form-helper-text error",children:g.dealer_id.message}),ft&&a.jsx("span",{className:"form-helper-text",children:"Loading dealers..."})]})}})})]})}),Dt&&je==="distributor"&&a.jsx("div",{className:"grid-col md-3 xs-12",children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",height:"100%"},children:[a.jsx("h6",{className:"subsection-header",style:{marginTop:0},children:"Select Distributor"}),a.jsx("div",{className:"form-field",children:a.jsx(En,{name:"distributor_id",control:i,render:({field:Le})=>a.jsxs(a.Fragment,{children:[a.jsx("select",{...Le,className:`form-select ${g.distributor_id?"error":""}`,disabled:dt,onChange:rt=>{Le.onChange(rt.target.value||null),h("under_type","distributor",{shouldDirty:!0,shouldTouch:!0})},children:Array.isArray(Xe)&&Xe.map(rt=>a.jsx("option",{value:rt.id,children:rt.company_name||`${rt.firstname||""} ${rt.lastname||""}`.trim()||rt.username||"Distributor"},rt.id))}),g.distributor_id&&a.jsx("span",{className:"form-helper-text error",children:g.distributor_id.message}),dt&&a.jsx("span",{className:"form-helper-text",children:"Loading distributors..."}),!dt&&(!Array.isArray(Xe)||Xe.length===0)&&a.jsx("span",{className:"form-helper-text",children:"No distributors found"})]})})})]})}),L.map((Le,rt)=>a.jsx("div",{className:"additional-account-row",children:a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[a.jsx("div",{style:{minWidth:"220px"},children:a.jsxs("select",{value:Le||"",onChange:Ke=>Te(rt,Ke.target.value),className:"form-select",children:[a.jsx("option",{value:"",children:"Select account type"}),H1.map(Ke=>a.jsx("option",{value:Ke.value,disabled:u("account_types")===Ke.value||L.some((pt,rr)=>pt===Ke.value&&rr!==rt),children:Ke.label},Ke.value))]})}),Le==="is_dealer"&&a.jsx("div",{style:{minWidth:"340px"},children:a.jsxs("select",{value:H[rt]||"",onChange:Ke=>{const pt=Ke.target.value||null;z(rr=>{const ur=[...rr];return ur[rt]=pt,ur})},className:"form-select",disabled:dt,children:[a.jsx("option",{value:"",children:"Select distributor"}),Array.isArray(Xe)&&Xe.map(Ke=>a.jsx("option",{value:Ke.id,children:Ke.company_name||`${Ke.firstname||""} ${Ke.lastname||""}`.trim()||Ke.username||"Distributor"},Ke.id))]})}),Le==="is_customer"&&a.jsx("div",{style:{minWidth:"300px"},children:a.jsxs("select",{value:q[rt]||"",onChange:Ke=>{const pt=Ke.target.value;D(pt==="none"||pt===""?rr=>rr.map((ur,Rr)=>Rr===rt?null:ur):pt==="distributor"?rr=>rr.map((ur,Rr)=>Rr===rt?"distributor":ur):rr=>{const ur=[...rr];return ur[rt]=pt,ur})},className:"form-select",disabled:ft,children:[a.jsx("option",{value:"none",children:"Direct Customer"}),a.jsx("option",{value:"distributor",children:"Under Distributor"}),Array.isArray($t)&&$t.map(Ke=>a.jsx("option",{value:Ke.id,children:Ke.company_name||`${Ke.firstname||""} ${Ke.lastname||""}`.trim()||Ke.username||"Dealer"},Ke.id))]})}),a.jsx("button",{type:"button",onClick:()=>ke(rt),className:"btn btn-small btn-danger",title:"Remove account type",style:{padding:"0.5rem 1rem"},children:""})]})},`additional_account_${rt}`)),a.jsx("div",{style:{gridColumn:"1 / -1"},children:a.jsx("button",{type:"button",onClick:le,className:"btn btn-secondary btn-small",children:"+ Add another account type"})}),a.jsx("h3",{className:"subsection-header",style:{gridColumn:"span 12"},children:"Business Info"}),a.jsx("div",{className:"grid-col md-4 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"business_name",children:"Business Name"}),a.jsx("input",{...s("business_name"),id:"business_name",type:"text",className:"form-input"})]})}),a.jsx("div",{className:"grid-col md-4 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"companyname",children:"Company Name"}),a.jsx("input",{...s("companyname"),id:"companyname",type:"text",className:"form-input"})]})}),a.jsx("div",{className:"grid-col md-4 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"industry_segment",children:"Industry Segment"}),a.jsx(En,{name:"industry_segment",control:i,render:({field:{onChange:Le,value:rt}})=>a.jsxs("select",{value:rt||"",onChange:Ke=>Le(Ke.target.value||""),className:"form-select",id:"industry_segment",children:[a.jsx("option",{value:"",children:"Select industry segment"}),Vt&&Vt.map(Ke=>a.jsx("option",{value:Ke,children:Ke},Ke))]})})]})}),a.jsx("div",{className:"grid-col md-4 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"designation",children:"Designation"}),a.jsx("input",{...s("designation"),id:"designation",type:"text",className:"form-input"})]})}),a.jsx("div",{className:"grid-col md-4 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"title",children:"Title"}),a.jsx("input",{...s("title"),id:"title",type:"text",className:"form-input"})]})})]}),a.jsx("h6",{className:"subsection-header",children:"Assign to Executive"}),a.jsxs("div",{style:{gridColumn:"1 / -1"},className:"flex-row",children:[a.jsx("div",{style:{flex:1,minWidth:200,marginRight:"1rem"},children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"assigned_department_id",children:"Select Department"}),a.jsx(En,{name:"assigned_department_id",control:i,render:({field:{onChange:Le,value:rt}})=>a.jsxs("select",{value:rt||"",onChange:Ke=>Le(Ke.target.value||null),className:"form-select",id:"assigned_department_id",children:[a.jsx("option",{value:"",children:"All departments"}),Lr&&Lr.map(Ke=>a.jsx("option",{value:Ke.id,children:Ke.name||Ke.id},Ke.id))]})})]})}),a.jsx("div",{style:{flex:1,minWidth:200},children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"assigned_executive_id",children:"Select Executive"}),a.jsx(En,{name:"assigned_executive_id",control:i,render:({field:{onChange:Le,value:rt}})=>a.jsxs("select",{value:rt||"",onChange:Ke=>Le(Ke.target.value||null),className:"form-select",disabled:Pt,id:"assigned_executive_id",children:[a.jsx("option",{value:"",children:"Select executive"}),Cr&&Cr.map(Ke=>{const pt=`${Ke&&Ke.salutation?Ke.salutation+" ":""}${(Ke==null?void 0:Ke.firstname)||""}${Ke!=null&&Ke.lastname?" "+Ke.lastname:""}${Ke!=null&&Ke.usercode?` (${Ke.usercode})`:""}`.trim();return pt?a.jsx("option",{value:Ke.id??"",children:pt},Ke.id??pt):null})]})})]})})]})]}),a.jsx("div",{className:"tab-content",style:{display:yn===2?"block":"none"},children:a.jsxs("div",{className:"form-grid",children:[a.jsx("h6",{className:"subsection-header",style:{gridColumn:"1 / -1"},children:"Additional Address"}),a.jsx("div",{style:{gridColumn:"1 / -1"},children:a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"2rem",marginBottom:"2rem"},children:[b.map((Le,rt)=>a.jsxs("div",{className:"address-card",style:{position:"relative"},children:[a.jsxs("h6",{className:"subsection-header",children:["Address ",rt+1]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"1rem"},children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Title"}),a.jsx("input",{type:"text",className:"form-input",value:Le.address_type||"",onChange:Ke=>_e(rt,"address_type",Ke.target.value)})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"GSTIN"}),a.jsxs("div",{className:"input-with-action",children:[a.jsx("input",{type:"text",className:"form-input",style:{flex:1},value:Le.gstin||"",onChange:Ke=>_e(rt,"gstin",Ke.target.value)}),a.jsx("button",{type:"button",className:"btn btn-secondary btn-small input-action-btn",children:"Get"})]})]}),[1,2,3].map(Ke=>a.jsxs("div",{className:"form-field",children:[a.jsxs("label",{children:["Address ",Ke]}),a.jsx("input",{type:"text",className:"form-input",value:Le[`address${Ke}`]||"",onChange:pt=>_e(rt,`address${Ke}`,pt.target.value)})]},`additional_${rt}_address${Ke}`)),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"City"}),String(Le.country||"").toLowerCase()==="india"?a.jsxs("select",{className:"form-select",value:Le.city||"",onChange:Ke=>_e(rt,"city",Ke.target.value),children:[a.jsx("option",{value:"",children:"Select City"}),Kc.map(Ke=>a.jsx("option",{value:Ke,children:Ke},Ke))]}):a.jsx("input",{type:"text",className:"form-input",value:Le.city||"",onChange:Ke=>_e(rt,"city",Ke.target.value)})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"State"}),String(Le.country||"").toLowerCase()==="india"?a.jsxs("select",{className:"form-select",value:Le.state||"",onChange:Ke=>_e(rt,"state",Ke.target.value),children:[a.jsx("option",{value:"",children:"Select State"}),indiaStates.map(Ke=>a.jsx("option",{value:Ke,children:Ke},Ke))]}):a.jsx("input",{type:"text",className:"form-input",value:Le.state||"",onChange:Ke=>_e(rt,"state",Ke.target.value)})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Country"}),a.jsxs("select",{className:"form-select",value:Le.country||"",onChange:Ke=>{const pt=Hs.find(rr=>rr.name===Ke.target.value);_e(rt,"country",Ke.target.value),_e(rt,"country_code",pt?pt.code:"")},children:[a.jsx("option",{value:"",children:"Select country"}),Hs&&Hs.map(Ke=>a.jsxs("option",{value:Ke.name,children:[Ke.name," (",Ke.code,")"]},`${Ke.name}-${Ke.code}`))]})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Pincode"}),a.jsx("input",{type:"text",className:"form-input",value:Le.pincode||"",onChange:Ke=>_e(rt,"pincode",Ke.target.value)})]})]}),a.jsx("h6",{className:"subsection-header",style:{marginTop:"2rem",marginBottom:"1rem"},children:"Additional Fields"}),Array.isArray(Le.keyValues)&&Le.keyValues.map((Ke,pt)=>a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr auto",gap:"1rem",marginBottom:"1rem",alignItems:"flex-end"},children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Key"}),a.jsx("input",{type:"text",className:"form-input",value:Ke.key||"",onChange:rr=>Ce(rt,pt,"key",rr.target.value)})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Value"}),a.jsx("input",{type:"text",className:"form-input",value:Ke.value||"",onChange:rr=>Ce(rt,pt,"value",rr.target.value)})]}),a.jsx("button",{type:"button",onClick:()=>Oe(rt,pt),className:"btn btn-danger btn-small",children:"Remove"})]},pt)),a.jsx("button",{type:"button",onClick:()=>xe(rt),className:"btn btn-secondary btn-small",style:{marginBottom:"2rem"},children:"+ Add Field"}),a.jsx("button",{type:"button",onClick:()=>ve(rt),className:"btn btn-danger btn-small",style:{position:"absolute",top:"8px",right:"8px"},children:"Remove"})]},rt)),a.jsxs("div",{className:"address-card",style:{cursor:"pointer",border:"2px dashed #ccc",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"250px",padding:"2rem",color:"#666"},onClick:fe,children:[a.jsx("span",{style:{fontSize:"2rem",marginRight:"0.5rem",color:"var(--primary-color, #007bff)"},children:"+"}),a.jsx("span",{style:{color:"var(--primary-color, #007bff)"},children:"Add Address"})]})]})}),a.jsx("h6",{className:"subsection-header",style:{gridColumn:"1 / -1"},children:"Bank Information"}),a.jsx("div",{className:"grid-col md-4 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"bank_name",children:"Bank Name"}),a.jsx("input",{...s("bank_name"),id:"bank_name",type:"text",className:"form-input"})]})}),a.jsx("div",{className:"grid-col md-4 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"branch_name",children:"Branch Name"}),a.jsx("input",{...s("branch_name"),id:"branch_name",type:"text",className:"form-input"})]})}),a.jsx("div",{className:"grid-col md-4 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"branch_address",children:"Branch Address"}),a.jsx("input",{...s("branch_address"),id:"branch_address",type:"text",className:"form-input"})]})}),a.jsx("div",{className:"grid-col md-4 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"account_number",children:"Account Number"}),a.jsx("input",{...s("account_number"),id:"account_number",type:"text",className:"form-input"})]})}),a.jsx("div",{className:"grid-col md-4 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"ifsc_code",children:"IFSC Code"}),a.jsx("input",{...s("ifsc_code"),id:"ifsc_code",type:"text",className:"form-input"})]})}),a.jsx("h6",{className:"subsection-header",style:{gridColumn:"1 / -1"},children:"Additional Bank Info"}),a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"2rem",marginBottom:"2rem",gridColumn:"1 / -1"},children:[S.map((Le,rt)=>a.jsxs("div",{className:"bank-info-card",style:{position:"relative"},children:[a.jsxs("h6",{className:"subsection-header",children:["Bank Info ",rt+1]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Bank Name"}),a.jsx("input",{type:"text",className:"form-input",value:Le.bank_name||"",onChange:Ke=>Se(rt,"bank_name",Ke.target.value)})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Branch Name"}),a.jsx("input",{type:"text",className:"form-input",value:Le.branch_name||"",onChange:Ke=>Se(rt,"branch_name",Ke.target.value)})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Branch Address"}),a.jsx("input",{type:"text",className:"form-input",value:Le.branch_address||"",onChange:Ke=>Se(rt,"branch_address",Ke.target.value)})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Account Number"}),a.jsx("input",{type:"text",className:"form-input",value:Le.account_number||"",onChange:Ke=>Se(rt,"account_number",Ke.target.value)})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"IFSC Code"}),a.jsx("input",{type:"text",className:"form-input",value:Le.ifsc_code||"",onChange:Ke=>Se(rt,"ifsc_code",Ke.target.value)})]})]}),a.jsx("h6",{className:"subsection-header",style:{marginTop:"2rem",marginBottom:"1rem",gridColumn:"1 / -1"},children:"Additional Fields"}),Array.isArray(Le.keyValues)&&Le.keyValues.map((Ke,pt)=>a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr auto",gap:"1rem",marginBottom:"1rem",alignItems:"flex-end",gridColumn:"1 / -1"},children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Key"}),a.jsx("input",{type:"text",className:"form-input",value:Ke.key||"",onChange:rr=>Re(rt,pt,"key",rr.target.value)})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Value"}),a.jsx("input",{type:"text",className:"form-input",value:Ke.value||"",onChange:rr=>Re(rt,pt,"value",rr.target.value)})]}),a.jsx("button",{type:"button",onClick:()=>ze(rt,pt),className:"btn btn-danger btn-small",children:"Remove"})]},pt)),a.jsx("button",{type:"button",onClick:()=>Ne(rt),className:"btn btn-secondary btn-small",style:{marginBottom:"2rem",gridColumn:"1 / -1"},children:"+ Add Field"}),a.jsx("button",{type:"button",onClick:()=>be(rt),className:"btn btn-danger btn-small",style:{position:"absolute",top:"8px",right:"8px"},children:"Remove"})]},rt)),a.jsxs("div",{className:"bank-info-card",style:{cursor:"pointer",border:"2px dashed #ccc",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"250px",padding:"2rem",color:"#666"},onClick:de,children:[a.jsx("span",{style:{fontSize:"2rem",marginRight:"0.5rem",color:"var(--primary-color, #007bff)"},children:"+"}),a.jsx("span",{style:{color:"var(--primary-color, #007bff)"},children:"Add Bank Info"})]})]}),a.jsxs("div",{style:{gridColumn:"1 / -1"},children:[a.jsx("h6",{className:"subsection-header",children:"Documents"}),a.jsxs("div",{style:{marginTop:"2rem"},children:[a.jsxs("label",{className:"btn btn-primary",style:{display:"inline-block",cursor:"pointer"},children:[" Upload Documents",a.jsx("input",{type:"file",multiple:!0,hidden:!0,accept:"image/*,.pdf,.doc,.docx",onChange:Ie})]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"2rem",marginTop:"2rem"},children:W.map(Le=>{var rt,Ke;return a.jsxs("div",{className:"document-card",children:[(Ke=(rt=Le.type)==null?void 0:rt.startsWith)!=null&&Ke.call(rt,"image/")?a.jsx("img",{src:Le.preview||(Le.file_url?Je+Le.file_url:""),alt:Le.name||Le.document_type||"Document",style:{width:"100%",height:"140px",backgroundColor:"#f5f5f5",objectFit:"cover"}}):a.jsx("div",{style:{height:"140px",backgroundColor:"#e0e0e0",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.2rem",fontWeight:"bold",color:"#666"},children:Le.name?Le.name.split(".").pop().toUpperCase():Le.document_type||"DOC"}),a.jsxs("div",{style:{padding:"0.5rem"},children:[a.jsx("div",{style:{marginTop:"0.5rem",marginBottom:"0.5rem"},children:a.jsxs("select",{className:"form-select",value:Le.document_type||"",onChange:pt=>we(Le.id,pt.target.value),style:{fontSize:"0.875rem"},children:[a.jsx("option",{value:"",children:"Document Type"}),Bie.map(pt=>a.jsx("option",{value:pt,children:pt},pt))]})}),a.jsx("div",{style:{marginTop:"0.5rem"},children:a.jsx("input",{type:"text",className:"form-input",placeholder:"Document Number",value:Le.document_number||Le.documentNumber||"",onChange:pt=>Fe(Le.id,pt.target.value),style:{fontSize:"0.875rem"}})})]}),a.jsxs("div",{className:"document-actions",children:[a.jsx("button",{type:"button",onClick:()=>xt(Le),title:"View",className:"btn btn-small",style:{padding:"0.25rem 0.5rem",fontSize:"1rem"},children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M1 12C1 12 5 4 12 4C19 4 23 12 23 12C23 12 19 20 12 20C5 20 1 12 1 12Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("circle",{cx:"12",cy:"12",r:"3",stroke:"currentColor",strokeWidth:"2"})]})}),a.jsx("button",{type:"button",onClick:()=>zt(Le),title:"Download",className:"btn btn-small",style:{padding:"0.25rem 0.5rem",fontSize:"1rem"},children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("polyline",{points:"7,10 12,15 17,10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),(Le.document_type&&String(Le.document_type).toLowerCase()==="photo"||Le.name&&String(Le.name).match(/\.(jpg|jpeg|png|gif|bmp|webp)$/i))&&a.jsx("button",{type:"button",onClick:()=>Ye(Le),title:"Edit/Crop",className:"btn btn-small",style:{padding:"0.25rem 0.5rem",fontSize:"1rem"},children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M11 4H4C3.46957 4 2.96086 4.21071 2.58579 4.58579C2.21071 4.96086 2 5.46957 2 6V20C2 20.5304 2.21071 20.9609 2.58579 21.3359C2.96086 21.711 3.46957 21.9217 4 21.9217H18C18.5304 21.9217 19.0391 21.711 19.4142 21.3359C19.7893 20.9609 20 20.5304 20 20V13",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M18.5 2.5C18.8978 2.10217 19.4374 1.87868 20 1.87868C20.5626 1.87868 21.1022 2.10217 21.5 2.5C21.8978 2.89782 22.1213 3.43739 22.1213 4C22.1213 4.56261 21.8978 5.10218 21.5 5.5L12 15L8 16L9 12L18.5 2.5Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),a.jsx("button",{type:"button",onClick:()=>ae(Le.id),title:"Delete",className:"btn btn-small btn-danger",style:{padding:"0.25rem 0.5rem",fontSize:"1rem"},children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M3 6H5H21",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M19 6V20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 22 17 22H7C6.46957 22 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20V6M8 6V4C8 3.46957 8.21071 2.96086 8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M10 11V17",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M14 11V17",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})})]})]},Le.id)})})]})]})]})}),a.jsx("div",{className:"tab-content",style:{display:yn===3?"block":"none"},children:a.jsxs("div",{className:"form-grid",children:[a.jsx("h6",{className:"subsection-header",style:{gridColumn:"1 / -1"},children:"Legal Information"}),a.jsx("div",{className:"grid-col md-3 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"aadhar_number",children:"Aadhar Number"}),a.jsx("input",{...s("aadhar_number"),id:"aadhar_number",type:"text",className:"form-input"})]})}),a.jsx("div",{className:"grid-col md-3 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"pan_number",children:"PAN Number"}),a.jsx("input",{...s("pan_number"),id:"pan_number",type:"text",className:"form-input"})]})}),a.jsx("div",{className:"grid-col md-3 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"gstin_number",children:"GSTIN"}),a.jsx("input",{...s("gstin_number"),id:"gstin_number",type:"text",className:"form-input"})]})}),a.jsx("div",{className:"grid-col md-3 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"msme_no",children:"MSME No"}),a.jsx("input",{...s("msme_no"),id:"msme_no",type:"text",className:"form-input"})]})}),a.jsx("h6",{className:"subsection-header",style:{gridColumn:"1 / -1"},children:"Authentication"}),a.jsx("div",{className:"grid-col md-2 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"username",children:"User Name *"}),a.jsx(En,{name:"username",control:i,rules:{required:"Username is required"},render:({field:Le})=>a.jsxs(a.Fragment,{children:[a.jsx("input",{...Le,id:"username",type:"text",className:`form-input ${g.username?"error":""}`}),g.username&&a.jsx("span",{className:"form-helper-text error",children:g.username.message})]})})]})}),a.jsx("div",{className:"grid-col md-3 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"password",children:"Password *"}),a.jsx(En,{name:"password",control:i,rules:{required:"Password is required",pattern:{value:/^(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]).{8,}$/,message:"Password must be at least 8 characters, include an uppercase letter, a number, and a special character."}},render:({field:Le})=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"password-wrapper",style:{display:"flex",alignItems:"center"},children:[a.jsx("input",{...Le,id:"password",type:ne?"text":"password",className:`form-input ${g.password?"error":""}`,style:{flex:1}}),a.jsx("button",{type:"button",onClick:ue,onMouseDown:ce,className:"btn btn-small password-toggle",title:"Toggle password visibility",children:ne?"":""})]}),g.password&&a.jsx("span",{className:"form-helper-text error",children:g.password.message})]})})]})}),a.jsx("div",{className:"grid-col md-3 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"confirmPassword",children:"Confirm Password *"}),a.jsx(En,{name:"confirmPassword",control:i,rules:{validate:Le=>Le===l("password")||"Passwords do not match"},render:({field:Le})=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"password-wrapper",style:{display:"flex",alignItems:"center"},children:[a.jsx("input",{...Le,id:"confirmPassword",type:K?"text":"password",className:`form-input ${g.confirmPassword?"error":""}`,style:{flex:1}}),a.jsx("button",{type:"button",onClick:se,onMouseDown:ce,className:"btn btn-small password-toggle",title:"Toggle password visibility",children:K?"":""})]}),g.confirmPassword&&a.jsx("span",{className:"form-helper-text error",children:g.confirmPassword.message})]})})]})}),(e==null?void 0:e.id)&&a.jsx("div",{className:"grid-col md-2 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"primary_key",children:"Primary Key (ID)"}),a.jsx("input",{id:"primary_key",type:"text",className:"form-input",value:(e==null?void 0:e.id)||"",readOnly:!0})]})}),a.jsx("div",{className:"grid-col md-2 xs-12",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"usercode",children:"User Code *"}),a.jsx(En,{name:"usercode",control:i,rules:{required:"User code is required"},render:({field:Le})=>a.jsxs(a.Fragment,{children:[a.jsx("input",{...Le,id:"usercode",type:"text",className:`form-input ${g.usercode?"error":""}`}),g.usercode&&a.jsx("span",{className:"form-helper-text error",children:g.usercode.message})]})})]})})]})}),a.jsxs("div",{style:{marginTop:"2rem",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[a.jsx("div",{children:a.jsx("button",{type:"button",className:"btn btn-secondary",onClick:Qn,children:"Reset"})}),a.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[a.jsx("button",{type:"button",className:"btn btn-secondary",onClick:za,disabled:yn===0,children:"Back"}),a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>{yn<3?$n():jr()},children:yn<3?"Next":"Submit"})]})]})]})}),a.jsx("div",{className:"modal-overlay",style:{display:wr?"flex":"none"},children:a.jsxs("div",{className:"modal",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h5",{className:"modal-title",children:e?"User Updated":"User Created"}),a.jsx("button",{type:"button",className:"btn btn-close",onClick:xn,children:""})]}),a.jsxs("div",{className:"modal-body",style:{display:"flex",flexDirection:"column",gap:"2rem"},children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"created_user_id",children:"Primary Key (ID)"}),a.jsx("input",{id:"created_user_id",type:"text",className:"form-input",value:(Dr==null?void 0:Dr.id)??"",readOnly:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"user_code_confirm",children:"User Code"}),a.jsx("input",{id:"user_code_confirm",type:"text",className:"form-input",value:Vr,onChange:Le=>on(Le.target.value)}),a.jsx("small",{style:{color:"#666"},children:"Edit user code if you want to change it. Ex : USR - 0001"})]})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{type:"button",className:"btn btn-secondary",onClick:xn,children:"Cancel"}),a.jsx("button",{type:"button",className:"btn btn-primary",onClick:ia,children:"Confirm"})]})]})}),I&&a.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:a.jsxs("div",{className:"modal",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{className:"modal-title",children:"Crop Image"}),a.jsx("button",{type:"button",className:"modal-close",onClick:_t,children:""})]}),a.jsxs("div",{className:"modal-content",children:[a.jsx("div",{className:"cropper-wrapper",children:a.jsx("div",{className:"cropper-container",children:k&&re&&a.jsx(Lw,{image:k,crop:A,zoom:V,cropShape:"rect",showGrid:!0,onCropChange:N,onCropComplete:me,onZoomChange:M})})}),a.jsxs("div",{className:"zoom-slider-container",style:{marginTop:"12px"},children:[a.jsx("label",{children:"Zoom: "}),a.jsx("input",{type:"range",value:V,min:.1,max:3,step:.1,"aria-labelledby":"Zoom",onChange:Le=>M(Number(Le.target.value)),className:"zoom-slider"})]})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{type:"button",className:"btn btn-secondary",onClick:_t,children:"Cancel"}),a.jsx("button",{type:"button",className:"btn btn-primary",onClick:mt,children:"Save Crop"})]})]})})]})},aj=()=>{const{id:e}=Jv();ii();const[r,t]=G.useState(null),[n,s]=G.useState([]),[o,i]=G.useState(!!e);G.useEffect(()=>{e&&ut.get(`${Je}/api/users/${e}`).then(u=>{t(u.data.user),s(u.data.hierarchy||[]),console.log(u.data)}).catch(u=>{console.error("Error fetching user:",u)}).finally(()=>{i(!1)})},[e]);const c=async u=>{console.log("User form submitted, received:",u)};return o?a.jsx("section",{className:"right-content",children:a.jsxs(b2,{sx:{mt:5},children:[a.jsx(Et,{variant:"h6",children:"Loading user..."}),a.jsx(Vs,{})]})}):a.jsx("section",{className:"right-content",children:a.jsx(sa,{sx:{p:2,mb:2},children:a.jsx(b2,{maxWidth:"xl",sx:{mt:5},children:a.jsx(zie,{defaultValues:r,hierarchy:n,onSubmitUser:c})})})})};var rv={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var $ie=rv.exports,sj;function Uie(){return sj||(sj=1,function(e,r){(function(){var t,n="4.17.21",s=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",i="Expected a function",c="Invalid `variable` option passed into `_.template`",u="__lodash_hash_undefined__",l=500,d="__lodash_placeholder__",h=1,f=2,p=4,v=1,g=2,m=1,b=2,y=4,S=8,C=16,L=32,O=64,H=128,z=256,q=512,D=30,W="...",P=800,I=16,U=1,k=2,_=3,R=1/0,j=9007199254740991,A=17976931348623157e292,N=NaN,V=4294967295,M=V-1,Z=V>>>1,J=[["ary",H],["bind",m],["bindKey",b],["curry",S],["curryRight",C],["flip",q],["partial",L],["partialRight",O],["rearg",z]],re="[object Arguments]",X="[object Array]",ne="[object AsyncFunction]",Y="[object Boolean]",K="[object Date]",ee="[object DOMException]",ue="[object Error]",se="[object Function]",ce="[object GeneratorFunction]",fe="[object Map]",ve="[object Number]",_e="[object Null]",le="[object Object]",ke="[object Promise]",Te="[object Proxy]",pe="[object RegExp]",ye="[object Set]",ge="[object String]",De="[object Symbol]",He="[object Undefined]",Xe="[object WeakMap]",at="[object WeakSet]",dt="[object ArrayBuffer]",wt="[object DataView]",$t="[object Float32Array]",Bt="[object Float64Array]",ft="[object Int8Array]",tr="[object Int16Array]",Me="[object Int32Array]",tt="[object Uint8Array]",Ze="[object Uint8ClampedArray]",St="[object Uint16Array]",et="[object Uint32Array]",Ht=/\b__p \+= '';/g,Nt=/\b(__p \+=) '' \+/g,kt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,kr=/&(?:amp|lt|gt|quot|#39);/g,Jt=/[&<>"']/g,Pt=RegExp(kr.source),Ur=RegExp(Jt.source),Lr=/<%-([\s\S]+?)%>/g,vt=/<%([\s\S]+?)%>/g,nr=/<%=([\s\S]+?)%>/g,Cr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Dt=/^\w*$/,je=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ct=/[\\^$.*+?()[\]{}|]/g,nt=RegExp(ct.source),Pe=/^\s+/,Qe=/\s/,gt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,xe=/\{\n\/\* \[wrapped with (.+)\] \*/,Oe=/,? & /,Ce=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,de=/[()=,{}\[\]\/\s]/,be=/\\(\\)?/g,Se=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ne=/\w*$/,ze=/^[-+]0x[0-9a-f]+$/i,Re=/^0b[01]+$/i,Ie=/^\[object .+?Constructor\]$/,ae=/^0o[0-7]+$/i,we=/^(?:0|[1-9]\d*)$/,Fe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ye=/($^)/,me=/['\n\r\u2028\u2029\\]/g,Be="\\ud800-\\udfff",Ge="\\u0300-\\u036f",mt="\\ufe20-\\ufe2f",_t="\\u20d0-\\u20ff",ot=Ge+mt+_t,xt="\\u2700-\\u27bf",zt="a-z\\xdf-\\xf6\\xf8-\\xff",Vt="\\xac\\xb1\\xd7\\xf7",Ar="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",wr="\\u2000-\\u206f",Nr=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Dr="A-Z\\xc0-\\xd6\\xd8-\\xde",Yr="\\ufe0e\\ufe0f",Vr=Vt+Ar+wr+Nr,on="[']",xn="["+Be+"]",ia="["+Vr+"]",yn="["+ot+"]",oa="\\d+",Qn="["+xt+"]",za="["+zt+"]",pr="[^"+Be+Vr+oa+xt+zt+Dr+"]",Ir="\\ud83c[\\udffb-\\udfff]",$n="(?:"+yn+"|"+Ir+")",Fr="[^"+Be+"]",jr="(?:\\ud83c[\\udde6-\\uddff]){2}",Le="[\\ud800-\\udbff][\\udc00-\\udfff]",rt="["+Dr+"]",Ke="\\u200d",pt="(?:"+za+"|"+pr+")",rr="(?:"+rt+"|"+pr+")",ur="(?:"+on+"(?:d|ll|m|re|s|t|ve))?",Rr="(?:"+on+"(?:D|LL|M|RE|S|T|VE))?",Kr=$n+"?",sr="["+Yr+"]?",jn="(?:"+Ke+"(?:"+[Fr,jr,Le].join("|")+")"+sr+Kr+")*",Kt="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",qt="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Gr=sr+Kr+jn,fn="(?:"+[Qn,jr,Le].join("|")+")"+Gr,rn="(?:"+[Fr+yn+"?",yn,jr,Le,xn].join("|")+")",$a=RegExp(on,"g"),la=RegExp(yn,"g"),ja=RegExp(Ir+"(?="+Ir+")|"+rn+Gr,"g"),mn=RegExp([rt+"?"+za+"+"+ur+"(?="+[ia,rt,"$"].join("|")+")",rr+"+"+Rr+"(?="+[ia,rt+pt,"$"].join("|")+")",rt+"?"+pt+"+"+ur,rt+"+"+Rr,qt,Kt,oa,fn].join("|"),"g"),Or=RegExp("["+Ke+Be+ot+Yr+"]"),wa=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Vn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Xs=-1,Qr={};Qr[$t]=Qr[Bt]=Qr[ft]=Qr[tr]=Qr[Me]=Qr[tt]=Qr[Ze]=Qr[St]=Qr[et]=!0,Qr[re]=Qr[X]=Qr[dt]=Qr[Y]=Qr[wt]=Qr[K]=Qr[ue]=Qr[se]=Qr[fe]=Qr[ve]=Qr[le]=Qr[pe]=Qr[ye]=Qr[ge]=Qr[Xe]=!1;var qn={};qn[re]=qn[X]=qn[dt]=qn[wt]=qn[Y]=qn[K]=qn[$t]=qn[Bt]=qn[ft]=qn[tr]=qn[Me]=qn[fe]=qn[ve]=qn[le]=qn[pe]=qn[ye]=qn[ge]=qn[De]=qn[tt]=qn[Ze]=qn[St]=qn[et]=!0,qn[ue]=qn[se]=qn[Xe]=!1;var ks={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},wn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ka={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Xn={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},st=parseFloat,Wt=parseInt,At=typeof Kn=="object"&&Kn&&Kn.Object===Object&&Kn,Xt=typeof self=="object"&&self&&self.Object===Object&&self,ht=At||Xt||Function("return this")(),er=r&&!r.nodeType&&r,mr=er&&!0&&e&&!e.nodeType&&e,ar=mr&&mr.exports===er,Mr=ar&&At.process,Wr=function(){try{var Ct=mr&&mr.require&&mr.require("util").types;return Ct||Mr&&Mr.binding&&Mr.binding("util")}catch{}}(),_n=Wr&&Wr.isArrayBuffer,en=Wr&&Wr.isDate,Yt=Wr&&Wr.isMap,xr=Wr&&Wr.isRegExp,Hr=Wr&&Wr.isSet,Na=Wr&&Wr.isTypedArray;function Ra(Ct,lr,Zt){switch(Zt.length){case 0:return Ct.call(lr);case 1:return Ct.call(lr,Zt[0]);case 2:return Ct.call(lr,Zt[0],Zt[1]);case 3:return Ct.call(lr,Zt[0],Zt[1],Zt[2])}return Ct.apply(lr,Zt)}function Xi(Ct,lr,Zt,qr){for(var kn=-1,ga=Ct==null?0:Ct.length;++kn<ga;){var Ls=Ct[kn];lr(qr,Ls,Zt(Ls),Ct)}return qr}function hn(Ct,lr){for(var Zt=-1,qr=Ct==null?0:Ct.length;++Zt<qr&&lr(Ct[Zt],Zt,Ct)!==!1;);return Ct}function Oi(Ct,lr){for(var Zt=Ct==null?0:Ct.length;Zt--&&lr(Ct[Zt],Zt,Ct)!==!1;);return Ct}function Rs(Ct,lr){for(var Zt=-1,qr=Ct==null?0:Ct.length;++Zt<qr;)if(!lr(Ct[Zt],Zt,Ct))return!1;return!0}function Ys(Ct,lr){for(var Zt=-1,qr=Ct==null?0:Ct.length,kn=0,ga=[];++Zt<qr;){var Ls=Ct[Zt];lr(Ls,Zt,Ct)&&(ga[kn++]=Ls)}return ga}function Do(Ct,lr){var Zt=Ct==null?0:Ct.length;return!!Zt&&Ac(Ct,lr,0)>-1}function ea(Ct,lr,Zt){for(var qr=-1,kn=Ct==null?0:Ct.length;++qr<kn;)if(Zt(lr,Ct[qr]))return!0;return!1}function Gn(Ct,lr){for(var Zt=-1,qr=Ct==null?0:Ct.length,kn=Array(qr);++Zt<qr;)kn[Zt]=lr(Ct[Zt],Zt,Ct);return kn}function Za(Ct,lr){for(var Zt=-1,qr=lr.length,kn=Ct.length;++Zt<qr;)Ct[kn+Zt]=lr[Zt];return Ct}function Zu(Ct,lr,Zt,qr){var kn=-1,ga=Ct==null?0:Ct.length;for(qr&&ga&&(Zt=Ct[++kn]);++kn<ga;)Zt=lr(Zt,Ct[kn],kn,Ct);return Zt}function ls(Ct,lr,Zt,qr){var kn=Ct==null?0:Ct.length;for(qr&&kn&&(Zt=Ct[--kn]);kn--;)Zt=lr(Zt,Ct[kn],kn,Ct);return Zt}function Es(Ct,lr){for(var Zt=-1,qr=Ct==null?0:Ct.length;++Zt<qr;)if(lr(Ct[Zt],Zt,Ct))return!0;return!1}var Ns=au("length");function yl(Ct){return Ct.split("")}function _c(Ct){return Ct.match(Ce)||[]}function Vd(Ct,lr,Zt){var qr;return Zt(Ct,function(kn,ga,Ls){if(lr(kn,ga,Ls))return qr=ga,!1}),qr}function Wd(Ct,lr,Zt,qr){for(var kn=Ct.length,ga=Zt+(qr?1:-1);qr?ga--:++ga<kn;)if(lr(Ct[ga],ga,Ct))return ga;return-1}function Ac(Ct,lr,Zt){return lr===lr?Kd(Ct,lr,Zt):Wd(Ct,nu,Zt)}function ah(Ct,lr,Zt,qr){for(var kn=Zt-1,ga=Ct.length;++kn<ga;)if(qr(Ct[kn],lr))return kn;return-1}function nu(Ct){return Ct!==Ct}function sh(Ct,lr){var Zt=Ct==null?0:Ct.length;return Zt?Gd(Ct,lr)/Zt:N}function au(Ct){return function(lr){return lr==null?t:lr[Ct]}}function qd(Ct){return function(lr){return Ct==null?t:Ct[lr]}}function ih(Ct,lr,Zt,qr,kn){return kn(Ct,function(ga,Ls,va){Zt=qr?(qr=!1,ga):lr(Zt,ga,Ls,va)}),Zt}function ep(Ct,lr){var Zt=Ct.length;for(Ct.sort(lr);Zt--;)Ct[Zt]=Ct[Zt].value;return Ct}function Gd(Ct,lr){for(var Zt,qr=-1,kn=Ct.length;++qr<kn;){var ga=lr(Ct[qr]);ga!==t&&(Zt=Zt===t?ga:Zt+ga)}return Zt}function Kl(Ct,lr){for(var Zt=-1,qr=Array(Ct);++Zt<Ct;)qr[Zt]=lr(Zt);return qr}function oe(Ct,lr){return Gn(lr,function(Zt){return[Zt,Ct[Zt]]})}function Ve(Ct){return Ct&&Ct.slice(0,Xd(Ct)+1).replace(Pe,"")}function It(Ct){return function(lr){return Ct(lr)}}function Qt(Ct,lr){return Gn(lr,function(Zt){return Ct[Zt]})}function Lt(Ct,lr){return Ct.has(lr)}function jt(Ct,lr){for(var Zt=-1,qr=Ct.length;++Zt<qr&&Ac(lr,Ct[Zt],0)>-1;);return Zt}function cr(Ct,lr){for(var Zt=Ct.length;Zt--&&Ac(lr,Ct[Zt],0)>-1;);return Zt}function Jr(Ct,lr){for(var Zt=Ct.length,qr=0;Zt--;)Ct[Zt]===lr&&++qr;return qr}var ta=qd(ks),Ta=qd(wn);function Ts(Ct){return"\\"+Xn[Ct]}function cs(Ct,lr){return Ct==null?t:Ct[lr]}function Ps(Ct){return Or.test(Ct)}function Yi(Ct){return wa.test(Ct)}function wl(Ct){for(var lr,Zt=[];!(lr=Ct.next()).done;)Zt.push(lr.value);return Zt}function oi(Ct){var lr=-1,Zt=Array(Ct.size);return Ct.forEach(function(qr,kn){Zt[++lr]=[kn,qr]}),Zt}function Xo(Ct,lr){return function(Zt){return Ct(lr(Zt))}}function li(Ct,lr){for(var Zt=-1,qr=Ct.length,kn=0,ga=[];++Zt<qr;){var Ls=Ct[Zt];(Ls===lr||Ls===d)&&(Ct[Zt]=d,ga[kn++]=Zt)}return ga}function Yo(Ct){var lr=-1,Zt=Array(Ct.size);return Ct.forEach(function(qr){Zt[++lr]=qr}),Zt}function Ju(Ct){var lr=-1,Zt=Array(Ct.size);return Ct.forEach(function(qr){Zt[++lr]=[qr,qr]}),Zt}function Kd(Ct,lr,Zt){for(var qr=Zt-1,kn=Ct.length;++qr<kn;)if(Ct[qr]===lr)return qr;return-1}function Pi(Ct,lr,Zt){for(var qr=Zt+1;qr--;)if(Ct[qr]===lr)return qr;return qr}function Io(Ct){return Ps(Ct)?lh(Ct):Ns(Ct)}function Zi(Ct){return Ps(Ct)?Yd(Ct):yl(Ct)}function Xd(Ct){for(var lr=Ct.length;lr--&&Qe.test(Ct.charAt(lr)););return lr}var oh=qd(ka);function lh(Ct){for(var lr=ja.lastIndex=0;ja.test(Ct);)++lr;return lr}function Yd(Ct){return Ct.match(ja)||[]}function tp(Ct){return Ct.match(mn)||[]}var Cc=function Ct(lr){lr=lr==null?ht:Sl.defaults(ht.Object(),lr,Sl.pick(ht,Vn));var Zt=lr.Array,qr=lr.Date,kn=lr.Error,ga=lr.Function,Ls=lr.Math,va=lr.Object,Qu=lr.RegExp,su=lr.String,Oo=lr.TypeError,rp=Zt.prototype,Vw=ga.prototype,Zd=va.prototype,ch=lr["__core-js_shared__"],uh=Vw.toString,Da=Zd.hasOwnProperty,_l=0,ag=function(){var T=/[^.]+$/.exec(ch&&ch.keys&&ch.keys.IE_PROTO||"");return T?"Symbol(src)_1."+T:""}(),Ji=Zd.toString,Zo=uh.call(va),Jd=ht._,sg=Qu("^"+uh.call(Da).replace(ct,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ed=ar?lr.Buffer:t,Al=lr.Symbol,Qd=lr.Uint8Array,td=ed?ed.allocUnsafe:t,dh=Xo(va.getPrototypeOf,va),fh=va.create,rd=Zd.propertyIsEnumerable,np=rp.splice,uo=Al?Al.isConcatSpreadable:t,nd=Al?Al.iterator:t,Qi=Al?Al.toStringTag:t,hh=function(){try{var T=pu(va,"defineProperty");return T({},"",{}),T}catch{}}(),ap=lr.clearTimeout!==ht.clearTimeout&&lr.clearTimeout,ad=qr&&qr.now!==ht.Date.now&&qr.now,ig=lr.setTimeout!==ht.setTimeout&&lr.setTimeout,ef=Ls.ceil,jc=Ls.floor,iu=va.getOwnPropertySymbols,sp=ed?ed.isBuffer:t,ph=lr.isFinite,Jo=rp.join,Qo=Xo(va.keys,va),ps=Ls.max,ys=Ls.min,kc=qr.now,sd=lr.parseInt,og=Ls.random,lg=rp.reverse,mh=pu(lr,"DataView"),ci=pu(lr,"Map"),ws=pu(lr,"Promise"),xa=pu(lr,"Set"),Cl=pu(lr,"WeakMap"),fo=pu(va,"create"),tf=Cl&&new Cl,el={},bx=Oc(mh),yx=Oc(ci),gh=Oc(ws),vh=Oc(xa),wx=Oc(Cl),ou=Al?Al.prototype:t,id=ou?ou.valueOf:t,lu=ou?ou.toString:t;function $e(T){if(Ms(T)&&!Pn(T)&&!(T instanceof ca)){if(T instanceof ho)return T;if(Da.call(T,"__wrapped__"))return di(T)}return new ho(T)}var Po=function(){function T(){}return function(F){if(!_s(F))return{};if(fh)return fh(F);T.prototype=F;var te=new T;return T.prototype=t,te}}();function tl(){}function ho(T,F){this.__wrapped__=T,this.__actions__=[],this.__chain__=!!F,this.__index__=0,this.__values__=t}$e.templateSettings={escape:Lr,evaluate:vt,interpolate:nr,variable:"",imports:{_:$e}},$e.prototype=tl.prototype,$e.prototype.constructor=$e,ho.prototype=Po(tl.prototype),ho.prototype.constructor=ho;function ca(T){this.__wrapped__=T,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=V,this.__views__=[]}function xh(){var T=new ca(this.__wrapped__);return T.__actions__=ui(this.__actions__),T.__dir__=this.__dir__,T.__filtered__=this.__filtered__,T.__iteratees__=ui(this.__iteratees__),T.__takeCount__=this.__takeCount__,T.__views__=ui(this.__views__),T}function ip(){if(this.__filtered__){var T=new ca(this);T.__dir__=-1,T.__filtered__=!0}else T=this.clone(),T.__dir__*=-1;return T}function od(){var T=this.__wrapped__.value(),F=this.__dir__,te=Pn(T),he=F<0,Ee=te?T.length:0,We=eb(0,Ee,this.__views__),it=We.start,bt=We.end,Tt=bt-it,br=he?bt:it-1,_r=this.__iteratees__,Tr=_r.length,Xr=0,gn=ys(Tt,this.__takeCount__);if(!te||!he&&Ee==Tt&&gn==Tt)return zx(T,this.__actions__);var Dn=[];e:for(;Tt--&&Xr<gn;){br+=F;for(var da=-1,In=T[br];++da<Tr;){var _a=_r[da],Ma=_a.iteratee,Ll=_a.type,Vo=Ma(In);if(Ll==k)In=Vo;else if(!Vo){if(Ll==U)continue e;break e}}Dn[Xr++]=In}return Dn}ca.prototype=Po(tl.prototype),ca.prototype.constructor=ca;function Fs(T){var F=-1,te=T==null?0:T.length;for(this.clear();++F<te;){var he=T[F];this.set(he[0],he[1])}}function op(){this.__data__=fo?fo(null):{},this.size=0}function Sx(T){var F=this.has(T)&&delete this.__data__[T];return this.size-=F?1:0,F}function Ww(T){var F=this.__data__;if(fo){var te=F[T];return te===u?t:te}return Da.call(F,T)?F[T]:t}function qw(T){var F=this.__data__;return fo?F[T]!==t:Da.call(F,T)}function Gw(T,F){var te=this.__data__;return this.size+=this.has(T)?0:1,te[T]=fo&&F===t?u:F,this}Fs.prototype.clear=op,Fs.prototype.delete=Sx,Fs.prototype.get=Ww,Fs.prototype.has=qw,Fs.prototype.set=Gw;function ts(T){var F=-1,te=T==null?0:T.length;for(this.clear();++F<te;){var he=T[F];this.set(he[0],he[1])}}function cg(){this.__data__=[],this.size=0}function bh(T){var F=this.__data__,te=af(F,T);if(te<0)return!1;var he=F.length-1;return te==he?F.pop():np.call(F,te,1),--this.size,!0}function yh(T){var F=this.__data__,te=af(F,T);return te<0?t:F[te][1]}function ug(T){return af(this.__data__,T)>-1}function rf(T,F){var te=this.__data__,he=af(te,T);return he<0?(++this.size,te.push([T,F])):te[he][1]=F,this}ts.prototype.clear=cg,ts.prototype.delete=bh,ts.prototype.get=yh,ts.prototype.has=ug,ts.prototype.set=rf;function po(T){var F=-1,te=T==null?0:T.length;for(this.clear();++F<te;){var he=T[F];this.set(he[0],he[1])}}function Kw(){this.size=0,this.__data__={hash:new Fs,map:new(ci||ts),string:new Fs}}function _x(T){var F=df(this,T).delete(T);return this.size-=F?1:0,F}function Xw(T){return df(this,T).get(T)}function Ax(T){return df(this,T).has(T)}function ld(T,F){var te=df(this,T),he=te.size;return te.set(T,F),this.size+=te.size==he?0:1,this}po.prototype.clear=Kw,po.prototype.delete=_x,po.prototype.get=Xw,po.prototype.has=Ax,po.prototype.set=ld;function Rc(T){var F=-1,te=T==null?0:T.length;for(this.__data__=new po;++F<te;)this.add(T[F])}function lp(T){return this.__data__.set(T,u),this}function Cx(T){return this.__data__.has(T)}Rc.prototype.add=Rc.prototype.push=lp,Rc.prototype.has=Cx;function eo(T){var F=this.__data__=new ts(T);this.size=F.size}function jx(){this.__data__=new ts,this.size=0}function cp(T){var F=this.__data__,te=F.delete(T);return this.size=F.size,te}function dg(T){return this.__data__.get(T)}function kx(T){return this.__data__.has(T)}function up(T,F){var te=this.__data__;if(te instanceof ts){var he=te.__data__;if(!ci||he.length<s-1)return he.push([T,F]),this.size=++te.size,this;te=this.__data__=new po(he)}return te.set(T,F),this.size=te.size,this}eo.prototype.clear=jx,eo.prototype.delete=cp,eo.prototype.get=dg,eo.prototype.has=kx,eo.prototype.set=up;function fg(T,F){var te=Pn(T),he=!te&&zc(T),Ee=!te&&!he&&Au(T),We=!te&&!he&&!Ee&&Cf(T),it=te||he||Ee||We,bt=it?Kl(T.length,su):[],Tt=bt.length;for(var br in T)(F||Da.call(T,br))&&!(it&&(br=="length"||Ee&&(br=="offset"||br=="parent")||We&&(br=="buffer"||br=="byteLength"||br=="byteOffset")||El(br,Tt)))&&bt.push(br);return bt}function nf(T){var F=T.length;return F?T[yp(0,F-1)]:t}function Rx(T,F){return Gh(ui(T),kl(F,0,T.length))}function Ex(T){return Gh(ui(T))}function Xl(T,F,te){(te!==t&&!wo(T[F],te)||te===t&&!(F in T))&&jl(T,F,te)}function cd(T,F,te){var he=T[F];(!(Da.call(T,F)&&wo(he,te))||te===t&&!(F in T))&&jl(T,F,te)}function af(T,F){for(var te=T.length;te--;)if(wo(T[te][0],F))return te;return-1}function cu(T,F,te,he){return Nc(T,function(Ee,We,it){F(he,Ee,te(Ee),it)}),he}function Ec(T,F){return T&&vo(F,pi(F),T)}function wh(T,F){return T&&vo(F,Ai(F),T)}function jl(T,F,te){F=="__proto__"&&hh?hh(T,F,{configurable:!0,enumerable:!0,value:te,writable:!0}):T[F]=te}function Sh(T,F){for(var te=-1,he=F.length,Ee=Zt(he),We=T==null;++te<he;)Ee[te]=We?t:o0(T,F[te]);return Ee}function kl(T,F,te){return T===T&&(te!==t&&(T=T<=te?T:te),F!==t&&(T=T>=F?T:F)),T}function Fi(T,F,te,he,Ee,We){var it,bt=F&h,Tt=F&f,br=F&p;if(te&&(it=Ee?te(T,he,Ee,We):te(T)),it!==t)return it;if(!_s(T))return T;var _r=Pn(T);if(_r){if(it=Fg(T),!bt)return ui(T,it)}else{var Tr=_i(T),Xr=Tr==se||Tr==ce;if(Au(T))return Ng(T,bt);if(Tr==le||Tr==re||Xr&&!Ee){if(it=Tt||Xr?{}:Bg(T),!bt)return Tt?Ih(T,wh(it,T)):jp(T,Ec(it,T))}else{if(!qn[Tr])return Ee?T:{};it=zg(T,Tr,bt)}}We||(We=new eo);var gn=We.get(T);if(gn)return gn;We.set(T,it),qb(T)?T.forEach(function(In){it.add(Fi(In,F,te,In,T,We))}):Zp(T)&&T.forEach(function(In,_a){it.set(_a,Fi(In,F,te,_a,T,We))});var Dn=br?Tt?Np:Ep:Tt?Ai:pi,da=_r?t:Dn(T);return hn(da||T,function(In,_a){da&&(_a=In,In=T[_a]),cd(it,_a,Fi(In,F,te,_a,T,We))}),it}function Nx(T){var F=pi(T);return function(te){return hg(te,T,F)}}function hg(T,F,te){var he=te.length;if(T==null)return!he;for(T=va(T);he--;){var Ee=te[he],We=F[Ee],it=T[Ee];if(it===t&&!(Ee in T)||!We(it))return!1}return!0}function ud(T,F,te){if(typeof T!="function")throw new Oo(i);return hf(function(){T.apply(t,te)},F)}function uu(T,F,te,he){var Ee=-1,We=Do,it=!0,bt=T.length,Tt=[],br=F.length;if(!bt)return Tt;te&&(F=Gn(F,It(te))),he?(We=ea,it=!1):F.length>=s&&(We=Lt,it=!1,F=new Rc(F));e:for(;++Ee<bt;){var _r=T[Ee],Tr=te==null?_r:te(_r);if(_r=he||_r!==0?_r:0,it&&Tr===Tr){for(var Xr=br;Xr--;)if(F[Xr]===Tr)continue e;Tt.push(_r)}else We(F,Tr,he)||Tt.push(_r)}return Tt}var Nc=Dg(Bi),dp=Dg(of,!0);function pg(T,F){var te=!0;return Nc(T,function(he,Ee,We){return te=!!F(he,Ee,We),te}),te}function Rl(T,F,te){for(var he=-1,Ee=T.length;++he<Ee;){var We=T[he],it=F(We);if(it!=null&&(bt===t?it===it&&!no(it):te(it,bt)))var bt=it,Tt=We}return Tt}function ra(T,F,te,he){var Ee=T.length;for(te=Un(te),te<0&&(te=-te>Ee?0:Ee+te),he=he===t||he>Ee?Ee:Un(he),he<0&&(he+=Ee),he=te>he?0:ac(he);te<he;)T[te++]=F;return T}function qa(T,F){var te=[];return Nc(T,function(he,Ee,We){F(he,Ee,We)&&te.push(he)}),te}function ba(T,F,te,he,Ee){var We=-1,it=T.length;for(te||(te=Dc),Ee||(Ee=[]);++We<it;){var bt=T[We];F>0&&te(bt)?F>1?ba(bt,F-1,te,he,Ee):Za(Ee,bt):he||(Ee[Ee.length]=bt)}return Ee}var sf=vd(),dd=vd(!0);function Bi(T,F){return T&&sf(T,F,pi)}function of(T,F){return T&&dd(T,F,pi)}function du(T,F){return Ys(F,function(te){return Nl(T[te])})}function rl(T,F){F=Lc(F,T);for(var te=0,he=F.length;T!=null&&te<he;)T=T[Ua(F[te++])];return te&&te==he?T:t}function Tx(T,F,te){var he=F(T);return Pn(T)?he:Za(he,te(T))}function Sa(T){return T==null?T===t?He:_e:Qi&&Qi in va(T)?Qx(T):sb(T)}function _h(T,F){return T>F}function mg(T,F){return T!=null&&Da.call(T,F)}function Lx(T,F){return T!=null&&F in va(T)}function Mx(T,F,te){return T>=ys(F,te)&&T<ps(F,te)}function gg(T,F,te){for(var he=te?ea:Do,Ee=T[0].length,We=T.length,it=We,bt=Zt(We),Tt=1/0,br=[];it--;){var _r=T[it];it&&F&&(_r=Gn(_r,It(F))),Tt=ys(_r.length,Tt),bt[it]=!te&&(F||Ee>=120&&_r.length>=120)?new Rc(it&&_r):t}_r=T[0];var Tr=-1,Xr=bt[0];e:for(;++Tr<Ee&&br.length<Tt;){var gn=_r[Tr],Dn=F?F(gn):gn;if(gn=te||gn!==0?gn:0,!(Xr?Lt(Xr,Dn):he(br,Dn,te))){for(it=We;--it;){var da=bt[it];if(!(da?Lt(da,Dn):he(T[it],Dn,te)))continue e}Xr&&Xr.push(Dn),br.push(gn)}}return br}function vg(T,F,te,he){return Bi(T,function(Ee,We,it){F(he,te(Ee),We,it)}),he}function fd(T,F,te){F=Lc(F,T),T=ff(T,F);var he=T==null?T:T[Ua(zi(F))];return he==null?t:Ra(he,T,te)}function fp(T){return Ms(T)&&Sa(T)==re}function mo(T){return Ms(T)&&Sa(T)==dt}function Zs(T){return Ms(T)&&Sa(T)==K}function hd(T,F,te,he,Ee){return T===F?!0:T==null||F==null||!Ms(T)&&!Ms(F)?T!==T&&F!==F:Ah(T,F,te,he,hd,Ee)}function Ah(T,F,te,he,Ee,We){var it=Pn(T),bt=Pn(F),Tt=it?X:_i(T),br=bt?X:_i(F);Tt=Tt==re?le:Tt,br=br==re?le:br;var _r=Tt==le,Tr=br==le,Xr=Tt==br;if(Xr&&Au(T)){if(!Au(F))return!1;it=!0,_r=!1}if(Xr&&!_r)return We||(We=new eo),it||Cf(T)?Zx(T,F,te,he,Ee,We):Jx(T,F,Tt,te,he,Ee,We);if(!(te&v)){var gn=_r&&Da.call(T,"__wrapped__"),Dn=Tr&&Da.call(F,"__wrapped__");if(gn||Dn){var da=gn?T.value():T,In=Dn?F.value():F;return We||(We=new eo),Ee(da,In,te,he,We)}}return Xr?(We||(We=new eo),Si(T,F,te,he,Ee,We)):!1}function hp(T){return Ms(T)&&_i(T)==fe}function Ch(T,F,te,he){var Ee=te.length,We=Ee,it=!he;if(T==null)return!We;for(T=va(T);Ee--;){var bt=te[Ee];if(it&&bt[2]?bt[1]!==T[bt[0]]:!(bt[0]in T))return!1}for(;++Ee<We;){bt=te[Ee];var Tt=bt[0],br=T[Tt],_r=bt[1];if(it&&bt[2]){if(br===t&&!(Tt in T))return!1}else{var Tr=new eo;if(he)var Xr=he(br,_r,Tt,T,F,Tr);if(!(Xr===t?hd(_r,br,v|g,he,Tr):Xr))return!1}}return!0}function Yl(T){if(!_s(T)||Op(T))return!1;var F=Nl(T)?sg:Ie;return F.test(Oc(T))}function pp(T){return Ms(T)&&Sa(T)==pe}function xg(T){return Ms(T)&&_i(T)==ye}function bg(T){return Ms(T)&&Sd(T.length)&&!!Qr[Sa(T)]}function yg(T){return typeof T=="function"?T:T==null?Ft:typeof T=="object"?Pn(T)?vp(T[0],T[1]):Sg(T):La(T)}function mp(T){if(!rs(T))return Qo(T);var F=[];for(var te in va(T))Da.call(T,te)&&te!="constructor"&&F.push(te);return F}function Dx(T){if(!_s(T))return mu(T);var F=rs(T),te=[];for(var he in T)he=="constructor"&&(F||!Da.call(T,he))||te.push(he);return te}function gp(T,F){return T<F}function wg(T,F){var te=-1,he=fi(T)?Zt(T.length):[];return Nc(T,function(Ee,We,it){he[++te]=F(Ee,We,it)}),he}function Sg(T){var F=Lp(T);return F.length==1&&F[0][2]?nb(F[0][0],F[0][1]):function(te){return te===T||Ch(te,T,F)}}function vp(T,F){return Dp(T)&&rb(F)?nb(Ua(T),F):function(te){var he=o0(te,T);return he===t&&he===F?Ef(te,T):hd(F,he,v|g)}}function jh(T,F,te,he,Ee){T!==F&&sf(F,function(We,it){if(Ee||(Ee=new eo),_s(We))Yw(T,F,it,te,jh,he,Ee);else{var bt=he?he(Pp(T,it),We,it+"",T,F,Ee):t;bt===t&&(bt=We),Xl(T,it,bt)}},Ai)}function Yw(T,F,te,he,Ee,We,it){var bt=Pp(T,te),Tt=Pp(F,te),br=it.get(Tt);if(br){Xl(T,te,br);return}var _r=We?We(bt,Tt,te+"",T,F,it):t,Tr=_r===t;if(Tr){var Xr=Pn(Tt),gn=!Xr&&Au(Tt),Dn=!Xr&&!gn&&Cf(Tt);_r=Tt,Xr||gn||Dn?Pn(bt)?_r=bt:$s(bt)?_r=ui(bt):gn?(Tr=!1,_r=Ng(Tt,!0)):Dn?(Tr=!1,_r=Lg(Tt,!0)):_r=[]:il(Tt)||zc(Tt)?(_r=bt,zc(bt)?_r=Xb(bt):(!_s(bt)||Nl(bt))&&(_r=Bg(Tt))):Tr=!1}Tr&&(it.set(Tt,_r),Ee(_r,Tt,he,We,it),it.delete(Tt)),Xl(T,te,_r)}function _g(T,F){var te=T.length;if(te)return F+=F<0?te:0,El(F,te)?T[F]:t}function Ag(T,F,te){F.length?F=Gn(F,function(We){return Pn(We)?function(it){return rl(it,We.length===1?We[0]:We)}:We}):F=[Ft];var he=-1;F=Gn(F,It(Sn()));var Ee=wg(T,function(We,it,bt){var Tt=Gn(F,function(br){return br(We)});return{criteria:Tt,index:++he,value:We}});return ep(Ee,function(We,it){return Vx(We,it,te)})}function Ix(T,F){return xp(T,F,function(te,he){return Ef(T,he)})}function xp(T,F,te){for(var he=-1,Ee=F.length,We={};++he<Ee;){var it=F[he],bt=rl(T,it);te(bt,it)&&cf(We,Lc(it,T),bt)}return We}function Ox(T){return function(F){return rl(F,T)}}function bp(T,F,te,he){var Ee=he?ah:Ac,We=-1,it=F.length,bt=T;for(T===F&&(F=ui(F)),te&&(bt=Gn(T,It(te)));++We<it;)for(var Tt=0,br=F[We],_r=te?te(br):br;(Tt=Ee(bt,_r,Tt,he))>-1;)bt!==T&&np.call(bt,Tt,1),np.call(T,Tt,1);return T}function Cg(T,F){for(var te=T?F.length:0,he=te-1;te--;){var Ee=F[te];if(te==he||Ee!==We){var We=Ee;El(Ee)?np.call(T,Ee,1):Nh(T,Ee)}}return T}function yp(T,F){return T+jc(og()*(F-T+1))}function Px(T,F,te,he){for(var Ee=-1,We=ps(ef((F-T)/(te||1)),0),it=Zt(We);We--;)it[he?We:++Ee]=T,T+=te;return it}function jg(T,F){var te="";if(!T||F<1||F>j)return te;do F%2&&(te+=T),F=jc(F/2),F&&(T+=T);while(F);return te}function Yn(T,F){return Wh($g(T,F,Ft),T+"")}function lf(T){return nf(Tf(T))}function wp(T,F){var te=Tf(T);return Gh(te,kl(F,0,te.length))}function cf(T,F,te,he){if(!_s(T))return T;F=Lc(F,T);for(var Ee=-1,We=F.length,it=We-1,bt=T;bt!=null&&++Ee<We;){var Tt=Ua(F[Ee]),br=te;if(Tt==="__proto__"||Tt==="constructor"||Tt==="prototype")return T;if(Ee!=it){var _r=bt[Tt];br=he?he(_r,Tt,bt):t,br===t&&(br=_s(_r)?_r:El(F[Ee+1])?[]:{})}cd(bt,Tt,br),bt=bt[Tt]}return T}var kh=tf?function(T,F){return tf.set(T,F),T}:Ft,Rh=hh?function(T,F){return hh(T,"toString",{configurable:!0,enumerable:!1,value:Ot(F),writable:!0})}:Ft;function Fx(T){return Gh(Tf(T))}function Fo(T,F,te){var he=-1,Ee=T.length;F<0&&(F=-F>Ee?0:Ee+F),te=te>Ee?Ee:te,te<0&&(te+=Ee),Ee=F>te?0:te-F>>>0,F>>>=0;for(var We=Zt(Ee);++he<Ee;)We[he]=T[he+F];return We}function Bx(T,F){var te;return Nc(T,function(he,Ee,We){return te=F(he,Ee,We),!te}),!!te}function Eh(T,F,te){var he=0,Ee=T==null?he:T.length;if(typeof F=="number"&&F===F&&Ee<=Z){for(;he<Ee;){var We=he+Ee>>>1,it=T[We];it!==null&&!no(it)&&(te?it<=F:it<F)?he=We+1:Ee=We}return Ee}return Sp(T,F,Ft,te)}function Sp(T,F,te,he){var Ee=0,We=T==null?0:T.length;if(We===0)return 0;F=te(F);for(var it=F!==F,bt=F===null,Tt=no(F),br=F===t;Ee<We;){var _r=jc((Ee+We)/2),Tr=te(T[_r]),Xr=Tr!==t,gn=Tr===null,Dn=Tr===Tr,da=no(Tr);if(it)var In=he||Dn;else br?In=Dn&&(he||Xr):bt?In=Dn&&Xr&&(he||!gn):Tt?In=Dn&&Xr&&!gn&&(he||!da):gn||da?In=!1:In=he?Tr<=F:Tr<F;In?Ee=_r+1:We=_r}return ys(We,M)}function kg(T,F){for(var te=-1,he=T.length,Ee=0,We=[];++te<he;){var it=T[te],bt=F?F(it):it;if(!te||!wo(bt,Tt)){var Tt=bt;We[Ee++]=it===0?0:it}}return We}function _p(T){return typeof T=="number"?T:no(T)?N:+T}function go(T){if(typeof T=="string")return T;if(Pn(T))return Gn(T,go)+"";if(no(T))return lu?lu.call(T):"";var F=T+"";return F=="0"&&1/T==-1/0?"-0":F}function Tc(T,F,te){var he=-1,Ee=Do,We=T.length,it=!0,bt=[],Tt=bt;if(te)it=!1,Ee=ea;else if(We>=s){var br=F?null:Xx(T);if(br)return Yo(br);it=!1,Ee=Lt,Tt=new Rc}else Tt=F?[]:bt;e:for(;++he<We;){var _r=T[he],Tr=F?F(_r):_r;if(_r=te||_r!==0?_r:0,it&&Tr===Tr){for(var Xr=Tt.length;Xr--;)if(Tt[Xr]===Tr)continue e;F&&Tt.push(Tr),bt.push(_r)}else Ee(Tt,Tr,te)||(Tt!==bt&&Tt.push(Tr),bt.push(_r))}return bt}function Nh(T,F){return F=Lc(F,T),T=ff(T,F),T==null||delete T[Ua(zi(F))]}function Rg(T,F,te,he){return cf(T,F,te(rl(T,F)),he)}function Th(T,F,te,he){for(var Ee=T.length,We=he?Ee:-1;(he?We--:++We<Ee)&&F(T[We],We,T););return te?Fo(T,he?0:We,he?We+1:Ee):Fo(T,he?We+1:0,he?Ee:We)}function zx(T,F){var te=T;return te instanceof ca&&(te=te.value()),Zu(F,function(he,Ee){return Ee.func.apply(Ee.thisArg,Za([he],Ee.args))},te)}function Lh(T,F,te){var he=T.length;if(he<2)return he?Tc(T[0]):[];for(var Ee=-1,We=Zt(he);++Ee<he;)for(var it=T[Ee],bt=-1;++bt<he;)bt!=Ee&&(We[Ee]=uu(We[Ee]||it,T[bt],F,te));return Tc(ba(We,1),F,te)}function Eg(T,F,te){for(var he=-1,Ee=T.length,We=F.length,it={};++he<Ee;){var bt=he<We?F[he]:t;te(it,T[he],bt)}return it}function Ap(T){return $s(T)?T:[]}function Mh(T){return typeof T=="function"?T:Ft}function Lc(T,F){return Pn(T)?T:Dp(T,F)?[T]:ec(Ia(T))}var $x=Yn;function fu(T,F,te){var he=T.length;return te=te===t?he:te,!F&&te>=he?T:Fo(T,F,te)}var Ux=ap||function(T){return ht.clearTimeout(T)};function Ng(T,F){if(F)return T.slice();var te=T.length,he=td?td(te):new T.constructor(te);return T.copy(he),he}function pd(T){var F=new T.constructor(T.byteLength);return new Qd(F).set(new Qd(T)),F}function Tg(T,F){var te=F?pd(T.buffer):T.buffer;return new T.constructor(te,T.byteOffset,T.byteLength)}function Cp(T){var F=new T.constructor(T.source,Ne.exec(T));return F.lastIndex=T.lastIndex,F}function Hx(T){return id?va(id.call(T)):{}}function Lg(T,F){var te=F?pd(T.buffer):T.buffer;return new T.constructor(te,T.byteOffset,T.length)}function Dh(T,F){if(T!==F){var te=T!==t,he=T===null,Ee=T===T,We=no(T),it=F!==t,bt=F===null,Tt=F===F,br=no(F);if(!bt&&!br&&!We&&T>F||We&&it&&Tt&&!bt&&!br||he&&it&&Tt||!te&&Tt||!Ee)return 1;if(!he&&!We&&!br&&T<F||br&&te&&Ee&&!he&&!We||bt&&te&&Ee||!it&&Ee||!Tt)return-1}return 0}function Vx(T,F,te){for(var he=-1,Ee=T.criteria,We=F.criteria,it=Ee.length,bt=te.length;++he<it;){var Tt=Dh(Ee[he],We[he]);if(Tt){if(he>=bt)return Tt;var br=te[he];return Tt*(br=="desc"?-1:1)}}return T.index-F.index}function Mg(T,F,te,he){for(var Ee=-1,We=T.length,it=te.length,bt=-1,Tt=F.length,br=ps(We-it,0),_r=Zt(Tt+br),Tr=!he;++bt<Tt;)_r[bt]=F[bt];for(;++Ee<it;)(Tr||Ee<We)&&(_r[te[Ee]]=T[Ee]);for(;br--;)_r[bt++]=T[Ee++];return _r}function Wx(T,F,te,he){for(var Ee=-1,We=T.length,it=-1,bt=te.length,Tt=-1,br=F.length,_r=ps(We-bt,0),Tr=Zt(_r+br),Xr=!he;++Ee<_r;)Tr[Ee]=T[Ee];for(var gn=Ee;++Tt<br;)Tr[gn+Tt]=F[Tt];for(;++it<bt;)(Xr||Ee<We)&&(Tr[gn+te[it]]=T[Ee++]);return Tr}function ui(T,F){var te=-1,he=T.length;for(F||(F=Zt(he));++te<he;)F[te]=T[te];return F}function vo(T,F,te,he){var Ee=!te;te||(te={});for(var We=-1,it=F.length;++We<it;){var bt=F[We],Tt=he?he(te[bt],T[bt],bt,te,T):t;Tt===t&&(Tt=T[bt]),Ee?jl(te,bt,Tt):cd(te,bt,Tt)}return te}function jp(T,F){return vo(T,$h(T),F)}function Ih(T,F){return vo(T,Mp(T),F)}function md(T,F){return function(te,he){var Ee=Pn(te)?Xi:cu,We=F?F():{};return Ee(te,T,Sn(he,2),We)}}function gd(T){return Yn(function(F,te){var he=-1,Ee=te.length,We=Ee>1?te[Ee-1]:t,it=Ee>2?te[2]:t;for(We=T.length>3&&typeof We=="function"?(Ee--,We):t,it&&ro(te[0],te[1],it)&&(We=Ee<3?t:We,Ee=1),F=va(F);++he<Ee;){var bt=te[he];bt&&T(F,bt,he,We)}return F})}function Dg(T,F){return function(te,he){if(te==null)return te;if(!fi(te))return T(te,he);for(var Ee=te.length,We=F?Ee:-1,it=va(te);(F?We--:++We<Ee)&&he(it[We],We,it)!==!1;);return te}}function vd(T){return function(F,te,he){for(var Ee=-1,We=va(F),it=he(F),bt=it.length;bt--;){var Tt=it[T?bt:++Ee];if(te(We[Tt],Tt,We)===!1)break}return F}}function qx(T,F,te){var he=F&m,Ee=nl(T);function We(){var it=this&&this!==ht&&this instanceof We?Ee:T;return it.apply(he?te:this,arguments)}return We}function Bo(T){return function(F){F=Ia(F);var te=Ps(F)?Zi(F):t,he=te?te[0]:F.charAt(0),Ee=te?fu(te,1).join(""):F.slice(1);return he[T]()+Ee}}function to(T){return function(F){return Zu(Q($c(F).replace($a,"")),T,"")}}function nl(T){return function(){var F=arguments;switch(F.length){case 0:return new T;case 1:return new T(F[0]);case 2:return new T(F[0],F[1]);case 3:return new T(F[0],F[1],F[2]);case 4:return new T(F[0],F[1],F[2],F[3]);case 5:return new T(F[0],F[1],F[2],F[3],F[4]);case 6:return new T(F[0],F[1],F[2],F[3],F[4],F[5]);case 7:return new T(F[0],F[1],F[2],F[3],F[4],F[5],F[6])}var te=Po(T.prototype),he=T.apply(te,F);return _s(he)?he:te}}function Gx(T,F,te){var he=nl(T);function Ee(){for(var We=arguments.length,it=Zt(We),bt=We,Tt=bd(Ee);bt--;)it[bt]=arguments[bt];var br=We<3&&it[0]!==Tt&&it[We-1]!==Tt?[]:li(it,Tt);if(We-=br.length,We<te)return Ig(T,F,Bs,Ee.placeholder,t,it,br,t,t,te-We);var _r=this&&this!==ht&&this instanceof Ee?he:T;return Ra(_r,this,it)}return Ee}function Mc(T){return function(F,te,he){var Ee=va(F);if(!fi(F)){var We=Sn(te,3);F=pi(F),te=function(bt){return We(Ee[bt],bt,Ee)}}var it=T(F,te,he);return it>-1?Ee[We?F[it]:it]:t}}function Zl(T){return ms(function(F){var te=F.length,he=te,Ee=ho.prototype.thru;for(T&&F.reverse();he--;){var We=F[he];if(typeof We!="function")throw new Oo(i);if(Ee&&!it&&zh(We)=="wrapper")var it=new ho([],!0)}for(he=it?he:te;++he<te;){We=F[he];var bt=zh(We),Tt=bt=="wrapper"?Tp(We):t;Tt&&Ip(Tt[0])&&Tt[1]==(H|S|L|z)&&!Tt[4].length&&Tt[9]==1?it=it[zh(Tt[0])].apply(it,Tt[3]):it=We.length==1&&Ip(We)?it[bt]():it.thru(We)}return function(){var br=arguments,_r=br[0];if(it&&br.length==1&&Pn(_r))return it.plant(_r).value();for(var Tr=0,Xr=te?F[Tr].apply(this,br):_r;++Tr<te;)Xr=F[Tr].call(this,Xr);return Xr}})}function Bs(T,F,te,he,Ee,We,it,bt,Tt,br){var _r=F&H,Tr=F&m,Xr=F&b,gn=F&(S|C),Dn=F&q,da=Xr?t:nl(T);function In(){for(var _a=arguments.length,Ma=Zt(_a),Ll=_a;Ll--;)Ma[Ll]=arguments[Ll];if(gn)var Vo=bd(In),Ml=Jr(Ma,Vo);if(he&&(Ma=Mg(Ma,he,Ee,gn)),We&&(Ma=Wx(Ma,We,it,gn)),_a-=Ml,gn&&_a<br){var mi=li(Ma,Vo);return Ig(T,F,Bs,In.placeholder,te,Ma,mi,bt,Tt,br-_a)}var Uc=Tr?te:this,_d=Xr?Uc[T]:T;return _a=Ma.length,bt?Ma=Ql(Ma,bt):Dn&&_a>1&&Ma.reverse(),_r&&Tt<_a&&(Ma.length=Tt),this&&this!==ht&&this instanceof In&&(_d=da||nl(_d)),_d.apply(Uc,Ma)}return In}function Oh(T,F){return function(te,he){return vg(te,T,F(he),{})}}function uf(T,F){return function(te,he){var Ee;if(te===t&&he===t)return F;if(te!==t&&(Ee=te),he!==t){if(Ee===t)return he;typeof te=="string"||typeof he=="string"?(te=go(te),he=go(he)):(te=_p(te),he=_p(he)),Ee=T(te,he)}return Ee}}function Ph(T){return ms(function(F){return F=Gn(F,It(Sn())),Yn(function(te){var he=this;return T(F,function(Ee){return Ra(Ee,he,te)})})})}function Fh(T,F){F=F===t?" ":go(F);var te=F.length;if(te<2)return te?jg(F,T):F;var he=jg(F,ef(T/Io(F)));return Ps(F)?fu(Zi(he),0,T).join(""):he.slice(0,T)}function Kx(T,F,te,he){var Ee=F&m,We=nl(T);function it(){for(var bt=-1,Tt=arguments.length,br=-1,_r=he.length,Tr=Zt(_r+Tt),Xr=this&&this!==ht&&this instanceof it?We:T;++br<_r;)Tr[br]=he[br];for(;Tt--;)Tr[br++]=arguments[++bt];return Ra(Xr,Ee?te:this,Tr)}return it}function hu(T){return function(F,te,he){return he&&typeof he!="number"&&ro(F,te,he)&&(te=he=t),F=nc(F),te===t?(te=F,F=0):te=nc(te),he=he===t?F<te?1:-1:nc(he),Px(F,te,he,T)}}function xd(T){return function(F,te){return typeof F=="string"&&typeof te=="string"||(F=ol(F),te=ol(te)),T(F,te)}}function Ig(T,F,te,he,Ee,We,it,bt,Tt,br){var _r=F&S,Tr=_r?it:t,Xr=_r?t:it,gn=_r?We:t,Dn=_r?t:We;F|=_r?L:O,F&=~(_r?O:L),F&y||(F&=-4);var da=[T,F,Ee,gn,Tr,Dn,Xr,bt,Tt,br],In=te.apply(t,da);return Ip(T)&&Fp(In,da),In.placeholder=he,Bp(In,T,F)}function kp(T){var F=Ls[T];return function(te,he){if(te=ol(te),he=he==null?0:ys(Un(he),292),he&&ph(te)){var Ee=(Ia(te)+"e").split("e"),We=F(Ee[0]+"e"+(+Ee[1]+he));return Ee=(Ia(We)+"e").split("e"),+(Ee[0]+"e"+(+Ee[1]-he))}return F(te)}}var Xx=xa&&1/Yo(new xa([,-0]))[1]==R?function(T){return new xa(T)}:tn;function Bh(T){return function(F){var te=_i(F);return te==fe?oi(F):te==ye?Ju(F):oe(F,T(F))}}function Jl(T,F,te,he,Ee,We,it,bt){var Tt=F&b;if(!Tt&&typeof T!="function")throw new Oo(i);var br=he?he.length:0;if(br||(F&=-97,he=Ee=t),it=it===t?it:ps(Un(it),0),bt=bt===t?bt:Un(bt),br-=Ee?Ee.length:0,F&O){var _r=he,Tr=Ee;he=Ee=t}var Xr=Tt?t:Tp(T),gn=[T,F,te,he,Ee,_r,Tr,We,it,bt];if(Xr&&Vh(gn,Xr),T=gn[0],F=gn[1],te=gn[2],he=gn[3],Ee=gn[4],bt=gn[9]=gn[9]===t?Tt?0:T.length:ps(gn[9]-br,0),!bt&&F&(S|C)&&(F&=-25),!F||F==m)var Dn=qx(T,F,te);else F==S||F==C?Dn=Gx(T,F,bt):(F==L||F==(m|L))&&!Ee.length?Dn=Kx(T,F,te,he):Dn=Bs.apply(t,gn);var da=Xr?kh:Fp;return Bp(da(Dn,gn),T,F)}function Rp(T,F,te,he){return T===t||wo(T,Zd[te])&&!Da.call(he,te)?F:T}function Og(T,F,te,he,Ee,We){return _s(T)&&_s(F)&&(We.set(F,T),jh(T,F,t,Og,We),We.delete(F)),T}function Yx(T){return il(T)?t:T}function Zx(T,F,te,he,Ee,We){var it=te&v,bt=T.length,Tt=F.length;if(bt!=Tt&&!(it&&Tt>bt))return!1;var br=We.get(T),_r=We.get(F);if(br&&_r)return br==F&&_r==T;var Tr=-1,Xr=!0,gn=te&g?new Rc:t;for(We.set(T,F),We.set(F,T);++Tr<bt;){var Dn=T[Tr],da=F[Tr];if(he)var In=it?he(da,Dn,Tr,F,T,We):he(Dn,da,Tr,T,F,We);if(In!==t){if(In)continue;Xr=!1;break}if(gn){if(!Es(F,function(_a,Ma){if(!Lt(gn,Ma)&&(Dn===_a||Ee(Dn,_a,te,he,We)))return gn.push(Ma)})){Xr=!1;break}}else if(!(Dn===da||Ee(Dn,da,te,he,We))){Xr=!1;break}}return We.delete(T),We.delete(F),Xr}function Jx(T,F,te,he,Ee,We,it){switch(te){case wt:if(T.byteLength!=F.byteLength||T.byteOffset!=F.byteOffset)return!1;T=T.buffer,F=F.buffer;case dt:return!(T.byteLength!=F.byteLength||!We(new Qd(T),new Qd(F)));case Y:case K:case ve:return wo(+T,+F);case ue:return T.name==F.name&&T.message==F.message;case pe:case ge:return T==F+"";case fe:var bt=oi;case ye:var Tt=he&v;if(bt||(bt=Yo),T.size!=F.size&&!Tt)return!1;var br=it.get(T);if(br)return br==F;he|=g,it.set(T,F);var _r=Zx(bt(T),bt(F),he,Ee,We,it);return it.delete(T),_r;case De:if(id)return id.call(T)==id.call(F)}return!1}function Si(T,F,te,he,Ee,We){var it=te&v,bt=Ep(T),Tt=bt.length,br=Ep(F),_r=br.length;if(Tt!=_r&&!it)return!1;for(var Tr=Tt;Tr--;){var Xr=bt[Tr];if(!(it?Xr in F:Da.call(F,Xr)))return!1}var gn=We.get(T),Dn=We.get(F);if(gn&&Dn)return gn==F&&Dn==T;var da=!0;We.set(T,F),We.set(F,T);for(var In=it;++Tr<Tt;){Xr=bt[Tr];var _a=T[Xr],Ma=F[Xr];if(he)var Ll=it?he(Ma,_a,Xr,F,T,We):he(_a,Ma,Xr,T,F,We);if(!(Ll===t?_a===Ma||Ee(_a,Ma,te,he,We):Ll)){da=!1;break}In||(In=Xr=="constructor")}if(da&&!In){var Vo=T.constructor,Ml=F.constructor;Vo!=Ml&&"constructor"in T&&"constructor"in F&&!(typeof Vo=="function"&&Vo instanceof Vo&&typeof Ml=="function"&&Ml instanceof Ml)&&(da=!1)}return We.delete(T),We.delete(F),da}function ms(T){return Wh($g(T,t,bo),T+"")}function Ep(T){return Tx(T,pi,$h)}function Np(T){return Tx(T,Ai,Mp)}var Tp=tf?function(T){return tf.get(T)}:tn;function zh(T){for(var F=T.name+"",te=el[F],he=Da.call(el,F)?te.length:0;he--;){var Ee=te[he],We=Ee.func;if(We==null||We==T)return Ee.name}return F}function bd(T){var F=Da.call($e,"placeholder")?$e:T;return F.placeholder}function Sn(){var T=$e.iteratee||Nn;return T=T===Nn?yg:T,arguments.length?T(arguments[0],arguments[1]):T}function df(T,F){var te=T.__data__;return Ic(F)?te[typeof F=="string"?"string":"hash"]:te.map}function Lp(T){for(var F=pi(T),te=F.length;te--;){var he=F[te],Ee=T[he];F[te]=[he,Ee,rb(Ee)]}return F}function pu(T,F){var te=cs(T,F);return Yl(te)?te:t}function Qx(T){var F=Da.call(T,Qi),te=T[Qi];try{T[Qi]=t;var he=!0}catch{}var Ee=Ji.call(T);return he&&(F?T[Qi]=te:delete T[Qi]),Ee}var $h=iu?function(T){return T==null?[]:(T=va(T),Ys(iu(T),function(F){return rd.call(T,F)}))}:M4,Mp=iu?function(T){for(var F=[];T;)Za(F,$h(T)),T=dh(T);return F}:M4,_i=Sa;(mh&&_i(new mh(new ArrayBuffer(1)))!=wt||ci&&_i(new ci)!=fe||ws&&_i(ws.resolve())!=ke||xa&&_i(new xa)!=ye||Cl&&_i(new Cl)!=Xe)&&(_i=function(T){var F=Sa(T),te=F==le?T.constructor:t,he=te?Oc(te):"";if(he)switch(he){case bx:return wt;case yx:return fe;case gh:return ke;case vh:return ye;case wx:return Xe}return F});function eb(T,F,te){for(var he=-1,Ee=te.length;++he<Ee;){var We=te[he],it=We.size;switch(We.type){case"drop":T+=it;break;case"dropRight":F-=it;break;case"take":F=ys(F,T+it);break;case"takeRight":T=ps(T,F-it);break}}return{start:T,end:F}}function Pg(T){var F=T.match(xe);return F?F[1].split(Oe):[]}function Uh(T,F,te){F=Lc(F,T);for(var he=-1,Ee=F.length,We=!1;++he<Ee;){var it=Ua(F[he]);if(!(We=T!=null&&te(T,it)))break;T=T[it]}return We||++he!=Ee?We:(Ee=T==null?0:T.length,!!Ee&&Sd(Ee)&&El(it,Ee)&&(Pn(T)||zc(T)))}function Fg(T){var F=T.length,te=new T.constructor(F);return F&&typeof T[0]=="string"&&Da.call(T,"index")&&(te.index=T.index,te.input=T.input),te}function Bg(T){return typeof T.constructor=="function"&&!rs(T)?Po(dh(T)):{}}function zg(T,F,te){var he=T.constructor;switch(F){case dt:return pd(T);case Y:case K:return new he(+T);case wt:return Tg(T,te);case $t:case Bt:case ft:case tr:case Me:case tt:case Ze:case St:case et:return Lg(T,te);case fe:return new he;case ve:case ge:return new he(T);case pe:return Cp(T);case ye:return new he;case De:return Hx(T)}}function tb(T,F){var te=F.length;if(!te)return T;var he=te-1;return F[he]=(te>1?"& ":"")+F[he],F=F.join(te>2?", ":" "),T.replace(gt,`{
/* [wrapped with `+F+`] */
`)}function Dc(T){return Pn(T)||zc(T)||!!(uo&&T&&T[uo])}function El(T,F){var te=typeof T;return F=F??j,!!F&&(te=="number"||te!="symbol"&&we.test(T))&&T>-1&&T%1==0&&T<F}function ro(T,F,te){if(!_s(te))return!1;var he=typeof F;return(he=="number"?fi(te)&&El(F,te.length):he=="string"&&F in te)?wo(te[F],T):!1}function Dp(T,F){if(Pn(T))return!1;var te=typeof T;return te=="number"||te=="symbol"||te=="boolean"||T==null||no(T)?!0:Dt.test(T)||!Cr.test(T)||F!=null&&T in va(F)}function Ic(T){var F=typeof T;return F=="string"||F=="number"||F=="symbol"||F=="boolean"?T!=="__proto__":T===null}function Ip(T){var F=zh(T),te=$e[F];if(typeof te!="function"||!(F in ca.prototype))return!1;if(T===te)return!0;var he=Tp(te);return!!he&&T===he[0]}function Op(T){return!!ag&&ag in T}var Hh=ch?Nl:D4;function rs(T){var F=T&&T.constructor,te=typeof F=="function"&&F.prototype||Zd;return T===te}function rb(T){return T===T&&!_s(T)}function nb(T,F){return function(te){return te==null?!1:te[T]===F&&(F!==t||T in va(te))}}function ab(T){var F=t0(T,function(he){return te.size===l&&te.clear(),he}),te=F.cache;return F}function Vh(T,F){var te=T[1],he=F[1],Ee=te|he,We=Ee<(m|b|H),it=he==H&&te==S||he==H&&te==z&&T[7].length<=F[8]||he==(H|z)&&F[7].length<=F[8]&&te==S;if(!(We||it))return T;he&m&&(T[2]=F[2],Ee|=te&m?0:y);var bt=F[3];if(bt){var Tt=T[3];T[3]=Tt?Mg(Tt,bt,F[4]):bt,T[4]=Tt?li(T[3],d):F[4]}return bt=F[5],bt&&(Tt=T[5],T[5]=Tt?Wx(Tt,bt,F[6]):bt,T[6]=Tt?li(T[5],d):F[6]),bt=F[7],bt&&(T[7]=bt),he&H&&(T[8]=T[8]==null?F[8]:ys(T[8],F[8])),T[9]==null&&(T[9]=F[9]),T[0]=F[0],T[1]=Ee,T}function mu(T){var F=[];if(T!=null)for(var te in va(T))F.push(te);return F}function sb(T){return Ji.call(T)}function $g(T,F,te){return F=ps(F===t?T.length-1:F,0),function(){for(var he=arguments,Ee=-1,We=ps(he.length-F,0),it=Zt(We);++Ee<We;)it[Ee]=he[F+Ee];Ee=-1;for(var bt=Zt(F+1);++Ee<F;)bt[Ee]=he[Ee];return bt[F]=te(it),Ra(T,this,bt)}}function ff(T,F){return F.length<2?T:rl(T,Fo(F,0,-1))}function Ql(T,F){for(var te=T.length,he=ys(F.length,te),Ee=ui(T);he--;){var We=F[he];T[he]=El(We,te)?Ee[We]:t}return T}function Pp(T,F){if(!(F==="constructor"&&typeof T[F]=="function")&&F!="__proto__")return T[F]}var Fp=qh(kh),hf=ig||function(T,F){return ht.setTimeout(T,F)},Wh=qh(Rh);function Bp(T,F,te){var he=F+"";return Wh(T,tb(he,ib(Pg(he),te)))}function qh(T){var F=0,te=0;return function(){var he=kc(),Ee=I-(he-te);if(te=he,Ee>0){if(++F>=P)return arguments[0]}else F=0;return T.apply(t,arguments)}}function Gh(T,F){var te=-1,he=T.length,Ee=he-1;for(F=F===t?he:F;++te<F;){var We=yp(te,Ee),it=T[We];T[We]=T[te],T[te]=it}return T.length=F,T}var ec=ab(function(T){var F=[];return T.charCodeAt(0)===46&&F.push(""),T.replace(je,function(te,he,Ee,We){F.push(Ee?We.replace(be,"$1"):he||te)}),F});function Ua(T){if(typeof T=="string"||no(T))return T;var F=T+"";return F=="0"&&1/T==-1/0?"-0":F}function Oc(T){if(T!=null){try{return uh.call(T)}catch{}try{return T+""}catch{}}return""}function ib(T,F){return hn(J,function(te){var he="_."+te[0];F&te[1]&&!Do(T,he)&&T.push(he)}),T.sort()}function di(T){if(T instanceof ca)return T.clone();var F=new ho(T.__wrapped__,T.__chain__);return F.__actions__=ui(T.__actions__),F.__index__=T.__index__,F.__values__=T.__values__,F}function Zw(T,F,te){(te?ro(T,F,te):F===t)?F=1:F=ps(Un(F),0);var he=T==null?0:T.length;if(!he||F<1)return[];for(var Ee=0,We=0,it=Zt(ef(he/F));Ee<he;)it[We++]=Fo(T,Ee,Ee+=F);return it}function ob(T){for(var F=-1,te=T==null?0:T.length,he=0,Ee=[];++F<te;){var We=T[F];We&&(Ee[he++]=We)}return Ee}function lb(){var T=arguments.length;if(!T)return[];for(var F=Zt(T-1),te=arguments[0],he=T;he--;)F[he-1]=arguments[he];return Za(Pn(te)?ui(te):[te],ba(F,1))}var Ss=Yn(function(T,F){return $s(T)?uu(T,ba(F,1,$s,!0)):[]}),xo=Yn(function(T,F){var te=zi(F);return $s(te)&&(te=t),$s(T)?uu(T,ba(F,1,$s,!0),Sn(te,2)):[]}),Pc=Yn(function(T,F){var te=zi(F);return $s(te)&&(te=t),$s(T)?uu(T,ba(F,1,$s,!0),t,te):[]});function cb(T,F,te){var he=T==null?0:T.length;return he?(F=te||F===t?1:Un(F),Fo(T,F<0?0:F,he)):[]}function ub(T,F,te){var he=T==null?0:T.length;return he?(F=te||F===t?1:Un(F),F=he-F,Fo(T,0,F<0?0:F)):[]}function Jw(T,F){return T&&T.length?Th(T,Sn(F,3),!0,!0):[]}function Ug(T,F){return T&&T.length?Th(T,Sn(F,3),!0):[]}function zo(T,F,te,he){var Ee=T==null?0:T.length;return Ee?(te&&typeof te!="number"&&ro(T,F,te)&&(te=0,he=Ee),ra(T,F,te,he)):[]}function al(T,F,te){var he=T==null?0:T.length;if(!he)return-1;var Ee=te==null?0:Un(te);return Ee<0&&(Ee=ps(he+Ee,0)),Wd(T,Sn(F,3),Ee)}function Hg(T,F,te){var he=T==null?0:T.length;if(!he)return-1;var Ee=he-1;return te!==t&&(Ee=Un(te),Ee=te<0?ps(he+Ee,0):ys(Ee,he-1)),Wd(T,Sn(F,3),Ee,!0)}function bo(T){var F=T==null?0:T.length;return F?ba(T,1):[]}function db(T){var F=T==null?0:T.length;return F?ba(T,R):[]}function gu(T,F){var te=T==null?0:T.length;return te?(F=F===t?1:Un(F),ba(T,F)):[]}function yd(T){for(var F=-1,te=T==null?0:T.length,he={};++F<te;){var Ee=T[F];he[Ee[0]]=Ee[1]}return he}function Fc(T){return T&&T.length?T[0]:t}function Vg(T,F,te){var he=T==null?0:T.length;if(!he)return-1;var Ee=te==null?0:Un(te);return Ee<0&&(Ee=ps(he+Ee,0)),Ac(T,F,Ee)}function Wg(T){var F=T==null?0:T.length;return F?Fo(T,0,-1):[]}var tc=Yn(function(T){var F=Gn(T,Ap);return F.length&&F[0]===T[0]?gg(F):[]}),fb=Yn(function(T){var F=zi(T),te=Gn(T,Ap);return F===zi(te)?F=t:te.pop(),te.length&&te[0]===T[0]?gg(te,Sn(F,2)):[]}),pf=Yn(function(T){var F=zi(T),te=Gn(T,Ap);return F=typeof F=="function"?F:t,F&&te.pop(),te.length&&te[0]===T[0]?gg(te,t,F):[]});function Kh(T,F){return T==null?"":Jo.call(T,F)}function zi(T){var F=T==null?0:T.length;return F?T[F-1]:t}function mf(T,F,te){var he=T==null?0:T.length;if(!he)return-1;var Ee=he;return te!==t&&(Ee=Un(te),Ee=Ee<0?ps(he+Ee,0):ys(Ee,he-1)),F===F?Pi(T,F,Ee):Wd(T,nu,Ee,!0)}function hb(T,F){return T&&T.length?_g(T,Un(F)):t}var pb=Yn(gf);function gf(T,F){return T&&T.length&&F&&F.length?bp(T,F):T}function mb(T,F,te){return T&&T.length&&F&&F.length?bp(T,F,Sn(te,2)):T}function zp(T,F,te){return T&&T.length&&F&&F.length?bp(T,F,t,te):T}var gb=ms(function(T,F){var te=T==null?0:T.length,he=Sh(T,F);return Cg(T,Gn(F,function(Ee){return El(Ee,te)?+Ee:Ee}).sort(Dh)),he});function Qw(T,F){var te=[];if(!(T&&T.length))return te;var he=-1,Ee=[],We=T.length;for(F=Sn(F,3);++he<We;){var it=T[he];F(it,he,T)&&(te.push(it),Ee.push(he))}return Cg(T,Ee),te}function qg(T){return T==null?T:lg.call(T)}function Ga(T,F,te){var he=T==null?0:T.length;return he?(te&&typeof te!="number"&&ro(T,F,te)?(F=0,te=he):(F=F==null?0:Un(F),te=te===t?he:Un(te)),Fo(T,F,te)):[]}function us(T,F){return Eh(T,F)}function ha(T,F,te){return Sp(T,F,Sn(te,2))}function Ea(T,F){var te=T==null?0:T.length;if(te){var he=Eh(T,F);if(he<te&&wo(T[he],F))return he}return-1}function Ka(T,F){return Eh(T,F,!0)}function $o(T,F,te){return Sp(T,F,Sn(te,2),!0)}function vu(T,F){var te=T==null?0:T.length;if(te){var he=Eh(T,F,!0)-1;if(wo(T[he],F))return he}return-1}function vf(T){return T&&T.length?kg(T):[]}function Gg(T,F){return T&&T.length?kg(T,Sn(F,2)):[]}function Bc(T){var F=T==null?0:T.length;return F?Fo(T,1,F):[]}function zs(T,F,te){return T&&T.length?(F=te||F===t?1:Un(F),Fo(T,0,F<0?0:F)):[]}function xu(T,F,te){var he=T==null?0:T.length;return he?(F=te||F===t?1:Un(F),F=he-F,Fo(T,F<0?0:F,he)):[]}function wd(T,F){return T&&T.length?Th(T,Sn(F,3),!1,!0):[]}function Kg(T,F){return T&&T.length?Th(T,Sn(F,3)):[]}var sl=Yn(function(T){return Tc(ba(T,1,$s,!0))}),xf=Yn(function(T){var F=zi(T);return $s(F)&&(F=t),Tc(ba(T,1,$s,!0),Sn(F,2))}),Xh=Yn(function(T){var F=zi(T);return F=typeof F=="function"?F:t,Tc(ba(T,1,$s,!0),t,F)});function yo(T){return T&&T.length?Tc(T):[]}function Xg(T,F){return T&&T.length?Tc(T,Sn(F,2)):[]}function Yg(T,F){return F=typeof F=="function"?F:t,T&&T.length?Tc(T,t,F):[]}function bf(T){if(!(T&&T.length))return[];var F=0;return T=Ys(T,function(te){if($s(te))return F=ps(te.length,F),!0}),Kl(F,function(te){return Gn(T,au(te))})}function Yh(T,F){if(!(T&&T.length))return[];var te=bf(T);return F==null?te:Gn(te,function(he){return Ra(F,t,he)})}var bu=Yn(function(T,F){return $s(T)?uu(T,F):[]}),Ti=Yn(function(T){return Lh(Ys(T,$s))}),yu=Yn(function(T){var F=zi(T);return $s(F)&&(F=t),Lh(Ys(T,$s),Sn(F,2))}),yf=Yn(function(T){var F=zi(T);return F=typeof F=="function"?F:t,Lh(Ys(T,$s),t,F)}),wf=Yn(bf);function Zg(T,F){return Eg(T||[],F||[],cd)}function Jg(T,F){return Eg(T||[],F||[],cf)}var vb=Yn(function(T){var F=T.length,te=F>1?T[F-1]:t;return te=typeof te=="function"?(T.pop(),te):t,Yh(T,te)});function Sf(T){var F=$e(T);return F.__chain__=!0,F}function Qg(T,F){return F(T),T}function $i(T,F){return F(T)}var xb=ms(function(T){var F=T.length,te=F?T[0]:0,he=this.__wrapped__,Ee=function(We){return Sh(We,T)};return F>1||this.__actions__.length||!(he instanceof ca)||!El(te)?this.thru(Ee):(he=he.slice(te,+te+(F?1:0)),he.__actions__.push({func:$i,args:[Ee],thisArg:t}),new ho(he,this.__chain__).thru(function(We){return F&&!We.length&&We.push(t),We}))});function Uo(){return Sf(this)}function bb(){return new ho(this.value(),this.__chain__)}function yb(){this.__values__===t&&(this.__values__=Ho(this.value()));var T=this.__index__>=this.__values__.length,F=T?t:this.__values__[this.__index__++];return{done:T,value:F}}function e4(){return this}function wu(T){for(var F,te=this;te instanceof tl;){var he=di(te);he.__index__=0,he.__values__=t,F?Ee.__wrapped__=he:F=he;var Ee=he;te=te.__wrapped__}return Ee.__wrapped__=T,F}function $p(){var T=this.__wrapped__;if(T instanceof ca){var F=T;return this.__actions__.length&&(F=new ca(this)),F=F.reverse(),F.__actions__.push({func:$i,args:[qg],thisArg:t}),new ho(F,this.__chain__)}return this.thru(qg)}function e1(){return zx(this.__wrapped__,this.__actions__)}var _f=md(function(T,F,te){Da.call(T,te)?++T[te]:jl(T,te,1)});function wb(T,F,te){var he=Pn(T)?Rs:pg;return te&&ro(T,F,te)&&(F=t),he(T,Sn(F,3))}function Sb(T,F){var te=Pn(T)?Ys:qa;return te(T,Sn(F,3))}var _b=Mc(al),t1=Mc(Hg);function r1(T,F){return ba(Zh(T,F),1)}function t4(T,F){return ba(Zh(T,F),R)}function r4(T,F,te){return te=te===t?1:Un(te),ba(Zh(T,F),te)}function Ab(T,F){var te=Pn(T)?hn:Nc;return te(T,Sn(F,3))}function n1(T,F){var te=Pn(T)?Oi:dp;return te(T,Sn(F,3))}var Cb=md(function(T,F,te){Da.call(T,te)?T[te].push(F):jl(T,te,[F])});function Af(T,F,te,he){T=fi(T)?T:Tf(T),te=te&&!he?Un(te):0;var Ee=T.length;return te<0&&(te=ps(Ee+te,0)),Qp(T)?te<=Ee&&T.indexOf(F,te)>-1:!!Ee&&Ac(T,F,te)>-1}var Up=Yn(function(T,F,te){var he=-1,Ee=typeof F=="function",We=fi(T)?Zt(T.length):[];return Nc(T,function(it){We[++he]=Ee?Ra(F,it,te):fd(it,F,te)}),We}),jb=md(function(T,F,te){jl(T,te,F)});function Zh(T,F){var te=Pn(T)?Gn:wg;return te(T,Sn(F,3))}function kb(T,F,te,he){return T==null?[]:(Pn(F)||(F=F==null?[]:[F]),te=he?t:te,Pn(te)||(te=te==null?[]:[te]),Ag(T,F,te))}var Rb=md(function(T,F,te){T[te?0:1].push(F)},function(){return[[],[]]});function Eb(T,F,te){var he=Pn(T)?Zu:ih,Ee=arguments.length<3;return he(T,Sn(F,4),te,Ee,Nc)}function Nb(T,F,te){var he=Pn(T)?ls:ih,Ee=arguments.length<3;return he(T,Sn(F,4),te,Ee,dp)}function Hp(T,F){var te=Pn(T)?Ys:qa;return te(T,r0(Sn(F,3)))}function Tb(T){var F=Pn(T)?nf:lf;return F(T)}function Lb(T,F,te){(te?ro(T,F,te):F===t)?F=1:F=Un(F);var he=Pn(T)?Rx:wp;return he(T,F)}function ns(T){var F=Pn(T)?Ex:Fx;return F(T)}function a1(T){if(T==null)return 0;if(fi(T))return Qp(T)?Io(T):T.length;var F=_i(T);return F==fe||F==ye?T.size:mp(T).length}function n4(T,F,te){var he=Pn(T)?Es:Bx;return te&&ro(T,F,te)&&(F=t),he(T,Sn(F,3))}var Mb=Yn(function(T,F){if(T==null)return[];var te=F.length;return te>1&&ro(T,F[0],F[1])?F=[]:te>2&&ro(F[0],F[1],F[2])&&(F=[F[0]]),Ag(T,ba(F,1),[])}),Vp=ad||function(){return ht.Date.now()};function a4(T,F){if(typeof F!="function")throw new Oo(i);return T=Un(T),function(){if(--T<1)return F.apply(this,arguments)}}function Db(T,F,te){return F=te?t:F,F=T&&F==null?T.length:F,Jl(T,H,t,t,t,t,F)}function Jh(T,F){var te;if(typeof F!="function")throw new Oo(i);return T=Un(T),function(){return--T>0&&(te=F.apply(this,arguments)),T<=1&&(F=t),te}}var Su=Yn(function(T,F,te){var he=m;if(te.length){var Ee=li(te,bd(Su));he|=L}return Jl(T,he,F,te,Ee)}),Wp=Yn(function(T,F,te){var he=m|b;if(te.length){var Ee=li(te,bd(Wp));he|=L}return Jl(F,he,T,te,Ee)});function Qh(T,F,te){F=te?t:F;var he=Jl(T,S,t,t,t,t,t,F);return he.placeholder=Qh.placeholder,he}function qp(T,F,te){F=te?t:F;var he=Jl(T,C,t,t,t,t,t,F);return he.placeholder=qp.placeholder,he}function _u(T,F,te){var he,Ee,We,it,bt,Tt,br=0,_r=!1,Tr=!1,Xr=!0;if(typeof T!="function")throw new Oo(i);F=ol(F)||0,_s(te)&&(_r=!!te.leading,Tr="maxWait"in te,We=Tr?ps(ol(te.maxWait)||0,F):We,Xr="trailing"in te?!!te.trailing:Xr);function gn(mi){var Uc=he,_d=Ee;return he=Ee=t,br=mi,it=T.apply(_d,Uc),it}function Dn(mi){return br=mi,bt=hf(_a,F),_r?gn(mi):it}function da(mi){var Uc=mi-Tt,_d=mi-br,q_=F-Uc;return Tr?ys(q_,We-_d):q_}function In(mi){var Uc=mi-Tt,_d=mi-br;return Tt===t||Uc>=F||Uc<0||Tr&&_d>=We}function _a(){var mi=Vp();if(In(mi))return Ma(mi);bt=hf(_a,da(mi))}function Ma(mi){return bt=t,Xr&&he?gn(mi):(he=Ee=t,it)}function Ll(){bt!==t&&Ux(bt),br=0,he=Tt=Ee=bt=t}function Vo(){return bt===t?it:Ma(Vp())}function Ml(){var mi=Vp(),Uc=In(mi);if(he=arguments,Ee=this,Tt=mi,Uc){if(bt===t)return Dn(Tt);if(Tr)return Ux(bt),bt=hf(_a,F),gn(Tt)}return bt===t&&(bt=hf(_a,F)),it}return Ml.cancel=Ll,Ml.flush=Vo,Ml}var rc=Yn(function(T,F){return ud(T,1,F)}),e0=Yn(function(T,F,te){return ud(T,ol(F)||0,te)});function s4(T){return Jl(T,q)}function t0(T,F){if(typeof T!="function"||F!=null&&typeof F!="function")throw new Oo(i);var te=function(){var he=arguments,Ee=F?F.apply(this,he):he[0],We=te.cache;if(We.has(Ee))return We.get(Ee);var it=T.apply(this,he);return te.cache=We.set(Ee,it)||We,it};return te.cache=new(t0.Cache||po),te}t0.Cache=po;function r0(T){if(typeof T!="function")throw new Oo(i);return function(){var F=arguments;switch(F.length){case 0:return!T.call(this);case 1:return!T.call(this,F[0]);case 2:return!T.call(this,F[0],F[1]);case 3:return!T.call(this,F[0],F[1],F[2])}return!T.apply(this,F)}}function Ib(T){return Jh(2,T)}var Ob=$x(function(T,F){F=F.length==1&&Pn(F[0])?Gn(F[0],It(Sn())):Gn(ba(F,1),It(Sn()));var te=F.length;return Yn(function(he){for(var Ee=-1,We=ys(he.length,te);++Ee<We;)he[Ee]=F[Ee].call(this,he[Ee]);return Ra(T,this,he)})}),s1=Yn(function(T,F){var te=li(F,bd(s1));return Jl(T,L,t,F,te)}),Gp=Yn(function(T,F){var te=li(F,bd(Gp));return Jl(T,O,t,F,te)}),Pb=ms(function(T,F){return Jl(T,z,t,t,t,F)});function Fb(T,F){if(typeof T!="function")throw new Oo(i);return F=F===t?F:Un(F),Yn(T,F)}function i4(T,F){if(typeof T!="function")throw new Oo(i);return F=F==null?0:ps(Un(F),0),Yn(function(te){var he=te[F],Ee=fu(te,0,F);return he&&Za(Ee,he),Ra(T,this,Ee)})}function i1(T,F,te){var he=!0,Ee=!0;if(typeof T!="function")throw new Oo(i);return _s(te)&&(he="leading"in te?!!te.leading:he,Ee="trailing"in te?!!te.trailing:Ee),_u(T,F,{leading:he,maxWait:F,trailing:Ee})}function o1(T){return Db(T,1)}function o4(T,F){return s1(Mh(F),T)}function l4(){if(!arguments.length)return[];var T=arguments[0];return Pn(T)?T:[T]}function n0(T){return Fi(T,p)}function c4(T,F){return F=typeof F=="function"?F:t,Fi(T,p,F)}function Bb(T){return Fi(T,h|p)}function pa(T,F){return F=typeof F=="function"?F:t,Fi(T,h|p,F)}function l1(T,F){return F==null||hg(T,F,pi(F))}function wo(T,F){return T===F||T!==T&&F!==F}var c1=xd(_h),zb=xd(function(T,F){return T>=F}),zc=fp(function(){return arguments}())?fp:function(T){return Ms(T)&&Da.call(T,"callee")&&!rd.call(T,"callee")},Pn=Zt.isArray,Kp=_n?It(_n):mo;function fi(T){return T!=null&&Sd(T.length)&&!Nl(T)}function $s(T){return Ms(T)&&fi(T)}function u4(T){return T===!0||T===!1||Ms(T)&&Sa(T)==Y}var Au=sp||D4,$b=en?It(en):Zs;function Ub(T){return Ms(T)&&T.nodeType===1&&!il(T)}function Xp(T){if(T==null)return!0;if(fi(T)&&(Pn(T)||typeof T=="string"||typeof T.splice=="function"||Au(T)||Cf(T)||zc(T)))return!T.length;var F=_i(T);if(F==fe||F==ye)return!T.size;if(rs(T))return!mp(T).length;for(var te in T)if(Da.call(T,te))return!1;return!0}function Ja(T,F){return hd(T,F)}function u1(T,F,te){te=typeof te=="function"?te:t;var he=te?te(T,F):t;return he===t?hd(T,F,t,te):!!he}function hi(T){if(!Ms(T))return!1;var F=Sa(T);return F==ue||F==ee||typeof T.message=="string"&&typeof T.name=="string"&&!il(T)}function d4(T){return typeof T=="number"&&ph(T)}function Nl(T){if(!_s(T))return!1;var F=Sa(T);return F==se||F==ce||F==ne||F==Te}function Yp(T){return typeof T=="number"&&T==Un(T)}function Sd(T){return typeof T=="number"&&T>-1&&T%1==0&&T<=j}function _s(T){var F=typeof T;return T!=null&&(F=="object"||F=="function")}function Ms(T){return T!=null&&typeof T=="object"}var Zp=Yt?It(Yt):hp;function d1(T,F){return T===F||Ch(T,F,Lp(F))}function f4(T,F,te){return te=typeof te=="function"?te:t,Ch(T,F,Lp(F),te)}function Hb(T){return Wb(T)&&T!=+T}function h4(T){if(Hh(T))throw new kn(o);return Yl(T)}function Vb(T){return T===null}function p4(T){return T==null}function Wb(T){return typeof T=="number"||Ms(T)&&Sa(T)==ve}function il(T){if(!Ms(T)||Sa(T)!=le)return!1;var F=dh(T);if(F===null)return!0;var te=Da.call(F,"constructor")&&F.constructor;return typeof te=="function"&&te instanceof te&&uh.call(te)==Zo}var Jp=xr?It(xr):pp;function f1(T){return Yp(T)&&T>=-9007199254740991&&T<=j}var qb=Hr?It(Hr):xg;function Qp(T){return typeof T=="string"||!Pn(T)&&Ms(T)&&Sa(T)==ge}function no(T){return typeof T=="symbol"||Ms(T)&&Sa(T)==De}var Cf=Na?It(Na):bg;function Tl(T){return T===t}function h1(T){return Ms(T)&&_i(T)==Xe}function Gb(T){return Ms(T)&&Sa(T)==at}var Kb=xd(gp),a0=xd(function(T,F){return T<=F});function Ho(T){if(!T)return[];if(fi(T))return Qp(T)?Zi(T):ui(T);if(nd&&T[nd])return wl(T[nd]());var F=_i(T),te=F==fe?oi:F==ye?Yo:Tf;return te(T)}function nc(T){if(!T)return T===0?T:0;if(T=ol(T),T===R||T===-1/0){var F=T<0?-1:1;return F*A}return T===T?T:0}function Un(T){var F=nc(T),te=F%1;return F===F?te?F-te:F:0}function ac(T){return T?kl(Un(T),0,V):0}function ol(T){if(typeof T=="number")return T;if(no(T))return N;if(_s(T)){var F=typeof T.valueOf=="function"?T.valueOf():T;T=_s(F)?F+"":F}if(typeof T!="string")return T===0?T:+T;T=Ve(T);var te=Re.test(T);return te||ae.test(T)?Wt(T.slice(2),te?2:8):ze.test(T)?N:+T}function Xb(T){return vo(T,Ai(T))}function jf(T){return T?kl(Un(T),-9007199254740991,j):T===0?T:0}function Ia(T){return T==null?"":go(T)}var m4=gd(function(T,F){if(rs(F)||fi(F)){vo(F,pi(F),T);return}for(var te in F)Da.call(F,te)&&cd(T,te,F[te])}),Yb=gd(function(T,F){vo(F,Ai(F),T)}),em=gd(function(T,F,te,he){vo(F,Ai(F),T,he)}),g4=gd(function(T,F,te,he){vo(F,pi(F),T,he)}),v4=ms(Sh);function x4(T,F){var te=Po(T);return F==null?te:Ec(te,F)}var b4=Yn(function(T,F){T=va(T);var te=-1,he=F.length,Ee=he>2?F[2]:t;for(Ee&&ro(F[0],F[1],Ee)&&(he=1);++te<he;)for(var We=F[te],it=Ai(We),bt=-1,Tt=it.length;++bt<Tt;){var br=it[bt],_r=T[br];(_r===t||wo(_r,Zd[br])&&!Da.call(T,br))&&(T[br]=We[br])}return T}),Zb=Yn(function(T){return T.push(t,Og),Ra(l0,t,T)});function kf(T,F){return Vd(T,Sn(F,3),Bi)}function s0(T,F){return Vd(T,Sn(F,3),of)}function Jb(T,F){return T==null?T:sf(T,Sn(F,3),Ai)}function y4(T,F){return T==null?T:dd(T,Sn(F,3),Ai)}function Rf(T,F){return T&&Bi(T,Sn(F,3))}function i0(T,F){return T&&of(T,Sn(F,3))}function Qb(T){return T==null?[]:du(T,pi(T))}function tm(T){return T==null?[]:du(T,Ai(T))}function o0(T,F,te){var he=T==null?t:rl(T,F);return he===t?te:he}function p1(T,F){return T!=null&&Uh(T,F,mg)}function Ef(T,F){return T!=null&&Uh(T,F,Lx)}var ey=Oh(function(T,F,te){F!=null&&typeof F.toString!="function"&&(F=Ji.call(F)),T[F]=te},Ot(Ft)),ty=Oh(function(T,F,te){F!=null&&typeof F.toString!="function"&&(F=Ji.call(F)),Da.call(T,F)?T[F].push(te):T[F]=[te]},Sn),w4=Yn(fd);function pi(T){return fi(T)?fg(T):mp(T)}function Ai(T){return fi(T)?fg(T,!0):Dx(T)}function S4(T,F){var te={};return F=Sn(F,3),Bi(T,function(he,Ee,We){jl(te,F(he,Ee,We),he)}),te}function _4(T,F){var te={};return F=Sn(F,3),Bi(T,function(he,Ee,We){jl(te,Ee,F(he,Ee,We))}),te}var A4=gd(function(T,F,te){jh(T,F,te)}),l0=gd(function(T,F,te,he){jh(T,F,te,he)}),rm=ms(function(T,F){var te={};if(T==null)return te;var he=!1;F=Gn(F,function(We){return We=Lc(We,T),he||(he=We.length>1),We}),vo(T,Np(T),te),he&&(te=Fi(te,h|f|p,Yx));for(var Ee=F.length;Ee--;)Nh(te,F[Ee]);return te});function m1(T,F){return Nf(T,r0(Sn(F)))}var C4=ms(function(T,F){return T==null?{}:Ix(T,F)});function Nf(T,F){if(T==null)return{};var te=Gn(Np(T),function(he){return[he]});return F=Sn(F),xp(T,te,function(he,Ee){return F(he,Ee[0])})}function j4(T,F,te){F=Lc(F,T);var he=-1,Ee=F.length;for(Ee||(Ee=1,T=t);++he<Ee;){var We=T==null?t:T[Ua(F[he])];We===t&&(he=Ee,We=te),T=Nl(We)?We.call(T):We}return T}function ry(T,F,te){return T==null?T:cf(T,F,te)}function ny(T,F,te,he){return he=typeof he=="function"?he:t,T==null?T:cf(T,F,te,he)}var g1=Bh(pi),v1=Bh(Ai);function x1(T,F,te){var he=Pn(T),Ee=he||Au(T)||Cf(T);if(F=Sn(F,4),te==null){var We=T&&T.constructor;Ee?te=he?new We:[]:_s(T)?te=Nl(We)?Po(dh(T)):{}:te={}}return(Ee?hn:Bi)(T,function(it,bt,Tt){return F(te,it,bt,Tt)}),te}function ay(T,F){return T==null?!0:Nh(T,F)}function nm(T,F,te){return T==null?T:Rg(T,F,Mh(te))}function k4(T,F,te,he){return he=typeof he=="function"?he:t,T==null?T:Rg(T,F,Mh(te),he)}function Tf(T){return T==null?[]:Qt(T,pi(T))}function b1(T){return T==null?[]:Qt(T,Ai(T))}function y1(T,F,te){return te===t&&(te=F,F=t),te!==t&&(te=ol(te),te=te===te?te:0),F!==t&&(F=ol(F),F=F===F?F:0),kl(ol(T),F,te)}function am(T,F,te){return F=nc(F),te===t?(te=F,F=0):te=nc(te),T=ol(T),Mx(T,F,te)}function w1(T,F,te){if(te&&typeof te!="boolean"&&ro(T,F,te)&&(F=te=t),te===t&&(typeof F=="boolean"?(te=F,F=t):typeof T=="boolean"&&(te=T,T=t)),T===t&&F===t?(T=0,F=1):(T=nc(T),F===t?(F=T,T=0):F=nc(F)),T>F){var he=T;T=F,F=he}if(te||T%1||F%1){var Ee=og();return ys(T+Ee*(F-T+st("1e-"+((Ee+"").length-1))),F)}return yp(T,F)}var sy=to(function(T,F,te){return F=F.toLowerCase(),T+(te?sm(F):F)});function sm(T){return B(Ia(T).toLowerCase())}function $c(T){return T=Ia(T),T&&T.replace(Fe,ta).replace(la,"")}function Cu(T,F,te){T=Ia(T),F=go(F);var he=T.length;te=te===t?he:kl(Un(te),0,he);var Ee=te;return te-=F.length,te>=0&&T.slice(te,Ee)==F}function ju(T){return T=Ia(T),T&&Ur.test(T)?T.replace(Jt,Ta):T}function c0(T){return T=Ia(T),T&&nt.test(T)?T.replace(ct,"\\$&"):T}var u0=to(function(T,F,te){return T+(te?"-":"")+F.toLowerCase()}),ku=to(function(T,F,te){return T+(te?" ":"")+F.toLowerCase()}),R4=Bo("toLowerCase");function iy(T,F,te){T=Ia(T),F=Un(F);var he=F?Io(T):0;if(!F||he>=F)return T;var Ee=(F-he)/2;return Fh(jc(Ee),te)+T+Fh(ef(Ee),te)}function d0(T,F,te){T=Ia(T),F=Un(F);var he=F?Io(T):0;return F&&he<F?T+Fh(F-he,te):T}function E4(T,F,te){T=Ia(T),F=Un(F);var he=F?Io(T):0;return F&&he<F?Fh(F-he,te)+T:T}function oy(T,F,te){return te||F==null?F=0:F&&(F=+F),sd(Ia(T).replace(Pe,""),F||0)}function im(T,F,te){return(te?ro(T,F,te):F===t)?F=1:F=Un(F),jg(Ia(T),F)}function ly(){var T=arguments,F=Ia(T[0]);return T.length<3?F:F.replace(T[1],T[2])}var N4=to(function(T,F,te){return T+(te?"_":"")+F.toLowerCase()});function om(T,F,te){return te&&typeof te!="number"&&ro(T,F,te)&&(F=te=t),te=te===t?V:te>>>0,te?(T=Ia(T),T&&(typeof F=="string"||F!=null&&!Jp(F))&&(F=go(F),!F&&Ps(T))?fu(Zi(T),0,te):T.split(F,te)):[]}var lm=to(function(T,F,te){return T+(te?" ":"")+B(F)});function cy(T,F,te){return T=Ia(T),te=te==null?0:kl(Un(te),0,T.length),F=go(F),T.slice(te,te+F.length)==F}function f0(T,F,te){var he=$e.templateSettings;te&&ro(T,F,te)&&(F=t),T=Ia(T),F=em({},F,he,Rp);var Ee=em({},F.imports,he.imports,Rp),We=pi(Ee),it=Qt(Ee,We),bt,Tt,br=0,_r=F.interpolate||Ye,Tr="__p += '",Xr=Qu((F.escape||Ye).source+"|"+_r.source+"|"+(_r===nr?Se:Ye).source+"|"+(F.evaluate||Ye).source+"|$","g"),gn="//# sourceURL="+(Da.call(F,"sourceURL")?(F.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Xs+"]")+`
`;T.replace(Xr,function(In,_a,Ma,Ll,Vo,Ml){return Ma||(Ma=Ll),Tr+=T.slice(br,Ml).replace(me,Ts),_a&&(bt=!0,Tr+=`' +
__e(`+_a+`) +
'`),Vo&&(Tt=!0,Tr+=`';
`+Vo+`;
__p += '`),Ma&&(Tr+=`' +
((__t = (`+Ma+`)) == null ? '' : __t) +
'`),br=Ml+In.length,In}),Tr+=`';
`;var Dn=Da.call(F,"variable")&&F.variable;if(!Dn)Tr=`with (obj) {
`+Tr+`
}
`;else if(de.test(Dn))throw new kn(c);Tr=(Tt?Tr.replace(Ht,""):Tr).replace(Nt,"$1").replace(kt,"$1;"),Tr="function("+(Dn||"obj")+`) {
`+(Dn?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(bt?", __e = _.escape":"")+(Tt?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Tr+`return __p
}`;var da=ie(function(){return ga(We,gn+"return "+Tr).apply(t,it)});if(da.source=Tr,hi(da))throw da;return da}function S1(T){return Ia(T).toLowerCase()}function cm(T){return Ia(T).toUpperCase()}function uy(T,F,te){if(T=Ia(T),T&&(te||F===t))return Ve(T);if(!T||!(F=go(F)))return T;var he=Zi(T),Ee=Zi(F),We=jt(he,Ee),it=cr(he,Ee)+1;return fu(he,We,it).join("")}function T4(T,F,te){if(T=Ia(T),T&&(te||F===t))return T.slice(0,Xd(T)+1);if(!T||!(F=go(F)))return T;var he=Zi(T),Ee=cr(he,Zi(F))+1;return fu(he,0,Ee).join("")}function um(T,F,te){if(T=Ia(T),T&&(te||F===t))return T.replace(Pe,"");if(!T||!(F=go(F)))return T;var he=Zi(T),Ee=jt(he,Zi(F));return fu(he,Ee).join("")}function x(T,F){var te=D,he=W;if(_s(F)){var Ee="separator"in F?F.separator:Ee;te="length"in F?Un(F.length):te,he="omission"in F?go(F.omission):he}T=Ia(T);var We=T.length;if(Ps(T)){var it=Zi(T);We=it.length}if(te>=We)return T;var bt=te-Io(he);if(bt<1)return he;var Tt=it?fu(it,0,bt).join(""):T.slice(0,bt);if(Ee===t)return Tt+he;if(it&&(bt+=Tt.length-bt),Jp(Ee)){if(T.slice(bt).search(Ee)){var br,_r=Tt;for(Ee.global||(Ee=Qu(Ee.source,Ia(Ne.exec(Ee))+"g")),Ee.lastIndex=0;br=Ee.exec(_r);)var Tr=br.index;Tt=Tt.slice(0,Tr===t?bt:Tr)}}else if(T.indexOf(go(Ee),bt)!=bt){var Xr=Tt.lastIndexOf(Ee);Xr>-1&&(Tt=Tt.slice(0,Xr))}return Tt+he}function w(T){return T=Ia(T),T&&Pt.test(T)?T.replace(kr,oh):T}var E=to(function(T,F,te){return T+(te?" ":"")+F.toUpperCase()}),B=Bo("toUpperCase");function Q(T,F,te){return T=Ia(T),F=te?t:F,F===t?Yi(T)?tp(T):_c(T):T.match(F)||[]}var ie=Yn(function(T,F){try{return Ra(T,t,F)}catch(te){return hi(te)?te:new kn(te)}}),Ae=ms(function(T,F){return hn(F,function(te){te=Ua(te),jl(T,te,Su(T[te],T))}),T});function Ue(T){var F=T==null?0:T.length,te=Sn();return T=F?Gn(T,function(he){if(typeof he[1]!="function")throw new Oo(i);return[te(he[0]),he[1]]}):[],Yn(function(he){for(var Ee=-1;++Ee<F;){var We=T[Ee];if(Ra(We[0],this,he))return Ra(We[1],this,he)}})}function lt(T){return Nx(Fi(T,h))}function Ot(T){return function(){return T}}function hr(T,F){return T==null||T!==T?F:T}var Sr=Zl(),Gt=Zl(!0);function Ft(T){return T}function Nn(T){return yg(typeof T=="function"?T:Fi(T,h))}function Rn(T){return Sg(Fi(T,h))}function Qa(T,F){return vp(T,Fi(F,h))}var Rt=Yn(function(T,F){return function(te){return fd(te,T,F)}}),yt=Yn(function(T,F){return function(te){return fd(T,te,F)}});function Mt(T,F,te){var he=pi(F),Ee=du(F,he);te==null&&!(_s(F)&&(Ee.length||!he.length))&&(te=F,F=T,T=this,Ee=du(F,pi(F)));var We=!(_s(te)&&"chain"in te)||!!te.chain,it=Nl(T);return hn(Ee,function(bt){var Tt=F[bt];T[bt]=Tt,it&&(T.prototype[bt]=function(){var br=this.__chain__;if(We||br){var _r=T(this.__wrapped__),Tr=_r.__actions__=ui(this.__actions__);return Tr.push({func:Tt,args:arguments,thisArg:T}),_r.__chain__=br,_r}return Tt.apply(T,Za([this.value()],arguments))})}),T}function gr(){return ht._===this&&(ht._=Jd),this}function tn(){}function ua(T){return T=Un(T),Yn(function(F){return _g(F,T)})}var bn=Ph(Gn),Tn=Ph(Rs),Ci=Ph(Es);function La(T){return Dp(T)?au(Ua(T)):Ox(T)}function Ru(T){return function(F){return T==null?t:rl(T,F)}}var L4=hu(),oN=hu(!0);function M4(){return[]}function D4(){return!1}function lN(){return{}}function cN(){return""}function uN(){return!0}function dN(T,F){if(T=Un(T),T<1||T>j)return[];var te=V,he=ys(T,V);F=Sn(F),T-=V;for(var Ee=Kl(he,F);++te<T;)F(te);return Ee}function fN(T){return Pn(T)?Gn(T,Ua):no(T)?[T]:ui(ec(Ia(T)))}function hN(T){var F=++_l;return Ia(T)+F}var pN=uf(function(T,F){return T+F},0),mN=kp("ceil"),gN=uf(function(T,F){return T/F},1),vN=kp("floor");function xN(T){return T&&T.length?Rl(T,Ft,_h):t}function bN(T,F){return T&&T.length?Rl(T,Sn(F,2),_h):t}function yN(T){return sh(T,Ft)}function wN(T,F){return sh(T,Sn(F,2))}function SN(T){return T&&T.length?Rl(T,Ft,gp):t}function _N(T,F){return T&&T.length?Rl(T,Sn(F,2),gp):t}var AN=uf(function(T,F){return T*F},1),CN=kp("round"),jN=uf(function(T,F){return T-F},0);function kN(T){return T&&T.length?Gd(T,Ft):0}function RN(T,F){return T&&T.length?Gd(T,Sn(F,2)):0}return $e.after=a4,$e.ary=Db,$e.assign=m4,$e.assignIn=Yb,$e.assignInWith=em,$e.assignWith=g4,$e.at=v4,$e.before=Jh,$e.bind=Su,$e.bindAll=Ae,$e.bindKey=Wp,$e.castArray=l4,$e.chain=Sf,$e.chunk=Zw,$e.compact=ob,$e.concat=lb,$e.cond=Ue,$e.conforms=lt,$e.constant=Ot,$e.countBy=_f,$e.create=x4,$e.curry=Qh,$e.curryRight=qp,$e.debounce=_u,$e.defaults=b4,$e.defaultsDeep=Zb,$e.defer=rc,$e.delay=e0,$e.difference=Ss,$e.differenceBy=xo,$e.differenceWith=Pc,$e.drop=cb,$e.dropRight=ub,$e.dropRightWhile=Jw,$e.dropWhile=Ug,$e.fill=zo,$e.filter=Sb,$e.flatMap=r1,$e.flatMapDeep=t4,$e.flatMapDepth=r4,$e.flatten=bo,$e.flattenDeep=db,$e.flattenDepth=gu,$e.flip=s4,$e.flow=Sr,$e.flowRight=Gt,$e.fromPairs=yd,$e.functions=Qb,$e.functionsIn=tm,$e.groupBy=Cb,$e.initial=Wg,$e.intersection=tc,$e.intersectionBy=fb,$e.intersectionWith=pf,$e.invert=ey,$e.invertBy=ty,$e.invokeMap=Up,$e.iteratee=Nn,$e.keyBy=jb,$e.keys=pi,$e.keysIn=Ai,$e.map=Zh,$e.mapKeys=S4,$e.mapValues=_4,$e.matches=Rn,$e.matchesProperty=Qa,$e.memoize=t0,$e.merge=A4,$e.mergeWith=l0,$e.method=Rt,$e.methodOf=yt,$e.mixin=Mt,$e.negate=r0,$e.nthArg=ua,$e.omit=rm,$e.omitBy=m1,$e.once=Ib,$e.orderBy=kb,$e.over=bn,$e.overArgs=Ob,$e.overEvery=Tn,$e.overSome=Ci,$e.partial=s1,$e.partialRight=Gp,$e.partition=Rb,$e.pick=C4,$e.pickBy=Nf,$e.property=La,$e.propertyOf=Ru,$e.pull=pb,$e.pullAll=gf,$e.pullAllBy=mb,$e.pullAllWith=zp,$e.pullAt=gb,$e.range=L4,$e.rangeRight=oN,$e.rearg=Pb,$e.reject=Hp,$e.remove=Qw,$e.rest=Fb,$e.reverse=qg,$e.sampleSize=Lb,$e.set=ry,$e.setWith=ny,$e.shuffle=ns,$e.slice=Ga,$e.sortBy=Mb,$e.sortedUniq=vf,$e.sortedUniqBy=Gg,$e.split=om,$e.spread=i4,$e.tail=Bc,$e.take=zs,$e.takeRight=xu,$e.takeRightWhile=wd,$e.takeWhile=Kg,$e.tap=Qg,$e.throttle=i1,$e.thru=$i,$e.toArray=Ho,$e.toPairs=g1,$e.toPairsIn=v1,$e.toPath=fN,$e.toPlainObject=Xb,$e.transform=x1,$e.unary=o1,$e.union=sl,$e.unionBy=xf,$e.unionWith=Xh,$e.uniq=yo,$e.uniqBy=Xg,$e.uniqWith=Yg,$e.unset=ay,$e.unzip=bf,$e.unzipWith=Yh,$e.update=nm,$e.updateWith=k4,$e.values=Tf,$e.valuesIn=b1,$e.without=bu,$e.words=Q,$e.wrap=o4,$e.xor=Ti,$e.xorBy=yu,$e.xorWith=yf,$e.zip=wf,$e.zipObject=Zg,$e.zipObjectDeep=Jg,$e.zipWith=vb,$e.entries=g1,$e.entriesIn=v1,$e.extend=Yb,$e.extendWith=em,Mt($e,$e),$e.add=pN,$e.attempt=ie,$e.camelCase=sy,$e.capitalize=sm,$e.ceil=mN,$e.clamp=y1,$e.clone=n0,$e.cloneDeep=Bb,$e.cloneDeepWith=pa,$e.cloneWith=c4,$e.conformsTo=l1,$e.deburr=$c,$e.defaultTo=hr,$e.divide=gN,$e.endsWith=Cu,$e.eq=wo,$e.escape=ju,$e.escapeRegExp=c0,$e.every=wb,$e.find=_b,$e.findIndex=al,$e.findKey=kf,$e.findLast=t1,$e.findLastIndex=Hg,$e.findLastKey=s0,$e.floor=vN,$e.forEach=Ab,$e.forEachRight=n1,$e.forIn=Jb,$e.forInRight=y4,$e.forOwn=Rf,$e.forOwnRight=i0,$e.get=o0,$e.gt=c1,$e.gte=zb,$e.has=p1,$e.hasIn=Ef,$e.head=Fc,$e.identity=Ft,$e.includes=Af,$e.indexOf=Vg,$e.inRange=am,$e.invoke=w4,$e.isArguments=zc,$e.isArray=Pn,$e.isArrayBuffer=Kp,$e.isArrayLike=fi,$e.isArrayLikeObject=$s,$e.isBoolean=u4,$e.isBuffer=Au,$e.isDate=$b,$e.isElement=Ub,$e.isEmpty=Xp,$e.isEqual=Ja,$e.isEqualWith=u1,$e.isError=hi,$e.isFinite=d4,$e.isFunction=Nl,$e.isInteger=Yp,$e.isLength=Sd,$e.isMap=Zp,$e.isMatch=d1,$e.isMatchWith=f4,$e.isNaN=Hb,$e.isNative=h4,$e.isNil=p4,$e.isNull=Vb,$e.isNumber=Wb,$e.isObject=_s,$e.isObjectLike=Ms,$e.isPlainObject=il,$e.isRegExp=Jp,$e.isSafeInteger=f1,$e.isSet=qb,$e.isString=Qp,$e.isSymbol=no,$e.isTypedArray=Cf,$e.isUndefined=Tl,$e.isWeakMap=h1,$e.isWeakSet=Gb,$e.join=Kh,$e.kebabCase=u0,$e.last=zi,$e.lastIndexOf=mf,$e.lowerCase=ku,$e.lowerFirst=R4,$e.lt=Kb,$e.lte=a0,$e.max=xN,$e.maxBy=bN,$e.mean=yN,$e.meanBy=wN,$e.min=SN,$e.minBy=_N,$e.stubArray=M4,$e.stubFalse=D4,$e.stubObject=lN,$e.stubString=cN,$e.stubTrue=uN,$e.multiply=AN,$e.nth=hb,$e.noConflict=gr,$e.noop=tn,$e.now=Vp,$e.pad=iy,$e.padEnd=d0,$e.padStart=E4,$e.parseInt=oy,$e.random=w1,$e.reduce=Eb,$e.reduceRight=Nb,$e.repeat=im,$e.replace=ly,$e.result=j4,$e.round=CN,$e.runInContext=Ct,$e.sample=Tb,$e.size=a1,$e.snakeCase=N4,$e.some=n4,$e.sortedIndex=us,$e.sortedIndexBy=ha,$e.sortedIndexOf=Ea,$e.sortedLastIndex=Ka,$e.sortedLastIndexBy=$o,$e.sortedLastIndexOf=vu,$e.startCase=lm,$e.startsWith=cy,$e.subtract=jN,$e.sum=kN,$e.sumBy=RN,$e.template=f0,$e.times=dN,$e.toFinite=nc,$e.toInteger=Un,$e.toLength=ac,$e.toLower=S1,$e.toNumber=ol,$e.toSafeInteger=jf,$e.toString=Ia,$e.toUpper=cm,$e.trim=uy,$e.trimEnd=T4,$e.trimStart=um,$e.truncate=x,$e.unescape=w,$e.uniqueId=hN,$e.upperCase=E,$e.upperFirst=B,$e.each=Ab,$e.eachRight=n1,$e.first=Fc,Mt($e,function(){var T={};return Bi($e,function(F,te){Da.call($e.prototype,te)||(T[te]=F)}),T}(),{chain:!1}),$e.VERSION=n,hn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(T){$e[T].placeholder=$e}),hn(["drop","take"],function(T,F){ca.prototype[T]=function(te){te=te===t?1:ps(Un(te),0);var he=this.__filtered__&&!F?new ca(this):this.clone();return he.__filtered__?he.__takeCount__=ys(te,he.__takeCount__):he.__views__.push({size:ys(te,V),type:T+(he.__dir__<0?"Right":"")}),he},ca.prototype[T+"Right"]=function(te){return this.reverse()[T](te).reverse()}}),hn(["filter","map","takeWhile"],function(T,F){var te=F+1,he=te==U||te==_;ca.prototype[T]=function(Ee){var We=this.clone();return We.__iteratees__.push({iteratee:Sn(Ee,3),type:te}),We.__filtered__=We.__filtered__||he,We}}),hn(["head","last"],function(T,F){var te="take"+(F?"Right":"");ca.prototype[T]=function(){return this[te](1).value()[0]}}),hn(["initial","tail"],function(T,F){var te="drop"+(F?"":"Right");ca.prototype[T]=function(){return this.__filtered__?new ca(this):this[te](1)}}),ca.prototype.compact=function(){return this.filter(Ft)},ca.prototype.find=function(T){return this.filter(T).head()},ca.prototype.findLast=function(T){return this.reverse().find(T)},ca.prototype.invokeMap=Yn(function(T,F){return typeof T=="function"?new ca(this):this.map(function(te){return fd(te,T,F)})}),ca.prototype.reject=function(T){return this.filter(r0(Sn(T)))},ca.prototype.slice=function(T,F){T=Un(T);var te=this;return te.__filtered__&&(T>0||F<0)?new ca(te):(T<0?te=te.takeRight(-T):T&&(te=te.drop(T)),F!==t&&(F=Un(F),te=F<0?te.dropRight(-F):te.take(F-T)),te)},ca.prototype.takeRightWhile=function(T){return this.reverse().takeWhile(T).reverse()},ca.prototype.toArray=function(){return this.take(V)},Bi(ca.prototype,function(T,F){var te=/^(?:filter|find|map|reject)|While$/.test(F),he=/^(?:head|last)$/.test(F),Ee=$e[he?"take"+(F=="last"?"Right":""):F],We=he||/^find/.test(F);Ee&&($e.prototype[F]=function(){var it=this.__wrapped__,bt=he?[1]:arguments,Tt=it instanceof ca,br=bt[0],_r=Tt||Pn(it),Tr=function(_a){var Ma=Ee.apply($e,Za([_a],bt));return he&&Xr?Ma[0]:Ma};_r&&te&&typeof br=="function"&&br.length!=1&&(Tt=_r=!1);var Xr=this.__chain__,gn=!!this.__actions__.length,Dn=We&&!Xr,da=Tt&&!gn;if(!We&&_r){it=da?it:new ca(this);var In=T.apply(it,bt);return In.__actions__.push({func:$i,args:[Tr],thisArg:t}),new ho(In,Xr)}return Dn&&da?T.apply(this,bt):(In=this.thru(Tr),Dn?he?In.value()[0]:In.value():In)})}),hn(["pop","push","shift","sort","splice","unshift"],function(T){var F=rp[T],te=/^(?:push|sort|unshift)$/.test(T)?"tap":"thru",he=/^(?:pop|shift)$/.test(T);$e.prototype[T]=function(){var Ee=arguments;if(he&&!this.__chain__){var We=this.value();return F.apply(Pn(We)?We:[],Ee)}return this[te](function(it){return F.apply(Pn(it)?it:[],Ee)})}}),Bi(ca.prototype,function(T,F){var te=$e[F];if(te){var he=te.name+"";Da.call(el,he)||(el[he]=[]),el[he].push({name:F,func:te})}}),el[Bs(t,b).name]=[{name:"wrapper",func:t}],ca.prototype.clone=xh,ca.prototype.reverse=ip,ca.prototype.value=od,$e.prototype.at=xb,$e.prototype.chain=Uo,$e.prototype.commit=bb,$e.prototype.next=yb,$e.prototype.plant=wu,$e.prototype.reverse=$p,$e.prototype.toJSON=$e.prototype.valueOf=$e.prototype.value=e1,$e.prototype.first=$e.prototype.head,nd&&($e.prototype[nd]=e4),$e},Sl=Cc();mr?((mr.exports=Sl)._=Sl,er._=Sl):ht._=Sl}).call($ie)}(rv,rv.exports)),rv.exports}var KS=Uie();function Py(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var q3={exports:{}};/*! ExcelJS 19-10-2023 */var ij;function Hie(){return ij||(ij=1,function(e,r){(function(t){e.exports=t()})(function(){return function t(n,s,o){function i(l,d){if(!s[l]){if(!n[l]){var h=typeof Py=="function"&&Py;if(!d&&h)return h(l,!0);if(c)return c(l,!0);var f=new Error("Cannot find module '"+l+"'");throw f.code="MODULE_NOT_FOUND",f}var p=s[l]={exports:{}};n[l][0].call(p.exports,function(v){return i(n[l][1][v]||v)},p,p.exports,t,n,s,o)}return s[l].exports}for(var c=typeof Py=="function"&&Py,u=0;u<o.length;u++)i(o[u]);return i}({1:[function(t,n,s){const o=t("fs"),i=t("fast-csv"),c=t("dayjs/plugin/customParseFormat"),u=t("dayjs/plugin/utc"),l=t("dayjs").extend(c).extend(u),d=t("../utils/stream-buf"),{fs:{exists:h}}=t("../utils/utils"),f={true:!0,false:!1,"#N/A":{error:"#N/A"},"#REF!":{error:"#REF!"},"#NAME?":{error:"#NAME?"},"#DIV/0!":{error:"#DIV/0!"},"#NULL!":{error:"#NULL!"},"#VALUE!":{error:"#VALUE!"},"#NUM!":{error:"#NUM!"}};n.exports=class{constructor(p){this.workbook=p,this.worksheet=null}async readFile(p,v){if(v=v||{},!await h(p))throw new Error("File not found: "+p);const g=o.createReadStream(p),m=await this.read(g,v);return g.close(),m}read(p,v){return v=v||{},new Promise((g,m)=>{const b=this.workbook.addWorksheet(v.sheetName),y=v.dateFormats||["YYYY-MM-DD[T]HH:mm:ssZ","YYYY-MM-DD[T]HH:mm:ss","MM-DD-YYYY","YYYY-MM-DD"],S=v.map||function(L){if(L==="")return null;const O=Number(L);if(!Number.isNaN(O)&&O!==1/0)return O;const H=y.reduce((q,D)=>{if(q)return q;const W=l(L,D,!0);return W.isValid()?W:null},null);if(H)return new Date(H.valueOf());const z=f[L];return z!==void 0?z:L},C=i.parse(v.parserOptions).on("data",L=>{b.addRow(L.map(S))}).on("end",()=>{C.emit("worksheet",b)});C.on("worksheet",g).on("error",m),p.pipe(C)})}createInputStream(){throw new Error("`CSV#createInputStream` is deprecated. You should use `CSV#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}write(p,v){return new Promise((g,m)=>{v=v||{};const b=this.workbook.getWorksheet(v.sheetName||v.sheetId),y=i.format(v.formatterOptions);p.on("finish",()=>{g()}),y.on("error",m),y.pipe(p);const{dateFormat:S,dateUTC:C}=v,L=v.map||(z=>{if(z){if(z.text||z.hyperlink)return z.hyperlink||z.text||"";if(z.formula||z.result)return z.result||"";if(z instanceof Date)return S?C?l.utc(z).format(S):l(z).format(S):C?l.utc(z).format():l(z).format();if(z.error)return z.error;if(typeof z=="object")return JSON.stringify(z)}return z}),O=v.includeEmptyRows===void 0||v.includeEmptyRows;let H=1;b&&b.eachRow((z,q)=>{if(O)for(;H++<q-1;)y.write([]);const{values:D}=z;D.shift(),y.write(D.map(L)),H=q}),y.end()})}writeFile(p,v){const g={encoding:(v=v||{}).encoding||"utf8"},m=o.createWriteStream(p,g);return this.write(m,v)}async writeBuffer(p){const v=new d;return await this.write(v,p),v.read()}}},{"../utils/stream-buf":24,"../utils/utils":27,dayjs:391,"dayjs/plugin/customParseFormat":392,"dayjs/plugin/utc":393,"fast-csv":424,fs:216}],2:[function(t,n,s){const o=t("../utils/col-cache");class i{constructor(u,l){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(this.worksheet=u,l)if(typeof l=="string"){const h=o.decodeAddress(l);this.nativeCol=h.col+d,this.nativeColOff=0,this.nativeRow=h.row+d,this.nativeRowOff=0}else l.nativeCol!==void 0?(this.nativeCol=l.nativeCol||0,this.nativeColOff=l.nativeColOff||0,this.nativeRow=l.nativeRow||0,this.nativeRowOff=l.nativeRowOff||0):l.col!==void 0?(this.col=l.col+d,this.row=l.row+d):(this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0);else this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0}static asInstance(u){return u instanceof i||u==null?u:new i(u)}get col(){return this.nativeCol+Math.min(this.colWidth-1,this.nativeColOff)/this.colWidth}set col(u){this.nativeCol=Math.floor(u),this.nativeColOff=Math.floor((u-this.nativeCol)*this.colWidth)}get row(){return this.nativeRow+Math.min(this.rowHeight-1,this.nativeRowOff)/this.rowHeight}set row(u){this.nativeRow=Math.floor(u),this.nativeRowOff=Math.floor((u-this.nativeRow)*this.rowHeight)}get colWidth(){return this.worksheet&&this.worksheet.getColumn(this.nativeCol+1)&&this.worksheet.getColumn(this.nativeCol+1).isCustomWidth?Math.floor(1e4*this.worksheet.getColumn(this.nativeCol+1).width):64e4}get rowHeight(){return this.worksheet&&this.worksheet.getRow(this.nativeRow+1)&&this.worksheet.getRow(this.nativeRow+1).height?Math.floor(1e4*this.worksheet.getRow(this.nativeRow+1).height):18e4}get model(){return{nativeCol:this.nativeCol,nativeColOff:this.nativeColOff,nativeRow:this.nativeRow,nativeRowOff:this.nativeRowOff}}set model(u){this.nativeCol=u.nativeCol,this.nativeColOff=u.nativeColOff,this.nativeRow=u.nativeRow,this.nativeRowOff=u.nativeRowOff}}n.exports=i},{"../utils/col-cache":19}],3:[function(t,n,s){const o=t("../utils/col-cache"),i=t("../utils/under-dash"),c=t("./enums"),{slideFormula:u}=t("../utils/shared-formula"),l=t("./note");class d{constructor(p,v,g){if(!p||!v)throw new Error("A Cell needs a Row");this._row=p,this._column=v,o.validateAddress(g),this._address=g,this._value=h.create(d.Types.Null,this),this.style=this._mergeStyle(p.style,v.style,{}),this._mergeCount=0}get worksheet(){return this._row.worksheet}get workbook(){return this._row.worksheet.workbook}destroy(){delete this.style,delete this._value,delete this._row,delete this._column,delete this._address}get numFmt(){return this.style.numFmt}set numFmt(p){this.style.numFmt=p}get font(){return this.style.font}set font(p){this.style.font=p}get alignment(){return this.style.alignment}set alignment(p){this.style.alignment=p}get border(){return this.style.border}set border(p){this.style.border=p}get fill(){return this.style.fill}set fill(p){this.style.fill=p}get protection(){return this.style.protection}set protection(p){this.style.protection=p}_mergeStyle(p,v,g){const m=p&&p.numFmt||v&&v.numFmt;m&&(g.numFmt=m);const b=p&&p.font||v&&v.font;b&&(g.font=b);const y=p&&p.alignment||v&&v.alignment;y&&(g.alignment=y);const S=p&&p.border||v&&v.border;S&&(g.border=S);const C=p&&p.fill||v&&v.fill;C&&(g.fill=C);const L=p&&p.protection||v&&v.protection;return L&&(g.protection=L),g}get address(){return this._address}get row(){return this._row.number}get col(){return this._column.number}get $col$row(){return`$${this._column.letter}$${this.row}`}get type(){return this._value.type}get effectiveType(){return this._value.effectiveType}toCsvString(){return this._value.toCsvString()}addMergeRef(){this._mergeCount++}releaseMergeRef(){this._mergeCount--}get isMerged(){return this._mergeCount>0||this.type===d.Types.Merge}merge(p,v){this._value.release(),this._value=h.create(d.Types.Merge,this,p),v||(this.style=p.style)}unmerge(){this.type===d.Types.Merge&&(this._value.release(),this._value=h.create(d.Types.Null,this),this.style=this._mergeStyle(this._row.style,this._column.style,{}))}isMergedTo(p){return this._value.type===d.Types.Merge&&this._value.isMergedTo(p)}get master(){return this.type===d.Types.Merge?this._value.master:this}get isHyperlink(){return this._value.type===d.Types.Hyperlink}get hyperlink(){return this._value.hyperlink}get value(){return this._value.value}set value(p){this.type!==d.Types.Merge?(this._value.release(),this._value=h.create(h.getType(p),this,p)):this._value.master.value=p}get note(){return this._comment&&this._comment.note}set note(p){this._comment=new l(p)}get text(){return this._value.toString()}get html(){return i.escapeHtml(this.text)}toString(){return this.text}_upgradeToHyperlink(p){this.type===d.Types.String&&(this._value=h.create(d.Types.Hyperlink,this,{text:this._value.value,hyperlink:p}))}get formula(){return this._value.formula}get result(){return this._value.result}get formulaType(){return this._value.formulaType}get fullAddress(){const{worksheet:p}=this._row;return{sheetName:p.name,address:this.address,row:this.row,col:this.col}}get name(){return this.names[0]}set name(p){this.names=[p]}get names(){return this.workbook.definedNames.getNamesEx(this.fullAddress)}set names(p){const{definedNames:v}=this.workbook;v.removeAllNames(this.fullAddress),p.forEach(g=>{v.addEx(this.fullAddress,g)})}addName(p){this.workbook.definedNames.addEx(this.fullAddress,p)}removeName(p){this.workbook.definedNames.removeEx(this.fullAddress,p)}removeAllNames(){this.workbook.definedNames.removeAllNames(this.fullAddress)}get _dataValidations(){return this.worksheet.dataValidations}get dataValidation(){return this._dataValidations.find(this.address)}set dataValidation(p){this._dataValidations.add(this.address,p)}get model(){const{model:p}=this._value;return p.style=this.style,this._comment&&(p.comment=this._comment.model),p}set model(p){if(this._value.release(),this._value=h.create(p.type,this),this._value.model=p,p.comment)switch(p.comment.type){case"note":this._comment=l.fromModel(p.comment)}p.style?this.style=p.style:this.style={}}}d.Types=c.ValueType;const h={getType:f=>f==null?d.Types.Null:f instanceof String||typeof f=="string"?d.Types.String:typeof f=="number"?d.Types.Number:typeof f=="boolean"?d.Types.Boolean:f instanceof Date?d.Types.Date:f.text&&f.hyperlink?d.Types.Hyperlink:f.formula||f.sharedFormula?d.Types.Formula:f.richText?d.Types.RichText:f.sharedString?d.Types.SharedString:f.error?d.Types.Error:d.Types.JSON,types:[{t:d.Types.Null,f:class{constructor(f){this.model={address:f.address,type:d.Types.Null}}get value(){return null}set value(f){}get type(){return d.Types.Null}get effectiveType(){return d.Types.Null}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return""}release(){}toString(){return""}}},{t:d.Types.Number,f:class{constructor(f,p){this.model={address:f.address,type:d.Types.Number,value:p}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return d.Types.Number}get effectiveType(){return d.Types.Number}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:d.Types.String,f:class{constructor(f,p){this.model={address:f.address,type:d.Types.String,value:p}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return d.Types.String}get effectiveType(){return d.Types.String}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return`"${this.model.value.replace(/"/g,'""')}"`}release(){}toString(){return this.model.value}}},{t:d.Types.Date,f:class{constructor(f,p){this.model={address:f.address,type:d.Types.Date,value:p}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return d.Types.Date}get effectiveType(){return d.Types.Date}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value.toISOString()}release(){}toString(){return this.model.value.toString()}}},{t:d.Types.Hyperlink,f:class{constructor(f,p){this.model={address:f.address,type:d.Types.Hyperlink,text:p?p.text:void 0,hyperlink:p?p.hyperlink:void 0},p&&p.tooltip&&(this.model.tooltip=p.tooltip)}get value(){const f={text:this.model.text,hyperlink:this.model.hyperlink};return this.model.tooltip&&(f.tooltip=this.model.tooltip),f}set value(f){this.model={text:f.text,hyperlink:f.hyperlink},f.tooltip&&(this.model.tooltip=f.tooltip)}get text(){return this.model.text}set text(f){this.model.text=f}get hyperlink(){return this.model.hyperlink}set hyperlink(f){this.model.hyperlink=f}get type(){return d.Types.Hyperlink}get effectiveType(){return d.Types.Hyperlink}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.hyperlink}release(){}toString(){return this.model.text}}},{t:d.Types.Formula,f:class{constructor(f,p){this.cell=f,this.model={address:f.address,type:d.Types.Formula,shareType:p?p.shareType:void 0,ref:p?p.ref:void 0,formula:p?p.formula:void 0,sharedFormula:p?p.sharedFormula:void 0,result:p?p.result:void 0}}_copyModel(f){const p={},v=g=>{const m=f[g];m&&(p[g]=m)};return v("formula"),v("result"),v("ref"),v("shareType"),v("sharedFormula"),p}get value(){return this._copyModel(this.model)}set value(f){this.model=this._copyModel(f)}validate(f){switch(h.getType(f)){case d.Types.Null:case d.Types.String:case d.Types.Number:case d.Types.Date:break;case d.Types.Hyperlink:case d.Types.Formula:default:throw new Error("Cannot process that type of result value")}}get dependencies(){return{ranges:this.formula.match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g),cells:this.formula.replace(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g,"").match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}/g)}}get formula(){return this.model.formula||this._getTranslatedFormula()}set formula(f){this.model.formula=f}get formulaType(){return this.model.formula?c.FormulaType.Master:this.model.sharedFormula?c.FormulaType.Shared:c.FormulaType.None}get result(){return this.model.result}set result(f){this.model.result=f}get type(){return d.Types.Formula}get effectiveType(){const f=this.model.result;return f==null?c.ValueType.Null:f instanceof String||typeof f=="string"?c.ValueType.String:typeof f=="number"?c.ValueType.Number:f instanceof Date?c.ValueType.Date:f.text&&f.hyperlink?c.ValueType.Hyperlink:f.formula?c.ValueType.Formula:c.ValueType.Null}get address(){return this.model.address}set address(f){this.model.address=f}_getTranslatedFormula(){if(!this._translatedFormula&&this.model.sharedFormula){const{worksheet:f}=this.cell,p=f.findCell(this.model.sharedFormula);this._translatedFormula=p&&u(p.formula,p.address,this.model.address)}return this._translatedFormula}toCsvString(){return""+(this.model.result||"")}release(){}toString(){return this.model.result?this.model.result.toString():""}}},{t:d.Types.Merge,f:class{constructor(f,p){this.model={address:f.address,type:d.Types.Merge,master:p?p.address:void 0},this._master=p,p&&p.addMergeRef()}get value(){return this._master.value}set value(f){f instanceof d?(this._master&&this._master.releaseMergeRef(),f.addMergeRef(),this._master=f):this._master.value=f}isMergedTo(f){return f===this._master}get master(){return this._master}get type(){return d.Types.Merge}get effectiveType(){return this._master.effectiveType}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return""}release(){this._master.releaseMergeRef()}toString(){return this.value.toString()}}},{t:d.Types.JSON,f:class{constructor(f,p){this.model={address:f.address,type:d.Types.String,value:JSON.stringify(p),rawValue:p}}get value(){return this.model.rawValue}set value(f){this.model.rawValue=f,this.model.value=JSON.stringify(f)}get type(){return d.Types.String}get effectiveType(){return d.Types.String}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value}release(){}toString(){return this.model.value}}},{t:d.Types.SharedString,f:class{constructor(f,p){this.model={address:f.address,type:d.Types.SharedString,value:p}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return d.Types.SharedString}get effectiveType(){return d.Types.SharedString}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:d.Types.RichText,f:class{constructor(f,p){this.model={address:f.address,type:d.Types.String,value:p}}get value(){return this.model.value}set value(f){this.model.value=f}toString(){return this.model.value.richText.map(f=>f.text).join("")}get type(){return d.Types.RichText}get effectiveType(){return d.Types.RichText}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return`"${this.text.replace(/"/g,'""')}"`}release(){}}},{t:d.Types.Boolean,f:class{constructor(f,p){this.model={address:f.address,type:d.Types.Boolean,value:p}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return d.Types.Boolean}get effectiveType(){return d.Types.Boolean}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value?1:0}release(){}toString(){return this.model.value.toString()}}},{t:d.Types.Error,f:class{constructor(f,p){this.model={address:f.address,type:d.Types.Error,value:p}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return d.Types.Error}get effectiveType(){return d.Types.Error}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.toString()}release(){}toString(){return this.model.value.error.toString()}}}].reduce((f,p)=>(f[p.t]=p.f,f),[]),create(f,p,v){const g=this.types[f];if(!g)throw new Error("Could not create Value of type "+f);return new g(p,v)}};n.exports=d},{"../utils/col-cache":19,"../utils/shared-formula":23,"../utils/under-dash":26,"./enums":7,"./note":9}],4:[function(t,n,s){const o=t("../utils/under-dash"),i=t("./enums"),c=t("../utils/col-cache");class u{constructor(d,h,f){this._worksheet=d,this._number=h,f!==!1&&(this.defn=f)}get number(){return this._number}get worksheet(){return this._worksheet}get letter(){return c.n2l(this._number)}get isCustomWidth(){return this.width!==void 0&&this.width!==9}get defn(){return{header:this._header,key:this.key,width:this.width,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel}}set defn(d){d?(this.key=d.key,this.width=d.width!==void 0?d.width:9,this.outlineLevel=d.outlineLevel,d.style?this.style=d.style:this.style={},this.header=d.header,this._hidden=!!d.hidden):(delete this._header,delete this._key,delete this.width,this.style={},this.outlineLevel=0)}get headers(){return this._header&&this._header instanceof Array?this._header:[this._header]}get header(){return this._header}set header(d){d!==void 0?(this._header=d,this.headers.forEach((h,f)=>{this._worksheet.getCell(f+1,this.number).value=h})):this._header=void 0}get key(){return this._key}set key(d){(this._key&&this._worksheet.getColumnKey(this._key))===this&&this._worksheet.deleteColumnKey(this._key),this._key=d,d&&this._worksheet.setColumnKey(this._key,this)}get hidden(){return!!this._hidden}set hidden(d){this._hidden=d}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(d){this._outlineLevel=d}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelCol)}toString(){return JSON.stringify({key:this.key,width:this.width,headers:this.headers.length?this.headers:void 0})}equivalentTo(d){return this.width===d.width&&this.hidden===d.hidden&&this.outlineLevel===d.outlineLevel&&o.isEqual(this.style,d.style)}get isDefault(){if(this.isCustomWidth||this.hidden||this.outlineLevel)return!1;const d=this.style;return!d||!(d.font||d.numFmt||d.alignment||d.border||d.fill||d.protection)}get headerCount(){return this.headers.length}eachCell(d,h){const f=this.number;h||(h=d,d=null),this._worksheet.eachRow(d,(p,v)=>{h(p.getCell(f),v)})}get values(){const d=[];return this.eachCell((h,f)=>{h&&h.type!==i.ValueType.Null&&(d[f]=h.value)}),d}set values(d){if(!d)return;const h=this.number;let f=0;d.hasOwnProperty("0")&&(f=1),d.forEach((p,v)=>{this._worksheet.getCell(v+f,h).value=p})}_applyStyle(d,h){return this.style[d]=h,this.eachCell(f=>{f[d]=h}),h}get numFmt(){return this.style.numFmt}set numFmt(d){this._applyStyle("numFmt",d)}get font(){return this.style.font}set font(d){this._applyStyle("font",d)}get alignment(){return this.style.alignment}set alignment(d){this._applyStyle("alignment",d)}get protection(){return this.style.protection}set protection(d){this._applyStyle("protection",d)}get border(){return this.style.border}set border(d){this._applyStyle("border",d)}get fill(){return this.style.fill}set fill(d){this._applyStyle("fill",d)}static toModel(d){const h=[];let f=null;return d&&d.forEach((p,v)=>{p.isDefault?f&&(f=null):f&&p.equivalentTo(f)?f.max=v+1:(f={min:v+1,max:v+1,width:p.width!==void 0?p.width:9,style:p.style,isCustomWidth:p.isCustomWidth,hidden:p.hidden,outlineLevel:p.outlineLevel,collapsed:p.collapsed},h.push(f))}),h.length?h:void 0}static fromModel(d,h){const f=[];let p=1,v=0;for(h=(h=h||[]).sort(function(g,m){return g.min-m.min});v<h.length;){const g=h[v++];for(;p<g.min;)f.push(new u(d,p++));for(;p<=g.max;)f.push(new u(d,p++,g))}return f.length?f:null}}n.exports=u},{"../utils/col-cache":19,"../utils/under-dash":26,"./enums":7}],5:[function(t,n,s){n.exports=class{constructor(o){this.model=o||{}}add(o,i){return this.model[o]=i}find(o){return this.model[o]}remove(o){this.model[o]=void 0}}},{}],6:[function(t,n,s){const o=t("../utils/under-dash"),i=t("../utils/col-cache"),c=t("../utils/cell-matrix"),u=t("./range"),l=/[$](\w+)[$](\d+)(:[$](\w+)[$](\d+))?/;n.exports=class{constructor(){this.matrixMap={}}getMatrix(d){return this.matrixMap[d]||(this.matrixMap[d]=new c)}add(d,h){const f=i.decodeEx(d);this.addEx(f,h)}addEx(d,h){const f=this.getMatrix(h);if(d.top)for(let p=d.left;p<=d.right;p++)for(let v=d.top;v<=d.bottom;v++){const g={sheetName:d.sheetName,address:i.n2l(p)+v,row:v,col:p};f.addCellEx(g)}else f.addCellEx(d)}remove(d,h){const f=i.decodeEx(d);this.removeEx(f,h)}removeEx(d,h){this.getMatrix(h).removeCellEx(d)}removeAllNames(d){o.each(this.matrixMap,h=>{h.removeCellEx(d)})}forEach(d){o.each(this.matrixMap,(h,f)=>{h.forEach(p=>{d(f,p)})})}getNames(d){return this.getNamesEx(i.decodeEx(d))}getNamesEx(d){return o.map(this.matrixMap,(h,f)=>h.findCellEx(d)&&f).filter(Boolean)}_explore(d,h){h.mark=!1;const{sheetName:f}=h,p=new u(h.row,h.col,h.row,h.col,f);let v,g;function m(y,S){const C=d.findCellAt(f,y,h.col);return!(!C||!C.mark)&&(p[S]=y,C.mark=!1,!0)}for(g=h.row-1;m(g,"top");g--);for(g=h.row+1;m(g,"bottom");g++);function b(y,S){const C=[];for(g=p.top;g<=p.bottom;g++){const L=d.findCellAt(f,g,y);if(!L||!L.mark)return!1;C.push(L)}p[S]=y;for(let L=0;L<C.length;L++)C[L].mark=!1;return!0}for(v=h.col-1;b(v,"left");v--);for(v=h.col+1;b(v,"right");v++);return p}getRanges(d,h){return(h=h||this.matrixMap[d])?(h.forEach(f=>{f.mark=!0}),{name:d,ranges:h.map(f=>f.mark&&this._explore(h,f)).filter(Boolean).map(f=>f.$shortRange)}):{name:d,ranges:[]}}normaliseMatrix(d,h){d.forEachInSheet(h,(f,p,v)=>{f&&(f.row===p&&f.col===v||(f.row=p,f.col=v,f.address=i.n2l(v)+p))})}spliceRows(d,h,f,p){o.each(this.matrixMap,v=>{v.spliceRows(d,h,f,p),this.normaliseMatrix(v,d)})}spliceColumns(d,h,f,p){o.each(this.matrixMap,v=>{v.spliceColumns(d,h,f,p),this.normaliseMatrix(v,d)})}get model(){return o.map(this.matrixMap,(d,h)=>this.getRanges(h,d)).filter(d=>d.ranges.length)}set model(d){const h=this.matrixMap={};d.forEach(f=>{const p=h[f.name]=new c;f.ranges.forEach(v=>{l.test(v.split("!").pop()||"")&&p.addCell(v)})})}}},{"../utils/cell-matrix":18,"../utils/col-cache":19,"../utils/under-dash":26,"./range":10}],7:[function(t,n,s){n.exports={ValueType:{Null:0,Merge:1,Number:2,String:3,Date:4,Hyperlink:5,Formula:6,SharedString:7,RichText:8,Boolean:9,Error:10},FormulaType:{None:0,Master:1,Shared:2},RelationshipType:{None:0,OfficeDocument:1,Worksheet:2,CalcChain:3,SharedStrings:4,Styles:5,Theme:6,Hyperlink:7},DocumentType:{Xlsx:1},ReadingOrder:{LeftToRight:1,RightToLeft:2},ErrorValue:{NotApplicable:"#N/A",Ref:"#REF!",Name:"#NAME?",DivZero:"#DIV/0!",Null:"#NULL!",Value:"#VALUE!",Num:"#NUM!"}}},{}],8:[function(t,n,s){const o=t("../utils/col-cache"),i=t("./anchor");n.exports=class{constructor(c,u){this.worksheet=c,this.model=u}get model(){switch(this.type){case"background":return{type:this.type,imageId:this.imageId};case"image":return{type:this.type,imageId:this.imageId,hyperlinks:this.range.hyperlinks,range:{tl:this.range.tl.model,br:this.range.br&&this.range.br.model,ext:this.range.ext,editAs:this.range.editAs}};default:throw new Error("Invalid Image Type")}}set model(c){let{type:u,imageId:l,range:d,hyperlinks:h}=c;if(this.type=u,this.imageId=l,u==="image")if(typeof d=="string"){const f=o.decode(d);this.range={tl:new i(this.worksheet,{col:f.left,row:f.top},-1),br:new i(this.worksheet,{col:f.right,row:f.bottom},0),editAs:"oneCell"}}else this.range={tl:new i(this.worksheet,d.tl,0),br:d.br&&new i(this.worksheet,d.br,0),ext:d.ext,editAs:d.editAs,hyperlinks:h||d.hyperlinks}}}},{"../utils/col-cache":19,"./anchor":2}],9:[function(t,n,s){const o=t("../utils/under-dash");class i{constructor(u){this.note=u}get model(){let u=null;switch(typeof this.note){case"string":u={type:"note",note:{texts:[{text:this.note}]}};break;default:u={type:"note",note:this.note}}return o.deepMerge({},i.DEFAULT_CONFIGS,u)}set model(u){const{note:l}=u,{texts:d}=l;d.length===1&&Object.keys(d[0]).length===1?this.note=d[0].text:this.note=l}static fromModel(u){const l=new i;return l.model=u,l}}i.DEFAULT_CONFIGS={note:{margins:{insetmode:"auto",inset:[.13,.13,.25,.25]},protection:{locked:"True",lockText:"True"},editAs:"absolute"}},n.exports=i},{"../utils/under-dash":26}],10:[function(t,n,s){const o=t("../utils/col-cache");class i{constructor(){this.decode(arguments)}setTLBR(u,l,d,h,f){if(arguments.length<4){const p=o.decodeAddress(u),v=o.decodeAddress(l);this.model={top:Math.min(p.row,v.row),left:Math.min(p.col,v.col),bottom:Math.max(p.row,v.row),right:Math.max(p.col,v.col),sheetName:d},this.setTLBR(p.row,p.col,v.row,v.col,f)}else this.model={top:Math.min(u,d),left:Math.min(l,h),bottom:Math.max(u,d),right:Math.max(l,h),sheetName:f}}decode(u){switch(u.length){case 5:this.setTLBR(u[0],u[1],u[2],u[3],u[4]);break;case 4:this.setTLBR(u[0],u[1],u[2],u[3]);break;case 3:this.setTLBR(u[0],u[1],u[2]);break;case 2:this.setTLBR(u[0],u[1]);break;case 1:{const l=u[0];if(l instanceof i)this.model={top:l.model.top,left:l.model.left,bottom:l.model.bottom,right:l.model.right,sheetName:l.sheetName};else if(l instanceof Array)this.decode(l);else if(l.top&&l.left&&l.bottom&&l.right)this.model={top:l.top,left:l.left,bottom:l.bottom,right:l.right,sheetName:l.sheetName};else{const d=o.decodeEx(l);d.top?this.model={top:d.top,left:d.left,bottom:d.bottom,right:d.right,sheetName:d.sheetName}:this.model={top:d.row,left:d.col,bottom:d.row,right:d.col,sheetName:d.sheetName}}break}case 0:this.model={top:0,left:0,bottom:0,right:0};break;default:throw new Error("Invalid number of arguments to _getDimensions() - "+u.length)}}get top(){return this.model.top||1}set top(u){this.model.top=u}get left(){return this.model.left||1}set left(u){this.model.left=u}get bottom(){return this.model.bottom||1}set bottom(u){this.model.bottom=u}get right(){return this.model.right||1}set right(u){this.model.right=u}get sheetName(){return this.model.sheetName}set sheetName(u){this.model.sheetName=u}get _serialisedSheetName(){const{sheetName:u}=this.model;return u?/^[a-zA-Z0-9]*$/.test(u)?u+"!":`'${u}'!`:""}expand(u,l,d,h){(!this.model.top||u<this.top)&&(this.top=u),(!this.model.left||l<this.left)&&(this.left=l),(!this.model.bottom||d>this.bottom)&&(this.bottom=d),(!this.model.right||h>this.right)&&(this.right=h)}expandRow(u){if(u){const{dimensions:l,number:d}=u;l&&this.expand(d,l.min,d,l.max)}}expandToAddress(u){const l=o.decodeEx(u);this.expand(l.row,l.col,l.row,l.col)}get tl(){return o.n2l(this.left)+this.top}get $t$l(){return`$${o.n2l(this.left)}$${this.top}`}get br(){return o.n2l(this.right)+this.bottom}get $b$r(){return`$${o.n2l(this.right)}$${this.bottom}`}get range(){return`${this._serialisedSheetName+this.tl}:${this.br}`}get $range(){return`${this._serialisedSheetName+this.$t$l}:${this.$b$r}`}get shortRange(){return this.count>1?this.range:this._serialisedSheetName+this.tl}get $shortRange(){return this.count>1?this.$range:this._serialisedSheetName+this.$t$l}get count(){return(1+this.bottom-this.top)*(1+this.right-this.left)}toString(){return this.range}intersects(u){return(!u.sheetName||!this.sheetName||u.sheetName===this.sheetName)&&!(u.bottom<this.top)&&!(u.top>this.bottom)&&!(u.right<this.left)&&!(u.left>this.right)}contains(u){const l=o.decodeEx(u);return this.containsEx(l)}containsEx(u){return(!u.sheetName||!this.sheetName||u.sheetName===this.sheetName)&&u.row>=this.top&&u.row<=this.bottom&&u.col>=this.left&&u.col<=this.right}forEachAddress(u){for(let l=this.left;l<=this.right;l++)for(let d=this.top;d<=this.bottom;d++)u(o.encodeAddress(d,l),d,l)}}n.exports=i},{"../utils/col-cache":19}],11:[function(t,n,s){const o=t("../utils/under-dash"),i=t("./enums"),c=t("../utils/col-cache"),u=t("./cell");n.exports=class{constructor(l,d){this._worksheet=l,this._number=d,this._cells=[],this.style={},this.outlineLevel=0}get number(){return this._number}get worksheet(){return this._worksheet}commit(){this._worksheet._commitRow(this)}destroy(){delete this._worksheet,delete this._cells,delete this.style}findCell(l){return this._cells[l-1]}getCellEx(l){let d=this._cells[l.col-1];if(!d){const h=this._worksheet.getColumn(l.col);d=new u(this,h,l.address),this._cells[l.col-1]=d}return d}getCell(l){if(typeof l=="string"){const d=this._worksheet.getColumnKey(l);l=d?d.number:c.l2n(l)}return this._cells[l-1]||this.getCellEx({address:c.encodeAddress(this._number,l),row:this._number,col:l})}splice(l,d){const h=l+d;for(var f=arguments.length,p=new Array(f>2?f-2:0),v=2;v<f;v++)p[v-2]=arguments[v];const g=p.length-d,m=this._cells.length;let b,y,S;if(g<0)for(b=l+p.length;b<=m;b++)S=this._cells[b-1],y=this._cells[b-g-1],y?(S=this.getCell(b),S.value=y.value,S.style=y.style,S._comment=y._comment):S&&(S.value=null,S.style={},S._comment=void 0);else if(g>0)for(b=m;b>=h;b--)y=this._cells[b-1],y?(S=this.getCell(b+g),S.value=y.value,S.style=y.style,S._comment=y._comment):this._cells[b+g-1]=void 0;for(b=0;b<p.length;b++)S=this.getCell(l+b),S.value=p[b],S.style={},S._comment=void 0}eachCell(l,d){if(d||(d=l,l=null),l&&l.includeEmpty){const h=this._cells.length;for(let f=1;f<=h;f++)d(this.getCell(f),f)}else this._cells.forEach((h,f)=>{h&&h.type!==i.ValueType.Null&&d(h,f+1)})}addPageBreak(l,d){const h=this._worksheet,f=Math.max(0,l-1)||0,p=Math.max(0,d-1)||16838,v={id:this._number,max:p,man:1};f&&(v.min=f),h.rowBreaks.push(v)}get values(){const l=[];return this._cells.forEach(d=>{d&&d.type!==i.ValueType.Null&&(l[d.col]=d.value)}),l}set values(l){if(this._cells=[],l)if(l instanceof Array){let d=0;l.hasOwnProperty("0")&&(d=1),l.forEach((h,f)=>{h!==void 0&&(this.getCellEx({address:c.encodeAddress(this._number,f+d),row:this._number,col:f+d}).value=h)})}else this._worksheet.eachColumnKey((d,h)=>{l[h]!==void 0&&(this.getCellEx({address:c.encodeAddress(this._number,d.number),row:this._number,col:d.number}).value=l[h])})}get hasValues(){return o.some(this._cells,l=>l&&l.type!==i.ValueType.Null)}get cellCount(){return this._cells.length}get actualCellCount(){let l=0;return this.eachCell(()=>{l++}),l}get dimensions(){let l=0,d=0;return this._cells.forEach(h=>{h&&h.type!==i.ValueType.Null&&((!l||l>h.col)&&(l=h.col),d<h.col&&(d=h.col))}),l>0?{min:l,max:d}:null}_applyStyle(l,d){return this.style[l]=d,this._cells.forEach(h=>{h&&(h[l]=d)}),d}get numFmt(){return this.style.numFmt}set numFmt(l){this._applyStyle("numFmt",l)}get font(){return this.style.font}set font(l){this._applyStyle("font",l)}get alignment(){return this.style.alignment}set alignment(l){this._applyStyle("alignment",l)}get protection(){return this.style.protection}set protection(l){this._applyStyle("protection",l)}get border(){return this.style.border}set border(l){this._applyStyle("border",l)}get fill(){return this.style.fill}set fill(l){this._applyStyle("fill",l)}get hidden(){return!!this._hidden}set hidden(l){this._hidden=l}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(l){this._outlineLevel=l}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelRow)}get model(){const l=[];let d=0,h=0;return this._cells.forEach(f=>{if(f){const p=f.model;p&&((!d||d>f.col)&&(d=f.col),h<f.col&&(h=f.col),l.push(p))}}),this.height||l.length?{cells:l,number:this.number,min:d,max:h,height:this.height,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel,collapsed:this.collapsed}:null}set model(l){if(l.number!==this._number)throw new Error("Invalid row number in model");let d;this._cells=[],l.cells.forEach(h=>{switch(h.type){case u.Types.Merge:break;default:{let f;if(h.address)f=c.decodeAddress(h.address);else if(d){const{row:p}=d,v=d.col+1;f={row:p,col:v,address:c.encodeAddress(p,v),$col$row:`$${c.n2l(v)}$${p}`}}d=f,this.getCellEx(f).model=h;break}}}),l.height?this.height=l.height:delete this.height,this.hidden=l.hidden,this.outlineLevel=l.outlineLevel||0,this.style=l.style&&JSON.parse(JSON.stringify(l.style))||{}}}},{"../utils/col-cache":19,"../utils/under-dash":26,"./cell":3,"./enums":7}],12:[function(t,n,s){const o=t("../utils/col-cache");class i{constructor(u,l,d){this.table=u,this.column=l,this.index=d}_set(u,l){this.table.cacheState(),this.column[u]=l}get name(){return this.column.name}set name(u){this._set("name",u)}get filterButton(){return this.column.filterButton}set filterButton(u){this.column.filterButton=u}get style(){return this.column.style}set style(u){this.column.style=u}get totalsRowLabel(){return this.column.totalsRowLabel}set totalsRowLabel(u){this._set("totalsRowLabel",u)}get totalsRowFunction(){return this.column.totalsRowFunction}set totalsRowFunction(u){this._set("totalsRowFunction",u)}get totalsRowResult(){return this.column.totalsRowResult}set totalsRowResult(u){this._set("totalsRowResult",u)}get totalsRowFormula(){return this.column.totalsRowFormula}set totalsRowFormula(u){this._set("totalsRowFormula",u)}}n.exports=class{constructor(c,u){this.worksheet=c,u&&(this.table=u,this.validate(),this.store())}getFormula(c){switch(c.totalsRowFunction){case"none":return null;case"average":return`SUBTOTAL(101,${this.table.name}[${c.name}])`;case"countNums":return`SUBTOTAL(102,${this.table.name}[${c.name}])`;case"count":return`SUBTOTAL(103,${this.table.name}[${c.name}])`;case"max":return`SUBTOTAL(104,${this.table.name}[${c.name}])`;case"min":return`SUBTOTAL(105,${this.table.name}[${c.name}])`;case"stdDev":return`SUBTOTAL(106,${this.table.name}[${c.name}])`;case"var":return`SUBTOTAL(107,${this.table.name}[${c.name}])`;case"sum":return`SUBTOTAL(109,${this.table.name}[${c.name}])`;case"custom":return c.totalsRowFormula;default:throw new Error("Invalid Totals Row Function: "+c.totalsRowFunction)}}get width(){return this.table.columns.length}get height(){return this.table.rows.length}get filterHeight(){return this.height+(this.table.headerRow?1:0)}get tableHeight(){return this.filterHeight+(this.table.totalsRow?1:0)}validate(){const{table:c}=this,u=(g,m,b)=>{g[m]===void 0&&(g[m]=b)};u(c,"headerRow",!0),u(c,"totalsRow",!1),u(c,"style",{}),u(c.style,"theme","TableStyleMedium2"),u(c.style,"showFirstColumn",!1),u(c.style,"showLastColumn",!1),u(c.style,"showRowStripes",!1),u(c.style,"showColumnStripes",!1);const l=(g,m)=>{if(!g)throw new Error(m)};l(c.ref,"Table must have ref"),l(c.columns,"Table must have column definitions"),l(c.rows,"Table must have row definitions"),c.tl=o.decodeAddress(c.ref);const{row:d,col:h}=c.tl;l(d>0,"Table must be on valid row"),l(h>0,"Table must be on valid col");const{width:f,filterHeight:p,tableHeight:v}=this;c.autoFilterRef=o.encode(d,h,d+p-1,h+f-1),c.tableRef=o.encode(d,h,d+v-1,h+f-1),c.columns.forEach((g,m)=>{l(g.name,`Column ${m} must have a name`),m===0?u(g,"totalsRowLabel","Total"):(u(g,"totalsRowFunction","none"),g.totalsRowFormula=this.getFormula(g))})}store(){const c=(p,v)=>{v&&Object.keys(v).forEach(g=>{p[g]=v[g]})},{worksheet:u,table:l}=this,{row:d,col:h}=l.tl;let f=0;if(l.headerRow){const p=u.getRow(d+f++);l.columns.forEach((v,g)=>{const{style:m,name:b}=v,y=p.getCell(h+g);y.value=b,c(y,m)})}if(l.rows.forEach(p=>{const v=u.getRow(d+f++);p.forEach((g,m)=>{const b=v.getCell(h+m);b.value=g,c(b,l.columns[m].style)})}),l.totalsRow){const p=u.getRow(d+f++);l.columns.forEach((v,g)=>{const m=p.getCell(h+g);if(g===0)m.value=v.totalsRowLabel;else{const b=this.getFormula(v);m.value=b?{formula:v.totalsRowFormula,result:v.totalsRowResult}:null}c(m,v.style)})}}load(c){const{table:u}=this,{row:l,col:d}=u.tl;let h=0;if(u.headerRow){const f=c.getRow(l+h++);u.columns.forEach((p,v)=>{f.getCell(d+v).value=p.name})}if(u.rows.forEach(f=>{const p=c.getRow(l+h++);f.forEach((v,g)=>{p.getCell(d+g).value=v})}),u.totalsRow){const f=c.getRow(l+h++);u.columns.forEach((p,v)=>{const g=f.getCell(d+v);v===0?g.value=p.totalsRowLabel:this.getFormula(p)&&(g.value={formula:p.totalsRowFormula,result:p.totalsRowResult})})}}get model(){return this.table}set model(c){this.table=c}cacheState(){this._cache||(this._cache={ref:this.ref,width:this.width,tableHeight:this.tableHeight})}commit(){if(!this._cache)return;this.validate();const c=o.decodeAddress(this._cache.ref);if(this.ref!==this._cache.ref)for(let u=0;u<this._cache.tableHeight;u++){const l=this.worksheet.getRow(c.row+u);for(let d=0;d<this._cache.width;d++)l.getCell(c.col+d).value=null}else{for(let u=this.tableHeight;u<this._cache.tableHeight;u++){const l=this.worksheet.getRow(c.row+u);for(let d=0;d<this._cache.width;d++)l.getCell(c.col+d).value=null}for(let u=0;u<this.tableHeight;u++){const l=this.worksheet.getRow(c.row+u);for(let d=this.width;d<this._cache.width;d++)l.getCell(c.col+d).value=null}}this.store()}addRow(c,u){this.cacheState(),u===void 0?this.table.rows.push(c):this.table.rows.splice(u,0,c)}removeRows(c){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.rows.splice(c,u)}getColumn(c){const u=this.table.columns[c];return new i(this,u,c)}addColumn(c,u,l){this.cacheState(),l===void 0?(this.table.columns.push(c),this.table.rows.forEach((d,h)=>{d.push(u[h])})):(this.table.columns.splice(l,0,c),this.table.rows.forEach((d,h)=>{d.splice(l,0,u[h])}))}removeColumns(c){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.columns.splice(c,u),this.table.rows.forEach(l=>{l.splice(c,u)})}_assign(c,u,l){this.cacheState(),c[u]=l}get ref(){return this.table.ref}set ref(c){this._assign(this.table,"ref",c)}get name(){return this.table.name}set name(c){this.table.name=c}get displayName(){return this.table.displyName||this.table.name}set displayNamename(c){this.table.displayName=c}get headerRow(){return this.table.headerRow}set headerRow(c){this._assign(this.table,"headerRow",c)}get totalsRow(){return this.table.totalsRow}set totalsRow(c){this._assign(this.table,"totalsRow",c)}get theme(){return this.table.style.name}set theme(c){this.table.style.name=c}get showFirstColumn(){return this.table.style.showFirstColumn}set showFirstColumn(c){this.table.style.showFirstColumn=c}get showLastColumn(){return this.table.style.showLastColumn}set showLastColumn(c){this.table.style.showLastColumn=c}get showRowStripes(){return this.table.style.showRowStripes}set showRowStripes(c){this.table.style.showRowStripes=c}get showColumnStripes(){return this.table.style.showColumnStripes}set showColumnStripes(c){this.table.style.showColumnStripes=c}}},{"../utils/col-cache":19}],13:[function(t,n,s){const o=t("./worksheet"),i=t("./defined-names"),c=t("../xlsx/xlsx"),u=t("../csv/csv");n.exports=class{constructor(){this.category="",this.company="",this.created=new Date,this.description="",this.keywords="",this.manager="",this.modified=this.created,this.properties={},this.calcProperties={},this._worksheets=[],this.subject="",this.title="",this.views=[],this.media=[],this._definedNames=new i}get xlsx(){return this._xlsx||(this._xlsx=new c(this)),this._xlsx}get csv(){return this._csv||(this._csv=new u(this)),this._csv}get nextId(){for(let l=1;l<this._worksheets.length;l++)if(!this._worksheets[l])return l;return this._worksheets.length||1}addWorksheet(l,d){const h=this.nextId;d&&(typeof d=="string"?(console.trace('tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb: "rbg value" } }'),d={properties:{tabColor:{argb:d}}}):(d.argb||d.theme||d.indexed)&&(console.trace("tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }"),d={properties:{tabColor:d}}));const f=this._worksheets.reduce((g,m)=>(m&&m.orderNo)>g?m.orderNo:g,0),p=Object.assign({},d,{id:h,name:l,orderNo:f+1,workbook:this}),v=new o(p);return this._worksheets[h]=v,v}removeWorksheetEx(l){delete this._worksheets[l.id]}removeWorksheet(l){const d=this.getWorksheet(l);d&&d.destroy()}getWorksheet(l){return l===void 0?this._worksheets.find(Boolean):typeof l=="number"?this._worksheets[l]:typeof l=="string"?this._worksheets.find(d=>d&&d.name===l):void 0}get worksheets(){return this._worksheets.slice(1).sort((l,d)=>l.orderNo-d.orderNo).filter(Boolean)}eachSheet(l){this.worksheets.forEach(d=>{l(d,d.id)})}get definedNames(){return this._definedNames}clearThemes(){this._themes=void 0}addImage(l){const d=this.media.length;return this.media.push(Object.assign({},l,{type:"image"})),d}getImage(l){return this.media[l]}get model(){return{creator:this.creator||"Unknown",lastModifiedBy:this.lastModifiedBy||"Unknown",lastPrinted:this.lastPrinted,created:this.created,modified:this.modified,properties:this.properties,worksheets:this.worksheets.map(l=>l.model),sheets:this.worksheets.map(l=>l.model).filter(Boolean),definedNames:this._definedNames.model,views:this.views,company:this.company,manager:this.manager,title:this.title,subject:this.subject,keywords:this.keywords,category:this.category,description:this.description,language:this.language,revision:this.revision,contentStatus:this.contentStatus,themes:this._themes,media:this.media,calcProperties:this.calcProperties}}set model(l){this.creator=l.creator,this.lastModifiedBy=l.lastModifiedBy,this.lastPrinted=l.lastPrinted,this.created=l.created,this.modified=l.modified,this.company=l.company,this.manager=l.manager,this.title=l.title,this.subject=l.subject,this.keywords=l.keywords,this.category=l.category,this.description=l.description,this.language=l.language,this.revision=l.revision,this.contentStatus=l.contentStatus,this.properties=l.properties,this.calcProperties=l.calcProperties,this._worksheets=[],l.worksheets.forEach(d=>{const{id:h,name:f,state:p}=d,v=l.sheets&&l.sheets.findIndex(g=>g.id===h);(this._worksheets[h]=new o({id:h,name:f,orderNo:v,state:p,workbook:this})).model=d}),this._definedNames.model=l.definedNames,this.views=l.views,this._themes=l.themes,this.media=l.media||[]}}},{"../csv/csv":1,"../xlsx/xlsx":144,"./defined-names":6,"./worksheet":14}],14:[function(t,n,s){const o=t("../utils/under-dash"),i=t("../utils/col-cache"),c=t("./range"),u=t("./row"),l=t("./column"),d=t("./enums"),h=t("./image"),f=t("./table"),p=t("./data-validations"),v=t("../utils/encryptor"),{copyStyle:g}=t("../utils/copy-style");n.exports=class{constructor(m){m=m||{},this._workbook=m.workbook,this.id=m.id,this.orderNo=m.orderNo,this.name=m.name,this.state=m.state||"visible",this._rows=[],this._columns=null,this._keys={},this._merges={},this.rowBreaks=[],this.properties=Object.assign({},{defaultRowHeight:15,dyDescent:55,outlineLevelCol:0,outlineLevelRow:0},m.properties),this.pageSetup=Object.assign({},{margins:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3},orientation:"portrait",horizontalDpi:4294967295,verticalDpi:4294967295,fitToPage:!(!m.pageSetup||!m.pageSetup.fitToWidth&&!m.pageSetup.fitToHeight||m.pageSetup.scale),pageOrder:"downThenOver",blackAndWhite:!1,draft:!1,cellComments:"None",errors:"displayed",scale:100,fitToWidth:1,fitToHeight:1,paperSize:void 0,showRowColHeaders:!1,showGridLines:!1,firstPageNumber:void 0,horizontalCentered:!1,verticalCentered:!1,rowBreaks:null,colBreaks:null},m.pageSetup),this.headerFooter=Object.assign({},{differentFirst:!1,differentOddEven:!1,oddHeader:null,oddFooter:null,evenHeader:null,evenFooter:null,firstHeader:null,firstFooter:null},m.headerFooter),this.dataValidations=new p,this.views=m.views||[],this.autoFilter=m.autoFilter||null,this._media=[],this.sheetProtection=null,this.tables={},this.conditionalFormattings=[]}get name(){return this._name}set name(m){if(m===void 0&&(m="sheet"+this.id),this._name!==m){if(typeof m!="string")throw new Error("The name has to be a string.");if(m==="")throw new Error("The name can't be empty.");if(m==="History")throw new Error('The name "History" is protected. Please use a different name.');if(/[*?:/\\[\]]/.test(m))throw new Error(`Worksheet name ${m} cannot include any of the following characters: * ? : \\ / [ ]`);if(/(^')|('$)/.test(m))throw new Error("The first or last character of worksheet name cannot be a single quotation mark: "+m);if(m&&m.length>31&&(console.warn(`Worksheet name ${m} exceeds 31 chars. This will be truncated`),m=m.substring(0,31)),this._workbook._worksheets.find(b=>b&&b.name.toLowerCase()===m.toLowerCase()))throw new Error("Worksheet name already exists: "+m);this._name=m}}get workbook(){return this._workbook}destroy(){this._workbook.removeWorksheetEx(this)}get dimensions(){const m=new c;return this._rows.forEach(b=>{if(b){const y=b.dimensions;y&&m.expand(b.number,y.min,b.number,y.max)}}),m}get columns(){return this._columns}set columns(m){this._headerRowCount=m.reduce((S,C)=>{const L=(C.header?1:C.headers&&C.headers.length)||0;return Math.max(S,L)},0);let b=1;const y=this._columns=[];m.forEach(S=>{const C=new l(this,b++,!1);y.push(C),C.defn=S})}getColumnKey(m){return this._keys[m]}setColumnKey(m,b){this._keys[m]=b}deleteColumnKey(m){delete this._keys[m]}eachColumnKey(m){o.each(this._keys,m)}getColumn(m){if(typeof m=="string"){const b=this._keys[m];if(b)return b;m=i.l2n(m)}if(this._columns||(this._columns=[]),m>this._columns.length){let b=this._columns.length+1;for(;b<=m;)this._columns.push(new l(this,b++))}return this._columns[m-1]}spliceColumns(m,b){const y=this._rows.length;for(var S=arguments.length,C=new Array(S>2?S-2:0),L=2;L<S;L++)C[L-2]=arguments[L];if(C.length>0)for(let q=0;q<y;q++){const D=[m,b];C.forEach(P=>{D.push(P[q]||null)});const W=this.getRow(q+1);W.splice.apply(W,D)}else this._rows.forEach(q=>{q&&q.splice(m,b)});const O=C.length-b,H=m+b,z=this._columns.length;if(O<0)for(let q=m+C.length;q<=z;q++)this.getColumn(q).defn=this.getColumn(q-O).defn;else if(O>0)for(let q=z;q>=H;q--)this.getColumn(q+O).defn=this.getColumn(q).defn;for(let q=m;q<m+C.length;q++)this.getColumn(q).defn=null;this.workbook.definedNames.spliceColumns(this.name,m,b,C.length)}get lastColumn(){return this.getColumn(this.columnCount)}get columnCount(){let m=0;return this.eachRow(b=>{m=Math.max(m,b.cellCount)}),m}get actualColumnCount(){const m=[];let b=0;return this.eachRow(y=>{y.eachCell(S=>{let{col:C}=S;m[C]||(m[C]=!0,b++)})}),b}_commitRow(){}get _lastRowNumber(){const m=this._rows;let b=m.length;for(;b>0&&m[b-1]===void 0;)b--;return b}get _nextRow(){return this._lastRowNumber+1}get lastRow(){if(this._rows.length)return this._rows[this._rows.length-1]}findRow(m){return this._rows[m-1]}findRows(m,b){return this._rows.slice(m-1,m-1+b)}get rowCount(){return this._lastRowNumber}get actualRowCount(){let m=0;return this.eachRow(()=>{m++}),m}getRow(m){let b=this._rows[m-1];return b||(b=this._rows[m-1]=new u(this,m)),b}getRows(m,b){if(b<1)return;const y=[];for(let S=m;S<m+b;S++)y.push(this.getRow(S));return y}addRow(m){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const y=this._nextRow,S=this.getRow(y);return S.values=m,this._setStyleOption(y,b[0]==="i"?b:"n"),S}addRows(m){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const y=[];return m.forEach(S=>{y.push(this.addRow(S,b))}),y}insertRow(m,b){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";return this.spliceRows(m,0,b),this._setStyleOption(m,y),this.getRow(m)}insertRows(m,b){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";if(this.spliceRows(m,0,...b),y!=="n")for(let S=0;S<b.length;S++)y[0]==="o"&&this.findRow(b.length+m+S)!==void 0?this._copyStyle(b.length+m+S,m+S,y[1]==="+"):y[0]==="i"&&this.findRow(m-1)!==void 0&&this._copyStyle(m-1,m+S,y[1]==="+");return this.getRows(m,b.length)}_setStyleOption(m){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";b[0]==="o"&&this.findRow(m+1)!==void 0?this._copyStyle(m+1,m,b[1]==="+"):b[0]==="i"&&this.findRow(m-1)!==void 0&&this._copyStyle(m-1,m,b[1]==="+")}_copyStyle(m,b){let y=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const S=this.getRow(m),C=this.getRow(b);C.style=g(S.style),S.eachCell({includeEmpty:y},(L,O)=>{C.getCell(O).style=g(L.style)}),C.height=S.height}duplicateRow(m,b){let y=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const S=this._rows[m-1],C=new Array(b).fill(S.values);this.spliceRows(m+1,y?0:b,...C);for(let L=0;L<b;L++){const O=this._rows[m+L];O.style=S.style,O.height=S.height,S.eachCell({includeEmpty:!0},(H,z)=>{O.getCell(z).style=H.style})}}spliceRows(m,b){const y=m+b;for(var S=arguments.length,C=new Array(S>2?S-2:0),L=2;L<S;L++)C[L-2]=arguments[L];const O=C.length,H=O-b,z=this._rows.length;let q,D;if(H<0)for(m===z&&(this._rows[z-1]=void 0),q=y;q<=z;q++)if(D=this._rows[q-1],D){const W=this.getRow(q+H);W.values=D.values,W.style=D.style,W.height=D.height,D.eachCell({includeEmpty:!0},(P,I)=>{W.getCell(I).style=P.style}),this._rows[q-1]=void 0}else this._rows[q+H-1]=void 0;else if(H>0)for(q=z;q>=y;q--)if(D=this._rows[q-1],D){const W=this.getRow(q+H);W.values=D.values,W.style=D.style,W.height=D.height,D.eachCell({includeEmpty:!0},(P,I)=>{if(W.getCell(I).style=P.style,P._value.constructor.name==="MergeValue"){const U=this.getRow(P._row._number+O).getCell(I),k=P._value._master,_=this.getRow(k._row._number+O).getCell(k._column._number);U.merge(_)}})}else this._rows[q+H-1]=void 0;for(q=0;q<O;q++){const W=this.getRow(m+q);W.style={},W.values=C[q]}this.workbook.definedNames.spliceRows(this.name,m,b,O)}eachRow(m,b){if(b||(b=m,m=void 0),m&&m.includeEmpty){const y=this._rows.length;for(let S=1;S<=y;S++)b(this.getRow(S),S)}else this._rows.forEach(y=>{y&&y.hasValues&&b(y,y.number)})}getSheetValues(){const m=[];return this._rows.forEach(b=>{b&&(m[b.number]=b.values)}),m}findCell(m,b){const y=i.getAddress(m,b),S=this._rows[y.row-1];return S?S.findCell(y.col):void 0}getCell(m,b){const y=i.getAddress(m,b);return this.getRow(y.row).getCellEx(y)}mergeCells(){for(var m=arguments.length,b=new Array(m),y=0;y<m;y++)b[y]=arguments[y];const S=new c(b);this._mergeCellsInternal(S)}mergeCellsWithoutStyle(){for(var m=arguments.length,b=new Array(m),y=0;y<m;y++)b[y]=arguments[y];const S=new c(b);this._mergeCellsInternal(S,!0)}_mergeCellsInternal(m,b){o.each(this._merges,S=>{if(S.intersects(m))throw new Error("Cannot merge already merged cells")});const y=this.getCell(m.top,m.left);for(let S=m.top;S<=m.bottom;S++)for(let C=m.left;C<=m.right;C++)(S>m.top||C>m.left)&&this.getCell(S,C).merge(y,b);this._merges[y.address]=m}_unMergeMaster(m){const b=this._merges[m.address];if(b){for(let y=b.top;y<=b.bottom;y++)for(let S=b.left;S<=b.right;S++)this.getCell(y,S).unmerge();delete this._merges[m.address]}}get hasMerges(){return o.some(this._merges,Boolean)}unMergeCells(){for(var m=arguments.length,b=new Array(m),y=0;y<m;y++)b[y]=arguments[y];const S=new c(b);for(let C=S.top;C<=S.bottom;C++)for(let L=S.left;L<=S.right;L++){const O=this.findCell(C,L);O&&(O.type===d.ValueType.Merge?this._unMergeMaster(O.master):this._merges[O.address]&&this._unMergeMaster(O))}}fillFormula(m,b,y){let S=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"shared";const C=i.decode(m),{top:L,left:O,bottom:H,right:z}=C,q=z-O+1,D=i.encodeAddress(L,O),W=S==="shared";let P;P=typeof y=="function"?y:Array.isArray(y)?Array.isArray(y[0])?(U,k)=>y[U-L][k-O]:(U,k)=>y[(U-L)*q+(k-O)]:()=>{};let I=!0;for(let U=L;U<=H;U++)for(let k=O;k<=z;k++)I?(this.getCell(U,k).value={shareType:S,formula:b,ref:m,result:P(U,k)},I=!1):this.getCell(U,k).value=W?{sharedFormula:D,result:P(U,k)}:P(U,k)}addImage(m,b){const y={type:"image",imageId:m,range:b};this._media.push(new h(this,y))}getImages(){return this._media.filter(m=>m.type==="image")}addBackgroundImage(m){const b={type:"background",imageId:m};this._media.push(new h(this,b))}getBackgroundImageId(){const m=this._media.find(b=>b.type==="background");return m&&m.imageId}protect(m,b){return new Promise(y=>{this.sheetProtection={sheet:!0},b&&"spinCount"in b&&(b.spinCount=Number.isFinite(b.spinCount)?Math.round(Math.max(0,b.spinCount)):1e5),m&&(this.sheetProtection.algorithmName="SHA-512",this.sheetProtection.saltValue=v.randomBytes(16).toString("base64"),this.sheetProtection.spinCount=b&&"spinCount"in b?b.spinCount:1e5,this.sheetProtection.hashValue=v.convertPasswordToHash(m,"SHA512",this.sheetProtection.saltValue,this.sheetProtection.spinCount)),b&&(this.sheetProtection=Object.assign(this.sheetProtection,b),!m&&"spinCount"in b&&delete this.sheetProtection.spinCount),y()})}unprotect(){this.sheetProtection=null}addTable(m){const b=new f(this,m);return this.tables[m.name]=b,b}getTable(m){return this.tables[m]}removeTable(m){delete this.tables[m]}getTables(){return Object.values(this.tables)}addConditionalFormatting(m){this.conditionalFormattings.push(m)}removeConditionalFormatting(m){typeof m=="number"?this.conditionalFormattings.splice(m,1):this.conditionalFormattings=m instanceof Function?this.conditionalFormattings.filter(m):[]}get tabColor(){return console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor}set tabColor(m){console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor=m}get model(){const m={id:this.id,name:this.name,dataValidations:this.dataValidations.model,properties:this.properties,state:this.state,pageSetup:this.pageSetup,headerFooter:this.headerFooter,rowBreaks:this.rowBreaks,views:this.views,autoFilter:this.autoFilter,media:this._media.map(S=>S.model),sheetProtection:this.sheetProtection,tables:Object.values(this.tables).map(S=>S.model),conditionalFormattings:this.conditionalFormattings};m.cols=l.toModel(this.columns);const b=m.rows=[],y=m.dimensions=new c;return this._rows.forEach(S=>{const C=S&&S.model;C&&(y.expand(C.number,C.min,C.number,C.max),b.push(C))}),m.merges=[],o.each(this._merges,S=>{m.merges.push(S.range)}),m}_parseRows(m){this._rows=[],m.rows.forEach(b=>{const y=new u(this,b.number);this._rows[y.number-1]=y,y.model=b})}_parseMergeCells(m){o.each(m.mergeCells,b=>{this.mergeCellsWithoutStyle(b)})}set model(m){this.name=m.name,this._columns=l.fromModel(this,m.cols),this._parseRows(m),this._parseMergeCells(m),this.dataValidations=new p(m.dataValidations),this.properties=m.properties,this.pageSetup=m.pageSetup,this.headerFooter=m.headerFooter,this.views=m.views,this.autoFilter=m.autoFilter,this._media=m.media.map(b=>new h(this,b)),this.sheetProtection=m.sheetProtection,this.tables=m.tables.reduce((b,y)=>{const S=new f;return S.model=y,b[y.name]=S,b},{}),this.conditionalFormattings=m.conditionalFormattings}}},{"../utils/col-cache":19,"../utils/copy-style":20,"../utils/encryptor":21,"../utils/under-dash":26,"./column":4,"./data-validations":5,"./enums":7,"./image":8,"./range":10,"./row":11,"./table":12}],15:[function(t,n,s){t("core-js/modules/es.promise"),t("core-js/modules/es.promise.finally"),t("core-js/modules/es.object.assign"),t("core-js/modules/es.object.keys"),t("core-js/modules/es.object.values"),t("core-js/modules/es.symbol"),t("core-js/modules/es.symbol.async-iterator"),t("core-js/modules/es.array.iterator"),t("core-js/modules/es.array.includes"),t("core-js/modules/es.array.find-index"),t("core-js/modules/es.array.find"),t("core-js/modules/es.string.from-code-point"),t("core-js/modules/es.string.includes"),t("core-js/modules/es.number.is-nan"),t("regenerator-runtime/runtime");const o={Workbook:t("./doc/workbook")},i=t("./doc/enums");Object.keys(i).forEach(c=>{o[c]=i[c]}),n.exports=o},{"./doc/enums":7,"./doc/workbook":13,"core-js/modules/es.array.find":359,"core-js/modules/es.array.find-index":358,"core-js/modules/es.array.includes":360,"core-js/modules/es.array.iterator":361,"core-js/modules/es.number.is-nan":363,"core-js/modules/es.object.assign":364,"core-js/modules/es.object.keys":366,"core-js/modules/es.object.values":367,"core-js/modules/es.promise":372,"core-js/modules/es.promise.finally":371,"core-js/modules/es.string.from-code-point":376,"core-js/modules/es.string.includes":377,"core-js/modules/es.symbol":381,"core-js/modules/es.symbol.async-iterator":378,"regenerator-runtime/runtime":492}],16:[function(t,n,s){const o=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");s.bufferToString=function(i){return typeof i=="string"?i:o?o.decode(i):i.toString()}},{}],17:[function(t,n,s){const o=typeof TextEncoder>"u"?null:new TextEncoder("utf-8"),{Buffer:i}=t("buffer");s.stringToBuffer=function(c){return typeof c!="string"?c:o?i.from(o.encode(c).buffer):i.from(c)}},{buffer:220}],18:[function(t,n,s){const o=t("./under-dash"),i=t("./col-cache");n.exports=class{constructor(c){this.template=c,this.sheets={}}addCell(c){this.addCellEx(i.decodeEx(c))}getCell(c){return this.findCellEx(i.decodeEx(c),!0)}findCell(c){return this.findCellEx(i.decodeEx(c),!1)}findCellAt(c,u,l){const d=this.sheets[c],h=d&&d[u];return h&&h[l]}addCellEx(c){if(c.top)for(let u=c.top;u<=c.bottom;u++)for(let l=c.left;l<=c.right;l++)this.getCellAt(c.sheetName,u,l);else this.findCellEx(c,!0)}getCellEx(c){return this.findCellEx(c,!0)}findCellEx(c,u){const l=this.findSheet(c,u),d=this.findSheetRow(l,c,u);return this.findRowCell(d,c,u)}getCellAt(c,u,l){const d=this.sheets[c]||(this.sheets[c]=[]),h=d[u]||(d[u]=[]);return h[l]||(h[l]={sheetName:c,address:i.n2l(l)+u,row:u,col:l})}removeCellEx(c){const u=this.findSheet(c);if(!u)return;const l=this.findSheetRow(u,c);l&&delete l[c.col]}forEachInSheet(c,u){const l=this.sheets[c];l&&l.forEach((d,h)=>{d&&d.forEach((f,p)=>{f&&u(f,h,p)})})}forEach(c){o.each(this.sheets,(u,l)=>{this.forEachInSheet(l,c)})}map(c){const u=[];return this.forEach(l=>{u.push(c(l))}),u}findSheet(c,u){const l=c.sheetName;return this.sheets[l]?this.sheets[l]:u?this.sheets[l]=[]:void 0}findSheetRow(c,u,l){const{row:d}=u;return c&&c[d]?c[d]:l?c[d]=[]:void 0}findRowCell(c,u,l){const{col:d}=u;return c&&c[d]?c[d]:l?c[d]=this.template?Object.assign(u,JSON.parse(JSON.stringify(this.template))):u:void 0}spliceRows(c,u,l,d){const h=this.sheets[c];if(h){const f=[];for(let p=0;p<d;p++)f.push([]);h.splice(u,l,...f)}}spliceColumns(c,u,l,d){const h=this.sheets[c];if(h){const f=[];for(let p=0;p<d;p++)f.push(null);o.each(h,p=>{p.splice(u,l,...f)})}}}},{"./col-cache":19,"./under-dash":26}],19:[function(t,n,s){const o=/^[A-Z]+\d+$/,i={_dictionary:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],_l2nFill:0,_l2n:{},_n2l:[],_level:c=>c<=26?1:c<=676?2:3,_fill(c){let u,l,d,h,f,p=1;if(c>=4)throw new Error("Out of bounds. Excel supports columns from 1 to 16384");if(this._l2nFill<1&&c>=1){for(;p<=26;)u=this._dictionary[p-1],this._n2l[p]=u,this._l2n[u]=p,p++;this._l2nFill=1}if(this._l2nFill<2&&c>=2){for(p=27;p<=702;)l=p-27,d=l%26,h=Math.floor(l/26),u=this._dictionary[h]+this._dictionary[d],this._n2l[p]=u,this._l2n[u]=p,p++;this._l2nFill=2}if(this._l2nFill<3&&c>=3){for(p=703;p<=16384;)l=p-703,d=l%26,h=Math.floor(l/26)%26,f=Math.floor(l/676),u=this._dictionary[f]+this._dictionary[h]+this._dictionary[d],this._n2l[p]=u,this._l2n[u]=p,p++;this._l2nFill=3}},l2n(c){if(this._l2n[c]||this._fill(c.length),!this._l2n[c])throw new Error("Out of bounds. Invalid column letter: "+c);return this._l2n[c]},n2l(c){if(c<1||c>16384)throw new Error(c+" is out of bounds. Excel supports columns from 1 to 16384");return this._n2l[c]||this._fill(this._level(c)),this._n2l[c]},_hash:{},validateAddress(c){if(!o.test(c))throw new Error("Invalid Address: "+c);return!0},decodeAddress(c){const u=c.length<5&&this._hash[c];if(u)return u;let l=!1,d="",h=0,f=!1,p="",v=0;for(let m,b=0;b<c.length;b++)if(m=c.charCodeAt(b),!f&&m>=65&&m<=90)l=!0,d+=c[b],h=26*h+m-64;else if(m>=48&&m<=57)f=!0,p+=c[b],v=10*v+m-48;else if(f&&l&&m!==36)break;if(l){if(h>16384)throw new Error("Out of bounds. Invalid column letter: "+d)}else h=void 0;f||(v=void 0);const g={address:c=d+p,col:h,row:v,$col$row:`$${d}$${p}`};return h<=100&&v<=100&&(this._hash[c]=g,this._hash[g.$col$row]=g),g},getAddress(c,u){if(u){const l=this.n2l(u)+c;return this.decodeAddress(l)}return this.decodeAddress(c)},decode(c){const u=c.split(":");if(u.length===2){const l=this.decodeAddress(u[0]),d=this.decodeAddress(u[1]),h={top:Math.min(l.row,d.row),left:Math.min(l.col,d.col),bottom:Math.max(l.row,d.row),right:Math.max(l.col,d.col)};return h.tl=this.n2l(h.left)+h.top,h.br=this.n2l(h.right)+h.bottom,h.dimensions=`${h.tl}:${h.br}`,h}return this.decodeAddress(c)},decodeEx(c){const u=c.match(/(?:(?:(?:'((?:[^']|'')*)')|([^'^ !]*))!)?(.*)/),l=u[1]||u[2],d=u[3],h=d.split(":");if(h.length>1){let p=this.decodeAddress(h[0]),v=this.decodeAddress(h[1]);const g=Math.min(p.row,v.row),m=Math.min(p.col,v.col),b=Math.max(p.row,v.row),y=Math.max(p.col,v.col);return p=this.n2l(m)+g,v=this.n2l(y)+b,{top:g,left:m,bottom:b,right:y,sheetName:l,tl:{address:p,col:m,row:g,$col$row:`$${this.n2l(m)}$${g}`,sheetName:l},br:{address:v,col:y,row:b,$col$row:`$${this.n2l(y)}$${b}`,sheetName:l},dimensions:`${p}:${v}`}}if(d.startsWith("#"))return l?{sheetName:l,error:d}:{error:d};const f=this.decodeAddress(d);return l?{sheetName:l,...f}:f},encodeAddress:(c,u)=>i.n2l(u)+c,encode(){switch(arguments.length){case 2:return i.encodeAddress(arguments[0],arguments[1]);case 4:return`${i.encodeAddress(arguments[0],arguments[1])}:${i.encodeAddress(arguments[2],arguments[3])}`;default:throw new Error("Can only encode with 2 or 4 arguments")}},inRange(c,u){const[l,d,,h,f]=c,[p,v]=u;return p>=l&&p<=h&&v>=d&&v<=f}};n.exports=i},{}],20:[function(t,n,s){const o=(c,u)=>({...c,...u.reduce((l,d)=>(c[d]&&(l[d]={...c[d]}),l),{})}),i=function(c,u,l){let d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];c[l]&&(u[l]=o(c[l],d))};s.copyStyle=c=>{if(!c)return c;if(u=c,Object.keys(u).length===0)return{};var u;const l={...c};return i(c,l,"font",["color"]),i(c,l,"alignment"),i(c,l,"protection"),c.border&&(i(c,l,"border"),i(c.border,l.border,"top",["color"]),i(c.border,l.border,"left",["color"]),i(c.border,l.border,"bottom",["color"]),i(c.border,l.border,"right",["color"]),i(c.border,l.border,"diagonal",["color"])),c.fill&&(i(c,l,"fill",["fgColor","bgColor","center"]),c.fill.stops&&(l.fill.stops=c.fill.stops.map(d=>o(d,["color"])))),l}},{}],21:[function(t,n,s){(function(o){(function(){const i=t("crypto"),c={hash(u){const l=i.createHash(u);for(var d=arguments.length,h=new Array(d>1?d-1:0),f=1;f<d;f++)h[f-1]=arguments[f];return l.update(o.concat(h)),l.digest()},convertPasswordToHash(u,l,d,h){if(l=l.toLowerCase(),i.getHashes().indexOf(l)<0)throw new Error(`Hash algorithm '${l}' not supported!`);const f=o.from(u,"utf16le");let p=this.hash(l,o.from(d,"base64"),f);for(let v=0;v<h;v++){const g=o.alloc(4);g.writeUInt32LE(v,0),p=this.hash(l,p,g)}return p.toString("base64")},randomBytes:u=>i.randomBytes(u)};n.exports=c}).call(this)}).call(this,t("buffer").Buffer)},{buffer:220,crypto:390}],22:[function(t,n,s){const{SaxesParser:o}=t("saxes"),{PassThrough:i}=t("readable-stream"),{bufferToString:c}=t("./browser-buffer-decode");n.exports=async function*(u){u.pipe&&!u[Symbol.asyncIterator]&&(u=u.pipe(new i));const l=new o;let d;l.on("error",f=>{d=f});let h=[];l.on("opentag",f=>h.push({eventType:"opentag",value:f})),l.on("text",f=>h.push({eventType:"text",value:f})),l.on("closetag",f=>h.push({eventType:"closetag",value:f}));for await(const f of u){if(l.write(c(f)),d)throw d;yield h,h=[]}}},{"./browser-buffer-decode":16,"readable-stream":491,saxes:496}],23:[function(t,n,s){const o=t("./col-cache"),i=/(([a-z_\-0-9]*)!)?([a-z0-9_$]{2,})([(])?/gi,c=/^([$])?([a-z]+)([$])?([1-9][0-9]*)$/i;n.exports={slideFormula:function(u,l,d){const h=o.decode(l),f=o.decode(d);return u.replace(i,(p,v,g,m,b)=>{if(b)return p;const y=c.exec(m);if(y){const S=y[1],C=y[2].toUpperCase(),L=y[3],O=y[4];if(C.length>3||C.length===3&&C>"XFD")return p;let H=o.l2n(C),z=parseInt(O,10);return S||(H+=f.col-h.col),L||(z+=f.row-h.row),(v||"")+(S||"")+o.n2l(H)+(L||"")+z}return p})}}},{"./col-cache":19}],24:[function(t,n,s){(function(o,i){(function(){const c=t("readable-stream"),u=t("./utils"),l=t("./string-buf");class d{constructor(m,b){this._data=m,this._encoding=b}get length(){return this.toBuffer().length}copy(m,b,y,S){return this.toBuffer().copy(m,b,y,S)}toBuffer(){return this._buffer||(this._buffer=i.from(this._data,this._encoding)),this._buffer}}class h{constructor(m){this._data=m}get length(){return this._data.length}copy(m,b,y,S){return this._data._buf.copy(m,b,y,S)}toBuffer(){return this._data.toBuffer()}}class f{constructor(m){this._data=m}get length(){return this._data.length}copy(m,b,y,S){this._data.copy(m,b,y,S)}toBuffer(){return this._data}}class p{constructor(m){this.size=m,this.buffer=i.alloc(m),this.iRead=0,this.iWrite=0}toBuffer(){if(this.iRead===0&&this.iWrite===this.size)return this.buffer;const m=i.alloc(this.iWrite-this.iRead);return this.buffer.copy(m,0,this.iRead,this.iWrite),m}get length(){return this.iWrite-this.iRead}get eod(){return this.iRead===this.iWrite}get full(){return this.iWrite===this.size}read(m){let b;return m===0?null:m===void 0||m>=this.length?(b=this.toBuffer(),this.iRead=this.iWrite,b):(b=i.alloc(m),this.buffer.copy(b,0,this.iRead,m),this.iRead+=m,b)}write(m,b,y){const S=Math.min(y,this.size-this.iWrite);return m.copy(this.buffer,this.iWrite,b,b+S),this.iWrite+=S,S}}const v=function(g){g=g||{},this.bufSize=g.bufSize||1048576,this.buffers=[],this.batch=g.batch||!1,this.corked=!1,this.inPos=0,this.outPos=0,this.pipes=[],this.paused=!1,this.encoding=null};u.inherits(v,c.Duplex,{toBuffer(){switch(this.buffers.length){case 0:return null;case 1:return this.buffers[0].toBuffer();default:return i.concat(this.buffers.map(g=>g.toBuffer()))}},_getWritableBuffer(){if(this.buffers.length){const m=this.buffers[this.buffers.length-1];if(!m.full)return m}const g=new p(this.bufSize);return this.buffers.push(g),g},async _pipe(g){await Promise.all(this.pipes.map(function(m){return new Promise(b=>{m.write(g.toBuffer(),()=>{b()})})}))},_writeToBuffers(g){let m=0;const b=g.length;for(;m<b;)m+=this._getWritableBuffer().write(g,m,b-m)},async write(g,m,b){let y;if(m instanceof Function&&(b=m,m="utf8"),b=b||u.nop,g instanceof l)y=new h(g);else if(g instanceof i)y=new f(g);else{if(!(typeof g=="string"||g instanceof String||g instanceof ArrayBuffer))throw new Error("Chunk must be one of type String, Buffer or StringBuf.");y=new d(g,m)}if(this.pipes.length)if(this.batch)for(this._writeToBuffers(y);!this.corked&&this.buffers.length>1;)this._pipe(this.buffers.shift());else this.corked?(this._writeToBuffers(y),o.nextTick(b)):(await this._pipe(y),b());else this.paused||this.emit("data",y.toBuffer()),this._writeToBuffers(y),this.emit("readable");return!0},cork(){this.corked=!0},_flush(){if(this.pipes.length)for(;this.buffers.length;)this._pipe(this.buffers.shift())},uncork(){this.corked=!1,this._flush()},end(g,m,b){const y=S=>{S?b(S):(this._flush(),this.pipes.forEach(C=>{C.end()}),this.emit("finish"))};g?this.write(g,m,y):y()},read(g){let m;if(g){for(m=[];g&&this.buffers.length&&!this.buffers[0].eod;){const b=this.buffers[0],y=b.read(g);g-=y.length,m.push(y),b.eod&&b.full&&this.buffers.shift()}return i.concat(m)}return m=this.buffers.map(b=>b.toBuffer()).filter(Boolean),this.buffers=[],i.concat(m)},setEncoding(g){this.encoding=g},pause(){this.paused=!0},resume(){this.paused=!1},isPaused(){return!!this.paused},pipe(g){this.pipes.push(g),!this.paused&&this.buffers.length&&this.end()},unpipe(g){this.pipes=this.pipes.filter(m=>m!==g)},unshift(){throw new Error("Not Implemented")},wrap(){throw new Error("Not Implemented")}}),n.exports=v}).call(this)}).call(this,t("_process"),t("buffer").Buffer)},{"./string-buf":25,"./utils":27,_process:467,buffer:220,"readable-stream":491}],25:[function(t,n,s){(function(o){(function(){n.exports=class{constructor(i){this._buf=o.alloc(i&&i.size||16384),this._encoding=i&&i.encoding||"utf8",this._inPos=0,this._buffer=void 0}get length(){return this._inPos}get capacity(){return this._buf.length}get buffer(){return this._buf}toBuffer(){return this._buffer||(this._buffer=o.alloc(this.length),this._buf.copy(this._buffer,0,0,this.length)),this._buffer}reset(i){i=i||0,this._buffer=void 0,this._inPos=i}_grow(i){let c=2*this._buf.length;for(;c<i;)c*=2;const u=o.alloc(c);this._buf.copy(u,0),this._buf=u}addText(i){this._buffer=void 0;let c=this._inPos+this._buf.write(i,this._inPos,this._encoding);for(;c>=this._buf.length-4;)this._grow(this._inPos+i.length),c=this._inPos+this._buf.write(i,this._inPos,this._encoding);this._inPos=c}addStringBuf(i){i.length&&(this._buffer=void 0,this.length+i.length>this.capacity&&this._grow(this.length+i.length),i._buf.copy(this._buf,this._inPos,0,i.length),this._inPos+=i.length)}}}).call(this)}).call(this,t("buffer").Buffer)},{buffer:220}],26:[function(t,n,s){const{toString:o}=Object.prototype,i=/["&<>]/,c={each:function(u,l){u&&(Array.isArray(u)?u.forEach(l):Object.keys(u).forEach(d=>{l(u[d],d)}))},some:function(u,l){return!!u&&(Array.isArray(u)?u.some(l):Object.keys(u).some(d=>l(u[d],d)))},every:function(u,l){return!u||(Array.isArray(u)?u.every(l):Object.keys(u).every(d=>l(u[d],d)))},map:function(u,l){return u?Array.isArray(u)?u.map(l):Object.keys(u).map(d=>l(u[d],d)):[]},keyBy:(u,l)=>u.reduce((d,h)=>(d[h[l]]=h,d),{}),isEqual:function(u,l){const d=typeof u,h=typeof l,f=Array.isArray(u),p=Array.isArray(l);let v;if(d!==h)return!1;switch(typeof u){case"object":if(f||p)return!(!f||!p)&&u.length===l.length&&u.every((g,m)=>{const b=l[m];return c.isEqual(g,b)});if(u===null||l===null)return u===l;if(v=Object.keys(u),Object.keys(l).length!==v.length)return!1;for(const g of v)if(!l.hasOwnProperty(g))return!1;return c.every(u,(g,m)=>{const b=l[m];return c.isEqual(g,b)});default:return u===l}},escapeHtml(u){const l=i.exec(u);if(!l)return u;let d="",h="",f=0,p=l.index;for(;p<u.length;p++){switch(u.charAt(p)){case'"':h="&quot;";break;case"&":h="&amp;";break;case"'":h="&apos;";break;case"<":h="&lt;";break;case">":h="&gt;";break;default:continue}f!==p&&(d+=u.substring(f,p)),f=p+1,d+=h}return f!==p?d+u.substring(f,p):d},strcmp:(u,l)=>u<l?-1:u>l?1:0,isUndefined:u=>o.call(u)==="[object Undefined]",isObject:u=>o.call(u)==="[object Object]",deepMerge(){const u=arguments[0]||{},{length:l}=arguments;let d,h,f;function p(v,g){d=u[g],f=Array.isArray(v),c.isObject(v)||f?(f?(f=!1,h=d&&Array.isArray(d)?d:[]):h=d&&c.isObject(d)?d:{},u[g]=c.deepMerge(h,v)):c.isUndefined(v)||(u[g]=v)}for(let v=0;v<l;v++)c.each(arguments[v],p);return u}};n.exports=c},{}],27:[function(t,n,s){(function(o,i){(function(){const c=t("fs"),u=/[<>&'"\x7F\x00-\x08\x0B-\x0C\x0E-\x1F]/,l={nop(){},promiseImmediate:d=>new Promise(h=>{o.setImmediate?i(()=>{h(d)}):setTimeout(()=>{h(d)},1)}),inherits:function(d,h,f,p){d.super_=h,p||(p=f,f=null),f&&Object.keys(f).forEach(g=>{Object.defineProperty(d,g,Object.getOwnPropertyDescriptor(f,g))});const v={constructor:{value:d,enumerable:!1,writable:!1,configurable:!0}};p&&Object.keys(p).forEach(g=>{v[g]=Object.getOwnPropertyDescriptor(p,g)}),d.prototype=Object.create(h.prototype,v)},dateToExcel:(d,h)=>25569+d.getTime()/864e5-(h?1462:0),excelToDate(d,h){const f=Math.round(24*(d-25569+(h?1462:0))*3600*1e3);return new Date(f)},parsePath(d){const h=d.lastIndexOf("/");return{path:d.substring(0,h),name:d.substring(h+1)}},getRelsPath(d){const h=l.parsePath(d);return`${h.path}/_rels/${h.name}.rels`},xmlEncode(d){const h=u.exec(d);if(!h)return d;let f="",p="",v=0,g=h.index;for(;g<d.length;g++){const m=d.charCodeAt(g);switch(m){case 34:p="&quot;";break;case 38:p="&amp;";break;case 39:p="&apos;";break;case 60:p="&lt;";break;case 62:p="&gt;";break;case 127:p="";break;default:if(m<=31&&(m<=8||m>=11&&m!==13)){p="";break}continue}v!==g&&(f+=d.substring(v,g)),v=g+1,p&&(f+=p)}return v!==g?f+d.substring(v,g):f},xmlDecode:d=>d.replace(/&([a-z]*);/g,h=>{switch(h){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&apos;":return"'";case"&quot;":return'"';default:return h}}),validInt(d){const h=parseInt(d,10);return Number.isNaN(h)?0:h},isDateFmt(d){return d?(d=(d=d.replace(/\[[^\]]*]/g,"")).replace(/"[^"]*"/g,"")).match(/[ymdhMsb]+/)!==null:!1},fs:{exists:d=>new Promise(h=>{c.access(d,c.constants.F_OK,f=>{h(!f)})})},toIsoDateString:d=>d.toIsoString().subsstr(0,10),parseBoolean:d=>d===!0||d==="true"||d===1||d==="1"};n.exports=l}).call(this)}).call(this,typeof Kn<"u"?Kn:typeof self<"u"?self:typeof window<"u"?window:{},t("timers").setImmediate)},{fs:216,timers:523}],28:[function(t,n,s){const o=t("./under-dash"),i=t("./utils");function c(d,h,f){d.push(` ${h}="${i.xmlEncode(f.toString())}"`)}function u(d,h){if(h){const f=[];o.each(h,(p,v)=>{p!==void 0&&c(f,v,p)}),d.push(f.join(""))}}class l{constructor(){this._xml=[],this._stack=[],this._rollbacks=[]}get tos(){return this._stack.length?this._stack[this._stack.length-1]:void 0}get cursor(){return this._xml.length}openXml(h){const f=this._xml;f.push("<?xml"),u(f,h),f.push(`?>
`)}openNode(h,f){const p=this.tos,v=this._xml;p&&this.open&&v.push(">"),this._stack.push(h),v.push("<"),v.push(h),u(v,f),this.leaf=!0,this.open=!0}addAttribute(h,f){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");f!==void 0&&c(this._xml,h,f)}addAttributes(h){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");u(this._xml,h)}writeText(h){const f=this._xml;this.open&&(f.push(">"),this.open=!1),this.leaf=!1,f.push(i.xmlEncode(h.toString()))}writeXml(h){this.open&&(this._xml.push(">"),this.open=!1),this.leaf=!1,this._xml.push(h)}closeNode(){const h=this._stack.pop(),f=this._xml;this.leaf?f.push("/>"):(f.push("</"),f.push(h),f.push(">")),this.open=!1,this.leaf=!1}leafNode(h,f,p){this.openNode(h,f),p!==void 0&&this.writeText(p),this.closeNode()}closeAll(){for(;this._stack.length;)this.closeNode()}addRollback(){return this._rollbacks.push({xml:this._xml.length,stack:this._stack.length,leaf:this.leaf,open:this.open}),this.cursor}commit(){this._rollbacks.pop()}rollback(){const h=this._rollbacks.pop();this._xml.length>h.xml&&this._xml.splice(h.xml,this._xml.length-h.xml),this._stack.length>h.stack&&this._stack.splice(h.stack,this._stack.length-h.stack),this.leaf=h.leaf,this.open=h.open}get xml(){return this.closeAll(),this._xml.join("")}}l.StdDocAttributes={version:"1.0",encoding:"UTF-8",standalone:"yes"},n.exports=l},{"./under-dash":26,"./utils":27}],29:[function(t,n,s){(function(o){(function(){const i=t("events"),c=t("jszip"),u=t("./stream-buf"),{stringToBuffer:l}=t("./browser-buffer-encode");class d extends i.EventEmitter{constructor(f){super(),this.options=Object.assign({type:"nodebuffer",compression:"DEFLATE"},f),this.zip=new c,this.stream=new u}append(f,p){p.hasOwnProperty("base64")&&p.base64?this.zip.file(p.name,f,{base64:!0}):(o.browser&&typeof f=="string"&&(f=l(f)),this.zip.file(p.name,f))}async finalize(){const f=await this.zip.generateAsync(this.options);this.stream.end(f),this.emit("finish")}read(f){return this.stream.read(f)}setEncoding(f){return this.stream.setEncoding(f)}pause(){return this.stream.pause()}resume(){return this.stream.resume()}isPaused(){return this.stream.isPaused()}pipe(f,p){return this.stream.pipe(f,p)}unpipe(f){return this.stream.unpipe(f)}unshift(f){return this.stream.unshift(f)}wrap(f){return this.stream.wrap(f)}}n.exports={ZipWriter:d}}).call(this)}).call(this,t("_process"))},{"./browser-buffer-encode":17,"./stream-buf":24,_process:467,events:422,jszip:441}],30:[function(t,n,s){n.exports={0:{f:"General"},1:{f:"0"},2:{f:"0.00"},3:{f:"#,##0"},4:{f:"#,##0.00"},9:{f:"0%"},10:{f:"0.00%"},11:{f:"0.00E+00"},12:{f:"# ?/?"},13:{f:"# ??/??"},14:{f:"mm-dd-yy"},15:{f:"d-mmm-yy"},16:{f:"d-mmm"},17:{f:"mmm-yy"},18:{f:"h:mm AM/PM"},19:{f:"h:mm:ss AM/PM"},20:{f:"h:mm"},21:{f:"h:mm:ss"},22:{f:'m/d/yy "h":mm'},27:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},28:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},29:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},30:{"zh-tw":"m/d/yy ","zh-cn":"m-d-yy","ja-jp":"m/d/yy","ko-kr":"mm-dd-yy"},31:{"zh-tw":'yyyy""m""d""',"zh-cn":'yyyy""m""d""',"ja-jp":'yyyy""m""d""',"ko-kr":'yyyy"" mm"" dd""'},32:{"zh-tw":'hh""mm""',"zh-cn":'h""mm""',"ja-jp":'h""mm""',"ko-kr":'h"" mm""'},33:{"zh-tw":'hh""mm""ss""',"zh-cn":'h""mm""ss""',"ja-jp":'h""mm""ss""',"ko-kr":'h"" mm"" ss""'},34:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},35:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},36:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},37:{f:"#,##0 ;(#,##0)"},38:{f:"#,##0 ;[Red](#,##0)"},39:{f:"#,##0.00 ;(#,##0.00)"},40:{f:"#,##0.00 ;[Red](#,##0.00)"},45:{f:"mm:ss"},46:{f:"[h]:mm:ss"},47:{f:"mmss.0"},48:{f:"##0.0E+0"},49:{f:"@"},50:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},51:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},52:{"zh-tw":'/ hh""mm""',"zh-cn":'yyyy""m""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},53:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'m""d""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},54:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},55:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},56:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},57:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},58:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},59:{"th-th":"t0"},60:{"th-th":"t0.00"},61:{"th-th":"t#,##0"},62:{"th-th":"t#,##0.00"},67:{"th-th":"t0%"},68:{"th-th":"t0.00%"},69:{"th-th":"t# ?/?"},70:{"th-th":"t# ??/??"},81:{"th-th":"d/m/bb"}}},{}],31:[function(t,n,s){n.exports={OfficeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",CalcChain:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain",SharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Styles:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Theme:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",CoreProperties:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",ExtenderProperties:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",Comments:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",VmlDrawing:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",Table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table"}},{}],32:[function(t,n,s){const o=t("../../utils/parse-sax"),i=t("../../utils/xml-stream");class c{prepare(){}render(){}parseOpen(l){}parseText(l){}parseClose(l){}reconcile(l,d){}reset(){this.model=null,this.map&&Object.values(this.map).forEach(l=>{l instanceof c?l.reset():l.xform&&l.xform.reset()})}mergeModel(l){this.model=Object.assign(this.model||{},l)}async parse(l){for await(const d of l)for(const{eventType:h,value:f}of d)if(h==="opentag")this.parseOpen(f);else if(h==="text")this.parseText(f);else if(h==="closetag"&&!this.parseClose(f.name))return this.model;return this.model}async parseStream(l){return this.parse(o(l))}get xml(){return this.toXml(this.model)}toXml(l){const d=new i;return this.render(d,l),d.xml}static toAttribute(l,d){let h=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(l===void 0){if(h)return d}else if(h||l!==d)return l.toString()}static toStringAttribute(l,d){let h=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return c.toAttribute(l,d,h)}static toStringValue(l,d){return l===void 0?d:l}static toBoolAttribute(l,d){let h=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(l===void 0){if(h)return d}else if(h||l!==d)return l?"1":"0"}static toBoolValue(l,d){return l===void 0?d:l==="1"}static toIntAttribute(l,d){let h=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return c.toAttribute(l,d,h)}static toIntValue(l,d){return l===void 0?d:parseInt(l,10)}static toFloatAttribute(l,d){let h=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return c.toAttribute(l,d,h)}static toFloatValue(l,d){return l===void 0?d:parseFloat(l)}}n.exports=c},{"../../utils/parse-sax":22,"../../utils/xml-stream":28}],33:[function(t,n,s){const o=t("../base-xform"),i=t("../../../utils/col-cache");function c(l){try{return i.decodeEx(l),!0}catch{return!1}}function u(l){const d=[];let h=!1,f="";return l.split(",").forEach(p=>{if(!p)return;const v=(p.match(/'/g)||[]).length;if(!v)return void(h?f+=p+",":c(p)&&d.push(p));const g=v%2==0;!h&&g&&c(p)?d.push(p):h&&!g?(h=!1,c(f+p)&&d.push(f+p),f=""):(h=!0,f+=p+",")}),d}n.exports=class extends o{render(l,d){l.openNode("definedName",{name:d.name,localSheetId:d.localSheetId}),l.writeText(d.ranges.join(",")),l.closeNode()}parseOpen(l){switch(l.name){case"definedName":return this._parsedName=l.attributes.name,this._parsedLocalSheetId=l.attributes.localSheetId,this._parsedText=[],!0;default:return!1}}parseText(l){this._parsedText.push(l)}parseClose(){return this.model={name:this._parsedName,ranges:u(this._parsedText.join(""))},this._parsedLocalSheetId!==void 0&&(this.model.localSheetId=parseInt(this._parsedLocalSheetId,10)),!1}}},{"../../../utils/col-cache":19,"../base-xform":32}],34:[function(t,n,s){const o=t("../../../utils/utils"),i=t("../base-xform");n.exports=class extends i{render(c,u){c.leafNode("sheet",{sheetId:u.id,name:u.name,state:u.state,"r:id":u.rId})}parseOpen(c){return c.name==="sheet"&&(this.model={name:o.xmlDecode(c.attributes.name),id:parseInt(c.attributes.sheetId,10),state:c.attributes.state,rId:c.attributes["r:id"]},!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/utils":27,"../base-xform":32}],35:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{render(i,c){i.leafNode("calcPr",{calcId:171027,fullCalcOnLoad:c.fullCalcOnLoad?1:void 0})}parseOpen(i){return i.name==="calcPr"&&(this.model={},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],36:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{render(i,c){i.leafNode("workbookPr",{date1904:c.date1904?1:void 0,defaultThemeVersion:164011,filterPrivacy:1})}parseOpen(i){return i.name==="workbookPr"&&(this.model={date1904:i.attributes.date1904==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],37:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{render(i,c){const u={xWindow:c.x||0,yWindow:c.y||0,windowWidth:c.width||12e3,windowHeight:c.height||24e3,firstSheet:c.firstSheet,activeTab:c.activeTab};c.visibility&&c.visibility!=="visible"&&(u.visibility=c.visibility),i.leafNode("workbookView",u)}parseOpen(i){if(i.name==="workbookView"){const c=this.model={},u=function(d,h,f){const p=h!==void 0?c[d]=h:f;p!==void 0&&(c[d]=p)},l=function(d,h,f){const p=h!==void 0?c[d]=parseInt(h,10):f;p!==void 0&&(c[d]=p)};return l("x",i.attributes.xWindow,0),l("y",i.attributes.yWindow,0),l("width",i.attributes.windowWidth,25e3),l("height",i.attributes.windowHeight,1e4),u("visibility",i.attributes.visibility,"visible"),l("activeTab",i.attributes.activeTab,void 0),l("firstSheet",i.attributes.firstSheet,void 0),!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],38:[function(t,n,s){const o=t("../../../utils/under-dash"),i=t("../../../utils/col-cache"),c=t("../../../utils/xml-stream"),u=t("../base-xform"),l=t("../static-xform"),d=t("../list-xform"),h=t("./defined-name-xform"),f=t("./sheet-xform"),p=t("./workbook-view-xform"),v=t("./workbook-properties-xform"),g=t("./workbook-calc-properties-xform");class m extends u{constructor(){super(),this.map={fileVersion:m.STATIC_XFORMS.fileVersion,workbookPr:new v,bookViews:new d({tag:"bookViews",count:!1,childXform:new p}),sheets:new d({tag:"sheets",count:!1,childXform:new f}),definedNames:new d({tag:"definedNames",count:!1,childXform:new h}),calcPr:new g}}prepare(y){y.sheets=y.worksheets;const S=[];let C=0;y.sheets.forEach(L=>{if(L.pageSetup&&L.pageSetup.printArea&&L.pageSetup.printArea.split("&&").forEach(O=>{const H=O.split(":"),z={name:"_xlnm.Print_Area",ranges:[`'${L.name}'!$${H[0]}:$${H[1]}`],localSheetId:C};S.push(z)}),L.pageSetup&&(L.pageSetup.printTitlesRow||L.pageSetup.printTitlesColumn)){const O=[];if(L.pageSetup.printTitlesColumn){const z=L.pageSetup.printTitlesColumn.split(":");O.push(`'${L.name}'!$${z[0]}:$${z[1]}`)}if(L.pageSetup.printTitlesRow){const z=L.pageSetup.printTitlesRow.split(":");O.push(`'${L.name}'!$${z[0]}:$${z[1]}`)}const H={name:"_xlnm.Print_Titles",ranges:O,localSheetId:C};S.push(H)}C++}),S.length&&(y.definedNames=y.definedNames.concat(S)),(y.media||[]).forEach((L,O)=>{L.name=L.type+(O+1)})}render(y,S){y.openXml(c.StdDocAttributes),y.openNode("workbook",m.WORKBOOK_ATTRIBUTES),this.map.fileVersion.render(y),this.map.workbookPr.render(y,S.properties),this.map.bookViews.render(y,S.views),this.map.sheets.render(y,S.sheets),this.map.definedNames.render(y,S.definedNames),this.map.calcPr.render(y,S.calcProperties),y.closeNode()}parseOpen(y){if(this.parser)return this.parser.parseOpen(y),!0;switch(y.name){case"workbook":return!0;default:return this.parser=this.map[y.name],this.parser&&this.parser.parseOpen(y),!0}}parseText(y){this.parser&&this.parser.parseText(y)}parseClose(y){if(this.parser)return this.parser.parseClose(y)||(this.parser=void 0),!0;switch(y){case"workbook":return this.model={sheets:this.map.sheets.model,properties:this.map.workbookPr.model||{},views:this.map.bookViews.model,calcProperties:{}},this.map.definedNames.model&&(this.model.definedNames=this.map.definedNames.model),!1;default:return!0}}reconcile(y){const S=(y.workbookRels||[]).reduce((z,q)=>(z[q.Id]=q,z),{}),C=[];let L,O=0;(y.sheets||[]).forEach(z=>{const q=S[z.rId];q&&(L=y.worksheetHash["xl/"+q.Target.replace(/^(\s|\/xl\/)+/,"")],L&&(L.name=z.name,L.id=z.id,L.state=z.state,C[O++]=L))});const H=[];o.each(y.definedNames,z=>{if(z.name==="_xlnm.Print_Area"){if(L=C[z.localSheetId],L){L.pageSetup||(L.pageSetup={});const q=i.decodeEx(z.ranges[0]);L.pageSetup.printArea=L.pageSetup.printArea?`${L.pageSetup.printArea}&&${q.dimensions}`:q.dimensions}}else if(z.name==="_xlnm.Print_Titles"){if(L=C[z.localSheetId],L){L.pageSetup||(L.pageSetup={});const q=z.ranges.join(","),D=/\$/g,W=/\$\d+:\$\d+/,P=q.match(W);if(P&&P.length){const k=P[0];L.pageSetup.printTitlesRow=k.replace(D,"")}const I=/\$[A-Z]+:\$[A-Z]+/,U=q.match(I);if(U&&U.length){const k=U[0];L.pageSetup.printTitlesColumn=k.replace(D,"")}}}else H.push(z)}),y.definedNames=H,y.media.forEach((z,q)=>{z.index=q})}}m.WORKBOOK_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x15","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},m.STATIC_XFORMS={fileVersion:new l({tag:"fileVersion",$:{appName:"xl",lastEdited:5,lowestEdited:5,rupBuild:9303}})},n.exports=m},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./defined-name-xform":33,"./sheet-xform":34,"./workbook-calc-properties-xform":35,"./workbook-properties-xform":36,"./workbook-view-xform":37}],39:[function(t,n,s){const o=t("../strings/rich-text-xform"),i=t("../../../utils/utils"),c=t("../base-xform"),u=n.exports=function(l){this.model=l};i.inherits(u,c,{get tag(){return"r"},get richTextXform(){return this._richTextXform||(this._richTextXform=new o),this._richTextXform},render(l,d){d=d||this.model,l.openNode("comment",{ref:d.ref,authorId:0}),l.openNode("text"),d&&d.note&&d.note.texts&&d.note.texts.forEach(h=>{this.richTextXform.render(l,h)}),l.closeNode(),l.closeNode()},parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case"comment":return this.model={type:"note",note:{texts:[]},...l.attributes},!0;case"r":return this.parser=this.richTextXform,this.parser.parseOpen(l),!0;default:return!1}},parseText(l){this.parser&&this.parser.parseText(l)},parseClose(l){switch(l){case"comment":return!1;case"r":return this.model.note.texts.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(l),!0}}})},{"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],40:[function(t,n,s){const o=t("../../../utils/xml-stream"),i=t("../../../utils/utils"),c=t("../base-xform"),u=t("./comment-xform"),l=n.exports=function(){this.map={comment:new u}};i.inherits(l,c,{COMMENTS_ATTRIBUTES:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},{render(d,h){h=h||this.model,d.openXml(o.StdDocAttributes),d.openNode("comments",l.COMMENTS_ATTRIBUTES),d.openNode("authors"),d.leafNode("author",null,"Author"),d.closeNode(),d.openNode("commentList"),h.comments.forEach(f=>{this.map.comment.render(d,f)}),d.closeNode(),d.closeNode()},parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case"commentList":return this.model={comments:[]},!0;case"comment":return this.parser=this.map.comment,this.parser.parseOpen(d),!0;default:return!1}},parseText(d){this.parser&&this.parser.parseText(d)},parseClose(d){switch(d){case"commentList":return!1;case"comment":return this.model.comments.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(d),!0}}})},{"../../../utils/utils":27,"../../../utils/xml-stream":28,"../base-xform":32,"./comment-xform":39}],41:[function(t,n,s){const o=t("../../base-xform");n.exports=class extends o{constructor(i){super(),this._model=i}get tag(){return this._model&&this._model.tag}render(i,c,u){(c===u[2]||this.tag==="x:SizeWithCells"&&c===u[1])&&i.leafNode(this.tag)}parseOpen(i){switch(i.name){case this.tag:return this.model={},this.model[this.tag]=!0,!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../base-xform":32}],42:[function(t,n,s){const o=t("../../base-xform");n.exports=class extends o{constructor(i){super(),this._model=i}get tag(){return this._model&&this._model.tag}render(i,c){i.leafNode(this.tag,null,c)}parseOpen(i){switch(i.name){case this.tag:return this.text="",!0;default:return!1}}parseText(i){this.text=i}parseClose(){return!1}}},{"../../base-xform":32}],43:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{get tag(){return"x:Anchor"}getAnchorRect(i){const c=Math.floor(i.left),u=Math.floor(68*(i.left-c)),l=Math.floor(i.top),d=Math.floor(18*(i.top-l)),h=Math.floor(i.right),f=Math.floor(68*(i.right-h)),p=Math.floor(i.bottom);return[c,u,l,d,h,f,p,Math.floor(18*(i.bottom-p))]}getDefaultRect(i){const c=i.col,u=Math.max(i.row-2,0);return[c,6,u,14,c+2,2,u+4,16]}render(i,c){const u=c.anchor?this.getAnchorRect(c.anchor):this.getDefaultRect(c.refAddress);i.leafNode("x:Anchor",null,u.join(", "))}parseOpen(i){switch(i.name){case this.tag:return this.text="",!0;default:return!1}}parseText(i){this.text=i}parseClose(){return!1}}},{"../base-xform":32}],44:[function(t,n,s){const o=t("../base-xform"),i=t("./vml-anchor-xform"),c=t("./style/vml-protection-xform"),u=t("./style/vml-position-xform"),l=["twoCells","oneCells","absolute"];n.exports=class extends o{constructor(){super(),this.map={"x:Anchor":new i,"x:Locked":new c({tag:"x:Locked"}),"x:LockText":new c({tag:"x:LockText"}),"x:SizeWithCells":new u({tag:"x:SizeWithCells"}),"x:MoveWithCells":new u({tag:"x:MoveWithCells"})}}get tag(){return"x:ClientData"}render(d,h){const{protection:f,editAs:p}=h.note;d.openNode(this.tag,{ObjectType:"Note"}),this.map["x:MoveWithCells"].render(d,p,l),this.map["x:SizeWithCells"].render(d,p,l),this.map["x:Anchor"].render(d,h),this.map["x:Locked"].render(d,f.locked),d.leafNode("x:AutoFill",null,"False"),this.map["x:LockText"].render(d,f.lockText),d.leafNode("x:Row",null,h.refAddress.row-1),d.leafNode("x:Column",null,h.refAddress.col-1),d.closeNode()}parseOpen(d){switch(d.name){case this.tag:this.reset(),this.model={anchor:[],protection:{},editAs:""};break;default:this.parser=this.map[d.name],this.parser&&this.parser.parseOpen(d)}return!0}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){if(this.parser)return this.parser.parseClose(d)||(this.parser=void 0),!0;switch(d){case this.tag:return this.normalizeModel(),!1;default:return!0}}normalizeModel(){const d=Object.assign({},this.map["x:MoveWithCells"].model,this.map["x:SizeWithCells"].model),h=Object.keys(d).length;this.model.editAs=l[h],this.model.anchor=this.map["x:Anchor"].text,this.model.protection.locked=this.map["x:Locked"].text,this.model.protection.lockText=this.map["x:LockText"].text}}},{"../base-xform":32,"./style/vml-position-xform":41,"./style/vml-protection-xform":42,"./vml-anchor-xform":43}],45:[function(t,n,s){const o=t("../../../utils/xml-stream"),i=t("../base-xform"),c=t("./vml-shape-xform");class u extends i{constructor(){super(),this.map={"v:shape":new c}}get tag(){return"xml"}render(d,h){d.openXml(o.StdDocAttributes),d.openNode(this.tag,u.DRAWING_ATTRIBUTES),d.openNode("o:shapelayout",{"v:ext":"edit"}),d.leafNode("o:idmap",{"v:ext":"edit",data:1}),d.closeNode(),d.openNode("v:shapetype",{id:"_x0000_t202",coordsize:"21600,21600","o:spt":202,path:"m,l,21600r21600,l21600,xe"}),d.leafNode("v:stroke",{joinstyle:"miter"}),d.leafNode("v:path",{gradientshapeok:"t","o:connecttype":"rect"}),d.closeNode(),h.comments.forEach((f,p)=>{this.map["v:shape"].render(d,f,p)}),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case this.tag:this.reset(),this.model={comments:[]};break;default:this.parser=this.map[d.name],this.parser&&this.parser.parseOpen(d)}return!0}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){if(this.parser)return this.parser.parseClose(d)||(this.model.comments.push(this.parser.model),this.parser=void 0),!0;switch(d){case this.tag:return!1;default:return!0}}reconcile(d,h){d.anchors.forEach(f=>{f.br?this.map["xdr:twoCellAnchor"].reconcile(f,h):this.map["xdr:oneCellAnchor"].reconcile(f,h)})}}u.DRAWING_ATTRIBUTES={"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:x":"urn:schemas-microsoft-com:office:excel"},n.exports=u},{"../../../utils/xml-stream":28,"../base-xform":32,"./vml-shape-xform":46}],46:[function(t,n,s){const o=t("../base-xform"),i=t("./vml-textbox-xform"),c=t("./vml-client-data-xform");class u extends o{constructor(){super(),this.map={"v:textbox":new i,"x:ClientData":new c}}get tag(){return"v:shape"}render(d,h,f){d.openNode("v:shape",u.V_SHAPE_ATTRIBUTES(h,f)),d.leafNode("v:fill",{color2:"infoBackground [80]"}),d.leafNode("v:shadow",{color:"none [81]",obscured:"t"}),d.leafNode("v:path",{"o:connecttype":"none"}),this.map["v:textbox"].render(d,h),this.map["x:ClientData"].render(d,h),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case this.tag:this.reset(),this.model={margins:{insetmode:d.attributes["o:insetmode"]},anchor:"",editAs:"",protection:{}};break;default:this.parser=this.map[d.name],this.parser&&this.parser.parseOpen(d)}return!0}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){if(this.parser)return this.parser.parseClose(d)||(this.parser=void 0),!0;switch(d){case this.tag:return this.model.margins.inset=this.map["v:textbox"].model&&this.map["v:textbox"].model.inset,this.model.protection=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.protection,this.model.anchor=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.anchor,this.model.editAs=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.editAs,!1;default:return!0}}}u.V_SHAPE_ATTRIBUTES=(l,d)=>({id:"_x0000_s"+(1025+d),type:"#_x0000_t202",style:"position:absolute; margin-left:105.3pt;margin-top:10.5pt;width:97.8pt;height:59.1pt;z-index:1;visibility:hidden",fillcolor:"infoBackground [80]",strokecolor:"none [81]","o:insetmode":l.note.margins&&l.note.margins.insetmode}),n.exports=u},{"../base-xform":32,"./vml-client-data-xform":44,"./vml-textbox-xform":47}],47:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{get tag(){return"v:textbox"}conversionUnit(i,c,u){return`${parseFloat(i)*c.toFixed(2)}${u}`}reverseConversionUnit(i){return(i||"").split(",").map(c=>Number(parseFloat(this.conversionUnit(parseFloat(c),.1,"")).toFixed(2)))}render(i,c){const u={style:"mso-direction-alt:auto"};if(c&&c.note){let{inset:l}=c.note&&c.note.margins;Array.isArray(l)&&(l=l.map(d=>this.conversionUnit(d,10,"mm")).join(",")),l&&(u.inset=l)}i.openNode("v:textbox",u),i.leafNode("div",{style:"text-align:left"}),i.closeNode()}parseOpen(i){switch(i.name){case this.tag:return this.model={inset:this.reverseConversionUnit(i.attributes.inset)},!0;default:return!0}}parseText(){}parseClose(i){switch(i){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],48:[function(t,n,s){const o=t("./base-xform");n.exports=class extends o{createNewModel(i){return{}}parseOpen(i){return this.parser=this.parser||this.map[i.name],this.parser?(this.parser.parseOpen(i),!0):i.name===this.tag&&(this.model=this.createNewModel(i),!0)}parseText(i){this.parser&&this.parser.parseText(i)}onParserClose(i,c){this.model[i]=c.model}parseClose(i){return this.parser?(this.parser.parseClose(i)||(this.onParserClose(i,this.parser),this.parser=void 0),!0):i!==this.tag}}},{"./base-xform":32}],49:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{render(i,c){i.openNode("HeadingPairs"),i.openNode("vt:vector",{size:2,baseType:"variant"}),i.openNode("vt:variant"),i.leafNode("vt:lpstr",void 0,"Worksheets"),i.closeNode(),i.openNode("vt:variant"),i.leafNode("vt:i4",void 0,c.length),i.closeNode(),i.closeNode(),i.closeNode()}parseOpen(i){return i.name==="HeadingPairs"}parseText(){}parseClose(i){return i!=="HeadingPairs"}}},{"../base-xform":32}],50:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{render(i,c){i.openNode("TitlesOfParts"),i.openNode("vt:vector",{size:c.length,baseType:"lpstr"}),c.forEach(u=>{i.leafNode("vt:lpstr",void 0,u.name)}),i.closeNode(),i.closeNode()}parseOpen(i){return i.name==="TitlesOfParts"}parseText(){}parseClose(i){return i!=="TitlesOfParts"}}},{"../base-xform":32}],51:[function(t,n,s){const o=t("../../../utils/xml-stream"),i=t("../base-xform"),c=t("../simple/string-xform"),u=t("./app-heading-pairs-xform"),l=t("./app-titles-of-parts-xform");class d extends i{constructor(){super(),this.map={Company:new c({tag:"Company"}),Manager:new c({tag:"Manager"}),HeadingPairs:new u,TitleOfParts:new l}}render(f,p){f.openXml(o.StdDocAttributes),f.openNode("Properties",d.PROPERTY_ATTRIBUTES),f.leafNode("Application",void 0,"Microsoft Excel"),f.leafNode("DocSecurity",void 0,"0"),f.leafNode("ScaleCrop",void 0,"false"),this.map.HeadingPairs.render(f,p.worksheets),this.map.TitleOfParts.render(f,p.worksheets),this.map.Company.render(f,p.company||""),this.map.Manager.render(f,p.manager),f.leafNode("LinksUpToDate",void 0,"false"),f.leafNode("SharedDoc",void 0,"false"),f.leafNode("HyperlinksChanged",void 0,"false"),f.leafNode("AppVersion",void 0,"16.0300"),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"Properties":return!0;default:return this.parser=this.map[f.name],!!this.parser&&(this.parser.parseOpen(f),!0)}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){if(this.parser)return this.parser.parseClose(f)||(this.parser=void 0),!0;switch(f){case"Properties":return this.model={worksheets:this.map.TitleOfParts.model,company:this.map.Company.model,manager:this.map.Manager.model},!1;default:return!0}}}d.DateFormat=function(h){return h.toISOString().replace(/[.]\d{3,6}/,"")},d.DateAttrs={"xsi:type":"dcterms:W3CDTF"},d.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","xmlns:vt":"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"},n.exports=d},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/string-xform":119,"./app-heading-pairs-xform":49,"./app-titles-of-parts-xform":50}],52:[function(t,n,s){const o=t("../../../utils/xml-stream"),i=t("../base-xform");class c extends i{render(l,d){l.openXml(o.StdDocAttributes),l.openNode("Types",c.PROPERTY_ATTRIBUTES);const h={};(d.media||[]).forEach(f=>{if(f.type==="image"){const p=f.extension;h[p]||(h[p]=!0,l.leafNode("Default",{Extension:p,ContentType:"image/"+p}))}}),l.leafNode("Default",{Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"}),l.leafNode("Default",{Extension:"xml",ContentType:"application/xml"}),l.leafNode("Override",{PartName:"/xl/workbook.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"}),d.worksheets.forEach(f=>{const p=`/xl/worksheets/sheet${f.id}.xml`;l.leafNode("Override",{PartName:p,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"})}),l.leafNode("Override",{PartName:"/xl/theme/theme1.xml",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml"}),l.leafNode("Override",{PartName:"/xl/styles.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"}),d.sharedStrings&&d.sharedStrings.count&&l.leafNode("Override",{PartName:"/xl/sharedStrings.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"}),d.tables&&d.tables.forEach(f=>{l.leafNode("Override",{PartName:"/xl/tables/"+f.target,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"})}),d.drawings&&d.drawings.forEach(f=>{l.leafNode("Override",{PartName:`/xl/drawings/${f.name}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml"})}),d.commentRefs&&(l.leafNode("Default",{Extension:"vml",ContentType:"application/vnd.openxmlformats-officedocument.vmlDrawing"}),d.commentRefs.forEach(f=>{let{commentName:p}=f;l.leafNode("Override",{PartName:`/xl/${p}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml"})})),l.leafNode("Override",{PartName:"/docProps/core.xml",ContentType:"application/vnd.openxmlformats-package.core-properties+xml"}),l.leafNode("Override",{PartName:"/docProps/app.xml",ContentType:"application/vnd.openxmlformats-officedocument.extended-properties+xml"}),l.closeNode()}parseOpen(){return!1}parseText(){}parseClose(){return!1}}c.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"},n.exports=c},{"../../../utils/xml-stream":28,"../base-xform":32}],53:[function(t,n,s){const o=t("../../../utils/xml-stream"),i=t("../base-xform"),c=t("../simple/date-xform"),u=t("../simple/string-xform"),l=t("../simple/integer-xform");class d extends i{constructor(){super(),this.map={"dc:creator":new u({tag:"dc:creator"}),"dc:title":new u({tag:"dc:title"}),"dc:subject":new u({tag:"dc:subject"}),"dc:description":new u({tag:"dc:description"}),"dc:identifier":new u({tag:"dc:identifier"}),"dc:language":new u({tag:"dc:language"}),"cp:keywords":new u({tag:"cp:keywords"}),"cp:category":new u({tag:"cp:category"}),"cp:lastModifiedBy":new u({tag:"cp:lastModifiedBy"}),"cp:lastPrinted":new c({tag:"cp:lastPrinted",format:d.DateFormat}),"cp:revision":new l({tag:"cp:revision"}),"cp:version":new u({tag:"cp:version"}),"cp:contentStatus":new u({tag:"cp:contentStatus"}),"cp:contentType":new u({tag:"cp:contentType"}),"dcterms:created":new c({tag:"dcterms:created",attrs:d.DateAttrs,format:d.DateFormat}),"dcterms:modified":new c({tag:"dcterms:modified",attrs:d.DateAttrs,format:d.DateFormat})}}render(f,p){f.openXml(o.StdDocAttributes),f.openNode("cp:coreProperties",d.CORE_PROPERTY_ATTRIBUTES),this.map["dc:creator"].render(f,p.creator),this.map["dc:title"].render(f,p.title),this.map["dc:subject"].render(f,p.subject),this.map["dc:description"].render(f,p.description),this.map["dc:identifier"].render(f,p.identifier),this.map["dc:language"].render(f,p.language),this.map["cp:keywords"].render(f,p.keywords),this.map["cp:category"].render(f,p.category),this.map["cp:lastModifiedBy"].render(f,p.lastModifiedBy),this.map["cp:lastPrinted"].render(f,p.lastPrinted),this.map["cp:revision"].render(f,p.revision),this.map["cp:version"].render(f,p.version),this.map["cp:contentStatus"].render(f,p.contentStatus),this.map["cp:contentType"].render(f,p.contentType),this.map["dcterms:created"].render(f,p.created),this.map["dcterms:modified"].render(f,p.modified),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"cp:coreProperties":case"coreProperties":return!0;default:if(this.parser=this.map[f.name],this.parser)return this.parser.parseOpen(f),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(f))}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){if(this.parser)return this.parser.parseClose(f)||(this.parser=void 0),!0;switch(f){case"cp:coreProperties":case"coreProperties":return this.model={creator:this.map["dc:creator"].model,title:this.map["dc:title"].model,subject:this.map["dc:subject"].model,description:this.map["dc:description"].model,identifier:this.map["dc:identifier"].model,language:this.map["dc:language"].model,keywords:this.map["cp:keywords"].model,category:this.map["cp:category"].model,lastModifiedBy:this.map["cp:lastModifiedBy"].model,lastPrinted:this.map["cp:lastPrinted"].model,revision:this.map["cp:revision"].model,contentStatus:this.map["cp:contentStatus"].model,contentType:this.map["cp:contentType"].model,created:this.map["dcterms:created"].model,modified:this.map["dcterms:modified"].model},!1;default:throw new Error("Unexpected xml node in parseClose: "+f)}}}d.DateFormat=function(h){return h.toISOString().replace(/[.]\d{3}/,"")},d.DateAttrs={"xsi:type":"dcterms:W3CDTF"},d.CORE_PROPERTY_ATTRIBUTES={"xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:dcterms":"http://purl.org/dc/terms/","xmlns:dcmitype":"http://purl.org/dc/dcmitype/","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"},n.exports=d},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/date-xform":117,"../simple/integer-xform":118,"../simple/string-xform":119}],54:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{render(i,c){i.leafNode("Relationship",c)}parseOpen(i){switch(i.name){case"Relationship":return this.model=i.attributes,!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],55:[function(t,n,s){const o=t("../../../utils/xml-stream"),i=t("../base-xform"),c=t("./relationship-xform");class u extends i{constructor(){super(),this.map={Relationship:new c}}render(d,h){h=h||this._values,d.openXml(o.StdDocAttributes),d.openNode("Relationships",u.RELATIONSHIPS_ATTRIBUTES),h.forEach(f=>{this.map.Relationship.render(d,f)}),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case"Relationships":return this.model=[],!0;default:if(this.parser=this.map[d.name],this.parser)return this.parser.parseOpen(d),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(d))}}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){if(this.parser)return this.parser.parseClose(d)||(this.model.push(this.parser.model),this.parser=void 0),!0;switch(d){case"Relationships":return!1;default:throw new Error("Unexpected xml node in parseClose: "+d)}}}u.RELATIONSHIPS_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"},n.exports=u},{"../../../utils/xml-stream":28,"../base-xform":32,"./relationship-xform":54}],56:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{parseOpen(i){if(this.parser)return this.parser.parseOpen(i),!0;switch(i.name){case this.tag:this.reset(),this.model={range:{editAs:i.attributes.editAs||"oneCell"}};break;default:this.parser=this.map[i.name],this.parser&&this.parser.parseOpen(i)}return!0}parseText(i){this.parser&&this.parser.parseText(i)}reconcilePicture(i,c){if(i&&i.rId){const u=c.rels[i.rId].Target.match(/.*\/media\/(.+[.][a-zA-Z]{3,4})/);if(u){const l=u[1],d=c.mediaIndex[l];return c.media[d]}}}}},{"../base-xform":32}],57:[function(t,n,s){const o=t("../base-xform"),i=t("./blip-xform");n.exports=class extends o{constructor(){super(),this.map={"a:blip":new i}}get tag(){return"xdr:blipFill"}render(c,u){c.openNode(this.tag),this.map["a:blip"].render(c,u),c.openNode("a:stretch"),c.leafNode("a:fillRect"),c.closeNode(),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case this.tag:this.reset();break;default:this.parser=this.map[c.name],this.parser&&this.parser.parseOpen(c)}return!0}parseText(){}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.parser=void 0),!0;switch(c){case this.tag:return this.model=this.map["a:blip"].model,!1;default:return!0}}}},{"../base-xform":32,"./blip-xform":58}],58:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{get tag(){return"a:blip"}render(i,c){i.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:embed":c.rId,cstate:"print"})}parseOpen(i){switch(i.name){case this.tag:return this.model={rId:i.attributes["r:embed"]},!0;default:return!0}}parseText(){}parseClose(i){switch(i){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],59:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{get tag(){return"xdr:cNvPicPr"}render(i){i.openNode(this.tag),i.leafNode("a:picLocks",{noChangeAspect:"1"}),i.closeNode()}parseOpen(i){switch(i.name){case this.tag:default:return!0}}parseText(){}parseClose(i){switch(i){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],60:[function(t,n,s){const o=t("../base-xform"),i=t("./hlink-click-xform"),c=t("./ext-lst-xform");n.exports=class extends o{constructor(){super(),this.map={"a:hlinkClick":new i,"a:extLst":new c}}get tag(){return"xdr:cNvPr"}render(u,l){u.openNode(this.tag,{id:l.index,name:"Picture "+l.index}),this.map["a:hlinkClick"].render(u,l),this.map["a:extLst"].render(u,l),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset();break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(){}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.model=this.map["a:hlinkClick"].model,!1;default:return!0}}}},{"../base-xform":32,"./ext-lst-xform":63,"./hlink-click-xform":65}],61:[function(t,n,s){const o=t("../base-xform"),i=t("../simple/integer-xform");n.exports=class extends o{constructor(c){super(),this.tag=c.tag,this.map={"xdr:col":new i({tag:"xdr:col",zero:!0}),"xdr:colOff":new i({tag:"xdr:colOff",zero:!0}),"xdr:row":new i({tag:"xdr:row",zero:!0}),"xdr:rowOff":new i({tag:"xdr:rowOff",zero:!0})}}render(c,u){c.openNode(this.tag),this.map["xdr:col"].render(c,u.nativeCol),this.map["xdr:colOff"].render(c,u.nativeColOff),this.map["xdr:row"].render(c,u.nativeRow),this.map["xdr:rowOff"].render(c,u.nativeRowOff),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case this.tag:this.reset();break;default:this.parser=this.map[c.name],this.parser&&this.parser.parseOpen(c)}return!0}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.parser=void 0),!0;switch(c){case this.tag:return this.model={nativeCol:this.map["xdr:col"].model,nativeColOff:this.map["xdr:colOff"].model,nativeRow:this.map["xdr:row"].model,nativeRowOff:this.map["xdr:rowOff"].model},!1;default:return!0}}}},{"../base-xform":32,"../simple/integer-xform":118}],62:[function(t,n,s){const o=t("../../../utils/col-cache"),i=t("../../../utils/xml-stream"),c=t("../base-xform"),u=t("./two-cell-anchor-xform"),l=t("./one-cell-anchor-xform");class d extends c{constructor(){super(),this.map={"xdr:twoCellAnchor":new u,"xdr:oneCellAnchor":new l}}prepare(f){f.anchors.forEach((p,v)=>{p.anchorType=function(g){return(typeof g.range=="string"?o.decode(g.range):g.range).br?"xdr:twoCellAnchor":"xdr:oneCellAnchor"}(p),this.map[p.anchorType].prepare(p,{index:v})})}get tag(){return"xdr:wsDr"}render(f,p){f.openXml(i.StdDocAttributes),f.openNode(this.tag,d.DRAWING_ATTRIBUTES),p.anchors.forEach(v=>{this.map[v.anchorType].render(f,v)}),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case this.tag:this.reset(),this.model={anchors:[]};break;default:this.parser=this.map[f.name],this.parser&&this.parser.parseOpen(f)}return!0}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){if(this.parser)return this.parser.parseClose(f)||(this.model.anchors.push(this.parser.model),this.parser=void 0),!0;switch(f){case this.tag:return!1;default:return!0}}reconcile(f,p){f.anchors.forEach(v=>{v.br?this.map["xdr:twoCellAnchor"].reconcile(v,p):this.map["xdr:oneCellAnchor"].reconcile(v,p)})}}d.DRAWING_ATTRIBUTES={"xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing","xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},n.exports=d},{"../../../utils/col-cache":19,"../../../utils/xml-stream":28,"../base-xform":32,"./one-cell-anchor-xform":67,"./two-cell-anchor-xform":70}],63:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{get tag(){return"a:extLst"}render(i){i.openNode(this.tag),i.openNode("a:ext",{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}),i.leafNode("a16:creationId",{"xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main",id:"{00000000-0008-0000-0000-000002000000}"}),i.closeNode(),i.closeNode()}parseOpen(i){switch(i.name){case this.tag:default:return!0}}parseText(){}parseClose(i){switch(i){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],64:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{constructor(i){super(),this.tag=i.tag,this.map={}}render(i,c){i.openNode(this.tag);const u=Math.floor(9525*c.width),l=Math.floor(9525*c.height);i.addAttribute("cx",u),i.addAttribute("cy",l),i.closeNode()}parseOpen(i){return i.name===this.tag&&(this.model={width:parseInt(i.attributes.cx||"0",10)/9525,height:parseInt(i.attributes.cy||"0",10)/9525},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],65:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{get tag(){return"a:hlinkClick"}render(i,c){c.hyperlinks&&c.hyperlinks.rId&&i.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:id":c.hyperlinks.rId,tooltip:c.hyperlinks.tooltip})}parseOpen(i){switch(i.name){case this.tag:return this.model={hyperlinks:{rId:i.attributes["r:id"],tooltip:i.attributes.tooltip}},!0;default:return!0}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],66:[function(t,n,s){const o=t("../base-xform"),i=t("./c-nv-pr-xform"),c=t("./c-nv-pic-pr-xform");n.exports=class extends o{constructor(){super(),this.map={"xdr:cNvPr":new i,"xdr:cNvPicPr":new c}}get tag(){return"xdr:nvPicPr"}render(u,l){u.openNode(this.tag),this.map["xdr:cNvPr"].render(u,l),this.map["xdr:cNvPicPr"].render(u,l),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset();break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(){}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.model=this.map["xdr:cNvPr"].model,!1;default:return!0}}}},{"../base-xform":32,"./c-nv-pic-pr-xform":59,"./c-nv-pr-xform":60}],67:[function(t,n,s){const o=t("./base-cell-anchor-xform"),i=t("../static-xform"),c=t("./cell-position-xform"),u=t("./ext-xform"),l=t("./pic-xform");n.exports=class extends o{constructor(){super(),this.map={"xdr:from":new c({tag:"xdr:from"}),"xdr:ext":new u({tag:"xdr:ext"}),"xdr:pic":new l,"xdr:clientData":new i({tag:"xdr:clientData"})}}get tag(){return"xdr:oneCellAnchor"}prepare(d,h){this.map["xdr:pic"].prepare(d.picture,h)}render(d,h){d.openNode(this.tag,{editAs:h.range.editAs||"oneCell"}),this.map["xdr:from"].render(d,h.range.tl),this.map["xdr:ext"].render(d,h.range.ext),this.map["xdr:pic"].render(d,h.picture),this.map["xdr:clientData"].render(d,{}),d.closeNode()}parseClose(d){if(this.parser)return this.parser.parseClose(d)||(this.parser=void 0),!0;switch(d){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.ext=this.map["xdr:ext"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}reconcile(d,h){d.medium=this.reconcilePicture(d.picture,h)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./ext-xform":64,"./pic-xform":68}],68:[function(t,n,s){const o=t("../base-xform"),i=t("../static-xform"),c=t("./blip-fill-xform"),u=t("./nv-pic-pr-xform"),l=t("./sp-pr");n.exports=class extends o{constructor(){super(),this.map={"xdr:nvPicPr":new u,"xdr:blipFill":new c,"xdr:spPr":new i(l)}}get tag(){return"xdr:pic"}prepare(d,h){d.index=h.index+1}render(d,h){d.openNode(this.tag),this.map["xdr:nvPicPr"].render(d,h),this.map["xdr:blipFill"].render(d,h),this.map["xdr:spPr"].render(d,h),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case this.tag:this.reset();break;default:this.parser=this.map[d.name],this.parser&&this.parser.parseOpen(d)}return!0}parseText(){}parseClose(d){if(this.parser)return this.parser.parseClose(d)||(this.mergeModel(this.parser.model),this.parser=void 0),!0;switch(d){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"../static-xform":120,"./blip-fill-xform":57,"./nv-pic-pr-xform":66,"./sp-pr":69}],69:[function(t,n,s){n.exports={tag:"xdr:spPr",c:[{tag:"a:xfrm",c:[{tag:"a:off",$:{x:"0",y:"0"}},{tag:"a:ext",$:{cx:"0",cy:"0"}}]},{tag:"a:prstGeom",$:{prst:"rect"},c:[{tag:"a:avLst"}]}]}},{}],70:[function(t,n,s){const o=t("./base-cell-anchor-xform"),i=t("../static-xform"),c=t("./cell-position-xform"),u=t("./pic-xform");n.exports=class extends o{constructor(){super(),this.map={"xdr:from":new c({tag:"xdr:from"}),"xdr:to":new c({tag:"xdr:to"}),"xdr:pic":new u,"xdr:clientData":new i({tag:"xdr:clientData"})}}get tag(){return"xdr:twoCellAnchor"}prepare(l,d){this.map["xdr:pic"].prepare(l.picture,d)}render(l,d){l.openNode(this.tag,{editAs:d.range.editAs||"oneCell"}),this.map["xdr:from"].render(l,d.range.tl),this.map["xdr:to"].render(l,d.range.br),this.map["xdr:pic"].render(l,d.picture),this.map["xdr:clientData"].render(l,{}),l.closeNode()}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.parser=void 0),!0;switch(l){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.br=this.map["xdr:to"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}reconcile(l,d){l.medium=this.reconcilePicture(l.picture,d)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./pic-xform":68}],71:[function(t,n,s){const o=t("./base-xform");n.exports=class extends o{constructor(i){super(),this.tag=i.tag,this.always=!!i.always,this.count=i.count,this.empty=i.empty,this.$count=i.$count||"count",this.$=i.$,this.childXform=i.childXform,this.maxItems=i.maxItems}prepare(i,c){const{childXform:u}=this;i&&i.forEach((l,d)=>{c.index=d,u.prepare(l,c)})}render(i,c){if(this.always||c&&c.length){i.openNode(this.tag,this.$),this.count&&i.addAttribute(this.$count,c&&c.length||0);const{childXform:u}=this;(c||[]).forEach((l,d)=>{u.render(i,l,d)}),i.closeNode()}else this.empty&&i.leafNode(this.tag)}parseOpen(i){if(this.parser)return this.parser.parseOpen(i),!0;switch(i.name){case this.tag:return this.model=[],!0;default:return!!this.childXform.parseOpen(i)&&(this.parser=this.childXform,!0)}}parseText(i){this.parser&&this.parser.parseText(i)}parseClose(i){if(this.parser){if(!this.parser.parseClose(i)&&(this.model.push(this.parser.model),this.parser=void 0,this.maxItems&&this.model.length>this.maxItems))throw new Error(`Max ${this.childXform.tag} count (${this.maxItems}) exceeded`);return!0}return!1}reconcile(i,c){if(i){const{childXform:u}=this;i.forEach(l=>{u.reconcile(l,c)})}}}},{"./base-xform":32}],72:[function(t,n,s){const o=t("../../../utils/col-cache"),i=t("../base-xform");n.exports=class extends i{get tag(){return"autoFilter"}render(c,u){if(u)if(typeof u=="string")c.leafNode("autoFilter",{ref:u});else{const l=function(f){return typeof f=="string"?f:o.getAddress(f.row,f.column).address},d=l(u.from),h=l(u.to);d&&h&&c.leafNode("autoFilter",{ref:`${d}:${h}`})}}parseOpen(c){c.name==="autoFilter"&&(this.model=c.attributes.ref)}}},{"../../../utils/col-cache":19,"../base-xform":32}],73:[function(t,n,s){const o=t("../../../utils/utils"),i=t("../base-xform"),c=t("../../../doc/range"),u=t("../../../doc/enums"),l=t("../strings/rich-text-xform");function d(h){if(h==null)return u.ValueType.Null;if(h instanceof String||typeof h=="string")return u.ValueType.String;if(typeof h=="number")return u.ValueType.Number;if(typeof h=="boolean")return u.ValueType.Boolean;if(h instanceof Date)return u.ValueType.Date;if(h.text&&h.hyperlink)return u.ValueType.Hyperlink;if(h.formula)return u.ValueType.Formula;if(h.error)return u.ValueType.Error;throw new Error("I could not understand type of value")}n.exports=class extends i{constructor(){super(),this.richTextXForm=new l}get tag(){return"c"}prepare(h,f){const p=f.styles.addStyleModel(h.style||{},function(v){switch(v.type){case u.ValueType.Formula:return d(v.result);default:return v.type}}(h));switch(p&&(h.styleId=p),h.comment&&f.comments.push({...h.comment,ref:h.address}),h.type){case u.ValueType.String:case u.ValueType.RichText:f.sharedStrings&&(h.ssId=f.sharedStrings.add(h.value));break;case u.ValueType.Date:f.date1904&&(h.date1904=!0);break;case u.ValueType.Hyperlink:f.sharedStrings&&h.text!==void 0&&h.text!==null&&(h.ssId=f.sharedStrings.add(h.text)),f.hyperlinks.push({address:h.address,target:h.hyperlink,tooltip:h.tooltip});break;case u.ValueType.Merge:f.merges.add(h);break;case u.ValueType.Formula:if(f.date1904&&(h.date1904=!0),h.shareType==="shared"&&(h.si=f.siFormulae++),h.formula)f.formulae[h.address]=h;else if(h.sharedFormula){const v=f.formulae[h.sharedFormula];if(!v)throw new Error("Shared Formula master must exist above and or left of clone for cell "+h.address);v.si===void 0?(v.shareType="shared",v.si=f.siFormulae++,v.range=new c(v.address,h.address)):v.range&&v.range.expandToAddress(h.address),h.si=v.si}}}renderFormula(h,f){let p=null;switch(f.shareType){case"shared":p={t:"shared",ref:f.ref||f.range.range,si:f.si};break;case"array":p={t:"array",ref:f.ref};break;default:f.si!==void 0&&(p={t:"shared",si:f.si})}switch(d(f.result)){case u.ValueType.Null:h.leafNode("f",p,f.formula);break;case u.ValueType.String:h.addAttribute("t","str"),h.leafNode("f",p,f.formula),h.leafNode("v",null,f.result);break;case u.ValueType.Number:h.leafNode("f",p,f.formula),h.leafNode("v",null,f.result);break;case u.ValueType.Boolean:h.addAttribute("t","b"),h.leafNode("f",p,f.formula),h.leafNode("v",null,f.result?1:0);break;case u.ValueType.Error:h.addAttribute("t","e"),h.leafNode("f",p,f.formula),h.leafNode("v",null,f.result.error);break;case u.ValueType.Date:h.leafNode("f",p,f.formula),h.leafNode("v",null,o.dateToExcel(f.result,f.date1904));break;default:throw new Error("I could not understand type of value")}}render(h,f){if(f.type!==u.ValueType.Null||f.styleId){switch(h.openNode("c"),h.addAttribute("r",f.address),f.styleId&&h.addAttribute("s",f.styleId),f.type){case u.ValueType.Null:break;case u.ValueType.Number:h.leafNode("v",null,f.value);break;case u.ValueType.Boolean:h.addAttribute("t","b"),h.leafNode("v",null,f.value?"1":"0");break;case u.ValueType.Error:h.addAttribute("t","e"),h.leafNode("v",null,f.value.error);break;case u.ValueType.String:case u.ValueType.RichText:f.ssId!==void 0?(h.addAttribute("t","s"),h.leafNode("v",null,f.ssId)):f.value&&f.value.richText?(h.addAttribute("t","inlineStr"),h.openNode("is"),f.value.richText.forEach(p=>{this.richTextXForm.render(h,p)}),h.closeNode("is")):(h.addAttribute("t","str"),h.leafNode("v",null,f.value));break;case u.ValueType.Date:h.leafNode("v",null,o.dateToExcel(f.value,f.date1904));break;case u.ValueType.Hyperlink:f.ssId!==void 0?(h.addAttribute("t","s"),h.leafNode("v",null,f.ssId)):(h.addAttribute("t","str"),h.leafNode("v",null,f.text));break;case u.ValueType.Formula:this.renderFormula(h,f);break;case u.ValueType.Merge:}h.closeNode()}}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case"c":return this.model={address:h.attributes.r},this.t=h.attributes.t,h.attributes.s&&(this.model.styleId=parseInt(h.attributes.s,10)),!0;case"f":return this.currentNode="f",this.model.si=h.attributes.si,this.model.shareType=h.attributes.t,this.model.ref=h.attributes.ref,!0;case"v":return this.currentNode="v",!0;case"t":return this.currentNode="t",!0;case"r":return this.parser=this.richTextXForm,this.parser.parseOpen(h),!0;default:return!1}}parseText(h){if(this.parser)this.parser.parseText(h);else switch(this.currentNode){case"f":this.model.formula=this.model.formula?this.model.formula+h:h;break;case"v":case"t":this.model.value&&this.model.value.richText?this.model.value.richText.text=this.model.value.richText.text?this.model.value.richText.text+h:h:this.model.value=this.model.value?this.model.value+h:h}}parseClose(h){switch(h){case"c":{const{model:f}=this;if(f.formula||f.shareType)f.type=u.ValueType.Formula,f.value&&(this.t==="str"?f.result=o.xmlDecode(f.value):this.t==="b"?f.result=parseInt(f.value,10)!==0:this.t==="e"?f.result={error:f.value}:f.result=parseFloat(f.value),f.value=void 0);else if(f.value!==void 0)switch(this.t){case"s":f.type=u.ValueType.String,f.value=parseInt(f.value,10);break;case"str":f.type=u.ValueType.String,f.value=o.xmlDecode(f.value);break;case"inlineStr":f.type=u.ValueType.String;break;case"b":f.type=u.ValueType.Boolean,f.value=parseInt(f.value,10)!==0;break;case"e":f.type=u.ValueType.Error,f.value={error:f.value};break;default:f.type=u.ValueType.Number,f.value=parseFloat(f.value)}else f.styleId?f.type=u.ValueType.Null:f.type=u.ValueType.Merge;return!1}case"f":case"v":case"is":return this.currentNode=void 0,!0;case"t":return this.parser?(this.parser.parseClose(h),!0):(this.currentNode=void 0,!0);case"r":return this.model.value=this.model.value||{},this.model.value.richText=this.model.value.richText||[],this.model.value.richText.push(this.parser.model),this.parser=void 0,this.currentNode=void 0,!0;default:return!!this.parser&&(this.parser.parseClose(h),!0)}}reconcile(h,f){const p=h.styleId&&f.styles&&f.styles.getStyleModel(h.styleId);switch(p&&(h.style=p),h.styleId!==void 0&&(h.styleId=void 0),h.type){case u.ValueType.String:typeof h.value=="number"&&f.sharedStrings&&(h.value=f.sharedStrings.getString(h.value)),h.value.richText&&(h.type=u.ValueType.RichText);break;case u.ValueType.Number:p&&o.isDateFmt(p.numFmt)&&(h.type=u.ValueType.Date,h.value=o.excelToDate(h.value,f.date1904));break;case u.ValueType.Formula:h.result!==void 0&&p&&o.isDateFmt(p.numFmt)&&(h.result=o.excelToDate(h.result,f.date1904)),h.shareType==="shared"&&(h.ref?f.formulae[h.si]=h.address:(h.sharedFormula=f.formulae[h.si],delete h.shareType),delete h.si)}const v=f.hyperlinkMap[h.address];v&&(h.type===u.ValueType.Formula?(h.text=h.result,h.result=void 0):(h.text=h.value,h.value=void 0),h.type=u.ValueType.Hyperlink,h.hyperlink=v);const g=f.commentsMap&&f.commentsMap[h.address];g&&(h.comment=g)}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],74:[function(t,n,s){const o=t("../../base-xform");n.exports=class extends o{get tag(){return"x14:cfIcon"}render(i,c){i.leafNode(this.tag,{iconSet:c.iconSet,iconId:c.iconId})}parseOpen(i){let{attributes:c}=i;this.model={iconSet:c.iconSet,iconId:o.toIntValue(c.iconId)}}parseClose(i){return i!==this.tag}}},{"../../base-xform":32}],75:[function(t,n,s){const{v4:o}=t("uuid"),i=t("../../base-xform"),c=t("../../composite-xform"),u=t("./databar-ext-xform"),l=t("./icon-set-ext-xform"),d={"3Triangles":!0,"3Stars":!0,"5Boxes":!0};class h extends c{constructor(){super(),this.map={"x14:dataBar":this.databarXform=new u,"x14:iconSet":this.iconSetXform=new l}}get tag(){return"x14:cfRule"}static isExt(p){return p.type==="dataBar"?u.isExt(p):!(p.type!=="iconSet"||!p.custom&&!d[p.iconSet])}prepare(p){h.isExt(p)&&(p.x14Id=`{${o()}}`.toUpperCase())}render(p,v){if(h.isExt(v))switch(v.type){case"dataBar":this.renderDataBar(p,v);break;case"iconSet":this.renderIconSet(p,v)}}renderDataBar(p,v){p.openNode(this.tag,{type:"dataBar",id:v.x14Id}),this.databarXform.render(p,v),p.closeNode()}renderIconSet(p,v){p.openNode(this.tag,{type:"iconSet",priority:v.priority,id:v.x14Id||`{${o()}}`}),this.iconSetXform.render(p,v),p.closeNode()}createNewModel(p){let{attributes:v}=p;return{type:v.type,x14Id:v.id,priority:i.toIntValue(v.priority)}}onParserClose(p,v){Object.assign(this.model,v.model)}}n.exports=h},{"../../base-xform":32,"../../composite-xform":48,"./databar-ext-xform":79,"./icon-set-ext-xform":81,uuid:528}],76:[function(t,n,s){const o=t("../../composite-xform"),i=t("./f-ext-xform");n.exports=class extends o{constructor(){super(),this.map={"xm:f":this.fExtXform=new i}}get tag(){return"x14:cfvo"}render(c,u){c.openNode(this.tag,{type:u.type}),u.value!==void 0&&this.fExtXform.render(c,u.value),c.closeNode()}createNewModel(c){return{type:c.attributes.type}}onParserClose(c,u){switch(c){case"xm:f":this.model.value=u.model?parseFloat(u.model):0}}}},{"../../composite-xform":48,"./f-ext-xform":80}],77:[function(t,n,s){const o=t("../../composite-xform"),i=t("./sqref-ext-xform"),c=t("./cf-rule-ext-xform");n.exports=class extends o{constructor(){super(),this.map={"xm:sqref":this.sqRef=new i,"x14:cfRule":this.cfRule=new c}}get tag(){return"x14:conditionalFormatting"}prepare(u,l){u.rules.forEach(d=>{this.cfRule.prepare(d,l)})}render(u,l){l.rules.some(c.isExt)&&(u.openNode(this.tag,{"xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"}),l.rules.filter(c.isExt).forEach(d=>this.cfRule.render(u,d)),this.sqRef.render(u,l.ref),u.closeNode())}createNewModel(){return{rules:[]}}onParserClose(u,l){switch(u){case"xm:sqref":this.model.ref=l.model;break;case"x14:cfRule":this.model.rules.push(l.model)}}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./sqref-ext-xform":82}],78:[function(t,n,s){const o=t("../../composite-xform"),i=t("./cf-rule-ext-xform"),c=t("./conditional-formatting-ext-xform");n.exports=class extends o{constructor(){super(),this.map={"x14:conditionalFormatting":this.cfXform=new c}}get tag(){return"x14:conditionalFormattings"}hasContent(u){return u.hasExtContent===void 0&&(u.hasExtContent=u.some(l=>l.rules.some(i.isExt))),u.hasExtContent}prepare(u,l){u.forEach(d=>{this.cfXform.prepare(d,l)})}render(u,l){this.hasContent(l)&&(u.openNode(this.tag),l.forEach(d=>this.cfXform.render(u,d)),u.closeNode())}createNewModel(){return[]}onParserClose(u,l){this.model.push(l.model)}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./conditional-formatting-ext-xform":77}],79:[function(t,n,s){const o=t("../../base-xform"),i=t("../../composite-xform"),c=t("../../style/color-xform"),u=t("./cfvo-ext-xform");n.exports=class extends i{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new u,"x14:borderColor":this.borderColorXform=new c("x14:borderColor"),"x14:negativeBorderColor":this.negativeBorderColorXform=new c("x14:negativeBorderColor"),"x14:negativeFillColor":this.negativeFillColorXform=new c("x14:negativeFillColor"),"x14:axisColor":this.axisColorXform=new c("x14:axisColor")}}static isExt(l){return!l.gradient}get tag(){return"x14:dataBar"}render(l,d){l.openNode(this.tag,{minLength:o.toIntAttribute(d.minLength,0,!0),maxLength:o.toIntAttribute(d.maxLength,100,!0),border:o.toBoolAttribute(d.border,!1),gradient:o.toBoolAttribute(d.gradient,!0),negativeBarColorSameAsPositive:o.toBoolAttribute(d.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:o.toBoolAttribute(d.negativeBarBorderColorSameAsPositive,!0),axisPosition:o.toAttribute(d.axisPosition,"auto"),direction:o.toAttribute(d.direction,"leftToRight")}),d.cfvo.forEach(h=>{this.cfvoXform.render(l,h)}),this.borderColorXform.render(l,d.borderColor),this.negativeBorderColorXform.render(l,d.negativeBorderColor),this.negativeFillColorXform.render(l,d.negativeFillColor),this.axisColorXform.render(l,d.axisColor),l.closeNode()}createNewModel(l){let{attributes:d}=l;return{cfvo:[],minLength:o.toIntValue(d.minLength,0),maxLength:o.toIntValue(d.maxLength,100),border:o.toBoolValue(d.border,!1),gradient:o.toBoolValue(d.gradient,!0),negativeBarColorSameAsPositive:o.toBoolValue(d.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:o.toBoolValue(d.negativeBarBorderColorSameAsPositive,!0),axisPosition:o.toStringValue(d.axisPosition,"auto"),direction:o.toStringValue(d.direction,"leftToRight")}}onParserClose(l,d){const[,h]=l.split(":");switch(h){case"cfvo":this.model.cfvo.push(d.model);break;default:this.model[h]=d.model}}}},{"../../base-xform":32,"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-ext-xform":76}],80:[function(t,n,s){const o=t("../../base-xform");n.exports=class extends o{get tag(){return"xm:f"}render(i,c){i.leafNode(this.tag,null,c)}parseOpen(){this.model=""}parseText(i){this.model+=i}parseClose(i){return i!==this.tag}}},{"../../base-xform":32}],81:[function(t,n,s){const o=t("../../base-xform"),i=t("../../composite-xform"),c=t("./cfvo-ext-xform"),u=t("./cf-icon-ext-xform");n.exports=class extends i{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new c,"x14:cfIcon":this.cfIconXform=new u}}get tag(){return"x14:iconSet"}render(l,d){l.openNode(this.tag,{iconSet:o.toStringAttribute(d.iconSet),reverse:o.toBoolAttribute(d.reverse,!1),showValue:o.toBoolAttribute(d.showValue,!0),custom:o.toBoolAttribute(d.icons,!1)}),d.cfvo.forEach(h=>{this.cfvoXform.render(l,h)}),d.icons&&d.icons.forEach((h,f)=>{h.iconId=f,this.cfIconXform.render(l,h)}),l.closeNode()}createNewModel(l){let{attributes:d}=l;return{cfvo:[],iconSet:o.toStringValue(d.iconSet,"3TrafficLights"),reverse:o.toBoolValue(d.reverse,!1),showValue:o.toBoolValue(d.showValue,!0)}}onParserClose(l,d){const[,h]=l.split(":");switch(h){case"cfvo":this.model.cfvo.push(d.model);break;case"cfIcon":this.model.icons||(this.model.icons=[]),this.model.icons.push(d.model);break;default:this.model[h]=d.model}}}},{"../../base-xform":32,"../../composite-xform":48,"./cf-icon-ext-xform":74,"./cfvo-ext-xform":76}],82:[function(t,n,s){const o=t("../../base-xform");n.exports=class extends o{get tag(){return"xm:sqref"}render(i,c){i.leafNode(this.tag,null,c)}parseOpen(){this.model=""}parseText(i){this.model+=i}parseClose(i){return i!==this.tag}}},{"../../base-xform":32}],83:[function(t,n,s){const o=t("../../base-xform"),i=t("../../composite-xform"),c=t("../../../../doc/range"),u=t("./databar-xform"),l=t("./ext-lst-ref-xform"),d=t("./formula-xform"),h=t("./color-scale-xform"),f=t("./icon-set-xform"),p={"3Triangles":!0,"3Stars":!0,"5Boxes":!0},v=m=>{const{type:b,operator:y}=m;switch(b){case"containsText":case"containsBlanks":case"notContainsBlanks":case"containsErrors":case"notContainsErrors":return{type:"containsText",operator:b};default:return{type:b,operator:y}}};class g extends i{constructor(){super(),this.map={dataBar:this.databarXform=new u,extLst:this.extLstRefXform=new l,formula:this.formulaXform=new d,colorScale:this.colorScaleXform=new h,iconSet:this.iconSetXform=new f}}get tag(){return"cfRule"}static isPrimitive(b){return b.type!=="iconSet"||!b.custom&&!p[b.iconSet]}render(b,y){switch(y.type){case"expression":this.renderExpression(b,y);break;case"cellIs":this.renderCellIs(b,y);break;case"top10":this.renderTop10(b,y);break;case"aboveAverage":this.renderAboveAverage(b,y);break;case"dataBar":this.renderDataBar(b,y);break;case"colorScale":this.renderColorScale(b,y);break;case"iconSet":this.renderIconSet(b,y);break;case"containsText":this.renderText(b,y);break;case"timePeriod":this.renderTimePeriod(b,y)}}renderExpression(b,y){b.openNode(this.tag,{type:"expression",dxfId:y.dxfId,priority:y.priority}),this.formulaXform.render(b,y.formulae[0]),b.closeNode()}renderCellIs(b,y){b.openNode(this.tag,{type:"cellIs",dxfId:y.dxfId,priority:y.priority,operator:y.operator}),y.formulae.forEach(S=>{this.formulaXform.render(b,S)}),b.closeNode()}renderTop10(b,y){b.leafNode(this.tag,{type:"top10",dxfId:y.dxfId,priority:y.priority,percent:o.toBoolAttribute(y.percent,!1),bottom:o.toBoolAttribute(y.bottom,!1),rank:o.toIntValue(y.rank,10,!0)})}renderAboveAverage(b,y){b.leafNode(this.tag,{type:"aboveAverage",dxfId:y.dxfId,priority:y.priority,aboveAverage:o.toBoolAttribute(y.aboveAverage,!0)})}renderDataBar(b,y){b.openNode(this.tag,{type:"dataBar",priority:y.priority}),this.databarXform.render(b,y),this.extLstRefXform.render(b,y),b.closeNode()}renderColorScale(b,y){b.openNode(this.tag,{type:"colorScale",priority:y.priority}),this.colorScaleXform.render(b,y),b.closeNode()}renderIconSet(b,y){g.isPrimitive(y)&&(b.openNode(this.tag,{type:"iconSet",priority:y.priority}),this.iconSetXform.render(b,y),b.closeNode())}renderText(b,y){b.openNode(this.tag,{type:y.operator,dxfId:y.dxfId,priority:y.priority,operator:o.toStringAttribute(y.operator,"containsText")});const S=(C=>{if(C.formulae&&C.formulae[0])return C.formulae[0];const L=new c(C.ref),{tl:O}=L;switch(C.operator){case"containsText":return`NOT(ISERROR(SEARCH("${C.text}",${O})))`;case"containsBlanks":return`LEN(TRIM(${O}))=0`;case"notContainsBlanks":return`LEN(TRIM(${O}))>0`;case"containsErrors":return`ISERROR(${O})`;case"notContainsErrors":return`NOT(ISERROR(${O}))`;default:return}})(y);S&&this.formulaXform.render(b,S),b.closeNode()}renderTimePeriod(b,y){b.openNode(this.tag,{type:"timePeriod",dxfId:y.dxfId,priority:y.priority,timePeriod:y.timePeriod});const S=(C=>{if(C.formulae&&C.formulae[0])return C.formulae[0];const L=new c(C.ref),{tl:O}=L;switch(C.timePeriod){case"thisWeek":return`AND(TODAY()-ROUNDDOWN(${O},0)<=WEEKDAY(TODAY())-1,ROUNDDOWN(${O},0)-TODAY()<=7-WEEKDAY(TODAY()))`;case"lastWeek":return`AND(TODAY()-ROUNDDOWN(${O},0)>=(WEEKDAY(TODAY())),TODAY()-ROUNDDOWN(${O},0)<(WEEKDAY(TODAY())+7))`;case"nextWeek":return`AND(ROUNDDOWN(${O},0)-TODAY()>(7-WEEKDAY(TODAY())),ROUNDDOWN(${O},0)-TODAY()<(15-WEEKDAY(TODAY())))`;case"yesterday":return`FLOOR(${O},1)=TODAY()-1`;case"today":return`FLOOR(${O},1)=TODAY()`;case"tomorrow":return`FLOOR(${O},1)=TODAY()+1`;case"last7Days":return`AND(TODAY()-FLOOR(${O},1)<=6,FLOOR(${O},1)<=TODAY())`;case"lastMonth":return`AND(MONTH(${O})=MONTH(EDATE(TODAY(),0-1)),YEAR(${O})=YEAR(EDATE(TODAY(),0-1)))`;case"thisMonth":return`AND(MONTH(${O})=MONTH(TODAY()),YEAR(${O})=YEAR(TODAY()))`;case"nextMonth":return`AND(MONTH(${O})=MONTH(EDATE(TODAY(),0+1)),YEAR(${O})=YEAR(EDATE(TODAY(),0+1)))`;default:return}})(y);S&&this.formulaXform.render(b,S),b.closeNode()}createNewModel(b){let{attributes:y}=b;return{...v(y),dxfId:o.toIntValue(y.dxfId),priority:o.toIntValue(y.priority),timePeriod:y.timePeriod,percent:o.toBoolValue(y.percent),bottom:o.toBoolValue(y.bottom),rank:o.toIntValue(y.rank),aboveAverage:o.toBoolValue(y.aboveAverage)}}onParserClose(b,y){switch(b){case"dataBar":case"extLst":case"colorScale":case"iconSet":Object.assign(this.model,y.model);break;case"formula":this.model.formulae=this.model.formulae||[],this.model.formulae.push(y.model)}}}n.exports=g},{"../../../../doc/range":10,"../../base-xform":32,"../../composite-xform":48,"./color-scale-xform":85,"./databar-xform":88,"./ext-lst-ref-xform":89,"./formula-xform":90,"./icon-set-xform":91}],84:[function(t,n,s){const o=t("../../base-xform");n.exports=class extends o{get tag(){return"cfvo"}render(i,c){i.leafNode(this.tag,{type:c.type,val:c.value})}parseOpen(i){this.model={type:i.attributes.type,value:o.toFloatValue(i.attributes.val)}}parseClose(i){return i!==this.tag}}},{"../../base-xform":32}],85:[function(t,n,s){const o=t("../../composite-xform"),i=t("../../style/color-xform"),c=t("./cfvo-xform");n.exports=class extends o{constructor(){super(),this.map={cfvo:this.cfvoXform=new c,color:this.colorXform=new i}}get tag(){return"colorScale"}render(u,l){u.openNode(this.tag),l.cfvo.forEach(d=>{this.cfvoXform.render(u,d)}),l.color.forEach(d=>{this.colorXform.render(u,d)}),u.closeNode()}createNewModel(u){return{cfvo:[],color:[]}}onParserClose(u,l){this.model[u].push(l.model)}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],86:[function(t,n,s){const o=t("../../composite-xform"),i=t("./cf-rule-xform");n.exports=class extends o{constructor(){super(),this.map={cfRule:new i}}get tag(){return"conditionalFormatting"}render(c,u){u.rules.some(i.isPrimitive)&&(c.openNode(this.tag,{sqref:u.ref}),u.rules.forEach(l=>{i.isPrimitive(l)&&(l.ref=u.ref,this.map.cfRule.render(c,l))}),c.closeNode())}createNewModel(c){let{attributes:u}=c;return{ref:u.sqref,rules:[]}}onParserClose(c,u){this.model.rules.push(u.model)}}},{"../../composite-xform":48,"./cf-rule-xform":83}],87:[function(t,n,s){const o=t("../../base-xform"),i=t("./conditional-formatting-xform");n.exports=class extends o{constructor(){super(),this.cfXform=new i}get tag(){return"conditionalFormatting"}reset(){this.model=[]}prepare(c,u){let l=c.reduce((d,h)=>Math.max(d,...h.rules.map(f=>f.priority||0)),1);c.forEach(d=>{d.rules.forEach(h=>{h.priority||(h.priority=l++),h.style&&(h.dxfId=u.styles.addDxfStyle(h.style))})})}render(c,u){u.forEach(l=>{this.cfXform.render(c,l)})}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case"conditionalFormatting":return this.parser=this.cfXform,this.parser.parseOpen(c),!0;default:return!1}}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){return!!this.parser&&(!!this.parser.parseClose(c)||(this.model.push(this.parser.model),this.parser=void 0,!1))}reconcile(c,u){c.forEach(l=>{l.rules.forEach(d=>{d.dxfId!==void 0&&(d.style=u.styles.getDxfStyle(d.dxfId),delete d.dxfId)})})}}},{"../../base-xform":32,"./conditional-formatting-xform":86}],88:[function(t,n,s){const o=t("../../composite-xform"),i=t("../../style/color-xform"),c=t("./cfvo-xform");n.exports=class extends o{constructor(){super(),this.map={cfvo:this.cfvoXform=new c,color:this.colorXform=new i}}get tag(){return"dataBar"}render(u,l){u.openNode(this.tag),l.cfvo.forEach(d=>{this.cfvoXform.render(u,d)}),this.colorXform.render(u,l.color),u.closeNode()}createNewModel(){return{cfvo:[]}}onParserClose(u,l){switch(u){case"cfvo":this.model.cfvo.push(l.model);break;case"color":this.model.color=l.model}}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],89:[function(t,n,s){const o=t("../../base-xform"),i=t("../../composite-xform");class c extends o{get tag(){return"x14:id"}render(d,h){d.leafNode(this.tag,null,h)}parseOpen(){this.model=""}parseText(d){this.model+=d}parseClose(d){return d!==this.tag}}class u extends i{constructor(){super(),this.map={"x14:id":this.idXform=new c}}get tag(){return"ext"}render(d,h){d.openNode(this.tag,{uri:"{B025F937-C7B1-47D3-B67F-A62EFF666E3E}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.idXform.render(d,h.x14Id),d.closeNode()}createNewModel(){return{}}onParserClose(d,h){this.model.x14Id=h.model}}n.exports=class extends i{constructor(){super(),this.map={ext:new u}}get tag(){return"extLst"}render(l,d){l.openNode(this.tag),this.map.ext.render(l,d),l.closeNode()}createNewModel(){return{}}onParserClose(l,d){Object.assign(this.model,d.model)}}},{"../../base-xform":32,"../../composite-xform":48}],90:[function(t,n,s){const o=t("../../base-xform");n.exports=class extends o{get tag(){return"formula"}render(i,c){i.leafNode(this.tag,null,c)}parseOpen(){this.model=""}parseText(i){this.model+=i}parseClose(i){return i!==this.tag}}},{"../../base-xform":32}],91:[function(t,n,s){const o=t("../../base-xform"),i=t("../../composite-xform"),c=t("./cfvo-xform");n.exports=class extends i{constructor(){super(),this.map={cfvo:this.cfvoXform=new c}}get tag(){return"iconSet"}render(u,l){u.openNode(this.tag,{iconSet:o.toStringAttribute(l.iconSet,"3TrafficLights"),reverse:o.toBoolAttribute(l.reverse,!1),showValue:o.toBoolAttribute(l.showValue,!0)}),l.cfvo.forEach(d=>{this.cfvoXform.render(u,d)}),u.closeNode()}createNewModel(u){let{attributes:l}=u;return{iconSet:o.toStringValue(l.iconSet,"3TrafficLights"),reverse:o.toBoolValue(l.reverse),showValue:o.toBoolValue(l.showValue),cfvo:[]}}onParserClose(u,l){this.model[u].push(l.model)}}},{"../../base-xform":32,"../../composite-xform":48,"./cfvo-xform":84}],92:[function(t,n,s){const o=t("../../../utils/utils"),i=t("../base-xform");n.exports=class extends i{get tag(){return"col"}prepare(c,u){const l=u.styles.addStyleModel(c.style||{});l&&(c.styleId=l)}render(c,u){c.openNode("col"),c.addAttribute("min",u.min),c.addAttribute("max",u.max),u.width&&c.addAttribute("width",u.width),u.styleId&&c.addAttribute("style",u.styleId),u.hidden&&c.addAttribute("hidden","1"),u.bestFit&&c.addAttribute("bestFit","1"),u.outlineLevel&&c.addAttribute("outlineLevel",u.outlineLevel),u.collapsed&&c.addAttribute("collapsed","1"),c.addAttribute("customWidth","1"),c.closeNode()}parseOpen(c){if(c.name==="col"){const u=this.model={min:parseInt(c.attributes.min||"0",10),max:parseInt(c.attributes.max||"0",10),width:c.attributes.width===void 0?void 0:parseFloat(c.attributes.width||"0")};return c.attributes.style&&(u.styleId=parseInt(c.attributes.style,10)),o.parseBoolean(c.attributes.hidden)&&(u.hidden=!0),o.parseBoolean(c.attributes.bestFit)&&(u.bestFit=!0),c.attributes.outlineLevel&&(u.outlineLevel=parseInt(c.attributes.outlineLevel,10)),o.parseBoolean(c.attributes.collapsed)&&(u.collapsed=!0),!0}return!1}parseText(){}parseClose(){return!1}reconcile(c,u){c.styleId&&(c.style=u.styles.getStyleModel(c.styleId))}}},{"../../../utils/utils":27,"../base-xform":32}],93:[function(t,n,s){const o=t("../../../utils/under-dash"),i=t("../../../utils/utils"),c=t("../../../utils/col-cache"),u=t("../base-xform"),l=t("../../../doc/range");function d(f,p,v,g){const m=p[v];m!==void 0?f[v]=m:g!==void 0&&(f[v]=g)}function h(f,p,v,g){const m=p[v];m!==void 0&&(f[v]=i.parseBoolean(m))}n.exports=class extends u{get tag(){return"dataValidations"}render(f,p){const v=function(g){const m=o.map(g,(S,C)=>({address:C,dataValidation:S,marked:!1})).sort((S,C)=>o.strcmp(S.address,C.address)),b=o.keyBy(m,"address"),y=(S,C,L)=>{for(let O=0;O<C;O++){const H=c.encodeAddress(S.row+O,L);if(!g[H]||!o.isEqual(g[S.address],g[H]))return!1}return!0};return m.map(S=>{if(!S.marked){const C=c.decodeEx(S.address);if(C.dimensions)return b[C.dimensions].marked=!0,{...S.dataValidation,sqref:S.address};let L=1,O=c.encodeAddress(C.row+L,C.col);for(;g[O]&&o.isEqual(S.dataValidation,g[O]);)L++,O=c.encodeAddress(C.row+L,C.col);let H=1;for(;y(C,L,C.col+H);)H++;for(let z=0;z<L;z++)for(let q=0;q<H;q++)O=c.encodeAddress(C.row+z,C.col+q),b[O].marked=!0;if(L>1||H>1){const z=C.row+(L-1),q=C.col+(H-1);return{...S.dataValidation,sqref:`${S.address}:${c.encodeAddress(z,q)}`}}return{...S.dataValidation,sqref:S.address}}return null}).filter(Boolean)}(p);v.length&&(f.openNode("dataValidations",{count:v.length}),v.forEach(g=>{f.openNode("dataValidation"),g.type!=="any"&&(f.addAttribute("type",g.type),g.operator&&g.type!=="list"&&g.operator!=="between"&&f.addAttribute("operator",g.operator),g.allowBlank&&f.addAttribute("allowBlank","1")),g.showInputMessage&&f.addAttribute("showInputMessage","1"),g.promptTitle&&f.addAttribute("promptTitle",g.promptTitle),g.prompt&&f.addAttribute("prompt",g.prompt),g.showErrorMessage&&f.addAttribute("showErrorMessage","1"),g.errorStyle&&f.addAttribute("errorStyle",g.errorStyle),g.errorTitle&&f.addAttribute("errorTitle",g.errorTitle),g.error&&f.addAttribute("error",g.error),f.addAttribute("sqref",g.sqref),(g.formulae||[]).forEach((m,b)=>{f.openNode("formula"+(b+1)),g.type==="date"?f.writeText(i.dateToExcel(new Date(m))):f.writeText(m),f.closeNode()}),f.closeNode()}),f.closeNode())}parseOpen(f){switch(f.name){case"dataValidations":return this.model={},!0;case"dataValidation":{this._address=f.attributes.sqref;const p={type:f.attributes.type||"any",formulae:[]};switch(f.attributes.type&&h(p,f.attributes,"allowBlank"),h(p,f.attributes,"showInputMessage"),h(p,f.attributes,"showErrorMessage"),p.type){case"any":case"list":case"custom":break;default:d(p,f.attributes,"operator","between")}return d(p,f.attributes,"promptTitle"),d(p,f.attributes,"prompt"),d(p,f.attributes,"errorStyle"),d(p,f.attributes,"errorTitle"),d(p,f.attributes,"error"),this._dataValidation=p,!0}case"formula1":case"formula2":return this._formula=[],!0;default:return!1}}parseText(f){this._formula&&this._formula.push(f)}parseClose(f){switch(f){case"dataValidations":return!1;case"dataValidation":return this._dataValidation.formulae&&this._dataValidation.formulae.length||(delete this._dataValidation.formulae,delete this._dataValidation.operator),(this._address.split(/\s+/g)||[]).forEach(p=>{p.includes(":")?new l(p).forEachAddress(v=>{this.model[v]=this._dataValidation}):this.model[p]=this._dataValidation}),!0;case"formula1":case"formula2":{let p=this._formula.join("");switch(this._dataValidation.type){case"whole":case"textLength":p=parseInt(p,10);break;case"decimal":p=parseFloat(p);break;case"date":p=i.excelToDate(parseFloat(p))}return this._dataValidation.formulae.push(p),this._formula=void 0,!0}default:return!0}}}},{"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/utils":27,"../base-xform":32}],94:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{get tag(){return"dimension"}render(i,c){c&&i.leafNode("dimension",{ref:c})}parseOpen(i){return i.name==="dimension"&&(this.model=i.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],95:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{get tag(){return"drawing"}render(i,c){c&&i.leafNode(this.tag,{"r:id":c.rId})}parseOpen(i){switch(i.name){case this.tag:return this.model={rId:i.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],96:[function(t,n,s){const o=t("../composite-xform"),i=t("./cf-ext/conditional-formattings-ext-xform");class c extends o{constructor(){super(),this.map={"x14:conditionalFormattings":this.conditionalFormattings=new i}}get tag(){return"ext"}hasContent(l){return this.conditionalFormattings.hasContent(l.conditionalFormattings)}prepare(l,d){this.conditionalFormattings.prepare(l.conditionalFormattings,d)}render(l,d){l.openNode("ext",{uri:"{78C0D931-6437-407d-A8EE-F0AAD7539E65}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.conditionalFormattings.render(l,d.conditionalFormattings),l.closeNode()}createNewModel(){return{}}onParserClose(l,d){this.model[l]=d.model}}n.exports=class extends o{constructor(){super(),this.map={ext:this.ext=new c}}get tag(){return"extLst"}prepare(u,l){this.ext.prepare(u,l)}hasContent(u){return this.ext.hasContent(u)}render(u,l){this.hasContent(l)&&(u.openNode("extLst"),this.ext.render(u,l),u.closeNode())}createNewModel(){return{}}onParserClose(u,l){Object.assign(this.model,l.model)}}},{"../composite-xform":48,"./cf-ext/conditional-formattings-ext-xform":78}],97:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{get tag(){return"headerFooter"}render(i,c){if(c){i.addRollback();let u=!1;i.openNode("headerFooter"),c.differentFirst&&(i.addAttribute("differentFirst","1"),u=!0),c.differentOddEven&&(i.addAttribute("differentOddEven","1"),u=!0),c.oddHeader&&typeof c.oddHeader=="string"&&(i.leafNode("oddHeader",null,c.oddHeader),u=!0),c.oddFooter&&typeof c.oddFooter=="string"&&(i.leafNode("oddFooter",null,c.oddFooter),u=!0),c.evenHeader&&typeof c.evenHeader=="string"&&(i.leafNode("evenHeader",null,c.evenHeader),u=!0),c.evenFooter&&typeof c.evenFooter=="string"&&(i.leafNode("evenFooter",null,c.evenFooter),u=!0),c.firstHeader&&typeof c.firstHeader=="string"&&(i.leafNode("firstHeader",null,c.firstHeader),u=!0),c.firstFooter&&typeof c.firstFooter=="string"&&(i.leafNode("firstFooter",null,c.firstFooter),u=!0),u?(i.closeNode(),i.commit()):i.rollback()}}parseOpen(i){switch(i.name){case"headerFooter":return this.model={},i.attributes.differentFirst&&(this.model.differentFirst=parseInt(i.attributes.differentFirst,0)===1),i.attributes.differentOddEven&&(this.model.differentOddEven=parseInt(i.attributes.differentOddEven,0)===1),!0;case"oddHeader":return this.currentNode="oddHeader",!0;case"oddFooter":return this.currentNode="oddFooter",!0;case"evenHeader":return this.currentNode="evenHeader",!0;case"evenFooter":return this.currentNode="evenFooter",!0;case"firstHeader":return this.currentNode="firstHeader",!0;case"firstFooter":return this.currentNode="firstFooter",!0;default:return!1}}parseText(i){switch(this.currentNode){case"oddHeader":this.model.oddHeader=i;break;case"oddFooter":this.model.oddFooter=i;break;case"evenHeader":this.model.evenHeader=i;break;case"evenFooter":this.model.evenFooter=i;break;case"firstHeader":this.model.firstHeader=i;break;case"firstFooter":this.model.firstFooter=i}}parseClose(){switch(this.currentNode){case"oddHeader":case"oddFooter":case"evenHeader":case"evenFooter":case"firstHeader":case"firstFooter":return this.currentNode=void 0,!0;default:return!1}}}},{"../base-xform":32}],98:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{get tag(){return"hyperlink"}render(i,c){this.isInternalLink(c)?i.leafNode("hyperlink",{ref:c.address,"r:id":c.rId,tooltip:c.tooltip,location:c.target}):i.leafNode("hyperlink",{ref:c.address,"r:id":c.rId,tooltip:c.tooltip})}parseOpen(i){return i.name==="hyperlink"&&(this.model={address:i.attributes.ref,rId:i.attributes["r:id"],tooltip:i.attributes.tooltip},i.attributes.location&&(this.model.target=i.attributes.location),!0)}parseText(){}parseClose(){return!1}isInternalLink(i){return i.target&&/^[^!]+![a-zA-Z]+[\d]+$/.test(i.target)}}},{"../base-xform":32}],99:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{get tag(){return"mergeCell"}render(i,c){i.leafNode("mergeCell",{ref:c})}parseOpen(i){return i.name==="mergeCell"&&(this.model=i.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],100:[function(t,n,s){const o=t("../../../utils/under-dash"),i=t("../../../doc/range"),c=t("../../../utils/col-cache"),u=t("../../../doc/enums");n.exports=class{constructor(){this.merges={}}add(l){if(this.merges[l.master])this.merges[l.master].expandToAddress(l.address);else{const d=`${l.master}:${l.address}`;this.merges[l.master]=new i(d)}}get mergeCells(){return o.map(this.merges,l=>l.range)}reconcile(l,d){o.each(l,h=>{const f=c.decode(h);for(let p=f.top;p<=f.bottom;p++){const v=d[p-1];for(let g=f.left;g<=f.right;g++){const m=v.cells[g-1];m?m.type===u.ValueType.Merge&&(m.master=f.tl):v.cells[g]={type:u.ValueType.Null,address:c.encodeAddress(p,g)}}}})}getMasterAddress(l){const d=this.hash[l];return d&&d.tl}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26}],101:[function(t,n,s){const o=t("../base-xform"),i=c=>c!==void 0;n.exports=class extends o{get tag(){return"outlinePr"}render(c,u){return!(!u||!i(u.summaryBelow)&&!i(u.summaryRight))&&(c.leafNode(this.tag,{summaryBelow:i(u.summaryBelow)?Number(u.summaryBelow):void 0,summaryRight:i(u.summaryRight)?Number(u.summaryRight):void 0}),!0)}parseOpen(c){return c.name===this.tag&&(this.model={summaryBelow:i(c.attributes.summaryBelow)?!!Number(c.attributes.summaryBelow):void 0,summaryRight:i(c.attributes.summaryRight)?!!Number(c.attributes.summaryRight):void 0},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],102:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{get tag(){return"brk"}render(i,c){i.leafNode("brk",c)}parseOpen(i){return i.name==="brk"&&(this.model=i.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],103:[function(t,n,s){const o=t("../../../utils/under-dash"),i=t("../base-xform");n.exports=class extends i{get tag(){return"pageMargins"}render(c,u){if(u){const l={left:u.left,right:u.right,top:u.top,bottom:u.bottom,header:u.header,footer:u.footer};o.some(l,d=>d!==void 0)&&c.leafNode(this.tag,l)}}parseOpen(c){switch(c.name){case this.tag:return this.model={left:parseFloat(c.attributes.left||.7),right:parseFloat(c.attributes.right||.7),top:parseFloat(c.attributes.top||.75),bottom:parseFloat(c.attributes.bottom||.75),header:parseFloat(c.attributes.header||.3),footer:parseFloat(c.attributes.footer||.3)},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],104:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{get tag(){return"pageSetUpPr"}render(i,c){return!(!c||!c.fitToPage)&&(i.leafNode(this.tag,{fitToPage:c.fitToPage?"1":void 0}),!0)}parseOpen(i){return i.name===this.tag&&(this.model={fitToPage:i.attributes.fitToPage==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],105:[function(t,n,s){const o=t("../../../utils/under-dash"),i=t("../base-xform");function c(h){return h?"1":void 0}function u(h){switch(h){case"overThenDown":return h;default:return}}function l(h){switch(h){case"atEnd":case"asDisplyed":return h;default:return}}function d(h){switch(h){case"dash":case"blank":case"NA":return h;default:return}}n.exports=class extends i{get tag(){return"pageSetup"}render(h,f){if(f){const p={paperSize:f.paperSize,orientation:f.orientation,horizontalDpi:f.horizontalDpi,verticalDpi:f.verticalDpi,pageOrder:u(f.pageOrder),blackAndWhite:c(f.blackAndWhite),draft:c(f.draft),cellComments:l(f.cellComments),errors:d(f.errors),scale:f.scale,fitToWidth:f.fitToWidth,fitToHeight:f.fitToHeight,firstPageNumber:f.firstPageNumber,useFirstPageNumber:c(f.firstPageNumber),usePrinterDefaults:c(f.usePrinterDefaults),copies:f.copies};o.some(p,v=>v!==void 0)&&h.leafNode(this.tag,p)}}parseOpen(h){switch(h.name){case this.tag:return this.model={paperSize:(f=h.attributes.paperSize,f!==void 0?parseInt(f,10):void 0),orientation:h.attributes.orientation||"portrait",horizontalDpi:parseInt(h.attributes.horizontalDpi||"4294967295",10),verticalDpi:parseInt(h.attributes.verticalDpi||"4294967295",10),pageOrder:h.attributes.pageOrder||"downThenOver",blackAndWhite:h.attributes.blackAndWhite==="1",draft:h.attributes.draft==="1",cellComments:h.attributes.cellComments||"None",errors:h.attributes.errors||"displayed",scale:parseInt(h.attributes.scale||"100",10),fitToWidth:parseInt(h.attributes.fitToWidth||"1",10),fitToHeight:parseInt(h.attributes.fitToHeight||"1",10),firstPageNumber:parseInt(h.attributes.firstPageNumber||"1",10),useFirstPageNumber:h.attributes.useFirstPageNumber==="1",usePrinterDefaults:h.attributes.usePrinterDefaults==="1",copies:parseInt(h.attributes.copies||"1",10)},!0;default:return!1}var f}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],106:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{get tag(){return"picture"}render(i,c){c&&i.leafNode(this.tag,{"r:id":c.rId})}parseOpen(i){switch(i.name){case this.tag:return this.model={rId:i.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],107:[function(t,n,s){const o=t("../../../utils/under-dash"),i=t("../base-xform");function c(u){return u?"1":void 0}n.exports=class extends i{get tag(){return"printOptions"}render(u,l){if(l){const d={headings:c(l.showRowColHeaders),gridLines:c(l.showGridLines),horizontalCentered:c(l.horizontalCentered),verticalCentered:c(l.verticalCentered)};o.some(d,h=>h!==void 0)&&u.leafNode(this.tag,d)}}parseOpen(u){switch(u.name){case this.tag:return this.model={showRowColHeaders:u.attributes.headings==="1",showGridLines:u.attributes.gridLines==="1",horizontalCentered:u.attributes.horizontalCentered==="1",verticalCentered:u.attributes.verticalCentered==="1"},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],108:[function(t,n,s){const o=t("./page-breaks-xform"),i=t("../list-xform");n.exports=class extends i{constructor(){super({tag:"rowBreaks",count:!0,childXform:new o})}render(c,u){if(u&&u.length){c.openNode(this.tag,this.$),this.count&&(c.addAttribute(this.$count,u.length),c.addAttribute("manualBreakCount",u.length));const{childXform:l}=this;u.forEach(d=>{l.render(c,d)}),c.closeNode()}else this.empty&&c.leafNode(this.tag)}}},{"../list-xform":71,"./page-breaks-xform":102}],109:[function(t,n,s){const o=t("../base-xform"),i=t("../../../utils/utils"),c=t("./cell-xform");n.exports=class extends o{constructor(u){super(),this.maxItems=u&&u.maxItems,this.map={c:new c}}get tag(){return"row"}prepare(u,l){const d=l.styles.addStyleModel(u.style);d&&(u.styleId=d);const h=this.map.c;u.cells.forEach(f=>{h.prepare(f,l)})}render(u,l,d){u.openNode("row"),u.addAttribute("r",l.number),l.height&&(u.addAttribute("ht",l.height),u.addAttribute("customHeight","1")),l.hidden&&u.addAttribute("hidden","1"),l.min>0&&l.max>0&&l.min<=l.max&&u.addAttribute("spans",`${l.min}:${l.max}`),l.styleId&&(u.addAttribute("s",l.styleId),u.addAttribute("customFormat","1")),u.addAttribute("x14ac:dyDescent","0.25"),l.outlineLevel&&u.addAttribute("outlineLevel",l.outlineLevel),l.collapsed&&u.addAttribute("collapsed","1");const h=this.map.c;l.cells.forEach(f=>{h.render(u,f,d)}),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;if(u.name==="row"){this.numRowsSeen+=1;const l=u.attributes.spans?u.attributes.spans.split(":").map(h=>parseInt(h,10)):[void 0,void 0],d=this.model={number:parseInt(u.attributes.r,10),min:l[0],max:l[1],cells:[]};return u.attributes.s&&(d.styleId=parseInt(u.attributes.s,10)),i.parseBoolean(u.attributes.hidden)&&(d.hidden=!0),i.parseBoolean(u.attributes.bestFit)&&(d.bestFit=!0),u.attributes.ht&&(d.height=parseFloat(u.attributes.ht)),u.attributes.outlineLevel&&(d.outlineLevel=parseInt(u.attributes.outlineLevel,10)),i.parseBoolean(u.attributes.collapsed)&&(d.collapsed=!0),!0}return this.parser=this.map[u.name],!!this.parser&&(this.parser.parseOpen(u),!0)}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser){if(!this.parser.parseClose(u)){if(this.model.cells.push(this.parser.model),this.maxItems&&this.model.cells.length>this.maxItems)throw new Error(`Max column count (${this.maxItems}) exceeded`);this.parser=void 0}return!0}return!1}reconcile(u,l){u.style=u.styleId?l.styles.getStyleModel(u.styleId):{},u.styleId!==void 0&&(u.styleId=void 0);const d=this.map.c;u.cells.forEach(h=>{d.reconcile(h,l)})}}},{"../../../utils/utils":27,"../base-xform":32,"./cell-xform":73}],110:[function(t,n,s){const o=t("../../../utils/under-dash"),i=t("../base-xform");n.exports=class extends i{get tag(){return"sheetFormatPr"}render(c,u){if(u){const l={defaultRowHeight:u.defaultRowHeight,outlineLevelRow:u.outlineLevelRow,outlineLevelCol:u.outlineLevelCol,"x14ac:dyDescent":u.dyDescent};u.defaultColWidth&&(l.defaultColWidth=u.defaultColWidth),u.defaultRowHeight&&u.defaultRowHeight===15||(l.customHeight="1"),o.some(l,d=>d!==void 0)&&c.leafNode("sheetFormatPr",l)}}parseOpen(c){return c.name==="sheetFormatPr"&&(this.model={defaultRowHeight:parseFloat(c.attributes.defaultRowHeight||"0"),dyDescent:parseFloat(c.attributes["x14ac:dyDescent"]||"0"),outlineLevelRow:parseInt(c.attributes.outlineLevelRow||"0",10),outlineLevelCol:parseInt(c.attributes.outlineLevelCol||"0",10)},c.attributes.defaultColWidth&&(this.model.defaultColWidth=parseFloat(c.attributes.defaultColWidth)),!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],111:[function(t,n,s){const o=t("../base-xform"),i=t("../style/color-xform"),c=t("./page-setup-properties-xform"),u=t("./outline-properties-xform");n.exports=class extends o{constructor(){super(),this.map={tabColor:new i("tabColor"),pageSetUpPr:new c,outlinePr:new u}}get tag(){return"sheetPr"}render(l,d){if(d){l.addRollback(),l.openNode("sheetPr");let h=!1;h=this.map.tabColor.render(l,d.tabColor)||h,h=this.map.pageSetUpPr.render(l,d.pageSetup)||h,h=this.map.outlinePr.render(l,d.outlineProperties)||h,h?(l.closeNode(),l.commit()):l.rollback()}}parseOpen(l){return this.parser?(this.parser.parseOpen(l),!0):l.name===this.tag?(this.reset(),!0):!!this.map[l.name]&&(this.parser=this.map[l.name],this.parser.parseOpen(l),!0)}parseText(l){return!!this.parser&&(this.parser.parseText(l),!0)}parseClose(l){return this.parser?(this.parser.parseClose(l)||(this.parser=void 0),!0):(this.map.tabColor.model||this.map.pageSetUpPr.model||this.map.outlinePr.model?(this.model={},this.map.tabColor.model&&(this.model.tabColor=this.map.tabColor.model),this.map.pageSetUpPr.model&&(this.model.pageSetup=this.map.pageSetUpPr.model),this.map.outlinePr.model&&(this.model.outlineProperties=this.map.outlinePr.model)):this.model=null,!1)}}},{"../base-xform":32,"../style/color-xform":128,"./outline-properties-xform":101,"./page-setup-properties-xform":104}],112:[function(t,n,s){const o=t("../../../utils/under-dash"),i=t("../base-xform");function c(l,d){return l?d:void 0}function u(l,d){return l===d||void 0}n.exports=class extends i{get tag(){return"sheetProtection"}render(l,d){if(d){const h={sheet:c(d.sheet,"1"),selectLockedCells:d.selectLockedCells===!1?"1":void 0,selectUnlockedCells:d.selectUnlockedCells===!1?"1":void 0,formatCells:c(d.formatCells,"0"),formatColumns:c(d.formatColumns,"0"),formatRows:c(d.formatRows,"0"),insertColumns:c(d.insertColumns,"0"),insertRows:c(d.insertRows,"0"),insertHyperlinks:c(d.insertHyperlinks,"0"),deleteColumns:c(d.deleteColumns,"0"),deleteRows:c(d.deleteRows,"0"),sort:c(d.sort,"0"),autoFilter:c(d.autoFilter,"0"),pivotTables:c(d.pivotTables,"0")};d.sheet&&(h.algorithmName=d.algorithmName,h.hashValue=d.hashValue,h.saltValue=d.saltValue,h.spinCount=d.spinCount,h.objects=c(d.objects===!1,"1"),h.scenarios=c(d.scenarios===!1,"1")),o.some(h,f=>f!==void 0)&&l.leafNode(this.tag,h)}}parseOpen(l){switch(l.name){case this.tag:return this.model={sheet:u(l.attributes.sheet,"1"),objects:l.attributes.objects!=="1"&&void 0,scenarios:l.attributes.scenarios!=="1"&&void 0,selectLockedCells:l.attributes.selectLockedCells!=="1"&&void 0,selectUnlockedCells:l.attributes.selectUnlockedCells!=="1"&&void 0,formatCells:u(l.attributes.formatCells,"0"),formatColumns:u(l.attributes.formatColumns,"0"),formatRows:u(l.attributes.formatRows,"0"),insertColumns:u(l.attributes.insertColumns,"0"),insertRows:u(l.attributes.insertRows,"0"),insertHyperlinks:u(l.attributes.insertHyperlinks,"0"),deleteColumns:u(l.attributes.deleteColumns,"0"),deleteRows:u(l.attributes.deleteRows,"0"),sort:u(l.attributes.sort,"0"),autoFilter:u(l.attributes.autoFilter,"0"),pivotTables:u(l.attributes.pivotTables,"0")},l.attributes.algorithmName&&(this.model.algorithmName=l.attributes.algorithmName,this.model.hashValue=l.attributes.hashValue,this.model.saltValue=l.attributes.saltValue,this.model.spinCount=parseInt(l.attributes.spinCount,10)),!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],113:[function(t,n,s){const o=t("../../../utils/col-cache"),i=t("../base-xform"),c={frozen:"frozen",frozenSplit:"frozen",split:"split"};n.exports=class extends i{get tag(){return"sheetView"}prepare(u){switch(u.state){case"frozen":case"split":break;default:u.state="normal"}}render(u,l){u.openNode("sheetView",{workbookViewId:l.workbookViewId||0});const d=function(g,m,b){b&&u.addAttribute(g,m)};let h,f,p,v;switch(d("rightToLeft","1",l.rightToLeft===!0),d("tabSelected","1",l.tabSelected),d("showRuler","0",l.showRuler===!1),d("showRowColHeaders","0",l.showRowColHeaders===!1),d("showGridLines","0",l.showGridLines===!1),d("zoomScale",l.zoomScale,l.zoomScale),d("zoomScaleNormal",l.zoomScaleNormal,l.zoomScaleNormal),d("view",l.style,l.style),l.state){case"frozen":f=l.xSplit||0,p=l.ySplit||0,h=l.topLeftCell||o.getAddress(p+1,f+1).address,v=(l.xSplit&&l.ySplit?"bottomRight":l.xSplit&&"topRight")||"bottomLeft",u.leafNode("pane",{xSplit:l.xSplit||void 0,ySplit:l.ySplit||void 0,topLeftCell:h,activePane:v,state:"frozen"}),u.leafNode("selection",{pane:v,activeCell:l.activeCell,sqref:l.activeCell});break;case"split":l.activePane==="topLeft"&&(l.activePane=void 0),u.leafNode("pane",{xSplit:l.xSplit||void 0,ySplit:l.ySplit||void 0,topLeftCell:l.topLeftCell,activePane:l.activePane}),u.leafNode("selection",{pane:l.activePane,activeCell:l.activeCell,sqref:l.activeCell});break;case"normal":l.activeCell&&u.leafNode("selection",{activeCell:l.activeCell,sqref:l.activeCell})}u.closeNode()}parseOpen(u){switch(u.name){case"sheetView":return this.sheetView={workbookViewId:parseInt(u.attributes.workbookViewId,10),rightToLeft:u.attributes.rightToLeft==="1",tabSelected:u.attributes.tabSelected==="1",showRuler:u.attributes.showRuler!=="0",showRowColHeaders:u.attributes.showRowColHeaders!=="0",showGridLines:u.attributes.showGridLines!=="0",zoomScale:parseInt(u.attributes.zoomScale||"100",10),zoomScaleNormal:parseInt(u.attributes.zoomScaleNormal||"100",10),style:u.attributes.view},this.pane=void 0,this.selections={},!0;case"pane":return this.pane={xSplit:parseInt(u.attributes.xSplit||"0",10),ySplit:parseInt(u.attributes.ySplit||"0",10),topLeftCell:u.attributes.topLeftCell,activePane:u.attributes.activePane||"topLeft",state:u.attributes.state},!0;case"selection":{const l=u.attributes.pane||"topLeft";return this.selections[l]={pane:l,activeCell:u.attributes.activeCell},!0}default:return!1}}parseText(){}parseClose(u){let l,d;switch(u){case"sheetView":return this.sheetView&&this.pane?(l=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:c[this.pane.state]||"split",xSplit:this.pane.xSplit,ySplit:this.pane.ySplit,topLeftCell:this.pane.topLeftCell,showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},this.model.state==="split"&&(l.activePane=this.pane.activePane),d=this.selections[this.pane.activePane],d&&d.activeCell&&(l.activeCell=d.activeCell),this.sheetView.style&&(l.style=this.sheetView.style)):(l=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:"normal",showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},d=this.selections.topLeft,d&&d.activeCell&&(l.activeCell=d.activeCell),this.sheetView.style&&(l.style=this.sheetView.style)),!1;default:return!0}}reconcile(){}}},{"../../../utils/col-cache":19,"../base-xform":32}],114:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{get tag(){return"tablePart"}render(i,c){c&&i.leafNode(this.tag,{"r:id":c.rId})}parseOpen(i){switch(i.name){case this.tag:return this.model={rId:i.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],115:[function(t,n,s){const o=t("../../../utils/under-dash"),i=t("../../../utils/col-cache"),c=t("../../../utils/xml-stream"),u=t("../../rel-type"),l=t("./merges"),d=t("../base-xform"),h=t("../list-xform"),f=t("./row-xform"),p=t("./col-xform"),v=t("./dimension-xform"),g=t("./hyperlink-xform"),m=t("./merge-cell-xform"),b=t("./data-validations-xform"),y=t("./sheet-properties-xform"),S=t("./sheet-format-properties-xform"),C=t("./sheet-view-xform"),L=t("./sheet-protection-xform"),O=t("./page-margins-xform"),H=t("./page-setup-xform"),z=t("./print-options-xform"),q=t("./auto-filter-xform"),D=t("./picture-xform"),W=t("./drawing-xform"),P=t("./table-part-xform"),I=t("./row-breaks-xform"),U=t("./header-footer-xform"),k=t("./cf/conditional-formattings-xform"),_=t("./ext-lst-xform"),R=(A,N)=>{if(!N||!N.length)return A;if(!A||!A.length)return N;const V={},M={};return A.forEach(Z=>{V[Z.ref]=Z,Z.rules.forEach(J=>{const{x14Id:re}=J;re&&(M[re]=J)})}),N.forEach(Z=>{Z.rules.forEach(J=>{const re=M[J.x14Id];re?((X,ne)=>{Object.keys(ne).forEach(Y=>{const K=X[Y],ee=ne[Y];K===void 0&&ee!==void 0&&(X[Y]=ee)})})(re,J):V[Z.ref]?V[Z.ref].rules.push(J):A.push({ref:Z.ref,rules:[J]})})}),A};class j extends d{constructor(N){super();const{maxRows:V,maxCols:M,ignoreNodes:Z}=N||{};this.ignoreNodes=Z||[],this.map={sheetPr:new y,dimension:new v,sheetViews:new h({tag:"sheetViews",count:!1,childXform:new C}),sheetFormatPr:new S,cols:new h({tag:"cols",count:!1,childXform:new p}),sheetData:new h({tag:"sheetData",count:!1,empty:!0,childXform:new f({maxItems:M}),maxItems:V}),autoFilter:new q,mergeCells:new h({tag:"mergeCells",count:!0,childXform:new m}),rowBreaks:new I,hyperlinks:new h({tag:"hyperlinks",count:!1,childXform:new g}),pageMargins:new O,dataValidations:new b,pageSetup:new H,headerFooter:new U,printOptions:new z,picture:new D,drawing:new W,sheetProtection:new L,tableParts:new h({tag:"tableParts",count:!0,childXform:new P}),conditionalFormatting:new k,extLst:new _}}prepare(N,V){V.merges=new l,N.hyperlinks=V.hyperlinks=[],N.comments=V.comments=[],V.formulae={},V.siFormulae=0,this.map.cols.prepare(N.cols,V),this.map.sheetData.prepare(N.rows,V),this.map.conditionalFormatting.prepare(N.conditionalFormattings,V),N.mergeCells=V.merges.mergeCells;const M=N.rels=[];function Z(X){return"rId"+(X.length+1)}if(N.hyperlinks.forEach(X=>{const ne=Z(M);X.rId=ne,M.push({Id:ne,Type:u.Hyperlink,Target:X.target,TargetMode:"External"})}),N.comments.length>0){const X={Id:Z(M),Type:u.Comments,Target:`../comments${N.id}.xml`};M.push(X);const ne={Id:Z(M),Type:u.VmlDrawing,Target:`../drawings/vmlDrawing${N.id}.vml`};M.push(ne),N.comments.forEach(Y=>{Y.refAddress=i.decodeAddress(Y.ref)}),V.commentRefs.push({commentName:"comments"+N.id,vmlDrawing:"vmlDrawing"+N.id})}const J=[];let re;N.media.forEach(X=>{if(X.type==="background"){const ne=Z(M);re=V.media[X.imageId],M.push({Id:ne,Type:u.Image,Target:`../media/${re.name}.${re.extension}`}),N.background={rId:ne},N.image=V.media[X.imageId]}else if(X.type==="image"){let{drawing:ne}=N;re=V.media[X.imageId],ne||(ne=N.drawing={rId:Z(M),name:"drawing"+ ++V.drawingsCount,anchors:[],rels:[]},V.drawings.push(ne),M.push({Id:ne.rId,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:`../drawings/${ne.name}.xml`}));let Y=this.preImageId===X.imageId?J[X.imageId]:J[ne.rels.length];Y||(Y=Z(ne.rels),J[ne.rels.length]=Y,ne.rels.push({Id:Y,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`../media/${re.name}.${re.extension}`}));const K={picture:{rId:Y},range:X.range};if(X.hyperlinks&&X.hyperlinks.hyperlink){const ee=Z(ne.rels);J[ne.rels.length]=ee,K.picture.hyperlinks={tooltip:X.hyperlinks.tooltip,rId:ee},ne.rels.push({Id:ee,Type:u.Hyperlink,Target:X.hyperlinks.hyperlink,TargetMode:"External"})}this.preImageId=X.imageId,ne.anchors.push(K)}}),N.tables.forEach(X=>{const ne=Z(M);X.rId=ne,M.push({Id:ne,Type:u.Table,Target:"../tables/"+X.target}),X.columns.forEach(Y=>{const{style:K}=Y;K&&(Y.dxfId=V.styles.addDxfStyle(K))})}),this.map.extLst.prepare(N,V)}render(N,V){N.openXml(c.StdDocAttributes),N.openNode("worksheet",j.WORKSHEET_ATTRIBUTES);const M=V.properties?{defaultRowHeight:V.properties.defaultRowHeight,dyDescent:V.properties.dyDescent,outlineLevelCol:V.properties.outlineLevelCol,outlineLevelRow:V.properties.outlineLevelRow}:void 0;V.properties&&V.properties.defaultColWidth&&(M.defaultColWidth=V.properties.defaultColWidth);const Z={outlineProperties:V.properties&&V.properties.outlineProperties,tabColor:V.properties&&V.properties.tabColor,pageSetup:V.pageSetup&&V.pageSetup.fitToPage?{fitToPage:V.pageSetup.fitToPage}:void 0},J=V.pageSetup&&V.pageSetup.margins,re={showRowColHeaders:V.pageSetup&&V.pageSetup.showRowColHeaders,showGridLines:V.pageSetup&&V.pageSetup.showGridLines,horizontalCentered:V.pageSetup&&V.pageSetup.horizontalCentered,verticalCentered:V.pageSetup&&V.pageSetup.verticalCentered},X=V.sheetProtection;this.map.sheetPr.render(N,Z),this.map.dimension.render(N,V.dimensions),this.map.sheetViews.render(N,V.views),this.map.sheetFormatPr.render(N,M),this.map.cols.render(N,V.cols),this.map.sheetData.render(N,V.rows),this.map.sheetProtection.render(N,X),this.map.autoFilter.render(N,V.autoFilter),this.map.mergeCells.render(N,V.mergeCells),this.map.conditionalFormatting.render(N,V.conditionalFormattings),this.map.dataValidations.render(N,V.dataValidations),this.map.hyperlinks.render(N,V.hyperlinks),this.map.printOptions.render(N,re),this.map.pageMargins.render(N,J),this.map.pageSetup.render(N,V.pageSetup),this.map.headerFooter.render(N,V.headerFooter),this.map.rowBreaks.render(N,V.rowBreaks),this.map.drawing.render(N,V.drawing),this.map.picture.render(N,V.background),this.map.tableParts.render(N,V.tables),this.map.extLst.render(N,V),V.rels&&V.rels.forEach(ne=>{ne.Type===u.VmlDrawing&&N.leafNode("legacyDrawing",{"r:id":ne.Id})}),N.closeNode()}parseOpen(N){return this.parser?(this.parser.parseOpen(N),!0):N.name==="worksheet"?(o.each(this.map,V=>{V.reset()}),!0):(this.map[N.name]&&!this.ignoreNodes.includes(N.name)&&(this.parser=this.map[N.name],this.parser.parseOpen(N)),!0)}parseText(N){this.parser&&this.parser.parseText(N)}parseClose(N){if(this.parser)return this.parser.parseClose(N)||(this.parser=void 0),!0;switch(N){case"worksheet":{const V=this.map.sheetFormatPr.model||{};this.map.sheetPr.model&&this.map.sheetPr.model.tabColor&&(V.tabColor=this.map.sheetPr.model.tabColor),this.map.sheetPr.model&&this.map.sheetPr.model.outlineProperties&&(V.outlineProperties=this.map.sheetPr.model.outlineProperties);const M={fitToPage:this.map.sheetPr.model&&this.map.sheetPr.model.pageSetup&&this.map.sheetPr.model.pageSetup.fitToPage||!1,margins:this.map.pageMargins.model},Z=Object.assign(M,this.map.pageSetup.model,this.map.printOptions.model),J=R(this.map.conditionalFormatting.model,this.map.extLst.model&&this.map.extLst.model["x14:conditionalFormattings"]);return this.model={dimensions:this.map.dimension.model,cols:this.map.cols.model,rows:this.map.sheetData.model,mergeCells:this.map.mergeCells.model,hyperlinks:this.map.hyperlinks.model,dataValidations:this.map.dataValidations.model,properties:V,views:this.map.sheetViews.model,pageSetup:Z,headerFooter:this.map.headerFooter.model,background:this.map.picture.model,drawing:this.map.drawing.model,tables:this.map.tableParts.model,conditionalFormattings:J},this.map.autoFilter.model&&(this.model.autoFilter=this.map.autoFilter.model),this.map.sheetProtection.model&&(this.model.sheetProtection=this.map.sheetProtection.model),!1}default:return!0}}reconcile(N,V){const M=(N.relationships||[]).reduce((J,re)=>{if(J[re.Id]=re,re.Type===u.Comments&&(N.comments=V.comments[re.Target].comments),re.Type===u.VmlDrawing&&N.comments&&N.comments.length){const X=V.vmlDrawings[re.Target].comments;N.comments.forEach((ne,Y)=>{ne.note=Object.assign({},ne.note,X[Y])})}return J},{});if(V.commentsMap=(N.comments||[]).reduce((J,re)=>(re.ref&&(J[re.ref]=re),J),{}),V.hyperlinkMap=(N.hyperlinks||[]).reduce((J,re)=>(re.rId&&(J[re.address]=M[re.rId].Target),J),{}),V.formulae={},N.rows=N.rows&&N.rows.filter(Boolean)||[],N.rows.forEach(J=>{J.cells=J.cells&&J.cells.filter(Boolean)||[]}),this.map.cols.reconcile(N.cols,V),this.map.sheetData.reconcile(N.rows,V),this.map.conditionalFormatting.reconcile(N.conditionalFormattings,V),N.media=[],N.drawing){const J=M[N.drawing.rId].Target.match(/\/drawings\/([a-zA-Z0-9]+)[.][a-zA-Z]{3,4}$/);if(J){const re=J[1];V.drawings[re].anchors.forEach(X=>{if(X.medium){const ne={type:"image",imageId:X.medium.index,range:X.range,hyperlinks:X.picture.hyperlinks};N.media.push(ne)}})}}const Z=N.background&&M[N.background.rId];if(Z){const J=Z.Target.split("/media/")[1],re=V.mediaIndex&&V.mediaIndex[J];re!==void 0&&N.media.push({type:"background",imageId:re})}N.tables=(N.tables||[]).map(J=>{const re=M[J.rId];return V.tables[re.Target]}),delete N.relationships,delete N.hyperlinks,delete N.comments}}j.WORKSHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"},n.exports=j},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../../rel-type":31,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":72,"./cf/conditional-formattings-xform":87,"./col-xform":92,"./data-validations-xform":93,"./dimension-xform":94,"./drawing-xform":95,"./ext-lst-xform":96,"./header-footer-xform":97,"./hyperlink-xform":98,"./merge-cell-xform":99,"./merges":100,"./page-margins-xform":103,"./page-setup-xform":105,"./picture-xform":106,"./print-options-xform":107,"./row-breaks-xform":108,"./row-xform":109,"./sheet-format-properties-xform":110,"./sheet-properties-xform":111,"./sheet-protection-xform":112,"./sheet-view-xform":113,"./table-part-xform":114}],116:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{constructor(i){super(),this.tag=i.tag,this.attr=i.attr}render(i,c){c&&(i.openNode(this.tag),i.closeNode())}parseOpen(i){i.name===this.tag&&(this.model=!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],117:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{constructor(i){super(),this.tag=i.tag,this.attr=i.attr,this.attrs=i.attrs,this._format=i.format||function(c){try{return Number.isNaN(c.getTime())?"":c.toISOString()}catch{return""}},this._parse=i.parse||function(c){return new Date(c)}}render(i,c){c&&(i.openNode(this.tag),this.attrs&&i.addAttributes(this.attrs),this.attr?i.addAttribute(this.attr,this._format(c)):i.writeText(this._format(c)),i.closeNode())}parseOpen(i){i.name===this.tag&&(this.attr?this.model=this._parse(i.attributes[this.attr]):this.text=[])}parseText(i){this.attr||this.text.push(i)}parseClose(){return this.attr||(this.model=this._parse(this.text.join(""))),!1}}},{"../base-xform":32}],118:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{constructor(i){super(),this.tag=i.tag,this.attr=i.attr,this.attrs=i.attrs,this.zero=i.zero}render(i,c){(c||this.zero)&&(i.openNode(this.tag),this.attrs&&i.addAttributes(this.attrs),this.attr?i.addAttribute(this.attr,c):i.writeText(c),i.closeNode())}parseOpen(i){return i.name===this.tag&&(this.attr?this.model=parseInt(i.attributes[this.attr],10):this.text=[],!0)}parseText(i){this.attr||this.text.push(i)}parseClose(){return this.attr||(this.model=parseInt(this.text.join("")||0,10)),!1}}},{"../base-xform":32}],119:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{constructor(i){super(),this.tag=i.tag,this.attr=i.attr,this.attrs=i.attrs}render(i,c){c!==void 0&&(i.openNode(this.tag),this.attrs&&i.addAttributes(this.attrs),this.attr?i.addAttribute(this.attr,c):i.writeText(c),i.closeNode())}parseOpen(i){i.name===this.tag&&(this.attr?this.model=i.attributes[this.attr]:this.text=[])}parseText(i){this.attr||this.text.push(i)}parseClose(){return this.attr||(this.model=this.text.join("")),!1}}},{"../base-xform":32}],120:[function(t,n,s){const o=t("./base-xform"),i=t("../../utils/xml-stream");n.exports=class extends o{constructor(c){super(),this._model=c}render(c){if(!this._xml){const u=new i;(function l(d,h){d.openNode(h.tag,h.$),h.c&&h.c.forEach(f=>{l(d,f)}),h.t&&d.writeText(h.t),d.closeNode()})(u,this._model),this._xml=u.xml}c.writeXml(this._xml)}parseOpen(){return!0}parseText(){}parseClose(c){switch(c){case this._model.tag:return!1;default:return!0}}}},{"../../utils/xml-stream":28,"./base-xform":32}],121:[function(t,n,s){const o=t("./text-xform"),i=t("./rich-text-xform"),c=t("../base-xform");n.exports=class extends c{constructor(){super(),this.map={r:new i,t:new o}}get tag(){return"rPh"}render(u,l){if(u.openNode(this.tag,{sb:l.sb||0,eb:l.eb||0}),l&&l.hasOwnProperty("richText")&&l.richText){const{r:d}=this.map;l.richText.forEach(h=>{d.render(u,h)})}else l&&this.map.t.render(u,l.text);u.closeNode()}parseOpen(u){const{name:l}=u;return this.parser?(this.parser.parseOpen(u),!0):l===this.tag?(this.model={sb:parseInt(u.attributes.sb,10),eb:parseInt(u.attributes.eb,10)},!0):(this.parser=this.map[l],!!this.parser&&(this.parser.parseOpen(u),!0))}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser){if(!this.parser.parseClose(u)){switch(u){case"r":{let l=this.model.richText;l||(l=this.model.richText=[]),l.push(this.parser.model);break}case"t":this.model.text=this.parser.model}this.parser=void 0}return!0}switch(u){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"./rich-text-xform":122,"./text-xform":125}],122:[function(t,n,s){const o=t("./text-xform"),i=t("../style/font-xform"),c=t("../base-xform");class u extends c{constructor(d){super(),this.model=d}get tag(){return"r"}get textXform(){return this._textXform||(this._textXform=new o)}get fontXform(){return this._fontXform||(this._fontXform=new i(u.FONT_OPTIONS))}render(d,h){h=h||this.model,d.openNode("r"),h.font&&this.fontXform.render(d,h.font),this.textXform.render(d,h.text),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case"r":return this.model={},!0;case"t":return this.parser=this.textXform,this.parser.parseOpen(d),!0;case"rPr":return this.parser=this.fontXform,this.parser.parseOpen(d),!0;default:return!1}}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){switch(d){case"r":return!1;case"t":return this.model.text=this.parser.model,this.parser=void 0,!0;case"rPr":return this.model.font=this.parser.model,this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(d),!0}}}u.FONT_OPTIONS={tagName:"rPr",fontNameTag:"rFont"},n.exports=u},{"../base-xform":32,"../style/font-xform":131,"./text-xform":125}],123:[function(t,n,s){const o=t("./text-xform"),i=t("./rich-text-xform"),c=t("./phonetic-text-xform"),u=t("../base-xform");n.exports=class extends u{constructor(l){super(),this.model=l,this.map={r:new i,t:new o,rPh:new c}}get tag(){return"si"}render(l,d){l.openNode(this.tag),d&&d.hasOwnProperty("richText")&&d.richText?d.richText.length?d.richText.forEach(h=>{this.map.r.render(l,h)}):this.map.t.render(l,""):d!=null&&this.map.t.render(l,d),l.closeNode()}parseOpen(l){const{name:d}=l;return this.parser?(this.parser.parseOpen(l),!0):d===this.tag?(this.model={},!0):(this.parser=this.map[d],!!this.parser&&(this.parser.parseOpen(l),!0))}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser){if(!this.parser.parseClose(l)){switch(l){case"r":{let d=this.model.richText;d||(d=this.model.richText=[]),d.push(this.parser.model);break}case"t":this.model=this.parser.model}this.parser=void 0}return!0}switch(l){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"./phonetic-text-xform":121,"./rich-text-xform":122,"./text-xform":125}],124:[function(t,n,s){const o=t("../../../utils/xml-stream"),i=t("../base-xform"),c=t("./shared-string-xform");n.exports=class extends i{constructor(u){super(),this.model=u||{values:[],count:0},this.hash=Object.create(null),this.rich=Object.create(null)}get sharedStringXform(){return this._sharedStringXform||(this._sharedStringXform=new c)}get values(){return this.model.values}get uniqueCount(){return this.model.values.length}get count(){return this.model.count}getString(u){return this.model.values[u]}add(u){return u.richText?this.addRichText(u):this.addText(u)}addText(u){let l=this.hash[u];return l===void 0&&(l=this.hash[u]=this.model.values.length,this.model.values.push(u)),this.model.count++,l}addRichText(u){const l=this.sharedStringXform.toXml(u);let d=this.rich[l];return d===void 0&&(d=this.rich[l]=this.model.values.length,this.model.values.push(u)),this.model.count++,d}render(u,l){l=l||this._values,u.openXml(o.StdDocAttributes),u.openNode("sst",{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:l.count,uniqueCount:l.values.length});const d=this.sharedStringXform;l.values.forEach(h=>{d.render(u,h)}),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"sst":return!0;case"si":return this.parser=this.sharedStringXform,this.parser.parseOpen(u),!0;default:throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(u))}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.model.values.push(this.parser.model),this.model.count++,this.parser=void 0),!0;switch(u){case"sst":return!1;default:throw new Error("Unexpected xml node in parseClose: "+u)}}}},{"../../../utils/xml-stream":28,"../base-xform":32,"./shared-string-xform":123}],125:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{get tag(){return"t"}render(i,c){i.openNode("t"),/^\s|\n|\s$/.test(c)&&i.addAttribute("xml:space","preserve"),i.writeText(c),i.closeNode()}get model(){return this._text.join("").replace(/_x([0-9A-F]{4})_/g,(i,c)=>String.fromCharCode(parseInt(c,16)))}parseOpen(i){switch(i.name){case"t":return this._text=[],!0;default:return!1}}parseText(i){this._text.push(i)}parseClose(){return!1}}},{"../base-xform":32}],126:[function(t,n,s){const o=t("../../../doc/enums"),i=t("../../../utils/utils"),c=t("../base-xform"),u={horizontalValues:["left","center","right","fill","centerContinuous","distributed","justify"].reduce((d,h)=>(d[h]=!0,d),{}),horizontal(d){return this.horizontalValues[d]?d:void 0},verticalValues:["top","middle","bottom","distributed","justify"].reduce((d,h)=>(d[h]=!0,d),{}),vertical(d){return d==="middle"?"center":this.verticalValues[d]?d:void 0},wrapText:d=>!!d||void 0,shrinkToFit:d=>!!d||void 0,textRotation(d){switch(d){case"vertical":return d;default:return(d=i.validInt(d))>=-90&&d<=90?d:void 0}},indent:d=>(d=i.validInt(d),Math.max(0,d)),readingOrder(d){switch(d){case"ltr":return o.ReadingOrder.LeftToRight;case"rtl":return o.ReadingOrder.RightToLeft;default:return}}},l={toXml(d){if(d=u.textRotation(d)){if(d==="vertical")return 255;const h=Math.round(d);if(h>=0&&h<=90)return h;if(h<0&&h>=-90)return 90-h}},toModel(d){const h=i.validInt(d);if(h!==void 0){if(h===255)return"vertical";if(h>=0&&h<=90)return h;if(h>90&&h<=180)return 90-h}}};n.exports=class extends c{get tag(){return"alignment"}render(d,h){d.addRollback(),d.openNode("alignment");let f=!1;function p(v,g){g&&(d.addAttribute(v,g),f=!0)}p("horizontal",u.horizontal(h.horizontal)),p("vertical",u.vertical(h.vertical)),p("wrapText",!!u.wrapText(h.wrapText)&&"1"),p("shrinkToFit",!!u.shrinkToFit(h.shrinkToFit)&&"1"),p("indent",u.indent(h.indent)),p("textRotation",l.toXml(h.textRotation)),p("readingOrder",u.readingOrder(h.readingOrder)),d.closeNode(),f?d.commit():d.rollback()}parseOpen(d){const h={};let f=!1;function p(v,g,m){v&&(h[g]=m,f=!0)}p(d.attributes.horizontal,"horizontal",d.attributes.horizontal),p(d.attributes.vertical,"vertical",d.attributes.vertical==="center"?"middle":d.attributes.vertical),p(d.attributes.wrapText,"wrapText",i.parseBoolean(d.attributes.wrapText)),p(d.attributes.shrinkToFit,"shrinkToFit",i.parseBoolean(d.attributes.shrinkToFit)),p(d.attributes.indent,"indent",parseInt(d.attributes.indent,10)),p(d.attributes.textRotation,"textRotation",l.toModel(d.attributes.textRotation)),p(d.attributes.readingOrder,"readingOrder",d.attributes.readingOrder==="2"?"rtl":"ltr"),this.model=f?h:null}parseText(){}parseClose(){return!1}}},{"../../../doc/enums":7,"../../../utils/utils":27,"../base-xform":32}],127:[function(t,n,s){const o=t("../base-xform"),i=t("../../../utils/utils"),c=t("./color-xform");class u extends o{constructor(d){super(),this.name=d,this.map={color:new c}}get tag(){return this.name}render(d,h,f){const p=h&&h.color||f||this.defaultColor;d.openNode(this.name),h&&h.style&&(d.addAttribute("style",h.style),p&&this.map.color.render(d,p)),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case this.name:{const{style:h}=d.attributes;return this.model=h?{style:h}:void 0,!0}case"color":return this.parser=this.map.color,this.parser.parseOpen(d),!0;default:return!1}}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){return this.parser?(this.parser.parseClose(d)||(this.parser=void 0),!0):(d===this.name&&this.map.color.model&&(this.model||(this.model={}),this.model.color=this.map.color.model),!1)}validStyle(d){return u.validStyleValues[d]}}u.validStyleValues=["thin","dashed","dotted","dashDot","hair","dashDotDot","slantDashDot","mediumDashed","mediumDashDotDot","mediumDashDot","medium","double","thick"].reduce((l,d)=>(l[d]=!0,l),{}),n.exports=class extends o{constructor(){super(),this.map={top:new u("top"),left:new u("left"),bottom:new u("bottom"),right:new u("right"),diagonal:new u("diagonal")}}render(l,d){const{color:h}=d;function f(p,v){p&&!p.color&&d.color&&(p={...p,color:d.color}),v.render(l,p,h)}l.openNode("border"),d.diagonal&&d.diagonal.style&&(d.diagonal.up&&l.addAttribute("diagonalUp","1"),d.diagonal.down&&l.addAttribute("diagonalDown","1")),f(d.left,this.map.left),f(d.right,this.map.right),f(d.top,this.map.top),f(d.bottom,this.map.bottom),f(d.diagonal,this.map.diagonal),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case"border":return this.reset(),this.diagonalUp=i.parseBoolean(l.attributes.diagonalUp),this.diagonalDown=i.parseBoolean(l.attributes.diagonalDown),!0;default:return this.parser=this.map[l.name],!!this.parser&&(this.parser.parseOpen(l),!0)}}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.parser=void 0),!0;if(l==="border"){const d=this.model={},h=function(f,p,v){p&&(v&&Object.assign(p,v),d[f]=p)};h("left",this.map.left.model),h("right",this.map.right.model),h("top",this.map.top.model),h("bottom",this.map.bottom.model),h("diagonal",this.map.diagonal.model,{up:this.diagonalUp,down:this.diagonalDown})}return!1}}},{"../../../utils/utils":27,"../base-xform":32,"./color-xform":128}],128:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{constructor(i){super(),this.name=i||"color"}get tag(){return this.name}render(i,c){return!!c&&(i.openNode(this.name),c.argb?i.addAttribute("rgb",c.argb):c.theme!==void 0?(i.addAttribute("theme",c.theme),c.tint!==void 0&&i.addAttribute("tint",c.tint)):c.indexed!==void 0?i.addAttribute("indexed",c.indexed):i.addAttribute("auto","1"),i.closeNode(),!0)}parseOpen(i){return i.name===this.name&&(i.attributes.rgb?this.model={argb:i.attributes.rgb}:i.attributes.theme?(this.model={theme:parseInt(i.attributes.theme,10)},i.attributes.tint&&(this.model.tint=parseFloat(i.attributes.tint))):i.attributes.indexed?this.model={indexed:parseInt(i.attributes.indexed,10)}:this.model=void 0,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],129:[function(t,n,s){const o=t("../base-xform"),i=t("./alignment-xform"),c=t("./border-xform"),u=t("./fill-xform"),l=t("./font-xform"),d=t("./numfmt-xform"),h=t("./protection-xform");n.exports=class extends o{constructor(){super(),this.map={alignment:new i,border:new c,fill:new u,font:new l,numFmt:new d,protection:new h}}get tag(){return"dxf"}render(f,p){if(f.openNode(this.tag),p.font&&this.map.font.render(f,p.font),p.numFmt&&p.numFmtId){const v={id:p.numFmtId,formatCode:p.numFmt};this.map.numFmt.render(f,v)}p.fill&&this.map.fill.render(f,p.fill),p.alignment&&this.map.alignment.render(f,p.alignment),p.border&&this.map.border.render(f,p.border),p.protection&&this.map.protection.render(f,p.protection),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case this.tag:return this.reset(),!0;default:return this.parser=this.map[f.name],this.parser&&this.parser.parseOpen(f),!0}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return this.parser?(this.parser.parseClose(f)||(this.parser=void 0),!0):f!==this.tag||(this.model={alignment:this.map.alignment.model,border:this.map.border.model,fill:this.map.fill.model,font:this.map.font.model,numFmt:this.map.numFmt.model,protection:this.map.protection.model},!1)}}},{"../base-xform":32,"./alignment-xform":126,"./border-xform":127,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./protection-xform":133}],130:[function(t,n,s){const o=t("../base-xform"),i=t("./color-xform");class c extends o{constructor(){super(),this.map={color:new i}}get tag(){return"stop"}render(f,p){f.openNode("stop"),f.addAttribute("position",p.position),this.map.color.render(f,p.color),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"stop":return this.model={position:parseFloat(f.attributes.position)},!0;case"color":return this.parser=this.map.color,this.parser.parseOpen(f),!0;default:return!1}}parseText(){}parseClose(f){return!!this.parser&&(this.parser.parseClose(f)||(this.model.color=this.parser.model,this.parser=void 0),!0)}}class u extends o{constructor(){super(),this.map={fgColor:new i("fgColor"),bgColor:new i("bgColor")}}get name(){return"pattern"}get tag(){return"patternFill"}render(f,p){f.openNode("patternFill"),f.addAttribute("patternType",p.pattern),p.fgColor&&this.map.fgColor.render(f,p.fgColor),p.bgColor&&this.map.bgColor.render(f,p.bgColor),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"patternFill":return this.model={type:"pattern",pattern:f.attributes.patternType},!0;default:return this.parser=this.map[f.name],!!this.parser&&(this.parser.parseOpen(f),!0)}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return!!this.parser&&(this.parser.parseClose(f)||(this.parser.model&&(this.model[f]=this.parser.model),this.parser=void 0),!0)}}class l extends o{constructor(){super(),this.map={stop:new c}}get name(){return"gradient"}get tag(){return"gradientFill"}render(f,p){switch(f.openNode("gradientFill"),p.gradient){case"angle":f.addAttribute("degree",p.degree);break;case"path":f.addAttribute("type","path"),p.center.left&&(f.addAttribute("left",p.center.left),p.center.right===void 0&&f.addAttribute("right",p.center.left)),p.center.right&&f.addAttribute("right",p.center.right),p.center.top&&(f.addAttribute("top",p.center.top),p.center.bottom===void 0&&f.addAttribute("bottom",p.center.top)),p.center.bottom&&f.addAttribute("bottom",p.center.bottom)}const v=this.map.stop;p.stops.forEach(g=>{v.render(f,g)}),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"gradientFill":{const p=this.model={stops:[]};return f.attributes.degree?(p.gradient="angle",p.degree=parseInt(f.attributes.degree,10)):f.attributes.type==="path"&&(p.gradient="path",p.center={left:f.attributes.left?parseFloat(f.attributes.left):0,top:f.attributes.top?parseFloat(f.attributes.top):0},f.attributes.right!==f.attributes.left&&(p.center.right=f.attributes.right?parseFloat(f.attributes.right):0),f.attributes.bottom!==f.attributes.top&&(p.center.bottom=f.attributes.bottom?parseFloat(f.attributes.bottom):0)),!0}case"stop":return this.parser=this.map.stop,this.parser.parseOpen(f),!0;default:return!1}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return!!this.parser&&(this.parser.parseClose(f)||(this.model.stops.push(this.parser.model),this.parser=void 0),!0)}}class d extends o{constructor(){super(),this.map={patternFill:new u,gradientFill:new l}}get tag(){return"fill"}render(f,p){switch(f.addRollback(),f.openNode("fill"),p.type){case"pattern":this.map.patternFill.render(f,p);break;case"gradient":this.map.gradientFill.render(f,p);break;default:return void f.rollback()}f.closeNode(),f.commit()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"fill":return this.model={},!0;default:return this.parser=this.map[f.name],!!this.parser&&(this.parser.parseOpen(f),!0)}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return!!this.parser&&(this.parser.parseClose(f)||(this.model=this.parser.model,this.model.type=this.parser.name,this.parser=void 0),!0)}validStyle(f){return d.validPatternValues[f]}}d.validPatternValues=["none","solid","darkVertical","darkGray","mediumGray","lightGray","gray125","gray0625","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","lightGrid"].reduce((h,f)=>(h[f]=!0,h),{}),d.StopXform=c,d.PatternFillXform=u,d.GradientFillXform=l,n.exports=d},{"../base-xform":32,"./color-xform":128}],131:[function(t,n,s){const o=t("./color-xform"),i=t("../simple/boolean-xform"),c=t("../simple/integer-xform"),u=t("../simple/string-xform"),l=t("./underline-xform"),d=t("../../../utils/under-dash"),h=t("../base-xform");class f extends h{constructor(v){super(),this.options=v||f.OPTIONS,this.map={b:{prop:"bold",xform:new i({tag:"b",attr:"val"})},i:{prop:"italic",xform:new i({tag:"i",attr:"val"})},u:{prop:"underline",xform:new l},charset:{prop:"charset",xform:new c({tag:"charset",attr:"val"})},color:{prop:"color",xform:new o},condense:{prop:"condense",xform:new i({tag:"condense",attr:"val"})},extend:{prop:"extend",xform:new i({tag:"extend",attr:"val"})},family:{prop:"family",xform:new c({tag:"family",attr:"val"})},outline:{prop:"outline",xform:new i({tag:"outline",attr:"val"})},vertAlign:{prop:"vertAlign",xform:new u({tag:"vertAlign",attr:"val"})},scheme:{prop:"scheme",xform:new u({tag:"scheme",attr:"val"})},shadow:{prop:"shadow",xform:new i({tag:"shadow",attr:"val"})},strike:{prop:"strike",xform:new i({tag:"strike",attr:"val"})},sz:{prop:"size",xform:new c({tag:"sz",attr:"val"})}},this.map[this.options.fontNameTag]={prop:"name",xform:new u({tag:this.options.fontNameTag,attr:"val"})}}get tag(){return this.options.tagName}render(v,g){const{map:m}=this;v.openNode(this.options.tagName),d.each(this.map,(b,y)=>{m[y].xform.render(v,g[b.prop])}),v.closeNode()}parseOpen(v){if(this.parser)return this.parser.parseOpen(v),!0;if(this.map[v.name])return this.parser=this.map[v.name].xform,this.parser.parseOpen(v);switch(v.name){case this.options.tagName:return this.model={},!0;default:return!1}}parseText(v){this.parser&&this.parser.parseText(v)}parseClose(v){if(this.parser&&!this.parser.parseClose(v)){const g=this.map[v];return this.parser.model&&(this.model[g.prop]=this.parser.model),this.parser=void 0,!0}switch(v){case this.options.tagName:return!1;default:return!0}}}f.OPTIONS={tagName:"font",fontNameTag:"name"},n.exports=f},{"../../../utils/under-dash":26,"../base-xform":32,"../simple/boolean-xform":116,"../simple/integer-xform":118,"../simple/string-xform":119,"./color-xform":128,"./underline-xform":136}],132:[function(t,n,s){const o=t("../../../utils/under-dash"),i=t("../../defaultnumformats"),c=t("../base-xform"),u=function(){const d={};return o.each(i,(h,f)=>{h.f&&(d[h.f]=parseInt(f,10))}),d}();class l extends c{constructor(h,f){super(),this.id=h,this.formatCode=f}get tag(){return"numFmt"}render(h,f){h.leafNode("numFmt",{numFmtId:f.id,formatCode:f.formatCode})}parseOpen(h){switch(h.name){case"numFmt":return this.model={id:parseInt(h.attributes.numFmtId,10),formatCode:h.attributes.formatCode.replace(/[\\](.)/g,"$1")},!0;default:return!1}}parseText(){}parseClose(){return!1}}l.getDefaultFmtId=function(d){return u[d]},l.getDefaultFmtCode=function(d){return i[d]&&i[d].f},n.exports=l},{"../../../utils/under-dash":26,"../../defaultnumformats":30,"../base-xform":32}],133:[function(t,n,s){const o=t("../base-xform"),i={boolean:(c,u)=>c===void 0?u:c};n.exports=class extends o{get tag(){return"protection"}render(c,u){c.addRollback(),c.openNode("protection");let l=!1;function d(h,f){f!==void 0&&(c.addAttribute(h,f),l=!0)}d("locked",i.boolean(u.locked,!0)?void 0:"0"),d("hidden",i.boolean(u.hidden,!1)?"1":void 0),c.closeNode(),l?c.commit():c.rollback()}parseOpen(c){const u={locked:c.attributes.locked!=="0",hidden:c.attributes.hidden==="1"},l=!u.locked||u.hidden;this.model=l?u:null}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],134:[function(t,n,s){const o=t("../base-xform"),i=t("./alignment-xform"),c=t("./protection-xform");n.exports=class extends o{constructor(u){super(),this.xfId=!(!u||!u.xfId),this.map={alignment:new i,protection:new c}}get tag(){return"xf"}render(u,l){u.openNode("xf",{numFmtId:l.numFmtId||0,fontId:l.fontId||0,fillId:l.fillId||0,borderId:l.borderId||0}),this.xfId&&u.addAttribute("xfId",l.xfId||0),l.numFmtId&&u.addAttribute("applyNumberFormat","1"),l.fontId&&u.addAttribute("applyFont","1"),l.fillId&&u.addAttribute("applyFill","1"),l.borderId&&u.addAttribute("applyBorder","1"),l.alignment&&u.addAttribute("applyAlignment","1"),l.protection&&u.addAttribute("applyProtection","1"),l.alignment&&this.map.alignment.render(u,l.alignment),l.protection&&this.map.protection.render(u,l.protection),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"xf":return this.model={numFmtId:parseInt(u.attributes.numFmtId,10),fontId:parseInt(u.attributes.fontId,10),fillId:parseInt(u.attributes.fillId,10),borderId:parseInt(u.attributes.borderId,10)},this.xfId&&(this.model.xfId=parseInt(u.attributes.xfId,10)),!0;case"alignment":return this.parser=this.map.alignment,this.parser.parseOpen(u),!0;case"protection":return this.parser=this.map.protection,this.parser.parseOpen(u),!0;default:return!1}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){return this.parser?(this.parser.parseClose(u)||(this.map.protection===this.parser?this.model.protection=this.parser.model:this.model.alignment=this.parser.model,this.parser=void 0),!0):u!=="xf"}}},{"../base-xform":32,"./alignment-xform":126,"./protection-xform":133}],135:[function(t,n,s){const o=t("../../../doc/enums"),i=t("../../../utils/xml-stream"),c=t("../base-xform"),u=t("../static-xform"),l=t("../list-xform"),d=t("./font-xform"),h=t("./fill-xform"),f=t("./border-xform"),p=t("./numfmt-xform"),v=t("./style-xform"),g=t("./dxf-xform");class m extends c{constructor(y){super(),this.map={numFmts:new l({tag:"numFmts",count:!0,childXform:new p}),fonts:new l({tag:"fonts",count:!0,childXform:new d,$:{"x14ac:knownFonts":1}}),fills:new l({tag:"fills",count:!0,childXform:new h}),borders:new l({tag:"borders",count:!0,childXform:new f}),cellStyleXfs:new l({tag:"cellStyleXfs",count:!0,childXform:new v}),cellXfs:new l({tag:"cellXfs",count:!0,childXform:new v({xfId:!0})}),dxfs:new l({tag:"dxfs",always:!0,count:!0,childXform:new g}),numFmt:new p,font:new d,fill:new h,border:new f,style:new v({xfId:!0}),cellStyles:m.STATIC_XFORMS.cellStyles,tableStyles:m.STATIC_XFORMS.tableStyles,extLst:m.STATIC_XFORMS.extLst},y&&this.init()}initIndex(){this.index={style:{},numFmt:{},numFmtNextId:164,font:{},border:{},fill:{}}}init(){this.model={styles:[],numFmts:[],fonts:[],borders:[],fills:[],dxfs:[]},this.initIndex(),this._addBorder({}),this._addStyle({numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}),this._addFill({type:"pattern",pattern:"none"}),this._addFill({type:"pattern",pattern:"gray125"}),this.weakMap=new WeakMap}render(y,S){S=S||this.model,y.openXml(i.StdDocAttributes),y.openNode("styleSheet",m.STYLESHEET_ATTRIBUTES),this.index?(S.numFmts&&S.numFmts.length&&(y.openNode("numFmts",{count:S.numFmts.length}),S.numFmts.forEach(C=>{y.writeXml(C)}),y.closeNode()),S.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),y.openNode("fonts",{count:S.fonts.length,"x14ac:knownFonts":1}),S.fonts.forEach(C=>{y.writeXml(C)}),y.closeNode(),y.openNode("fills",{count:S.fills.length}),S.fills.forEach(C=>{y.writeXml(C)}),y.closeNode(),y.openNode("borders",{count:S.borders.length}),S.borders.forEach(C=>{y.writeXml(C)}),y.closeNode(),this.map.cellStyleXfs.render(y,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),y.openNode("cellXfs",{count:S.styles.length}),S.styles.forEach(C=>{y.writeXml(C)}),y.closeNode()):(this.map.numFmts.render(y,S.numFmts),this.map.fonts.render(y,S.fonts),this.map.fills.render(y,S.fills),this.map.borders.render(y,S.borders),this.map.cellStyleXfs.render(y,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),this.map.cellXfs.render(y,S.styles)),m.STATIC_XFORMS.cellStyles.render(y),this.map.dxfs.render(y,S.dxfs),m.STATIC_XFORMS.tableStyles.render(y),m.STATIC_XFORMS.extLst.render(y),y.closeNode()}parseOpen(y){if(this.parser)return this.parser.parseOpen(y),!0;switch(y.name){case"styleSheet":return this.initIndex(),!0;default:return this.parser=this.map[y.name],this.parser&&this.parser.parseOpen(y),!0}}parseText(y){this.parser&&this.parser.parseText(y)}parseClose(y){if(this.parser)return this.parser.parseClose(y)||(this.parser=void 0),!0;switch(y){case"styleSheet":{this.model={};const S=(C,L)=>{L.model&&L.model.length&&(this.model[C]=L.model)};if(S("numFmts",this.map.numFmts),S("fonts",this.map.fonts),S("fills",this.map.fills),S("borders",this.map.borders),S("styles",this.map.cellXfs),S("dxfs",this.map.dxfs),this.index={model:[],numFmt:[]},this.model.numFmts){const C=this.index.numFmt;this.model.numFmts.forEach(L=>{C[L.id]=L.formatCode})}return!1}default:return!0}}addStyleModel(y,S){if(!y)return 0;if(this.model.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),this.weakMap&&this.weakMap.has(y))return this.weakMap.get(y);const C={};if(S=S||o.ValueType.Number,y.numFmt)C.numFmtId=this._addNumFmtStr(y.numFmt);else switch(S){case o.ValueType.Number:C.numFmtId=this._addNumFmtStr("General");break;case o.ValueType.Date:C.numFmtId=this._addNumFmtStr("mm-dd-yy")}y.font&&(C.fontId=this._addFont(y.font)),y.border&&(C.borderId=this._addBorder(y.border)),y.fill&&(C.fillId=this._addFill(y.fill)),y.alignment&&(C.alignment=y.alignment),y.protection&&(C.protection=y.protection);const L=this._addStyle(C);return this.weakMap&&this.weakMap.set(y,L),L}getStyleModel(y){const S=this.model.styles[y];if(!S)return null;let C=this.index.model[y];if(C)return C;if(C=this.index.model[y]={},S.numFmtId){const O=this.index.numFmt[S.numFmtId]||p.getDefaultFmtCode(S.numFmtId);O&&(C.numFmt=O)}function L(O,H,z){if(z||z===0){const q=H[z];q&&(C[O]=q)}}return L("font",this.model.fonts,S.fontId),L("border",this.model.borders,S.borderId),L("fill",this.model.fills,S.fillId),S.alignment&&(C.alignment=S.alignment),S.protection&&(C.protection=S.protection),C}addDxfStyle(y){return y.numFmt&&(y.numFmtId=this._addNumFmtStr(y.numFmt)),this.model.dxfs.push(y),this.model.dxfs.length-1}getDxfStyle(y){return this.model.dxfs[y]}_addStyle(y){const S=this.map.style.toXml(y);let C=this.index.style[S];return C===void 0&&(C=this.index.style[S]=this.model.styles.length,this.model.styles.push(S)),C}_addNumFmtStr(y){let S=p.getDefaultFmtId(y);if(S!==void 0||(S=this.index.numFmt[y],S!==void 0))return S;S=this.index.numFmt[y]=164+this.model.numFmts.length;const C=this.map.numFmt.toXml({id:S,formatCode:y});return this.model.numFmts.push(C),S}_addFont(y){const S=this.map.font.toXml(y);let C=this.index.font[S];return C===void 0&&(C=this.index.font[S]=this.model.fonts.length,this.model.fonts.push(S)),C}_addBorder(y){const S=this.map.border.toXml(y);let C=this.index.border[S];return C===void 0&&(C=this.index.border[S]=this.model.borders.length,this.model.borders.push(S)),C}_addFill(y){const S=this.map.fill.toXml(y);let C=this.index.fill[S];return C===void 0&&(C=this.index.fill[S]=this.model.fills.length,this.model.fills.push(S)),C}}m.STYLESHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac x16r2","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main"},m.STATIC_XFORMS={cellStyles:new u({tag:"cellStyles",$:{count:1},c:[{tag:"cellStyle",$:{name:"Normal",xfId:0,builtinId:0}}]}),dxfs:new u({tag:"dxfs",$:{count:0}}),tableStyles:new u({tag:"tableStyles",$:{count:0,defaultTableStyle:"TableStyleMedium2",defaultPivotStyle:"PivotStyleLight16"}}),extLst:new u({tag:"extLst",c:[{tag:"ext",$:{uri:"{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"},c:[{tag:"x14:slicerStyles",$:{defaultSlicerStyle:"SlicerStyleLight1"}}]},{tag:"ext",$:{uri:"{9260A510-F301-46a8-8635-F512D64BE5F5}","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},c:[{tag:"x15:timelineStyles",$:{defaultTimelineStyle:"TimeSlicerStyleLight1"}}]}]})},m.Mock=class extends m{constructor(){super(),this.model={styles:[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}],numFmts:[],fonts:[{size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}],borders:[{}],fills:[{type:"pattern",pattern:"none"},{type:"pattern",pattern:"gray125"}]}}parseStream(b){return b.autodrain(),Promise.resolve()}addStyleModel(b,y){switch(y){case o.ValueType.Date:return this.dateStyleId;default:return 0}}get dateStyleId(){if(!this._dateStyleId){const b={numFmtId:p.getDefaultFmtId("mm-dd-yy")};this._dateStyleId=this.model.styles.length,this.model.styles.push(b)}return this._dateStyleId}getStyleModel(){return{}}},n.exports=m},{"../../../doc/enums":7,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./border-xform":127,"./dxf-xform":129,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./style-xform":134}],136:[function(t,n,s){const o=t("../base-xform");class i extends o{constructor(u){super(),this.model=u}get tag(){return"u"}render(u,l){if((l=l||this.model)===!0)u.leafNode("u");else{const d=i.Attributes[l];d&&u.leafNode("u",d)}}parseOpen(u){u.name==="u"&&(this.model=u.attributes.val||!0)}parseText(){}parseClose(){return!1}}i.Attributes={single:{},double:{val:"double"},singleAccounting:{val:"singleAccounting"},doubleAccounting:{val:"doubleAccounting"}},n.exports=i},{"../base-xform":32}],137:[function(t,n,s){const o=t("../base-xform"),i=t("./filter-column-xform");n.exports=class extends o{constructor(){super(),this.map={filterColumn:new i}}get tag(){return"autoFilter"}prepare(c){c.columns.forEach((u,l)=>{this.map.filterColumn.prepare(u,{index:l})})}render(c,u){return c.openNode(this.tag,{ref:u.autoFilterRef}),u.columns.forEach(l=>{this.map.filterColumn.render(c,l)}),c.closeNode(),!0}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case this.tag:return this.model={autoFilterRef:c.attributes.ref,columns:[]},!0;default:if(this.parser=this.map[c.name],this.parser)return this.parseOpen(c),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(c))}}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.model.columns.push(this.parser.model),this.parser=void 0),!0;switch(c){case this.tag:return!1;default:throw new Error("Unexpected xml node in parseClose: "+c)}}}},{"../base-xform":32,"./filter-column-xform":139}],138:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{get tag(){return"customFilter"}render(i,c){i.leafNode(this.tag,{val:c.val,operator:c.operator})}parseOpen(i){return i.name===this.tag&&(this.model={val:i.attributes.val,operator:i.attributes.operator},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],139:[function(t,n,s){const o=t("../base-xform"),i=t("../list-xform"),c=t("./custom-filter-xform"),u=t("./filter-xform");n.exports=class extends o{constructor(){super(),this.map={customFilters:new i({tag:"customFilters",count:!1,empty:!0,childXform:new c}),filters:new i({tag:"filters",count:!1,empty:!0,childXform:new u})}}get tag(){return"filterColumn"}prepare(l,d){l.colId=d.index.toString()}render(l,d){return d.customFilters?(l.openNode(this.tag,{colId:d.colId,hiddenButton:d.filterButton?"0":"1"}),this.map.customFilters.render(l,d.customFilters),l.closeNode(),!0):(l.leafNode(this.tag,{colId:d.colId,hiddenButton:d.filterButton?"0":"1"}),!0)}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;const{attributes:d}=l;switch(l.name){case this.tag:return this.model={filterButton:d.hiddenButton==="0"},!0;default:if(this.parser=this.map[l.name],this.parser)return this.parseOpen(l),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(l))}}parseText(){}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.parser=void 0),!0;switch(l){case this.tag:return this.model.customFilters=this.map.customFilters.model,!1;default:return!0}}}},{"../base-xform":32,"../list-xform":71,"./custom-filter-xform":138,"./filter-xform":140}],140:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{get tag(){return"filter"}render(i,c){i.leafNode(this.tag,{val:c.val})}parseOpen(i){return i.name===this.tag&&(this.model={val:i.attributes.val},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],141:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{get tag(){return"tableColumn"}prepare(i,c){i.id=c.index+1}render(i,c){return i.leafNode(this.tag,{id:c.id.toString(),name:c.name,totalsRowLabel:c.totalsRowLabel,totalsRowFunction:c.totalsRowFunction,dxfId:c.dxfId}),!0}parseOpen(i){if(i.name===this.tag){const{attributes:c}=i;return this.model={name:c.name,totalsRowLabel:c.totalsRowLabel,totalsRowFunction:c.totalsRowFunction,dxfId:c.dxfId},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],142:[function(t,n,s){const o=t("../base-xform");n.exports=class extends o{get tag(){return"tableStyleInfo"}render(i,c){return i.leafNode(this.tag,{name:c.theme?c.theme:void 0,showFirstColumn:c.showFirstColumn?"1":"0",showLastColumn:c.showLastColumn?"1":"0",showRowStripes:c.showRowStripes?"1":"0",showColumnStripes:c.showColumnStripes?"1":"0"}),!0}parseOpen(i){if(i.name===this.tag){const{attributes:c}=i;return this.model={theme:c.name?c.name:null,showFirstColumn:c.showFirstColumn==="1",showLastColumn:c.showLastColumn==="1",showRowStripes:c.showRowStripes==="1",showColumnStripes:c.showColumnStripes==="1"},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],143:[function(t,n,s){const o=t("../../../utils/xml-stream"),i=t("../base-xform"),c=t("../list-xform"),u=t("./auto-filter-xform"),l=t("./table-column-xform"),d=t("./table-style-info-xform");class h extends i{constructor(){super(),this.map={autoFilter:new u,tableColumns:new c({tag:"tableColumns",count:!0,empty:!0,childXform:new l}),tableStyleInfo:new d}}prepare(p,v){this.map.autoFilter.prepare(p),this.map.tableColumns.prepare(p.columns,v)}get tag(){return"table"}render(p,v){p.openXml(o.StdDocAttributes),p.openNode(this.tag,{...h.TABLE_ATTRIBUTES,id:v.id,name:v.name,displayName:v.displayName||v.name,ref:v.tableRef,totalsRowCount:v.totalsRow?"1":void 0,totalsRowShown:v.totalsRow?void 0:"1",headerRowCount:v.headerRow?"1":"0"}),this.map.autoFilter.render(p,v),this.map.tableColumns.render(p,v.columns),this.map.tableStyleInfo.render(p,v.style),p.closeNode()}parseOpen(p){if(this.parser)return this.parser.parseOpen(p),!0;const{name:v,attributes:g}=p;switch(v){case this.tag:this.reset(),this.model={name:g.name,displayName:g.displayName||g.name,tableRef:g.ref,totalsRow:g.totalsRowCount==="1",headerRow:g.headerRowCount==="1"};break;default:this.parser=this.map[p.name],this.parser&&this.parser.parseOpen(p)}return!0}parseText(p){this.parser&&this.parser.parseText(p)}parseClose(p){if(this.parser)return this.parser.parseClose(p)||(this.parser=void 0),!0;switch(p){case this.tag:return this.model.columns=this.map.tableColumns.model,this.map.autoFilter.model&&(this.model.autoFilterRef=this.map.autoFilter.model.autoFilterRef,this.map.autoFilter.model.columns.forEach((v,g)=>{this.model.columns[g].filterButton=v.filterButton})),this.model.style=this.map.tableStyleInfo.model,!1;default:return!0}}reconcile(p,v){p.columns.forEach(g=>{g.dxfId!==void 0&&(g.style=v.styles.getDxfStyle(g.dxfId))})}}h.TABLE_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"xr xr3","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision","xmlns:xr3":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3"},n.exports=h},{"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":137,"./table-column-xform":141,"./table-style-info-xform":142}],144:[function(t,n,s){(function(o,i){(function(){const c=t("fs"),u=t("jszip"),{PassThrough:l}=t("readable-stream"),d=t("../utils/zip-stream"),h=t("../utils/stream-buf"),f=t("../utils/utils"),p=t("../utils/xml-stream"),{bufferToString:v}=t("../utils/browser-buffer-decode"),g=t("./xform/style/styles-xform"),m=t("./xform/core/core-xform"),b=t("./xform/strings/shared-strings-xform"),y=t("./xform/core/relationships-xform"),S=t("./xform/core/content-types-xform"),C=t("./xform/core/app-xform"),L=t("./xform/book/workbook-xform"),O=t("./xform/sheet/worksheet-xform"),H=t("./xform/drawing/drawing-xform"),z=t("./xform/table/table-xform"),q=t("./xform/comment/comments-xform"),D=t("./xform/comment/vml-notes-xform"),W=t("./xml/theme1");class P{constructor(U){this.workbook=U}async readFile(U,k){if(!await f.fs.exists(U))throw new Error("File not found: "+U);const _=c.createReadStream(U);try{const R=await this.read(_,k);return _.close(),R}catch(R){throw _.close(),R}}parseRels(U){return new y().parseStream(U)}parseWorkbook(U){return new L().parseStream(U)}parseSharedStrings(U){return new b().parseStream(U)}reconcile(U,k){const _=new L,R=new O(k),j=new H,A=new z;_.reconcile(U);const N={media:U.media,mediaIndex:U.mediaIndex};Object.keys(U.drawings).forEach(Z=>{const J=U.drawings[Z],re=U.drawingRels[Z];re&&(N.rels=re.reduce((X,ne)=>(X[ne.Id]=ne,X),{}),(J.anchors||[]).forEach(X=>{const ne=X.picture&&X.picture.hyperlinks;ne&&N.rels[ne.rId]&&(ne.hyperlink=N.rels[ne.rId].Target,delete ne.rId)}),j.reconcile(J,N))});const V={styles:U.styles};Object.values(U.tables).forEach(Z=>{A.reconcile(Z,V)});const M={styles:U.styles,sharedStrings:U.sharedStrings,media:U.media,mediaIndex:U.mediaIndex,date1904:U.properties&&U.properties.date1904,drawings:U.drawings,comments:U.comments,tables:U.tables,vmlDrawings:U.vmlDrawings};U.worksheets.forEach(Z=>{Z.relationships=U.worksheetRels[Z.sheetNo],R.reconcile(Z,M)}),delete U.worksheetHash,delete U.worksheetRels,delete U.globalRels,delete U.sharedStrings,delete U.workbookRels,delete U.sheetDefs,delete U.styles,delete U.mediaIndex,delete U.drawings,delete U.drawingRels,delete U.vmlDrawings}async _processWorksheetEntry(U,k,_,R,j){const A=new O(R),N=await A.parseStream(U);N.sheetNo=_,k.worksheetHash[j]=N,k.worksheets.push(N)}async _processCommentEntry(U,k,_){const R=new q,j=await R.parseStream(U);k.comments[`../${_}.xml`]=j}async _processTableEntry(U,k,_){const R=new z,j=await R.parseStream(U);k.tables[`../tables/${_}.xml`]=j}async _processWorksheetRelsEntry(U,k,_){const R=new y,j=await R.parseStream(U);k.worksheetRels[_]=j}async _processMediaEntry(U,k,_){const R=_.lastIndexOf(".");if(R>=1){const j=_.substr(R+1),A=_.substr(0,R);await new Promise((N,V)=>{const M=new h;M.on("finish",()=>{k.mediaIndex[_]=k.media.length,k.mediaIndex[A]=k.media.length;const Z={type:"image",name:A,extension:j,buffer:M.toBuffer()};k.media.push(Z),N()}),U.on("error",Z=>{V(Z)}),U.pipe(M)})}}async _processDrawingEntry(U,k,_){const R=new H,j=await R.parseStream(U);k.drawings[_]=j}async _processDrawingRelsEntry(U,k,_){const R=new y,j=await R.parseStream(U);k.drawingRels[_]=j}async _processVmlDrawingEntry(U,k,_){const R=new D,j=await R.parseStream(U);k.vmlDrawings[`../drawings/${_}.vml`]=j}async _processThemeEntry(U,k,_){await new Promise((R,j)=>{const A=new h;U.on("error",j),A.on("error",j),A.on("finish",()=>{k.themes[_]=A.read().toString(),R()}),U.pipe(A)})}createInputStream(){throw new Error("`XLSX#createInputStream` is deprecated. You should use `XLSX#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}async read(U,k){!U[Symbol.asyncIterator]&&U.pipe&&(U=U.pipe(new l));const _=[];for await(const R of U)_.push(R);return this.load(i.concat(_),k)}async load(U,k){let _;_=k&&k.base64?i.from(U.toString(),"base64"):U;const R={worksheets:[],worksheetHash:{},worksheetRels:[],themes:{},media:[],mediaIndex:{},drawings:{},drawingRels:{},comments:{},tables:{},vmlDrawings:{}},j=await u.loadAsync(_);for(const A of Object.values(j.files))if(!A.dir){let N,V=A.name;if(V[0]==="/"&&(V=V.substr(1)),V.match(/xl\/media\//)||V.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/))N=new l,N.write(await A.async("nodebuffer"));else{let M;N=new l({writableObjectMode:!0,readableObjectMode:!0}),M=o.browser?v(await A.async("nodebuffer")):await A.async("string");const Z=16384;for(let J=0;J<M.length;J+=Z)N.write(M.substring(J,J+Z))}switch(N.end(),V){case"_rels/.rels":R.globalRels=await this.parseRels(N);break;case"xl/workbook.xml":{const M=await this.parseWorkbook(N);R.sheets=M.sheets,R.definedNames=M.definedNames,R.views=M.views,R.properties=M.properties,R.calcProperties=M.calcProperties;break}case"xl/_rels/workbook.xml.rels":R.workbookRels=await this.parseRels(N);break;case"xl/sharedStrings.xml":R.sharedStrings=new b,await R.sharedStrings.parseStream(N);break;case"xl/styles.xml":R.styles=new g,await R.styles.parseStream(N);break;case"docProps/app.xml":{const M=new C,Z=await M.parseStream(N);R.company=Z.company,R.manager=Z.manager;break}case"docProps/core.xml":{const M=new m,Z=await M.parseStream(N);Object.assign(R,Z);break}default:{let M=V.match(/xl\/worksheets\/sheet(\d+)[.]xml/);if(M){await this._processWorksheetEntry(N,R,M[1],k,V);break}if(M=V.match(/xl\/worksheets\/_rels\/sheet(\d+)[.]xml.rels/),M){await this._processWorksheetRelsEntry(N,R,M[1]);break}if(M=V.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/),M){await this._processThemeEntry(N,R,M[1]);break}if(M=V.match(/xl\/media\/([a-zA-Z0-9]+[.][a-zA-Z0-9]{3,4})$/),M){await this._processMediaEntry(N,R,M[1]);break}if(M=V.match(/xl\/drawings\/([a-zA-Z0-9]+)[.]xml/),M){await this._processDrawingEntry(N,R,M[1]);break}if(M=V.match(/xl\/(comments\d+)[.]xml/),M){await this._processCommentEntry(N,R,M[1]);break}if(M=V.match(/xl\/tables\/(table\d+)[.]xml/),M){await this._processTableEntry(N,R,M[1]);break}if(M=V.match(/xl\/drawings\/_rels\/([a-zA-Z0-9]+)[.]xml[.]rels/),M){await this._processDrawingRelsEntry(N,R,M[1]);break}if(M=V.match(/xl\/drawings\/(vmlDrawing\d+)[.]vml/),M){await this._processVmlDrawingEntry(N,R,M[1]);break}}}}return this.reconcile(R,k),this.workbook.model=R,this.workbook}async addMedia(U,k){await Promise.all(k.media.map(async _=>{if(_.type==="image"){const R=`xl/media/${_.name}.${_.extension}`;if(_.filename){const j=await function(A,N){return new Promise((V,M)=>{c.readFile(A,N,(Z,J)=>{Z?M(Z):V(J)})})}(_.filename);return U.append(j,{name:R})}if(_.buffer)return U.append(_.buffer,{name:R});if(_.base64){const j=_.base64,A=j.substring(j.indexOf(",")+1);return U.append(A,{name:R,base64:!0})}}throw new Error("Unsupported media")}))}addDrawings(U,k){const _=new H,R=new y;k.worksheets.forEach(j=>{const{drawing:A}=j;if(A){_.prepare(A,{});let N=_.toXml(A);U.append(N,{name:`xl/drawings/${A.name}.xml`}),N=R.toXml(A.rels),U.append(N,{name:`xl/drawings/_rels/${A.name}.xml.rels`})}})}addTables(U,k){const _=new z;k.worksheets.forEach(R=>{const{tables:j}=R;j.forEach(A=>{_.prepare(A,{});const N=_.toXml(A);U.append(N,{name:"xl/tables/"+A.target})})})}async addContentTypes(U,k){const _=new S().toXml(k);U.append(_,{name:"[Content_Types].xml"})}async addApp(U,k){const _=new C().toXml(k);U.append(_,{name:"docProps/app.xml"})}async addCore(U,k){const _=new m;U.append(_.toXml(k),{name:"docProps/core.xml"})}async addThemes(U,k){const _=k.themes||{theme1:W};Object.keys(_).forEach(R=>{const j=_[R],A=`xl/theme/${R}.xml`;U.append(j,{name:A})})}async addOfficeRels(U){const k=new y().toXml([{Id:"rId1",Type:P.RelType.OfficeDocument,Target:"xl/workbook.xml"},{Id:"rId2",Type:P.RelType.CoreProperties,Target:"docProps/core.xml"},{Id:"rId3",Type:P.RelType.ExtenderProperties,Target:"docProps/app.xml"}]);U.append(k,{name:"_rels/.rels"})}async addWorkbookRels(U,k){let _=1;const R=[{Id:"rId"+_++,Type:P.RelType.Styles,Target:"styles.xml"},{Id:"rId"+_++,Type:P.RelType.Theme,Target:"theme/theme1.xml"}];k.sharedStrings.count&&R.push({Id:"rId"+_++,Type:P.RelType.SharedStrings,Target:"sharedStrings.xml"}),k.worksheets.forEach(A=>{A.rId="rId"+_++,R.push({Id:A.rId,Type:P.RelType.Worksheet,Target:`worksheets/sheet${A.id}.xml`})});const j=new y().toXml(R);U.append(j,{name:"xl/_rels/workbook.xml.rels"})}async addSharedStrings(U,k){k.sharedStrings&&k.sharedStrings.count&&U.append(k.sharedStrings.xml,{name:"xl/sharedStrings.xml"})}async addStyles(U,k){const{xml:_}=k.styles;_&&U.append(_,{name:"xl/styles.xml"})}async addWorkbook(U,k){const _=new L;U.append(_.toXml(k),{name:"xl/workbook.xml"})}async addWorksheets(U,k){const _=new O,R=new y,j=new q,A=new D;k.worksheets.forEach(N=>{let V=new p;_.render(V,N),U.append(V.xml,{name:`xl/worksheets/sheet${N.id}.xml`}),N.rels&&N.rels.length&&(V=new p,R.render(V,N.rels),U.append(V.xml,{name:`xl/worksheets/_rels/sheet${N.id}.xml.rels`})),N.comments.length>0&&(V=new p,j.render(V,N),U.append(V.xml,{name:`xl/comments${N.id}.xml`}),V=new p,A.render(V,N),U.append(V.xml,{name:`xl/drawings/vmlDrawing${N.id}.vml`}))})}_finalize(U){return new Promise((k,_)=>{U.on("finish",()=>{k(this)}),U.on("error",_),U.finalize()})}prepareModel(U,k){U.creator=U.creator||"ExcelJS",U.lastModifiedBy=U.lastModifiedBy||"ExcelJS",U.created=U.created||new Date,U.modified=U.modified||new Date,U.useSharedStrings=k.useSharedStrings===void 0||k.useSharedStrings,U.useStyles=k.useStyles===void 0||k.useStyles,U.sharedStrings=new b,U.styles=U.useStyles?new g(!0):new g.Mock;const _=new L,R=new O;_.prepare(U);const j={sharedStrings:U.sharedStrings,styles:U.styles,date1904:U.properties.date1904,drawingsCount:0,media:U.media};j.drawings=U.drawings=[],j.commentRefs=U.commentRefs=[];let A=0;U.tables=[],U.worksheets.forEach(N=>{N.tables.forEach(V=>{A++,V.target=`table${A}.xml`,V.id=A,U.tables.push(V)}),R.prepare(N,j)})}async write(U,k){k=k||{};const{model:_}=this.workbook,R=new d.ZipWriter(k.zip);return R.pipe(U),this.prepareModel(_,k),await this.addContentTypes(R,_),await this.addOfficeRels(R,_),await this.addWorkbookRels(R,_),await this.addWorksheets(R,_),await this.addSharedStrings(R,_),await this.addDrawings(R,_),await this.addTables(R,_),await Promise.all([this.addThemes(R,_),this.addStyles(R,_)]),await this.addMedia(R,_),await Promise.all([this.addApp(R,_),this.addCore(R,_)]),await this.addWorkbook(R,_),this._finalize(R)}writeFile(U,k){const _=c.createWriteStream(U);return new Promise((R,j)=>{_.on("finish",()=>{R()}),_.on("error",A=>{j(A)}),this.write(_,k).then(()=>{_.end()}).catch(A=>{j(A)})})}async writeBuffer(U){const k=new h;return await this.write(k,U),k.read()}}P.RelType=t("./rel-type"),n.exports=P}).call(this)}).call(this,t("_process"),t("buffer").Buffer)},{"../utils/browser-buffer-decode":16,"../utils/stream-buf":24,"../utils/utils":27,"../utils/xml-stream":28,"../utils/zip-stream":29,"./rel-type":31,"./xform/book/workbook-xform":38,"./xform/comment/comments-xform":40,"./xform/comment/vml-notes-xform":45,"./xform/core/app-xform":51,"./xform/core/content-types-xform":52,"./xform/core/core-xform":53,"./xform/core/relationships-xform":55,"./xform/drawing/drawing-xform":62,"./xform/sheet/worksheet-xform":115,"./xform/strings/shared-strings-xform":124,"./xform/style/styles-xform":135,"./xform/table/table-xform":143,"./xml/theme1":145,_process:467,buffer:220,fs:216,jszip:441,"readable-stream":491}],145:[function(t,n,s){n.exports=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"> <a:themeElements> <a:clrScheme name="Office"> <a:dk1> <a:sysClr val="windowText" lastClr="000000"/> </a:dk1> <a:lt1> <a:sysClr val="window" lastClr="FFFFFF"/> </a:lt1> <a:dk2> <a:srgbClr val="1F497D"/> </a:dk2> <a:lt2> <a:srgbClr val="EEECE1"/> </a:lt2> <a:accent1> <a:srgbClr val="4F81BD"/> </a:accent1> <a:accent2> <a:srgbClr val="C0504D"/> </a:accent2> <a:accent3> <a:srgbClr val="9BBB59"/> </a:accent3> <a:accent4> <a:srgbClr val="8064A2"/> </a:accent4> <a:accent5> <a:srgbClr val="4BACC6"/> </a:accent5> <a:accent6> <a:srgbClr val="F79646"/> </a:accent6> <a:hlink> <a:srgbClr val="0000FF"/> </a:hlink> <a:folHlink> <a:srgbClr val="800080"/> </a:folHlink> </a:clrScheme> <a:fontScheme name="Office"> <a:majorFont> <a:latin typeface="Cambria"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Times New Roman"/> <a:font script="Hebr" typeface="Times New Roman"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="MoolBoran"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Times New Roman"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:majorFont> <a:minorFont> <a:latin typeface="Calibri"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Arial"/> <a:font script="Hebr" typeface="Arial"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="DaunPenh"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Arial"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:minorFont> </a:fontScheme> <a:fmtScheme name="Office"> <a:fillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="35000"> <a:schemeClr val="phClr"> <a:tint val="37000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="15000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="1"/> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="100000"/> <a:shade val="100000"/> <a:satMod val="130000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:shade val="100000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="0"/> </a:gradFill> </a:fillStyleLst> <a:lnStyleLst> <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"> <a:shade val="95000"/> <a:satMod val="105000"/> </a:schemeClr> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> </a:lnStyleLst> <a:effectStyleLst> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="38000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> <a:scene3d> <a:camera prst="orthographicFront"> <a:rot lat="0" lon="0" rev="0"/> </a:camera> <a:lightRig rig="threePt" dir="t"> <a:rot lat="0" lon="0" rev="1200000"/> </a:lightRig> </a:scene3d> <a:sp3d> <a:bevelT w="63500" h="25400"/> </a:sp3d> </a:effectStyle> </a:effectStyleLst> <a:bgFillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="40000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="40000"> <a:schemeClr val="phClr"> <a:tint val="45000"/> <a:shade val="99000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="20000"/> <a:satMod val="255000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="-80000" r="50000" b="180000"/> </a:path> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="80000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="30000"/> <a:satMod val="200000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="50000" r="50000" b="50000"/> </a:path> </a:gradFill> </a:bgFillStyleLst> </a:fmtScheme> </a:themeElements> <a:objectDefaults> <a:spDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="1"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="3"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="2"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="lt1"/> </a:fontRef> </a:style> </a:spDef> <a:lnDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="2"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="0"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="1"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="tx1"/> </a:fontRef> </a:style> </a:lnDef> </a:objectDefaults> <a:extraClrSchemeLst/> </a:theme>`},{}],146:[function(t,n,s){(function(o){(function(){Object.defineProperty(s,"__esModule",{value:!0}),s.CsvFormatterStream=void 0;const i=t("stream"),c=t("./formatter");class u extends i.Transform{constructor(d){super({writableObjectMode:d.objectMode}),this.hasWrittenBOM=!1,this.formatterOptions=d,this.rowFormatter=new c.RowFormatter(d),this.hasWrittenBOM=!d.writeBOM}transform(d){return this.rowFormatter.rowTransform=d,this}_transform(d,h,f){let p=!1;try{this.hasWrittenBOM||(this.push(this.formatterOptions.BOM),this.hasWrittenBOM=!0),this.rowFormatter.format(d,(v,g)=>v?(p=!0,f(v)):(g&&g.forEach(m=>{this.push(o.from(m,"utf8"))}),p=!0,f()))}catch(v){if(p)throw v;f(v)}}_flush(d){this.rowFormatter.finish((h,f)=>h?d(h):(f&&f.forEach(p=>{this.push(o.from(p,"utf8"))}),d()))}}s.CsvFormatterStream=u}).call(this)}).call(this,t("buffer").Buffer)},{"./formatter":150,buffer:220,stream:505}],147:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.FormatterOptions=void 0,s.FormatterOptions=class{constructor(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};var i;this.objectMode=!0,this.delimiter=",",this.rowDelimiter=`
`,this.quote='"',this.escape=this.quote,this.quoteColumns=!1,this.quoteHeaders=this.quoteColumns,this.headers=null,this.includeEndRowDelimiter=!1,this.writeBOM=!1,this.BOM="\uFEFF",this.alwaysWriteHeaders=!1,Object.assign(this,o||{}),(o==null?void 0:o.quoteHeaders)===void 0&&(this.quoteHeaders=this.quoteColumns),(o==null?void 0:o.quote)===!0?this.quote='"':(o==null?void 0:o.quote)===!1&&(this.quote=""),typeof(o==null?void 0:o.escape)!="string"&&(this.escape=this.quote),this.shouldWriteHeaders=!!this.headers&&((i=o.writeHeaders)===null||i===void 0||i),this.headers=Array.isArray(this.headers)?this.headers:null,this.escapedQuote=`${this.escape}${this.quote}`}}},{}],148:[function(t,n,s){var o=function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(s,"__esModule",{value:!0}),s.FieldFormatter=void 0;const i=o(t("lodash.isboolean")),c=o(t("lodash.isnil")),u=o(t("lodash.escaperegexp"));s.FieldFormatter=class{constructor(l){this._headers=null,this.formatterOptions=l,l.headers!==null&&(this.headers=l.headers),this.REPLACE_REGEXP=new RegExp(l.quote,"g");const d=`[${l.delimiter}${u.default(l.rowDelimiter)}|\r|
]`;this.ESCAPE_REGEXP=new RegExp(d)}set headers(l){this._headers=l}shouldQuote(l,d){const h=d?this.formatterOptions.quoteHeaders:this.formatterOptions.quoteColumns;return i.default(h)?h:Array.isArray(h)?h[l]:this._headers!==null&&h[this._headers[l]]}format(l,d,h){const f=(""+(c.default(l)?"":l)).replace(/\0/g,""),{formatterOptions:p}=this;return p.quote!==""&&f.indexOf(p.quote)!==-1?this.quoteField(f.replace(this.REPLACE_REGEXP,p.escapedQuote)):f.search(this.ESCAPE_REGEXP)!==-1||this.shouldQuote(d,h)?this.quoteField(f):f}quoteField(l){const{quote:d}=this.formatterOptions;return`${d}${l}${d}`}}},{"lodash.escaperegexp":442,"lodash.isboolean":444,"lodash.isnil":447}],149:[function(t,n,s){var o=function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(s,"__esModule",{value:!0}),s.RowFormatter=void 0;const i=o(t("lodash.isfunction")),c=o(t("lodash.isequal")),u=t("./FieldFormatter"),l=t("../types");class d{constructor(f){this.rowCount=0,this.formatterOptions=f,this.fieldFormatter=new u.FieldFormatter(f),this.headers=f.headers,this.shouldWriteHeaders=f.shouldWriteHeaders,this.hasWrittenHeaders=!1,this.headers!==null&&(this.fieldFormatter.headers=this.headers),f.transform&&(this.rowTransform=f.transform)}static isRowHashArray(f){return!!Array.isArray(f)&&Array.isArray(f[0])&&f[0].length===2}static isRowArray(f){return Array.isArray(f)&&!this.isRowHashArray(f)}static gatherHeaders(f){return d.isRowHashArray(f)?f.map(p=>p[0]):Array.isArray(f)?f:Object.keys(f)}static createTransform(f){return l.isSyncTransform(f)?(p,v)=>{let g=null;try{g=f(p)}catch(m){return v(m)}return v(null,g)}:(p,v)=>{f(p,v)}}set rowTransform(f){if(!i.default(f))throw new TypeError("The transform should be a function");this._rowTransform=d.createTransform(f)}format(f,p){this.callTransformer(f,(v,g)=>{if(v)return p(v);if(!f)return p(null);const m=[];if(g){const{shouldFormatColumns:b,headers:y}=this.checkHeaders(g);if(this.shouldWriteHeaders&&y&&!this.hasWrittenHeaders&&(m.push(this.formatColumns(y,!0)),this.hasWrittenHeaders=!0),b){const S=this.gatherColumns(g);m.push(this.formatColumns(S,!1))}}return p(null,m)})}finish(f){const p=[];if(this.formatterOptions.alwaysWriteHeaders&&this.rowCount===0){if(!this.headers)return f(new Error("`alwaysWriteHeaders` option is set to true but `headers` option not provided."));p.push(this.formatColumns(this.headers,!0))}return this.formatterOptions.includeEndRowDelimiter&&p.push(this.formatterOptions.rowDelimiter),f(null,p)}checkHeaders(f){if(this.headers)return{shouldFormatColumns:!0,headers:this.headers};const p=d.gatherHeaders(f);return this.headers=p,this.fieldFormatter.headers=p,this.shouldWriteHeaders?{shouldFormatColumns:!c.default(p,f),headers:p}:{shouldFormatColumns:!0,headers:null}}gatherColumns(f){if(this.headers===null)throw new Error("Headers is currently null");return Array.isArray(f)?d.isRowHashArray(f)?this.headers.map((p,v)=>{const g=f[v];return g?g[1]:""}):d.isRowArray(f)&&!this.shouldWriteHeaders?f:this.headers.map((p,v)=>f[v]):this.headers.map(p=>f[p])}callTransformer(f,p){return this._rowTransform?this._rowTransform(f,p):p(null,f)}formatColumns(f,p){const v=f.map((m,b)=>this.fieldFormatter.format(m,b,p)).join(this.formatterOptions.delimiter),{rowCount:g}=this;return this.rowCount+=1,g?[this.formatterOptions.rowDelimiter,v].join(""):v}}s.RowFormatter=d},{"../types":152,"./FieldFormatter":148,"lodash.isequal":445,"lodash.isfunction":446}],150:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.FieldFormatter=s.RowFormatter=void 0;var o=t("./RowFormatter");Object.defineProperty(s,"RowFormatter",{enumerable:!0,get:function(){return o.RowFormatter}});var i=t("./FieldFormatter");Object.defineProperty(s,"FieldFormatter",{enumerable:!0,get:function(){return i.FieldFormatter}})},{"./FieldFormatter":148,"./RowFormatter":149}],151:[function(t,n,s){(function(o){(function(){var i=Object.create?function(b,y,S,C){C===void 0&&(C=S),Object.defineProperty(b,C,{enumerable:!0,get:function(){return y[S]}})}:function(b,y,S,C){C===void 0&&(C=S),b[C]=y[S]},c=Object.create?function(b,y){Object.defineProperty(b,"default",{enumerable:!0,value:y})}:function(b,y){b.default=y},u=function(b){if(b&&b.__esModule)return b;var y={};if(b!=null)for(var S in b)S!=="default"&&Object.prototype.hasOwnProperty.call(b,S)&&i(y,b,S);return c(y,b),y},l=function(b,y){for(var S in b)S==="default"||Object.prototype.hasOwnProperty.call(y,S)||i(y,b,S)};Object.defineProperty(s,"__esModule",{value:!0}),s.writeToPath=s.writeToString=s.writeToBuffer=s.writeToStream=s.write=s.format=s.FormatterOptions=s.CsvFormatterStream=void 0;const d=t("util"),h=t("stream"),f=u(t("fs")),p=t("./FormatterOptions"),v=t("./CsvFormatterStream");l(t("./types"),s);var g=t("./CsvFormatterStream");Object.defineProperty(s,"CsvFormatterStream",{enumerable:!0,get:function(){return g.CsvFormatterStream}});var m=t("./FormatterOptions");Object.defineProperty(s,"FormatterOptions",{enumerable:!0,get:function(){return m.FormatterOptions}}),s.format=b=>new v.CsvFormatterStream(new p.FormatterOptions(b)),s.write=(b,y)=>{const S=s.format(y),C=d.promisify((L,O)=>{S.write(L,void 0,O)});return b.reduce((L,O)=>L.then(()=>C(O)),Promise.resolve()).then(()=>S.end()).catch(L=>{S.emit("error",L)}),S},s.writeToStream=(b,y,S)=>s.write(y,S).pipe(b),s.writeToBuffer=function(b){let y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const S=[],C=new h.Writable({write(L,O,H){S.push(L),H()}});return new Promise((L,O)=>{C.on("error",O).on("finish",()=>L(o.concat(S))),s.write(b,y).pipe(C)})},s.writeToString=(b,y)=>s.writeToBuffer(b,y).then(S=>S.toString()),s.writeToPath=(b,y,S)=>{const C=f.createWriteStream(b,{encoding:"utf8"});return s.write(y,S).pipe(C)}}).call(this)}).call(this,t("buffer").Buffer)},{"./CsvFormatterStream":146,"./FormatterOptions":147,"./types":152,buffer:220,fs:216,stream:505,util:527}],152:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.isSyncTransform=void 0,s.isSyncTransform=o=>o.length===1},{}],153:[function(t,n,s){(function(o){(function(){Object.defineProperty(s,"__esModule",{value:!0}),s.CsvParserStream=void 0;const i=t("string_decoder"),c=t("stream"),u=t("./transforms"),l=t("./parser");class d extends c.Transform{constructor(f){super({objectMode:f.objectMode}),this.lines="",this.rowCount=0,this.parsedRowCount=0,this.parsedLineCount=0,this.endEmitted=!1,this.headersEmitted=!1,this.parserOptions=f,this.parser=new l.Parser(f),this.headerTransformer=new u.HeaderTransformer(f),this.decoder=new i.StringDecoder(f.encoding),this.rowTransformerValidator=new u.RowTransformerValidator}get hasHitRowLimit(){return this.parserOptions.limitRows&&this.rowCount>=this.parserOptions.maxRows}get shouldEmitRows(){return this.parsedRowCount>this.parserOptions.skipRows}get shouldSkipLine(){return this.parsedLineCount<=this.parserOptions.skipLines}transform(f){return this.rowTransformerValidator.rowTransform=f,this}validate(f){return this.rowTransformerValidator.rowValidator=f,this}emit(f){if(f==="end")return this.endEmitted||(this.endEmitted=!0,super.emit("end",this.rowCount)),!1;for(var p=arguments.length,v=new Array(p>1?p-1:0),g=1;g<p;g++)v[g-1]=arguments[g];return super.emit(f,...v)}_transform(f,p,v){if(this.hasHitRowLimit)return v();const g=d.wrapDoneCallback(v);try{const{lines:m}=this,b=m+this.decoder.write(f),y=this.parse(b,!0);return this.processRows(y,g)}catch(m){return g(m)}}_flush(f){const p=d.wrapDoneCallback(f);if(this.hasHitRowLimit)return p();try{const v=this.lines+this.decoder.end(),g=this.parse(v,!1);return this.processRows(g,p)}catch(v){return p(v)}}parse(f,p){if(!f)return[];const{line:v,rows:g}=this.parser.parse(f,p);return this.lines=v,g}processRows(f,p){const v=f.length,g=m=>{const b=C=>C?p(C):m%100!=0?g(m+1):void o(()=>g(m+1));if(this.checkAndEmitHeaders(),m>=v||this.hasHitRowLimit)return p();if(this.parsedLineCount+=1,this.shouldSkipLine)return b();const y=f[m];this.rowCount+=1,this.parsedRowCount+=1;const S=this.rowCount;return this.transformRow(y,(C,L)=>{if(C)return this.rowCount-=1,b(C);if(!L)return b(new Error("expected transform result"));if(L.isValid){if(L.row)return this.pushRow(L.row,b)}else this.emit("data-invalid",L.row,S,L.reason);return b()})};g(0)}transformRow(f,p){try{this.headerTransformer.transform(f,(v,g)=>v?p(v):g?g.isValid?g.row?this.shouldEmitRows?this.rowTransformerValidator.transformAndValidate(g.row,p):this.skipRow(p):(this.rowCount-=1,this.parsedRowCount-=1,p(null,{row:null,isValid:!0})):this.shouldEmitRows?p(null,{isValid:!1,row:f}):this.skipRow(p):p(new Error("Expected result from header transform")))}catch(v){p(v)}}checkAndEmitHeaders(){!this.headersEmitted&&this.headerTransformer.headers&&(this.headersEmitted=!0,this.emit("headers",this.headerTransformer.headers))}skipRow(f){return this.rowCount-=1,f(null,{row:null,isValid:!0})}pushRow(f,p){try{this.parserOptions.objectMode?this.push(f):this.push(JSON.stringify(f)),p()}catch(v){p(v)}}static wrapDoneCallback(f){let p=!1;return function(v){if(v){if(p)throw v;return p=!0,void f(v)}for(var g=arguments.length,m=new Array(g>1?g-1:0),b=1;b<g;b++)m[b-1]=arguments[b];f(...m)}}}s.CsvParserStream=d}).call(this)}).call(this,t("timers").setImmediate)},{"./parser":165,"./transforms":168,stream:505,string_decoder:218,timers:523}],154:[function(t,n,s){var o=function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(s,"__esModule",{value:!0}),s.ParserOptions=void 0;const i=o(t("lodash.escaperegexp")),c=o(t("lodash.isnil"));s.ParserOptions=class{constructor(u){var l;if(this.objectMode=!0,this.delimiter=",",this.ignoreEmpty=!1,this.quote='"',this.escape=null,this.escapeChar=this.quote,this.comment=null,this.supportsComments=!1,this.ltrim=!1,this.rtrim=!1,this.trim=!1,this.headers=null,this.renameHeaders=!1,this.strictColumnHandling=!1,this.discardUnmappedColumns=!1,this.carriageReturn="\r",this.encoding="utf8",this.limitRows=!1,this.maxRows=0,this.skipLines=0,this.skipRows=0,Object.assign(this,u||{}),this.delimiter.length>1)throw new Error("delimiter option must be one character long");this.escapedDelimiter=i.default(this.delimiter),this.escapeChar=(l=this.escape)!==null&&l!==void 0?l:this.quote,this.supportsComments=!c.default(this.comment),this.NEXT_TOKEN_REGEXP=new RegExp(`([^\\s]|\\r\\n|\\n|\\r|${this.escapedDelimiter})`),this.maxRows>0&&(this.limitRows=!0)}}},{"lodash.escaperegexp":442,"lodash.isnil":447}],155:[function(t,n,s){var o=Object.create?function(g,m,b,y){y===void 0&&(y=b),Object.defineProperty(g,y,{enumerable:!0,get:function(){return m[b]}})}:function(g,m,b,y){y===void 0&&(y=b),g[y]=m[b]},i=Object.create?function(g,m){Object.defineProperty(g,"default",{enumerable:!0,value:m})}:function(g,m){g.default=m},c=function(g){if(g&&g.__esModule)return g;var m={};if(g!=null)for(var b in g)b!=="default"&&Object.prototype.hasOwnProperty.call(g,b)&&o(m,g,b);return i(m,g),m},u=function(g,m){for(var b in g)b==="default"||Object.prototype.hasOwnProperty.call(m,b)||o(m,g,b)};Object.defineProperty(s,"__esModule",{value:!0}),s.parseString=s.parseFile=s.parseStream=s.parse=s.ParserOptions=s.CsvParserStream=void 0;const l=c(t("fs")),d=t("stream"),h=t("./ParserOptions"),f=t("./CsvParserStream");u(t("./types"),s);var p=t("./CsvParserStream");Object.defineProperty(s,"CsvParserStream",{enumerable:!0,get:function(){return p.CsvParserStream}});var v=t("./ParserOptions");Object.defineProperty(s,"ParserOptions",{enumerable:!0,get:function(){return v.ParserOptions}}),s.parse=g=>new f.CsvParserStream(new h.ParserOptions(g)),s.parseStream=(g,m)=>g.pipe(new f.CsvParserStream(new h.ParserOptions(m))),s.parseFile=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return l.createReadStream(g).pipe(new f.CsvParserStream(new h.ParserOptions(m)))},s.parseString=(g,m)=>{const b=new d.Readable;return b.push(g),b.push(null),b.pipe(new f.CsvParserStream(new h.ParserOptions(m)))}},{"./CsvParserStream":153,"./ParserOptions":154,"./types":169,fs:216,stream:505}],156:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.Parser=void 0;const o=t("./Scanner"),i=t("./RowParser"),c=t("./Token");class u{constructor(d){this.parserOptions=d,this.rowParser=new i.RowParser(this.parserOptions)}static removeBOM(d){return d&&d.charCodeAt(0)===65279?d.slice(1):d}parse(d,h){const f=new o.Scanner({line:u.removeBOM(d),parserOptions:this.parserOptions,hasMoreData:h});return this.parserOptions.supportsComments?this.parseWithComments(f):this.parseWithoutComments(f)}parseWithoutComments(d){const h=[];let f=!0;for(;f;)f=this.parseRow(d,h);return{line:d.line,rows:h}}parseWithComments(d){const{parserOptions:h}=this,f=[];for(let p=d.nextCharacterToken;p!==null;p=d.nextCharacterToken)if(c.Token.isTokenComment(p,h)){if(d.advancePastLine()===null)return{line:d.lineFromCursor,rows:f};if(!d.hasMoreCharacters)return{line:d.lineFromCursor,rows:f};d.truncateToCursor()}else if(!this.parseRow(d,f))break;return{line:d.line,rows:f}}parseRow(d,h){if(!d.nextNonSpaceToken)return!1;const f=this.rowParser.parse(d);return f!==null&&(this.parserOptions.ignoreEmpty&&i.RowParser.isEmptyRow(f)||h.push(f),!0)}}s.Parser=u},{"./RowParser":157,"./Scanner":158,"./Token":159}],157:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.RowParser=void 0;const o=t("./column"),i=t("./Token");s.RowParser=class{constructor(c){this.parserOptions=c,this.columnParser=new o.ColumnParser(c)}static isEmptyRow(c){return c.join("").replace(/\s+/g,"")===""}parse(c){const{parserOptions:u}=this,{hasMoreData:l}=c,d=c,h=[];let f=this.getStartToken(d,h);for(;f;){if(i.Token.isTokenRowDelimiter(f))return d.advancePastToken(f),!d.hasMoreCharacters&&i.Token.isTokenCarriageReturn(f,u)&&l?null:(d.truncateToCursor(),h);if(!this.shouldSkipColumnParse(d,f,h)){const p=this.columnParser.parse(d);if(p===null)return null;h.push(p)}f=d.nextNonSpaceToken}return l?null:(d.truncateToCursor(),h)}getStartToken(c,u){const l=c.nextNonSpaceToken;return l!==null&&i.Token.isTokenDelimiter(l,this.parserOptions)?(u.push(""),c.nextNonSpaceToken):l}shouldSkipColumnParse(c,u,l){const{parserOptions:d}=this;if(i.Token.isTokenDelimiter(u,d)){c.advancePastToken(u);const h=c.nextCharacterToken;if(!c.hasMoreCharacters||h!==null&&i.Token.isTokenRowDelimiter(h)||h!==null&&i.Token.isTokenDelimiter(h,d))return l.push(""),!0}return!1}}},{"./Token":159,"./column":164}],158:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.Scanner=void 0;const o=t("./Token"),i=/((?:\r\n)|\n|\r)/;s.Scanner=class{constructor(c){this.cursor=0,this.line=c.line,this.lineLength=this.line.length,this.parserOptions=c.parserOptions,this.hasMoreData=c.hasMoreData,this.cursor=c.cursor||0}get hasMoreCharacters(){return this.lineLength>this.cursor}get nextNonSpaceToken(){const{lineFromCursor:c}=this,u=this.parserOptions.NEXT_TOKEN_REGEXP;if(c.search(u)===-1)return null;const l=u.exec(c);if(l==null)return null;const d=l[1],h=this.cursor+(l.index||0);return new o.Token({token:d,startCursor:h,endCursor:h+d.length-1})}get nextCharacterToken(){const{cursor:c,lineLength:u}=this;return u<=c?null:new o.Token({token:this.line[c],startCursor:c,endCursor:c})}get lineFromCursor(){return this.line.substr(this.cursor)}advancePastLine(){const c=i.exec(this.lineFromCursor);return c?(this.cursor+=(c.index||0)+c[0].length,this):this.hasMoreData?null:(this.cursor=this.lineLength,this)}advanceTo(c){return this.cursor=c,this}advanceToToken(c){return this.cursor=c.startCursor,this}advancePastToken(c){return this.cursor=c.endCursor+1,this}truncateToCursor(){return this.line=this.lineFromCursor,this.lineLength=this.line.length,this.cursor=0,this}}},{"./Token":159}],159:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.Token=void 0,s.Token=class{constructor(o){this.token=o.token,this.startCursor=o.startCursor,this.endCursor=o.endCursor}static isTokenRowDelimiter(o){const i=o.token;return i==="\r"||i===`
`||i===`\r
`}static isTokenCarriageReturn(o,i){return o.token===i.carriageReturn}static isTokenComment(o,i){return i.supportsComments&&!!o&&o.token===i.comment}static isTokenEscapeCharacter(o,i){return o.token===i.escapeChar}static isTokenQuote(o,i){return o.token===i.quote}static isTokenDelimiter(o,i){return o.token===i.delimiter}}},{}],160:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.ColumnFormatter=void 0,s.ColumnFormatter=class{constructor(o){o.trim?this.format=i=>i.trim():o.ltrim?this.format=i=>i.trimLeft():o.rtrim?this.format=i=>i.trimRight():this.format=i=>i}}},{}],161:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.ColumnParser=void 0;const o=t("./NonQuotedColumnParser"),i=t("./QuotedColumnParser"),c=t("../Token");s.ColumnParser=class{constructor(u){this.parserOptions=u,this.quotedColumnParser=new i.QuotedColumnParser(u),this.nonQuotedColumnParser=new o.NonQuotedColumnParser(u)}parse(u){const{nextNonSpaceToken:l}=u;return l!==null&&c.Token.isTokenQuote(l,this.parserOptions)?(u.advanceToToken(l),this.quotedColumnParser.parse(u)):this.nonQuotedColumnParser.parse(u)}}},{"../Token":159,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],162:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.NonQuotedColumnParser=void 0;const o=t("./ColumnFormatter"),i=t("../Token");s.NonQuotedColumnParser=class{constructor(c){this.parserOptions=c,this.columnFormatter=new o.ColumnFormatter(c)}parse(c){if(!c.hasMoreCharacters)return null;const{parserOptions:u}=this,l=[];let d=c.nextCharacterToken;for(;d&&!i.Token.isTokenDelimiter(d,u)&&!i.Token.isTokenRowDelimiter(d);d=c.nextCharacterToken)l.push(d.token),c.advancePastToken(d);return this.columnFormatter.format(l.join(""))}}},{"../Token":159,"./ColumnFormatter":160}],163:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.QuotedColumnParser=void 0;const o=t("./ColumnFormatter"),i=t("../Token");s.QuotedColumnParser=class{constructor(c){this.parserOptions=c,this.columnFormatter=new o.ColumnFormatter(c)}parse(c){if(!c.hasMoreCharacters)return null;const u=c.cursor,{foundClosingQuote:l,col:d}=this.gatherDataBetweenQuotes(c);if(!l){if(c.advanceTo(u),!c.hasMoreData)throw new Error(`Parse Error: missing closing: '${this.parserOptions.quote||""}' in line: at '${c.lineFromCursor.replace(/[\r\n]/g,"\\n'")}'`);return null}return this.checkForMalformedColumn(c),d}gatherDataBetweenQuotes(c){const{parserOptions:u}=this;let l=!1,d=!1;const h=[];let f=c.nextCharacterToken;for(;!d&&f!==null;f=c.nextCharacterToken){const p=i.Token.isTokenQuote(f,u);if(!l&&p)l=!0;else if(l)if(i.Token.isTokenEscapeCharacter(f,u)){c.advancePastToken(f);const v=c.nextCharacterToken;v!==null&&(i.Token.isTokenQuote(v,u)||i.Token.isTokenEscapeCharacter(v,u))?(h.push(v.token),f=v):p?d=!0:h.push(f.token)}else p?d=!0:h.push(f.token);c.advancePastToken(f)}return{col:this.columnFormatter.format(h.join("")),foundClosingQuote:d}}checkForMalformedColumn(c){const{parserOptions:u}=this,{nextNonSpaceToken:l}=c;if(l){const d=i.Token.isTokenDelimiter(l,u),h=i.Token.isTokenRowDelimiter(l);if(!d&&!h){const f=c.lineFromCursor.substr(0,10).replace(/[\r\n]/g,"\\n'");throw new Error(`Parse Error: expected: '${u.escapedDelimiter}' OR new line got: '${l.token}'. at '${f}`)}c.advanceToToken(l)}else c.hasMoreData||c.advancePastLine()}}},{"../Token":159,"./ColumnFormatter":160}],164:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.ColumnFormatter=s.QuotedColumnParser=s.NonQuotedColumnParser=s.ColumnParser=void 0;var o=t("./ColumnParser");Object.defineProperty(s,"ColumnParser",{enumerable:!0,get:function(){return o.ColumnParser}});var i=t("./NonQuotedColumnParser");Object.defineProperty(s,"NonQuotedColumnParser",{enumerable:!0,get:function(){return i.NonQuotedColumnParser}});var c=t("./QuotedColumnParser");Object.defineProperty(s,"QuotedColumnParser",{enumerable:!0,get:function(){return c.QuotedColumnParser}});var u=t("./ColumnFormatter");Object.defineProperty(s,"ColumnFormatter",{enumerable:!0,get:function(){return u.ColumnFormatter}})},{"./ColumnFormatter":160,"./ColumnParser":161,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],165:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.QuotedColumnParser=s.NonQuotedColumnParser=s.ColumnParser=s.Token=s.Scanner=s.RowParser=s.Parser=void 0;var o=t("./Parser");Object.defineProperty(s,"Parser",{enumerable:!0,get:function(){return o.Parser}});var i=t("./RowParser");Object.defineProperty(s,"RowParser",{enumerable:!0,get:function(){return i.RowParser}});var c=t("./Scanner");Object.defineProperty(s,"Scanner",{enumerable:!0,get:function(){return c.Scanner}});var u=t("./Token");Object.defineProperty(s,"Token",{enumerable:!0,get:function(){return u.Token}});var l=t("./column");Object.defineProperty(s,"ColumnParser",{enumerable:!0,get:function(){return l.ColumnParser}}),Object.defineProperty(s,"NonQuotedColumnParser",{enumerable:!0,get:function(){return l.NonQuotedColumnParser}}),Object.defineProperty(s,"QuotedColumnParser",{enumerable:!0,get:function(){return l.QuotedColumnParser}})},{"./Parser":156,"./RowParser":157,"./Scanner":158,"./Token":159,"./column":164}],166:[function(t,n,s){var o=function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(s,"__esModule",{value:!0}),s.HeaderTransformer=void 0;const i=o(t("lodash.isundefined")),c=o(t("lodash.isfunction")),u=o(t("lodash.uniq")),l=o(t("lodash.groupby"));s.HeaderTransformer=class{constructor(d){this.headers=null,this.receivedHeaders=!1,this.shouldUseFirstRow=!1,this.processedFirstRow=!1,this.headersLength=0,this.parserOptions=d,d.headers===!0?this.shouldUseFirstRow=!0:Array.isArray(d.headers)?this.setHeaders(d.headers):c.default(d.headers)&&(this.headersTransform=d.headers)}transform(d,h){return this.shouldMapRow(d)?h(null,this.processRow(d)):h(null,{row:null,isValid:!0})}shouldMapRow(d){const{parserOptions:h}=this;if(!this.headersTransform&&h.renameHeaders&&!this.processedFirstRow){if(!this.receivedHeaders)throw new Error("Error renaming headers: new headers must be provided in an array");return this.processedFirstRow=!0,!1}if(!this.receivedHeaders&&Array.isArray(d)){if(this.headersTransform)this.setHeaders(this.headersTransform(d));else{if(!this.shouldUseFirstRow)return!0;this.setHeaders(d)}return!1}return!0}processRow(d){if(!this.headers)return{row:d,isValid:!0};const{parserOptions:h}=this;if(!h.discardUnmappedColumns&&d.length>this.headersLength){if(!h.strictColumnHandling)throw new Error(`Unexpected Error: column header mismatch expected: ${this.headersLength} columns got: ${d.length}`);return{row:d,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${d.length}`}}return h.strictColumnHandling&&d.length<this.headersLength?{row:d,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${d.length}`}:{row:this.mapHeaders(d),isValid:!0}}mapHeaders(d){const h={},{headers:f,headersLength:p}=this;for(let v=0;v<p;v+=1){const g=f[v];if(!i.default(g)){const m=d[v];i.default(m)?h[g]="":h[g]=m}}return h}setHeaders(d){var h;const f=d.filter(p=>!!p);if(u.default(f).length!==f.length){const p=l.default(f),v=Object.keys(p).filter(g=>p[g].length>1);throw new Error("Duplicate headers found "+JSON.stringify(v))}this.headers=d,this.receivedHeaders=!0,this.headersLength=((h=this.headers)===null||h===void 0?void 0:h.length)||0}}},{"lodash.groupby":443,"lodash.isfunction":446,"lodash.isundefined":448,"lodash.uniq":449}],167:[function(t,n,s){var o=function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(s,"__esModule",{value:!0}),s.RowTransformerValidator=void 0;const i=o(t("lodash.isfunction")),c=t("../types");class u{constructor(){this._rowTransform=null,this._rowValidator=null}static createTransform(d){return c.isSyncTransform(d)?(h,f)=>{let p=null;try{p=d(h)}catch(v){return f(v)}return f(null,p)}:d}static createValidator(d){return c.isSyncValidate(d)?(h,f)=>{f(null,{row:h,isValid:d(h)})}:(h,f)=>{d(h,(p,v,g)=>p?f(p):f(null,v?{row:h,isValid:v,reason:g}:{row:h,isValid:!1,reason:g}))}}set rowTransform(d){if(!i.default(d))throw new TypeError("The transform should be a function");this._rowTransform=u.createTransform(d)}set rowValidator(d){if(!i.default(d))throw new TypeError("The validate should be a function");this._rowValidator=u.createValidator(d)}transformAndValidate(d,h){return this.callTransformer(d,(f,p)=>f?h(f):p?this.callValidator(p,(v,g)=>v?h(v):g&&!g.isValid?h(null,{row:p,isValid:!1,reason:g.reason}):h(null,{row:p,isValid:!0})):h(null,{row:null,isValid:!0}))}callTransformer(d,h){return this._rowTransform?this._rowTransform(d,h):h(null,d)}callValidator(d,h){return this._rowValidator?this._rowValidator(d,h):h(null,{row:d,isValid:!0})}}s.RowTransformerValidator=u},{"../types":169,"lodash.isfunction":446}],168:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.HeaderTransformer=s.RowTransformerValidator=void 0;var o=t("./RowTransformerValidator");Object.defineProperty(s,"RowTransformerValidator",{enumerable:!0,get:function(){return o.RowTransformerValidator}});var i=t("./HeaderTransformer");Object.defineProperty(s,"HeaderTransformer",{enumerable:!0,get:function(){return i.HeaderTransformer}})},{"./HeaderTransformer":166,"./RowTransformerValidator":167}],169:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.isSyncValidate=s.isSyncTransform=void 0,s.isSyncTransform=o=>o.length===1,s.isSyncValidate=o=>o.length===1},{}],170:[function(t,n,s){const o=s;o.bignum=t("bn.js"),o.define=t("./asn1/api").define,o.base=t("./asn1/base"),o.constants=t("./asn1/constants"),o.decoders=t("./asn1/decoders"),o.encoders=t("./asn1/encoders")},{"./asn1/api":171,"./asn1/base":173,"./asn1/constants":177,"./asn1/decoders":179,"./asn1/encoders":182,"bn.js":184}],171:[function(t,n,s){const o=t("./encoders"),i=t("./decoders"),c=t("inherits");function u(l,d){this.name=l,this.body=d,this.decoders={},this.encoders={}}s.define=function(l,d){return new u(l,d)},u.prototype._createNamed=function(l){const d=this.name;function h(f){this._initNamed(f,d)}return c(h,l),h.prototype._initNamed=function(f,p){l.call(this,f,p)},new h(this)},u.prototype._getDecoder=function(l){return l=l||"der",this.decoders.hasOwnProperty(l)||(this.decoders[l]=this._createNamed(i[l])),this.decoders[l]},u.prototype.decode=function(l,d,h){return this._getDecoder(d).decode(l,h)},u.prototype._getEncoder=function(l){return l=l||"der",this.encoders.hasOwnProperty(l)||(this.encoders[l]=this._createNamed(o[l])),this.encoders[l]},u.prototype.encode=function(l,d,h){return this._getEncoder(d).encode(l,h)}},{"./decoders":179,"./encoders":182,inherits:440}],172:[function(t,n,s){const o=t("inherits"),i=t("../base/reporter").Reporter,c=t("safer-buffer").Buffer;function u(d,h){i.call(this,h),c.isBuffer(d)?(this.base=d,this.offset=0,this.length=d.length):this.error("Input not Buffer")}function l(d,h){if(Array.isArray(d))this.length=0,this.value=d.map(function(f){return l.isEncoderBuffer(f)||(f=new l(f,h)),this.length+=f.length,f},this);else if(typeof d=="number"){if(!(0<=d&&d<=255))return h.error("non-byte EncoderBuffer value");this.value=d,this.length=1}else if(typeof d=="string")this.value=d,this.length=c.byteLength(d);else{if(!c.isBuffer(d))return h.error("Unsupported type: "+typeof d);this.value=d,this.length=d.length}}o(u,i),s.DecoderBuffer=u,u.isDecoderBuffer=function(d){return d instanceof u?!0:typeof d=="object"&&c.isBuffer(d.base)&&d.constructor.name==="DecoderBuffer"&&typeof d.offset=="number"&&typeof d.length=="number"&&typeof d.save=="function"&&typeof d.restore=="function"&&typeof d.isEmpty=="function"&&typeof d.readUInt8=="function"&&typeof d.skip=="function"&&typeof d.raw=="function"},u.prototype.save=function(){return{offset:this.offset,reporter:i.prototype.save.call(this)}},u.prototype.restore=function(d){const h=new u(this.base);return h.offset=d.offset,h.length=this.offset,this.offset=d.offset,i.prototype.restore.call(this,d.reporter),h},u.prototype.isEmpty=function(){return this.offset===this.length},u.prototype.readUInt8=function(d){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(d||"DecoderBuffer overrun")},u.prototype.skip=function(d,h){if(!(this.offset+d<=this.length))return this.error(h||"DecoderBuffer overrun");const f=new u(this.base);return f._reporterState=this._reporterState,f.offset=this.offset,f.length=this.offset+d,this.offset+=d,f},u.prototype.raw=function(d){return this.base.slice(d?d.offset:this.offset,this.length)},s.EncoderBuffer=l,l.isEncoderBuffer=function(d){return d instanceof l?!0:typeof d=="object"&&d.constructor.name==="EncoderBuffer"&&typeof d.length=="number"&&typeof d.join=="function"},l.prototype.join=function(d,h){return d||(d=c.alloc(this.length)),h||(h=0),this.length===0||(Array.isArray(this.value)?this.value.forEach(function(f){f.join(d,h),h+=f.length}):(typeof this.value=="number"?d[h]=this.value:typeof this.value=="string"?d.write(this.value,h):c.isBuffer(this.value)&&this.value.copy(d,h),h+=this.length)),d}},{"../base/reporter":175,inherits:440,"safer-buffer":495}],173:[function(t,n,s){const o=s;o.Reporter=t("./reporter").Reporter,o.DecoderBuffer=t("./buffer").DecoderBuffer,o.EncoderBuffer=t("./buffer").EncoderBuffer,o.Node=t("./node")},{"./buffer":172,"./node":174,"./reporter":175}],174:[function(t,n,s){const o=t("../base/reporter").Reporter,i=t("../base/buffer").EncoderBuffer,c=t("../base/buffer").DecoderBuffer,u=t("minimalistic-assert"),l=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],d=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(l);function h(p,v,g){const m={};this._baseState=m,m.name=g,m.enc=p,m.parent=v||null,m.children=null,m.tag=null,m.args=null,m.reverseArgs=null,m.choice=null,m.optional=!1,m.any=!1,m.obj=!1,m.use=null,m.useDecoder=null,m.key=null,m.default=null,m.explicit=null,m.implicit=null,m.contains=null,m.parent||(m.children=[],this._wrap())}n.exports=h;const f=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];h.prototype.clone=function(){const p=this._baseState,v={};f.forEach(function(m){v[m]=p[m]});const g=new this.constructor(v.parent);return g._baseState=v,g},h.prototype._wrap=function(){const p=this._baseState;d.forEach(function(v){this[v]=function(){const g=new this.constructor(this);return p.children.push(g),g[v].apply(g,arguments)}},this)},h.prototype._init=function(p){const v=this._baseState;u(v.parent===null),p.call(this),v.children=v.children.filter(function(g){return g._baseState.parent===this},this),u.equal(v.children.length,1,"Root node can have only one child")},h.prototype._useArgs=function(p){const v=this._baseState,g=p.filter(function(m){return m instanceof this.constructor},this);p=p.filter(function(m){return!(m instanceof this.constructor)},this),g.length!==0&&(u(v.children===null),v.children=g,g.forEach(function(m){m._baseState.parent=this},this)),p.length!==0&&(u(v.args===null),v.args=p,v.reverseArgs=p.map(function(m){if(typeof m!="object"||m.constructor!==Object)return m;const b={};return Object.keys(m).forEach(function(y){y==(0|y)&&(y|=0);const S=m[y];b[S]=y}),b}))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach(function(p){h.prototype[p]=function(){const v=this._baseState;throw new Error(p+" not implemented for encoding: "+v.enc)}}),l.forEach(function(p){h.prototype[p]=function(){const v=this._baseState,g=Array.prototype.slice.call(arguments);return u(v.tag===null),v.tag=p,this._useArgs(g),this}}),h.prototype.use=function(p){u(p);const v=this._baseState;return u(v.use===null),v.use=p,this},h.prototype.optional=function(){return this._baseState.optional=!0,this},h.prototype.def=function(p){const v=this._baseState;return u(v.default===null),v.default=p,v.optional=!0,this},h.prototype.explicit=function(p){const v=this._baseState;return u(v.explicit===null&&v.implicit===null),v.explicit=p,this},h.prototype.implicit=function(p){const v=this._baseState;return u(v.explicit===null&&v.implicit===null),v.implicit=p,this},h.prototype.obj=function(){const p=this._baseState,v=Array.prototype.slice.call(arguments);return p.obj=!0,v.length!==0&&this._useArgs(v),this},h.prototype.key=function(p){const v=this._baseState;return u(v.key===null),v.key=p,this},h.prototype.any=function(){return this._baseState.any=!0,this},h.prototype.choice=function(p){const v=this._baseState;return u(v.choice===null),v.choice=p,this._useArgs(Object.keys(p).map(function(g){return p[g]})),this},h.prototype.contains=function(p){const v=this._baseState;return u(v.use===null),v.contains=p,this},h.prototype._decode=function(p,v){const g=this._baseState;if(g.parent===null)return p.wrapResult(g.children[0]._decode(p,v));let m,b=g.default,y=!0,S=null;if(g.key!==null&&(S=p.enterKey(g.key)),g.optional){let C=null;if(g.explicit!==null?C=g.explicit:g.implicit!==null?C=g.implicit:g.tag!==null&&(C=g.tag),C!==null||g.any){if(y=this._peekTag(p,C,g.any),p.isError(y))return y}else{const L=p.save();try{g.choice===null?this._decodeGeneric(g.tag,p,v):this._decodeChoice(p,v),y=!0}catch{y=!1}p.restore(L)}}if(g.obj&&y&&(m=p.enterObject()),y){if(g.explicit!==null){const L=this._decodeTag(p,g.explicit);if(p.isError(L))return L;p=L}const C=p.offset;if(g.use===null&&g.choice===null){let L;g.any&&(L=p.save());const O=this._decodeTag(p,g.implicit!==null?g.implicit:g.tag,g.any);if(p.isError(O))return O;g.any?b=p.raw(L):p=O}if(v&&v.track&&g.tag!==null&&v.track(p.path(),C,p.length,"tagged"),v&&v.track&&g.tag!==null&&v.track(p.path(),p.offset,p.length,"content"),g.any||(b=g.choice===null?this._decodeGeneric(g.tag,p,v):this._decodeChoice(p,v)),p.isError(b))return b;if(g.any||g.choice!==null||g.children===null||g.children.forEach(function(L){L._decode(p,v)}),g.contains&&(g.tag==="octstr"||g.tag==="bitstr")){const L=new c(b);b=this._getUse(g.contains,p._reporterState.obj)._decode(L,v)}}return g.obj&&y&&(b=p.leaveObject(m)),g.key===null||b===null&&y!==!0?S!==null&&p.exitKey(S):p.leaveKey(S,g.key,b),b},h.prototype._decodeGeneric=function(p,v,g){const m=this._baseState;return p==="seq"||p==="set"?null:p==="seqof"||p==="setof"?this._decodeList(v,p,m.args[0],g):/str$/.test(p)?this._decodeStr(v,p,g):p==="objid"&&m.args?this._decodeObjid(v,m.args[0],m.args[1],g):p==="objid"?this._decodeObjid(v,null,null,g):p==="gentime"||p==="utctime"?this._decodeTime(v,p,g):p==="null_"?this._decodeNull(v,g):p==="bool"?this._decodeBool(v,g):p==="objDesc"?this._decodeStr(v,p,g):p==="int"||p==="enum"?this._decodeInt(v,m.args&&m.args[0],g):m.use!==null?this._getUse(m.use,v._reporterState.obj)._decode(v,g):v.error("unknown tag: "+p)},h.prototype._getUse=function(p,v){const g=this._baseState;return g.useDecoder=this._use(p,v),u(g.useDecoder._baseState.parent===null),g.useDecoder=g.useDecoder._baseState.children[0],g.implicit!==g.useDecoder._baseState.implicit&&(g.useDecoder=g.useDecoder.clone(),g.useDecoder._baseState.implicit=g.implicit),g.useDecoder},h.prototype._decodeChoice=function(p,v){const g=this._baseState;let m=null,b=!1;return Object.keys(g.choice).some(function(y){const S=p.save(),C=g.choice[y];try{const L=C._decode(p,v);if(p.isError(L))return!1;m={type:y,value:L},b=!0}catch{return p.restore(S),!1}return!0},this),b?m:p.error("Choice not matched")},h.prototype._createEncoderBuffer=function(p){return new i(p,this.reporter)},h.prototype._encode=function(p,v,g){const m=this._baseState;if(m.default!==null&&m.default===p)return;const b=this._encodeValue(p,v,g);return b===void 0||this._skipDefault(b,v,g)?void 0:b},h.prototype._encodeValue=function(p,v,g){const m=this._baseState;if(m.parent===null)return m.children[0]._encode(p,v||new o);let b=null;if(this.reporter=v,m.optional&&p===void 0){if(m.default===null)return;p=m.default}let y=null,S=!1;if(m.any)b=this._createEncoderBuffer(p);else if(m.choice)b=this._encodeChoice(p,v);else if(m.contains)y=this._getUse(m.contains,g)._encode(p,v),S=!0;else if(m.children)y=m.children.map(function(C){if(C._baseState.tag==="null_")return C._encode(null,v,p);if(C._baseState.key===null)return v.error("Child should have a key");const L=v.enterKey(C._baseState.key);if(typeof p!="object")return v.error("Child expected, but input is not object");const O=C._encode(p[C._baseState.key],v,p);return v.leaveKey(L),O},this).filter(function(C){return C}),y=this._createEncoderBuffer(y);else if(m.tag==="seqof"||m.tag==="setof"){if(!m.args||m.args.length!==1)return v.error("Too many args for : "+m.tag);if(!Array.isArray(p))return v.error("seqof/setof, but data is not Array");const C=this.clone();C._baseState.implicit=null,y=this._createEncoderBuffer(p.map(function(L){const O=this._baseState;return this._getUse(O.args[0],p)._encode(L,v)},C))}else m.use!==null?b=this._getUse(m.use,g)._encode(p,v):(y=this._encodePrimitive(m.tag,p),S=!0);if(!m.any&&m.choice===null){const C=m.implicit!==null?m.implicit:m.tag,L=m.implicit===null?"universal":"context";C===null?m.use===null&&v.error("Tag could be omitted only for .use()"):m.use===null&&(b=this._encodeComposite(C,S,L,y))}return m.explicit!==null&&(b=this._encodeComposite(m.explicit,!1,"context",b)),b},h.prototype._encodeChoice=function(p,v){const g=this._baseState,m=g.choice[p.type];return m||u(!1,p.type+" not found in "+JSON.stringify(Object.keys(g.choice))),m._encode(p.value,v)},h.prototype._encodePrimitive=function(p,v){const g=this._baseState;if(/str$/.test(p))return this._encodeStr(v,p);if(p==="objid"&&g.args)return this._encodeObjid(v,g.reverseArgs[0],g.args[1]);if(p==="objid")return this._encodeObjid(v,null,null);if(p==="gentime"||p==="utctime")return this._encodeTime(v,p);if(p==="null_")return this._encodeNull();if(p==="int"||p==="enum")return this._encodeInt(v,g.args&&g.reverseArgs[0]);if(p==="bool")return this._encodeBool(v);if(p==="objDesc")return this._encodeStr(v,p);throw new Error("Unsupported tag: "+p)},h.prototype._isNumstr=function(p){return/^[0-9 ]*$/.test(p)},h.prototype._isPrintstr=function(p){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(p)}},{"../base/buffer":172,"../base/reporter":175,"minimalistic-assert":453}],175:[function(t,n,s){const o=t("inherits");function i(u){this._reporterState={obj:null,path:[],options:u||{},errors:[]}}function c(u,l){this.path=u,this.rethrow(l)}s.Reporter=i,i.prototype.isError=function(u){return u instanceof c},i.prototype.save=function(){const u=this._reporterState;return{obj:u.obj,pathLen:u.path.length}},i.prototype.restore=function(u){const l=this._reporterState;l.obj=u.obj,l.path=l.path.slice(0,u.pathLen)},i.prototype.enterKey=function(u){return this._reporterState.path.push(u)},i.prototype.exitKey=function(u){const l=this._reporterState;l.path=l.path.slice(0,u-1)},i.prototype.leaveKey=function(u,l,d){const h=this._reporterState;this.exitKey(u),h.obj!==null&&(h.obj[l]=d)},i.prototype.path=function(){return this._reporterState.path.join("/")},i.prototype.enterObject=function(){const u=this._reporterState,l=u.obj;return u.obj={},l},i.prototype.leaveObject=function(u){const l=this._reporterState,d=l.obj;return l.obj=u,d},i.prototype.error=function(u){let l;const d=this._reporterState,h=u instanceof c;if(l=h?u:new c(d.path.map(function(f){return"["+JSON.stringify(f)+"]"}).join(""),u.message||u,u.stack),!d.options.partial)throw l;return h||d.errors.push(l),l},i.prototype.wrapResult=function(u){const l=this._reporterState;return l.options.partial?{result:this.isError(u)?null:u,errors:l.errors}:u},o(c,Error),c.prototype.rethrow=function(u){if(this.message=u+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,c),!this.stack)try{throw new Error(this.message)}catch(l){this.stack=l.stack}return this}},{inherits:440}],176:[function(t,n,s){function o(i){const c={};return Object.keys(i).forEach(function(u){(0|u)==u&&(u|=0);const l=i[u];c[l]=u}),c}s.tagClass={0:"universal",1:"application",2:"context",3:"private"},s.tagClassByName=o(s.tagClass),s.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},s.tagByName=o(s.tag)},{}],177:[function(t,n,s){const o=s;o._reverse=function(i){const c={};return Object.keys(i).forEach(function(u){(0|u)==u&&(u|=0);const l=i[u];c[l]=u}),c},o.der=t("./der")},{"./der":176}],178:[function(t,n,s){const o=t("inherits"),i=t("bn.js"),c=t("../base/buffer").DecoderBuffer,u=t("../base/node"),l=t("../constants/der");function d(v){this.enc="der",this.name=v.name,this.entity=v,this.tree=new h,this.tree._init(v.body)}function h(v){u.call(this,"der",v)}function f(v,g){let m=v.readUInt8(g);if(v.isError(m))return m;const b=l.tagClass[m>>6],y=(32&m)==0;if((31&m)==31){let S=m;for(m=0;(128&S)==128;){if(S=v.readUInt8(g),v.isError(S))return S;m<<=7,m|=127&S}}else m&=31;return{cls:b,primitive:y,tag:m,tagStr:l.tag[m]}}function p(v,g,m){let b=v.readUInt8(m);if(v.isError(b))return b;if(!g&&b===128)return null;if((128&b)==0)return b;const y=127&b;if(y>4)return v.error("length octect is too long");b=0;for(let S=0;S<y;S++){b<<=8;const C=v.readUInt8(m);if(v.isError(C))return C;b|=C}return b}n.exports=d,d.prototype.decode=function(v,g){return c.isDecoderBuffer(v)||(v=new c(v,g)),this.tree._decode(v,g)},o(h,u),h.prototype._peekTag=function(v,g,m){if(v.isEmpty())return!1;const b=v.save(),y=f(v,'Failed to peek tag: "'+g+'"');return v.isError(y)?y:(v.restore(b),y.tag===g||y.tagStr===g||y.tagStr+"of"===g||m)},h.prototype._decodeTag=function(v,g,m){const b=f(v,'Failed to decode tag of "'+g+'"');if(v.isError(b))return b;let y=p(v,b.primitive,'Failed to get length of "'+g+'"');if(v.isError(y))return y;if(!m&&b.tag!==g&&b.tagStr!==g&&b.tagStr+"of"!==g)return v.error('Failed to match tag: "'+g+'"');if(b.primitive||y!==null)return v.skip(y,'Failed to match body of: "'+g+'"');const S=v.save(),C=this._skipUntilEnd(v,'Failed to skip indefinite length body: "'+this.tag+'"');return v.isError(C)?C:(y=v.offset-S.offset,v.restore(S),v.skip(y,'Failed to match body of: "'+g+'"'))},h.prototype._skipUntilEnd=function(v,g){for(;;){const m=f(v,g);if(v.isError(m))return m;const b=p(v,m.primitive,g);if(v.isError(b))return b;let y;if(y=m.primitive||b!==null?v.skip(b):this._skipUntilEnd(v,g),v.isError(y))return y;if(m.tagStr==="end")break}},h.prototype._decodeList=function(v,g,m,b){const y=[];for(;!v.isEmpty();){const S=this._peekTag(v,"end");if(v.isError(S))return S;const C=m.decode(v,"der",b);if(v.isError(C)&&S)break;y.push(C)}return y},h.prototype._decodeStr=function(v,g){if(g==="bitstr"){const m=v.readUInt8();return v.isError(m)?m:{unused:m,data:v.raw()}}if(g==="bmpstr"){const m=v.raw();if(m.length%2==1)return v.error("Decoding of string type: bmpstr length mismatch");let b="";for(let y=0;y<m.length/2;y++)b+=String.fromCharCode(m.readUInt16BE(2*y));return b}if(g==="numstr"){const m=v.raw().toString("ascii");return this._isNumstr(m)?m:v.error("Decoding of string type: numstr unsupported characters")}if(g==="octstr"||g==="objDesc")return v.raw();if(g==="printstr"){const m=v.raw().toString("ascii");return this._isPrintstr(m)?m:v.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(g)?v.raw().toString():v.error("Decoding of string type: "+g+" unsupported")},h.prototype._decodeObjid=function(v,g,m){let b;const y=[];let S=0,C=0;for(;!v.isEmpty();)C=v.readUInt8(),S<<=7,S|=127&C,(128&C)==0&&(y.push(S),S=0);128&C&&y.push(S);const L=y[0]/40|0,O=y[0]%40;if(b=m?y:[L,O].concat(y.slice(1)),g){let H=g[b.join(" ")];H===void 0&&(H=g[b.join(".")]),H!==void 0&&(b=H)}return b},h.prototype._decodeTime=function(v,g){const m=v.raw().toString();let b,y,S,C,L,O;if(g==="gentime")b=0|m.slice(0,4),y=0|m.slice(4,6),S=0|m.slice(6,8),C=0|m.slice(8,10),L=0|m.slice(10,12),O=0|m.slice(12,14);else{if(g!=="utctime")return v.error("Decoding "+g+" time is not supported yet");b=0|m.slice(0,2),y=0|m.slice(2,4),S=0|m.slice(4,6),C=0|m.slice(6,8),L=0|m.slice(8,10),O=0|m.slice(10,12),b=b<70?2e3+b:1900+b}return Date.UTC(b,y-1,S,C,L,O,0)},h.prototype._decodeNull=function(){return null},h.prototype._decodeBool=function(v){const g=v.readUInt8();return v.isError(g)?g:g!==0},h.prototype._decodeInt=function(v,g){const m=v.raw();let b=new i(m);return g&&(b=g[b.toString(10)]||b),b},h.prototype._use=function(v,g){return typeof v=="function"&&(v=v(g)),v._getDecoder("der").tree}},{"../base/buffer":172,"../base/node":174,"../constants/der":176,"bn.js":184,inherits:440}],179:[function(t,n,s){const o=s;o.der=t("./der"),o.pem=t("./pem")},{"./der":178,"./pem":180}],180:[function(t,n,s){const o=t("inherits"),i=t("safer-buffer").Buffer,c=t("./der");function u(l){c.call(this,l),this.enc="pem"}o(u,c),n.exports=u,u.prototype.decode=function(l,d){const h=l.toString().split(/[\r\n]+/g),f=d.label.toUpperCase(),p=/^-----(BEGIN|END) ([^-]+)-----$/;let v=-1,g=-1;for(let y=0;y<h.length;y++){const S=h[y].match(p);if(S!==null&&S[2]===f){if(v!==-1){if(S[1]!=="END")break;g=y;break}if(S[1]!=="BEGIN")break;v=y}}if(v===-1||g===-1)throw new Error("PEM section not found for: "+f);const m=h.slice(v+1,g).join("");m.replace(/[^a-z0-9+/=]+/gi,"");const b=i.from(m,"base64");return c.prototype.decode.call(this,b,d)}},{"./der":178,inherits:440,"safer-buffer":495}],181:[function(t,n,s){const o=t("inherits"),i=t("safer-buffer").Buffer,c=t("../base/node"),u=t("../constants/der");function l(f){this.enc="der",this.name=f.name,this.entity=f,this.tree=new d,this.tree._init(f.body)}function d(f){c.call(this,"der",f)}function h(f){return f<10?"0"+f:f}n.exports=l,l.prototype.encode=function(f,p){return this.tree._encode(f,p).join()},o(d,c),d.prototype._encodeComposite=function(f,p,v,g){const m=function(S,C,L,O){let H;if(S==="seqof"?S="seq":S==="setof"&&(S="set"),u.tagByName.hasOwnProperty(S))H=u.tagByName[S];else{if(typeof S!="number"||(0|S)!==S)return O.error("Unknown tag: "+S);H=S}return H>=31?O.error("Multi-octet tag encoding unsupported"):(C||(H|=32),H|=u.tagClassByName[L||"universal"]<<6,H)}(f,p,v,this.reporter);if(g.length<128){const S=i.alloc(2);return S[0]=m,S[1]=g.length,this._createEncoderBuffer([S,g])}let b=1;for(let S=g.length;S>=256;S>>=8)b++;const y=i.alloc(2+b);y[0]=m,y[1]=128|b;for(let S=1+b,C=g.length;C>0;S--,C>>=8)y[S]=255&C;return this._createEncoderBuffer([y,g])},d.prototype._encodeStr=function(f,p){if(p==="bitstr")return this._createEncoderBuffer([0|f.unused,f.data]);if(p==="bmpstr"){const v=i.alloc(2*f.length);for(let g=0;g<f.length;g++)v.writeUInt16BE(f.charCodeAt(g),2*g);return this._createEncoderBuffer(v)}return p==="numstr"?this._isNumstr(f)?this._createEncoderBuffer(f):this.reporter.error("Encoding of string type: numstr supports only digits and space"):p==="printstr"?this._isPrintstr(f)?this._createEncoderBuffer(f):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(p)||p==="objDesc"?this._createEncoderBuffer(f):this.reporter.error("Encoding of string type: "+p+" unsupported")},d.prototype._encodeObjid=function(f,p,v){if(typeof f=="string"){if(!p)return this.reporter.error("string objid given, but no values map found");if(!p.hasOwnProperty(f))return this.reporter.error("objid not found in values map");f=p[f].split(/[\s.]+/g);for(let y=0;y<f.length;y++)f[y]|=0}else if(Array.isArray(f)){f=f.slice();for(let y=0;y<f.length;y++)f[y]|=0}if(!Array.isArray(f))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(f));if(!v){if(f[1]>=40)return this.reporter.error("Second objid identifier OOB");f.splice(0,2,40*f[0]+f[1])}let g=0;for(let y=0;y<f.length;y++){let S=f[y];for(g++;S>=128;S>>=7)g++}const m=i.alloc(g);let b=m.length-1;for(let y=f.length-1;y>=0;y--){let S=f[y];for(m[b--]=127&S;(S>>=7)>0;)m[b--]=128|127&S}return this._createEncoderBuffer(m)},d.prototype._encodeTime=function(f,p){let v;const g=new Date(f);return p==="gentime"?v=[h(g.getUTCFullYear()),h(g.getUTCMonth()+1),h(g.getUTCDate()),h(g.getUTCHours()),h(g.getUTCMinutes()),h(g.getUTCSeconds()),"Z"].join(""):p==="utctime"?v=[h(g.getUTCFullYear()%100),h(g.getUTCMonth()+1),h(g.getUTCDate()),h(g.getUTCHours()),h(g.getUTCMinutes()),h(g.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+p+" time is not supported yet"),this._encodeStr(v,"octstr")},d.prototype._encodeNull=function(){return this._createEncoderBuffer("")},d.prototype._encodeInt=function(f,p){if(typeof f=="string"){if(!p)return this.reporter.error("String int or enum given, but no values map");if(!p.hasOwnProperty(f))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(f));f=p[f]}if(typeof f!="number"&&!i.isBuffer(f)){const m=f.toArray();!f.sign&&128&m[0]&&m.unshift(0),f=i.from(m)}if(i.isBuffer(f)){let m=f.length;f.length===0&&m++;const b=i.alloc(m);return f.copy(b),f.length===0&&(b[0]=0),this._createEncoderBuffer(b)}if(f<128)return this._createEncoderBuffer(f);if(f<256)return this._createEncoderBuffer([0,f]);let v=1;for(let m=f;m>=256;m>>=8)v++;const g=new Array(v);for(let m=g.length-1;m>=0;m--)g[m]=255&f,f>>=8;return 128&g[0]&&g.unshift(0),this._createEncoderBuffer(i.from(g))},d.prototype._encodeBool=function(f){return this._createEncoderBuffer(f?255:0)},d.prototype._use=function(f,p){return typeof f=="function"&&(f=f(p)),f._getEncoder("der").tree},d.prototype._skipDefault=function(f,p,v){const g=this._baseState;let m;if(g.default===null)return!1;const b=f.join();if(g.defaultBuffer===void 0&&(g.defaultBuffer=this._encodeValue(g.default,p,v).join()),b.length!==g.defaultBuffer.length)return!1;for(m=0;m<b.length;m++)if(b[m]!==g.defaultBuffer[m])return!1;return!0}},{"../base/node":174,"../constants/der":176,inherits:440,"safer-buffer":495}],182:[function(t,n,s){const o=s;o.der=t("./der"),o.pem=t("./pem")},{"./der":181,"./pem":183}],183:[function(t,n,s){const o=t("inherits"),i=t("./der");function c(u){i.call(this,u),this.enc="pem"}o(c,i),n.exports=c,c.prototype.encode=function(u,l){const d=i.prototype.encode.call(this,u).toString("base64"),h=["-----BEGIN "+l.label+"-----"];for(let f=0;f<d.length;f+=64)h.push(d.slice(f,f+64));return h.push("-----END "+l.label+"-----"),h.join(`
`)}},{"./der":181,inherits:440}],184:[function(t,n,s){(function(o,i){function c(I,U){if(!I)throw new Error(U||"Assertion failed")}function u(I,U){I.super_=U;var k=function(){};k.prototype=U.prototype,I.prototype=new k,I.prototype.constructor=I}function l(I,U,k){if(l.isBN(I))return I;this.negative=0,this.words=null,this.length=0,this.red=null,I!==null&&(U!=="le"&&U!=="be"||(k=U,U=10),this._init(I||0,U||10,k||"be"))}var d;typeof o=="object"?o.exports=l:(void 0).BN=l,l.BN=l,l.wordSize=26;try{d=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:t("buffer").Buffer}catch{}function h(I,U){var k=I.charCodeAt(U);return k>=65&&k<=70?k-55:k>=97&&k<=102?k-87:k-48&15}function f(I,U,k){var _=h(I,k);return k-1>=U&&(_|=h(I,k-1)<<4),_}function p(I,U,k,_){for(var R=0,j=Math.min(I.length,k),A=U;A<j;A++){var N=I.charCodeAt(A)-48;R*=_,R+=N>=49?N-49+10:N>=17?N-17+10:N}return R}l.isBN=function(I){return I instanceof l||I!==null&&typeof I=="object"&&I.constructor.wordSize===l.wordSize&&Array.isArray(I.words)},l.max=function(I,U){return I.cmp(U)>0?I:U},l.min=function(I,U){return I.cmp(U)<0?I:U},l.prototype._init=function(I,U,k){if(typeof I=="number")return this._initNumber(I,U,k);if(typeof I=="object")return this._initArray(I,U,k);U==="hex"&&(U=16),c(U===(0|U)&&U>=2&&U<=36);var _=0;(I=I.toString().replace(/\s+/g,""))[0]==="-"&&(_++,this.negative=1),_<I.length&&(U===16?this._parseHex(I,_,k):(this._parseBase(I,U,_),k==="le"&&this._initArray(this.toArray(),U,k)))},l.prototype._initNumber=function(I,U,k){I<0&&(this.negative=1,I=-I),I<67108864?(this.words=[67108863&I],this.length=1):I<4503599627370496?(this.words=[67108863&I,I/67108864&67108863],this.length=2):(c(I<9007199254740992),this.words=[67108863&I,I/67108864&67108863,1],this.length=3),k==="le"&&this._initArray(this.toArray(),U,k)},l.prototype._initArray=function(I,U,k){if(c(typeof I.length=="number"),I.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(I.length/3),this.words=new Array(this.length);for(var _=0;_<this.length;_++)this.words[_]=0;var R,j,A=0;if(k==="be")for(_=I.length-1,R=0;_>=0;_-=3)j=I[_]|I[_-1]<<8|I[_-2]<<16,this.words[R]|=j<<A&67108863,this.words[R+1]=j>>>26-A&67108863,(A+=24)>=26&&(A-=26,R++);else if(k==="le")for(_=0,R=0;_<I.length;_+=3)j=I[_]|I[_+1]<<8|I[_+2]<<16,this.words[R]|=j<<A&67108863,this.words[R+1]=j>>>26-A&67108863,(A+=24)>=26&&(A-=26,R++);return this.strip()},l.prototype._parseHex=function(I,U,k){this.length=Math.ceil((I.length-U)/6),this.words=new Array(this.length);for(var _=0;_<this.length;_++)this.words[_]=0;var R,j=0,A=0;if(k==="be")for(_=I.length-1;_>=U;_-=2)R=f(I,U,_)<<j,this.words[A]|=67108863&R,j>=18?(j-=18,A+=1,this.words[A]|=R>>>26):j+=8;else for(_=(I.length-U)%2==0?U+1:U;_<I.length;_+=2)R=f(I,U,_)<<j,this.words[A]|=67108863&R,j>=18?(j-=18,A+=1,this.words[A]|=R>>>26):j+=8;this.strip()},l.prototype._parseBase=function(I,U,k){this.words=[0],this.length=1;for(var _=0,R=1;R<=67108863;R*=U)_++;_--,R=R/U|0;for(var j=I.length-k,A=j%_,N=Math.min(j,j-A)+k,V=0,M=k;M<N;M+=_)V=p(I,M,M+_,U),this.imuln(R),this.words[0]+V<67108864?this.words[0]+=V:this._iaddn(V);if(A!==0){var Z=1;for(V=p(I,M,I.length,U),M=0;M<A;M++)Z*=U;this.imuln(Z),this.words[0]+V<67108864?this.words[0]+=V:this._iaddn(V)}this.strip()},l.prototype.copy=function(I){I.words=new Array(this.length);for(var U=0;U<this.length;U++)I.words[U]=this.words[U];I.length=this.length,I.negative=this.negative,I.red=this.red},l.prototype.clone=function(){var I=new l(null);return this.copy(I),I},l.prototype._expand=function(I){for(;this.length<I;)this.words[this.length++]=0;return this},l.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},l.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},l.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var v=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],g=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],m=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function b(I,U,k){k.negative=U.negative^I.negative;var _=I.length+U.length|0;k.length=_,_=_-1|0;var R=0|I.words[0],j=0|U.words[0],A=R*j,N=67108863&A,V=A/67108864|0;k.words[0]=N;for(var M=1;M<_;M++){for(var Z=V>>>26,J=67108863&V,re=Math.min(M,U.length-1),X=Math.max(0,M-I.length+1);X<=re;X++){var ne=M-X|0;Z+=(A=(R=0|I.words[ne])*(j=0|U.words[X])+J)/67108864|0,J=67108863&A}k.words[M]=0|J,V=0|Z}return V!==0?k.words[M]=0|V:k.length--,k.strip()}l.prototype.toString=function(I,U){var k;if(U=0|U||1,(I=I||10)===16||I==="hex"){k="";for(var _=0,R=0,j=0;j<this.length;j++){var A=this.words[j],N=(16777215&(A<<_|R)).toString(16);k=(R=A>>>24-_&16777215)!==0||j!==this.length-1?v[6-N.length]+N+k:N+k,(_+=2)>=26&&(_-=26,j--)}for(R!==0&&(k=R.toString(16)+k);k.length%U!=0;)k="0"+k;return this.negative!==0&&(k="-"+k),k}if(I===(0|I)&&I>=2&&I<=36){var V=g[I],M=m[I];k="";var Z=this.clone();for(Z.negative=0;!Z.isZero();){var J=Z.modn(M).toString(I);k=(Z=Z.idivn(M)).isZero()?J+k:v[V-J.length]+J+k}for(this.isZero()&&(k="0"+k);k.length%U!=0;)k="0"+k;return this.negative!==0&&(k="-"+k),k}c(!1,"Base should be between 2 and 36")},l.prototype.toNumber=function(){var I=this.words[0];return this.length===2?I+=67108864*this.words[1]:this.length===3&&this.words[2]===1?I+=4503599627370496+67108864*this.words[1]:this.length>2&&c(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-I:I},l.prototype.toJSON=function(){return this.toString(16)},l.prototype.toBuffer=function(I,U){return c(d!==void 0),this.toArrayLike(d,I,U)},l.prototype.toArray=function(I,U){return this.toArrayLike(Array,I,U)},l.prototype.toArrayLike=function(I,U,k){var _=this.byteLength(),R=k||Math.max(1,_);c(_<=R,"byte array longer than desired length"),c(R>0,"Requested array length <= 0"),this.strip();var j,A,N=U==="le",V=new I(R),M=this.clone();if(N){for(A=0;!M.isZero();A++)j=M.andln(255),M.iushrn(8),V[A]=j;for(;A<R;A++)V[A]=0}else{for(A=0;A<R-_;A++)V[A]=0;for(A=0;!M.isZero();A++)j=M.andln(255),M.iushrn(8),V[R-A-1]=j}return V},Math.clz32?l.prototype._countBits=function(I){return 32-Math.clz32(I)}:l.prototype._countBits=function(I){var U=I,k=0;return U>=4096&&(k+=13,U>>>=13),U>=64&&(k+=7,U>>>=7),U>=8&&(k+=4,U>>>=4),U>=2&&(k+=2,U>>>=2),k+U},l.prototype._zeroBits=function(I){if(I===0)return 26;var U=I,k=0;return(8191&U)==0&&(k+=13,U>>>=13),(127&U)==0&&(k+=7,U>>>=7),(15&U)==0&&(k+=4,U>>>=4),(3&U)==0&&(k+=2,U>>>=2),(1&U)==0&&k++,k},l.prototype.bitLength=function(){var I=this.words[this.length-1],U=this._countBits(I);return 26*(this.length-1)+U},l.prototype.zeroBits=function(){if(this.isZero())return 0;for(var I=0,U=0;U<this.length;U++){var k=this._zeroBits(this.words[U]);if(I+=k,k!==26)break}return I},l.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},l.prototype.toTwos=function(I){return this.negative!==0?this.abs().inotn(I).iaddn(1):this.clone()},l.prototype.fromTwos=function(I){return this.testn(I-1)?this.notn(I).iaddn(1).ineg():this.clone()},l.prototype.isNeg=function(){return this.negative!==0},l.prototype.neg=function(){return this.clone().ineg()},l.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},l.prototype.iuor=function(I){for(;this.length<I.length;)this.words[this.length++]=0;for(var U=0;U<I.length;U++)this.words[U]=this.words[U]|I.words[U];return this.strip()},l.prototype.ior=function(I){return c((this.negative|I.negative)==0),this.iuor(I)},l.prototype.or=function(I){return this.length>I.length?this.clone().ior(I):I.clone().ior(this)},l.prototype.uor=function(I){return this.length>I.length?this.clone().iuor(I):I.clone().iuor(this)},l.prototype.iuand=function(I){var U;U=this.length>I.length?I:this;for(var k=0;k<U.length;k++)this.words[k]=this.words[k]&I.words[k];return this.length=U.length,this.strip()},l.prototype.iand=function(I){return c((this.negative|I.negative)==0),this.iuand(I)},l.prototype.and=function(I){return this.length>I.length?this.clone().iand(I):I.clone().iand(this)},l.prototype.uand=function(I){return this.length>I.length?this.clone().iuand(I):I.clone().iuand(this)},l.prototype.iuxor=function(I){var U,k;this.length>I.length?(U=this,k=I):(U=I,k=this);for(var _=0;_<k.length;_++)this.words[_]=U.words[_]^k.words[_];if(this!==U)for(;_<U.length;_++)this.words[_]=U.words[_];return this.length=U.length,this.strip()},l.prototype.ixor=function(I){return c((this.negative|I.negative)==0),this.iuxor(I)},l.prototype.xor=function(I){return this.length>I.length?this.clone().ixor(I):I.clone().ixor(this)},l.prototype.uxor=function(I){return this.length>I.length?this.clone().iuxor(I):I.clone().iuxor(this)},l.prototype.inotn=function(I){c(typeof I=="number"&&I>=0);var U=0|Math.ceil(I/26),k=I%26;this._expand(U),k>0&&U--;for(var _=0;_<U;_++)this.words[_]=67108863&~this.words[_];return k>0&&(this.words[_]=~this.words[_]&67108863>>26-k),this.strip()},l.prototype.notn=function(I){return this.clone().inotn(I)},l.prototype.setn=function(I,U){c(typeof I=="number"&&I>=0);var k=I/26|0,_=I%26;return this._expand(k+1),this.words[k]=U?this.words[k]|1<<_:this.words[k]&~(1<<_),this.strip()},l.prototype.iadd=function(I){var U,k,_;if(this.negative!==0&&I.negative===0)return this.negative=0,U=this.isub(I),this.negative^=1,this._normSign();if(this.negative===0&&I.negative!==0)return I.negative=0,U=this.isub(I),I.negative=1,U._normSign();this.length>I.length?(k=this,_=I):(k=I,_=this);for(var R=0,j=0;j<_.length;j++)U=(0|k.words[j])+(0|_.words[j])+R,this.words[j]=67108863&U,R=U>>>26;for(;R!==0&&j<k.length;j++)U=(0|k.words[j])+R,this.words[j]=67108863&U,R=U>>>26;if(this.length=k.length,R!==0)this.words[this.length]=R,this.length++;else if(k!==this)for(;j<k.length;j++)this.words[j]=k.words[j];return this},l.prototype.add=function(I){var U;return I.negative!==0&&this.negative===0?(I.negative=0,U=this.sub(I),I.negative^=1,U):I.negative===0&&this.negative!==0?(this.negative=0,U=I.sub(this),this.negative=1,U):this.length>I.length?this.clone().iadd(I):I.clone().iadd(this)},l.prototype.isub=function(I){if(I.negative!==0){I.negative=0;var U=this.iadd(I);return I.negative=1,U._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(I),this.negative=1,this._normSign();var k,_,R=this.cmp(I);if(R===0)return this.negative=0,this.length=1,this.words[0]=0,this;R>0?(k=this,_=I):(k=I,_=this);for(var j=0,A=0;A<_.length;A++)j=(U=(0|k.words[A])-(0|_.words[A])+j)>>26,this.words[A]=67108863&U;for(;j!==0&&A<k.length;A++)j=(U=(0|k.words[A])+j)>>26,this.words[A]=67108863&U;if(j===0&&A<k.length&&k!==this)for(;A<k.length;A++)this.words[A]=k.words[A];return this.length=Math.max(this.length,A),k!==this&&(this.negative=1),this.strip()},l.prototype.sub=function(I){return this.clone().isub(I)};var y=function(I,U,k){var _,R,j,A=I.words,N=U.words,V=k.words,M=0,Z=0|A[0],J=8191&Z,re=Z>>>13,X=0|A[1],ne=8191&X,Y=X>>>13,K=0|A[2],ee=8191&K,ue=K>>>13,se=0|A[3],ce=8191&se,fe=se>>>13,ve=0|A[4],_e=8191&ve,le=ve>>>13,ke=0|A[5],Te=8191&ke,pe=ke>>>13,ye=0|A[6],ge=8191&ye,De=ye>>>13,He=0|A[7],Xe=8191&He,at=He>>>13,dt=0|A[8],wt=8191&dt,$t=dt>>>13,Bt=0|A[9],ft=8191&Bt,tr=Bt>>>13,Me=0|N[0],tt=8191&Me,Ze=Me>>>13,St=0|N[1],et=8191&St,Ht=St>>>13,Nt=0|N[2],kt=8191&Nt,kr=Nt>>>13,Jt=0|N[3],Pt=8191&Jt,Ur=Jt>>>13,Lr=0|N[4],vt=8191&Lr,nr=Lr>>>13,Cr=0|N[5],Dt=8191&Cr,je=Cr>>>13,ct=0|N[6],nt=8191&ct,Pe=ct>>>13,Qe=0|N[7],gt=8191&Qe,xe=Qe>>>13,Oe=0|N[8],Ce=8191&Oe,de=Oe>>>13,be=0|N[9],Se=8191&be,Ne=be>>>13;k.negative=I.negative^U.negative,k.length=19;var ze=(M+(_=Math.imul(J,tt))|0)+((8191&(R=(R=Math.imul(J,Ze))+Math.imul(re,tt)|0))<<13)|0;M=((j=Math.imul(re,Ze))+(R>>>13)|0)+(ze>>>26)|0,ze&=67108863,_=Math.imul(ne,tt),R=(R=Math.imul(ne,Ze))+Math.imul(Y,tt)|0,j=Math.imul(Y,Ze);var Re=(M+(_=_+Math.imul(J,et)|0)|0)+((8191&(R=(R=R+Math.imul(J,Ht)|0)+Math.imul(re,et)|0))<<13)|0;M=((j=j+Math.imul(re,Ht)|0)+(R>>>13)|0)+(Re>>>26)|0,Re&=67108863,_=Math.imul(ee,tt),R=(R=Math.imul(ee,Ze))+Math.imul(ue,tt)|0,j=Math.imul(ue,Ze),_=_+Math.imul(ne,et)|0,R=(R=R+Math.imul(ne,Ht)|0)+Math.imul(Y,et)|0,j=j+Math.imul(Y,Ht)|0;var Ie=(M+(_=_+Math.imul(J,kt)|0)|0)+((8191&(R=(R=R+Math.imul(J,kr)|0)+Math.imul(re,kt)|0))<<13)|0;M=((j=j+Math.imul(re,kr)|0)+(R>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,_=Math.imul(ce,tt),R=(R=Math.imul(ce,Ze))+Math.imul(fe,tt)|0,j=Math.imul(fe,Ze),_=_+Math.imul(ee,et)|0,R=(R=R+Math.imul(ee,Ht)|0)+Math.imul(ue,et)|0,j=j+Math.imul(ue,Ht)|0,_=_+Math.imul(ne,kt)|0,R=(R=R+Math.imul(ne,kr)|0)+Math.imul(Y,kt)|0,j=j+Math.imul(Y,kr)|0;var ae=(M+(_=_+Math.imul(J,Pt)|0)|0)+((8191&(R=(R=R+Math.imul(J,Ur)|0)+Math.imul(re,Pt)|0))<<13)|0;M=((j=j+Math.imul(re,Ur)|0)+(R>>>13)|0)+(ae>>>26)|0,ae&=67108863,_=Math.imul(_e,tt),R=(R=Math.imul(_e,Ze))+Math.imul(le,tt)|0,j=Math.imul(le,Ze),_=_+Math.imul(ce,et)|0,R=(R=R+Math.imul(ce,Ht)|0)+Math.imul(fe,et)|0,j=j+Math.imul(fe,Ht)|0,_=_+Math.imul(ee,kt)|0,R=(R=R+Math.imul(ee,kr)|0)+Math.imul(ue,kt)|0,j=j+Math.imul(ue,kr)|0,_=_+Math.imul(ne,Pt)|0,R=(R=R+Math.imul(ne,Ur)|0)+Math.imul(Y,Pt)|0,j=j+Math.imul(Y,Ur)|0;var we=(M+(_=_+Math.imul(J,vt)|0)|0)+((8191&(R=(R=R+Math.imul(J,nr)|0)+Math.imul(re,vt)|0))<<13)|0;M=((j=j+Math.imul(re,nr)|0)+(R>>>13)|0)+(we>>>26)|0,we&=67108863,_=Math.imul(Te,tt),R=(R=Math.imul(Te,Ze))+Math.imul(pe,tt)|0,j=Math.imul(pe,Ze),_=_+Math.imul(_e,et)|0,R=(R=R+Math.imul(_e,Ht)|0)+Math.imul(le,et)|0,j=j+Math.imul(le,Ht)|0,_=_+Math.imul(ce,kt)|0,R=(R=R+Math.imul(ce,kr)|0)+Math.imul(fe,kt)|0,j=j+Math.imul(fe,kr)|0,_=_+Math.imul(ee,Pt)|0,R=(R=R+Math.imul(ee,Ur)|0)+Math.imul(ue,Pt)|0,j=j+Math.imul(ue,Ur)|0,_=_+Math.imul(ne,vt)|0,R=(R=R+Math.imul(ne,nr)|0)+Math.imul(Y,vt)|0,j=j+Math.imul(Y,nr)|0;var Fe=(M+(_=_+Math.imul(J,Dt)|0)|0)+((8191&(R=(R=R+Math.imul(J,je)|0)+Math.imul(re,Dt)|0))<<13)|0;M=((j=j+Math.imul(re,je)|0)+(R>>>13)|0)+(Fe>>>26)|0,Fe&=67108863,_=Math.imul(ge,tt),R=(R=Math.imul(ge,Ze))+Math.imul(De,tt)|0,j=Math.imul(De,Ze),_=_+Math.imul(Te,et)|0,R=(R=R+Math.imul(Te,Ht)|0)+Math.imul(pe,et)|0,j=j+Math.imul(pe,Ht)|0,_=_+Math.imul(_e,kt)|0,R=(R=R+Math.imul(_e,kr)|0)+Math.imul(le,kt)|0,j=j+Math.imul(le,kr)|0,_=_+Math.imul(ce,Pt)|0,R=(R=R+Math.imul(ce,Ur)|0)+Math.imul(fe,Pt)|0,j=j+Math.imul(fe,Ur)|0,_=_+Math.imul(ee,vt)|0,R=(R=R+Math.imul(ee,nr)|0)+Math.imul(ue,vt)|0,j=j+Math.imul(ue,nr)|0,_=_+Math.imul(ne,Dt)|0,R=(R=R+Math.imul(ne,je)|0)+Math.imul(Y,Dt)|0,j=j+Math.imul(Y,je)|0;var Ye=(M+(_=_+Math.imul(J,nt)|0)|0)+((8191&(R=(R=R+Math.imul(J,Pe)|0)+Math.imul(re,nt)|0))<<13)|0;M=((j=j+Math.imul(re,Pe)|0)+(R>>>13)|0)+(Ye>>>26)|0,Ye&=67108863,_=Math.imul(Xe,tt),R=(R=Math.imul(Xe,Ze))+Math.imul(at,tt)|0,j=Math.imul(at,Ze),_=_+Math.imul(ge,et)|0,R=(R=R+Math.imul(ge,Ht)|0)+Math.imul(De,et)|0,j=j+Math.imul(De,Ht)|0,_=_+Math.imul(Te,kt)|0,R=(R=R+Math.imul(Te,kr)|0)+Math.imul(pe,kt)|0,j=j+Math.imul(pe,kr)|0,_=_+Math.imul(_e,Pt)|0,R=(R=R+Math.imul(_e,Ur)|0)+Math.imul(le,Pt)|0,j=j+Math.imul(le,Ur)|0,_=_+Math.imul(ce,vt)|0,R=(R=R+Math.imul(ce,nr)|0)+Math.imul(fe,vt)|0,j=j+Math.imul(fe,nr)|0,_=_+Math.imul(ee,Dt)|0,R=(R=R+Math.imul(ee,je)|0)+Math.imul(ue,Dt)|0,j=j+Math.imul(ue,je)|0,_=_+Math.imul(ne,nt)|0,R=(R=R+Math.imul(ne,Pe)|0)+Math.imul(Y,nt)|0,j=j+Math.imul(Y,Pe)|0;var me=(M+(_=_+Math.imul(J,gt)|0)|0)+((8191&(R=(R=R+Math.imul(J,xe)|0)+Math.imul(re,gt)|0))<<13)|0;M=((j=j+Math.imul(re,xe)|0)+(R>>>13)|0)+(me>>>26)|0,me&=67108863,_=Math.imul(wt,tt),R=(R=Math.imul(wt,Ze))+Math.imul($t,tt)|0,j=Math.imul($t,Ze),_=_+Math.imul(Xe,et)|0,R=(R=R+Math.imul(Xe,Ht)|0)+Math.imul(at,et)|0,j=j+Math.imul(at,Ht)|0,_=_+Math.imul(ge,kt)|0,R=(R=R+Math.imul(ge,kr)|0)+Math.imul(De,kt)|0,j=j+Math.imul(De,kr)|0,_=_+Math.imul(Te,Pt)|0,R=(R=R+Math.imul(Te,Ur)|0)+Math.imul(pe,Pt)|0,j=j+Math.imul(pe,Ur)|0,_=_+Math.imul(_e,vt)|0,R=(R=R+Math.imul(_e,nr)|0)+Math.imul(le,vt)|0,j=j+Math.imul(le,nr)|0,_=_+Math.imul(ce,Dt)|0,R=(R=R+Math.imul(ce,je)|0)+Math.imul(fe,Dt)|0,j=j+Math.imul(fe,je)|0,_=_+Math.imul(ee,nt)|0,R=(R=R+Math.imul(ee,Pe)|0)+Math.imul(ue,nt)|0,j=j+Math.imul(ue,Pe)|0,_=_+Math.imul(ne,gt)|0,R=(R=R+Math.imul(ne,xe)|0)+Math.imul(Y,gt)|0,j=j+Math.imul(Y,xe)|0;var Be=(M+(_=_+Math.imul(J,Ce)|0)|0)+((8191&(R=(R=R+Math.imul(J,de)|0)+Math.imul(re,Ce)|0))<<13)|0;M=((j=j+Math.imul(re,de)|0)+(R>>>13)|0)+(Be>>>26)|0,Be&=67108863,_=Math.imul(ft,tt),R=(R=Math.imul(ft,Ze))+Math.imul(tr,tt)|0,j=Math.imul(tr,Ze),_=_+Math.imul(wt,et)|0,R=(R=R+Math.imul(wt,Ht)|0)+Math.imul($t,et)|0,j=j+Math.imul($t,Ht)|0,_=_+Math.imul(Xe,kt)|0,R=(R=R+Math.imul(Xe,kr)|0)+Math.imul(at,kt)|0,j=j+Math.imul(at,kr)|0,_=_+Math.imul(ge,Pt)|0,R=(R=R+Math.imul(ge,Ur)|0)+Math.imul(De,Pt)|0,j=j+Math.imul(De,Ur)|0,_=_+Math.imul(Te,vt)|0,R=(R=R+Math.imul(Te,nr)|0)+Math.imul(pe,vt)|0,j=j+Math.imul(pe,nr)|0,_=_+Math.imul(_e,Dt)|0,R=(R=R+Math.imul(_e,je)|0)+Math.imul(le,Dt)|0,j=j+Math.imul(le,je)|0,_=_+Math.imul(ce,nt)|0,R=(R=R+Math.imul(ce,Pe)|0)+Math.imul(fe,nt)|0,j=j+Math.imul(fe,Pe)|0,_=_+Math.imul(ee,gt)|0,R=(R=R+Math.imul(ee,xe)|0)+Math.imul(ue,gt)|0,j=j+Math.imul(ue,xe)|0,_=_+Math.imul(ne,Ce)|0,R=(R=R+Math.imul(ne,de)|0)+Math.imul(Y,Ce)|0,j=j+Math.imul(Y,de)|0;var Ge=(M+(_=_+Math.imul(J,Se)|0)|0)+((8191&(R=(R=R+Math.imul(J,Ne)|0)+Math.imul(re,Se)|0))<<13)|0;M=((j=j+Math.imul(re,Ne)|0)+(R>>>13)|0)+(Ge>>>26)|0,Ge&=67108863,_=Math.imul(ft,et),R=(R=Math.imul(ft,Ht))+Math.imul(tr,et)|0,j=Math.imul(tr,Ht),_=_+Math.imul(wt,kt)|0,R=(R=R+Math.imul(wt,kr)|0)+Math.imul($t,kt)|0,j=j+Math.imul($t,kr)|0,_=_+Math.imul(Xe,Pt)|0,R=(R=R+Math.imul(Xe,Ur)|0)+Math.imul(at,Pt)|0,j=j+Math.imul(at,Ur)|0,_=_+Math.imul(ge,vt)|0,R=(R=R+Math.imul(ge,nr)|0)+Math.imul(De,vt)|0,j=j+Math.imul(De,nr)|0,_=_+Math.imul(Te,Dt)|0,R=(R=R+Math.imul(Te,je)|0)+Math.imul(pe,Dt)|0,j=j+Math.imul(pe,je)|0,_=_+Math.imul(_e,nt)|0,R=(R=R+Math.imul(_e,Pe)|0)+Math.imul(le,nt)|0,j=j+Math.imul(le,Pe)|0,_=_+Math.imul(ce,gt)|0,R=(R=R+Math.imul(ce,xe)|0)+Math.imul(fe,gt)|0,j=j+Math.imul(fe,xe)|0,_=_+Math.imul(ee,Ce)|0,R=(R=R+Math.imul(ee,de)|0)+Math.imul(ue,Ce)|0,j=j+Math.imul(ue,de)|0;var mt=(M+(_=_+Math.imul(ne,Se)|0)|0)+((8191&(R=(R=R+Math.imul(ne,Ne)|0)+Math.imul(Y,Se)|0))<<13)|0;M=((j=j+Math.imul(Y,Ne)|0)+(R>>>13)|0)+(mt>>>26)|0,mt&=67108863,_=Math.imul(ft,kt),R=(R=Math.imul(ft,kr))+Math.imul(tr,kt)|0,j=Math.imul(tr,kr),_=_+Math.imul(wt,Pt)|0,R=(R=R+Math.imul(wt,Ur)|0)+Math.imul($t,Pt)|0,j=j+Math.imul($t,Ur)|0,_=_+Math.imul(Xe,vt)|0,R=(R=R+Math.imul(Xe,nr)|0)+Math.imul(at,vt)|0,j=j+Math.imul(at,nr)|0,_=_+Math.imul(ge,Dt)|0,R=(R=R+Math.imul(ge,je)|0)+Math.imul(De,Dt)|0,j=j+Math.imul(De,je)|0,_=_+Math.imul(Te,nt)|0,R=(R=R+Math.imul(Te,Pe)|0)+Math.imul(pe,nt)|0,j=j+Math.imul(pe,Pe)|0,_=_+Math.imul(_e,gt)|0,R=(R=R+Math.imul(_e,xe)|0)+Math.imul(le,gt)|0,j=j+Math.imul(le,xe)|0,_=_+Math.imul(ce,Ce)|0,R=(R=R+Math.imul(ce,de)|0)+Math.imul(fe,Ce)|0,j=j+Math.imul(fe,de)|0;var _t=(M+(_=_+Math.imul(ee,Se)|0)|0)+((8191&(R=(R=R+Math.imul(ee,Ne)|0)+Math.imul(ue,Se)|0))<<13)|0;M=((j=j+Math.imul(ue,Ne)|0)+(R>>>13)|0)+(_t>>>26)|0,_t&=67108863,_=Math.imul(ft,Pt),R=(R=Math.imul(ft,Ur))+Math.imul(tr,Pt)|0,j=Math.imul(tr,Ur),_=_+Math.imul(wt,vt)|0,R=(R=R+Math.imul(wt,nr)|0)+Math.imul($t,vt)|0,j=j+Math.imul($t,nr)|0,_=_+Math.imul(Xe,Dt)|0,R=(R=R+Math.imul(Xe,je)|0)+Math.imul(at,Dt)|0,j=j+Math.imul(at,je)|0,_=_+Math.imul(ge,nt)|0,R=(R=R+Math.imul(ge,Pe)|0)+Math.imul(De,nt)|0,j=j+Math.imul(De,Pe)|0,_=_+Math.imul(Te,gt)|0,R=(R=R+Math.imul(Te,xe)|0)+Math.imul(pe,gt)|0,j=j+Math.imul(pe,xe)|0,_=_+Math.imul(_e,Ce)|0,R=(R=R+Math.imul(_e,de)|0)+Math.imul(le,Ce)|0,j=j+Math.imul(le,de)|0;var ot=(M+(_=_+Math.imul(ce,Se)|0)|0)+((8191&(R=(R=R+Math.imul(ce,Ne)|0)+Math.imul(fe,Se)|0))<<13)|0;M=((j=j+Math.imul(fe,Ne)|0)+(R>>>13)|0)+(ot>>>26)|0,ot&=67108863,_=Math.imul(ft,vt),R=(R=Math.imul(ft,nr))+Math.imul(tr,vt)|0,j=Math.imul(tr,nr),_=_+Math.imul(wt,Dt)|0,R=(R=R+Math.imul(wt,je)|0)+Math.imul($t,Dt)|0,j=j+Math.imul($t,je)|0,_=_+Math.imul(Xe,nt)|0,R=(R=R+Math.imul(Xe,Pe)|0)+Math.imul(at,nt)|0,j=j+Math.imul(at,Pe)|0,_=_+Math.imul(ge,gt)|0,R=(R=R+Math.imul(ge,xe)|0)+Math.imul(De,gt)|0,j=j+Math.imul(De,xe)|0,_=_+Math.imul(Te,Ce)|0,R=(R=R+Math.imul(Te,de)|0)+Math.imul(pe,Ce)|0,j=j+Math.imul(pe,de)|0;var xt=(M+(_=_+Math.imul(_e,Se)|0)|0)+((8191&(R=(R=R+Math.imul(_e,Ne)|0)+Math.imul(le,Se)|0))<<13)|0;M=((j=j+Math.imul(le,Ne)|0)+(R>>>13)|0)+(xt>>>26)|0,xt&=67108863,_=Math.imul(ft,Dt),R=(R=Math.imul(ft,je))+Math.imul(tr,Dt)|0,j=Math.imul(tr,je),_=_+Math.imul(wt,nt)|0,R=(R=R+Math.imul(wt,Pe)|0)+Math.imul($t,nt)|0,j=j+Math.imul($t,Pe)|0,_=_+Math.imul(Xe,gt)|0,R=(R=R+Math.imul(Xe,xe)|0)+Math.imul(at,gt)|0,j=j+Math.imul(at,xe)|0,_=_+Math.imul(ge,Ce)|0,R=(R=R+Math.imul(ge,de)|0)+Math.imul(De,Ce)|0,j=j+Math.imul(De,de)|0;var zt=(M+(_=_+Math.imul(Te,Se)|0)|0)+((8191&(R=(R=R+Math.imul(Te,Ne)|0)+Math.imul(pe,Se)|0))<<13)|0;M=((j=j+Math.imul(pe,Ne)|0)+(R>>>13)|0)+(zt>>>26)|0,zt&=67108863,_=Math.imul(ft,nt),R=(R=Math.imul(ft,Pe))+Math.imul(tr,nt)|0,j=Math.imul(tr,Pe),_=_+Math.imul(wt,gt)|0,R=(R=R+Math.imul(wt,xe)|0)+Math.imul($t,gt)|0,j=j+Math.imul($t,xe)|0,_=_+Math.imul(Xe,Ce)|0,R=(R=R+Math.imul(Xe,de)|0)+Math.imul(at,Ce)|0,j=j+Math.imul(at,de)|0;var Vt=(M+(_=_+Math.imul(ge,Se)|0)|0)+((8191&(R=(R=R+Math.imul(ge,Ne)|0)+Math.imul(De,Se)|0))<<13)|0;M=((j=j+Math.imul(De,Ne)|0)+(R>>>13)|0)+(Vt>>>26)|0,Vt&=67108863,_=Math.imul(ft,gt),R=(R=Math.imul(ft,xe))+Math.imul(tr,gt)|0,j=Math.imul(tr,xe),_=_+Math.imul(wt,Ce)|0,R=(R=R+Math.imul(wt,de)|0)+Math.imul($t,Ce)|0,j=j+Math.imul($t,de)|0;var Ar=(M+(_=_+Math.imul(Xe,Se)|0)|0)+((8191&(R=(R=R+Math.imul(Xe,Ne)|0)+Math.imul(at,Se)|0))<<13)|0;M=((j=j+Math.imul(at,Ne)|0)+(R>>>13)|0)+(Ar>>>26)|0,Ar&=67108863,_=Math.imul(ft,Ce),R=(R=Math.imul(ft,de))+Math.imul(tr,Ce)|0,j=Math.imul(tr,de);var wr=(M+(_=_+Math.imul(wt,Se)|0)|0)+((8191&(R=(R=R+Math.imul(wt,Ne)|0)+Math.imul($t,Se)|0))<<13)|0;M=((j=j+Math.imul($t,Ne)|0)+(R>>>13)|0)+(wr>>>26)|0,wr&=67108863;var Nr=(M+(_=Math.imul(ft,Se))|0)+((8191&(R=(R=Math.imul(ft,Ne))+Math.imul(tr,Se)|0))<<13)|0;return M=((j=Math.imul(tr,Ne))+(R>>>13)|0)+(Nr>>>26)|0,Nr&=67108863,V[0]=ze,V[1]=Re,V[2]=Ie,V[3]=ae,V[4]=we,V[5]=Fe,V[6]=Ye,V[7]=me,V[8]=Be,V[9]=Ge,V[10]=mt,V[11]=_t,V[12]=ot,V[13]=xt,V[14]=zt,V[15]=Vt,V[16]=Ar,V[17]=wr,V[18]=Nr,M!==0&&(V[19]=M,k.length++),k};function S(I,U,k){return new C().mulp(I,U,k)}function C(I,U){this.x=I,this.y=U}Math.imul||(y=b),l.prototype.mulTo=function(I,U){var k=this.length+I.length;return this.length===10&&I.length===10?y(this,I,U):k<63?b(this,I,U):k<1024?function(_,R,j){j.negative=R.negative^_.negative,j.length=_.length+R.length;for(var A=0,N=0,V=0;V<j.length-1;V++){var M=N;N=0;for(var Z=67108863&A,J=Math.min(V,R.length-1),re=Math.max(0,V-_.length+1);re<=J;re++){var X=V-re,ne=(0|_.words[X])*(0|R.words[re]),Y=67108863&ne;Z=67108863&(Y=Y+Z|0),N+=(M=(M=M+(ne/67108864|0)|0)+(Y>>>26)|0)>>>26,M&=67108863}j.words[V]=Z,A=M,M=N}return A!==0?j.words[V]=A:j.length--,j.strip()}(this,I,U):S(this,I,U)},C.prototype.makeRBT=function(I){for(var U=new Array(I),k=l.prototype._countBits(I)-1,_=0;_<I;_++)U[_]=this.revBin(_,k,I);return U},C.prototype.revBin=function(I,U,k){if(I===0||I===k-1)return I;for(var _=0,R=0;R<U;R++)_|=(1&I)<<U-R-1,I>>=1;return _},C.prototype.permute=function(I,U,k,_,R,j){for(var A=0;A<j;A++)_[A]=U[I[A]],R[A]=k[I[A]]},C.prototype.transform=function(I,U,k,_,R,j){this.permute(j,I,U,k,_,R);for(var A=1;A<R;A<<=1)for(var N=A<<1,V=Math.cos(2*Math.PI/N),M=Math.sin(2*Math.PI/N),Z=0;Z<R;Z+=N)for(var J=V,re=M,X=0;X<A;X++){var ne=k[Z+X],Y=_[Z+X],K=k[Z+X+A],ee=_[Z+X+A],ue=J*K-re*ee;ee=J*ee+re*K,K=ue,k[Z+X]=ne+K,_[Z+X]=Y+ee,k[Z+X+A]=ne-K,_[Z+X+A]=Y-ee,X!==N&&(ue=V*J-M*re,re=V*re+M*J,J=ue)}},C.prototype.guessLen13b=function(I,U){var k=1|Math.max(U,I),_=1&k,R=0;for(k=k/2|0;k;k>>>=1)R++;return 1<<R+1+_},C.prototype.conjugate=function(I,U,k){if(!(k<=1))for(var _=0;_<k/2;_++){var R=I[_];I[_]=I[k-_-1],I[k-_-1]=R,R=U[_],U[_]=-U[k-_-1],U[k-_-1]=-R}},C.prototype.normalize13b=function(I,U){for(var k=0,_=0;_<U/2;_++){var R=8192*Math.round(I[2*_+1]/U)+Math.round(I[2*_]/U)+k;I[_]=67108863&R,k=R<67108864?0:R/67108864|0}return I},C.prototype.convert13b=function(I,U,k,_){for(var R=0,j=0;j<U;j++)R+=0|I[j],k[2*j]=8191&R,R>>>=13,k[2*j+1]=8191&R,R>>>=13;for(j=2*U;j<_;++j)k[j]=0;c(R===0),c((-8192&R)==0)},C.prototype.stub=function(I){for(var U=new Array(I),k=0;k<I;k++)U[k]=0;return U},C.prototype.mulp=function(I,U,k){var _=2*this.guessLen13b(I.length,U.length),R=this.makeRBT(_),j=this.stub(_),A=new Array(_),N=new Array(_),V=new Array(_),M=new Array(_),Z=new Array(_),J=new Array(_),re=k.words;re.length=_,this.convert13b(I.words,I.length,A,_),this.convert13b(U.words,U.length,M,_),this.transform(A,j,N,V,_,R),this.transform(M,j,Z,J,_,R);for(var X=0;X<_;X++){var ne=N[X]*Z[X]-V[X]*J[X];V[X]=N[X]*J[X]+V[X]*Z[X],N[X]=ne}return this.conjugate(N,V,_),this.transform(N,V,re,j,_,R),this.conjugate(re,j,_),this.normalize13b(re,_),k.negative=I.negative^U.negative,k.length=I.length+U.length,k.strip()},l.prototype.mul=function(I){var U=new l(null);return U.words=new Array(this.length+I.length),this.mulTo(I,U)},l.prototype.mulf=function(I){var U=new l(null);return U.words=new Array(this.length+I.length),S(this,I,U)},l.prototype.imul=function(I){return this.clone().mulTo(I,this)},l.prototype.imuln=function(I){c(typeof I=="number"),c(I<67108864);for(var U=0,k=0;k<this.length;k++){var _=(0|this.words[k])*I,R=(67108863&_)+(67108863&U);U>>=26,U+=_/67108864|0,U+=R>>>26,this.words[k]=67108863&R}return U!==0&&(this.words[k]=U,this.length++),this},l.prototype.muln=function(I){return this.clone().imuln(I)},l.prototype.sqr=function(){return this.mul(this)},l.prototype.isqr=function(){return this.imul(this.clone())},l.prototype.pow=function(I){var U=function(j){for(var A=new Array(j.bitLength()),N=0;N<A.length;N++){var V=N/26|0,M=N%26;A[N]=(j.words[V]&1<<M)>>>M}return A}(I);if(U.length===0)return new l(1);for(var k=this,_=0;_<U.length&&U[_]===0;_++,k=k.sqr());if(++_<U.length)for(var R=k.sqr();_<U.length;_++,R=R.sqr())U[_]!==0&&(k=k.mul(R));return k},l.prototype.iushln=function(I){c(typeof I=="number"&&I>=0);var U,k=I%26,_=(I-k)/26,R=67108863>>>26-k<<26-k;if(k!==0){var j=0;for(U=0;U<this.length;U++){var A=this.words[U]&R,N=(0|this.words[U])-A<<k;this.words[U]=N|j,j=A>>>26-k}j&&(this.words[U]=j,this.length++)}if(_!==0){for(U=this.length-1;U>=0;U--)this.words[U+_]=this.words[U];for(U=0;U<_;U++)this.words[U]=0;this.length+=_}return this.strip()},l.prototype.ishln=function(I){return c(this.negative===0),this.iushln(I)},l.prototype.iushrn=function(I,U,k){var _;c(typeof I=="number"&&I>=0),_=U?(U-U%26)/26:0;var R=I%26,j=Math.min((I-R)/26,this.length),A=67108863^67108863>>>R<<R,N=k;if(_-=j,_=Math.max(0,_),N){for(var V=0;V<j;V++)N.words[V]=this.words[V];N.length=j}if(j!==0)if(this.length>j)for(this.length-=j,V=0;V<this.length;V++)this.words[V]=this.words[V+j];else this.words[0]=0,this.length=1;var M=0;for(V=this.length-1;V>=0&&(M!==0||V>=_);V--){var Z=0|this.words[V];this.words[V]=M<<26-R|Z>>>R,M=Z&A}return N&&M!==0&&(N.words[N.length++]=M),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},l.prototype.ishrn=function(I,U,k){return c(this.negative===0),this.iushrn(I,U,k)},l.prototype.shln=function(I){return this.clone().ishln(I)},l.prototype.ushln=function(I){return this.clone().iushln(I)},l.prototype.shrn=function(I){return this.clone().ishrn(I)},l.prototype.ushrn=function(I){return this.clone().iushrn(I)},l.prototype.testn=function(I){c(typeof I=="number"&&I>=0);var U=I%26,k=(I-U)/26,_=1<<U;return!(this.length<=k)&&!!(this.words[k]&_)},l.prototype.imaskn=function(I){c(typeof I=="number"&&I>=0);var U=I%26,k=(I-U)/26;if(c(this.negative===0,"imaskn works only with positive numbers"),this.length<=k)return this;if(U!==0&&k++,this.length=Math.min(k,this.length),U!==0){var _=67108863^67108863>>>U<<U;this.words[this.length-1]&=_}return this.strip()},l.prototype.maskn=function(I){return this.clone().imaskn(I)},l.prototype.iaddn=function(I){return c(typeof I=="number"),c(I<67108864),I<0?this.isubn(-I):this.negative!==0?this.length===1&&(0|this.words[0])<I?(this.words[0]=I-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(I),this.negative=1,this):this._iaddn(I)},l.prototype._iaddn=function(I){this.words[0]+=I;for(var U=0;U<this.length&&this.words[U]>=67108864;U++)this.words[U]-=67108864,U===this.length-1?this.words[U+1]=1:this.words[U+1]++;return this.length=Math.max(this.length,U+1),this},l.prototype.isubn=function(I){if(c(typeof I=="number"),c(I<67108864),I<0)return this.iaddn(-I);if(this.negative!==0)return this.negative=0,this.iaddn(I),this.negative=1,this;if(this.words[0]-=I,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var U=0;U<this.length&&this.words[U]<0;U++)this.words[U]+=67108864,this.words[U+1]-=1;return this.strip()},l.prototype.addn=function(I){return this.clone().iaddn(I)},l.prototype.subn=function(I){return this.clone().isubn(I)},l.prototype.iabs=function(){return this.negative=0,this},l.prototype.abs=function(){return this.clone().iabs()},l.prototype._ishlnsubmul=function(I,U,k){var _,R,j=I.length+k;this._expand(j);var A=0;for(_=0;_<I.length;_++){R=(0|this.words[_+k])+A;var N=(0|I.words[_])*U;A=((R-=67108863&N)>>26)-(N/67108864|0),this.words[_+k]=67108863&R}for(;_<this.length-k;_++)A=(R=(0|this.words[_+k])+A)>>26,this.words[_+k]=67108863&R;if(A===0)return this.strip();for(c(A===-1),A=0,_=0;_<this.length;_++)A=(R=-(0|this.words[_])+A)>>26,this.words[_]=67108863&R;return this.negative=1,this.strip()},l.prototype._wordDiv=function(I,U){var k=(this.length,I.length),_=this.clone(),R=I,j=0|R.words[R.length-1];(k=26-this._countBits(j))!==0&&(R=R.ushln(k),_.iushln(k),j=0|R.words[R.length-1]);var A,N=_.length-R.length;if(U!=="mod"){(A=new l(null)).length=N+1,A.words=new Array(A.length);for(var V=0;V<A.length;V++)A.words[V]=0}var M=_.clone()._ishlnsubmul(R,1,N);M.negative===0&&(_=M,A&&(A.words[N]=1));for(var Z=N-1;Z>=0;Z--){var J=67108864*(0|_.words[R.length+Z])+(0|_.words[R.length+Z-1]);for(J=Math.min(J/j|0,67108863),_._ishlnsubmul(R,J,Z);_.negative!==0;)J--,_.negative=0,_._ishlnsubmul(R,1,Z),_.isZero()||(_.negative^=1);A&&(A.words[Z]=J)}return A&&A.strip(),_.strip(),U!=="div"&&k!==0&&_.iushrn(k),{div:A||null,mod:_}},l.prototype.divmod=function(I,U,k){return c(!I.isZero()),this.isZero()?{div:new l(0),mod:new l(0)}:this.negative!==0&&I.negative===0?(j=this.neg().divmod(I,U),U!=="mod"&&(_=j.div.neg()),U!=="div"&&(R=j.mod.neg(),k&&R.negative!==0&&R.iadd(I)),{div:_,mod:R}):this.negative===0&&I.negative!==0?(j=this.divmod(I.neg(),U),U!=="mod"&&(_=j.div.neg()),{div:_,mod:j.mod}):(this.negative&I.negative)!=0?(j=this.neg().divmod(I.neg(),U),U!=="div"&&(R=j.mod.neg(),k&&R.negative!==0&&R.isub(I)),{div:j.div,mod:R}):I.length>this.length||this.cmp(I)<0?{div:new l(0),mod:this}:I.length===1?U==="div"?{div:this.divn(I.words[0]),mod:null}:U==="mod"?{div:null,mod:new l(this.modn(I.words[0]))}:{div:this.divn(I.words[0]),mod:new l(this.modn(I.words[0]))}:this._wordDiv(I,U);var _,R,j},l.prototype.div=function(I){return this.divmod(I,"div",!1).div},l.prototype.mod=function(I){return this.divmod(I,"mod",!1).mod},l.prototype.umod=function(I){return this.divmod(I,"mod",!0).mod},l.prototype.divRound=function(I){var U=this.divmod(I);if(U.mod.isZero())return U.div;var k=U.div.negative!==0?U.mod.isub(I):U.mod,_=I.ushrn(1),R=I.andln(1),j=k.cmp(_);return j<0||R===1&&j===0?U.div:U.div.negative!==0?U.div.isubn(1):U.div.iaddn(1)},l.prototype.modn=function(I){c(I<=67108863);for(var U=(1<<26)%I,k=0,_=this.length-1;_>=0;_--)k=(U*k+(0|this.words[_]))%I;return k},l.prototype.idivn=function(I){c(I<=67108863);for(var U=0,k=this.length-1;k>=0;k--){var _=(0|this.words[k])+67108864*U;this.words[k]=_/I|0,U=_%I}return this.strip()},l.prototype.divn=function(I){return this.clone().idivn(I)},l.prototype.egcd=function(I){c(I.negative===0),c(!I.isZero());var U=this,k=I.clone();U=U.negative!==0?U.umod(I):U.clone();for(var _=new l(1),R=new l(0),j=new l(0),A=new l(1),N=0;U.isEven()&&k.isEven();)U.iushrn(1),k.iushrn(1),++N;for(var V=k.clone(),M=U.clone();!U.isZero();){for(var Z=0,J=1;(U.words[0]&J)==0&&Z<26;++Z,J<<=1);if(Z>0)for(U.iushrn(Z);Z-- >0;)(_.isOdd()||R.isOdd())&&(_.iadd(V),R.isub(M)),_.iushrn(1),R.iushrn(1);for(var re=0,X=1;(k.words[0]&X)==0&&re<26;++re,X<<=1);if(re>0)for(k.iushrn(re);re-- >0;)(j.isOdd()||A.isOdd())&&(j.iadd(V),A.isub(M)),j.iushrn(1),A.iushrn(1);U.cmp(k)>=0?(U.isub(k),_.isub(j),R.isub(A)):(k.isub(U),j.isub(_),A.isub(R))}return{a:j,b:A,gcd:k.iushln(N)}},l.prototype._invmp=function(I){c(I.negative===0),c(!I.isZero());var U=this,k=I.clone();U=U.negative!==0?U.umod(I):U.clone();for(var _,R=new l(1),j=new l(0),A=k.clone();U.cmpn(1)>0&&k.cmpn(1)>0;){for(var N=0,V=1;(U.words[0]&V)==0&&N<26;++N,V<<=1);if(N>0)for(U.iushrn(N);N-- >0;)R.isOdd()&&R.iadd(A),R.iushrn(1);for(var M=0,Z=1;(k.words[0]&Z)==0&&M<26;++M,Z<<=1);if(M>0)for(k.iushrn(M);M-- >0;)j.isOdd()&&j.iadd(A),j.iushrn(1);U.cmp(k)>=0?(U.isub(k),R.isub(j)):(k.isub(U),j.isub(R))}return(_=U.cmpn(1)===0?R:j).cmpn(0)<0&&_.iadd(I),_},l.prototype.gcd=function(I){if(this.isZero())return I.abs();if(I.isZero())return this.abs();var U=this.clone(),k=I.clone();U.negative=0,k.negative=0;for(var _=0;U.isEven()&&k.isEven();_++)U.iushrn(1),k.iushrn(1);for(;;){for(;U.isEven();)U.iushrn(1);for(;k.isEven();)k.iushrn(1);var R=U.cmp(k);if(R<0){var j=U;U=k,k=j}else if(R===0||k.cmpn(1)===0)break;U.isub(k)}return k.iushln(_)},l.prototype.invm=function(I){return this.egcd(I).a.umod(I)},l.prototype.isEven=function(){return(1&this.words[0])==0},l.prototype.isOdd=function(){return(1&this.words[0])==1},l.prototype.andln=function(I){return this.words[0]&I},l.prototype.bincn=function(I){c(typeof I=="number");var U=I%26,k=(I-U)/26,_=1<<U;if(this.length<=k)return this._expand(k+1),this.words[k]|=_,this;for(var R=_,j=k;R!==0&&j<this.length;j++){var A=0|this.words[j];R=(A+=R)>>>26,A&=67108863,this.words[j]=A}return R!==0&&(this.words[j]=R,this.length++),this},l.prototype.isZero=function(){return this.length===1&&this.words[0]===0},l.prototype.cmpn=function(I){var U,k=I<0;if(this.negative!==0&&!k)return-1;if(this.negative===0&&k)return 1;if(this.strip(),this.length>1)U=1;else{k&&(I=-I),c(I<=67108863,"Number is too big");var _=0|this.words[0];U=_===I?0:_<I?-1:1}return this.negative!==0?0|-U:U},l.prototype.cmp=function(I){if(this.negative!==0&&I.negative===0)return-1;if(this.negative===0&&I.negative!==0)return 1;var U=this.ucmp(I);return this.negative!==0?0|-U:U},l.prototype.ucmp=function(I){if(this.length>I.length)return 1;if(this.length<I.length)return-1;for(var U=0,k=this.length-1;k>=0;k--){var _=0|this.words[k],R=0|I.words[k];if(_!==R){_<R?U=-1:_>R&&(U=1);break}}return U},l.prototype.gtn=function(I){return this.cmpn(I)===1},l.prototype.gt=function(I){return this.cmp(I)===1},l.prototype.gten=function(I){return this.cmpn(I)>=0},l.prototype.gte=function(I){return this.cmp(I)>=0},l.prototype.ltn=function(I){return this.cmpn(I)===-1},l.prototype.lt=function(I){return this.cmp(I)===-1},l.prototype.lten=function(I){return this.cmpn(I)<=0},l.prototype.lte=function(I){return this.cmp(I)<=0},l.prototype.eqn=function(I){return this.cmpn(I)===0},l.prototype.eq=function(I){return this.cmp(I)===0},l.red=function(I){return new W(I)},l.prototype.toRed=function(I){return c(!this.red,"Already a number in reduction context"),c(this.negative===0,"red works only with positives"),I.convertTo(this)._forceRed(I)},l.prototype.fromRed=function(){return c(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},l.prototype._forceRed=function(I){return this.red=I,this},l.prototype.forceRed=function(I){return c(!this.red,"Already a number in reduction context"),this._forceRed(I)},l.prototype.redAdd=function(I){return c(this.red,"redAdd works only with red numbers"),this.red.add(this,I)},l.prototype.redIAdd=function(I){return c(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,I)},l.prototype.redSub=function(I){return c(this.red,"redSub works only with red numbers"),this.red.sub(this,I)},l.prototype.redISub=function(I){return c(this.red,"redISub works only with red numbers"),this.red.isub(this,I)},l.prototype.redShl=function(I){return c(this.red,"redShl works only with red numbers"),this.red.shl(this,I)},l.prototype.redMul=function(I){return c(this.red,"redMul works only with red numbers"),this.red._verify2(this,I),this.red.mul(this,I)},l.prototype.redIMul=function(I){return c(this.red,"redMul works only with red numbers"),this.red._verify2(this,I),this.red.imul(this,I)},l.prototype.redSqr=function(){return c(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},l.prototype.redISqr=function(){return c(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},l.prototype.redSqrt=function(){return c(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},l.prototype.redInvm=function(){return c(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},l.prototype.redNeg=function(){return c(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},l.prototype.redPow=function(I){return c(this.red&&!I.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,I)};var L={k256:null,p224:null,p192:null,p25519:null};function O(I,U){this.name=I,this.p=new l(U,16),this.n=this.p.bitLength(),this.k=new l(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function H(){O.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function z(){O.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function q(){O.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function D(){O.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function W(I){if(typeof I=="string"){var U=l._prime(I);this.m=U.p,this.prime=U}else c(I.gtn(1),"modulus must be greater than 1"),this.m=I,this.prime=null}function P(I){W.call(this,I),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new l(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}O.prototype._tmp=function(){var I=new l(null);return I.words=new Array(Math.ceil(this.n/13)),I},O.prototype.ireduce=function(I){var U,k=I;do this.split(k,this.tmp),U=(k=(k=this.imulK(k)).iadd(this.tmp)).bitLength();while(U>this.n);var _=U<this.n?-1:k.ucmp(this.p);return _===0?(k.words[0]=0,k.length=1):_>0?k.isub(this.p):k.strip!==void 0?k.strip():k._strip(),k},O.prototype.split=function(I,U){I.iushrn(this.n,0,U)},O.prototype.imulK=function(I){return I.imul(this.k)},u(H,O),H.prototype.split=function(I,U){for(var k=Math.min(I.length,9),_=0;_<k;_++)U.words[_]=I.words[_];if(U.length=k,I.length<=9)return I.words[0]=0,void(I.length=1);var R=I.words[9];for(U.words[U.length++]=4194303&R,_=10;_<I.length;_++){var j=0|I.words[_];I.words[_-10]=(4194303&j)<<4|R>>>22,R=j}R>>>=22,I.words[_-10]=R,R===0&&I.length>10?I.length-=10:I.length-=9},H.prototype.imulK=function(I){I.words[I.length]=0,I.words[I.length+1]=0,I.length+=2;for(var U=0,k=0;k<I.length;k++){var _=0|I.words[k];U+=977*_,I.words[k]=67108863&U,U=64*_+(U/67108864|0)}return I.words[I.length-1]===0&&(I.length--,I.words[I.length-1]===0&&I.length--),I},u(z,O),u(q,O),u(D,O),D.prototype.imulK=function(I){for(var U=0,k=0;k<I.length;k++){var _=19*(0|I.words[k])+U,R=67108863&_;_>>>=26,I.words[k]=R,U=_}return U!==0&&(I.words[I.length++]=U),I},l._prime=function(I){if(L[I])return L[I];var U;if(I==="k256")U=new H;else if(I==="p224")U=new z;else if(I==="p192")U=new q;else{if(I!=="p25519")throw new Error("Unknown prime "+I);U=new D}return L[I]=U,U},W.prototype._verify1=function(I){c(I.negative===0,"red works only with positives"),c(I.red,"red works only with red numbers")},W.prototype._verify2=function(I,U){c((I.negative|U.negative)==0,"red works only with positives"),c(I.red&&I.red===U.red,"red works only with red numbers")},W.prototype.imod=function(I){return this.prime?this.prime.ireduce(I)._forceRed(this):I.umod(this.m)._forceRed(this)},W.prototype.neg=function(I){return I.isZero()?I.clone():this.m.sub(I)._forceRed(this)},W.prototype.add=function(I,U){this._verify2(I,U);var k=I.add(U);return k.cmp(this.m)>=0&&k.isub(this.m),k._forceRed(this)},W.prototype.iadd=function(I,U){this._verify2(I,U);var k=I.iadd(U);return k.cmp(this.m)>=0&&k.isub(this.m),k},W.prototype.sub=function(I,U){this._verify2(I,U);var k=I.sub(U);return k.cmpn(0)<0&&k.iadd(this.m),k._forceRed(this)},W.prototype.isub=function(I,U){this._verify2(I,U);var k=I.isub(U);return k.cmpn(0)<0&&k.iadd(this.m),k},W.prototype.shl=function(I,U){return this._verify1(I),this.imod(I.ushln(U))},W.prototype.imul=function(I,U){return this._verify2(I,U),this.imod(I.imul(U))},W.prototype.mul=function(I,U){return this._verify2(I,U),this.imod(I.mul(U))},W.prototype.isqr=function(I){return this.imul(I,I.clone())},W.prototype.sqr=function(I){return this.mul(I,I)},W.prototype.sqrt=function(I){if(I.isZero())return I.clone();var U=this.m.andln(3);if(c(U%2==1),U===3){var k=this.m.add(new l(1)).iushrn(2);return this.pow(I,k)}for(var _=this.m.subn(1),R=0;!_.isZero()&&_.andln(1)===0;)R++,_.iushrn(1);c(!_.isZero());var j=new l(1).toRed(this),A=j.redNeg(),N=this.m.subn(1).iushrn(1),V=this.m.bitLength();for(V=new l(2*V*V).toRed(this);this.pow(V,N).cmp(A)!==0;)V.redIAdd(A);for(var M=this.pow(V,_),Z=this.pow(I,_.addn(1).iushrn(1)),J=this.pow(I,_),re=R;J.cmp(j)!==0;){for(var X=J,ne=0;X.cmp(j)!==0;ne++)X=X.redSqr();c(ne<re);var Y=this.pow(M,new l(1).iushln(re-ne-1));Z=Z.redMul(Y),M=Y.redSqr(),J=J.redMul(M),re=ne}return Z},W.prototype.invm=function(I){var U=I._invmp(this.m);return U.negative!==0?(U.negative=0,this.imod(U).redNeg()):this.imod(U)},W.prototype.pow=function(I,U){if(U.isZero())return new l(1).toRed(this);if(U.cmpn(1)===0)return I.clone();var k=new Array(16);k[0]=new l(1).toRed(this),k[1]=I;for(var _=2;_<k.length;_++)k[_]=this.mul(k[_-1],I);var R=k[0],j=0,A=0,N=U.bitLength()%26;for(N===0&&(N=26),_=U.length-1;_>=0;_--){for(var V=U.words[_],M=N-1;M>=0;M--){var Z=V>>M&1;R!==k[0]&&(R=this.sqr(R)),Z!==0||j!==0?(j<<=1,j|=Z,(++A===4||_===0&&M===0)&&(R=this.mul(R,k[j]),A=0,j=0)):A=0}N=26}return R},W.prototype.convertTo=function(I){var U=I.umod(this.m);return U===I?U.clone():U},W.prototype.convertFrom=function(I){var U=I.clone();return U.red=null,U},l.mont=function(I){return new P(I)},u(P,W),P.prototype.convertTo=function(I){return this.imod(I.ushln(this.shift))},P.prototype.convertFrom=function(I){var U=this.imod(I.mul(this.rinv));return U.red=null,U},P.prototype.imul=function(I,U){if(I.isZero()||U.isZero())return I.words[0]=0,I.length=1,I;var k=I.imul(U),_=k.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),R=k.isub(_).iushrn(this.shift),j=R;return R.cmp(this.m)>=0?j=R.isub(this.m):R.cmpn(0)<0&&(j=R.iadd(this.m)),j._forceRed(this)},P.prototype.mul=function(I,U){if(I.isZero()||U.isZero())return new l(0)._forceRed(this);var k=I.mul(U),_=k.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),R=k.isub(_).iushrn(this.shift),j=R;return R.cmp(this.m)>=0?j=R.isub(this.m):R.cmpn(0)<0&&(j=R.iadd(this.m)),j._forceRed(this)},P.prototype.invm=function(I){return this.imod(I._invmp(this.m).mul(this.r2))._forceRed(this)}})(n===void 0||n)},{buffer:188}],185:[function(t,n,s){s.byteLength=function(p){var v=h(p),g=v[0],m=v[1];return 3*(g+m)/4-m},s.toByteArray=function(p){var v,g,m=h(p),b=m[0],y=m[1],S=new c(function(O,H,z){return 3*(H+z)/4-z}(0,b,y)),C=0,L=y>0?b-4:b;for(g=0;g<L;g+=4)v=i[p.charCodeAt(g)]<<18|i[p.charCodeAt(g+1)]<<12|i[p.charCodeAt(g+2)]<<6|i[p.charCodeAt(g+3)],S[C++]=v>>16&255,S[C++]=v>>8&255,S[C++]=255&v;return y===2&&(v=i[p.charCodeAt(g)]<<2|i[p.charCodeAt(g+1)]>>4,S[C++]=255&v),y===1&&(v=i[p.charCodeAt(g)]<<10|i[p.charCodeAt(g+1)]<<4|i[p.charCodeAt(g+2)]>>2,S[C++]=v>>8&255,S[C++]=255&v),S},s.fromByteArray=function(p){for(var v,g=p.length,m=g%3,b=[],y=0,S=g-m;y<S;y+=16383)b.push(f(p,y,y+16383>S?S:y+16383));return m===1?(v=p[g-1],b.push(o[v>>2]+o[v<<4&63]+"==")):m===2&&(v=(p[g-2]<<8)+p[g-1],b.push(o[v>>10]+o[v>>4&63]+o[v<<2&63]+"=")),b.join("")};for(var o=[],i=[],c=typeof Uint8Array<"u"?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,d=u.length;l<d;++l)o[l]=u[l],i[u.charCodeAt(l)]=l;function h(p){var v=p.length;if(v%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var g=p.indexOf("=");return g===-1&&(g=v),[g,g===v?0:4-g%4]}function f(p,v,g){for(var m,b,y=[],S=v;S<g;S+=3)m=(p[S]<<16&16711680)+(p[S+1]<<8&65280)+(255&p[S+2]),y.push(o[(b=m)>>18&63]+o[b>>12&63]+o[b>>6&63]+o[63&b]);return y.join("")}i[45]=62,i[95]=63},{}],186:[function(t,n,s){(function(o,i){function c(k,_){if(!k)throw new Error(_||"Assertion failed")}function u(k,_){k.super_=_;var R=function(){};R.prototype=_.prototype,k.prototype=new R,k.prototype.constructor=k}function l(k,_,R){if(l.isBN(k))return k;this.negative=0,this.words=null,this.length=0,this.red=null,k!==null&&(_!=="le"&&_!=="be"||(R=_,_=10),this._init(k||0,_||10,R||"be"))}var d;typeof o=="object"?o.exports=l:(void 0).BN=l,l.BN=l,l.wordSize=26;try{d=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:t("buffer").Buffer}catch{}function h(k,_){var R=k.charCodeAt(_);return R>=48&&R<=57?R-48:R>=65&&R<=70?R-55:R>=97&&R<=102?R-87:void c(!1,"Invalid character in "+k)}function f(k,_,R){var j=h(k,R);return R-1>=_&&(j|=h(k,R-1)<<4),j}function p(k,_,R,j){for(var A=0,N=0,V=Math.min(k.length,R),M=_;M<V;M++){var Z=k.charCodeAt(M)-48;A*=j,N=Z>=49?Z-49+10:Z>=17?Z-17+10:Z,c(Z>=0&&N<j,"Invalid character"),A+=N}return A}function v(k,_){k.words=_.words,k.length=_.length,k.negative=_.negative,k.red=_.red}if(l.isBN=function(k){return k instanceof l||k!==null&&typeof k=="object"&&k.constructor.wordSize===l.wordSize&&Array.isArray(k.words)},l.max=function(k,_){return k.cmp(_)>0?k:_},l.min=function(k,_){return k.cmp(_)<0?k:_},l.prototype._init=function(k,_,R){if(typeof k=="number")return this._initNumber(k,_,R);if(typeof k=="object")return this._initArray(k,_,R);_==="hex"&&(_=16),c(_===(0|_)&&_>=2&&_<=36);var j=0;(k=k.toString().replace(/\s+/g,""))[0]==="-"&&(j++,this.negative=1),j<k.length&&(_===16?this._parseHex(k,j,R):(this._parseBase(k,_,j),R==="le"&&this._initArray(this.toArray(),_,R)))},l.prototype._initNumber=function(k,_,R){k<0&&(this.negative=1,k=-k),k<67108864?(this.words=[67108863&k],this.length=1):k<4503599627370496?(this.words=[67108863&k,k/67108864&67108863],this.length=2):(c(k<9007199254740992),this.words=[67108863&k,k/67108864&67108863,1],this.length=3),R==="le"&&this._initArray(this.toArray(),_,R)},l.prototype._initArray=function(k,_,R){if(c(typeof k.length=="number"),k.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(k.length/3),this.words=new Array(this.length);for(var j=0;j<this.length;j++)this.words[j]=0;var A,N,V=0;if(R==="be")for(j=k.length-1,A=0;j>=0;j-=3)N=k[j]|k[j-1]<<8|k[j-2]<<16,this.words[A]|=N<<V&67108863,this.words[A+1]=N>>>26-V&67108863,(V+=24)>=26&&(V-=26,A++);else if(R==="le")for(j=0,A=0;j<k.length;j+=3)N=k[j]|k[j+1]<<8|k[j+2]<<16,this.words[A]|=N<<V&67108863,this.words[A+1]=N>>>26-V&67108863,(V+=24)>=26&&(V-=26,A++);return this._strip()},l.prototype._parseHex=function(k,_,R){this.length=Math.ceil((k.length-_)/6),this.words=new Array(this.length);for(var j=0;j<this.length;j++)this.words[j]=0;var A,N=0,V=0;if(R==="be")for(j=k.length-1;j>=_;j-=2)A=f(k,_,j)<<N,this.words[V]|=67108863&A,N>=18?(N-=18,V+=1,this.words[V]|=A>>>26):N+=8;else for(j=(k.length-_)%2==0?_+1:_;j<k.length;j+=2)A=f(k,_,j)<<N,this.words[V]|=67108863&A,N>=18?(N-=18,V+=1,this.words[V]|=A>>>26):N+=8;this._strip()},l.prototype._parseBase=function(k,_,R){this.words=[0],this.length=1;for(var j=0,A=1;A<=67108863;A*=_)j++;j--,A=A/_|0;for(var N=k.length-R,V=N%j,M=Math.min(N,N-V)+R,Z=0,J=R;J<M;J+=j)Z=p(k,J,J+j,_),this.imuln(A),this.words[0]+Z<67108864?this.words[0]+=Z:this._iaddn(Z);if(V!==0){var re=1;for(Z=p(k,J,k.length,_),J=0;J<V;J++)re*=_;this.imuln(re),this.words[0]+Z<67108864?this.words[0]+=Z:this._iaddn(Z)}this._strip()},l.prototype.copy=function(k){k.words=new Array(this.length);for(var _=0;_<this.length;_++)k.words[_]=this.words[_];k.length=this.length,k.negative=this.negative,k.red=this.red},l.prototype._move=function(k){v(k,this)},l.prototype.clone=function(){var k=new l(null);return this.copy(k),k},l.prototype._expand=function(k){for(;this.length<k;)this.words[this.length++]=0;return this},l.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},l.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{l.prototype[Symbol.for("nodejs.util.inspect.custom")]=g}catch{l.prototype.inspect=g}else l.prototype.inspect=g;function g(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var m=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],b=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],y=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];l.prototype.toString=function(k,_){var R;if(_=0|_||1,(k=k||10)===16||k==="hex"){R="";for(var j=0,A=0,N=0;N<this.length;N++){var V=this.words[N],M=(16777215&(V<<j|A)).toString(16);A=V>>>24-j&16777215,(j+=2)>=26&&(j-=26,N--),R=A!==0||N!==this.length-1?m[6-M.length]+M+R:M+R}for(A!==0&&(R=A.toString(16)+R);R.length%_!=0;)R="0"+R;return this.negative!==0&&(R="-"+R),R}if(k===(0|k)&&k>=2&&k<=36){var Z=b[k],J=y[k];R="";var re=this.clone();for(re.negative=0;!re.isZero();){var X=re.modrn(J).toString(k);R=(re=re.idivn(J)).isZero()?X+R:m[Z-X.length]+X+R}for(this.isZero()&&(R="0"+R);R.length%_!=0;)R="0"+R;return this.negative!==0&&(R="-"+R),R}c(!1,"Base should be between 2 and 36")},l.prototype.toNumber=function(){var k=this.words[0];return this.length===2?k+=67108864*this.words[1]:this.length===3&&this.words[2]===1?k+=4503599627370496+67108864*this.words[1]:this.length>2&&c(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-k:k},l.prototype.toJSON=function(){return this.toString(16,2)},d&&(l.prototype.toBuffer=function(k,_){return this.toArrayLike(d,k,_)}),l.prototype.toArray=function(k,_){return this.toArrayLike(Array,k,_)};function S(k,_,R){R.negative=_.negative^k.negative;var j=k.length+_.length|0;R.length=j,j=j-1|0;var A=0|k.words[0],N=0|_.words[0],V=A*N,M=67108863&V,Z=V/67108864|0;R.words[0]=M;for(var J=1;J<j;J++){for(var re=Z>>>26,X=67108863&Z,ne=Math.min(J,_.length-1),Y=Math.max(0,J-k.length+1);Y<=ne;Y++){var K=J-Y|0;re+=(V=(A=0|k.words[K])*(N=0|_.words[Y])+X)/67108864|0,X=67108863&V}R.words[J]=0|X,Z=0|re}return Z!==0?R.words[J]=0|Z:R.length--,R._strip()}l.prototype.toArrayLike=function(k,_,R){this._strip();var j=this.byteLength(),A=R||Math.max(1,j);c(j<=A,"byte array longer than desired length"),c(A>0,"Requested array length <= 0");var N=function(V,M){return V.allocUnsafe?V.allocUnsafe(M):new V(M)}(k,A);return this["_toArrayLike"+(_==="le"?"LE":"BE")](N,j),N},l.prototype._toArrayLikeLE=function(k,_){for(var R=0,j=0,A=0,N=0;A<this.length;A++){var V=this.words[A]<<N|j;k[R++]=255&V,R<k.length&&(k[R++]=V>>8&255),R<k.length&&(k[R++]=V>>16&255),N===6?(R<k.length&&(k[R++]=V>>24&255),j=0,N=0):(j=V>>>24,N+=2)}if(R<k.length)for(k[R++]=j;R<k.length;)k[R++]=0},l.prototype._toArrayLikeBE=function(k,_){for(var R=k.length-1,j=0,A=0,N=0;A<this.length;A++){var V=this.words[A]<<N|j;k[R--]=255&V,R>=0&&(k[R--]=V>>8&255),R>=0&&(k[R--]=V>>16&255),N===6?(R>=0&&(k[R--]=V>>24&255),j=0,N=0):(j=V>>>24,N+=2)}if(R>=0)for(k[R--]=j;R>=0;)k[R--]=0},Math.clz32?l.prototype._countBits=function(k){return 32-Math.clz32(k)}:l.prototype._countBits=function(k){var _=k,R=0;return _>=4096&&(R+=13,_>>>=13),_>=64&&(R+=7,_>>>=7),_>=8&&(R+=4,_>>>=4),_>=2&&(R+=2,_>>>=2),R+_},l.prototype._zeroBits=function(k){if(k===0)return 26;var _=k,R=0;return(8191&_)==0&&(R+=13,_>>>=13),(127&_)==0&&(R+=7,_>>>=7),(15&_)==0&&(R+=4,_>>>=4),(3&_)==0&&(R+=2,_>>>=2),(1&_)==0&&R++,R},l.prototype.bitLength=function(){var k=this.words[this.length-1],_=this._countBits(k);return 26*(this.length-1)+_},l.prototype.zeroBits=function(){if(this.isZero())return 0;for(var k=0,_=0;_<this.length;_++){var R=this._zeroBits(this.words[_]);if(k+=R,R!==26)break}return k},l.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},l.prototype.toTwos=function(k){return this.negative!==0?this.abs().inotn(k).iaddn(1):this.clone()},l.prototype.fromTwos=function(k){return this.testn(k-1)?this.notn(k).iaddn(1).ineg():this.clone()},l.prototype.isNeg=function(){return this.negative!==0},l.prototype.neg=function(){return this.clone().ineg()},l.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},l.prototype.iuor=function(k){for(;this.length<k.length;)this.words[this.length++]=0;for(var _=0;_<k.length;_++)this.words[_]=this.words[_]|k.words[_];return this._strip()},l.prototype.ior=function(k){return c((this.negative|k.negative)==0),this.iuor(k)},l.prototype.or=function(k){return this.length>k.length?this.clone().ior(k):k.clone().ior(this)},l.prototype.uor=function(k){return this.length>k.length?this.clone().iuor(k):k.clone().iuor(this)},l.prototype.iuand=function(k){var _;_=this.length>k.length?k:this;for(var R=0;R<_.length;R++)this.words[R]=this.words[R]&k.words[R];return this.length=_.length,this._strip()},l.prototype.iand=function(k){return c((this.negative|k.negative)==0),this.iuand(k)},l.prototype.and=function(k){return this.length>k.length?this.clone().iand(k):k.clone().iand(this)},l.prototype.uand=function(k){return this.length>k.length?this.clone().iuand(k):k.clone().iuand(this)},l.prototype.iuxor=function(k){var _,R;this.length>k.length?(_=this,R=k):(_=k,R=this);for(var j=0;j<R.length;j++)this.words[j]=_.words[j]^R.words[j];if(this!==_)for(;j<_.length;j++)this.words[j]=_.words[j];return this.length=_.length,this._strip()},l.prototype.ixor=function(k){return c((this.negative|k.negative)==0),this.iuxor(k)},l.prototype.xor=function(k){return this.length>k.length?this.clone().ixor(k):k.clone().ixor(this)},l.prototype.uxor=function(k){return this.length>k.length?this.clone().iuxor(k):k.clone().iuxor(this)},l.prototype.inotn=function(k){c(typeof k=="number"&&k>=0);var _=0|Math.ceil(k/26),R=k%26;this._expand(_),R>0&&_--;for(var j=0;j<_;j++)this.words[j]=67108863&~this.words[j];return R>0&&(this.words[j]=~this.words[j]&67108863>>26-R),this._strip()},l.prototype.notn=function(k){return this.clone().inotn(k)},l.prototype.setn=function(k,_){c(typeof k=="number"&&k>=0);var R=k/26|0,j=k%26;return this._expand(R+1),this.words[R]=_?this.words[R]|1<<j:this.words[R]&~(1<<j),this._strip()},l.prototype.iadd=function(k){var _,R,j;if(this.negative!==0&&k.negative===0)return this.negative=0,_=this.isub(k),this.negative^=1,this._normSign();if(this.negative===0&&k.negative!==0)return k.negative=0,_=this.isub(k),k.negative=1,_._normSign();this.length>k.length?(R=this,j=k):(R=k,j=this);for(var A=0,N=0;N<j.length;N++)_=(0|R.words[N])+(0|j.words[N])+A,this.words[N]=67108863&_,A=_>>>26;for(;A!==0&&N<R.length;N++)_=(0|R.words[N])+A,this.words[N]=67108863&_,A=_>>>26;if(this.length=R.length,A!==0)this.words[this.length]=A,this.length++;else if(R!==this)for(;N<R.length;N++)this.words[N]=R.words[N];return this},l.prototype.add=function(k){var _;return k.negative!==0&&this.negative===0?(k.negative=0,_=this.sub(k),k.negative^=1,_):k.negative===0&&this.negative!==0?(this.negative=0,_=k.sub(this),this.negative=1,_):this.length>k.length?this.clone().iadd(k):k.clone().iadd(this)},l.prototype.isub=function(k){if(k.negative!==0){k.negative=0;var _=this.iadd(k);return k.negative=1,_._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(k),this.negative=1,this._normSign();var R,j,A=this.cmp(k);if(A===0)return this.negative=0,this.length=1,this.words[0]=0,this;A>0?(R=this,j=k):(R=k,j=this);for(var N=0,V=0;V<j.length;V++)N=(_=(0|R.words[V])-(0|j.words[V])+N)>>26,this.words[V]=67108863&_;for(;N!==0&&V<R.length;V++)N=(_=(0|R.words[V])+N)>>26,this.words[V]=67108863&_;if(N===0&&V<R.length&&R!==this)for(;V<R.length;V++)this.words[V]=R.words[V];return this.length=Math.max(this.length,V),R!==this&&(this.negative=1),this._strip()},l.prototype.sub=function(k){return this.clone().isub(k)};var C=function(k,_,R){var j,A,N,V=k.words,M=_.words,Z=R.words,J=0,re=0|V[0],X=8191&re,ne=re>>>13,Y=0|V[1],K=8191&Y,ee=Y>>>13,ue=0|V[2],se=8191&ue,ce=ue>>>13,fe=0|V[3],ve=8191&fe,_e=fe>>>13,le=0|V[4],ke=8191&le,Te=le>>>13,pe=0|V[5],ye=8191&pe,ge=pe>>>13,De=0|V[6],He=8191&De,Xe=De>>>13,at=0|V[7],dt=8191&at,wt=at>>>13,$t=0|V[8],Bt=8191&$t,ft=$t>>>13,tr=0|V[9],Me=8191&tr,tt=tr>>>13,Ze=0|M[0],St=8191&Ze,et=Ze>>>13,Ht=0|M[1],Nt=8191&Ht,kt=Ht>>>13,kr=0|M[2],Jt=8191&kr,Pt=kr>>>13,Ur=0|M[3],Lr=8191&Ur,vt=Ur>>>13,nr=0|M[4],Cr=8191&nr,Dt=nr>>>13,je=0|M[5],ct=8191&je,nt=je>>>13,Pe=0|M[6],Qe=8191&Pe,gt=Pe>>>13,xe=0|M[7],Oe=8191&xe,Ce=xe>>>13,de=0|M[8],be=8191&de,Se=de>>>13,Ne=0|M[9],ze=8191&Ne,Re=Ne>>>13;R.negative=k.negative^_.negative,R.length=19;var Ie=(J+(j=Math.imul(X,St))|0)+((8191&(A=(A=Math.imul(X,et))+Math.imul(ne,St)|0))<<13)|0;J=((N=Math.imul(ne,et))+(A>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,j=Math.imul(K,St),A=(A=Math.imul(K,et))+Math.imul(ee,St)|0,N=Math.imul(ee,et);var ae=(J+(j=j+Math.imul(X,Nt)|0)|0)+((8191&(A=(A=A+Math.imul(X,kt)|0)+Math.imul(ne,Nt)|0))<<13)|0;J=((N=N+Math.imul(ne,kt)|0)+(A>>>13)|0)+(ae>>>26)|0,ae&=67108863,j=Math.imul(se,St),A=(A=Math.imul(se,et))+Math.imul(ce,St)|0,N=Math.imul(ce,et),j=j+Math.imul(K,Nt)|0,A=(A=A+Math.imul(K,kt)|0)+Math.imul(ee,Nt)|0,N=N+Math.imul(ee,kt)|0;var we=(J+(j=j+Math.imul(X,Jt)|0)|0)+((8191&(A=(A=A+Math.imul(X,Pt)|0)+Math.imul(ne,Jt)|0))<<13)|0;J=((N=N+Math.imul(ne,Pt)|0)+(A>>>13)|0)+(we>>>26)|0,we&=67108863,j=Math.imul(ve,St),A=(A=Math.imul(ve,et))+Math.imul(_e,St)|0,N=Math.imul(_e,et),j=j+Math.imul(se,Nt)|0,A=(A=A+Math.imul(se,kt)|0)+Math.imul(ce,Nt)|0,N=N+Math.imul(ce,kt)|0,j=j+Math.imul(K,Jt)|0,A=(A=A+Math.imul(K,Pt)|0)+Math.imul(ee,Jt)|0,N=N+Math.imul(ee,Pt)|0;var Fe=(J+(j=j+Math.imul(X,Lr)|0)|0)+((8191&(A=(A=A+Math.imul(X,vt)|0)+Math.imul(ne,Lr)|0))<<13)|0;J=((N=N+Math.imul(ne,vt)|0)+(A>>>13)|0)+(Fe>>>26)|0,Fe&=67108863,j=Math.imul(ke,St),A=(A=Math.imul(ke,et))+Math.imul(Te,St)|0,N=Math.imul(Te,et),j=j+Math.imul(ve,Nt)|0,A=(A=A+Math.imul(ve,kt)|0)+Math.imul(_e,Nt)|0,N=N+Math.imul(_e,kt)|0,j=j+Math.imul(se,Jt)|0,A=(A=A+Math.imul(se,Pt)|0)+Math.imul(ce,Jt)|0,N=N+Math.imul(ce,Pt)|0,j=j+Math.imul(K,Lr)|0,A=(A=A+Math.imul(K,vt)|0)+Math.imul(ee,Lr)|0,N=N+Math.imul(ee,vt)|0;var Ye=(J+(j=j+Math.imul(X,Cr)|0)|0)+((8191&(A=(A=A+Math.imul(X,Dt)|0)+Math.imul(ne,Cr)|0))<<13)|0;J=((N=N+Math.imul(ne,Dt)|0)+(A>>>13)|0)+(Ye>>>26)|0,Ye&=67108863,j=Math.imul(ye,St),A=(A=Math.imul(ye,et))+Math.imul(ge,St)|0,N=Math.imul(ge,et),j=j+Math.imul(ke,Nt)|0,A=(A=A+Math.imul(ke,kt)|0)+Math.imul(Te,Nt)|0,N=N+Math.imul(Te,kt)|0,j=j+Math.imul(ve,Jt)|0,A=(A=A+Math.imul(ve,Pt)|0)+Math.imul(_e,Jt)|0,N=N+Math.imul(_e,Pt)|0,j=j+Math.imul(se,Lr)|0,A=(A=A+Math.imul(se,vt)|0)+Math.imul(ce,Lr)|0,N=N+Math.imul(ce,vt)|0,j=j+Math.imul(K,Cr)|0,A=(A=A+Math.imul(K,Dt)|0)+Math.imul(ee,Cr)|0,N=N+Math.imul(ee,Dt)|0;var me=(J+(j=j+Math.imul(X,ct)|0)|0)+((8191&(A=(A=A+Math.imul(X,nt)|0)+Math.imul(ne,ct)|0))<<13)|0;J=((N=N+Math.imul(ne,nt)|0)+(A>>>13)|0)+(me>>>26)|0,me&=67108863,j=Math.imul(He,St),A=(A=Math.imul(He,et))+Math.imul(Xe,St)|0,N=Math.imul(Xe,et),j=j+Math.imul(ye,Nt)|0,A=(A=A+Math.imul(ye,kt)|0)+Math.imul(ge,Nt)|0,N=N+Math.imul(ge,kt)|0,j=j+Math.imul(ke,Jt)|0,A=(A=A+Math.imul(ke,Pt)|0)+Math.imul(Te,Jt)|0,N=N+Math.imul(Te,Pt)|0,j=j+Math.imul(ve,Lr)|0,A=(A=A+Math.imul(ve,vt)|0)+Math.imul(_e,Lr)|0,N=N+Math.imul(_e,vt)|0,j=j+Math.imul(se,Cr)|0,A=(A=A+Math.imul(se,Dt)|0)+Math.imul(ce,Cr)|0,N=N+Math.imul(ce,Dt)|0,j=j+Math.imul(K,ct)|0,A=(A=A+Math.imul(K,nt)|0)+Math.imul(ee,ct)|0,N=N+Math.imul(ee,nt)|0;var Be=(J+(j=j+Math.imul(X,Qe)|0)|0)+((8191&(A=(A=A+Math.imul(X,gt)|0)+Math.imul(ne,Qe)|0))<<13)|0;J=((N=N+Math.imul(ne,gt)|0)+(A>>>13)|0)+(Be>>>26)|0,Be&=67108863,j=Math.imul(dt,St),A=(A=Math.imul(dt,et))+Math.imul(wt,St)|0,N=Math.imul(wt,et),j=j+Math.imul(He,Nt)|0,A=(A=A+Math.imul(He,kt)|0)+Math.imul(Xe,Nt)|0,N=N+Math.imul(Xe,kt)|0,j=j+Math.imul(ye,Jt)|0,A=(A=A+Math.imul(ye,Pt)|0)+Math.imul(ge,Jt)|0,N=N+Math.imul(ge,Pt)|0,j=j+Math.imul(ke,Lr)|0,A=(A=A+Math.imul(ke,vt)|0)+Math.imul(Te,Lr)|0,N=N+Math.imul(Te,vt)|0,j=j+Math.imul(ve,Cr)|0,A=(A=A+Math.imul(ve,Dt)|0)+Math.imul(_e,Cr)|0,N=N+Math.imul(_e,Dt)|0,j=j+Math.imul(se,ct)|0,A=(A=A+Math.imul(se,nt)|0)+Math.imul(ce,ct)|0,N=N+Math.imul(ce,nt)|0,j=j+Math.imul(K,Qe)|0,A=(A=A+Math.imul(K,gt)|0)+Math.imul(ee,Qe)|0,N=N+Math.imul(ee,gt)|0;var Ge=(J+(j=j+Math.imul(X,Oe)|0)|0)+((8191&(A=(A=A+Math.imul(X,Ce)|0)+Math.imul(ne,Oe)|0))<<13)|0;J=((N=N+Math.imul(ne,Ce)|0)+(A>>>13)|0)+(Ge>>>26)|0,Ge&=67108863,j=Math.imul(Bt,St),A=(A=Math.imul(Bt,et))+Math.imul(ft,St)|0,N=Math.imul(ft,et),j=j+Math.imul(dt,Nt)|0,A=(A=A+Math.imul(dt,kt)|0)+Math.imul(wt,Nt)|0,N=N+Math.imul(wt,kt)|0,j=j+Math.imul(He,Jt)|0,A=(A=A+Math.imul(He,Pt)|0)+Math.imul(Xe,Jt)|0,N=N+Math.imul(Xe,Pt)|0,j=j+Math.imul(ye,Lr)|0,A=(A=A+Math.imul(ye,vt)|0)+Math.imul(ge,Lr)|0,N=N+Math.imul(ge,vt)|0,j=j+Math.imul(ke,Cr)|0,A=(A=A+Math.imul(ke,Dt)|0)+Math.imul(Te,Cr)|0,N=N+Math.imul(Te,Dt)|0,j=j+Math.imul(ve,ct)|0,A=(A=A+Math.imul(ve,nt)|0)+Math.imul(_e,ct)|0,N=N+Math.imul(_e,nt)|0,j=j+Math.imul(se,Qe)|0,A=(A=A+Math.imul(se,gt)|0)+Math.imul(ce,Qe)|0,N=N+Math.imul(ce,gt)|0,j=j+Math.imul(K,Oe)|0,A=(A=A+Math.imul(K,Ce)|0)+Math.imul(ee,Oe)|0,N=N+Math.imul(ee,Ce)|0;var mt=(J+(j=j+Math.imul(X,be)|0)|0)+((8191&(A=(A=A+Math.imul(X,Se)|0)+Math.imul(ne,be)|0))<<13)|0;J=((N=N+Math.imul(ne,Se)|0)+(A>>>13)|0)+(mt>>>26)|0,mt&=67108863,j=Math.imul(Me,St),A=(A=Math.imul(Me,et))+Math.imul(tt,St)|0,N=Math.imul(tt,et),j=j+Math.imul(Bt,Nt)|0,A=(A=A+Math.imul(Bt,kt)|0)+Math.imul(ft,Nt)|0,N=N+Math.imul(ft,kt)|0,j=j+Math.imul(dt,Jt)|0,A=(A=A+Math.imul(dt,Pt)|0)+Math.imul(wt,Jt)|0,N=N+Math.imul(wt,Pt)|0,j=j+Math.imul(He,Lr)|0,A=(A=A+Math.imul(He,vt)|0)+Math.imul(Xe,Lr)|0,N=N+Math.imul(Xe,vt)|0,j=j+Math.imul(ye,Cr)|0,A=(A=A+Math.imul(ye,Dt)|0)+Math.imul(ge,Cr)|0,N=N+Math.imul(ge,Dt)|0,j=j+Math.imul(ke,ct)|0,A=(A=A+Math.imul(ke,nt)|0)+Math.imul(Te,ct)|0,N=N+Math.imul(Te,nt)|0,j=j+Math.imul(ve,Qe)|0,A=(A=A+Math.imul(ve,gt)|0)+Math.imul(_e,Qe)|0,N=N+Math.imul(_e,gt)|0,j=j+Math.imul(se,Oe)|0,A=(A=A+Math.imul(se,Ce)|0)+Math.imul(ce,Oe)|0,N=N+Math.imul(ce,Ce)|0,j=j+Math.imul(K,be)|0,A=(A=A+Math.imul(K,Se)|0)+Math.imul(ee,be)|0,N=N+Math.imul(ee,Se)|0;var _t=(J+(j=j+Math.imul(X,ze)|0)|0)+((8191&(A=(A=A+Math.imul(X,Re)|0)+Math.imul(ne,ze)|0))<<13)|0;J=((N=N+Math.imul(ne,Re)|0)+(A>>>13)|0)+(_t>>>26)|0,_t&=67108863,j=Math.imul(Me,Nt),A=(A=Math.imul(Me,kt))+Math.imul(tt,Nt)|0,N=Math.imul(tt,kt),j=j+Math.imul(Bt,Jt)|0,A=(A=A+Math.imul(Bt,Pt)|0)+Math.imul(ft,Jt)|0,N=N+Math.imul(ft,Pt)|0,j=j+Math.imul(dt,Lr)|0,A=(A=A+Math.imul(dt,vt)|0)+Math.imul(wt,Lr)|0,N=N+Math.imul(wt,vt)|0,j=j+Math.imul(He,Cr)|0,A=(A=A+Math.imul(He,Dt)|0)+Math.imul(Xe,Cr)|0,N=N+Math.imul(Xe,Dt)|0,j=j+Math.imul(ye,ct)|0,A=(A=A+Math.imul(ye,nt)|0)+Math.imul(ge,ct)|0,N=N+Math.imul(ge,nt)|0,j=j+Math.imul(ke,Qe)|0,A=(A=A+Math.imul(ke,gt)|0)+Math.imul(Te,Qe)|0,N=N+Math.imul(Te,gt)|0,j=j+Math.imul(ve,Oe)|0,A=(A=A+Math.imul(ve,Ce)|0)+Math.imul(_e,Oe)|0,N=N+Math.imul(_e,Ce)|0,j=j+Math.imul(se,be)|0,A=(A=A+Math.imul(se,Se)|0)+Math.imul(ce,be)|0,N=N+Math.imul(ce,Se)|0;var ot=(J+(j=j+Math.imul(K,ze)|0)|0)+((8191&(A=(A=A+Math.imul(K,Re)|0)+Math.imul(ee,ze)|0))<<13)|0;J=((N=N+Math.imul(ee,Re)|0)+(A>>>13)|0)+(ot>>>26)|0,ot&=67108863,j=Math.imul(Me,Jt),A=(A=Math.imul(Me,Pt))+Math.imul(tt,Jt)|0,N=Math.imul(tt,Pt),j=j+Math.imul(Bt,Lr)|0,A=(A=A+Math.imul(Bt,vt)|0)+Math.imul(ft,Lr)|0,N=N+Math.imul(ft,vt)|0,j=j+Math.imul(dt,Cr)|0,A=(A=A+Math.imul(dt,Dt)|0)+Math.imul(wt,Cr)|0,N=N+Math.imul(wt,Dt)|0,j=j+Math.imul(He,ct)|0,A=(A=A+Math.imul(He,nt)|0)+Math.imul(Xe,ct)|0,N=N+Math.imul(Xe,nt)|0,j=j+Math.imul(ye,Qe)|0,A=(A=A+Math.imul(ye,gt)|0)+Math.imul(ge,Qe)|0,N=N+Math.imul(ge,gt)|0,j=j+Math.imul(ke,Oe)|0,A=(A=A+Math.imul(ke,Ce)|0)+Math.imul(Te,Oe)|0,N=N+Math.imul(Te,Ce)|0,j=j+Math.imul(ve,be)|0,A=(A=A+Math.imul(ve,Se)|0)+Math.imul(_e,be)|0,N=N+Math.imul(_e,Se)|0;var xt=(J+(j=j+Math.imul(se,ze)|0)|0)+((8191&(A=(A=A+Math.imul(se,Re)|0)+Math.imul(ce,ze)|0))<<13)|0;J=((N=N+Math.imul(ce,Re)|0)+(A>>>13)|0)+(xt>>>26)|0,xt&=67108863,j=Math.imul(Me,Lr),A=(A=Math.imul(Me,vt))+Math.imul(tt,Lr)|0,N=Math.imul(tt,vt),j=j+Math.imul(Bt,Cr)|0,A=(A=A+Math.imul(Bt,Dt)|0)+Math.imul(ft,Cr)|0,N=N+Math.imul(ft,Dt)|0,j=j+Math.imul(dt,ct)|0,A=(A=A+Math.imul(dt,nt)|0)+Math.imul(wt,ct)|0,N=N+Math.imul(wt,nt)|0,j=j+Math.imul(He,Qe)|0,A=(A=A+Math.imul(He,gt)|0)+Math.imul(Xe,Qe)|0,N=N+Math.imul(Xe,gt)|0,j=j+Math.imul(ye,Oe)|0,A=(A=A+Math.imul(ye,Ce)|0)+Math.imul(ge,Oe)|0,N=N+Math.imul(ge,Ce)|0,j=j+Math.imul(ke,be)|0,A=(A=A+Math.imul(ke,Se)|0)+Math.imul(Te,be)|0,N=N+Math.imul(Te,Se)|0;var zt=(J+(j=j+Math.imul(ve,ze)|0)|0)+((8191&(A=(A=A+Math.imul(ve,Re)|0)+Math.imul(_e,ze)|0))<<13)|0;J=((N=N+Math.imul(_e,Re)|0)+(A>>>13)|0)+(zt>>>26)|0,zt&=67108863,j=Math.imul(Me,Cr),A=(A=Math.imul(Me,Dt))+Math.imul(tt,Cr)|0,N=Math.imul(tt,Dt),j=j+Math.imul(Bt,ct)|0,A=(A=A+Math.imul(Bt,nt)|0)+Math.imul(ft,ct)|0,N=N+Math.imul(ft,nt)|0,j=j+Math.imul(dt,Qe)|0,A=(A=A+Math.imul(dt,gt)|0)+Math.imul(wt,Qe)|0,N=N+Math.imul(wt,gt)|0,j=j+Math.imul(He,Oe)|0,A=(A=A+Math.imul(He,Ce)|0)+Math.imul(Xe,Oe)|0,N=N+Math.imul(Xe,Ce)|0,j=j+Math.imul(ye,be)|0,A=(A=A+Math.imul(ye,Se)|0)+Math.imul(ge,be)|0,N=N+Math.imul(ge,Se)|0;var Vt=(J+(j=j+Math.imul(ke,ze)|0)|0)+((8191&(A=(A=A+Math.imul(ke,Re)|0)+Math.imul(Te,ze)|0))<<13)|0;J=((N=N+Math.imul(Te,Re)|0)+(A>>>13)|0)+(Vt>>>26)|0,Vt&=67108863,j=Math.imul(Me,ct),A=(A=Math.imul(Me,nt))+Math.imul(tt,ct)|0,N=Math.imul(tt,nt),j=j+Math.imul(Bt,Qe)|0,A=(A=A+Math.imul(Bt,gt)|0)+Math.imul(ft,Qe)|0,N=N+Math.imul(ft,gt)|0,j=j+Math.imul(dt,Oe)|0,A=(A=A+Math.imul(dt,Ce)|0)+Math.imul(wt,Oe)|0,N=N+Math.imul(wt,Ce)|0,j=j+Math.imul(He,be)|0,A=(A=A+Math.imul(He,Se)|0)+Math.imul(Xe,be)|0,N=N+Math.imul(Xe,Se)|0;var Ar=(J+(j=j+Math.imul(ye,ze)|0)|0)+((8191&(A=(A=A+Math.imul(ye,Re)|0)+Math.imul(ge,ze)|0))<<13)|0;J=((N=N+Math.imul(ge,Re)|0)+(A>>>13)|0)+(Ar>>>26)|0,Ar&=67108863,j=Math.imul(Me,Qe),A=(A=Math.imul(Me,gt))+Math.imul(tt,Qe)|0,N=Math.imul(tt,gt),j=j+Math.imul(Bt,Oe)|0,A=(A=A+Math.imul(Bt,Ce)|0)+Math.imul(ft,Oe)|0,N=N+Math.imul(ft,Ce)|0,j=j+Math.imul(dt,be)|0,A=(A=A+Math.imul(dt,Se)|0)+Math.imul(wt,be)|0,N=N+Math.imul(wt,Se)|0;var wr=(J+(j=j+Math.imul(He,ze)|0)|0)+((8191&(A=(A=A+Math.imul(He,Re)|0)+Math.imul(Xe,ze)|0))<<13)|0;J=((N=N+Math.imul(Xe,Re)|0)+(A>>>13)|0)+(wr>>>26)|0,wr&=67108863,j=Math.imul(Me,Oe),A=(A=Math.imul(Me,Ce))+Math.imul(tt,Oe)|0,N=Math.imul(tt,Ce),j=j+Math.imul(Bt,be)|0,A=(A=A+Math.imul(Bt,Se)|0)+Math.imul(ft,be)|0,N=N+Math.imul(ft,Se)|0;var Nr=(J+(j=j+Math.imul(dt,ze)|0)|0)+((8191&(A=(A=A+Math.imul(dt,Re)|0)+Math.imul(wt,ze)|0))<<13)|0;J=((N=N+Math.imul(wt,Re)|0)+(A>>>13)|0)+(Nr>>>26)|0,Nr&=67108863,j=Math.imul(Me,be),A=(A=Math.imul(Me,Se))+Math.imul(tt,be)|0,N=Math.imul(tt,Se);var Dr=(J+(j=j+Math.imul(Bt,ze)|0)|0)+((8191&(A=(A=A+Math.imul(Bt,Re)|0)+Math.imul(ft,ze)|0))<<13)|0;J=((N=N+Math.imul(ft,Re)|0)+(A>>>13)|0)+(Dr>>>26)|0,Dr&=67108863;var Yr=(J+(j=Math.imul(Me,ze))|0)+((8191&(A=(A=Math.imul(Me,Re))+Math.imul(tt,ze)|0))<<13)|0;return J=((N=Math.imul(tt,Re))+(A>>>13)|0)+(Yr>>>26)|0,Yr&=67108863,Z[0]=Ie,Z[1]=ae,Z[2]=we,Z[3]=Fe,Z[4]=Ye,Z[5]=me,Z[6]=Be,Z[7]=Ge,Z[8]=mt,Z[9]=_t,Z[10]=ot,Z[11]=xt,Z[12]=zt,Z[13]=Vt,Z[14]=Ar,Z[15]=wr,Z[16]=Nr,Z[17]=Dr,Z[18]=Yr,J!==0&&(Z[19]=J,R.length++),R};function L(k,_,R){R.negative=_.negative^k.negative,R.length=k.length+_.length;for(var j=0,A=0,N=0;N<R.length-1;N++){var V=A;A=0;for(var M=67108863&j,Z=Math.min(N,_.length-1),J=Math.max(0,N-k.length+1);J<=Z;J++){var re=N-J,X=(0|k.words[re])*(0|_.words[J]),ne=67108863&X;M=67108863&(ne=ne+M|0),A+=(V=(V=V+(X/67108864|0)|0)+(ne>>>26)|0)>>>26,V&=67108863}R.words[N]=M,j=V,V=A}return j!==0?R.words[N]=j:R.length--,R._strip()}function O(k,_,R){return L(k,_,R)}Math.imul||(C=S),l.prototype.mulTo=function(k,_){var R=this.length+k.length;return this.length===10&&k.length===10?C(this,k,_):R<63?S(this,k,_):R<1024?L(this,k,_):O(this,k,_)},l.prototype.mul=function(k){var _=new l(null);return _.words=new Array(this.length+k.length),this.mulTo(k,_)},l.prototype.mulf=function(k){var _=new l(null);return _.words=new Array(this.length+k.length),O(this,k,_)},l.prototype.imul=function(k){return this.clone().mulTo(k,this)},l.prototype.imuln=function(k){var _=k<0;_&&(k=-k),c(typeof k=="number"),c(k<67108864);for(var R=0,j=0;j<this.length;j++){var A=(0|this.words[j])*k,N=(67108863&A)+(67108863&R);R>>=26,R+=A/67108864|0,R+=N>>>26,this.words[j]=67108863&N}return R!==0&&(this.words[j]=R,this.length++),_?this.ineg():this},l.prototype.muln=function(k){return this.clone().imuln(k)},l.prototype.sqr=function(){return this.mul(this)},l.prototype.isqr=function(){return this.imul(this.clone())},l.prototype.pow=function(k){var _=function(N){for(var V=new Array(N.bitLength()),M=0;M<V.length;M++){var Z=M/26|0,J=M%26;V[M]=N.words[Z]>>>J&1}return V}(k);if(_.length===0)return new l(1);for(var R=this,j=0;j<_.length&&_[j]===0;j++,R=R.sqr());if(++j<_.length)for(var A=R.sqr();j<_.length;j++,A=A.sqr())_[j]!==0&&(R=R.mul(A));return R},l.prototype.iushln=function(k){c(typeof k=="number"&&k>=0);var _,R=k%26,j=(k-R)/26,A=67108863>>>26-R<<26-R;if(R!==0){var N=0;for(_=0;_<this.length;_++){var V=this.words[_]&A,M=(0|this.words[_])-V<<R;this.words[_]=M|N,N=V>>>26-R}N&&(this.words[_]=N,this.length++)}if(j!==0){for(_=this.length-1;_>=0;_--)this.words[_+j]=this.words[_];for(_=0;_<j;_++)this.words[_]=0;this.length+=j}return this._strip()},l.prototype.ishln=function(k){return c(this.negative===0),this.iushln(k)},l.prototype.iushrn=function(k,_,R){var j;c(typeof k=="number"&&k>=0),j=_?(_-_%26)/26:0;var A=k%26,N=Math.min((k-A)/26,this.length),V=67108863^67108863>>>A<<A,M=R;if(j-=N,j=Math.max(0,j),M){for(var Z=0;Z<N;Z++)M.words[Z]=this.words[Z];M.length=N}if(N!==0)if(this.length>N)for(this.length-=N,Z=0;Z<this.length;Z++)this.words[Z]=this.words[Z+N];else this.words[0]=0,this.length=1;var J=0;for(Z=this.length-1;Z>=0&&(J!==0||Z>=j);Z--){var re=0|this.words[Z];this.words[Z]=J<<26-A|re>>>A,J=re&V}return M&&J!==0&&(M.words[M.length++]=J),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},l.prototype.ishrn=function(k,_,R){return c(this.negative===0),this.iushrn(k,_,R)},l.prototype.shln=function(k){return this.clone().ishln(k)},l.prototype.ushln=function(k){return this.clone().iushln(k)},l.prototype.shrn=function(k){return this.clone().ishrn(k)},l.prototype.ushrn=function(k){return this.clone().iushrn(k)},l.prototype.testn=function(k){c(typeof k=="number"&&k>=0);var _=k%26,R=(k-_)/26,j=1<<_;return!(this.length<=R)&&!!(this.words[R]&j)},l.prototype.imaskn=function(k){c(typeof k=="number"&&k>=0);var _=k%26,R=(k-_)/26;if(c(this.negative===0,"imaskn works only with positive numbers"),this.length<=R)return this;if(_!==0&&R++,this.length=Math.min(R,this.length),_!==0){var j=67108863^67108863>>>_<<_;this.words[this.length-1]&=j}return this._strip()},l.prototype.maskn=function(k){return this.clone().imaskn(k)},l.prototype.iaddn=function(k){return c(typeof k=="number"),c(k<67108864),k<0?this.isubn(-k):this.negative!==0?this.length===1&&(0|this.words[0])<=k?(this.words[0]=k-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(k),this.negative=1,this):this._iaddn(k)},l.prototype._iaddn=function(k){this.words[0]+=k;for(var _=0;_<this.length&&this.words[_]>=67108864;_++)this.words[_]-=67108864,_===this.length-1?this.words[_+1]=1:this.words[_+1]++;return this.length=Math.max(this.length,_+1),this},l.prototype.isubn=function(k){if(c(typeof k=="number"),c(k<67108864),k<0)return this.iaddn(-k);if(this.negative!==0)return this.negative=0,this.iaddn(k),this.negative=1,this;if(this.words[0]-=k,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var _=0;_<this.length&&this.words[_]<0;_++)this.words[_]+=67108864,this.words[_+1]-=1;return this._strip()},l.prototype.addn=function(k){return this.clone().iaddn(k)},l.prototype.subn=function(k){return this.clone().isubn(k)},l.prototype.iabs=function(){return this.negative=0,this},l.prototype.abs=function(){return this.clone().iabs()},l.prototype._ishlnsubmul=function(k,_,R){var j,A,N=k.length+R;this._expand(N);var V=0;for(j=0;j<k.length;j++){A=(0|this.words[j+R])+V;var M=(0|k.words[j])*_;V=((A-=67108863&M)>>26)-(M/67108864|0),this.words[j+R]=67108863&A}for(;j<this.length-R;j++)V=(A=(0|this.words[j+R])+V)>>26,this.words[j+R]=67108863&A;if(V===0)return this._strip();for(c(V===-1),V=0,j=0;j<this.length;j++)V=(A=-(0|this.words[j])+V)>>26,this.words[j]=67108863&A;return this.negative=1,this._strip()},l.prototype._wordDiv=function(k,_){var R=(this.length,k.length),j=this.clone(),A=k,N=0|A.words[A.length-1];(R=26-this._countBits(N))!==0&&(A=A.ushln(R),j.iushln(R),N=0|A.words[A.length-1]);var V,M=j.length-A.length;if(_!=="mod"){(V=new l(null)).length=M+1,V.words=new Array(V.length);for(var Z=0;Z<V.length;Z++)V.words[Z]=0}var J=j.clone()._ishlnsubmul(A,1,M);J.negative===0&&(j=J,V&&(V.words[M]=1));for(var re=M-1;re>=0;re--){var X=67108864*(0|j.words[A.length+re])+(0|j.words[A.length+re-1]);for(X=Math.min(X/N|0,67108863),j._ishlnsubmul(A,X,re);j.negative!==0;)X--,j.negative=0,j._ishlnsubmul(A,1,re),j.isZero()||(j.negative^=1);V&&(V.words[re]=X)}return V&&V._strip(),j._strip(),_!=="div"&&R!==0&&j.iushrn(R),{div:V||null,mod:j}},l.prototype.divmod=function(k,_,R){return c(!k.isZero()),this.isZero()?{div:new l(0),mod:new l(0)}:this.negative!==0&&k.negative===0?(N=this.neg().divmod(k,_),_!=="mod"&&(j=N.div.neg()),_!=="div"&&(A=N.mod.neg(),R&&A.negative!==0&&A.iadd(k)),{div:j,mod:A}):this.negative===0&&k.negative!==0?(N=this.divmod(k.neg(),_),_!=="mod"&&(j=N.div.neg()),{div:j,mod:N.mod}):(this.negative&k.negative)!=0?(N=this.neg().divmod(k.neg(),_),_!=="div"&&(A=N.mod.neg(),R&&A.negative!==0&&A.isub(k)),{div:N.div,mod:A}):k.length>this.length||this.cmp(k)<0?{div:new l(0),mod:this}:k.length===1?_==="div"?{div:this.divn(k.words[0]),mod:null}:_==="mod"?{div:null,mod:new l(this.modrn(k.words[0]))}:{div:this.divn(k.words[0]),mod:new l(this.modrn(k.words[0]))}:this._wordDiv(k,_);var j,A,N},l.prototype.div=function(k){return this.divmod(k,"div",!1).div},l.prototype.mod=function(k){return this.divmod(k,"mod",!1).mod},l.prototype.umod=function(k){return this.divmod(k,"mod",!0).mod},l.prototype.divRound=function(k){var _=this.divmod(k);if(_.mod.isZero())return _.div;var R=_.div.negative!==0?_.mod.isub(k):_.mod,j=k.ushrn(1),A=k.andln(1),N=R.cmp(j);return N<0||A===1&&N===0?_.div:_.div.negative!==0?_.div.isubn(1):_.div.iaddn(1)},l.prototype.modrn=function(k){var _=k<0;_&&(k=-k),c(k<=67108863);for(var R=(1<<26)%k,j=0,A=this.length-1;A>=0;A--)j=(R*j+(0|this.words[A]))%k;return _?-j:j},l.prototype.modn=function(k){return this.modrn(k)},l.prototype.idivn=function(k){var _=k<0;_&&(k=-k),c(k<=67108863);for(var R=0,j=this.length-1;j>=0;j--){var A=(0|this.words[j])+67108864*R;this.words[j]=A/k|0,R=A%k}return this._strip(),_?this.ineg():this},l.prototype.divn=function(k){return this.clone().idivn(k)},l.prototype.egcd=function(k){c(k.negative===0),c(!k.isZero());var _=this,R=k.clone();_=_.negative!==0?_.umod(k):_.clone();for(var j=new l(1),A=new l(0),N=new l(0),V=new l(1),M=0;_.isEven()&&R.isEven();)_.iushrn(1),R.iushrn(1),++M;for(var Z=R.clone(),J=_.clone();!_.isZero();){for(var re=0,X=1;(_.words[0]&X)==0&&re<26;++re,X<<=1);if(re>0)for(_.iushrn(re);re-- >0;)(j.isOdd()||A.isOdd())&&(j.iadd(Z),A.isub(J)),j.iushrn(1),A.iushrn(1);for(var ne=0,Y=1;(R.words[0]&Y)==0&&ne<26;++ne,Y<<=1);if(ne>0)for(R.iushrn(ne);ne-- >0;)(N.isOdd()||V.isOdd())&&(N.iadd(Z),V.isub(J)),N.iushrn(1),V.iushrn(1);_.cmp(R)>=0?(_.isub(R),j.isub(N),A.isub(V)):(R.isub(_),N.isub(j),V.isub(A))}return{a:N,b:V,gcd:R.iushln(M)}},l.prototype._invmp=function(k){c(k.negative===0),c(!k.isZero());var _=this,R=k.clone();_=_.negative!==0?_.umod(k):_.clone();for(var j,A=new l(1),N=new l(0),V=R.clone();_.cmpn(1)>0&&R.cmpn(1)>0;){for(var M=0,Z=1;(_.words[0]&Z)==0&&M<26;++M,Z<<=1);if(M>0)for(_.iushrn(M);M-- >0;)A.isOdd()&&A.iadd(V),A.iushrn(1);for(var J=0,re=1;(R.words[0]&re)==0&&J<26;++J,re<<=1);if(J>0)for(R.iushrn(J);J-- >0;)N.isOdd()&&N.iadd(V),N.iushrn(1);_.cmp(R)>=0?(_.isub(R),A.isub(N)):(R.isub(_),N.isub(A))}return(j=_.cmpn(1)===0?A:N).cmpn(0)<0&&j.iadd(k),j},l.prototype.gcd=function(k){if(this.isZero())return k.abs();if(k.isZero())return this.abs();var _=this.clone(),R=k.clone();_.negative=0,R.negative=0;for(var j=0;_.isEven()&&R.isEven();j++)_.iushrn(1),R.iushrn(1);for(;;){for(;_.isEven();)_.iushrn(1);for(;R.isEven();)R.iushrn(1);var A=_.cmp(R);if(A<0){var N=_;_=R,R=N}else if(A===0||R.cmpn(1)===0)break;_.isub(R)}return R.iushln(j)},l.prototype.invm=function(k){return this.egcd(k).a.umod(k)},l.prototype.isEven=function(){return(1&this.words[0])==0},l.prototype.isOdd=function(){return(1&this.words[0])==1},l.prototype.andln=function(k){return this.words[0]&k},l.prototype.bincn=function(k){c(typeof k=="number");var _=k%26,R=(k-_)/26,j=1<<_;if(this.length<=R)return this._expand(R+1),this.words[R]|=j,this;for(var A=j,N=R;A!==0&&N<this.length;N++){var V=0|this.words[N];A=(V+=A)>>>26,V&=67108863,this.words[N]=V}return A!==0&&(this.words[N]=A,this.length++),this},l.prototype.isZero=function(){return this.length===1&&this.words[0]===0},l.prototype.cmpn=function(k){var _,R=k<0;if(this.negative!==0&&!R)return-1;if(this.negative===0&&R)return 1;if(this._strip(),this.length>1)_=1;else{R&&(k=-k),c(k<=67108863,"Number is too big");var j=0|this.words[0];_=j===k?0:j<k?-1:1}return this.negative!==0?0|-_:_},l.prototype.cmp=function(k){if(this.negative!==0&&k.negative===0)return-1;if(this.negative===0&&k.negative!==0)return 1;var _=this.ucmp(k);return this.negative!==0?0|-_:_},l.prototype.ucmp=function(k){if(this.length>k.length)return 1;if(this.length<k.length)return-1;for(var _=0,R=this.length-1;R>=0;R--){var j=0|this.words[R],A=0|k.words[R];if(j!==A){j<A?_=-1:j>A&&(_=1);break}}return _},l.prototype.gtn=function(k){return this.cmpn(k)===1},l.prototype.gt=function(k){return this.cmp(k)===1},l.prototype.gten=function(k){return this.cmpn(k)>=0},l.prototype.gte=function(k){return this.cmp(k)>=0},l.prototype.ltn=function(k){return this.cmpn(k)===-1},l.prototype.lt=function(k){return this.cmp(k)===-1},l.prototype.lten=function(k){return this.cmpn(k)<=0},l.prototype.lte=function(k){return this.cmp(k)<=0},l.prototype.eqn=function(k){return this.cmpn(k)===0},l.prototype.eq=function(k){return this.cmp(k)===0},l.red=function(k){return new I(k)},l.prototype.toRed=function(k){return c(!this.red,"Already a number in reduction context"),c(this.negative===0,"red works only with positives"),k.convertTo(this)._forceRed(k)},l.prototype.fromRed=function(){return c(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},l.prototype._forceRed=function(k){return this.red=k,this},l.prototype.forceRed=function(k){return c(!this.red,"Already a number in reduction context"),this._forceRed(k)},l.prototype.redAdd=function(k){return c(this.red,"redAdd works only with red numbers"),this.red.add(this,k)},l.prototype.redIAdd=function(k){return c(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,k)},l.prototype.redSub=function(k){return c(this.red,"redSub works only with red numbers"),this.red.sub(this,k)},l.prototype.redISub=function(k){return c(this.red,"redISub works only with red numbers"),this.red.isub(this,k)},l.prototype.redShl=function(k){return c(this.red,"redShl works only with red numbers"),this.red.shl(this,k)},l.prototype.redMul=function(k){return c(this.red,"redMul works only with red numbers"),this.red._verify2(this,k),this.red.mul(this,k)},l.prototype.redIMul=function(k){return c(this.red,"redMul works only with red numbers"),this.red._verify2(this,k),this.red.imul(this,k)},l.prototype.redSqr=function(){return c(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},l.prototype.redISqr=function(){return c(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},l.prototype.redSqrt=function(){return c(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},l.prototype.redInvm=function(){return c(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},l.prototype.redNeg=function(){return c(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},l.prototype.redPow=function(k){return c(this.red&&!k.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,k)};var H={k256:null,p224:null,p192:null,p25519:null};function z(k,_){this.name=k,this.p=new l(_,16),this.n=this.p.bitLength(),this.k=new l(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function q(){z.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function D(){z.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function W(){z.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function P(){z.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function I(k){if(typeof k=="string"){var _=l._prime(k);this.m=_.p,this.prime=_}else c(k.gtn(1),"modulus must be greater than 1"),this.m=k,this.prime=null}function U(k){I.call(this,k),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new l(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}z.prototype._tmp=function(){var k=new l(null);return k.words=new Array(Math.ceil(this.n/13)),k},z.prototype.ireduce=function(k){var _,R=k;do this.split(R,this.tmp),_=(R=(R=this.imulK(R)).iadd(this.tmp)).bitLength();while(_>this.n);var j=_<this.n?-1:R.ucmp(this.p);return j===0?(R.words[0]=0,R.length=1):j>0?R.isub(this.p):R.strip!==void 0?R.strip():R._strip(),R},z.prototype.split=function(k,_){k.iushrn(this.n,0,_)},z.prototype.imulK=function(k){return k.imul(this.k)},u(q,z),q.prototype.split=function(k,_){for(var R=Math.min(k.length,9),j=0;j<R;j++)_.words[j]=k.words[j];if(_.length=R,k.length<=9)return k.words[0]=0,void(k.length=1);var A=k.words[9];for(_.words[_.length++]=4194303&A,j=10;j<k.length;j++){var N=0|k.words[j];k.words[j-10]=(4194303&N)<<4|A>>>22,A=N}A>>>=22,k.words[j-10]=A,A===0&&k.length>10?k.length-=10:k.length-=9},q.prototype.imulK=function(k){k.words[k.length]=0,k.words[k.length+1]=0,k.length+=2;for(var _=0,R=0;R<k.length;R++){var j=0|k.words[R];_+=977*j,k.words[R]=67108863&_,_=64*j+(_/67108864|0)}return k.words[k.length-1]===0&&(k.length--,k.words[k.length-1]===0&&k.length--),k},u(D,z),u(W,z),u(P,z),P.prototype.imulK=function(k){for(var _=0,R=0;R<k.length;R++){var j=19*(0|k.words[R])+_,A=67108863&j;j>>>=26,k.words[R]=A,_=j}return _!==0&&(k.words[k.length++]=_),k},l._prime=function(k){if(H[k])return H[k];var _;if(k==="k256")_=new q;else if(k==="p224")_=new D;else if(k==="p192")_=new W;else{if(k!=="p25519")throw new Error("Unknown prime "+k);_=new P}return H[k]=_,_},I.prototype._verify1=function(k){c(k.negative===0,"red works only with positives"),c(k.red,"red works only with red numbers")},I.prototype._verify2=function(k,_){c((k.negative|_.negative)==0,"red works only with positives"),c(k.red&&k.red===_.red,"red works only with red numbers")},I.prototype.imod=function(k){return this.prime?this.prime.ireduce(k)._forceRed(this):(v(k,k.umod(this.m)._forceRed(this)),k)},I.prototype.neg=function(k){return k.isZero()?k.clone():this.m.sub(k)._forceRed(this)},I.prototype.add=function(k,_){this._verify2(k,_);var R=k.add(_);return R.cmp(this.m)>=0&&R.isub(this.m),R._forceRed(this)},I.prototype.iadd=function(k,_){this._verify2(k,_);var R=k.iadd(_);return R.cmp(this.m)>=0&&R.isub(this.m),R},I.prototype.sub=function(k,_){this._verify2(k,_);var R=k.sub(_);return R.cmpn(0)<0&&R.iadd(this.m),R._forceRed(this)},I.prototype.isub=function(k,_){this._verify2(k,_);var R=k.isub(_);return R.cmpn(0)<0&&R.iadd(this.m),R},I.prototype.shl=function(k,_){return this._verify1(k),this.imod(k.ushln(_))},I.prototype.imul=function(k,_){return this._verify2(k,_),this.imod(k.imul(_))},I.prototype.mul=function(k,_){return this._verify2(k,_),this.imod(k.mul(_))},I.prototype.isqr=function(k){return this.imul(k,k.clone())},I.prototype.sqr=function(k){return this.mul(k,k)},I.prototype.sqrt=function(k){if(k.isZero())return k.clone();var _=this.m.andln(3);if(c(_%2==1),_===3){var R=this.m.add(new l(1)).iushrn(2);return this.pow(k,R)}for(var j=this.m.subn(1),A=0;!j.isZero()&&j.andln(1)===0;)A++,j.iushrn(1);c(!j.isZero());var N=new l(1).toRed(this),V=N.redNeg(),M=this.m.subn(1).iushrn(1),Z=this.m.bitLength();for(Z=new l(2*Z*Z).toRed(this);this.pow(Z,M).cmp(V)!==0;)Z.redIAdd(V);for(var J=this.pow(Z,j),re=this.pow(k,j.addn(1).iushrn(1)),X=this.pow(k,j),ne=A;X.cmp(N)!==0;){for(var Y=X,K=0;Y.cmp(N)!==0;K++)Y=Y.redSqr();c(K<ne);var ee=this.pow(J,new l(1).iushln(ne-K-1));re=re.redMul(ee),J=ee.redSqr(),X=X.redMul(J),ne=K}return re},I.prototype.invm=function(k){var _=k._invmp(this.m);return _.negative!==0?(_.negative=0,this.imod(_).redNeg()):this.imod(_)},I.prototype.pow=function(k,_){if(_.isZero())return new l(1).toRed(this);if(_.cmpn(1)===0)return k.clone();var R=new Array(16);R[0]=new l(1).toRed(this),R[1]=k;for(var j=2;j<R.length;j++)R[j]=this.mul(R[j-1],k);var A=R[0],N=0,V=0,M=_.bitLength()%26;for(M===0&&(M=26),j=_.length-1;j>=0;j--){for(var Z=_.words[j],J=M-1;J>=0;J--){var re=Z>>J&1;A!==R[0]&&(A=this.sqr(A)),re!==0||N!==0?(N<<=1,N|=re,(++V===4||j===0&&J===0)&&(A=this.mul(A,R[N]),V=0,N=0)):V=0}M=26}return A},I.prototype.convertTo=function(k){var _=k.umod(this.m);return _===k?_.clone():_},I.prototype.convertFrom=function(k){var _=k.clone();return _.red=null,_},l.mont=function(k){return new U(k)},u(U,I),U.prototype.convertTo=function(k){return this.imod(k.ushln(this.shift))},U.prototype.convertFrom=function(k){var _=this.imod(k.mul(this.rinv));return _.red=null,_},U.prototype.imul=function(k,_){if(k.isZero()||_.isZero())return k.words[0]=0,k.length=1,k;var R=k.imul(_),j=R.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),A=R.isub(j).iushrn(this.shift),N=A;return A.cmp(this.m)>=0?N=A.isub(this.m):A.cmpn(0)<0&&(N=A.iadd(this.m)),N._forceRed(this)},U.prototype.mul=function(k,_){if(k.isZero()||_.isZero())return new l(0)._forceRed(this);var R=k.mul(_),j=R.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),A=R.isub(j).iushrn(this.shift),N=A;return A.cmp(this.m)>=0?N=A.isub(this.m):A.cmpn(0)<0&&(N=A.iadd(this.m)),N._forceRed(this)},U.prototype.invm=function(k){return this.imod(k._invmp(this.m).mul(this.r2))._forceRed(this)}})(n===void 0||n)},{buffer:188}],187:[function(t,n,s){var o;function i(u){this.rand=u}if(n.exports=function(u){return o||(o=new i(null)),o.generate(u)},n.exports.Rand=i,i.prototype.generate=function(u){return this._rand(u)},i.prototype._rand=function(u){if(this.rand.getBytes)return this.rand.getBytes(u);for(var l=new Uint8Array(u),d=0;d<l.length;d++)l[d]=this.rand.getByte();return l},typeof self=="object")self.crypto&&self.crypto.getRandomValues?i.prototype._rand=function(u){var l=new Uint8Array(u);return self.crypto.getRandomValues(l),l}:self.msCrypto&&self.msCrypto.getRandomValues?i.prototype._rand=function(u){var l=new Uint8Array(u);return self.msCrypto.getRandomValues(l),l}:typeof window=="object"&&(i.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var c=t("crypto");if(typeof c.randomBytes!="function")throw new Error("Not supported");i.prototype._rand=function(u){return c.randomBytes(u)}}catch{}},{crypto:188}],188:[function(t,n,s){},{}],189:[function(t,n,s){var o=t("safe-buffer").Buffer;function i(f){o.isBuffer(f)||(f=o.from(f));for(var p=f.length/4|0,v=new Array(p),g=0;g<p;g++)v[g]=f.readUInt32BE(4*g);return v}function c(f){for(;0<f.length;f++)f[0]=0}function u(f,p,v,g,m){for(var b,y,S,C,L=v[0],O=v[1],H=v[2],z=v[3],q=f[0]^p[0],D=f[1]^p[1],W=f[2]^p[2],P=f[3]^p[3],I=4,U=1;U<m;U++)b=L[q>>>24]^O[D>>>16&255]^H[W>>>8&255]^z[255&P]^p[I++],y=L[D>>>24]^O[W>>>16&255]^H[P>>>8&255]^z[255&q]^p[I++],S=L[W>>>24]^O[P>>>16&255]^H[q>>>8&255]^z[255&D]^p[I++],C=L[P>>>24]^O[q>>>16&255]^H[D>>>8&255]^z[255&W]^p[I++],q=b,D=y,W=S,P=C;return b=(g[q>>>24]<<24|g[D>>>16&255]<<16|g[W>>>8&255]<<8|g[255&P])^p[I++],y=(g[D>>>24]<<24|g[W>>>16&255]<<16|g[P>>>8&255]<<8|g[255&q])^p[I++],S=(g[W>>>24]<<24|g[P>>>16&255]<<16|g[q>>>8&255]<<8|g[255&D])^p[I++],C=(g[P>>>24]<<24|g[q>>>16&255]<<16|g[D>>>8&255]<<8|g[255&W])^p[I++],[b>>>=0,y>>>=0,S>>>=0,C>>>=0]}var l=[0,1,2,4,8,16,32,64,128,27,54],d=function(){for(var f=new Array(256),p=0;p<256;p++)f[p]=p<128?p<<1:p<<1^283;for(var v=[],g=[],m=[[],[],[],[]],b=[[],[],[],[]],y=0,S=0,C=0;C<256;++C){var L=S^S<<1^S<<2^S<<3^S<<4;L=L>>>8^255&L^99,v[y]=L,g[L]=y;var O=f[y],H=f[O],z=f[H],q=257*f[L]^16843008*L;m[0][y]=q<<24|q>>>8,m[1][y]=q<<16|q>>>16,m[2][y]=q<<8|q>>>24,m[3][y]=q,q=16843009*z^65537*H^257*O^16843008*y,b[0][L]=q<<24|q>>>8,b[1][L]=q<<16|q>>>16,b[2][L]=q<<8|q>>>24,b[3][L]=q,y===0?y=S=1:(y=O^f[f[f[z^O]]],S^=f[f[S]])}return{SBOX:v,INV_SBOX:g,SUB_MIX:m,INV_SUB_MIX:b}}();function h(f){this._key=i(f),this._reset()}h.blockSize=16,h.keySize=32,h.prototype.blockSize=h.blockSize,h.prototype.keySize=h.keySize,h.prototype._reset=function(){for(var f=this._key,p=f.length,v=p+6,g=4*(v+1),m=[],b=0;b<p;b++)m[b]=f[b];for(b=p;b<g;b++){var y=m[b-1];b%p==0?(y=y<<8|y>>>24,y=d.SBOX[y>>>24]<<24|d.SBOX[y>>>16&255]<<16|d.SBOX[y>>>8&255]<<8|d.SBOX[255&y],y^=l[b/p|0]<<24):p>6&&b%p==4&&(y=d.SBOX[y>>>24]<<24|d.SBOX[y>>>16&255]<<16|d.SBOX[y>>>8&255]<<8|d.SBOX[255&y]),m[b]=m[b-p]^y}for(var S=[],C=0;C<g;C++){var L=g-C,O=m[L-(C%4?0:4)];S[C]=C<4||L<=4?O:d.INV_SUB_MIX[0][d.SBOX[O>>>24]]^d.INV_SUB_MIX[1][d.SBOX[O>>>16&255]]^d.INV_SUB_MIX[2][d.SBOX[O>>>8&255]]^d.INV_SUB_MIX[3][d.SBOX[255&O]]}this._nRounds=v,this._keySchedule=m,this._invKeySchedule=S},h.prototype.encryptBlockRaw=function(f){return u(f=i(f),this._keySchedule,d.SUB_MIX,d.SBOX,this._nRounds)},h.prototype.encryptBlock=function(f){var p=this.encryptBlockRaw(f),v=o.allocUnsafe(16);return v.writeUInt32BE(p[0],0),v.writeUInt32BE(p[1],4),v.writeUInt32BE(p[2],8),v.writeUInt32BE(p[3],12),v},h.prototype.decryptBlock=function(f){var p=(f=i(f))[1];f[1]=f[3],f[3]=p;var v=u(f,this._invKeySchedule,d.INV_SUB_MIX,d.INV_SBOX,this._nRounds),g=o.allocUnsafe(16);return g.writeUInt32BE(v[0],0),g.writeUInt32BE(v[3],4),g.writeUInt32BE(v[2],8),g.writeUInt32BE(v[1],12),g},h.prototype.scrub=function(){c(this._keySchedule),c(this._invKeySchedule),c(this._key)},n.exports.AES=h},{"safe-buffer":494}],190:[function(t,n,s){var o=t("./aes"),i=t("safe-buffer").Buffer,c=t("cipher-base"),u=t("inherits"),l=t("./ghash"),d=t("buffer-xor"),h=t("./incr32");function f(p,v,g,m){c.call(this);var b=i.alloc(4,0);this._cipher=new o.AES(v);var y=this._cipher.encryptBlock(b);this._ghash=new l(y),g=function(S,C,L){if(C.length===12)return S._finID=i.concat([C,i.from([0,0,0,1])]),i.concat([C,i.from([0,0,0,2])]);var O=new l(L),H=C.length,z=H%16;O.update(C),z&&(z=16-z,O.update(i.alloc(z,0))),O.update(i.alloc(8,0));var q=8*H,D=i.alloc(8);D.writeUIntBE(q,0,8),O.update(D),S._finID=O.state;var W=i.from(S._finID);return h(W),W}(this,g,y),this._prev=i.from(g),this._cache=i.allocUnsafe(0),this._secCache=i.allocUnsafe(0),this._decrypt=m,this._alen=0,this._len=0,this._mode=p,this._authTag=null,this._called=!1}u(f,c),f.prototype._update=function(p){if(!this._called&&this._alen){var v=16-this._alen%16;v<16&&(v=i.alloc(v,0),this._ghash.update(v))}this._called=!0;var g=this._mode.encrypt(this,p);return this._decrypt?this._ghash.update(p):this._ghash.update(g),this._len+=p.length,g},f.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var p=d(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&function(v,g){var m=0;v.length!==g.length&&m++;for(var b=Math.min(v.length,g.length),y=0;y<b;++y)m+=v[y]^g[y];return m}(p,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=p,this._cipher.scrub()},f.prototype.getAuthTag=function(){if(this._decrypt||!i.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},f.prototype.setAuthTag=function(p){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=p},f.prototype.setAAD=function(p){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(p),this._alen+=p.length},n.exports=f},{"./aes":189,"./ghash":194,"./incr32":195,"buffer-xor":219,"cipher-base":221,inherits:440,"safe-buffer":494}],191:[function(t,n,s){var o=t("./encrypter"),i=t("./decrypter"),c=t("./modes/list.json");s.createCipher=s.Cipher=o.createCipher,s.createCipheriv=s.Cipheriv=o.createCipheriv,s.createDecipher=s.Decipher=i.createDecipher,s.createDecipheriv=s.Decipheriv=i.createDecipheriv,s.listCiphers=s.getCiphers=function(){return Object.keys(c)}},{"./decrypter":192,"./encrypter":193,"./modes/list.json":203}],192:[function(t,n,s){var o=t("./authCipher"),i=t("safe-buffer").Buffer,c=t("./modes"),u=t("./streamCipher"),l=t("cipher-base"),d=t("./aes"),h=t("evp_bytestokey");function f(g,m,b){l.call(this),this._cache=new p,this._last=void 0,this._cipher=new d.AES(m),this._prev=i.from(b),this._mode=g,this._autopadding=!0}function p(){this.cache=i.allocUnsafe(0)}function v(g,m,b){var y=c[g.toLowerCase()];if(!y)throw new TypeError("invalid suite type");if(typeof b=="string"&&(b=i.from(b)),y.mode!=="GCM"&&b.length!==y.iv)throw new TypeError("invalid iv length "+b.length);if(typeof m=="string"&&(m=i.from(m)),m.length!==y.key/8)throw new TypeError("invalid key length "+m.length);return y.type==="stream"?new u(y.module,m,b,!0):y.type==="auth"?new o(y.module,m,b,!0):new f(y.module,m,b)}t("inherits")(f,l),f.prototype._update=function(g){var m,b;this._cache.add(g);for(var y=[];m=this._cache.get(this._autopadding);)b=this._mode.decrypt(this,m),y.push(b);return i.concat(y)},f.prototype._final=function(){var g=this._cache.flush();if(this._autopadding)return function(m){var b=m[15];if(b<1||b>16)throw new Error("unable to decrypt data");for(var y=-1;++y<b;)if(m[y+(16-b)]!==b)throw new Error("unable to decrypt data");if(b!==16)return m.slice(0,16-b)}(this._mode.decrypt(this,g));if(g)throw new Error("data not multiple of block length")},f.prototype.setAutoPadding=function(g){return this._autopadding=!!g,this},p.prototype.add=function(g){this.cache=i.concat([this.cache,g])},p.prototype.get=function(g){var m;if(g){if(this.cache.length>16)return m=this.cache.slice(0,16),this.cache=this.cache.slice(16),m}else if(this.cache.length>=16)return m=this.cache.slice(0,16),this.cache=this.cache.slice(16),m;return null},p.prototype.flush=function(){if(this.cache.length)return this.cache},s.createDecipher=function(g,m){var b=c[g.toLowerCase()];if(!b)throw new TypeError("invalid suite type");var y=h(m,!1,b.key,b.iv);return v(g,y.key,y.iv)},s.createDecipheriv=v},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],193:[function(t,n,s){var o=t("./modes"),i=t("./authCipher"),c=t("safe-buffer").Buffer,u=t("./streamCipher"),l=t("cipher-base"),d=t("./aes"),h=t("evp_bytestokey");function f(m,b,y){l.call(this),this._cache=new v,this._cipher=new d.AES(b),this._prev=c.from(y),this._mode=m,this._autopadding=!0}t("inherits")(f,l),f.prototype._update=function(m){var b,y;this._cache.add(m);for(var S=[];b=this._cache.get();)y=this._mode.encrypt(this,b),S.push(y);return c.concat(S)};var p=c.alloc(16,16);function v(){this.cache=c.allocUnsafe(0)}function g(m,b,y){var S=o[m.toLowerCase()];if(!S)throw new TypeError("invalid suite type");if(typeof b=="string"&&(b=c.from(b)),b.length!==S.key/8)throw new TypeError("invalid key length "+b.length);if(typeof y=="string"&&(y=c.from(y)),S.mode!=="GCM"&&y.length!==S.iv)throw new TypeError("invalid iv length "+y.length);return S.type==="stream"?new u(S.module,b,y):S.type==="auth"?new i(S.module,b,y):new f(S.module,b,y)}f.prototype._final=function(){var m=this._cache.flush();if(this._autopadding)return m=this._mode.encrypt(this,m),this._cipher.scrub(),m;if(!m.equals(p))throw this._cipher.scrub(),new Error("data not multiple of block length")},f.prototype.setAutoPadding=function(m){return this._autopadding=!!m,this},v.prototype.add=function(m){this.cache=c.concat([this.cache,m])},v.prototype.get=function(){if(this.cache.length>15){var m=this.cache.slice(0,16);return this.cache=this.cache.slice(16),m}return null},v.prototype.flush=function(){for(var m=16-this.cache.length,b=c.allocUnsafe(m),y=-1;++y<m;)b.writeUInt8(m,y);return c.concat([this.cache,b])},s.createCipheriv=g,s.createCipher=function(m,b){var y=o[m.toLowerCase()];if(!y)throw new TypeError("invalid suite type");var S=h(b,!1,y.key,y.iv);return g(m,S.key,S.iv)}},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],194:[function(t,n,s){var o=t("safe-buffer").Buffer,i=o.alloc(16,0);function c(l){var d=o.allocUnsafe(16);return d.writeUInt32BE(l[0]>>>0,0),d.writeUInt32BE(l[1]>>>0,4),d.writeUInt32BE(l[2]>>>0,8),d.writeUInt32BE(l[3]>>>0,12),d}function u(l){this.h=l,this.state=o.alloc(16,0),this.cache=o.allocUnsafe(0)}u.prototype.ghash=function(l){for(var d=-1;++d<l.length;)this.state[d]^=l[d];this._multiply()},u.prototype._multiply=function(){for(var l,d,h,f=[(l=this.h).readUInt32BE(0),l.readUInt32BE(4),l.readUInt32BE(8),l.readUInt32BE(12)],p=[0,0,0,0],v=-1;++v<128;){for((this.state[~~(v/8)]&1<<7-v%8)!=0&&(p[0]^=f[0],p[1]^=f[1],p[2]^=f[2],p[3]^=f[3]),h=(1&f[3])!=0,d=3;d>0;d--)f[d]=f[d]>>>1|(1&f[d-1])<<31;f[0]=f[0]>>>1,h&&(f[0]=f[0]^225<<24)}this.state=c(p)},u.prototype.update=function(l){var d;for(this.cache=o.concat([this.cache,l]);this.cache.length>=16;)d=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(d)},u.prototype.final=function(l,d){return this.cache.length&&this.ghash(o.concat([this.cache,i],16)),this.ghash(c([0,l,0,d])),this.state},n.exports=u},{"safe-buffer":494}],195:[function(t,n,s){n.exports=function(o){for(var i,c=o.length;c--;){if((i=o.readUInt8(c))!==255){i++,o.writeUInt8(i,c);break}o.writeUInt8(0,c)}}},{}],196:[function(t,n,s){var o=t("buffer-xor");s.encrypt=function(i,c){var u=o(c,i._prev);return i._prev=i._cipher.encryptBlock(u),i._prev},s.decrypt=function(i,c){var u=i._prev;i._prev=c;var l=i._cipher.decryptBlock(c);return o(l,u)}},{"buffer-xor":219}],197:[function(t,n,s){var o=t("safe-buffer").Buffer,i=t("buffer-xor");function c(u,l,d){var h=l.length,f=i(l,u._cache);return u._cache=u._cache.slice(h),u._prev=o.concat([u._prev,d?l:f]),f}s.encrypt=function(u,l,d){for(var h,f=o.allocUnsafe(0);l.length;){if(u._cache.length===0&&(u._cache=u._cipher.encryptBlock(u._prev),u._prev=o.allocUnsafe(0)),!(u._cache.length<=l.length)){f=o.concat([f,c(u,l,d)]);break}h=u._cache.length,f=o.concat([f,c(u,l.slice(0,h),d)]),l=l.slice(h)}return f}},{"buffer-xor":219,"safe-buffer":494}],198:[function(t,n,s){var o=t("safe-buffer").Buffer;function i(u,l,d){for(var h,f,p=-1,v=0;++p<8;)h=l&1<<7-p?128:0,v+=(128&(f=u._cipher.encryptBlock(u._prev)[0]^h))>>p%8,u._prev=c(u._prev,d?h:f);return v}function c(u,l){var d=u.length,h=-1,f=o.allocUnsafe(u.length);for(u=o.concat([u,o.from([l])]);++h<d;)f[h]=u[h]<<1|u[h+1]>>7;return f}s.encrypt=function(u,l,d){for(var h=l.length,f=o.allocUnsafe(h),p=-1;++p<h;)f[p]=i(u,l[p],d);return f}},{"safe-buffer":494}],199:[function(t,n,s){var o=t("safe-buffer").Buffer;function i(c,u,l){var d=c._cipher.encryptBlock(c._prev)[0]^u;return c._prev=o.concat([c._prev.slice(1),o.from([l?u:d])]),d}s.encrypt=function(c,u,l){for(var d=u.length,h=o.allocUnsafe(d),f=-1;++f<d;)h[f]=i(c,u[f],l);return h}},{"safe-buffer":494}],200:[function(t,n,s){var o=t("buffer-xor"),i=t("safe-buffer").Buffer,c=t("../incr32");function u(l){var d=l._cipher.encryptBlockRaw(l._prev);return c(l._prev),d}s.encrypt=function(l,d){var h=Math.ceil(d.length/16),f=l._cache.length;l._cache=i.concat([l._cache,i.allocUnsafe(16*h)]);for(var p=0;p<h;p++){var v=u(l),g=f+16*p;l._cache.writeUInt32BE(v[0],g+0),l._cache.writeUInt32BE(v[1],g+4),l._cache.writeUInt32BE(v[2],g+8),l._cache.writeUInt32BE(v[3],g+12)}var m=l._cache.slice(0,d.length);return l._cache=l._cache.slice(d.length),o(d,m)}},{"../incr32":195,"buffer-xor":219,"safe-buffer":494}],201:[function(t,n,s){s.encrypt=function(o,i){return o._cipher.encryptBlock(i)},s.decrypt=function(o,i){return o._cipher.decryptBlock(i)}},{}],202:[function(t,n,s){var o={ECB:t("./ecb"),CBC:t("./cbc"),CFB:t("./cfb"),CFB8:t("./cfb8"),CFB1:t("./cfb1"),OFB:t("./ofb"),CTR:t("./ctr"),GCM:t("./ctr")},i=t("./list.json");for(var c in i)i[c].module=o[i[c].mode];n.exports=i},{"./cbc":196,"./cfb":197,"./cfb1":198,"./cfb8":199,"./ctr":200,"./ecb":201,"./list.json":203,"./ofb":204}],203:[function(t,n,s){n.exports={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128:{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192:{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256:{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}}},{}],204:[function(t,n,s){(function(o){(function(){var i=t("buffer-xor");function c(u){return u._prev=u._cipher.encryptBlock(u._prev),u._prev}s.encrypt=function(u,l){for(;u._cache.length<l.length;)u._cache=o.concat([u._cache,c(u)]);var d=u._cache.slice(0,l.length);return u._cache=u._cache.slice(l.length),i(l,d)}}).call(this)}).call(this,t("buffer").Buffer)},{buffer:220,"buffer-xor":219}],205:[function(t,n,s){var o=t("./aes"),i=t("safe-buffer").Buffer,c=t("cipher-base");function u(l,d,h,f){c.call(this),this._cipher=new o.AES(d),this._prev=i.from(h),this._cache=i.allocUnsafe(0),this._secCache=i.allocUnsafe(0),this._decrypt=f,this._mode=l}t("inherits")(u,c),u.prototype._update=function(l){return this._mode.encrypt(this,l,this._decrypt)},u.prototype._final=function(){this._cipher.scrub()},n.exports=u},{"./aes":189,"cipher-base":221,inherits:440,"safe-buffer":494}],206:[function(t,n,s){var o=t("browserify-des"),i=t("browserify-aes/browser"),c=t("browserify-aes/modes"),u=t("browserify-des/modes"),l=t("evp_bytestokey");function d(f,p,v){if(f=f.toLowerCase(),c[f])return i.createCipheriv(f,p,v);if(u[f])return new o({key:p,iv:v,mode:f});throw new TypeError("invalid suite type")}function h(f,p,v){if(f=f.toLowerCase(),c[f])return i.createDecipheriv(f,p,v);if(u[f])return new o({key:p,iv:v,mode:f,decrypt:!0});throw new TypeError("invalid suite type")}s.createCipher=s.Cipher=function(f,p){var v,g;if(f=f.toLowerCase(),c[f])v=c[f].key,g=c[f].iv;else{if(!u[f])throw new TypeError("invalid suite type");v=8*u[f].key,g=u[f].iv}var m=l(p,!1,v,g);return d(f,m.key,m.iv)},s.createCipheriv=s.Cipheriv=d,s.createDecipher=s.Decipher=function(f,p){var v,g;if(f=f.toLowerCase(),c[f])v=c[f].key,g=c[f].iv;else{if(!u[f])throw new TypeError("invalid suite type");v=8*u[f].key,g=u[f].iv}var m=l(p,!1,v,g);return h(f,m.key,m.iv)},s.createDecipheriv=s.Decipheriv=h,s.listCiphers=s.getCiphers=function(){return Object.keys(u).concat(i.getCiphers())}},{"browserify-aes/browser":191,"browserify-aes/modes":202,"browserify-des":207,"browserify-des/modes":208,evp_bytestokey:423}],207:[function(t,n,s){var o=t("cipher-base"),i=t("des.js"),c=t("inherits"),u=t("safe-buffer").Buffer,l={"des-ede3-cbc":i.CBC.instantiate(i.EDE),"des-ede3":i.EDE,"des-ede-cbc":i.CBC.instantiate(i.EDE),"des-ede":i.EDE,"des-cbc":i.CBC.instantiate(i.DES),"des-ecb":i.DES};function d(h){o.call(this);var f,p=h.mode.toLowerCase(),v=l[p];f=h.decrypt?"decrypt":"encrypt";var g=h.key;u.isBuffer(g)||(g=u.from(g)),p!=="des-ede"&&p!=="des-ede-cbc"||(g=u.concat([g,g.slice(0,8)]));var m=h.iv;u.isBuffer(m)||(m=u.from(m)),this._des=v.create({key:g,iv:m,type:f})}l.des=l["des-cbc"],l.des3=l["des-ede3-cbc"],n.exports=d,c(d,o),d.prototype._update=function(h){return u.from(this._des.update(h))},d.prototype._final=function(){return u.from(this._des.final())}},{"cipher-base":221,"des.js":394,inherits:440,"safe-buffer":494}],208:[function(t,n,s){s["des-ecb"]={key:8,iv:0},s["des-cbc"]=s.des={key:8,iv:8},s["des-ede3-cbc"]=s.des3={key:24,iv:8},s["des-ede3"]={key:24,iv:0},s["des-ede-cbc"]={key:16,iv:8},s["des-ede"]={key:16,iv:0}},{}],209:[function(t,n,s){(function(o){(function(){var i=t("bn.js"),c=t("randombytes");function u(d){var h,f=d.modulus.byteLength();do h=new i(c(f));while(h.cmp(d.modulus)>=0||!h.umod(d.prime1)||!h.umod(d.prime2));return h}function l(d,h){var f=function(H){var z=u(H);return{blinder:z.toRed(i.mont(H.modulus)).redPow(new i(H.publicExponent)).fromRed(),unblinder:z.invm(H.modulus)}}(h),p=h.modulus.byteLength(),v=new i(d).mul(f.blinder).umod(h.modulus),g=v.toRed(i.mont(h.prime1)),m=v.toRed(i.mont(h.prime2)),b=h.coefficient,y=h.prime1,S=h.prime2,C=g.redPow(h.exponent1).fromRed(),L=m.redPow(h.exponent2).fromRed(),O=C.isub(L).imul(b).umod(y).imul(S);return L.iadd(O).imul(f.unblinder).umod(h.modulus).toArrayLike(o,"be",p)}l.getr=u,n.exports=l}).call(this)}).call(this,t("buffer").Buffer)},{"bn.js":186,buffer:220,randombytes:475}],210:[function(t,n,s){n.exports=t("./browser/algorithms.json")},{"./browser/algorithms.json":211}],211:[function(t,n,s){n.exports={sha224WithRSAEncryption:{sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:{sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:{sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:{sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:{sign:"ecdsa",hash:"sha256",id:""},sha224:{sign:"ecdsa",hash:"sha224",id:""},sha384:{sign:"ecdsa",hash:"sha384",id:""},sha512:{sign:"ecdsa",hash:"sha512",id:""},"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:{sign:"dsa",hash:"sha1",id:""},"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}}},{}],212:[function(t,n,s){n.exports={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}},{}],213:[function(t,n,s){var o=t("safe-buffer").Buffer,i=t("create-hash"),c=t("readable-stream"),u=t("inherits"),l=t("./sign"),d=t("./verify"),h=t("./algorithms.json");function f(m){c.Writable.call(this);var b=h[m];if(!b)throw new Error("Unknown message digest");this._hashType=b.hash,this._hash=i(b.hash),this._tag=b.id,this._signType=b.sign}function p(m){c.Writable.call(this);var b=h[m];if(!b)throw new Error("Unknown message digest");this._hash=i(b.hash),this._tag=b.id,this._signType=b.sign}function v(m){return new f(m)}function g(m){return new p(m)}Object.keys(h).forEach(function(m){h[m].id=o.from(h[m].id,"hex"),h[m.toLowerCase()]=h[m]}),u(f,c.Writable),f.prototype._write=function(m,b,y){this._hash.update(m),y()},f.prototype.update=function(m,b){return typeof m=="string"&&(m=o.from(m,b)),this._hash.update(m),this},f.prototype.sign=function(m,b){this.end();var y=this._hash.digest(),S=l(y,m,this._hashType,this._signType,this._tag);return b?S.toString(b):S},u(p,c.Writable),p.prototype._write=function(m,b,y){this._hash.update(m),y()},p.prototype.update=function(m,b){return typeof m=="string"&&(m=o.from(m,b)),this._hash.update(m),this},p.prototype.verify=function(m,b,y){typeof b=="string"&&(b=o.from(b,y)),this.end();var S=this._hash.digest();return d(b,S,m,this._signType,this._tag)},n.exports={Sign:v,Verify:g,createSign:v,createVerify:g}},{"./algorithms.json":211,"./sign":214,"./verify":215,"create-hash":386,inherits:440,"readable-stream":491,"safe-buffer":494}],214:[function(t,n,s){var o=t("safe-buffer").Buffer,i=t("create-hmac"),c=t("browserify-rsa"),u=t("elliptic").ec,l=t("bn.js"),d=t("parse-asn1"),h=t("./curves.json");function f(m,b,y,S){if((m=o.from(m.toArray())).length<b.byteLength()){var C=o.alloc(b.byteLength()-m.length);m=o.concat([C,m])}var L=y.length,O=function(q,D){q=(q=p(q,D)).mod(D);var W=o.from(q.toArray());if(W.length<D.byteLength()){var P=o.alloc(D.byteLength()-W.length);W=o.concat([P,W])}return W}(y,b),H=o.alloc(L);H.fill(1);var z=o.alloc(L);return z=i(S,z).update(H).update(o.from([0])).update(m).update(O).digest(),H=i(S,z).update(H).digest(),{k:z=i(S,z).update(H).update(o.from([1])).update(m).update(O).digest(),v:H=i(S,z).update(H).digest()}}function p(m,b){var y=new l(m),S=(m.length<<3)-b.bitLength();return S>0&&y.ishrn(S),y}function v(m,b,y){var S,C;do{for(S=o.alloc(0);8*S.length<m.bitLength();)b.v=i(y,b.k).update(b.v).digest(),S=o.concat([S,b.v]);C=p(S,m),b.k=i(y,b.k).update(b.v).update(o.from([0])).digest(),b.v=i(y,b.k).update(b.v).digest()}while(C.cmp(m)!==-1);return C}function g(m,b,y,S){return m.toRed(l.mont(y)).redPow(b).fromRed().mod(S)}n.exports=function(m,b,y,S,C){var L=d(b);if(L.curve){if(S!=="ecdsa"&&S!=="ecdsa/rsa")throw new Error("wrong private key type");return function(q,D){var W=h[D.curve.join(".")];if(!W)throw new Error("unknown curve "+D.curve.join("."));var P=new u(W).keyFromPrivate(D.privateKey).sign(q);return o.from(P.toDER())}(m,L)}if(L.type==="dsa"){if(S!=="dsa")throw new Error("wrong private key type");return function(q,D,W){for(var P,I=D.params.priv_key,U=D.params.p,k=D.params.q,_=D.params.g,R=new l(0),j=p(q,k).mod(k),A=!1,N=f(I,k,q,W);A===!1;)P=v(k,N,W),R=g(_,P,U,k),(A=P.invm(k).imul(j.add(I.mul(R))).mod(k)).cmpn(0)===0&&(A=!1,R=new l(0));return function(V,M){V=V.toArray(),M=M.toArray(),128&V[0]&&(V=[0].concat(V)),128&M[0]&&(M=[0].concat(M));var Z=[48,V.length+M.length+4,2,V.length];return Z=Z.concat(V,[2,M.length],M),o.from(Z)}(R,A)}(m,L,y)}if(S!=="rsa"&&S!=="ecdsa/rsa")throw new Error("wrong private key type");m=o.concat([C,m]);for(var O=L.modulus.byteLength(),H=[0,1];m.length+H.length+1<O;)H.push(255);H.push(0);for(var z=-1;++z<m.length;)H.push(m[z]);return c(H,L)},n.exports.getKey=f,n.exports.makeKey=v},{"./curves.json":212,"bn.js":186,"browserify-rsa":209,"create-hmac":388,elliptic:405,"parse-asn1":459,"safe-buffer":494}],215:[function(t,n,s){var o=t("safe-buffer").Buffer,i=t("bn.js"),c=t("elliptic").ec,u=t("parse-asn1"),l=t("./curves.json");function d(h,f){if(h.cmpn(0)<=0)throw new Error("invalid sig");if(h.cmp(f)>=f)throw new Error("invalid sig")}n.exports=function(h,f,p,v,g){var m=u(p);if(m.type==="ec"){if(v!=="ecdsa"&&v!=="ecdsa/rsa")throw new Error("wrong public key type");return function(H,z,q){var D=l[q.data.algorithm.curve.join(".")];if(!D)throw new Error("unknown curve "+q.data.algorithm.curve.join("."));var W=new c(D),P=q.data.subjectPrivateKey.data;return W.verify(z,H,P)}(h,f,m)}if(m.type==="dsa"){if(v!=="dsa")throw new Error("wrong public key type");return function(H,z,q){var D=q.data.p,W=q.data.q,P=q.data.g,I=q.data.pub_key,U=u.signature.decode(H,"der"),k=U.s,_=U.r;d(k,W),d(_,W);var R=i.mont(D),j=k.invm(W);return P.toRed(R).redPow(new i(z).mul(j).mod(W)).fromRed().mul(I.toRed(R).redPow(_.mul(j).mod(W)).fromRed()).mod(D).mod(W).cmp(_)===0}(h,f,m)}if(v!=="rsa"&&v!=="ecdsa/rsa")throw new Error("wrong public key type");f=o.concat([g,f]);for(var b=m.modulus.byteLength(),y=[1],S=0;f.length+y.length+2<b;)y.push(255),S++;y.push(0);for(var C=-1;++C<f.length;)y.push(f[C]);y=o.from(y);var L=i.mont(m.modulus);h=(h=new i(h).toRed(L)).redPow(new i(m.publicExponent)),h=o.from(h.fromRed().toArray());var O=S<8?1:0;for(b=Math.min(h.length,y.length),h.length!==y.length&&(O=1),C=-1;++C<b;)O|=h[C]^y[C];return O===0}},{"./curves.json":212,"bn.js":186,elliptic:405,"parse-asn1":459,"safe-buffer":494}],216:[function(t,n,s){},{}],217:[function(t,n,s){var o=t("buffer"),i=o.Buffer;function c(l,d){for(var h in l)d[h]=l[h]}function u(l,d,h){return i(l,d,h)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?n.exports=o:(c(o,s),s.Buffer=u),c(i,u),u.from=function(l,d,h){if(typeof l=="number")throw new TypeError("Argument must not be a number");return i(l,d,h)},u.alloc=function(l,d,h){if(typeof l!="number")throw new TypeError("Argument must be a number");var f=i(l);return d!==void 0?typeof h=="string"?f.fill(d,h):f.fill(d):f.fill(0),f},u.allocUnsafe=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return i(l)},u.allocUnsafeSlow=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return o.SlowBuffer(l)}},{buffer:220}],218:[function(t,n,s){var o=t("safe-buffer").Buffer,i=o.isEncoding||function(m){switch((m=""+m)&&m.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function c(m){var b;switch(this.encoding=function(y){var S=function(C){if(!C)return"utf8";for(var L;;)switch(C){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return C;default:if(L)return;C=(""+C).toLowerCase(),L=!0}}(y);if(typeof S!="string"&&(o.isEncoding===i||!i(y)))throw new Error("Unknown encoding: "+y);return S||y}(m),this.encoding){case"utf16le":this.text=d,this.end=h,b=4;break;case"utf8":this.fillLast=l,b=4;break;case"base64":this.text=f,this.end=p,b=3;break;default:return this.write=v,void(this.end=g)}this.lastNeed=0,this.lastTotal=0,this.lastChar=o.allocUnsafe(b)}function u(m){return m<=127?0:m>>5==6?2:m>>4==14?3:m>>3==30?4:m>>6==2?-1:-2}function l(m){var b=this.lastTotal-this.lastNeed,y=function(S,C,L){if((192&C[0])!=128)return S.lastNeed=0,"";if(S.lastNeed>1&&C.length>1){if((192&C[1])!=128)return S.lastNeed=1,"";if(S.lastNeed>2&&C.length>2&&(192&C[2])!=128)return S.lastNeed=2,""}}(this,m);return y!==void 0?y:this.lastNeed<=m.length?(m.copy(this.lastChar,b,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(m.copy(this.lastChar,b,0,m.length),void(this.lastNeed-=m.length))}function d(m,b){if((m.length-b)%2==0){var y=m.toString("utf16le",b);if(y){var S=y.charCodeAt(y.length-1);if(S>=55296&&S<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=m[m.length-2],this.lastChar[1]=m[m.length-1],y.slice(0,-1)}return y}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=m[m.length-1],m.toString("utf16le",b,m.length-1)}function h(m){var b=m&&m.length?this.write(m):"";if(this.lastNeed){var y=this.lastTotal-this.lastNeed;return b+this.lastChar.toString("utf16le",0,y)}return b}function f(m,b){var y=(m.length-b)%3;return y===0?m.toString("base64",b):(this.lastNeed=3-y,this.lastTotal=3,y===1?this.lastChar[0]=m[m.length-1]:(this.lastChar[0]=m[m.length-2],this.lastChar[1]=m[m.length-1]),m.toString("base64",b,m.length-y))}function p(m){var b=m&&m.length?this.write(m):"";return this.lastNeed?b+this.lastChar.toString("base64",0,3-this.lastNeed):b}function v(m){return m.toString(this.encoding)}function g(m){return m&&m.length?this.write(m):""}s.StringDecoder=c,c.prototype.write=function(m){if(m.length===0)return"";var b,y;if(this.lastNeed){if((b=this.fillLast(m))===void 0)return"";y=this.lastNeed,this.lastNeed=0}else y=0;return y<m.length?b?b+this.text(m,y):this.text(m,y):b||""},c.prototype.end=function(m){var b=m&&m.length?this.write(m):"";return this.lastNeed?b+"":b},c.prototype.text=function(m,b){var y=function(C,L,O){var H=L.length-1;if(H<O)return 0;var z=u(L[H]);return z>=0?(z>0&&(C.lastNeed=z-1),z):--H<O||z===-2?0:(z=u(L[H]))>=0?(z>0&&(C.lastNeed=z-2),z):--H<O||z===-2?0:(z=u(L[H]))>=0?(z>0&&(z===2?z=0:C.lastNeed=z-3),z):0}(this,m,b);if(!this.lastNeed)return m.toString("utf8",b);this.lastTotal=y;var S=m.length-(y-this.lastNeed);return m.copy(this.lastChar,0,S),m.toString("utf8",b,S)},c.prototype.fillLast=function(m){if(this.lastNeed<=m.length)return m.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);m.copy(this.lastChar,this.lastTotal-this.lastNeed,0,m.length),this.lastNeed-=m.length}},{"safe-buffer":217}],219:[function(t,n,s){(function(o){(function(){n.exports=function(i,c){for(var u=Math.min(i.length,c.length),l=new o(u),d=0;d<u;++d)l[d]=i[d]^c[d];return l}}).call(this)}).call(this,t("buffer").Buffer)},{buffer:220}],220:[function(t,n,s){(function(o){(function(){var i=t("base64-js"),c=t("ieee754");s.Buffer=l,s.SlowBuffer=function(Y){return+Y!=Y&&(Y=0),l.alloc(+Y)},s.INSPECT_MAX_BYTES=50;function u(Y){if(Y>2147483647)throw new RangeError('The value "'+Y+'" is invalid for option "size"');var K=new Uint8Array(Y);return K.__proto__=l.prototype,K}function l(Y,K,ee){if(typeof Y=="number"){if(typeof K=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return f(Y)}return d(Y,K,ee)}function d(Y,K,ee){if(typeof Y=="string")return function(ce,fe){if(typeof fe=="string"&&fe!==""||(fe="utf8"),!l.isEncoding(fe))throw new TypeError("Unknown encoding: "+fe);var ve=0|g(ce,fe),_e=u(ve),le=_e.write(ce,fe);return le!==ve&&(_e=_e.slice(0,le)),_e}(Y,K);if(ArrayBuffer.isView(Y))return p(Y);if(Y==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Y);if(X(Y,ArrayBuffer)||Y&&X(Y.buffer,ArrayBuffer))return function(ce,fe,ve){if(fe<0||ce.byteLength<fe)throw new RangeError('"offset" is outside of buffer bounds');if(ce.byteLength<fe+(ve||0))throw new RangeError('"length" is outside of buffer bounds');var _e;return _e=fe===void 0&&ve===void 0?new Uint8Array(ce):ve===void 0?new Uint8Array(ce,fe):new Uint8Array(ce,fe,ve),_e.__proto__=l.prototype,_e}(Y,K,ee);if(typeof Y=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var ue=Y.valueOf&&Y.valueOf();if(ue!=null&&ue!==Y)return l.from(ue,K,ee);var se=function(ce){if(l.isBuffer(ce)){var fe=0|v(ce.length),ve=u(fe);return ve.length===0||ce.copy(ve,0,0,fe),ve}if(ce.length!==void 0)return typeof ce.length!="number"||ne(ce.length)?u(0):p(ce);if(ce.type==="Buffer"&&Array.isArray(ce.data))return p(ce.data)}(Y);if(se)return se;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Y[Symbol.toPrimitive]=="function")return l.from(Y[Symbol.toPrimitive]("string"),K,ee);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Y)}function h(Y){if(typeof Y!="number")throw new TypeError('"size" argument must be of type number');if(Y<0)throw new RangeError('The value "'+Y+'" is invalid for option "size"')}function f(Y){return h(Y),u(Y<0?0:0|v(Y))}function p(Y){for(var K=Y.length<0?0:0|v(Y.length),ee=u(K),ue=0;ue<K;ue+=1)ee[ue]=255&Y[ue];return ee}function v(Y){if(Y>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|Y}function g(Y,K){if(l.isBuffer(Y))return Y.length;if(ArrayBuffer.isView(Y)||X(Y,ArrayBuffer))return Y.byteLength;if(typeof Y!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Y);var ee=Y.length,ue=arguments.length>2&&arguments[2]===!0;if(!ue&&ee===0)return 0;for(var se=!1;;)switch(K){case"ascii":case"latin1":case"binary":return ee;case"utf8":case"utf-8":return Z(Y).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*ee;case"hex":return ee>>>1;case"base64":return J(Y).length;default:if(se)return ue?-1:Z(Y).length;K=(""+K).toLowerCase(),se=!0}}function m(Y,K,ee){var ue=!1;if((K===void 0||K<0)&&(K=0),K>this.length||((ee===void 0||ee>this.length)&&(ee=this.length),ee<=0)||(ee>>>=0)<=(K>>>=0))return"";for(Y||(Y="utf8");;)switch(Y){case"hex":return U(this,K,ee);case"utf8":case"utf-8":return W(this,K,ee);case"ascii":return P(this,K,ee);case"latin1":case"binary":return I(this,K,ee);case"base64":return D(this,K,ee);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,K,ee);default:if(ue)throw new TypeError("Unknown encoding: "+Y);Y=(Y+"").toLowerCase(),ue=!0}}function b(Y,K,ee){var ue=Y[K];Y[K]=Y[ee],Y[ee]=ue}function y(Y,K,ee,ue,se){if(Y.length===0)return-1;if(typeof ee=="string"?(ue=ee,ee=0):ee>2147483647?ee=2147483647:ee<-2147483648&&(ee=-2147483648),ne(ee=+ee)&&(ee=se?0:Y.length-1),ee<0&&(ee=Y.length+ee),ee>=Y.length){if(se)return-1;ee=Y.length-1}else if(ee<0){if(!se)return-1;ee=0}if(typeof K=="string"&&(K=l.from(K,ue)),l.isBuffer(K))return K.length===0?-1:S(Y,K,ee,ue,se);if(typeof K=="number")return K&=255,typeof Uint8Array.prototype.indexOf=="function"?se?Uint8Array.prototype.indexOf.call(Y,K,ee):Uint8Array.prototype.lastIndexOf.call(Y,K,ee):S(Y,[K],ee,ue,se);throw new TypeError("val must be string, number or Buffer")}function S(Y,K,ee,ue,se){var ce,fe=1,ve=Y.length,_e=K.length;if(ue!==void 0&&((ue=String(ue).toLowerCase())==="ucs2"||ue==="ucs-2"||ue==="utf16le"||ue==="utf-16le")){if(Y.length<2||K.length<2)return-1;fe=2,ve/=2,_e/=2,ee/=2}function le(ye,ge){return fe===1?ye[ge]:ye.readUInt16BE(ge*fe)}if(se){var ke=-1;for(ce=ee;ce<ve;ce++)if(le(Y,ce)===le(K,ke===-1?0:ce-ke)){if(ke===-1&&(ke=ce),ce-ke+1===_e)return ke*fe}else ke!==-1&&(ce-=ce-ke),ke=-1}else for(ee+_e>ve&&(ee=ve-_e),ce=ee;ce>=0;ce--){for(var Te=!0,pe=0;pe<_e;pe++)if(le(Y,ce+pe)!==le(K,pe)){Te=!1;break}if(Te)return ce}return-1}function C(Y,K,ee,ue){ee=Number(ee)||0;var se=Y.length-ee;ue?(ue=Number(ue))>se&&(ue=se):ue=se;var ce=K.length;ue>ce/2&&(ue=ce/2);for(var fe=0;fe<ue;++fe){var ve=parseInt(K.substr(2*fe,2),16);if(ne(ve))return fe;Y[ee+fe]=ve}return fe}function L(Y,K,ee,ue){return re(Z(K,Y.length-ee),Y,ee,ue)}function O(Y,K,ee,ue){return re(function(se){for(var ce=[],fe=0;fe<se.length;++fe)ce.push(255&se.charCodeAt(fe));return ce}(K),Y,ee,ue)}function H(Y,K,ee,ue){return O(Y,K,ee,ue)}function z(Y,K,ee,ue){return re(J(K),Y,ee,ue)}function q(Y,K,ee,ue){return re(function(se,ce){for(var fe,ve,_e,le=[],ke=0;ke<se.length&&!((ce-=2)<0);++ke)fe=se.charCodeAt(ke),ve=fe>>8,_e=fe%256,le.push(_e),le.push(ve);return le}(K,Y.length-ee),Y,ee,ue)}function D(Y,K,ee){return K===0&&ee===Y.length?i.fromByteArray(Y):i.fromByteArray(Y.slice(K,ee))}function W(Y,K,ee){ee=Math.min(Y.length,ee);for(var ue=[],se=K;se<ee;){var ce,fe,ve,_e,le=Y[se],ke=null,Te=le>239?4:le>223?3:le>191?2:1;if(se+Te<=ee)switch(Te){case 1:le<128&&(ke=le);break;case 2:(192&(ce=Y[se+1]))==128&&(_e=(31&le)<<6|63&ce)>127&&(ke=_e);break;case 3:ce=Y[se+1],fe=Y[se+2],(192&ce)==128&&(192&fe)==128&&(_e=(15&le)<<12|(63&ce)<<6|63&fe)>2047&&(_e<55296||_e>57343)&&(ke=_e);break;case 4:ce=Y[se+1],fe=Y[se+2],ve=Y[se+3],(192&ce)==128&&(192&fe)==128&&(192&ve)==128&&(_e=(15&le)<<18|(63&ce)<<12|(63&fe)<<6|63&ve)>65535&&_e<1114112&&(ke=_e)}ke===null?(ke=65533,Te=1):ke>65535&&(ke-=65536,ue.push(ke>>>10&1023|55296),ke=56320|1023&ke),ue.push(ke),se+=Te}return function(pe){var ye=pe.length;if(ye<=4096)return String.fromCharCode.apply(String,pe);for(var ge="",De=0;De<ye;)ge+=String.fromCharCode.apply(String,pe.slice(De,De+=4096));return ge}(ue)}s.kMaxLength=2147483647,l.TYPED_ARRAY_SUPPORT=function(){try{var Y=new Uint8Array(1);return Y.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},Y.foo()===42}catch{return!1}}(),l.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),l.poolSize=8192,l.from=function(Y,K,ee){return d(Y,K,ee)},l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,l.alloc=function(Y,K,ee){return function(ue,se,ce){return h(ue),ue<=0?u(ue):se!==void 0?typeof ce=="string"?u(ue).fill(se,ce):u(ue).fill(se):u(ue)}(Y,K,ee)},l.allocUnsafe=function(Y){return f(Y)},l.allocUnsafeSlow=function(Y){return f(Y)},l.isBuffer=function(Y){return Y!=null&&Y._isBuffer===!0&&Y!==l.prototype},l.compare=function(Y,K){if(X(Y,Uint8Array)&&(Y=l.from(Y,Y.offset,Y.byteLength)),X(K,Uint8Array)&&(K=l.from(K,K.offset,K.byteLength)),!l.isBuffer(Y)||!l.isBuffer(K))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(Y===K)return 0;for(var ee=Y.length,ue=K.length,se=0,ce=Math.min(ee,ue);se<ce;++se)if(Y[se]!==K[se]){ee=Y[se],ue=K[se];break}return ee<ue?-1:ue<ee?1:0},l.isEncoding=function(Y){switch(String(Y).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(Y,K){if(!Array.isArray(Y))throw new TypeError('"list" argument must be an Array of Buffers');if(Y.length===0)return l.alloc(0);var ee;if(K===void 0)for(K=0,ee=0;ee<Y.length;++ee)K+=Y[ee].length;var ue=l.allocUnsafe(K),se=0;for(ee=0;ee<Y.length;++ee){var ce=Y[ee];if(X(ce,Uint8Array)&&(ce=l.from(ce)),!l.isBuffer(ce))throw new TypeError('"list" argument must be an Array of Buffers');ce.copy(ue,se),se+=ce.length}return ue},l.byteLength=g,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var Y=this.length;if(Y%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var K=0;K<Y;K+=2)b(this,K,K+1);return this},l.prototype.swap32=function(){var Y=this.length;if(Y%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var K=0;K<Y;K+=4)b(this,K,K+3),b(this,K+1,K+2);return this},l.prototype.swap64=function(){var Y=this.length;if(Y%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var K=0;K<Y;K+=8)b(this,K,K+7),b(this,K+1,K+6),b(this,K+2,K+5),b(this,K+3,K+4);return this},l.prototype.toString=function(){var Y=this.length;return Y===0?"":arguments.length===0?W(this,0,Y):m.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(Y){if(!l.isBuffer(Y))throw new TypeError("Argument must be a Buffer");return this===Y||l.compare(this,Y)===0},l.prototype.inspect=function(){var Y="",K=s.INSPECT_MAX_BYTES;return Y=this.toString("hex",0,K).replace(/(.{2})/g,"$1 ").trim(),this.length>K&&(Y+=" ... "),"<Buffer "+Y+">"},l.prototype.compare=function(Y,K,ee,ue,se){if(X(Y,Uint8Array)&&(Y=l.from(Y,Y.offset,Y.byteLength)),!l.isBuffer(Y))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof Y);if(K===void 0&&(K=0),ee===void 0&&(ee=Y?Y.length:0),ue===void 0&&(ue=0),se===void 0&&(se=this.length),K<0||ee>Y.length||ue<0||se>this.length)throw new RangeError("out of range index");if(ue>=se&&K>=ee)return 0;if(ue>=se)return-1;if(K>=ee)return 1;if(this===Y)return 0;for(var ce=(se>>>=0)-(ue>>>=0),fe=(ee>>>=0)-(K>>>=0),ve=Math.min(ce,fe),_e=this.slice(ue,se),le=Y.slice(K,ee),ke=0;ke<ve;++ke)if(_e[ke]!==le[ke]){ce=_e[ke],fe=le[ke];break}return ce<fe?-1:fe<ce?1:0},l.prototype.includes=function(Y,K,ee){return this.indexOf(Y,K,ee)!==-1},l.prototype.indexOf=function(Y,K,ee){return y(this,Y,K,ee,!0)},l.prototype.lastIndexOf=function(Y,K,ee){return y(this,Y,K,ee,!1)},l.prototype.write=function(Y,K,ee,ue){if(K===void 0)ue="utf8",ee=this.length,K=0;else if(ee===void 0&&typeof K=="string")ue=K,ee=this.length,K=0;else{if(!isFinite(K))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");K>>>=0,isFinite(ee)?(ee>>>=0,ue===void 0&&(ue="utf8")):(ue=ee,ee=void 0)}var se=this.length-K;if((ee===void 0||ee>se)&&(ee=se),Y.length>0&&(ee<0||K<0)||K>this.length)throw new RangeError("Attempt to write outside buffer bounds");ue||(ue="utf8");for(var ce=!1;;)switch(ue){case"hex":return C(this,Y,K,ee);case"utf8":case"utf-8":return L(this,Y,K,ee);case"ascii":return O(this,Y,K,ee);case"latin1":case"binary":return H(this,Y,K,ee);case"base64":return z(this,Y,K,ee);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q(this,Y,K,ee);default:if(ce)throw new TypeError("Unknown encoding: "+ue);ue=(""+ue).toLowerCase(),ce=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function P(Y,K,ee){var ue="";ee=Math.min(Y.length,ee);for(var se=K;se<ee;++se)ue+=String.fromCharCode(127&Y[se]);return ue}function I(Y,K,ee){var ue="";ee=Math.min(Y.length,ee);for(var se=K;se<ee;++se)ue+=String.fromCharCode(Y[se]);return ue}function U(Y,K,ee){var ue=Y.length;(!K||K<0)&&(K=0),(!ee||ee<0||ee>ue)&&(ee=ue);for(var se="",ce=K;ce<ee;++ce)se+=M(Y[ce]);return se}function k(Y,K,ee){for(var ue=Y.slice(K,ee),se="",ce=0;ce<ue.length;ce+=2)se+=String.fromCharCode(ue[ce]+256*ue[ce+1]);return se}function _(Y,K,ee){if(Y%1!=0||Y<0)throw new RangeError("offset is not uint");if(Y+K>ee)throw new RangeError("Trying to access beyond buffer length")}function R(Y,K,ee,ue,se,ce){if(!l.isBuffer(Y))throw new TypeError('"buffer" argument must be a Buffer instance');if(K>se||K<ce)throw new RangeError('"value" argument is out of bounds');if(ee+ue>Y.length)throw new RangeError("Index out of range")}function j(Y,K,ee,ue,se,ce){if(ee+ue>Y.length)throw new RangeError("Index out of range");if(ee<0)throw new RangeError("Index out of range")}function A(Y,K,ee,ue,se){return K=+K,ee>>>=0,se||j(Y,0,ee,4),c.write(Y,K,ee,ue,23,4),ee+4}function N(Y,K,ee,ue,se){return K=+K,ee>>>=0,se||j(Y,0,ee,8),c.write(Y,K,ee,ue,52,8),ee+8}l.prototype.slice=function(Y,K){var ee=this.length;(Y=~~Y)<0?(Y+=ee)<0&&(Y=0):Y>ee&&(Y=ee),(K=K===void 0?ee:~~K)<0?(K+=ee)<0&&(K=0):K>ee&&(K=ee),K<Y&&(K=Y);var ue=this.subarray(Y,K);return ue.__proto__=l.prototype,ue},l.prototype.readUIntLE=function(Y,K,ee){Y>>>=0,K>>>=0,ee||_(Y,K,this.length);for(var ue=this[Y],se=1,ce=0;++ce<K&&(se*=256);)ue+=this[Y+ce]*se;return ue},l.prototype.readUIntBE=function(Y,K,ee){Y>>>=0,K>>>=0,ee||_(Y,K,this.length);for(var ue=this[Y+--K],se=1;K>0&&(se*=256);)ue+=this[Y+--K]*se;return ue},l.prototype.readUInt8=function(Y,K){return Y>>>=0,K||_(Y,1,this.length),this[Y]},l.prototype.readUInt16LE=function(Y,K){return Y>>>=0,K||_(Y,2,this.length),this[Y]|this[Y+1]<<8},l.prototype.readUInt16BE=function(Y,K){return Y>>>=0,K||_(Y,2,this.length),this[Y]<<8|this[Y+1]},l.prototype.readUInt32LE=function(Y,K){return Y>>>=0,K||_(Y,4,this.length),(this[Y]|this[Y+1]<<8|this[Y+2]<<16)+16777216*this[Y+3]},l.prototype.readUInt32BE=function(Y,K){return Y>>>=0,K||_(Y,4,this.length),16777216*this[Y]+(this[Y+1]<<16|this[Y+2]<<8|this[Y+3])},l.prototype.readIntLE=function(Y,K,ee){Y>>>=0,K>>>=0,ee||_(Y,K,this.length);for(var ue=this[Y],se=1,ce=0;++ce<K&&(se*=256);)ue+=this[Y+ce]*se;return ue>=(se*=128)&&(ue-=Math.pow(2,8*K)),ue},l.prototype.readIntBE=function(Y,K,ee){Y>>>=0,K>>>=0,ee||_(Y,K,this.length);for(var ue=K,se=1,ce=this[Y+--ue];ue>0&&(se*=256);)ce+=this[Y+--ue]*se;return ce>=(se*=128)&&(ce-=Math.pow(2,8*K)),ce},l.prototype.readInt8=function(Y,K){return Y>>>=0,K||_(Y,1,this.length),128&this[Y]?-1*(255-this[Y]+1):this[Y]},l.prototype.readInt16LE=function(Y,K){Y>>>=0,K||_(Y,2,this.length);var ee=this[Y]|this[Y+1]<<8;return 32768&ee?4294901760|ee:ee},l.prototype.readInt16BE=function(Y,K){Y>>>=0,K||_(Y,2,this.length);var ee=this[Y+1]|this[Y]<<8;return 32768&ee?4294901760|ee:ee},l.prototype.readInt32LE=function(Y,K){return Y>>>=0,K||_(Y,4,this.length),this[Y]|this[Y+1]<<8|this[Y+2]<<16|this[Y+3]<<24},l.prototype.readInt32BE=function(Y,K){return Y>>>=0,K||_(Y,4,this.length),this[Y]<<24|this[Y+1]<<16|this[Y+2]<<8|this[Y+3]},l.prototype.readFloatLE=function(Y,K){return Y>>>=0,K||_(Y,4,this.length),c.read(this,Y,!0,23,4)},l.prototype.readFloatBE=function(Y,K){return Y>>>=0,K||_(Y,4,this.length),c.read(this,Y,!1,23,4)},l.prototype.readDoubleLE=function(Y,K){return Y>>>=0,K||_(Y,8,this.length),c.read(this,Y,!0,52,8)},l.prototype.readDoubleBE=function(Y,K){return Y>>>=0,K||_(Y,8,this.length),c.read(this,Y,!1,52,8)},l.prototype.writeUIntLE=function(Y,K,ee,ue){Y=+Y,K>>>=0,ee>>>=0,ue||R(this,Y,K,ee,Math.pow(2,8*ee)-1,0);var se=1,ce=0;for(this[K]=255&Y;++ce<ee&&(se*=256);)this[K+ce]=Y/se&255;return K+ee},l.prototype.writeUIntBE=function(Y,K,ee,ue){Y=+Y,K>>>=0,ee>>>=0,ue||R(this,Y,K,ee,Math.pow(2,8*ee)-1,0);var se=ee-1,ce=1;for(this[K+se]=255&Y;--se>=0&&(ce*=256);)this[K+se]=Y/ce&255;return K+ee},l.prototype.writeUInt8=function(Y,K,ee){return Y=+Y,K>>>=0,ee||R(this,Y,K,1,255,0),this[K]=255&Y,K+1},l.prototype.writeUInt16LE=function(Y,K,ee){return Y=+Y,K>>>=0,ee||R(this,Y,K,2,65535,0),this[K]=255&Y,this[K+1]=Y>>>8,K+2},l.prototype.writeUInt16BE=function(Y,K,ee){return Y=+Y,K>>>=0,ee||R(this,Y,K,2,65535,0),this[K]=Y>>>8,this[K+1]=255&Y,K+2},l.prototype.writeUInt32LE=function(Y,K,ee){return Y=+Y,K>>>=0,ee||R(this,Y,K,4,4294967295,0),this[K+3]=Y>>>24,this[K+2]=Y>>>16,this[K+1]=Y>>>8,this[K]=255&Y,K+4},l.prototype.writeUInt32BE=function(Y,K,ee){return Y=+Y,K>>>=0,ee||R(this,Y,K,4,4294967295,0),this[K]=Y>>>24,this[K+1]=Y>>>16,this[K+2]=Y>>>8,this[K+3]=255&Y,K+4},l.prototype.writeIntLE=function(Y,K,ee,ue){if(Y=+Y,K>>>=0,!ue){var se=Math.pow(2,8*ee-1);R(this,Y,K,ee,se-1,-se)}var ce=0,fe=1,ve=0;for(this[K]=255&Y;++ce<ee&&(fe*=256);)Y<0&&ve===0&&this[K+ce-1]!==0&&(ve=1),this[K+ce]=(Y/fe>>0)-ve&255;return K+ee},l.prototype.writeIntBE=function(Y,K,ee,ue){if(Y=+Y,K>>>=0,!ue){var se=Math.pow(2,8*ee-1);R(this,Y,K,ee,se-1,-se)}var ce=ee-1,fe=1,ve=0;for(this[K+ce]=255&Y;--ce>=0&&(fe*=256);)Y<0&&ve===0&&this[K+ce+1]!==0&&(ve=1),this[K+ce]=(Y/fe>>0)-ve&255;return K+ee},l.prototype.writeInt8=function(Y,K,ee){return Y=+Y,K>>>=0,ee||R(this,Y,K,1,127,-128),Y<0&&(Y=255+Y+1),this[K]=255&Y,K+1},l.prototype.writeInt16LE=function(Y,K,ee){return Y=+Y,K>>>=0,ee||R(this,Y,K,2,32767,-32768),this[K]=255&Y,this[K+1]=Y>>>8,K+2},l.prototype.writeInt16BE=function(Y,K,ee){return Y=+Y,K>>>=0,ee||R(this,Y,K,2,32767,-32768),this[K]=Y>>>8,this[K+1]=255&Y,K+2},l.prototype.writeInt32LE=function(Y,K,ee){return Y=+Y,K>>>=0,ee||R(this,Y,K,4,2147483647,-2147483648),this[K]=255&Y,this[K+1]=Y>>>8,this[K+2]=Y>>>16,this[K+3]=Y>>>24,K+4},l.prototype.writeInt32BE=function(Y,K,ee){return Y=+Y,K>>>=0,ee||R(this,Y,K,4,2147483647,-2147483648),Y<0&&(Y=4294967295+Y+1),this[K]=Y>>>24,this[K+1]=Y>>>16,this[K+2]=Y>>>8,this[K+3]=255&Y,K+4},l.prototype.writeFloatLE=function(Y,K,ee){return A(this,Y,K,!0,ee)},l.prototype.writeFloatBE=function(Y,K,ee){return A(this,Y,K,!1,ee)},l.prototype.writeDoubleLE=function(Y,K,ee){return N(this,Y,K,!0,ee)},l.prototype.writeDoubleBE=function(Y,K,ee){return N(this,Y,K,!1,ee)},l.prototype.copy=function(Y,K,ee,ue){if(!l.isBuffer(Y))throw new TypeError("argument should be a Buffer");if(ee||(ee=0),ue||ue===0||(ue=this.length),K>=Y.length&&(K=Y.length),K||(K=0),ue>0&&ue<ee&&(ue=ee),ue===ee||Y.length===0||this.length===0)return 0;if(K<0)throw new RangeError("targetStart out of bounds");if(ee<0||ee>=this.length)throw new RangeError("Index out of range");if(ue<0)throw new RangeError("sourceEnd out of bounds");ue>this.length&&(ue=this.length),Y.length-K<ue-ee&&(ue=Y.length-K+ee);var se=ue-ee;if(this===Y&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(K,ee,ue);else if(this===Y&&ee<K&&K<ue)for(var ce=se-1;ce>=0;--ce)Y[ce+K]=this[ce+ee];else Uint8Array.prototype.set.call(Y,this.subarray(ee,ue),K);return se},l.prototype.fill=function(Y,K,ee,ue){if(typeof Y=="string"){if(typeof K=="string"?(ue=K,K=0,ee=this.length):typeof ee=="string"&&(ue=ee,ee=this.length),ue!==void 0&&typeof ue!="string")throw new TypeError("encoding must be a string");if(typeof ue=="string"&&!l.isEncoding(ue))throw new TypeError("Unknown encoding: "+ue);if(Y.length===1){var se=Y.charCodeAt(0);(ue==="utf8"&&se<128||ue==="latin1")&&(Y=se)}}else typeof Y=="number"&&(Y&=255);if(K<0||this.length<K||this.length<ee)throw new RangeError("Out of range index");if(ee<=K)return this;var ce;if(K>>>=0,ee=ee===void 0?this.length:ee>>>0,Y||(Y=0),typeof Y=="number")for(ce=K;ce<ee;++ce)this[ce]=Y;else{var fe=l.isBuffer(Y)?Y:l.from(Y,ue),ve=fe.length;if(ve===0)throw new TypeError('The value "'+Y+'" is invalid for argument "value"');for(ce=0;ce<ee-K;++ce)this[ce+K]=fe[ce%ve]}return this};var V=/[^+/0-9A-Za-z-_]/g;function M(Y){return Y<16?"0"+Y.toString(16):Y.toString(16)}function Z(Y,K){var ee;K=K||1/0;for(var ue=Y.length,se=null,ce=[],fe=0;fe<ue;++fe){if((ee=Y.charCodeAt(fe))>55295&&ee<57344){if(!se){if(ee>56319){(K-=3)>-1&&ce.push(239,191,189);continue}if(fe+1===ue){(K-=3)>-1&&ce.push(239,191,189);continue}se=ee;continue}if(ee<56320){(K-=3)>-1&&ce.push(239,191,189),se=ee;continue}ee=65536+(se-55296<<10|ee-56320)}else se&&(K-=3)>-1&&ce.push(239,191,189);if(se=null,ee<128){if((K-=1)<0)break;ce.push(ee)}else if(ee<2048){if((K-=2)<0)break;ce.push(ee>>6|192,63&ee|128)}else if(ee<65536){if((K-=3)<0)break;ce.push(ee>>12|224,ee>>6&63|128,63&ee|128)}else{if(!(ee<1114112))throw new Error("Invalid code point");if((K-=4)<0)break;ce.push(ee>>18|240,ee>>12&63|128,ee>>6&63|128,63&ee|128)}}return ce}function J(Y){return i.toByteArray(function(K){if((K=(K=K.split("=")[0]).trim().replace(V,"")).length<2)return"";for(;K.length%4!=0;)K+="=";return K}(Y))}function re(Y,K,ee,ue){for(var se=0;se<ue&&!(se+ee>=K.length||se>=Y.length);++se)K[se+ee]=Y[se];return se}function X(Y,K){return Y instanceof K||Y!=null&&Y.constructor!=null&&Y.constructor.name!=null&&Y.constructor.name===K.name}function ne(Y){return Y!=Y}}).call(this)}).call(this,t("buffer").Buffer)},{"base64-js":185,buffer:220,ieee754:439}],221:[function(t,n,s){var o=t("safe-buffer").Buffer,i=t("stream").Transform,c=t("string_decoder").StringDecoder;function u(l){i.call(this),this.hashMode=typeof l=="string",this.hashMode?this[l]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}t("inherits")(u,i),u.prototype.update=function(l,d,h){typeof l=="string"&&(l=o.from(l,d));var f=this._update(l);return this.hashMode?this:(h&&(f=this._toString(f,h)),f)},u.prototype.setAutoPadding=function(){},u.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},u.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},u.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},u.prototype._transform=function(l,d,h){var f;try{this.hashMode?this._update(l):this.push(this._update(l))}catch(p){f=p}finally{h(f)}},u.prototype._flush=function(l){var d;try{this.push(this.__final())}catch(h){d=h}l(d)},u.prototype._finalOrDigest=function(l){var d=this.__final()||o.alloc(0);return l&&(d=this._toString(d,l,!0)),d},u.prototype._toString=function(l,d,h){if(this._decoder||(this._decoder=new c(d),this._encoding=d),this._encoding!==d)throw new Error("can't switch encodings");var f=this._decoder.write(l);return h&&(f+=this._decoder.end()),f},n.exports=u},{inherits:440,"safe-buffer":494,stream:505,string_decoder:218}],222:[function(t,n,s){var o=t("../internals/is-callable"),i=t("../internals/try-to-string"),c=TypeError;n.exports=function(u){if(o(u))return u;throw new c(i(u)+" is not a function")}},{"../internals/is-callable":285,"../internals/try-to-string":349}],223:[function(t,n,s){var o=t("../internals/is-constructor"),i=t("../internals/try-to-string"),c=TypeError;n.exports=function(u){if(o(u))return u;throw new c(i(u)+" is not a constructor")}},{"../internals/is-constructor":286,"../internals/try-to-string":349}],224:[function(t,n,s){var o=t("../internals/is-callable"),i=String,c=TypeError;n.exports=function(u){if(typeof u=="object"||o(u))return u;throw new c("Can't set "+i(u)+" as a prototype")}},{"../internals/is-callable":285}],225:[function(t,n,s){var o=t("../internals/well-known-symbol"),i=t("../internals/object-create"),c=t("../internals/object-define-property").f,u=o("unscopables"),l=Array.prototype;l[u]===void 0&&c(l,u,{configurable:!0,value:i(null)}),n.exports=function(d){l[u][d]=!0}},{"../internals/object-create":306,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],226:[function(t,n,s){var o=t("../internals/object-is-prototype-of"),i=TypeError;n.exports=function(c,u){if(o(u,c))return c;throw new i("Incorrect invocation")}},{"../internals/object-is-prototype-of":314}],227:[function(t,n,s){var o=t("../internals/is-object"),i=String,c=TypeError;n.exports=function(u){if(o(u))return u;throw new c(i(u)+" is not an object")}},{"../internals/is-object":289}],228:[function(t,n,s){var o=t("../internals/to-indexed-object"),i=t("../internals/to-absolute-index"),c=t("../internals/length-of-array-like"),u=function(l){return function(d,h,f){var p,v=o(d),g=c(v),m=i(f,g);if(l&&h!=h){for(;g>m;)if((p=v[m++])!=p)return!0}else for(;g>m;m++)if((l||m in v)&&v[m]===h)return l||m||0;return!l&&-1}};n.exports={includes:u(!0),indexOf:u(!1)}},{"../internals/length-of-array-like":299,"../internals/to-absolute-index":340,"../internals/to-indexed-object":341}],229:[function(t,n,s){var o=t("../internals/function-bind-context"),i=t("../internals/function-uncurry-this"),c=t("../internals/indexed-object"),u=t("../internals/to-object"),l=t("../internals/length-of-array-like"),d=t("../internals/array-species-create"),h=i([].push),f=function(p){var v=p===1,g=p===2,m=p===3,b=p===4,y=p===6,S=p===7,C=p===5||y;return function(L,O,H,z){for(var q,D,W=u(L),P=c(W),I=o(O,H),U=l(P),k=0,_=z||d,R=v?_(L,U):g||S?_(L,0):void 0;U>k;k++)if((C||k in P)&&(D=I(q=P[k],k,W),p))if(v)R[k]=D;else if(D)switch(p){case 3:return!0;case 5:return q;case 6:return k;case 2:h(R,q)}else switch(p){case 4:return!1;case 7:h(R,q)}return y?-1:m||b?b:R}};n.exports={forEach:f(0),map:f(1),filter:f(2),some:f(3),every:f(4),find:f(5),findIndex:f(6),filterReject:f(7)}},{"../internals/array-species-create":233,"../internals/function-bind-context":262,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/length-of-array-like":299,"../internals/to-object":344}],230:[function(t,n,s){var o=t("../internals/to-absolute-index"),i=t("../internals/length-of-array-like"),c=t("../internals/create-property"),u=Array,l=Math.max;n.exports=function(d,h,f){for(var p=i(d),v=o(h,p),g=o(f===void 0?p:f,p),m=u(l(g-v,0)),b=0;v<g;v++,b++)c(m,b,d[v]);return m.length=b,m}},{"../internals/create-property":243,"../internals/length-of-array-like":299,"../internals/to-absolute-index":340}],231:[function(t,n,s){var o=t("../internals/function-uncurry-this");n.exports=o([].slice)},{"../internals/function-uncurry-this":268}],232:[function(t,n,s){var o=t("../internals/is-array"),i=t("../internals/is-constructor"),c=t("../internals/is-object"),u=t("../internals/well-known-symbol")("species"),l=Array;n.exports=function(d){var h;return o(d)&&(h=d.constructor,(i(h)&&(h===l||o(h.prototype))||c(h)&&(h=h[u])===null)&&(h=void 0)),h===void 0?l:h}},{"../internals/is-array":284,"../internals/is-constructor":286,"../internals/is-object":289,"../internals/well-known-symbol":357}],233:[function(t,n,s){var o=t("../internals/array-species-constructor");n.exports=function(i,c){return new(o(i))(c===0?0:c)}},{"../internals/array-species-constructor":232}],234:[function(t,n,s){var o=t("../internals/well-known-symbol")("iterator"),i=!1;try{var c=0,u={next:function(){return{done:!!c++}},return:function(){i=!0}};u[o]=function(){return this},Array.from(u,function(){throw 2})}catch{}n.exports=function(l,d){try{if(!d&&!i)return!1}catch{return!1}var h=!1;try{var f={};f[o]=function(){return{next:function(){return{done:h=!0}}}},l(f)}catch{}return h}},{"../internals/well-known-symbol":357}],235:[function(t,n,s){var o=t("../internals/function-uncurry-this"),i=o({}.toString),c=o("".slice);n.exports=function(u){return c(i(u),8,-1)}},{"../internals/function-uncurry-this":268}],236:[function(t,n,s){var o=t("../internals/to-string-tag-support"),i=t("../internals/is-callable"),c=t("../internals/classof-raw"),u=t("../internals/well-known-symbol")("toStringTag"),l=Object,d=c(function(){return arguments}())==="Arguments";n.exports=o?c:function(h){var f,p,v;return h===void 0?"Undefined":h===null?"Null":typeof(p=function(g,m){try{return g[m]}catch{}}(f=l(h),u))=="string"?p:d?c(f):(v=c(f))==="Object"&&i(f.callee)?"Arguments":v}},{"../internals/classof-raw":235,"../internals/is-callable":285,"../internals/to-string-tag-support":347,"../internals/well-known-symbol":357}],237:[function(t,n,s){var o=t("../internals/has-own-property"),i=t("../internals/own-keys"),c=t("../internals/object-get-own-property-descriptor"),u=t("../internals/object-define-property");n.exports=function(l,d,h){for(var f=i(d),p=u.f,v=c.f,g=0;g<f.length;g++){var m=f[g];o(l,m)||h&&o(h,m)||p(l,m,v(d,m))}}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/own-keys":321}],238:[function(t,n,s){var o=t("../internals/well-known-symbol")("match");n.exports=function(i){var c=/./;try{"/./"[i](c)}catch{try{return c[o]=!1,"/./"[i](c)}catch{}}return!1}},{"../internals/well-known-symbol":357}],239:[function(t,n,s){var o=t("../internals/fails");n.exports=!o(function(){function i(){}return i.prototype.constructor=null,Object.getPrototypeOf(new i)!==i.prototype})},{"../internals/fails":260}],240:[function(t,n,s){n.exports=function(o,i){return{value:o,done:i}}},{}],241:[function(t,n,s){var o=t("../internals/descriptors"),i=t("../internals/object-define-property"),c=t("../internals/create-property-descriptor");n.exports=o?function(u,l,d){return i.f(u,l,c(1,d))}:function(u,l,d){return u[l]=d,u}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/object-define-property":308}],242:[function(t,n,s){n.exports=function(o,i){return{enumerable:!(1&o),configurable:!(2&o),writable:!(4&o),value:i}}},{}],243:[function(t,n,s){var o=t("../internals/to-property-key"),i=t("../internals/object-define-property"),c=t("../internals/create-property-descriptor");n.exports=function(u,l,d){var h=o(l);h in u?i.f(u,h,c(0,d)):u[h]=d}},{"../internals/create-property-descriptor":242,"../internals/object-define-property":308,"../internals/to-property-key":346}],244:[function(t,n,s){var o=t("../internals/make-built-in"),i=t("../internals/object-define-property");n.exports=function(c,u,l){return l.get&&o(l.get,u,{getter:!0}),l.set&&o(l.set,u,{setter:!0}),i.f(c,u,l)}},{"../internals/make-built-in":300,"../internals/object-define-property":308}],245:[function(t,n,s){var o=t("../internals/is-callable"),i=t("../internals/object-define-property"),c=t("../internals/make-built-in"),u=t("../internals/define-global-property");n.exports=function(l,d,h,f){f||(f={});var p=f.enumerable,v=f.name!==void 0?f.name:d;if(o(h)&&c(h,v,f),f.global)p?l[d]=h:u(d,h);else{try{f.unsafe?l[d]&&(p=!0):delete l[d]}catch{}p?l[d]=h:i.f(l,d,{value:h,enumerable:!1,configurable:!f.nonConfigurable,writable:!f.nonWritable})}return l}},{"../internals/define-global-property":246,"../internals/is-callable":285,"../internals/make-built-in":300,"../internals/object-define-property":308}],246:[function(t,n,s){var o=t("../internals/global"),i=Object.defineProperty;n.exports=function(c,u){try{i(o,c,{value:u,configurable:!0,writable:!0})}catch{o[c]=u}return u}},{"../internals/global":274}],247:[function(t,n,s){var o=t("../internals/fails");n.exports=!o(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})},{"../internals/fails":260}],248:[function(t,n,s){var o=typeof document=="object"&&document.all,i=o===void 0&&o!==void 0;n.exports={all:o,IS_HTMLDDA:i}},{}],249:[function(t,n,s){var o=t("../internals/global"),i=t("../internals/is-object"),c=o.document,u=i(c)&&i(c.createElement);n.exports=function(l){return u?c.createElement(l):{}}},{"../internals/global":274,"../internals/is-object":289}],250:[function(t,n,s){var o=t("../internals/engine-is-deno"),i=t("../internals/engine-is-node");n.exports=!o&&!i&&typeof window=="object"&&typeof document=="object"},{"../internals/engine-is-deno":251,"../internals/engine-is-node":254}],251:[function(t,n,s){n.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"},{}],252:[function(t,n,s){var o=t("../internals/engine-user-agent");n.exports=/ipad|iphone|ipod/i.test(o)&&typeof Pebble<"u"},{"../internals/engine-user-agent":256}],253:[function(t,n,s){var o=t("../internals/engine-user-agent");n.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(o)},{"../internals/engine-user-agent":256}],254:[function(t,n,s){var o=t("../internals/global"),i=t("../internals/classof-raw");n.exports=i(o.process)==="process"},{"../internals/classof-raw":235,"../internals/global":274}],255:[function(t,n,s){var o=t("../internals/engine-user-agent");n.exports=/web0s(?!.*chrome)/i.test(o)},{"../internals/engine-user-agent":256}],256:[function(t,n,s){n.exports=typeof navigator<"u"&&String(navigator.userAgent)||""},{}],257:[function(t,n,s){var o,i,c=t("../internals/global"),u=t("../internals/engine-user-agent"),l=c.process,d=c.Deno,h=l&&l.versions||d&&d.version,f=h&&h.v8;f&&(i=(o=f.split("."))[0]>0&&o[0]<4?1:+(o[0]+o[1])),!i&&u&&(!(o=u.match(/Edge\/(\d+)/))||o[1]>=74)&&(o=u.match(/Chrome\/(\d+)/))&&(i=+o[1]),n.exports=i},{"../internals/engine-user-agent":256,"../internals/global":274}],258:[function(t,n,s){n.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],259:[function(t,n,s){var o=t("../internals/global"),i=t("../internals/object-get-own-property-descriptor").f,c=t("../internals/create-non-enumerable-property"),u=t("../internals/define-built-in"),l=t("../internals/define-global-property"),d=t("../internals/copy-constructor-properties"),h=t("../internals/is-forced");n.exports=function(f,p){var v,g,m,b,y,S=f.target,C=f.global,L=f.stat;if(v=C?o:L?o[S]||l(S,{}):(o[S]||{}).prototype)for(g in p){if(b=p[g],m=f.dontCallGetSet?(y=i(v,g))&&y.value:v[g],!h(C?g:S+(L?".":"#")+g,f.forced)&&m!==void 0){if(typeof b==typeof m)continue;d(b,m)}(f.sham||m&&m.sham)&&c(b,"sham",!0),u(v,g,b,f)}}},{"../internals/copy-constructor-properties":237,"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/define-global-property":246,"../internals/global":274,"../internals/is-forced":287,"../internals/object-get-own-property-descriptor":309}],260:[function(t,n,s){n.exports=function(o){try{return!!o()}catch{return!0}}},{}],261:[function(t,n,s){var o=t("../internals/function-bind-native"),i=Function.prototype,c=i.apply,u=i.call;n.exports=typeof Reflect=="object"&&Reflect.apply||(o?u.bind(c):function(){return u.apply(c,arguments)})},{"../internals/function-bind-native":263}],262:[function(t,n,s){var o=t("../internals/function-uncurry-this-clause"),i=t("../internals/a-callable"),c=t("../internals/function-bind-native"),u=o(o.bind);n.exports=function(l,d){return i(l),d===void 0?l:c?u(l,d):function(){return l.apply(d,arguments)}}},{"../internals/a-callable":222,"../internals/function-bind-native":263,"../internals/function-uncurry-this-clause":267}],263:[function(t,n,s){var o=t("../internals/fails");n.exports=!o(function(){var i=(function(){}).bind();return typeof i!="function"||i.hasOwnProperty("prototype")})},{"../internals/fails":260}],264:[function(t,n,s){var o=t("../internals/function-bind-native"),i=Function.prototype.call;n.exports=o?i.bind(i):function(){return i.apply(i,arguments)}},{"../internals/function-bind-native":263}],265:[function(t,n,s){var o=t("../internals/descriptors"),i=t("../internals/has-own-property"),c=Function.prototype,u=o&&Object.getOwnPropertyDescriptor,l=i(c,"name"),d=l&&(function(){}).name==="something",h=l&&(!o||o&&u(c,"name").configurable);n.exports={EXISTS:l,PROPER:d,CONFIGURABLE:h}},{"../internals/descriptors":247,"../internals/has-own-property":275}],266:[function(t,n,s){var o=t("../internals/function-uncurry-this"),i=t("../internals/a-callable");n.exports=function(c,u,l){try{return o(i(Object.getOwnPropertyDescriptor(c,u)[l]))}catch{}}},{"../internals/a-callable":222,"../internals/function-uncurry-this":268}],267:[function(t,n,s){var o=t("../internals/classof-raw"),i=t("../internals/function-uncurry-this");n.exports=function(c){if(o(c)==="Function")return i(c)}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268}],268:[function(t,n,s){var o=t("../internals/function-bind-native"),i=Function.prototype,c=i.call,u=o&&i.bind.bind(c,c);n.exports=o?u:function(l){return function(){return c.apply(l,arguments)}}},{"../internals/function-bind-native":263}],269:[function(t,n,s){var o=t("../internals/global"),i=t("../internals/is-callable"),c=function(u){return i(u)?u:void 0};n.exports=function(u,l){return arguments.length<2?c(o[u]):o[u]&&o[u][l]}},{"../internals/global":274,"../internals/is-callable":285}],270:[function(t,n,s){var o=t("../internals/classof"),i=t("../internals/get-method"),c=t("../internals/is-null-or-undefined"),u=t("../internals/iterators"),l=t("../internals/well-known-symbol")("iterator");n.exports=function(d){if(!c(d))return i(d,l)||i(d,"@@iterator")||u[o(d)]}},{"../internals/classof":236,"../internals/get-method":273,"../internals/is-null-or-undefined":288,"../internals/iterators":298,"../internals/well-known-symbol":357}],271:[function(t,n,s){var o=t("../internals/function-call"),i=t("../internals/a-callable"),c=t("../internals/an-object"),u=t("../internals/try-to-string"),l=t("../internals/get-iterator-method"),d=TypeError;n.exports=function(h,f){var p=arguments.length<2?l(h):f;if(i(p))return c(o(p,h));throw new d(u(h)+" is not iterable")}},{"../internals/a-callable":222,"../internals/an-object":227,"../internals/function-call":264,"../internals/get-iterator-method":270,"../internals/try-to-string":349}],272:[function(t,n,s){var o=t("../internals/function-uncurry-this"),i=t("../internals/is-array"),c=t("../internals/is-callable"),u=t("../internals/classof-raw"),l=t("../internals/to-string"),d=o([].push);n.exports=function(h){if(c(h))return h;if(i(h)){for(var f=h.length,p=[],v=0;v<f;v++){var g=h[v];typeof g=="string"?d(p,g):typeof g!="number"&&u(g)!=="Number"&&u(g)!=="String"||d(p,l(g))}var m=p.length,b=!0;return function(y,S){if(b)return b=!1,S;if(i(this))return S;for(var C=0;C<m;C++)if(p[C]===y)return S}}}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268,"../internals/is-array":284,"../internals/is-callable":285,"../internals/to-string":348}],273:[function(t,n,s){var o=t("../internals/a-callable"),i=t("../internals/is-null-or-undefined");n.exports=function(c,u){var l=c[u];return i(l)?void 0:o(l)}},{"../internals/a-callable":222,"../internals/is-null-or-undefined":288}],274:[function(t,n,s){(function(o){(function(){var i=function(c){return c&&c.Math===Math&&c};n.exports=i(typeof globalThis=="object"&&globalThis)||i(typeof window=="object"&&window)||i(typeof self=="object"&&self)||i(typeof o=="object"&&o)||function(){return this}()||this||Function("return this")()}).call(this)}).call(this,typeof Kn<"u"?Kn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],275:[function(t,n,s){var o=t("../internals/function-uncurry-this"),i=t("../internals/to-object"),c=o({}.hasOwnProperty);n.exports=Object.hasOwn||function(u,l){return c(i(u),l)}},{"../internals/function-uncurry-this":268,"../internals/to-object":344}],276:[function(t,n,s){n.exports={}},{}],277:[function(t,n,s){n.exports=function(o,i){try{arguments.length===1?console.error(o):console.error(o,i)}catch{}}},{}],278:[function(t,n,s){var o=t("../internals/get-built-in");n.exports=o("document","documentElement")},{"../internals/get-built-in":269}],279:[function(t,n,s){var o=t("../internals/descriptors"),i=t("../internals/fails"),c=t("../internals/document-create-element");n.exports=!o&&!i(function(){return Object.defineProperty(c("div"),"a",{get:function(){return 7}}).a!==7})},{"../internals/descriptors":247,"../internals/document-create-element":249,"../internals/fails":260}],280:[function(t,n,s){var o=t("../internals/function-uncurry-this"),i=t("../internals/fails"),c=t("../internals/classof-raw"),u=Object,l=o("".split);n.exports=i(function(){return!u("z").propertyIsEnumerable(0)})?function(d){return c(d)==="String"?l(d,""):u(d)}:u},{"../internals/classof-raw":235,"../internals/fails":260,"../internals/function-uncurry-this":268}],281:[function(t,n,s){var o=t("../internals/function-uncurry-this"),i=t("../internals/is-callable"),c=t("../internals/shared-store"),u=o(Function.toString);i(c.inspectSource)||(c.inspectSource=function(l){return u(l)}),n.exports=c.inspectSource},{"../internals/function-uncurry-this":268,"../internals/is-callable":285,"../internals/shared-store":333}],282:[function(t,n,s){var o,i,c,u=t("../internals/weak-map-basic-detection"),l=t("../internals/global"),d=t("../internals/is-object"),h=t("../internals/create-non-enumerable-property"),f=t("../internals/has-own-property"),p=t("../internals/shared-store"),v=t("../internals/shared-key"),g=t("../internals/hidden-keys"),m=l.TypeError,b=l.WeakMap;if(u||p.state){var y=p.state||(p.state=new b);y.get=y.get,y.has=y.has,y.set=y.set,o=function(C,L){if(y.has(C))throw new m("Object already initialized");return L.facade=C,y.set(C,L),L},i=function(C){return y.get(C)||{}},c=function(C){return y.has(C)}}else{var S=v("state");g[S]=!0,o=function(C,L){if(f(C,S))throw new m("Object already initialized");return L.facade=C,h(C,S,L),L},i=function(C){return f(C,S)?C[S]:{}},c=function(C){return f(C,S)}}n.exports={set:o,get:i,has:c,enforce:function(C){return c(C)?i(C):o(C,{})},getterFor:function(C){return function(L){var O;if(!d(L)||(O=i(L)).type!==C)throw new m("Incompatible receiver, "+C+" required");return O}}}},{"../internals/create-non-enumerable-property":241,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/is-object":289,"../internals/shared-key":332,"../internals/shared-store":333,"../internals/weak-map-basic-detection":354}],283:[function(t,n,s){var o=t("../internals/well-known-symbol"),i=t("../internals/iterators"),c=o("iterator"),u=Array.prototype;n.exports=function(l){return l!==void 0&&(i.Array===l||u[c]===l)}},{"../internals/iterators":298,"../internals/well-known-symbol":357}],284:[function(t,n,s){var o=t("../internals/classof-raw");n.exports=Array.isArray||function(i){return o(i)==="Array"}},{"../internals/classof-raw":235}],285:[function(t,n,s){var o=t("../internals/document-all"),i=o.all;n.exports=o.IS_HTMLDDA?function(c){return typeof c=="function"||c===i}:function(c){return typeof c=="function"}},{"../internals/document-all":248}],286:[function(t,n,s){var o=t("../internals/function-uncurry-this"),i=t("../internals/fails"),c=t("../internals/is-callable"),u=t("../internals/classof"),l=t("../internals/get-built-in"),d=t("../internals/inspect-source"),h=function(){},f=[],p=l("Reflect","construct"),v=/^\s*(?:class|function)\b/,g=o(v.exec),m=!v.test(h),b=function(S){if(!c(S))return!1;try{return p(h,f,S),!0}catch{return!1}},y=function(S){if(!c(S))return!1;switch(u(S)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return m||!!g(v,d(S))}catch{return!0}};y.sham=!0,n.exports=!p||i(function(){var S;return b(b.call)||!b(Object)||!b(function(){S=!0})||S})?y:b},{"../internals/classof":236,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/inspect-source":281,"../internals/is-callable":285}],287:[function(t,n,s){var o=t("../internals/fails"),i=t("../internals/is-callable"),c=/#|\.prototype\./,u=function(p,v){var g=d[l(p)];return g===f||g!==h&&(i(v)?o(v):!!v)},l=u.normalize=function(p){return String(p).replace(c,".").toLowerCase()},d=u.data={},h=u.NATIVE="N",f=u.POLYFILL="P";n.exports=u},{"../internals/fails":260,"../internals/is-callable":285}],288:[function(t,n,s){n.exports=function(o){return o==null}},{}],289:[function(t,n,s){var o=t("../internals/is-callable"),i=t("../internals/document-all"),c=i.all;n.exports=i.IS_HTMLDDA?function(u){return typeof u=="object"?u!==null:o(u)||u===c}:function(u){return typeof u=="object"?u!==null:o(u)}},{"../internals/document-all":248,"../internals/is-callable":285}],290:[function(t,n,s){n.exports=!1},{}],291:[function(t,n,s){var o=t("../internals/is-object"),i=t("../internals/classof-raw"),c=t("../internals/well-known-symbol")("match");n.exports=function(u){var l;return o(u)&&((l=u[c])!==void 0?!!l:i(u)==="RegExp")}},{"../internals/classof-raw":235,"../internals/is-object":289,"../internals/well-known-symbol":357}],292:[function(t,n,s){var o=t("../internals/get-built-in"),i=t("../internals/is-callable"),c=t("../internals/object-is-prototype-of"),u=t("../internals/use-symbol-as-uid"),l=Object;n.exports=u?function(d){return typeof d=="symbol"}:function(d){var h=o("Symbol");return i(h)&&c(h.prototype,l(d))}},{"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/object-is-prototype-of":314,"../internals/use-symbol-as-uid":351}],293:[function(t,n,s){var o=t("../internals/function-bind-context"),i=t("../internals/function-call"),c=t("../internals/an-object"),u=t("../internals/try-to-string"),l=t("../internals/is-array-iterator-method"),d=t("../internals/length-of-array-like"),h=t("../internals/object-is-prototype-of"),f=t("../internals/get-iterator"),p=t("../internals/get-iterator-method"),v=t("../internals/iterator-close"),g=TypeError,m=function(y,S){this.stopped=y,this.result=S},b=m.prototype;n.exports=function(y,S,C){var L,O,H,z,q,D,W,P=C&&C.that,I=!(!C||!C.AS_ENTRIES),U=!(!C||!C.IS_RECORD),k=!(!C||!C.IS_ITERATOR),_=!(!C||!C.INTERRUPTED),R=o(S,P),j=function(N){return L&&v(L,"normal",N),new m(!0,N)},A=function(N){return I?(c(N),_?R(N[0],N[1],j):R(N[0],N[1])):_?R(N,j):R(N)};if(U)L=y.iterator;else if(k)L=y;else{if(!(O=p(y)))throw new g(u(y)+" is not iterable");if(l(O)){for(H=0,z=d(y);z>H;H++)if((q=A(y[H]))&&h(b,q))return q;return new m(!1)}L=f(y,O)}for(D=U?y.next:L.next;!(W=i(D,L)).done;){try{q=A(W.value)}catch(N){v(L,"throw",N)}if(typeof q=="object"&&q&&h(b,q))return q}return new m(!1)}},{"../internals/an-object":227,"../internals/function-bind-context":262,"../internals/function-call":264,"../internals/get-iterator":271,"../internals/get-iterator-method":270,"../internals/is-array-iterator-method":283,"../internals/iterator-close":294,"../internals/length-of-array-like":299,"../internals/object-is-prototype-of":314,"../internals/try-to-string":349}],294:[function(t,n,s){var o=t("../internals/function-call"),i=t("../internals/an-object"),c=t("../internals/get-method");n.exports=function(u,l,d){var h,f;i(u);try{if(!(h=c(u,"return"))){if(l==="throw")throw d;return d}h=o(h,u)}catch(p){f=!0,h=p}if(l==="throw")throw d;if(f)throw h;return i(h),d}},{"../internals/an-object":227,"../internals/function-call":264,"../internals/get-method":273}],295:[function(t,n,s){var o=t("../internals/iterators-core").IteratorPrototype,i=t("../internals/object-create"),c=t("../internals/create-property-descriptor"),u=t("../internals/set-to-string-tag"),l=t("../internals/iterators"),d=function(){return this};n.exports=function(h,f,p,v){var g=f+" Iterator";return h.prototype=i(o,{next:c(+!v,p)}),u(h,g,!1,!0),l[g]=d,h}},{"../internals/create-property-descriptor":242,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-create":306,"../internals/set-to-string-tag":331}],296:[function(t,n,s){var o=t("../internals/export"),i=t("../internals/function-call"),c=t("../internals/is-pure"),u=t("../internals/function-name"),l=t("../internals/is-callable"),d=t("../internals/iterator-create-constructor"),h=t("../internals/object-get-prototype-of"),f=t("../internals/object-set-prototype-of"),p=t("../internals/set-to-string-tag"),v=t("../internals/create-non-enumerable-property"),g=t("../internals/define-built-in"),m=t("../internals/well-known-symbol"),b=t("../internals/iterators"),y=t("../internals/iterators-core"),S=u.PROPER,C=u.CONFIGURABLE,L=y.IteratorPrototype,O=y.BUGGY_SAFARI_ITERATORS,H=m("iterator"),z=function(){return this};n.exports=function(q,D,W,P,I,U,k){d(W,D,P);var _,R,j,A=function(X){if(X===I&&J)return J;if(!O&&X&&X in M)return M[X];switch(X){case"keys":case"values":case"entries":return function(){return new W(this,X)}}return function(){return new W(this)}},N=D+" Iterator",V=!1,M=q.prototype,Z=M[H]||M["@@iterator"]||I&&M[I],J=!O&&Z||A(I),re=D==="Array"&&M.entries||Z;if(re&&(_=h(re.call(new q)))!==Object.prototype&&_.next&&(c||h(_)===L||(f?f(_,L):l(_[H])||g(_,H,z)),p(_,N,!0,!0),c&&(b[N]=z)),S&&I==="values"&&Z&&Z.name!=="values"&&(!c&&C?v(M,"name","values"):(V=!0,J=function(){return i(Z,this)})),I)if(R={values:A("values"),keys:U?J:A("keys"),entries:A("entries")},k)for(j in R)(O||V||!(j in M))&&g(M,j,R[j]);else o({target:D,proto:!0,forced:O||V},R);return c&&!k||M[H]===J||g(M,H,J,{name:I}),b[D]=J,R}},{"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/export":259,"../internals/function-call":264,"../internals/function-name":265,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/iterator-create-constructor":295,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-get-prototype-of":313,"../internals/object-set-prototype-of":318,"../internals/set-to-string-tag":331,"../internals/well-known-symbol":357}],297:[function(t,n,s){var o,i,c,u=t("../internals/fails"),l=t("../internals/is-callable"),d=t("../internals/is-object"),h=t("../internals/object-create"),f=t("../internals/object-get-prototype-of"),p=t("../internals/define-built-in"),v=t("../internals/well-known-symbol"),g=t("../internals/is-pure"),m=v("iterator"),b=!1;[].keys&&("next"in(c=[].keys())?(i=f(f(c)))!==Object.prototype&&(o=i):b=!0),!d(o)||u(function(){var y={};return o[m].call(y)!==y})?o={}:g&&(o=h(o)),l(o[m])||p(o,m,function(){return this}),n.exports={IteratorPrototype:o,BUGGY_SAFARI_ITERATORS:b}},{"../internals/define-built-in":245,"../internals/fails":260,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-get-prototype-of":313,"../internals/well-known-symbol":357}],298:[function(t,n,s){arguments[4][276][0].apply(s,arguments)},{dup:276}],299:[function(t,n,s){var o=t("../internals/to-length");n.exports=function(i){return o(i.length)}},{"../internals/to-length":343}],300:[function(t,n,s){var o=t("../internals/function-uncurry-this"),i=t("../internals/fails"),c=t("../internals/is-callable"),u=t("../internals/has-own-property"),l=t("../internals/descriptors"),d=t("../internals/function-name").CONFIGURABLE,h=t("../internals/inspect-source"),f=t("../internals/internal-state"),p=f.enforce,v=f.get,g=String,m=Object.defineProperty,b=o("".slice),y=o("".replace),S=o([].join),C=l&&!i(function(){return m(function(){},"length",{value:8}).length!==8}),L=String(String).split("String"),O=n.exports=function(H,z,q){b(g(z),0,7)==="Symbol("&&(z="["+y(g(z),/^Symbol\(([^)]*)\)/,"$1")+"]"),q&&q.getter&&(z="get "+z),q&&q.setter&&(z="set "+z),(!u(H,"name")||d&&H.name!==z)&&(l?m(H,"name",{value:z,configurable:!0}):H.name=z),C&&q&&u(q,"arity")&&H.length!==q.arity&&m(H,"length",{value:q.arity});try{q&&u(q,"constructor")&&q.constructor?l&&m(H,"prototype",{writable:!1}):H.prototype&&(H.prototype=void 0)}catch{}var D=p(H);return u(D,"source")||(D.source=S(L,typeof z=="string"?z:"")),H};Function.prototype.toString=O(function(){return c(this)&&v(this).source||h(this)},"toString")},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-name":265,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/inspect-source":281,"../internals/internal-state":282,"../internals/is-callable":285}],301:[function(t,n,s){var o=Math.ceil,i=Math.floor;n.exports=Math.trunc||function(c){var u=+c;return(u>0?i:o)(u)}},{}],302:[function(t,n,s){var o,i,c,u,l,d=t("../internals/global"),h=t("../internals/function-bind-context"),f=t("../internals/object-get-own-property-descriptor").f,p=t("../internals/task").set,v=t("../internals/queue"),g=t("../internals/engine-is-ios"),m=t("../internals/engine-is-ios-pebble"),b=t("../internals/engine-is-webos-webkit"),y=t("../internals/engine-is-node"),S=d.MutationObserver||d.WebKitMutationObserver,C=d.document,L=d.process,O=d.Promise,H=f(d,"queueMicrotask"),z=H&&H.value;if(!z){var q=new v,D=function(){var W,P;for(y&&(W=L.domain)&&W.exit();P=q.get();)try{P()}catch(I){throw q.head&&o(),I}W&&W.enter()};g||y||b||!S||!C?!m&&O&&O.resolve?((u=O.resolve(void 0)).constructor=O,l=h(u.then,u),o=function(){l(D)}):y?o=function(){L.nextTick(D)}:(p=h(p,d),o=function(){p(D)}):(i=!0,c=C.createTextNode(""),new S(D).observe(c,{characterData:!0}),o=function(){c.data=i=!i}),z=function(W){q.head||o(),q.add(W)}}n.exports=z},{"../internals/engine-is-ios":253,"../internals/engine-is-ios-pebble":252,"../internals/engine-is-node":254,"../internals/engine-is-webos-webkit":255,"../internals/function-bind-context":262,"../internals/global":274,"../internals/object-get-own-property-descriptor":309,"../internals/queue":328,"../internals/task":339}],303:[function(t,n,s){var o=t("../internals/a-callable"),i=TypeError,c=function(u){var l,d;this.promise=new u(function(h,f){if(l!==void 0||d!==void 0)throw new i("Bad Promise constructor");l=h,d=f}),this.resolve=o(l),this.reject=o(d)};n.exports.f=function(u){return new c(u)}},{"../internals/a-callable":222}],304:[function(t,n,s){var o=t("../internals/is-regexp"),i=TypeError;n.exports=function(c){if(o(c))throw new i("The method doesn't accept regular expressions");return c}},{"../internals/is-regexp":291}],305:[function(t,n,s){var o=t("../internals/descriptors"),i=t("../internals/function-uncurry-this"),c=t("../internals/function-call"),u=t("../internals/fails"),l=t("../internals/object-keys"),d=t("../internals/object-get-own-property-symbols"),h=t("../internals/object-property-is-enumerable"),f=t("../internals/to-object"),p=t("../internals/indexed-object"),v=Object.assign,g=Object.defineProperty,m=i([].concat);n.exports=!v||u(function(){if(o&&v({b:1},v(g({},"a",{enumerable:!0,get:function(){g(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var b={},y={},S=Symbol("assign detection");return b[S]=7,"abcdefghijklmnopqrst".split("").forEach(function(C){y[C]=C}),v({},b)[S]!==7||l(v({},y)).join("")!=="abcdefghijklmnopqrst"})?function(b,y){for(var S=f(b),C=arguments.length,L=1,O=d.f,H=h.f;C>L;)for(var z,q=p(arguments[L++]),D=O?m(l(q),O(q)):l(q),W=D.length,P=0;W>P;)z=D[P++],o&&!c(H,q,z)||(S[z]=q[z]);return S}:v},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/object-get-own-property-symbols":312,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-object":344}],306:[function(t,n,s){var o,i=t("../internals/an-object"),c=t("../internals/object-define-properties"),u=t("../internals/enum-bug-keys"),l=t("../internals/hidden-keys"),d=t("../internals/html"),h=t("../internals/document-create-element"),f=t("../internals/shared-key"),p=f("IE_PROTO"),v=function(){},g=function(y){return"<script>"+y+"<\/script>"},m=function(y){y.write(g("")),y.close();var S=y.parentWindow.Object;return y=null,S},b=function(){try{o=new ActiveXObject("htmlfile")}catch{}var y,S;b=typeof document<"u"?document.domain&&o?m(o):((S=h("iframe")).style.display="none",d.appendChild(S),S.src="javascript:",(y=S.contentWindow.document).open(),y.write(g("document.F=Object")),y.close(),y.F):m(o);for(var C=u.length;C--;)delete b.prototype[u[C]];return b()};l[p]=!0,n.exports=Object.create||function(y,S){var C;return y!==null?(v.prototype=i(y),C=new v,v.prototype=null,C[p]=y):C=b(),S===void 0?C:c.f(C,S)}},{"../internals/an-object":227,"../internals/document-create-element":249,"../internals/enum-bug-keys":258,"../internals/hidden-keys":276,"../internals/html":278,"../internals/object-define-properties":307,"../internals/shared-key":332}],307:[function(t,n,s){var o=t("../internals/descriptors"),i=t("../internals/v8-prototype-define-bug"),c=t("../internals/object-define-property"),u=t("../internals/an-object"),l=t("../internals/to-indexed-object"),d=t("../internals/object-keys");s.f=o&&!i?Object.defineProperties:function(h,f){u(h);for(var p,v=l(f),g=d(f),m=g.length,b=0;m>b;)c.f(h,p=g[b++],v[p]);return h}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/object-define-property":308,"../internals/object-keys":316,"../internals/to-indexed-object":341,"../internals/v8-prototype-define-bug":352}],308:[function(t,n,s){var o=t("../internals/descriptors"),i=t("../internals/ie8-dom-define"),c=t("../internals/v8-prototype-define-bug"),u=t("../internals/an-object"),l=t("../internals/to-property-key"),d=TypeError,h=Object.defineProperty,f=Object.getOwnPropertyDescriptor;s.f=o?c?function(p,v,g){if(u(p),v=l(v),u(g),typeof p=="function"&&v==="prototype"&&"value"in g&&"writable"in g&&!g.writable){var m=f(p,v);m&&m.writable&&(p[v]=g.value,g={configurable:"configurable"in g?g.configurable:m.configurable,enumerable:"enumerable"in g?g.enumerable:m.enumerable,writable:!1})}return h(p,v,g)}:h:function(p,v,g){if(u(p),v=l(v),u(g),i)try{return h(p,v,g)}catch{}if("get"in g||"set"in g)throw new d("Accessors not supported");return"value"in g&&(p[v]=g.value),p}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/ie8-dom-define":279,"../internals/to-property-key":346,"../internals/v8-prototype-define-bug":352}],309:[function(t,n,s){var o=t("../internals/descriptors"),i=t("../internals/function-call"),c=t("../internals/object-property-is-enumerable"),u=t("../internals/create-property-descriptor"),l=t("../internals/to-indexed-object"),d=t("../internals/to-property-key"),h=t("../internals/has-own-property"),f=t("../internals/ie8-dom-define"),p=Object.getOwnPropertyDescriptor;s.f=o?p:function(v,g){if(v=l(v),g=d(g),f)try{return p(v,g)}catch{}if(h(v,g))return u(!i(c.f,v,g),v[g])}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/function-call":264,"../internals/has-own-property":275,"../internals/ie8-dom-define":279,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341,"../internals/to-property-key":346}],310:[function(t,n,s){var o=t("../internals/classof-raw"),i=t("../internals/to-indexed-object"),c=t("../internals/object-get-own-property-names").f,u=t("../internals/array-slice-simple"),l=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];n.exports.f=function(d){return l&&o(d)==="Window"?function(h){try{return c(h)}catch{return u(l)}}(d):c(i(d))}},{"../internals/array-slice-simple":230,"../internals/classof-raw":235,"../internals/object-get-own-property-names":311,"../internals/to-indexed-object":341}],311:[function(t,n,s){var o=t("../internals/object-keys-internal"),i=t("../internals/enum-bug-keys").concat("length","prototype");s.f=Object.getOwnPropertyNames||function(c){return o(c,i)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],312:[function(t,n,s){s.f=Object.getOwnPropertySymbols},{}],313:[function(t,n,s){var o=t("../internals/has-own-property"),i=t("../internals/is-callable"),c=t("../internals/to-object"),u=t("../internals/shared-key"),l=t("../internals/correct-prototype-getter"),d=u("IE_PROTO"),h=Object,f=h.prototype;n.exports=l?h.getPrototypeOf:function(p){var v=c(p);if(o(v,d))return v[d];var g=v.constructor;return i(g)&&v instanceof g?g.prototype:v instanceof h?f:null}},{"../internals/correct-prototype-getter":239,"../internals/has-own-property":275,"../internals/is-callable":285,"../internals/shared-key":332,"../internals/to-object":344}],314:[function(t,n,s){var o=t("../internals/function-uncurry-this");n.exports=o({}.isPrototypeOf)},{"../internals/function-uncurry-this":268}],315:[function(t,n,s){var o=t("../internals/function-uncurry-this"),i=t("../internals/has-own-property"),c=t("../internals/to-indexed-object"),u=t("../internals/array-includes").indexOf,l=t("../internals/hidden-keys"),d=o([].push);n.exports=function(h,f){var p,v=c(h),g=0,m=[];for(p in v)!i(l,p)&&i(v,p)&&d(m,p);for(;f.length>g;)i(v,p=f[g++])&&(~u(m,p)||d(m,p));return m}},{"../internals/array-includes":228,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/to-indexed-object":341}],316:[function(t,n,s){var o=t("../internals/object-keys-internal"),i=t("../internals/enum-bug-keys");n.exports=Object.keys||function(c){return o(c,i)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],317:[function(t,n,s){var o={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,c=i&&!o.call({1:2},1);s.f=c?function(u){var l=i(this,u);return!!l&&l.enumerable}:o},{}],318:[function(t,n,s){var o=t("../internals/function-uncurry-this-accessor"),i=t("../internals/an-object"),c=t("../internals/a-possible-prototype");n.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var u,l=!1,d={};try{(u=o(Object.prototype,"__proto__","set"))(d,[]),l=d instanceof Array}catch{}return function(h,f){return i(h),c(f),l?u(h,f):h.__proto__=f,h}}():void 0)},{"../internals/a-possible-prototype":224,"../internals/an-object":227,"../internals/function-uncurry-this-accessor":266}],319:[function(t,n,s){var o=t("../internals/descriptors"),i=t("../internals/fails"),c=t("../internals/function-uncurry-this"),u=t("../internals/object-get-prototype-of"),l=t("../internals/object-keys"),d=t("../internals/to-indexed-object"),h=c(t("../internals/object-property-is-enumerable").f),f=c([].push),p=o&&i(function(){var g=Object.create(null);return g[2]=2,!h(g,2)}),v=function(g){return function(m){for(var b,y=d(m),S=l(y),C=p&&u(y)===null,L=S.length,O=0,H=[];L>O;)b=S[O++],o&&!(C?b in y:h(y,b))||f(H,g?[b,y[b]]:y[b]);return H}};n.exports={entries:v(!0),values:v(!1)}},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/object-get-prototype-of":313,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341}],320:[function(t,n,s){var o=t("../internals/function-call"),i=t("../internals/is-callable"),c=t("../internals/is-object"),u=TypeError;n.exports=function(l,d){var h,f;if(d==="string"&&i(h=l.toString)&&!c(f=o(h,l))||i(h=l.valueOf)&&!c(f=o(h,l))||d!=="string"&&i(h=l.toString)&&!c(f=o(h,l)))return f;throw new u("Can't convert object to primitive value")}},{"../internals/function-call":264,"../internals/is-callable":285,"../internals/is-object":289}],321:[function(t,n,s){var o=t("../internals/get-built-in"),i=t("../internals/function-uncurry-this"),c=t("../internals/object-get-own-property-names"),u=t("../internals/object-get-own-property-symbols"),l=t("../internals/an-object"),d=i([].concat);n.exports=o("Reflect","ownKeys")||function(h){var f=c.f(l(h)),p=u.f;return p?d(f,p(h)):f}},{"../internals/an-object":227,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-symbols":312}],322:[function(t,n,s){var o=t("../internals/global");n.exports=o},{"../internals/global":274}],323:[function(t,n,s){n.exports=function(o){try{return{error:!1,value:o()}}catch(i){return{error:!0,value:i}}}},{}],324:[function(t,n,s){var o=t("../internals/global"),i=t("../internals/promise-native-constructor"),c=t("../internals/is-callable"),u=t("../internals/is-forced"),l=t("../internals/inspect-source"),d=t("../internals/well-known-symbol"),h=t("../internals/engine-is-browser"),f=t("../internals/engine-is-deno"),p=t("../internals/is-pure"),v=t("../internals/engine-v8-version"),g=i&&i.prototype,m=d("species"),b=!1,y=c(o.PromiseRejectionEvent),S=u("Promise",function(){var C=l(i),L=C!==String(i);if(!L&&v===66||p&&(!g.catch||!g.finally))return!0;if(!v||v<51||!/native code/.test(C)){var O=new i(function(z){z(1)}),H=function(z){z(function(){},function(){})};if((O.constructor={})[m]=H,!(b=O.then(function(){})instanceof H))return!0}return!L&&(h||f)&&!y});n.exports={CONSTRUCTOR:S,REJECTION_EVENT:y,SUBCLASSING:b}},{"../internals/engine-is-browser":250,"../internals/engine-is-deno":251,"../internals/engine-v8-version":257,"../internals/global":274,"../internals/inspect-source":281,"../internals/is-callable":285,"../internals/is-forced":287,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/well-known-symbol":357}],325:[function(t,n,s){var o=t("../internals/global");n.exports=o.Promise},{"../internals/global":274}],326:[function(t,n,s){var o=t("../internals/an-object"),i=t("../internals/is-object"),c=t("../internals/new-promise-capability");n.exports=function(u,l){if(o(u),i(l)&&l.constructor===u)return l;var d=c.f(u);return(0,d.resolve)(l),d.promise}},{"../internals/an-object":227,"../internals/is-object":289,"../internals/new-promise-capability":303}],327:[function(t,n,s){var o=t("../internals/promise-native-constructor"),i=t("../internals/check-correctness-of-iteration"),c=t("../internals/promise-constructor-detection").CONSTRUCTOR;n.exports=c||!i(function(u){o.all(u).then(void 0,function(){})})},{"../internals/check-correctness-of-iteration":234,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],328:[function(t,n,s){var o=function(){this.head=null,this.tail=null};o.prototype={add:function(i){var c={item:i,next:null},u=this.tail;u?u.next=c:this.head=c,this.tail=c},get:function(){var i=this.head;if(i)return(this.head=i.next)===null&&(this.tail=null),i.item}},n.exports=o},{}],329:[function(t,n,s){var o=t("../internals/is-null-or-undefined"),i=TypeError;n.exports=function(c){if(o(c))throw new i("Can't call method on "+c);return c}},{"../internals/is-null-or-undefined":288}],330:[function(t,n,s){var o=t("../internals/get-built-in"),i=t("../internals/define-built-in-accessor"),c=t("../internals/well-known-symbol"),u=t("../internals/descriptors"),l=c("species");n.exports=function(d){var h=o(d);u&&h&&!h[l]&&i(h,l,{configurable:!0,get:function(){return this}})}},{"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],331:[function(t,n,s){var o=t("../internals/object-define-property").f,i=t("../internals/has-own-property"),c=t("../internals/well-known-symbol")("toStringTag");n.exports=function(u,l,d){u&&!d&&(u=u.prototype),u&&!i(u,c)&&o(u,c,{configurable:!0,value:l})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],332:[function(t,n,s){var o=t("../internals/shared"),i=t("../internals/uid"),c=o("keys");n.exports=function(u){return c[u]||(c[u]=i(u))}},{"../internals/shared":334,"../internals/uid":350}],333:[function(t,n,s){var o=t("../internals/global"),i=t("../internals/define-global-property"),c=o["__core-js_shared__"]||i("__core-js_shared__",{});n.exports=c},{"../internals/define-global-property":246,"../internals/global":274}],334:[function(t,n,s){var o=t("../internals/is-pure"),i=t("../internals/shared-store");(n.exports=function(c,u){return i[c]||(i[c]=u!==void 0?u:{})})("versions",[]).push({version:"3.33.0",mode:o?"pure":"global",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.0/LICENSE",source:"https://github.com/zloirock/core-js"})},{"../internals/is-pure":290,"../internals/shared-store":333}],335:[function(t,n,s){var o=t("../internals/an-object"),i=t("../internals/a-constructor"),c=t("../internals/is-null-or-undefined"),u=t("../internals/well-known-symbol")("species");n.exports=function(l,d){var h,f=o(l).constructor;return f===void 0||c(h=o(f)[u])?d:i(h)}},{"../internals/a-constructor":223,"../internals/an-object":227,"../internals/is-null-or-undefined":288,"../internals/well-known-symbol":357}],336:[function(t,n,s){var o=t("../internals/engine-v8-version"),i=t("../internals/fails"),c=t("../internals/global").String;n.exports=!!Object.getOwnPropertySymbols&&!i(function(){var u=Symbol("symbol detection");return!c(u)||!(Object(u)instanceof Symbol)||!Symbol.sham&&o&&o<41})},{"../internals/engine-v8-version":257,"../internals/fails":260,"../internals/global":274}],337:[function(t,n,s){var o=t("../internals/function-call"),i=t("../internals/get-built-in"),c=t("../internals/well-known-symbol"),u=t("../internals/define-built-in");n.exports=function(){var l=i("Symbol"),d=l&&l.prototype,h=d&&d.valueOf,f=c("toPrimitive");d&&!d[f]&&u(d,f,function(p){return o(h,this)},{arity:1})}},{"../internals/define-built-in":245,"../internals/function-call":264,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],338:[function(t,n,s){var o=t("../internals/symbol-constructor-detection");n.exports=o&&!!Symbol.for&&!!Symbol.keyFor},{"../internals/symbol-constructor-detection":336}],339:[function(t,n,s){var o,i,c,u,l=t("../internals/global"),d=t("../internals/function-apply"),h=t("../internals/function-bind-context"),f=t("../internals/is-callable"),p=t("../internals/has-own-property"),v=t("../internals/fails"),g=t("../internals/html"),m=t("../internals/array-slice"),b=t("../internals/document-create-element"),y=t("../internals/validate-arguments-length"),S=t("../internals/engine-is-ios"),C=t("../internals/engine-is-node"),L=l.setImmediate,O=l.clearImmediate,H=l.process,z=l.Dispatch,q=l.Function,D=l.MessageChannel,W=l.String,P=0,I={};v(function(){o=l.location});var U=function(j){if(p(I,j)){var A=I[j];delete I[j],A()}},k=function(j){return function(){U(j)}},_=function(j){U(j.data)},R=function(j){l.postMessage(W(j),o.protocol+"//"+o.host)};L&&O||(L=function(j){y(arguments.length,1);var A=f(j)?j:q(j),N=m(arguments,1);return I[++P]=function(){d(A,void 0,N)},i(P),P},O=function(j){delete I[j]},C?i=function(j){H.nextTick(k(j))}:z&&z.now?i=function(j){z.now(k(j))}:D&&!S?(u=(c=new D).port2,c.port1.onmessage=_,i=h(u.postMessage,u)):l.addEventListener&&f(l.postMessage)&&!l.importScripts&&o&&o.protocol!=="file:"&&!v(R)?(i=R,l.addEventListener("message",_,!1)):i="onreadystatechange"in b("script")?function(j){g.appendChild(b("script")).onreadystatechange=function(){g.removeChild(this),U(j)}}:function(j){setTimeout(k(j),0)}),n.exports={set:L,clear:O}},{"../internals/array-slice":231,"../internals/document-create-element":249,"../internals/engine-is-ios":253,"../internals/engine-is-node":254,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-bind-context":262,"../internals/global":274,"../internals/has-own-property":275,"../internals/html":278,"../internals/is-callable":285,"../internals/validate-arguments-length":353}],340:[function(t,n,s){var o=t("../internals/to-integer-or-infinity"),i=Math.max,c=Math.min;n.exports=function(u,l){var d=o(u);return d<0?i(d+l,0):c(d,l)}},{"../internals/to-integer-or-infinity":342}],341:[function(t,n,s){var o=t("../internals/indexed-object"),i=t("../internals/require-object-coercible");n.exports=function(c){return o(i(c))}},{"../internals/indexed-object":280,"../internals/require-object-coercible":329}],342:[function(t,n,s){var o=t("../internals/math-trunc");n.exports=function(i){var c=+i;return c!=c||c===0?0:o(c)}},{"../internals/math-trunc":301}],343:[function(t,n,s){var o=t("../internals/to-integer-or-infinity"),i=Math.min;n.exports=function(c){return c>0?i(o(c),9007199254740991):0}},{"../internals/to-integer-or-infinity":342}],344:[function(t,n,s){var o=t("../internals/require-object-coercible"),i=Object;n.exports=function(c){return i(o(c))}},{"../internals/require-object-coercible":329}],345:[function(t,n,s){var o=t("../internals/function-call"),i=t("../internals/is-object"),c=t("../internals/is-symbol"),u=t("../internals/get-method"),l=t("../internals/ordinary-to-primitive"),d=t("../internals/well-known-symbol"),h=TypeError,f=d("toPrimitive");n.exports=function(p,v){if(!i(p)||c(p))return p;var g,m=u(p,f);if(m){if(v===void 0&&(v="default"),g=o(m,p,v),!i(g)||c(g))return g;throw new h("Can't convert object to primitive value")}return v===void 0&&(v="number"),l(p,v)}},{"../internals/function-call":264,"../internals/get-method":273,"../internals/is-object":289,"../internals/is-symbol":292,"../internals/ordinary-to-primitive":320,"../internals/well-known-symbol":357}],346:[function(t,n,s){var o=t("../internals/to-primitive"),i=t("../internals/is-symbol");n.exports=function(c){var u=o(c,"string");return i(u)?u:u+""}},{"../internals/is-symbol":292,"../internals/to-primitive":345}],347:[function(t,n,s){var o={};o[t("../internals/well-known-symbol")("toStringTag")]="z",n.exports=String(o)==="[object z]"},{"../internals/well-known-symbol":357}],348:[function(t,n,s){var o=t("../internals/classof"),i=String;n.exports=function(c){if(o(c)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return i(c)}},{"../internals/classof":236}],349:[function(t,n,s){var o=String;n.exports=function(i){try{return o(i)}catch{return"Object"}}},{}],350:[function(t,n,s){var o=t("../internals/function-uncurry-this"),i=0,c=Math.random(),u=o(1 .toString);n.exports=function(l){return"Symbol("+(l===void 0?"":l)+")_"+u(++i+c,36)}},{"../internals/function-uncurry-this":268}],351:[function(t,n,s){var o=t("../internals/symbol-constructor-detection");n.exports=o&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},{"../internals/symbol-constructor-detection":336}],352:[function(t,n,s){var o=t("../internals/descriptors"),i=t("../internals/fails");n.exports=o&&i(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})},{"../internals/descriptors":247,"../internals/fails":260}],353:[function(t,n,s){var o=TypeError;n.exports=function(i,c){if(i<c)throw new o("Not enough arguments");return i}},{}],354:[function(t,n,s){var o=t("../internals/global"),i=t("../internals/is-callable"),c=o.WeakMap;n.exports=i(c)&&/native code/.test(String(c))},{"../internals/global":274,"../internals/is-callable":285}],355:[function(t,n,s){var o=t("../internals/path"),i=t("../internals/has-own-property"),c=t("../internals/well-known-symbol-wrapped"),u=t("../internals/object-define-property").f;n.exports=function(l){var d=o.Symbol||(o.Symbol={});i(d,l)||u(d,l,{value:c.f(l)})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/path":322,"../internals/well-known-symbol-wrapped":356}],356:[function(t,n,s){var o=t("../internals/well-known-symbol");s.f=o},{"../internals/well-known-symbol":357}],357:[function(t,n,s){var o=t("../internals/global"),i=t("../internals/shared"),c=t("../internals/has-own-property"),u=t("../internals/uid"),l=t("../internals/symbol-constructor-detection"),d=t("../internals/use-symbol-as-uid"),h=o.Symbol,f=i("wks"),p=d?h.for||h:h&&h.withoutSetter||u;n.exports=function(v){return c(f,v)||(f[v]=l&&c(h,v)?h[v]:p("Symbol."+v)),f[v]}},{"../internals/global":274,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-constructor-detection":336,"../internals/uid":350,"../internals/use-symbol-as-uid":351}],358:[function(t,n,s){var o=t("../internals/export"),i=t("../internals/array-iteration").findIndex,c=t("../internals/add-to-unscopables"),u=!0;"findIndex"in[]&&Array(1).findIndex(function(){u=!1}),o({target:"Array",proto:!0,forced:u},{findIndex:function(l){return i(this,l,arguments.length>1?arguments[1]:void 0)}}),c("findIndex")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],359:[function(t,n,s){var o=t("../internals/export"),i=t("../internals/array-iteration").find,c=t("../internals/add-to-unscopables"),u=!0;"find"in[]&&Array(1).find(function(){u=!1}),o({target:"Array",proto:!0,forced:u},{find:function(l){return i(this,l,arguments.length>1?arguments[1]:void 0)}}),c("find")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],360:[function(t,n,s){var o=t("../internals/export"),i=t("../internals/array-includes").includes,c=t("../internals/fails"),u=t("../internals/add-to-unscopables");o({target:"Array",proto:!0,forced:c(function(){return!Array(1).includes()})},{includes:function(l){return i(this,l,arguments.length>1?arguments[1]:void 0)}}),u("includes")},{"../internals/add-to-unscopables":225,"../internals/array-includes":228,"../internals/export":259,"../internals/fails":260}],361:[function(t,n,s){var o=t("../internals/to-indexed-object"),i=t("../internals/add-to-unscopables"),c=t("../internals/iterators"),u=t("../internals/internal-state"),l=t("../internals/object-define-property").f,d=t("../internals/iterator-define"),h=t("../internals/create-iter-result-object"),f=t("../internals/is-pure"),p=t("../internals/descriptors"),v=u.set,g=u.getterFor("Array Iterator");n.exports=d(Array,"Array",function(b,y){v(this,{type:"Array Iterator",target:o(b),index:0,kind:y})},function(){var b=g(this),y=b.target,S=b.kind,C=b.index++;if(!y||C>=y.length)return b.target=void 0,h(void 0,!0);switch(S){case"keys":return h(C,!1);case"values":return h(y[C],!1)}return h([C,y[C]],!1)},"values");var m=c.Arguments=c.Array;if(i("keys"),i("values"),i("entries"),!f&&p&&m.name!=="values")try{l(m,"name",{value:"values"})}catch{}},{"../internals/add-to-unscopables":225,"../internals/create-iter-result-object":240,"../internals/descriptors":247,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/iterator-define":296,"../internals/iterators":298,"../internals/object-define-property":308,"../internals/to-indexed-object":341}],362:[function(t,n,s){var o=t("../internals/export"),i=t("../internals/get-built-in"),c=t("../internals/function-apply"),u=t("../internals/function-call"),l=t("../internals/function-uncurry-this"),d=t("../internals/fails"),h=t("../internals/is-callable"),f=t("../internals/is-symbol"),p=t("../internals/array-slice"),v=t("../internals/get-json-replacer-function"),g=t("../internals/symbol-constructor-detection"),m=String,b=i("JSON","stringify"),y=l(/./.exec),S=l("".charAt),C=l("".charCodeAt),L=l("".replace),O=l(1 .toString),H=/[\uD800-\uDFFF]/g,z=/^[\uD800-\uDBFF]$/,q=/^[\uDC00-\uDFFF]$/,D=!g||d(function(){var U=i("Symbol")("stringify detection");return b([U])!=="[null]"||b({a:U})!=="{}"||b(Object(U))!=="{}"}),W=d(function(){return b("\uDF06\uD834")!=='"\\udf06\\ud834"'||b("\uDEAD")!=='"\\udead"'}),P=function(U,k){var _=p(arguments),R=v(k);if(h(R)||U!==void 0&&!f(U))return _[1]=function(j,A){if(h(R)&&(A=u(R,this,m(j),A)),!f(A))return A},c(b,null,_)},I=function(U,k,_){var R=S(_,k-1),j=S(_,k+1);return y(z,U)&&!y(q,j)||y(q,U)&&!y(z,R)?"\\u"+O(C(U,0),16):U};b&&o({target:"JSON",stat:!0,arity:3,forced:D||W},{stringify:function(U,k,_){var R=p(arguments),j=c(D?P:b,null,R);return W&&typeof j=="string"?L(j,H,I):j}})},{"../internals/array-slice":231,"../internals/export":259,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/get-json-replacer-function":272,"../internals/is-callable":285,"../internals/is-symbol":292,"../internals/symbol-constructor-detection":336}],363:[function(t,n,s){t("../internals/export")({target:"Number",stat:!0},{isNaN:function(o){return o!=o}})},{"../internals/export":259}],364:[function(t,n,s){var o=t("../internals/export"),i=t("../internals/object-assign");o({target:"Object",stat:!0,arity:2,forced:Object.assign!==i},{assign:i})},{"../internals/export":259,"../internals/object-assign":305}],365:[function(t,n,s){var o=t("../internals/export"),i=t("../internals/symbol-constructor-detection"),c=t("../internals/fails"),u=t("../internals/object-get-own-property-symbols"),l=t("../internals/to-object");o({target:"Object",stat:!0,forced:!i||c(function(){u.f(1)})},{getOwnPropertySymbols:function(d){var h=u.f;return h?h(l(d)):[]}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-get-own-property-symbols":312,"../internals/symbol-constructor-detection":336,"../internals/to-object":344}],366:[function(t,n,s){var o=t("../internals/export"),i=t("../internals/to-object"),c=t("../internals/object-keys");o({target:"Object",stat:!0,forced:t("../internals/fails")(function(){c(1)})},{keys:function(u){return c(i(u))}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-keys":316,"../internals/to-object":344}],367:[function(t,n,s){var o=t("../internals/export"),i=t("../internals/object-to-array").values;o({target:"Object",stat:!0},{values:function(c){return i(c)}})},{"../internals/export":259,"../internals/object-to-array":319}],368:[function(t,n,s){var o=t("../internals/export"),i=t("../internals/function-call"),c=t("../internals/a-callable"),u=t("../internals/new-promise-capability"),l=t("../internals/perform"),d=t("../internals/iterate");o({target:"Promise",stat:!0,forced:t("../internals/promise-statics-incorrect-iteration")},{all:function(h){var f=this,p=u.f(f),v=p.resolve,g=p.reject,m=l(function(){var b=c(f.resolve),y=[],S=0,C=1;d(h,function(L){var O=S++,H=!1;C++,i(b,f,L).then(function(z){H||(H=!0,y[O]=z,--C||v(y))},g)}),--C||v(y)});return m.error&&g(m.value),p.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],369:[function(t,n,s){var o=t("../internals/export"),i=t("../internals/is-pure"),c=t("../internals/promise-constructor-detection").CONSTRUCTOR,u=t("../internals/promise-native-constructor"),l=t("../internals/get-built-in"),d=t("../internals/is-callable"),h=t("../internals/define-built-in"),f=u&&u.prototype;if(o({target:"Promise",proto:!0,forced:c,real:!0},{catch:function(v){return this.then(void 0,v)}}),!i&&d(u)){var p=l("Promise").prototype.catch;f.catch!==p&&h(f,"catch",p,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],370:[function(t,n,s){var o,i,c,u=t("../internals/export"),l=t("../internals/is-pure"),d=t("../internals/engine-is-node"),h=t("../internals/global"),f=t("../internals/function-call"),p=t("../internals/define-built-in"),v=t("../internals/object-set-prototype-of"),g=t("../internals/set-to-string-tag"),m=t("../internals/set-species"),b=t("../internals/a-callable"),y=t("../internals/is-callable"),S=t("../internals/is-object"),C=t("../internals/an-instance"),L=t("../internals/species-constructor"),O=t("../internals/task").set,H=t("../internals/microtask"),z=t("../internals/host-report-errors"),q=t("../internals/perform"),D=t("../internals/queue"),W=t("../internals/internal-state"),P=t("../internals/promise-native-constructor"),I=t("../internals/promise-constructor-detection"),U=t("../internals/new-promise-capability"),k=I.CONSTRUCTOR,_=I.REJECTION_EVENT,R=I.SUBCLASSING,j=W.getterFor("Promise"),A=W.set,N=P&&P.prototype,V=P,M=N,Z=h.TypeError,J=h.document,re=h.process,X=U.f,ne=X,Y=!!(J&&J.createEvent&&h.dispatchEvent),K=function(Te){var pe;return!(!S(Te)||!y(pe=Te.then))&&pe},ee=function(Te,pe){var ye,ge,De,He=pe.value,Xe=pe.state===1,at=Xe?Te.ok:Te.fail,dt=Te.resolve,wt=Te.reject,$t=Te.domain;try{at?(Xe||(pe.rejection===2&&ve(pe),pe.rejection=1),at===!0?ye=He:($t&&$t.enter(),ye=at(He),$t&&($t.exit(),De=!0)),ye===Te.promise?wt(new Z("Promise-chain cycle")):(ge=K(ye))?f(ge,ye,dt,wt):dt(ye)):wt(He)}catch(Bt){$t&&!De&&$t.exit(),wt(Bt)}},ue=function(Te,pe){Te.notified||(Te.notified=!0,H(function(){for(var ye,ge=Te.reactions;ye=ge.get();)ee(ye,Te);Te.notified=!1,pe&&!Te.rejection&&ce(Te)}))},se=function(Te,pe,ye){var ge,De;Y?((ge=J.createEvent("Event")).promise=pe,ge.reason=ye,ge.initEvent(Te,!1,!0),h.dispatchEvent(ge)):ge={promise:pe,reason:ye},!_&&(De=h["on"+Te])?De(ge):Te==="unhandledrejection"&&z("Unhandled promise rejection",ye)},ce=function(Te){f(O,h,function(){var pe,ye=Te.facade,ge=Te.value;if(fe(Te)&&(pe=q(function(){d?re.emit("unhandledRejection",ge,ye):se("unhandledrejection",ye,ge)}),Te.rejection=d||fe(Te)?2:1,pe.error))throw pe.value})},fe=function(Te){return Te.rejection!==1&&!Te.parent},ve=function(Te){f(O,h,function(){var pe=Te.facade;d?re.emit("rejectionHandled",pe):se("rejectionhandled",pe,Te.value)})},_e=function(Te,pe,ye){return function(ge){Te(pe,ge,ye)}},le=function(Te,pe,ye){Te.done||(Te.done=!0,ye&&(Te=ye),Te.value=pe,Te.state=2,ue(Te,!0))},ke=function(Te,pe,ye){if(!Te.done){Te.done=!0,ye&&(Te=ye);try{if(Te.facade===pe)throw new Z("Promise can't be resolved itself");var ge=K(pe);ge?H(function(){var De={done:!1};try{f(ge,pe,_e(ke,De,Te),_e(le,De,Te))}catch(He){le(De,He,Te)}}):(Te.value=pe,Te.state=1,ue(Te,!1))}catch(De){le({done:!1},De,Te)}}};if(k&&(M=(V=function(Te){C(this,M),b(Te),f(o,this);var pe=j(this);try{Te(_e(ke,pe),_e(le,pe))}catch(ye){le(pe,ye)}}).prototype,(o=function(Te){A(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new D,rejection:!1,state:0,value:void 0})}).prototype=p(M,"then",function(Te,pe){var ye=j(this),ge=X(L(this,V));return ye.parent=!0,ge.ok=!y(Te)||Te,ge.fail=y(pe)&&pe,ge.domain=d?re.domain:void 0,ye.state===0?ye.reactions.add(ge):H(function(){ee(ge,ye)}),ge.promise}),i=function(){var Te=new o,pe=j(Te);this.promise=Te,this.resolve=_e(ke,pe),this.reject=_e(le,pe)},U.f=X=function(Te){return Te===V||Te===void 0?new i(Te):ne(Te)},!l&&y(P)&&N!==Object.prototype)){c=N.then,R||p(N,"then",function(Te,pe){var ye=this;return new V(function(ge,De){f(c,ye,ge,De)}).then(Te,pe)},{unsafe:!0});try{delete N.constructor}catch{}v&&v(N,M)}u({global:!0,constructor:!0,wrap:!0,forced:k},{Promise:V}),g(V,"Promise",!1,!0),m("Promise")},{"../internals/a-callable":222,"../internals/an-instance":226,"../internals/define-built-in":245,"../internals/engine-is-node":254,"../internals/export":259,"../internals/function-call":264,"../internals/global":274,"../internals/host-report-errors":277,"../internals/internal-state":282,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/microtask":302,"../internals/new-promise-capability":303,"../internals/object-set-prototype-of":318,"../internals/perform":323,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/queue":328,"../internals/set-species":330,"../internals/set-to-string-tag":331,"../internals/species-constructor":335,"../internals/task":339}],371:[function(t,n,s){var o=t("../internals/export"),i=t("../internals/is-pure"),c=t("../internals/promise-native-constructor"),u=t("../internals/fails"),l=t("../internals/get-built-in"),d=t("../internals/is-callable"),h=t("../internals/species-constructor"),f=t("../internals/promise-resolve"),p=t("../internals/define-built-in"),v=c&&c.prototype;if(o({target:"Promise",proto:!0,real:!0,forced:!!c&&u(function(){v.finally.call({then:function(){}},function(){})})},{finally:function(m){var b=h(this,l("Promise")),y=d(m);return this.then(y?function(S){return f(b,m()).then(function(){return S})}:m,y?function(S){return f(b,m()).then(function(){throw S})}:m)}}),!i&&d(c)){var g=l("Promise").prototype.finally;v.finally!==g&&p(v,"finally",g,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/fails":260,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326,"../internals/species-constructor":335}],372:[function(t,n,s){t("../modules/es.promise.constructor"),t("../modules/es.promise.all"),t("../modules/es.promise.catch"),t("../modules/es.promise.race"),t("../modules/es.promise.reject"),t("../modules/es.promise.resolve")},{"../modules/es.promise.all":368,"../modules/es.promise.catch":369,"../modules/es.promise.constructor":370,"../modules/es.promise.race":373,"../modules/es.promise.reject":374,"../modules/es.promise.resolve":375}],373:[function(t,n,s){var o=t("../internals/export"),i=t("../internals/function-call"),c=t("../internals/a-callable"),u=t("../internals/new-promise-capability"),l=t("../internals/perform"),d=t("../internals/iterate");o({target:"Promise",stat:!0,forced:t("../internals/promise-statics-incorrect-iteration")},{race:function(h){var f=this,p=u.f(f),v=p.reject,g=l(function(){var m=c(f.resolve);d(h,function(b){i(m,f,b).then(p.resolve,v)})});return g.error&&v(g.value),p.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],374:[function(t,n,s){var o=t("../internals/export"),i=t("../internals/function-call"),c=t("../internals/new-promise-capability");o({target:"Promise",stat:!0,forced:t("../internals/promise-constructor-detection").CONSTRUCTOR},{reject:function(u){var l=c.f(this);return i(l.reject,void 0,u),l.promise}})},{"../internals/export":259,"../internals/function-call":264,"../internals/new-promise-capability":303,"../internals/promise-constructor-detection":324}],375:[function(t,n,s){var o=t("../internals/export"),i=t("../internals/get-built-in"),c=t("../internals/is-pure"),u=t("../internals/promise-native-constructor"),l=t("../internals/promise-constructor-detection").CONSTRUCTOR,d=t("../internals/promise-resolve"),h=i("Promise"),f=c&&!l;o({target:"Promise",stat:!0,forced:c||l},{resolve:function(p){return d(f&&this===h?u:this,p)}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326}],376:[function(t,n,s){var o=t("../internals/export"),i=t("../internals/function-uncurry-this"),c=t("../internals/to-absolute-index"),u=RangeError,l=String.fromCharCode,d=String.fromCodePoint,h=i([].join);o({target:"String",stat:!0,arity:1,forced:!!d&&d.length!==1},{fromCodePoint:function(f){for(var p,v=[],g=arguments.length,m=0;g>m;){if(p=+arguments[m++],c(p,1114111)!==p)throw new u(p+" is not a valid code point");v[m]=p<65536?l(p):l(55296+((p-=65536)>>10),p%1024+56320)}return h(v,"")}})},{"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/to-absolute-index":340}],377:[function(t,n,s){var o=t("../internals/export"),i=t("../internals/function-uncurry-this"),c=t("../internals/not-a-regexp"),u=t("../internals/require-object-coercible"),l=t("../internals/to-string"),d=t("../internals/correct-is-regexp-logic"),h=i("".indexOf);o({target:"String",proto:!0,forced:!d("includes")},{includes:function(f){return!!~h(l(u(this)),l(c(f)),arguments.length>1?arguments[1]:void 0)}})},{"../internals/correct-is-regexp-logic":238,"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/not-a-regexp":304,"../internals/require-object-coercible":329,"../internals/to-string":348}],378:[function(t,n,s){t("../internals/well-known-symbol-define")("asyncIterator")},{"../internals/well-known-symbol-define":355}],379:[function(t,n,s){var o=t("../internals/export"),i=t("../internals/global"),c=t("../internals/function-call"),u=t("../internals/function-uncurry-this"),l=t("../internals/is-pure"),d=t("../internals/descriptors"),h=t("../internals/symbol-constructor-detection"),f=t("../internals/fails"),p=t("../internals/has-own-property"),v=t("../internals/object-is-prototype-of"),g=t("../internals/an-object"),m=t("../internals/to-indexed-object"),b=t("../internals/to-property-key"),y=t("../internals/to-string"),S=t("../internals/create-property-descriptor"),C=t("../internals/object-create"),L=t("../internals/object-keys"),O=t("../internals/object-get-own-property-names"),H=t("../internals/object-get-own-property-names-external"),z=t("../internals/object-get-own-property-symbols"),q=t("../internals/object-get-own-property-descriptor"),D=t("../internals/object-define-property"),W=t("../internals/object-define-properties"),P=t("../internals/object-property-is-enumerable"),I=t("../internals/define-built-in"),U=t("../internals/define-built-in-accessor"),k=t("../internals/shared"),_=t("../internals/shared-key"),R=t("../internals/hidden-keys"),j=t("../internals/uid"),A=t("../internals/well-known-symbol"),N=t("../internals/well-known-symbol-wrapped"),V=t("../internals/well-known-symbol-define"),M=t("../internals/symbol-define-to-primitive"),Z=t("../internals/set-to-string-tag"),J=t("../internals/internal-state"),re=t("../internals/array-iteration").forEach,X=_("hidden"),ne=J.set,Y=J.getterFor("Symbol"),K=Object.prototype,ee=i.Symbol,ue=ee&&ee.prototype,se=i.RangeError,ce=i.TypeError,fe=i.QObject,ve=q.f,_e=D.f,le=H.f,ke=P.f,Te=u([].push),pe=k("symbols"),ye=k("op-symbols"),ge=k("wks"),De=!fe||!fe.prototype||!fe.prototype.findChild,He=function(Me,tt,Ze){var St=ve(K,tt);St&&delete K[tt],_e(Me,tt,Ze),St&&Me!==K&&_e(K,tt,St)},Xe=d&&f(function(){return C(_e({},"a",{get:function(){return _e(this,"a",{value:7}).a}})).a!==7})?He:_e,at=function(Me,tt){var Ze=pe[Me]=C(ue);return ne(Ze,{type:"Symbol",tag:Me,description:tt}),d||(Ze.description=tt),Ze},dt=function(Me,tt,Ze){Me===K&&dt(ye,tt,Ze),g(Me);var St=b(tt);return g(Ze),p(pe,St)?(Ze.enumerable?(p(Me,X)&&Me[X][St]&&(Me[X][St]=!1),Ze=C(Ze,{enumerable:S(0,!1)})):(p(Me,X)||_e(Me,X,S(1,{})),Me[X][St]=!0),Xe(Me,St,Ze)):_e(Me,St,Ze)},wt=function(Me,tt){g(Me);var Ze=m(tt),St=L(Ze).concat(tr(Ze));return re(St,function(et){d&&!c($t,Ze,et)||dt(Me,et,Ze[et])}),Me},$t=function(Me){var tt=b(Me),Ze=c(ke,this,tt);return!(this===K&&p(pe,tt)&&!p(ye,tt))&&(!(Ze||!p(this,tt)||!p(pe,tt)||p(this,X)&&this[X][tt])||Ze)},Bt=function(Me,tt){var Ze=m(Me),St=b(tt);if(Ze!==K||!p(pe,St)||p(ye,St)){var et=ve(Ze,St);return!et||!p(pe,St)||p(Ze,X)&&Ze[X][St]||(et.enumerable=!0),et}},ft=function(Me){var tt=le(m(Me)),Ze=[];return re(tt,function(St){p(pe,St)||p(R,St)||Te(Ze,St)}),Ze},tr=function(Me){var tt=Me===K,Ze=le(tt?ye:m(Me)),St=[];return re(Ze,function(et){!p(pe,et)||tt&&!p(K,et)||Te(St,pe[et])}),St};h||(I(ue=(ee=function(){if(v(ue,this))throw new ce("Symbol is not a constructor");var Me=arguments.length&&arguments[0]!==void 0?y(arguments[0]):void 0,tt=j(Me),Ze=function(St){this===K&&c(Ze,ye,St),p(this,X)&&p(this[X],tt)&&(this[X][tt]=!1);var et=S(1,St);try{Xe(this,tt,et)}catch(Ht){if(!(Ht instanceof se))throw Ht;He(this,tt,et)}};return d&&De&&Xe(K,tt,{configurable:!0,set:Ze}),at(tt,Me)}).prototype,"toString",function(){return Y(this).tag}),I(ee,"withoutSetter",function(Me){return at(j(Me),Me)}),P.f=$t,D.f=dt,W.f=wt,q.f=Bt,O.f=H.f=ft,z.f=tr,N.f=function(Me){return at(A(Me),Me)},d&&(U(ue,"description",{configurable:!0,get:function(){return Y(this).description}}),l||I(K,"propertyIsEnumerable",$t,{unsafe:!0}))),o({global:!0,constructor:!0,wrap:!0,forced:!h,sham:!h},{Symbol:ee}),re(L(ge),function(Me){V(Me)}),o({target:"Symbol",stat:!0,forced:!h},{useSetter:function(){De=!0},useSimple:function(){De=!1}}),o({target:"Object",stat:!0,forced:!h,sham:!d},{create:function(Me,tt){return tt===void 0?C(Me):wt(C(Me),tt)},defineProperty:dt,defineProperties:wt,getOwnPropertyDescriptor:Bt}),o({target:"Object",stat:!0,forced:!h},{getOwnPropertyNames:ft}),M(),Z(ee,"Symbol"),R[X]=!0},{"../internals/an-object":227,"../internals/array-iteration":229,"../internals/create-property-descriptor":242,"../internals/define-built-in":245,"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/export":259,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-define-properties":307,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-names-external":310,"../internals/object-get-own-property-symbols":312,"../internals/object-is-prototype-of":314,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/set-to-string-tag":331,"../internals/shared":334,"../internals/shared-key":332,"../internals/symbol-constructor-detection":336,"../internals/symbol-define-to-primitive":337,"../internals/to-indexed-object":341,"../internals/to-property-key":346,"../internals/to-string":348,"../internals/uid":350,"../internals/well-known-symbol":357,"../internals/well-known-symbol-define":355,"../internals/well-known-symbol-wrapped":356}],380:[function(t,n,s){var o=t("../internals/export"),i=t("../internals/get-built-in"),c=t("../internals/has-own-property"),u=t("../internals/to-string"),l=t("../internals/shared"),d=t("../internals/symbol-registry-detection"),h=l("string-to-symbol-registry"),f=l("symbol-to-string-registry");o({target:"Symbol",stat:!0,forced:!d},{for:function(p){var v=u(p);if(c(h,v))return h[v];var g=i("Symbol")(v);return h[v]=g,f[g]=v,g}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/to-string":348}],381:[function(t,n,s){t("../modules/es.symbol.constructor"),t("../modules/es.symbol.for"),t("../modules/es.symbol.key-for"),t("../modules/es.json.stringify"),t("../modules/es.object.get-own-property-symbols")},{"../modules/es.json.stringify":362,"../modules/es.object.get-own-property-symbols":365,"../modules/es.symbol.constructor":379,"../modules/es.symbol.for":380,"../modules/es.symbol.key-for":382}],382:[function(t,n,s){var o=t("../internals/export"),i=t("../internals/has-own-property"),c=t("../internals/is-symbol"),u=t("../internals/try-to-string"),l=t("../internals/shared"),d=t("../internals/symbol-registry-detection"),h=l("symbol-to-string-registry");o({target:"Symbol",stat:!0,forced:!d},{keyFor:function(f){if(!c(f))throw new TypeError(u(f)+" is not a symbol");if(i(h,f))return h[f]}})},{"../internals/export":259,"../internals/has-own-property":275,"../internals/is-symbol":292,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/try-to-string":349}],383:[function(t,n,s){function o(i){return Object.prototype.toString.call(i)}s.isArray=function(i){return Array.isArray?Array.isArray(i):o(i)==="[object Array]"},s.isBoolean=function(i){return typeof i=="boolean"},s.isNull=function(i){return i===null},s.isNullOrUndefined=function(i){return i==null},s.isNumber=function(i){return typeof i=="number"},s.isString=function(i){return typeof i=="string"},s.isSymbol=function(i){return typeof i=="symbol"},s.isUndefined=function(i){return i===void 0},s.isRegExp=function(i){return o(i)==="[object RegExp]"},s.isObject=function(i){return typeof i=="object"&&i!==null},s.isDate=function(i){return o(i)==="[object Date]"},s.isError=function(i){return o(i)==="[object Error]"||i instanceof Error},s.isFunction=function(i){return typeof i=="function"},s.isPrimitive=function(i){return i===null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||typeof i=="symbol"||i===void 0},s.isBuffer=t("buffer").Buffer.isBuffer},{buffer:220}],384:[function(t,n,s){(function(o){(function(){var i=t("elliptic"),c=t("bn.js");n.exports=function(h){return new l(h)};var u={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function l(h){this.curveType=u[h],this.curveType||(this.curveType={name:h}),this.curve=new i.ec(this.curveType.name),this.keys=void 0}function d(h,f,p){Array.isArray(h)||(h=h.toArray());var v=new o(h);if(p&&v.length<p){var g=new o(p-v.length);g.fill(0),v=o.concat([g,v])}return f?v.toString(f):v}u.p224=u.secp224r1,u.p256=u.secp256r1=u.prime256v1,u.p192=u.secp192r1=u.prime192v1,u.p384=u.secp384r1,u.p521=u.secp521r1,l.prototype.generateKeys=function(h,f){return this.keys=this.curve.genKeyPair(),this.getPublicKey(h,f)},l.prototype.computeSecret=function(h,f,p){return f=f||"utf8",o.isBuffer(h)||(h=new o(h,f)),d(this.curve.keyFromPublic(h).getPublic().mul(this.keys.getPrivate()).getX(),p,this.curveType.byteLength)},l.prototype.getPublicKey=function(h,f){var p=this.keys.getPublic(f==="compressed",!0);return f==="hybrid"&&(p[p.length-1]%2?p[0]=7:p[0]=6),d(p,h)},l.prototype.getPrivateKey=function(h){return d(this.keys.getPrivate(),h)},l.prototype.setPublicKey=function(h,f){return f=f||"utf8",o.isBuffer(h)||(h=new o(h,f)),this.keys._importPublic(h),this},l.prototype.setPrivateKey=function(h,f){f=f||"utf8",o.isBuffer(h)||(h=new o(h,f));var p=new c(h);return p=p.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(p),this}}).call(this)}).call(this,t("buffer").Buffer)},{"bn.js":385,buffer:220,elliptic:405}],385:[function(t,n,s){arguments[4][184][0].apply(s,arguments)},{buffer:188,dup:184}],386:[function(t,n,s){var o=t("inherits"),i=t("md5.js"),c=t("ripemd160"),u=t("sha.js"),l=t("cipher-base");function d(h){l.call(this,"digest"),this._hash=h}o(d,l),d.prototype._update=function(h){this._hash.update(h)},d.prototype._final=function(){return this._hash.digest()},n.exports=function(h){return(h=h.toLowerCase())==="md5"?new i:h==="rmd160"||h==="ripemd160"?new c:new d(u(h))}},{"cipher-base":221,inherits:440,"md5.js":450,ripemd160:493,"sha.js":498}],387:[function(t,n,s){var o=t("md5.js");n.exports=function(i){return new o().update(i).digest()}},{"md5.js":450}],388:[function(t,n,s){var o=t("inherits"),i=t("./legacy"),c=t("cipher-base"),u=t("safe-buffer").Buffer,l=t("create-hash/md5"),d=t("ripemd160"),h=t("sha.js"),f=u.alloc(128);function p(v,g){c.call(this,"digest"),typeof g=="string"&&(g=u.from(g));var m=v==="sha512"||v==="sha384"?128:64;this._alg=v,this._key=g,g.length>m?g=(v==="rmd160"?new d:h(v)).update(g).digest():g.length<m&&(g=u.concat([g,f],m));for(var b=this._ipad=u.allocUnsafe(m),y=this._opad=u.allocUnsafe(m),S=0;S<m;S++)b[S]=54^g[S],y[S]=92^g[S];this._hash=v==="rmd160"?new d:h(v),this._hash.update(b)}o(p,c),p.prototype._update=function(v){this._hash.update(v)},p.prototype._final=function(){var v=this._hash.digest();return(this._alg==="rmd160"?new d:h(this._alg)).update(this._opad).update(v).digest()},n.exports=function(v,g){return(v=v.toLowerCase())==="rmd160"||v==="ripemd160"?new p("rmd160",g):v==="md5"?new i(l,g):new p(v,g)}},{"./legacy":389,"cipher-base":221,"create-hash/md5":387,inherits:440,ripemd160:493,"safe-buffer":494,"sha.js":498}],389:[function(t,n,s){var o=t("inherits"),i=t("safe-buffer").Buffer,c=t("cipher-base"),u=i.alloc(128);function l(d,h){c.call(this,"digest"),typeof h=="string"&&(h=i.from(h)),this._alg=d,this._key=h,h.length>64?h=d(h):h.length<64&&(h=i.concat([h,u],64));for(var f=this._ipad=i.allocUnsafe(64),p=this._opad=i.allocUnsafe(64),v=0;v<64;v++)f[v]=54^h[v],p[v]=92^h[v];this._hash=[f]}o(l,c),l.prototype._update=function(d){this._hash.push(d)},l.prototype._final=function(){var d=this._alg(i.concat(this._hash));return this._alg(i.concat([this._opad,d]))},n.exports=l},{"cipher-base":221,inherits:440,"safe-buffer":494}],390:[function(t,n,s){s.randomBytes=s.rng=s.pseudoRandomBytes=s.prng=t("randombytes"),s.createHash=s.Hash=t("create-hash"),s.createHmac=s.Hmac=t("create-hmac");var o=t("browserify-sign/algos"),i=Object.keys(o),c=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(i);s.getHashes=function(){return c};var u=t("pbkdf2");s.pbkdf2=u.pbkdf2,s.pbkdf2Sync=u.pbkdf2Sync;var l=t("browserify-cipher");s.Cipher=l.Cipher,s.createCipher=l.createCipher,s.Cipheriv=l.Cipheriv,s.createCipheriv=l.createCipheriv,s.Decipher=l.Decipher,s.createDecipher=l.createDecipher,s.Decipheriv=l.Decipheriv,s.createDecipheriv=l.createDecipheriv,s.getCiphers=l.getCiphers,s.listCiphers=l.listCiphers;var d=t("diffie-hellman");s.DiffieHellmanGroup=d.DiffieHellmanGroup,s.createDiffieHellmanGroup=d.createDiffieHellmanGroup,s.getDiffieHellman=d.getDiffieHellman,s.createDiffieHellman=d.createDiffieHellman,s.DiffieHellman=d.DiffieHellman;var h=t("browserify-sign");s.createSign=h.createSign,s.Sign=h.Sign,s.createVerify=h.createVerify,s.Verify=h.Verify,s.createECDH=t("create-ecdh");var f=t("public-encrypt");s.publicEncrypt=f.publicEncrypt,s.privateEncrypt=f.privateEncrypt,s.publicDecrypt=f.publicDecrypt,s.privateDecrypt=f.privateDecrypt;var p=t("randomfill");s.randomFill=p.randomFill,s.randomFillSync=p.randomFillSync,s.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join(`
`))},s.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},{"browserify-cipher":206,"browserify-sign":213,"browserify-sign/algos":210,"create-ecdh":384,"create-hash":386,"create-hmac":388,"diffie-hellman":400,pbkdf2:460,"public-encrypt":468,randombytes:475,randomfill:476}],391:[function(t,n,s){(function(o,i){typeof s=="object"&&n!==void 0?n.exports=i():(o=typeof globalThis<"u"?globalThis:o||self).dayjs=i()})(void 0,function(){var o=6e4,i=36e5,c="millisecond",u="second",l="minute",d="hour",h="day",f="week",p="month",v="quarter",g="year",m="date",b="Invalid Date",y=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,S=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,C={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(_){var R=["th","st","nd","rd"],j=_%100;return"["+_+(R[(j-20)%10]||R[j]||R[0])+"]"}},L=function(_,R,j){var A=String(_);return!A||A.length>=R?_:""+Array(R+1-A.length).join(j)+_},O={s:L,z:function(_){var R=-_.utcOffset(),j=Math.abs(R),A=Math.floor(j/60),N=j%60;return(R<=0?"+":"-")+L(A,2,"0")+":"+L(N,2,"0")},m:function _(R,j){if(R.date()<j.date())return-_(j,R);var A=12*(j.year()-R.year())+(j.month()-R.month()),N=R.clone().add(A,p),V=j-N<0,M=R.clone().add(A+(V?-1:1),p);return+(-(A+(j-N)/(V?N-M:M-N))||0)},a:function(_){return _<0?Math.ceil(_)||0:Math.floor(_)},p:function(_){return{M:p,y:g,w:f,d:h,D:m,h:d,m:l,s:u,ms:c,Q:v}[_]||String(_||"").toLowerCase().replace(/s$/,"")},u:function(_){return _===void 0}},H="en",z={};z[H]=C;var q="$isDayjsObject",D=function(_){return _ instanceof U||!(!_||!_[q])},W=function _(R,j,A){var N;if(!R)return H;if(typeof R=="string"){var V=R.toLowerCase();z[V]&&(N=V),j&&(z[V]=j,N=V);var M=R.split("-");if(!N&&M.length>1)return _(M[0])}else{var Z=R.name;z[Z]=R,N=Z}return!A&&N&&(H=N),N||!A&&H},P=function(_,R){if(D(_))return _.clone();var j=typeof R=="object"?R:{};return j.date=_,j.args=arguments,new U(j)},I=O;I.l=W,I.i=D,I.w=function(_,R){return P(_,{locale:R.$L,utc:R.$u,x:R.$x,$offset:R.$offset})};var U=function(){function _(j){this.$L=W(j.locale,null,!0),this.parse(j),this.$x=this.$x||j.x||{},this[q]=!0}var R=_.prototype;return R.parse=function(j){this.$d=function(A){var N=A.date,V=A.utc;if(N===null)return new Date(NaN);if(I.u(N))return new Date;if(N instanceof Date)return new Date(N);if(typeof N=="string"&&!/Z$/i.test(N)){var M=N.match(y);if(M){var Z=M[2]-1||0,J=(M[7]||"0").substring(0,3);return V?new Date(Date.UTC(M[1],Z,M[3]||1,M[4]||0,M[5]||0,M[6]||0,J)):new Date(M[1],Z,M[3]||1,M[4]||0,M[5]||0,M[6]||0,J)}}return new Date(N)}(j),this.init()},R.init=function(){var j=this.$d;this.$y=j.getFullYear(),this.$M=j.getMonth(),this.$D=j.getDate(),this.$W=j.getDay(),this.$H=j.getHours(),this.$m=j.getMinutes(),this.$s=j.getSeconds(),this.$ms=j.getMilliseconds()},R.$utils=function(){return I},R.isValid=function(){return this.$d.toString()!==b},R.isSame=function(j,A){var N=P(j);return this.startOf(A)<=N&&N<=this.endOf(A)},R.isAfter=function(j,A){return P(j)<this.startOf(A)},R.isBefore=function(j,A){return this.endOf(A)<P(j)},R.$g=function(j,A,N){return I.u(j)?this[A]:this.set(N,j)},R.unix=function(){return Math.floor(this.valueOf()/1e3)},R.valueOf=function(){return this.$d.getTime()},R.startOf=function(j,A){var N=this,V=!!I.u(A)||A,M=I.p(j),Z=function(ue,se){var ce=I.w(N.$u?Date.UTC(N.$y,se,ue):new Date(N.$y,se,ue),N);return V?ce:ce.endOf(h)},J=function(ue,se){return I.w(N.toDate()[ue].apply(N.toDate("s"),(V?[0,0,0,0]:[23,59,59,999]).slice(se)),N)},re=this.$W,X=this.$M,ne=this.$D,Y="set"+(this.$u?"UTC":"");switch(M){case g:return V?Z(1,0):Z(31,11);case p:return V?Z(1,X):Z(0,X+1);case f:var K=this.$locale().weekStart||0,ee=(re<K?re+7:re)-K;return Z(V?ne-ee:ne+(6-ee),X);case h:case m:return J(Y+"Hours",0);case d:return J(Y+"Minutes",1);case l:return J(Y+"Seconds",2);case u:return J(Y+"Milliseconds",3);default:return this.clone()}},R.endOf=function(j){return this.startOf(j,!1)},R.$set=function(j,A){var N,V=I.p(j),M="set"+(this.$u?"UTC":""),Z=(N={},N[h]=M+"Date",N[m]=M+"Date",N[p]=M+"Month",N[g]=M+"FullYear",N[d]=M+"Hours",N[l]=M+"Minutes",N[u]=M+"Seconds",N[c]=M+"Milliseconds",N)[V],J=V===h?this.$D+(A-this.$W):A;if(V===p||V===g){var re=this.clone().set(m,1);re.$d[Z](J),re.init(),this.$d=re.set(m,Math.min(this.$D,re.daysInMonth())).$d}else Z&&this.$d[Z](J);return this.init(),this},R.set=function(j,A){return this.clone().$set(j,A)},R.get=function(j){return this[I.p(j)]()},R.add=function(j,A){var N,V=this;j=Number(j);var M=I.p(A),Z=function(X){var ne=P(V);return I.w(ne.date(ne.date()+Math.round(X*j)),V)};if(M===p)return this.set(p,this.$M+j);if(M===g)return this.set(g,this.$y+j);if(M===h)return Z(1);if(M===f)return Z(7);var J=(N={},N[l]=o,N[d]=i,N[u]=1e3,N)[M]||1,re=this.$d.getTime()+j*J;return I.w(re,this)},R.subtract=function(j,A){return this.add(-1*j,A)},R.format=function(j){var A=this,N=this.$locale();if(!this.isValid())return N.invalidDate||b;var V=j||"YYYY-MM-DDTHH:mm:ssZ",M=I.z(this),Z=this.$H,J=this.$m,re=this.$M,X=N.weekdays,ne=N.months,Y=N.meridiem,K=function(se,ce,fe,ve){return se&&(se[ce]||se(A,V))||fe[ce].slice(0,ve)},ee=function(se){return I.s(Z%12||12,se,"0")},ue=Y||function(se,ce,fe){var ve=se<12?"AM":"PM";return fe?ve.toLowerCase():ve};return V.replace(S,function(se,ce){return ce||function(fe){switch(fe){case"YY":return String(A.$y).slice(-2);case"YYYY":return I.s(A.$y,4,"0");case"M":return re+1;case"MM":return I.s(re+1,2,"0");case"MMM":return K(N.monthsShort,re,ne,3);case"MMMM":return K(ne,re);case"D":return A.$D;case"DD":return I.s(A.$D,2,"0");case"d":return String(A.$W);case"dd":return K(N.weekdaysMin,A.$W,X,2);case"ddd":return K(N.weekdaysShort,A.$W,X,3);case"dddd":return X[A.$W];case"H":return String(Z);case"HH":return I.s(Z,2,"0");case"h":return ee(1);case"hh":return ee(2);case"a":return ue(Z,J,!0);case"A":return ue(Z,J,!1);case"m":return String(J);case"mm":return I.s(J,2,"0");case"s":return String(A.$s);case"ss":return I.s(A.$s,2,"0");case"SSS":return I.s(A.$ms,3,"0");case"Z":return M}return null}(se)||M.replace(":","")})},R.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},R.diff=function(j,A,N){var V,M=this,Z=I.p(A),J=P(j),re=(J.utcOffset()-this.utcOffset())*o,X=this-J,ne=function(){return I.m(M,J)};switch(Z){case g:V=ne()/12;break;case p:V=ne();break;case v:V=ne()/3;break;case f:V=(X-re)/6048e5;break;case h:V=(X-re)/864e5;break;case d:V=X/i;break;case l:V=X/o;break;case u:V=X/1e3;break;default:V=X}return N?V:I.a(V)},R.daysInMonth=function(){return this.endOf(p).$D},R.$locale=function(){return z[this.$L]},R.locale=function(j,A){if(!j)return this.$L;var N=this.clone(),V=W(j,A,!0);return V&&(N.$L=V),N},R.clone=function(){return I.w(this.$d,this)},R.toDate=function(){return new Date(this.valueOf())},R.toJSON=function(){return this.isValid()?this.toISOString():null},R.toISOString=function(){return this.$d.toISOString()},R.toString=function(){return this.$d.toUTCString()},_}(),k=U.prototype;return P.prototype=k,[["$ms",c],["$s",u],["$m",l],["$H",d],["$W",h],["$M",p],["$y",g],["$D",m]].forEach(function(_){k[_[1]]=function(R){return this.$g(R,_[0],_[1])}}),P.extend=function(_,R){return _.$i||(_(R,U,P),_.$i=!0),P},P.locale=W,P.isDayjs=D,P.unix=function(_){return P(1e3*_)},P.en=z[H],P.Ls=z,P.p={},P})},{}],392:[function(t,n,s){(function(o,i){typeof s=="object"&&n!==void 0?n.exports=i():(o=typeof globalThis<"u"?globalThis:o||self).dayjs_plugin_customParseFormat=i()})(void 0,function(){var o={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},i=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,c=/\d\d/,u=/\d\d?/,l=/\d*[^-_:/,()\s\d]+/,d={},h=function(y){return(y=+y)+(y>68?1900:2e3)},f=function(y){return function(S){this[y]=+S}},p=[/[+-]\d\d:?(\d\d)?|Z/,function(y){(this.zone||(this.zone={})).offset=function(S){if(!S||S==="Z")return 0;var C=S.match(/([+-]|\d\d)/g),L=60*C[1]+(+C[2]||0);return L===0?0:C[0]==="+"?-L:L}(y)}],v=function(y){var S=d[y];return S&&(S.indexOf?S:S.s.concat(S.f))},g=function(y,S){var C,L=d.meridiem;if(L){for(var O=1;O<=24;O+=1)if(y.indexOf(L(O,0,S))>-1){C=O>12;break}}else C=y===(S?"pm":"PM");return C},m={A:[l,function(y){this.afternoon=g(y,!1)}],a:[l,function(y){this.afternoon=g(y,!0)}],S:[/\d/,function(y){this.milliseconds=100*+y}],SS:[c,function(y){this.milliseconds=10*+y}],SSS:[/\d{3}/,function(y){this.milliseconds=+y}],s:[u,f("seconds")],ss:[u,f("seconds")],m:[u,f("minutes")],mm:[u,f("minutes")],H:[u,f("hours")],h:[u,f("hours")],HH:[u,f("hours")],hh:[u,f("hours")],D:[u,f("day")],DD:[c,f("day")],Do:[l,function(y){var S=d.ordinal,C=y.match(/\d+/);if(this.day=C[0],S)for(var L=1;L<=31;L+=1)S(L).replace(/\[|\]/g,"")===y&&(this.day=L)}],M:[u,f("month")],MM:[c,f("month")],MMM:[l,function(y){var S=v("months"),C=(v("monthsShort")||S.map(function(L){return L.slice(0,3)})).indexOf(y)+1;if(C<1)throw new Error;this.month=C%12||C}],MMMM:[l,function(y){var S=v("months").indexOf(y)+1;if(S<1)throw new Error;this.month=S%12||S}],Y:[/[+-]?\d+/,f("year")],YY:[c,function(y){this.year=h(y)}],YYYY:[/\d{4}/,f("year")],Z:p,ZZ:p};function b(y){var S,C;S=y,C=d&&d.formats;for(var L=(y=S.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(P,I,U){var k=U&&U.toUpperCase();return I||C[U]||o[U]||C[k].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(_,R,j){return R||j.slice(1)})})).match(i),O=L.length,H=0;H<O;H+=1){var z=L[H],q=m[z],D=q&&q[0],W=q&&q[1];L[H]=W?{regex:D,parser:W}:z.replace(/^\[|\]$/g,"")}return function(P){for(var I={},U=0,k=0;U<O;U+=1){var _=L[U];if(typeof _=="string")k+=_.length;else{var R=_.regex,j=_.parser,A=P.slice(k),N=R.exec(A)[0];j.call(I,N),P=P.replace(N,"")}}return function(V){var M=V.afternoon;if(M!==void 0){var Z=V.hours;M?Z<12&&(V.hours+=12):Z===12&&(V.hours=0),delete V.afternoon}}(I),I}}return function(y,S,C){C.p.customParseFormat=!0,y&&y.parseTwoDigitYear&&(h=y.parseTwoDigitYear);var L=S.prototype,O=L.parse;L.parse=function(H){var z=H.date,q=H.utc,D=H.args;this.$u=q;var W=D[1];if(typeof W=="string"){var P=D[2]===!0,I=D[3]===!0,U=P||I,k=D[2];I&&(k=D[2]),d=this.$locale(),!P&&k&&(d=C.Ls[k]),this.$d=function(A,N,V){try{if(["x","X"].indexOf(N)>-1)return new Date((N==="X"?1e3:1)*A);var M=b(N)(A),Z=M.year,J=M.month,re=M.day,X=M.hours,ne=M.minutes,Y=M.seconds,K=M.milliseconds,ee=M.zone,ue=new Date,se=re||(Z||J?1:ue.getDate()),ce=Z||ue.getFullYear(),fe=0;Z&&!J||(fe=J>0?J-1:ue.getMonth());var ve=X||0,_e=ne||0,le=Y||0,ke=K||0;return ee?new Date(Date.UTC(ce,fe,se,ve,_e,le,ke+60*ee.offset*1e3)):V?new Date(Date.UTC(ce,fe,se,ve,_e,le,ke)):new Date(ce,fe,se,ve,_e,le,ke)}catch{return new Date("")}}(z,W,q),this.init(),k&&k!==!0&&(this.$L=this.locale(k).$L),U&&z!=this.format(W)&&(this.$d=new Date("")),d={}}else if(W instanceof Array)for(var _=W.length,R=1;R<=_;R+=1){D[1]=W[R-1];var j=C.apply(this,D);if(j.isValid()){this.$d=j.$d,this.$L=j.$L,this.init();break}R===_&&(this.$d=new Date(""))}else O.call(this,H)}}})},{}],393:[function(t,n,s){(function(o,i){typeof s=="object"&&n!==void 0?n.exports=i():(o=typeof globalThis<"u"?globalThis:o||self).dayjs_plugin_utc=i()})(void 0,function(){var o="minute",i=/[+-]\d\d(?::?\d\d)?/g,c=/([+-]|\d\d)/g;return function(u,l,d){var h=l.prototype;d.utc=function(y){var S={date:y,utc:!0,args:arguments};return new l(S)},h.utc=function(y){var S=d(this.toDate(),{locale:this.$L,utc:!0});return y?S.add(this.utcOffset(),o):S},h.local=function(){return d(this.toDate(),{locale:this.$L,utc:!1})};var f=h.parse;h.parse=function(y){y.utc&&(this.$u=!0),this.$utils().u(y.$offset)||(this.$offset=y.$offset),f.call(this,y)};var p=h.init;h.init=function(){if(this.$u){var y=this.$d;this.$y=y.getUTCFullYear(),this.$M=y.getUTCMonth(),this.$D=y.getUTCDate(),this.$W=y.getUTCDay(),this.$H=y.getUTCHours(),this.$m=y.getUTCMinutes(),this.$s=y.getUTCSeconds(),this.$ms=y.getUTCMilliseconds()}else p.call(this)};var v=h.utcOffset;h.utcOffset=function(y,S){var C=this.$utils().u;if(C(y))return this.$u?0:C(this.$offset)?v.call(this):this.$offset;if(typeof y=="string"&&(y=function(z){z===void 0&&(z="");var q=z.match(i);if(!q)return null;var D=(""+q[0]).match(c)||["-",0,0],W=D[0],P=60*+D[1]+ +D[2];return P===0?0:W==="+"?P:-P}(y))===null)return this;var L=Math.abs(y)<=16?60*y:y,O=this;if(S)return O.$offset=L,O.$u=y===0,O;if(y!==0){var H=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(O=this.local().add(L+H,o)).$offset=L,O.$x.$localOffset=H}else O=this.utc();return O};var g=h.format;h.format=function(y){var S=y||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return g.call(this,S)},h.valueOf=function(){var y=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*y},h.isUTC=function(){return!!this.$u},h.toISOString=function(){return this.toDate().toISOString()},h.toString=function(){return this.toDate().toUTCString()};var m=h.toDate;h.toDate=function(y){return y==="s"&&this.$offset?d(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():m.call(this)};var b=h.diff;h.diff=function(y,S,C){if(y&&this.$u===y.$u)return b.call(this,y,S,C);var L=this.local(),O=d(y).local();return b.call(L,O,S,C)}}})},{}],394:[function(t,n,s){s.utils=t("./des/utils"),s.Cipher=t("./des/cipher"),s.DES=t("./des/des"),s.CBC=t("./des/cbc"),s.EDE=t("./des/ede")},{"./des/cbc":395,"./des/cipher":396,"./des/des":397,"./des/ede":398,"./des/utils":399}],395:[function(t,n,s){var o=t("minimalistic-assert"),i=t("inherits"),c={};function u(l){o.equal(l.length,8,"Invalid IV length"),this.iv=new Array(8);for(var d=0;d<this.iv.length;d++)this.iv[d]=l[d]}s.instantiate=function(l){function d(v){l.call(this,v),this._cbcInit()}i(d,l);for(var h=Object.keys(c),f=0;f<h.length;f++){var p=h[f];d.prototype[p]=c[p]}return d.create=function(v){return new d(v)},d},c._cbcInit=function(){var l=new u(this.options.iv);this._cbcState=l},c._update=function(l,d,h,f){var p=this._cbcState,v=this.constructor.super_.prototype,g=p.iv;if(this.type==="encrypt"){for(var m=0;m<this.blockSize;m++)g[m]^=l[d+m];for(v._update.call(this,g,0,h,f),m=0;m<this.blockSize;m++)g[m]=h[f+m]}else{for(v._update.call(this,l,d,h,f),m=0;m<this.blockSize;m++)h[f+m]^=g[m];for(m=0;m<this.blockSize;m++)g[m]=l[d+m]}}},{inherits:440,"minimalistic-assert":453}],396:[function(t,n,s){var o=t("minimalistic-assert");function i(c){this.options=c,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0,this.padding=c.padding!==!1}n.exports=i,i.prototype._init=function(){},i.prototype.update=function(c){return c.length===0?[]:this.type==="decrypt"?this._updateDecrypt(c):this._updateEncrypt(c)},i.prototype._buffer=function(c,u){for(var l=Math.min(this.buffer.length-this.bufferOff,c.length-u),d=0;d<l;d++)this.buffer[this.bufferOff+d]=c[u+d];return this.bufferOff+=l,l},i.prototype._flushBuffer=function(c,u){return this._update(this.buffer,0,c,u),this.bufferOff=0,this.blockSize},i.prototype._updateEncrypt=function(c){var u=0,l=0,d=(this.bufferOff+c.length)/this.blockSize|0,h=new Array(d*this.blockSize);this.bufferOff!==0&&(u+=this._buffer(c,u),this.bufferOff===this.buffer.length&&(l+=this._flushBuffer(h,l)));for(var f=c.length-(c.length-u)%this.blockSize;u<f;u+=this.blockSize)this._update(c,u,h,l),l+=this.blockSize;for(;u<c.length;u++,this.bufferOff++)this.buffer[this.bufferOff]=c[u];return h},i.prototype._updateDecrypt=function(c){for(var u=0,l=0,d=Math.ceil((this.bufferOff+c.length)/this.blockSize)-1,h=new Array(d*this.blockSize);d>0;d--)u+=this._buffer(c,u),l+=this._flushBuffer(h,l);return u+=this._buffer(c,u),h},i.prototype.final=function(c){var u,l;return c&&(u=this.update(c)),l=this.type==="encrypt"?this._finalEncrypt():this._finalDecrypt(),u?u.concat(l):l},i.prototype._pad=function(c,u){if(u===0)return!1;for(;u<c.length;)c[u++]=0;return!0},i.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var c=new Array(this.blockSize);return this._update(this.buffer,0,c,0),c},i.prototype._unpad=function(c){return c},i.prototype._finalDecrypt=function(){o.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var c=new Array(this.blockSize);return this._flushBuffer(c,0),this._unpad(c)}},{"minimalistic-assert":453}],397:[function(t,n,s){var o=t("minimalistic-assert"),i=t("inherits"),c=t("./utils"),u=t("./cipher");function l(){this.tmp=new Array(2),this.keys=null}function d(f){u.call(this,f);var p=new l;this._desState=p,this.deriveKeys(p,f.key)}i(d,u),n.exports=d,d.create=function(f){return new d(f)};var h=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];d.prototype.deriveKeys=function(f,p){f.keys=new Array(32),o.equal(p.length,this.blockSize,"Invalid key length");var v=c.readUInt32BE(p,0),g=c.readUInt32BE(p,4);c.pc1(v,g,f.tmp,0),v=f.tmp[0],g=f.tmp[1];for(var m=0;m<f.keys.length;m+=2){var b=h[m>>>1];v=c.r28shl(v,b),g=c.r28shl(g,b),c.pc2(v,g,f.keys,m)}},d.prototype._update=function(f,p,v,g){var m=this._desState,b=c.readUInt32BE(f,p),y=c.readUInt32BE(f,p+4);c.ip(b,y,m.tmp,0),b=m.tmp[0],y=m.tmp[1],this.type==="encrypt"?this._encrypt(m,b,y,m.tmp,0):this._decrypt(m,b,y,m.tmp,0),b=m.tmp[0],y=m.tmp[1],c.writeUInt32BE(v,b,g),c.writeUInt32BE(v,y,g+4)},d.prototype._pad=function(f,p){if(this.padding===!1)return!1;for(var v=f.length-p,g=p;g<f.length;g++)f[g]=v;return!0},d.prototype._unpad=function(f){if(this.padding===!1)return f;for(var p=f[f.length-1],v=f.length-p;v<f.length;v++)o.equal(f[v],p);return f.slice(0,f.length-p)},d.prototype._encrypt=function(f,p,v,g,m){for(var b=p,y=v,S=0;S<f.keys.length;S+=2){var C=f.keys[S],L=f.keys[S+1];c.expand(y,f.tmp,0),C^=f.tmp[0],L^=f.tmp[1];var O=c.substitute(C,L),H=y;y=(b^c.permute(O))>>>0,b=H}c.rip(y,b,g,m)},d.prototype._decrypt=function(f,p,v,g,m){for(var b=v,y=p,S=f.keys.length-2;S>=0;S-=2){var C=f.keys[S],L=f.keys[S+1];c.expand(b,f.tmp,0),C^=f.tmp[0],L^=f.tmp[1];var O=c.substitute(C,L),H=b;b=(y^c.permute(O))>>>0,y=H}c.rip(b,y,g,m)}},{"./cipher":396,"./utils":399,inherits:440,"minimalistic-assert":453}],398:[function(t,n,s){var o=t("minimalistic-assert"),i=t("inherits"),c=t("./cipher"),u=t("./des");function l(h,f){o.equal(f.length,24,"Invalid key length");var p=f.slice(0,8),v=f.slice(8,16),g=f.slice(16,24);this.ciphers=h==="encrypt"?[u.create({type:"encrypt",key:p}),u.create({type:"decrypt",key:v}),u.create({type:"encrypt",key:g})]:[u.create({type:"decrypt",key:g}),u.create({type:"encrypt",key:v}),u.create({type:"decrypt",key:p})]}function d(h){c.call(this,h);var f=new l(this.type,this.options.key);this._edeState=f}i(d,c),n.exports=d,d.create=function(h){return new d(h)},d.prototype._update=function(h,f,p,v){var g=this._edeState;g.ciphers[0]._update(h,f,p,v),g.ciphers[1]._update(p,v,p,v),g.ciphers[2]._update(p,v,p,v)},d.prototype._pad=u.prototype._pad,d.prototype._unpad=u.prototype._unpad},{"./cipher":396,"./des":397,inherits:440,"minimalistic-assert":453}],399:[function(t,n,s){s.readUInt32BE=function(u,l){return(u[0+l]<<24|u[1+l]<<16|u[2+l]<<8|u[3+l])>>>0},s.writeUInt32BE=function(u,l,d){u[0+d]=l>>>24,u[1+d]=l>>>16&255,u[2+d]=l>>>8&255,u[3+d]=255&l},s.ip=function(u,l,d,h){for(var f=0,p=0,v=6;v>=0;v-=2){for(var g=0;g<=24;g+=8)f<<=1,f|=l>>>g+v&1;for(g=0;g<=24;g+=8)f<<=1,f|=u>>>g+v&1}for(v=6;v>=0;v-=2){for(g=1;g<=25;g+=8)p<<=1,p|=l>>>g+v&1;for(g=1;g<=25;g+=8)p<<=1,p|=u>>>g+v&1}d[h+0]=f>>>0,d[h+1]=p>>>0},s.rip=function(u,l,d,h){for(var f=0,p=0,v=0;v<4;v++)for(var g=24;g>=0;g-=8)f<<=1,f|=l>>>g+v&1,f<<=1,f|=u>>>g+v&1;for(v=4;v<8;v++)for(g=24;g>=0;g-=8)p<<=1,p|=l>>>g+v&1,p<<=1,p|=u>>>g+v&1;d[h+0]=f>>>0,d[h+1]=p>>>0},s.pc1=function(u,l,d,h){for(var f=0,p=0,v=7;v>=5;v--){for(var g=0;g<=24;g+=8)f<<=1,f|=l>>g+v&1;for(g=0;g<=24;g+=8)f<<=1,f|=u>>g+v&1}for(g=0;g<=24;g+=8)f<<=1,f|=l>>g+v&1;for(v=1;v<=3;v++){for(g=0;g<=24;g+=8)p<<=1,p|=l>>g+v&1;for(g=0;g<=24;g+=8)p<<=1,p|=u>>g+v&1}for(g=0;g<=24;g+=8)p<<=1,p|=u>>g+v&1;d[h+0]=f>>>0,d[h+1]=p>>>0},s.r28shl=function(u,l){return u<<l&268435455|u>>>28-l};var o=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];s.pc2=function(u,l,d,h){for(var f=0,p=0,v=o.length>>>1,g=0;g<v;g++)f<<=1,f|=u>>>o[g]&1;for(g=v;g<o.length;g++)p<<=1,p|=l>>>o[g]&1;d[h+0]=f>>>0,d[h+1]=p>>>0},s.expand=function(u,l,d){var h=0,f=0;h=(1&u)<<5|u>>>27;for(var p=23;p>=15;p-=4)h<<=6,h|=u>>>p&63;for(p=11;p>=3;p-=4)f|=u>>>p&63,f<<=6;f|=(31&u)<<1|u>>>31,l[d+0]=h>>>0,l[d+1]=f>>>0};var i=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];s.substitute=function(u,l){for(var d=0,h=0;h<4;h++)d<<=4,d|=i[64*h+(u>>>18-6*h&63)];for(h=0;h<4;h++)d<<=4,d|=i[256+64*h+(l>>>18-6*h&63)];return d>>>0};var c=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];s.permute=function(u){for(var l=0,d=0;d<c.length;d++)l<<=1,l|=u>>>c[d]&1;return l>>>0},s.padSplit=function(u,l,d){for(var h=u.toString(2);h.length<l;)h="0"+h;for(var f=[],p=0;p<l;p+=d)f.push(h.slice(p,p+d));return f.join(" ")}},{}],400:[function(t,n,s){(function(o){(function(){var i=t("./lib/generatePrime"),c=t("./lib/primes.json"),u=t("./lib/dh"),l={binary:!0,hex:!0,base64:!0};s.DiffieHellmanGroup=s.createDiffieHellmanGroup=s.getDiffieHellman=function(d){var h=new o(c[d].prime,"hex"),f=new o(c[d].gen,"hex");return new u(h,f)},s.createDiffieHellman=s.DiffieHellman=function d(h,f,p,v){return o.isBuffer(f)||l[f]===void 0?d(h,"binary",f,p):(f=f||"binary",v=v||"binary",p=p||new o([2]),o.isBuffer(p)||(p=new o(p,v)),typeof h=="number"?new u(i(h,p),p,!0):(o.isBuffer(h)||(h=new o(h,f)),new u(h,p,!0)))}}).call(this)}).call(this,t("buffer").Buffer)},{"./lib/dh":401,"./lib/generatePrime":402,"./lib/primes.json":403,buffer:220}],401:[function(t,n,s){(function(o){(function(){var i=t("bn.js"),c=new(t("miller-rabin")),u=new i(24),l=new i(11),d=new i(10),h=new i(3),f=new i(7),p=t("./generatePrime"),v=t("randombytes");function g(C,L){return L=L||"utf8",o.isBuffer(C)||(C=new o(C,L)),this._pub=new i(C),this}function m(C,L){return L=L||"utf8",o.isBuffer(C)||(C=new o(C,L)),this._priv=new i(C),this}n.exports=y;var b={};function y(C,L,O){this.setGenerator(L),this.__prime=new i(C),this._prime=i.mont(this.__prime),this._primeLen=C.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,O?(this.setPublicKey=g,this.setPrivateKey=m):this._primeCode=8}function S(C,L){var O=new o(C.toArray());return L?O.toString(L):O}Object.defineProperty(y.prototype,"verifyError",{enumerable:!0,get:function(){return typeof this._primeCode!="number"&&(this._primeCode=function(C,L){var O=L.toString("hex"),H=[O,C.toString(16)].join("_");if(H in b)return b[H];var z,q=0;if(C.isEven()||!p.simpleSieve||!p.fermatTest(C)||!c.test(C))return q+=1,q+=O==="02"||O==="05"?8:4,b[H]=q,q;switch(c.test(C.shrn(1))||(q+=2),O){case"02":C.mod(u).cmp(l)&&(q+=8);break;case"05":(z=C.mod(d)).cmp(h)&&z.cmp(f)&&(q+=8);break;default:q+=4}return b[H]=q,q}(this.__prime,this.__gen)),this._primeCode}}),y.prototype.generateKeys=function(){return this._priv||(this._priv=new i(v(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},y.prototype.computeSecret=function(C){var L=(C=(C=new i(C)).toRed(this._prime)).redPow(this._priv).fromRed(),O=new o(L.toArray()),H=this.getPrime();if(O.length<H.length){var z=new o(H.length-O.length);z.fill(0),O=o.concat([z,O])}return O},y.prototype.getPublicKey=function(C){return S(this._pub,C)},y.prototype.getPrivateKey=function(C){return S(this._priv,C)},y.prototype.getPrime=function(C){return S(this.__prime,C)},y.prototype.getGenerator=function(C){return S(this._gen,C)},y.prototype.setGenerator=function(C,L){return L=L||"utf8",o.isBuffer(C)||(C=new o(C,L)),this.__gen=C,this._gen=new i(C),this}}).call(this)}).call(this,t("buffer").Buffer)},{"./generatePrime":402,"bn.js":404,buffer:220,"miller-rabin":451,randombytes:475}],402:[function(t,n,s){var o=t("randombytes");n.exports=C,C.simpleSieve=y,C.fermatTest=S;var i=t("bn.js"),c=new i(24),u=new(t("miller-rabin")),l=new i(1),d=new i(2),h=new i(5),f=(new i(16),new i(8),new i(10)),p=new i(3),v=(new i(7),new i(11)),g=new i(4),m=(new i(12),null);function b(){if(m!==null)return m;var L=[];L[0]=2;for(var O=1,H=3;H<1048576;H+=2){for(var z=Math.ceil(Math.sqrt(H)),q=0;q<O&&L[q]<=z&&H%L[q]!=0;q++);O!==q&&L[q]<=z||(L[O++]=H)}return m=L,L}function y(L){for(var O=b(),H=0;H<O.length;H++)if(L.modn(O[H])===0)return L.cmpn(O[H])===0;return!0}function S(L){var O=i.mont(L);return d.toRed(O).redPow(L.subn(1)).fromRed().cmpn(1)===0}function C(L,O){if(L<16)return new i(O===2||O===5?[140,123]:[140,39]);var H,z;for(O=new i(O);;){for(H=new i(o(Math.ceil(L/8)));H.bitLength()>L;)H.ishrn(1);if(H.isEven()&&H.iadd(l),H.testn(1)||H.iadd(d),O.cmp(d)){if(!O.cmp(h))for(;H.mod(f).cmp(p);)H.iadd(g)}else for(;H.mod(c).cmp(v);)H.iadd(g);if(y(z=H.shrn(1))&&y(H)&&S(z)&&S(H)&&u.test(z)&&u.test(H))return H}}},{"bn.js":404,"miller-rabin":451,randombytes:475}],403:[function(t,n,s){n.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},{}],404:[function(t,n,s){arguments[4][184][0].apply(s,arguments)},{buffer:188,dup:184}],405:[function(t,n,s){var o=s;o.version=t("../package.json").version,o.utils=t("./elliptic/utils"),o.rand=t("brorand"),o.curve=t("./elliptic/curve"),o.curves=t("./elliptic/curves"),o.ec=t("./elliptic/ec"),o.eddsa=t("./elliptic/eddsa")},{"../package.json":421,"./elliptic/curve":408,"./elliptic/curves":411,"./elliptic/ec":412,"./elliptic/eddsa":415,"./elliptic/utils":419,brorand:187}],406:[function(t,n,s){var o=t("bn.js"),i=t("../utils"),c=i.getNAF,u=i.getJSF,l=i.assert;function d(f,p){this.type=f,this.p=new o(p.p,16),this.red=p.prime?o.red(p.prime):o.mont(this.p),this.zero=new o(0).toRed(this.red),this.one=new o(1).toRed(this.red),this.two=new o(2).toRed(this.red),this.n=p.n&&new o(p.n,16),this.g=p.g&&this.pointFromJSON(p.g,p.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var v=this.n&&this.p.div(this.n);!v||v.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function h(f,p){this.curve=f,this.type=p,this.precomputed=null}n.exports=d,d.prototype.point=function(){throw new Error("Not implemented")},d.prototype.validate=function(){throw new Error("Not implemented")},d.prototype._fixedNafMul=function(f,p){l(f.precomputed);var v=f._getDoubles(),g=c(p,1,this._bitLength),m=(1<<v.step+1)-(v.step%2==0?2:1);m/=3;var b,y,S=[];for(b=0;b<g.length;b+=v.step){y=0;for(var C=b+v.step-1;C>=b;C--)y=(y<<1)+g[C];S.push(y)}for(var L=this.jpoint(null,null,null),O=this.jpoint(null,null,null),H=m;H>0;H--){for(b=0;b<S.length;b++)(y=S[b])===H?O=O.mixedAdd(v.points[b]):y===-H&&(O=O.mixedAdd(v.points[b].neg()));L=L.add(O)}return L.toP()},d.prototype._wnafMul=function(f,p){var v=4,g=f._getNAFPoints(v);v=g.wnd;for(var m=g.points,b=c(p,v,this._bitLength),y=this.jpoint(null,null,null),S=b.length-1;S>=0;S--){for(var C=0;S>=0&&b[S]===0;S--)C++;if(S>=0&&C++,y=y.dblp(C),S<0)break;var L=b[S];l(L!==0),y=f.type==="affine"?L>0?y.mixedAdd(m[L-1>>1]):y.mixedAdd(m[-L-1>>1].neg()):L>0?y.add(m[L-1>>1]):y.add(m[-L-1>>1].neg())}return f.type==="affine"?y.toP():y},d.prototype._wnafMulAdd=function(f,p,v,g,m){var b,y,S,C=this._wnafT1,L=this._wnafT2,O=this._wnafT3,H=0;for(b=0;b<g;b++){var z=(S=p[b])._getNAFPoints(f);C[b]=z.wnd,L[b]=z.points}for(b=g-1;b>=1;b-=2){var q=b-1,D=b;if(C[q]===1&&C[D]===1){var W=[p[q],null,null,p[D]];p[q].y.cmp(p[D].y)===0?(W[1]=p[q].add(p[D]),W[2]=p[q].toJ().mixedAdd(p[D].neg())):p[q].y.cmp(p[D].y.redNeg())===0?(W[1]=p[q].toJ().mixedAdd(p[D]),W[2]=p[q].add(p[D].neg())):(W[1]=p[q].toJ().mixedAdd(p[D]),W[2]=p[q].toJ().mixedAdd(p[D].neg()));var P=[-3,-1,-5,-7,0,7,5,1,3],I=u(v[q],v[D]);for(H=Math.max(I[0].length,H),O[q]=new Array(H),O[D]=new Array(H),y=0;y<H;y++){var U=0|I[0][y],k=0|I[1][y];O[q][y]=P[3*(U+1)+(k+1)],O[D][y]=0,L[q]=W}}else O[q]=c(v[q],C[q],this._bitLength),O[D]=c(v[D],C[D],this._bitLength),H=Math.max(O[q].length,H),H=Math.max(O[D].length,H)}var _=this.jpoint(null,null,null),R=this._wnafT4;for(b=H;b>=0;b--){for(var j=0;b>=0;){var A=!0;for(y=0;y<g;y++)R[y]=0|O[y][b],R[y]!==0&&(A=!1);if(!A)break;j++,b--}if(b>=0&&j++,_=_.dblp(j),b<0)break;for(y=0;y<g;y++){var N=R[y];N!==0&&(N>0?S=L[y][N-1>>1]:N<0&&(S=L[y][-N-1>>1].neg()),_=S.type==="affine"?_.mixedAdd(S):_.add(S))}}for(b=0;b<g;b++)L[b]=null;return m?_:_.toP()},d.BasePoint=h,h.prototype.eq=function(){throw new Error("Not implemented")},h.prototype.validate=function(){return this.curve.validate(this)},d.prototype.decodePoint=function(f,p){f=i.toArray(f,p);var v=this.p.byteLength();if((f[0]===4||f[0]===6||f[0]===7)&&f.length-1==2*v)return f[0]===6?l(f[f.length-1]%2==0):f[0]===7&&l(f[f.length-1]%2==1),this.point(f.slice(1,1+v),f.slice(1+v,1+2*v));if((f[0]===2||f[0]===3)&&f.length-1===v)return this.pointFromX(f.slice(1,1+v),f[0]===3);throw new Error("Unknown point format")},h.prototype.encodeCompressed=function(f){return this.encode(f,!0)},h.prototype._encode=function(f){var p=this.curve.p.byteLength(),v=this.getX().toArray("be",p);return f?[this.getY().isEven()?2:3].concat(v):[4].concat(v,this.getY().toArray("be",p))},h.prototype.encode=function(f,p){return i.encode(this._encode(p),f)},h.prototype.precompute=function(f){if(this.precomputed)return this;var p={doubles:null,naf:null,beta:null};return p.naf=this._getNAFPoints(8),p.doubles=this._getDoubles(4,f),p.beta=this._getBeta(),this.precomputed=p,this},h.prototype._hasDoubles=function(f){if(!this.precomputed)return!1;var p=this.precomputed.doubles;return!!p&&p.points.length>=Math.ceil((f.bitLength()+1)/p.step)},h.prototype._getDoubles=function(f,p){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var v=[this],g=this,m=0;m<p;m+=f){for(var b=0;b<f;b++)g=g.dbl();v.push(g)}return{step:f,points:v}},h.prototype._getNAFPoints=function(f){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var p=[this],v=(1<<f)-1,g=v===1?null:this.dbl(),m=1;m<v;m++)p[m]=p[m-1].add(g);return{wnd:f,points:p}},h.prototype._getBeta=function(){return null},h.prototype.dblp=function(f){for(var p=this,v=0;v<f;v++)p=p.dbl();return p}},{"../utils":419,"bn.js":420}],407:[function(t,n,s){var o=t("../utils"),i=t("bn.js"),c=t("inherits"),u=t("./base"),l=o.assert;function d(f){this.twisted=(0|f.a)!=1,this.mOneA=this.twisted&&(0|f.a)==-1,this.extended=this.mOneA,u.call(this,"edwards",f),this.a=new i(f.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new i(f.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new i(f.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),l(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(0|f.c)==1}function h(f,p,v,g,m){u.BasePoint.call(this,f,"projective"),p===null&&v===null&&g===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new i(p,16),this.y=new i(v,16),this.z=g?new i(g,16):this.curve.one,this.t=m&&new i(m,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}c(d,u),n.exports=d,d.prototype._mulA=function(f){return this.mOneA?f.redNeg():this.a.redMul(f)},d.prototype._mulC=function(f){return this.oneC?f:this.c.redMul(f)},d.prototype.jpoint=function(f,p,v,g){return this.point(f,p,v,g)},d.prototype.pointFromX=function(f,p){(f=new i(f,16)).red||(f=f.toRed(this.red));var v=f.redSqr(),g=this.c2.redSub(this.a.redMul(v)),m=this.one.redSub(this.c2.redMul(this.d).redMul(v)),b=g.redMul(m.redInvm()),y=b.redSqrt();if(y.redSqr().redSub(b).cmp(this.zero)!==0)throw new Error("invalid point");var S=y.fromRed().isOdd();return(p&&!S||!p&&S)&&(y=y.redNeg()),this.point(f,y)},d.prototype.pointFromY=function(f,p){(f=new i(f,16)).red||(f=f.toRed(this.red));var v=f.redSqr(),g=v.redSub(this.c2),m=v.redMul(this.d).redMul(this.c2).redSub(this.a),b=g.redMul(m.redInvm());if(b.cmp(this.zero)===0){if(p)throw new Error("invalid point");return this.point(this.zero,f)}var y=b.redSqrt();if(y.redSqr().redSub(b).cmp(this.zero)!==0)throw new Error("invalid point");return y.fromRed().isOdd()!==p&&(y=y.redNeg()),this.point(y,f)},d.prototype.validate=function(f){if(f.isInfinity())return!0;f.normalize();var p=f.x.redSqr(),v=f.y.redSqr(),g=p.redMul(this.a).redAdd(v),m=this.c2.redMul(this.one.redAdd(this.d.redMul(p).redMul(v)));return g.cmp(m)===0},c(h,u.BasePoint),d.prototype.pointFromJSON=function(f){return h.fromJSON(this,f)},d.prototype.point=function(f,p,v,g){return new h(this,f,p,v,g)},h.fromJSON=function(f,p){return new h(f,p[0],p[1],p[2])},h.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},h.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},h.prototype._extDbl=function(){var f=this.x.redSqr(),p=this.y.redSqr(),v=this.z.redSqr();v=v.redIAdd(v);var g=this.curve._mulA(f),m=this.x.redAdd(this.y).redSqr().redISub(f).redISub(p),b=g.redAdd(p),y=b.redSub(v),S=g.redSub(p),C=m.redMul(y),L=b.redMul(S),O=m.redMul(S),H=y.redMul(b);return this.curve.point(C,L,H,O)},h.prototype._projDbl=function(){var f,p,v,g,m,b,y=this.x.redAdd(this.y).redSqr(),S=this.x.redSqr(),C=this.y.redSqr();if(this.curve.twisted){var L=(g=this.curve._mulA(S)).redAdd(C);this.zOne?(f=y.redSub(S).redSub(C).redMul(L.redSub(this.curve.two)),p=L.redMul(g.redSub(C)),v=L.redSqr().redSub(L).redSub(L)):(m=this.z.redSqr(),b=L.redSub(m).redISub(m),f=y.redSub(S).redISub(C).redMul(b),p=L.redMul(g.redSub(C)),v=L.redMul(b))}else g=S.redAdd(C),m=this.curve._mulC(this.z).redSqr(),b=g.redSub(m).redSub(m),f=this.curve._mulC(y.redISub(g)).redMul(b),p=this.curve._mulC(g).redMul(S.redISub(C)),v=g.redMul(b);return this.curve.point(f,p,v)},h.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},h.prototype._extAdd=function(f){var p=this.y.redSub(this.x).redMul(f.y.redSub(f.x)),v=this.y.redAdd(this.x).redMul(f.y.redAdd(f.x)),g=this.t.redMul(this.curve.dd).redMul(f.t),m=this.z.redMul(f.z.redAdd(f.z)),b=v.redSub(p),y=m.redSub(g),S=m.redAdd(g),C=v.redAdd(p),L=b.redMul(y),O=S.redMul(C),H=b.redMul(C),z=y.redMul(S);return this.curve.point(L,O,z,H)},h.prototype._projAdd=function(f){var p,v,g=this.z.redMul(f.z),m=g.redSqr(),b=this.x.redMul(f.x),y=this.y.redMul(f.y),S=this.curve.d.redMul(b).redMul(y),C=m.redSub(S),L=m.redAdd(S),O=this.x.redAdd(this.y).redMul(f.x.redAdd(f.y)).redISub(b).redISub(y),H=g.redMul(C).redMul(O);return this.curve.twisted?(p=g.redMul(L).redMul(y.redSub(this.curve._mulA(b))),v=C.redMul(L)):(p=g.redMul(L).redMul(y.redSub(b)),v=this.curve._mulC(C).redMul(L)),this.curve.point(H,p,v)},h.prototype.add=function(f){return this.isInfinity()?f:f.isInfinity()?this:this.curve.extended?this._extAdd(f):this._projAdd(f)},h.prototype.mul=function(f){return this._hasDoubles(f)?this.curve._fixedNafMul(this,f):this.curve._wnafMul(this,f)},h.prototype.mulAdd=function(f,p,v){return this.curve._wnafMulAdd(1,[this,p],[f,v],2,!1)},h.prototype.jmulAdd=function(f,p,v){return this.curve._wnafMulAdd(1,[this,p],[f,v],2,!0)},h.prototype.normalize=function(){if(this.zOne)return this;var f=this.z.redInvm();return this.x=this.x.redMul(f),this.y=this.y.redMul(f),this.t&&(this.t=this.t.redMul(f)),this.z=this.curve.one,this.zOne=!0,this},h.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},h.prototype.getX=function(){return this.normalize(),this.x.fromRed()},h.prototype.getY=function(){return this.normalize(),this.y.fromRed()},h.prototype.eq=function(f){return this===f||this.getX().cmp(f.getX())===0&&this.getY().cmp(f.getY())===0},h.prototype.eqXToP=function(f){var p=f.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(p)===0)return!0;for(var v=f.clone(),g=this.curve.redN.redMul(this.z);;){if(v.iadd(this.curve.n),v.cmp(this.curve.p)>=0)return!1;if(p.redIAdd(g),this.x.cmp(p)===0)return!0}},h.prototype.toP=h.prototype.normalize,h.prototype.mixedAdd=h.prototype.add},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],408:[function(t,n,s){var o=s;o.base=t("./base"),o.short=t("./short"),o.mont=t("./mont"),o.edwards=t("./edwards")},{"./base":406,"./edwards":407,"./mont":409,"./short":410}],409:[function(t,n,s){var o=t("bn.js"),i=t("inherits"),c=t("./base"),u=t("../utils");function l(h){c.call(this,"mont",h),this.a=new o(h.a,16).toRed(this.red),this.b=new o(h.b,16).toRed(this.red),this.i4=new o(4).toRed(this.red).redInvm(),this.two=new o(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function d(h,f,p){c.BasePoint.call(this,h,"projective"),f===null&&p===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new o(f,16),this.z=new o(p,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}i(l,c),n.exports=l,l.prototype.validate=function(h){var f=h.normalize().x,p=f.redSqr(),v=p.redMul(f).redAdd(p.redMul(this.a)).redAdd(f);return v.redSqrt().redSqr().cmp(v)===0},i(d,c.BasePoint),l.prototype.decodePoint=function(h,f){return this.point(u.toArray(h,f),1)},l.prototype.point=function(h,f){return new d(this,h,f)},l.prototype.pointFromJSON=function(h){return d.fromJSON(this,h)},d.prototype.precompute=function(){},d.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},d.fromJSON=function(h,f){return new d(h,f[0],f[1]||h.one)},d.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},d.prototype.isInfinity=function(){return this.z.cmpn(0)===0},d.prototype.dbl=function(){var h=this.x.redAdd(this.z).redSqr(),f=this.x.redSub(this.z).redSqr(),p=h.redSub(f),v=h.redMul(f),g=p.redMul(f.redAdd(this.curve.a24.redMul(p)));return this.curve.point(v,g)},d.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},d.prototype.diffAdd=function(h,f){var p=this.x.redAdd(this.z),v=this.x.redSub(this.z),g=h.x.redAdd(h.z),m=h.x.redSub(h.z).redMul(p),b=g.redMul(v),y=f.z.redMul(m.redAdd(b).redSqr()),S=f.x.redMul(m.redISub(b).redSqr());return this.curve.point(y,S)},d.prototype.mul=function(h){for(var f=h.clone(),p=this,v=this.curve.point(null,null),g=[];f.cmpn(0)!==0;f.iushrn(1))g.push(f.andln(1));for(var m=g.length-1;m>=0;m--)g[m]===0?(p=p.diffAdd(v,this),v=v.dbl()):(v=p.diffAdd(v,this),p=p.dbl());return v},d.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},d.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},d.prototype.eq=function(h){return this.getX().cmp(h.getX())===0},d.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},d.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],410:[function(t,n,s){var o=t("../utils"),i=t("bn.js"),c=t("inherits"),u=t("./base"),l=o.assert;function d(p){u.call(this,"short",p),this.a=new i(p.a,16).toRed(this.red),this.b=new i(p.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(p),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function h(p,v,g,m){u.BasePoint.call(this,p,"affine"),v===null&&g===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new i(v,16),this.y=new i(g,16),m&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function f(p,v,g,m){u.BasePoint.call(this,p,"jacobian"),v===null&&g===null&&m===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new i(0)):(this.x=new i(v,16),this.y=new i(g,16),this.z=new i(m,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}c(d,u),n.exports=d,d.prototype._getEndomorphism=function(p){if(this.zeroA&&this.g&&this.n&&this.p.modn(3)===1){var v,g;if(p.beta)v=new i(p.beta,16).toRed(this.red);else{var m=this._getEndoRoots(this.p);v=(v=m[0].cmp(m[1])<0?m[0]:m[1]).toRed(this.red)}if(p.lambda)g=new i(p.lambda,16);else{var b=this._getEndoRoots(this.n);this.g.mul(b[0]).x.cmp(this.g.x.redMul(v))===0?g=b[0]:(g=b[1],l(this.g.mul(g).x.cmp(this.g.x.redMul(v))===0))}return{beta:v,lambda:g,basis:p.basis?p.basis.map(function(y){return{a:new i(y.a,16),b:new i(y.b,16)}}):this._getEndoBasis(g)}}},d.prototype._getEndoRoots=function(p){var v=p===this.p?this.red:i.mont(p),g=new i(2).toRed(v).redInvm(),m=g.redNeg(),b=new i(3).toRed(v).redNeg().redSqrt().redMul(g);return[m.redAdd(b).fromRed(),m.redSub(b).fromRed()]},d.prototype._getEndoBasis=function(p){for(var v,g,m,b,y,S,C,L,O,H=this.n.ushrn(Math.floor(this.n.bitLength()/2)),z=p,q=this.n.clone(),D=new i(1),W=new i(0),P=new i(0),I=new i(1),U=0;z.cmpn(0)!==0;){var k=q.div(z);L=q.sub(k.mul(z)),O=P.sub(k.mul(D));var _=I.sub(k.mul(W));if(!m&&L.cmp(H)<0)v=C.neg(),g=D,m=L.neg(),b=O;else if(m&&++U==2)break;C=L,q=z,z=L,P=D,D=O,I=W,W=_}y=L.neg(),S=O;var R=m.sqr().add(b.sqr());return y.sqr().add(S.sqr()).cmp(R)>=0&&(y=v,S=g),m.negative&&(m=m.neg(),b=b.neg()),y.negative&&(y=y.neg(),S=S.neg()),[{a:m,b},{a:y,b:S}]},d.prototype._endoSplit=function(p){var v=this.endo.basis,g=v[0],m=v[1],b=m.b.mul(p).divRound(this.n),y=g.b.neg().mul(p).divRound(this.n),S=b.mul(g.a),C=y.mul(m.a),L=b.mul(g.b),O=y.mul(m.b);return{k1:p.sub(S).sub(C),k2:L.add(O).neg()}},d.prototype.pointFromX=function(p,v){(p=new i(p,16)).red||(p=p.toRed(this.red));var g=p.redSqr().redMul(p).redIAdd(p.redMul(this.a)).redIAdd(this.b),m=g.redSqrt();if(m.redSqr().redSub(g).cmp(this.zero)!==0)throw new Error("invalid point");var b=m.fromRed().isOdd();return(v&&!b||!v&&b)&&(m=m.redNeg()),this.point(p,m)},d.prototype.validate=function(p){if(p.inf)return!0;var v=p.x,g=p.y,m=this.a.redMul(v),b=v.redSqr().redMul(v).redIAdd(m).redIAdd(this.b);return g.redSqr().redISub(b).cmpn(0)===0},d.prototype._endoWnafMulAdd=function(p,v,g){for(var m=this._endoWnafT1,b=this._endoWnafT2,y=0;y<p.length;y++){var S=this._endoSplit(v[y]),C=p[y],L=C._getBeta();S.k1.negative&&(S.k1.ineg(),C=C.neg(!0)),S.k2.negative&&(S.k2.ineg(),L=L.neg(!0)),m[2*y]=C,m[2*y+1]=L,b[2*y]=S.k1,b[2*y+1]=S.k2}for(var O=this._wnafMulAdd(1,m,b,2*y,g),H=0;H<2*y;H++)m[H]=null,b[H]=null;return O},c(h,u.BasePoint),d.prototype.point=function(p,v,g){return new h(this,p,v,g)},d.prototype.pointFromJSON=function(p,v){return h.fromJSON(this,p,v)},h.prototype._getBeta=function(){if(this.curve.endo){var p=this.precomputed;if(p&&p.beta)return p.beta;var v=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(p){var g=this.curve,m=function(b){return g.point(b.x.redMul(g.endo.beta),b.y)};p.beta=v,v.precomputed={beta:null,naf:p.naf&&{wnd:p.naf.wnd,points:p.naf.points.map(m)},doubles:p.doubles&&{step:p.doubles.step,points:p.doubles.points.map(m)}}}return v}},h.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},h.fromJSON=function(p,v,g){typeof v=="string"&&(v=JSON.parse(v));var m=p.point(v[0],v[1],g);if(!v[2])return m;function b(S){return p.point(S[0],S[1],g)}var y=v[2];return m.precomputed={beta:null,doubles:y.doubles&&{step:y.doubles.step,points:[m].concat(y.doubles.points.map(b))},naf:y.naf&&{wnd:y.naf.wnd,points:[m].concat(y.naf.points.map(b))}},m},h.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},h.prototype.isInfinity=function(){return this.inf},h.prototype.add=function(p){if(this.inf)return p;if(p.inf)return this;if(this.eq(p))return this.dbl();if(this.neg().eq(p))return this.curve.point(null,null);if(this.x.cmp(p.x)===0)return this.curve.point(null,null);var v=this.y.redSub(p.y);v.cmpn(0)!==0&&(v=v.redMul(this.x.redSub(p.x).redInvm()));var g=v.redSqr().redISub(this.x).redISub(p.x),m=v.redMul(this.x.redSub(g)).redISub(this.y);return this.curve.point(g,m)},h.prototype.dbl=function(){if(this.inf)return this;var p=this.y.redAdd(this.y);if(p.cmpn(0)===0)return this.curve.point(null,null);var v=this.curve.a,g=this.x.redSqr(),m=p.redInvm(),b=g.redAdd(g).redIAdd(g).redIAdd(v).redMul(m),y=b.redSqr().redISub(this.x.redAdd(this.x)),S=b.redMul(this.x.redSub(y)).redISub(this.y);return this.curve.point(y,S)},h.prototype.getX=function(){return this.x.fromRed()},h.prototype.getY=function(){return this.y.fromRed()},h.prototype.mul=function(p){return p=new i(p,16),this.isInfinity()?this:this._hasDoubles(p)?this.curve._fixedNafMul(this,p):this.curve.endo?this.curve._endoWnafMulAdd([this],[p]):this.curve._wnafMul(this,p)},h.prototype.mulAdd=function(p,v,g){var m=[this,v],b=[p,g];return this.curve.endo?this.curve._endoWnafMulAdd(m,b):this.curve._wnafMulAdd(1,m,b,2)},h.prototype.jmulAdd=function(p,v,g){var m=[this,v],b=[p,g];return this.curve.endo?this.curve._endoWnafMulAdd(m,b,!0):this.curve._wnafMulAdd(1,m,b,2,!0)},h.prototype.eq=function(p){return this===p||this.inf===p.inf&&(this.inf||this.x.cmp(p.x)===0&&this.y.cmp(p.y)===0)},h.prototype.neg=function(p){if(this.inf)return this;var v=this.curve.point(this.x,this.y.redNeg());if(p&&this.precomputed){var g=this.precomputed,m=function(b){return b.neg()};v.precomputed={naf:g.naf&&{wnd:g.naf.wnd,points:g.naf.points.map(m)},doubles:g.doubles&&{step:g.doubles.step,points:g.doubles.points.map(m)}}}return v},h.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},c(f,u.BasePoint),d.prototype.jpoint=function(p,v,g){return new f(this,p,v,g)},f.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var p=this.z.redInvm(),v=p.redSqr(),g=this.x.redMul(v),m=this.y.redMul(v).redMul(p);return this.curve.point(g,m)},f.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},f.prototype.add=function(p){if(this.isInfinity())return p;if(p.isInfinity())return this;var v=p.z.redSqr(),g=this.z.redSqr(),m=this.x.redMul(v),b=p.x.redMul(g),y=this.y.redMul(v.redMul(p.z)),S=p.y.redMul(g.redMul(this.z)),C=m.redSub(b),L=y.redSub(S);if(C.cmpn(0)===0)return L.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var O=C.redSqr(),H=O.redMul(C),z=m.redMul(O),q=L.redSqr().redIAdd(H).redISub(z).redISub(z),D=L.redMul(z.redISub(q)).redISub(y.redMul(H)),W=this.z.redMul(p.z).redMul(C);return this.curve.jpoint(q,D,W)},f.prototype.mixedAdd=function(p){if(this.isInfinity())return p.toJ();if(p.isInfinity())return this;var v=this.z.redSqr(),g=this.x,m=p.x.redMul(v),b=this.y,y=p.y.redMul(v).redMul(this.z),S=g.redSub(m),C=b.redSub(y);if(S.cmpn(0)===0)return C.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var L=S.redSqr(),O=L.redMul(S),H=g.redMul(L),z=C.redSqr().redIAdd(O).redISub(H).redISub(H),q=C.redMul(H.redISub(z)).redISub(b.redMul(O)),D=this.z.redMul(S);return this.curve.jpoint(z,q,D)},f.prototype.dblp=function(p){if(p===0)return this;if(this.isInfinity())return this;if(!p)return this.dbl();var v;if(this.curve.zeroA||this.curve.threeA){var g=this;for(v=0;v<p;v++)g=g.dbl();return g}var m=this.curve.a,b=this.curve.tinv,y=this.x,S=this.y,C=this.z,L=C.redSqr().redSqr(),O=S.redAdd(S);for(v=0;v<p;v++){var H=y.redSqr(),z=O.redSqr(),q=z.redSqr(),D=H.redAdd(H).redIAdd(H).redIAdd(m.redMul(L)),W=y.redMul(z),P=D.redSqr().redISub(W.redAdd(W)),I=W.redISub(P),U=D.redMul(I);U=U.redIAdd(U).redISub(q);var k=O.redMul(C);v+1<p&&(L=L.redMul(q)),y=P,C=k,O=U}return this.curve.jpoint(y,O.redMul(b),C)},f.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},f.prototype._zeroDbl=function(){var p,v,g;if(this.zOne){var m=this.x.redSqr(),b=this.y.redSqr(),y=b.redSqr(),S=this.x.redAdd(b).redSqr().redISub(m).redISub(y);S=S.redIAdd(S);var C=m.redAdd(m).redIAdd(m),L=C.redSqr().redISub(S).redISub(S),O=y.redIAdd(y);O=(O=O.redIAdd(O)).redIAdd(O),p=L,v=C.redMul(S.redISub(L)).redISub(O),g=this.y.redAdd(this.y)}else{var H=this.x.redSqr(),z=this.y.redSqr(),q=z.redSqr(),D=this.x.redAdd(z).redSqr().redISub(H).redISub(q);D=D.redIAdd(D);var W=H.redAdd(H).redIAdd(H),P=W.redSqr(),I=q.redIAdd(q);I=(I=I.redIAdd(I)).redIAdd(I),p=P.redISub(D).redISub(D),v=W.redMul(D.redISub(p)).redISub(I),g=(g=this.y.redMul(this.z)).redIAdd(g)}return this.curve.jpoint(p,v,g)},f.prototype._threeDbl=function(){var p,v,g;if(this.zOne){var m=this.x.redSqr(),b=this.y.redSqr(),y=b.redSqr(),S=this.x.redAdd(b).redSqr().redISub(m).redISub(y);S=S.redIAdd(S);var C=m.redAdd(m).redIAdd(m).redIAdd(this.curve.a),L=C.redSqr().redISub(S).redISub(S);p=L;var O=y.redIAdd(y);O=(O=O.redIAdd(O)).redIAdd(O),v=C.redMul(S.redISub(L)).redISub(O),g=this.y.redAdd(this.y)}else{var H=this.z.redSqr(),z=this.y.redSqr(),q=this.x.redMul(z),D=this.x.redSub(H).redMul(this.x.redAdd(H));D=D.redAdd(D).redIAdd(D);var W=q.redIAdd(q),P=(W=W.redIAdd(W)).redAdd(W);p=D.redSqr().redISub(P),g=this.y.redAdd(this.z).redSqr().redISub(z).redISub(H);var I=z.redSqr();I=(I=(I=I.redIAdd(I)).redIAdd(I)).redIAdd(I),v=D.redMul(W.redISub(p)).redISub(I)}return this.curve.jpoint(p,v,g)},f.prototype._dbl=function(){var p=this.curve.a,v=this.x,g=this.y,m=this.z,b=m.redSqr().redSqr(),y=v.redSqr(),S=g.redSqr(),C=y.redAdd(y).redIAdd(y).redIAdd(p.redMul(b)),L=v.redAdd(v),O=(L=L.redIAdd(L)).redMul(S),H=C.redSqr().redISub(O.redAdd(O)),z=O.redISub(H),q=S.redSqr();q=(q=(q=q.redIAdd(q)).redIAdd(q)).redIAdd(q);var D=C.redMul(z).redISub(q),W=g.redAdd(g).redMul(m);return this.curve.jpoint(H,D,W)},f.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var p=this.x.redSqr(),v=this.y.redSqr(),g=this.z.redSqr(),m=v.redSqr(),b=p.redAdd(p).redIAdd(p),y=b.redSqr(),S=this.x.redAdd(v).redSqr().redISub(p).redISub(m),C=(S=(S=(S=S.redIAdd(S)).redAdd(S).redIAdd(S)).redISub(y)).redSqr(),L=m.redIAdd(m);L=(L=(L=L.redIAdd(L)).redIAdd(L)).redIAdd(L);var O=b.redIAdd(S).redSqr().redISub(y).redISub(C).redISub(L),H=v.redMul(O);H=(H=H.redIAdd(H)).redIAdd(H);var z=this.x.redMul(C).redISub(H);z=(z=z.redIAdd(z)).redIAdd(z);var q=this.y.redMul(O.redMul(L.redISub(O)).redISub(S.redMul(C)));q=(q=(q=q.redIAdd(q)).redIAdd(q)).redIAdd(q);var D=this.z.redAdd(S).redSqr().redISub(g).redISub(C);return this.curve.jpoint(z,q,D)},f.prototype.mul=function(p,v){return p=new i(p,v),this.curve._wnafMul(this,p)},f.prototype.eq=function(p){if(p.type==="affine")return this.eq(p.toJ());if(this===p)return!0;var v=this.z.redSqr(),g=p.z.redSqr();if(this.x.redMul(g).redISub(p.x.redMul(v)).cmpn(0)!==0)return!1;var m=v.redMul(this.z),b=g.redMul(p.z);return this.y.redMul(b).redISub(p.y.redMul(m)).cmpn(0)===0},f.prototype.eqXToP=function(p){var v=this.z.redSqr(),g=p.toRed(this.curve.red).redMul(v);if(this.x.cmp(g)===0)return!0;for(var m=p.clone(),b=this.curve.redN.redMul(v);;){if(m.iadd(this.curve.n),m.cmp(this.curve.p)>=0)return!1;if(g.redIAdd(b),this.x.cmp(g)===0)return!0}},f.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},f.prototype.isInfinity=function(){return this.z.cmpn(0)===0}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],411:[function(t,n,s){var o,i=s,c=t("hash.js"),u=t("./curve"),l=t("./utils").assert;function d(f){f.type==="short"?this.curve=new u.short(f):f.type==="edwards"?this.curve=new u.edwards(f):this.curve=new u.mont(f),this.g=this.curve.g,this.n=this.curve.n,this.hash=f.hash,l(this.g.validate(),"Invalid curve"),l(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function h(f,p){Object.defineProperty(i,f,{configurable:!0,enumerable:!0,get:function(){var v=new d(p);return Object.defineProperty(i,f,{configurable:!0,enumerable:!0,value:v}),v}})}i.PresetCurve=d,h("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:c.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),h("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:c.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),h("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:c.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),h("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:c.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),h("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:c.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),h("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:c.sha256,gRed:!1,g:["9"]}),h("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:c.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{o=t("./precomputed/secp256k1")}catch{o=void 0}h("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:c.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",o]})},{"./curve":408,"./precomputed/secp256k1":418,"./utils":419,"hash.js":426}],412:[function(t,n,s){var o=t("bn.js"),i=t("hmac-drbg"),c=t("../utils"),u=t("../curves"),l=t("brorand"),d=c.assert,h=t("./key"),f=t("./signature");function p(v){if(!(this instanceof p))return new p(v);typeof v=="string"&&(d(Object.prototype.hasOwnProperty.call(u,v),"Unknown curve "+v),v=u[v]),v instanceof u.PresetCurve&&(v={curve:v}),this.curve=v.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=v.curve.g,this.g.precompute(v.curve.n.bitLength()+1),this.hash=v.hash||v.curve.hash}n.exports=p,p.prototype.keyPair=function(v){return new h(this,v)},p.prototype.keyFromPrivate=function(v,g){return h.fromPrivate(this,v,g)},p.prototype.keyFromPublic=function(v,g){return h.fromPublic(this,v,g)},p.prototype.genKeyPair=function(v){v||(v={});for(var g=new i({hash:this.hash,pers:v.pers,persEnc:v.persEnc||"utf8",entropy:v.entropy||l(this.hash.hmacStrength),entropyEnc:v.entropy&&v.entropyEnc||"utf8",nonce:this.n.toArray()}),m=this.n.byteLength(),b=this.n.sub(new o(2));;){var y=new o(g.generate(m));if(!(y.cmp(b)>0))return y.iaddn(1),this.keyFromPrivate(y)}},p.prototype._truncateToN=function(v,g){var m=8*v.byteLength()-this.n.bitLength();return m>0&&(v=v.ushrn(m)),!g&&v.cmp(this.n)>=0?v.sub(this.n):v},p.prototype.sign=function(v,g,m,b){typeof m=="object"&&(b=m,m=null),b||(b={}),g=this.keyFromPrivate(g,m),v=this._truncateToN(new o(v,16));for(var y=this.n.byteLength(),S=g.getPrivate().toArray("be",y),C=v.toArray("be",y),L=new i({hash:this.hash,entropy:S,nonce:C,pers:b.pers,persEnc:b.persEnc||"utf8"}),O=this.n.sub(new o(1)),H=0;;H++){var z=b.k?b.k(H):new o(L.generate(this.n.byteLength()));if(!((z=this._truncateToN(z,!0)).cmpn(1)<=0||z.cmp(O)>=0)){var q=this.g.mul(z);if(!q.isInfinity()){var D=q.getX(),W=D.umod(this.n);if(W.cmpn(0)!==0){var P=z.invm(this.n).mul(W.mul(g.getPrivate()).iadd(v));if((P=P.umod(this.n)).cmpn(0)!==0){var I=(q.getY().isOdd()?1:0)|(D.cmp(W)!==0?2:0);return b.canonical&&P.cmp(this.nh)>0&&(P=this.n.sub(P),I^=1),new f({r:W,s:P,recoveryParam:I})}}}}}},p.prototype.verify=function(v,g,m,b){v=this._truncateToN(new o(v,16)),m=this.keyFromPublic(m,b);var y=(g=new f(g,"hex")).r,S=g.s;if(y.cmpn(1)<0||y.cmp(this.n)>=0||S.cmpn(1)<0||S.cmp(this.n)>=0)return!1;var C,L=S.invm(this.n),O=L.mul(v).umod(this.n),H=L.mul(y).umod(this.n);return this.curve._maxwellTrick?!(C=this.g.jmulAdd(O,m.getPublic(),H)).isInfinity()&&C.eqXToP(y):!(C=this.g.mulAdd(O,m.getPublic(),H)).isInfinity()&&C.getX().umod(this.n).cmp(y)===0},p.prototype.recoverPubKey=function(v,g,m,b){d((3&m)===m,"The recovery param is more than two bits"),g=new f(g,b);var y=this.n,S=new o(v),C=g.r,L=g.s,O=1&m,H=m>>1;if(C.cmp(this.curve.p.umod(this.curve.n))>=0&&H)throw new Error("Unable to find sencond key candinate");C=H?this.curve.pointFromX(C.add(this.curve.n),O):this.curve.pointFromX(C,O);var z=g.r.invm(y),q=y.sub(S).mul(z).umod(y),D=L.mul(z).umod(y);return this.g.mulAdd(q,C,D)},p.prototype.getKeyRecoveryParam=function(v,g,m,b){if((g=new f(g,b)).recoveryParam!==null)return g.recoveryParam;for(var y=0;y<4;y++){var S;try{S=this.recoverPubKey(v,g,y)}catch{continue}if(S.eq(m))return y}throw new Error("Unable to find valid recovery factor")}},{"../curves":411,"../utils":419,"./key":413,"./signature":414,"bn.js":420,brorand:187,"hmac-drbg":438}],413:[function(t,n,s){var o=t("bn.js"),i=t("../utils").assert;function c(u,l){this.ec=u,this.priv=null,this.pub=null,l.priv&&this._importPrivate(l.priv,l.privEnc),l.pub&&this._importPublic(l.pub,l.pubEnc)}n.exports=c,c.fromPublic=function(u,l,d){return l instanceof c?l:new c(u,{pub:l,pubEnc:d})},c.fromPrivate=function(u,l,d){return l instanceof c?l:new c(u,{priv:l,privEnc:d})},c.prototype.validate=function(){var u=this.getPublic();return u.isInfinity()?{result:!1,reason:"Invalid public key"}:u.validate()?u.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},c.prototype.getPublic=function(u,l){return typeof u=="string"&&(l=u,u=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),l?this.pub.encode(l,u):this.pub},c.prototype.getPrivate=function(u){return u==="hex"?this.priv.toString(16,2):this.priv},c.prototype._importPrivate=function(u,l){this.priv=new o(u,l||16),this.priv=this.priv.umod(this.ec.curve.n)},c.prototype._importPublic=function(u,l){if(u.x||u.y)return this.ec.curve.type==="mont"?i(u.x,"Need x coordinate"):this.ec.curve.type!=="short"&&this.ec.curve.type!=="edwards"||i(u.x&&u.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(u.x,u.y));this.pub=this.ec.curve.decodePoint(u,l)},c.prototype.derive=function(u){return u.validate()||i(u.validate(),"public point not validated"),u.mul(this.priv).getX()},c.prototype.sign=function(u,l,d){return this.ec.sign(u,this,l,d)},c.prototype.verify=function(u,l){return this.ec.verify(u,l,this)},c.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"../utils":419,"bn.js":420}],414:[function(t,n,s){var o=t("bn.js"),i=t("../utils"),c=i.assert;function u(p,v){if(p instanceof u)return p;this._importDER(p,v)||(c(p.r&&p.s,"Signature without r or s"),this.r=new o(p.r,16),this.s=new o(p.s,16),p.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=p.recoveryParam)}function l(){this.place=0}function d(p,v){var g=p[v.place++];if(!(128&g))return g;var m=15&g;if(m===0||m>4)return!1;for(var b=0,y=0,S=v.place;y<m;y++,S++)b<<=8,b|=p[S],b>>>=0;return!(b<=127)&&(v.place=S,b)}function h(p){for(var v=0,g=p.length-1;!p[v]&&!(128&p[v+1])&&v<g;)v++;return v===0?p:p.slice(v)}function f(p,v){if(v<128)p.push(v);else{var g=1+(Math.log(v)/Math.LN2>>>3);for(p.push(128|g);--g;)p.push(v>>>(g<<3)&255);p.push(v)}}n.exports=u,u.prototype._importDER=function(p,v){p=i.toArray(p,v);var g=new l;if(p[g.place++]!==48)return!1;var m=d(p,g);if(m===!1||m+g.place!==p.length||p[g.place++]!==2)return!1;var b=d(p,g);if(b===!1)return!1;var y=p.slice(g.place,b+g.place);if(g.place+=b,p[g.place++]!==2)return!1;var S=d(p,g);if(S===!1||p.length!==S+g.place)return!1;var C=p.slice(g.place,S+g.place);if(y[0]===0){if(!(128&y[1]))return!1;y=y.slice(1)}if(C[0]===0){if(!(128&C[1]))return!1;C=C.slice(1)}return this.r=new o(y),this.s=new o(C),this.recoveryParam=null,!0},u.prototype.toDER=function(p){var v=this.r.toArray(),g=this.s.toArray();for(128&v[0]&&(v=[0].concat(v)),128&g[0]&&(g=[0].concat(g)),v=h(v),g=h(g);!(g[0]||128&g[1]);)g=g.slice(1);var m=[2];f(m,v.length),(m=m.concat(v)).push(2),f(m,g.length);var b=m.concat(g),y=[48];return f(y,b.length),y=y.concat(b),i.encode(y,p)}},{"../utils":419,"bn.js":420}],415:[function(t,n,s){var o=t("hash.js"),i=t("../curves"),c=t("../utils"),u=c.assert,l=c.parseBytes,d=t("./key"),h=t("./signature");function f(p){if(u(p==="ed25519","only tested with ed25519 so far"),!(this instanceof f))return new f(p);p=i[p].curve,this.curve=p,this.g=p.g,this.g.precompute(p.n.bitLength()+1),this.pointClass=p.point().constructor,this.encodingLength=Math.ceil(p.n.bitLength()/8),this.hash=o.sha512}n.exports=f,f.prototype.sign=function(p,v){p=l(p);var g=this.keyFromSecret(v),m=this.hashInt(g.messagePrefix(),p),b=this.g.mul(m),y=this.encodePoint(b),S=this.hashInt(y,g.pubBytes(),p).mul(g.priv()),C=m.add(S).umod(this.curve.n);return this.makeSignature({R:b,S:C,Rencoded:y})},f.prototype.verify=function(p,v,g){p=l(p),v=this.makeSignature(v);var m=this.keyFromPublic(g),b=this.hashInt(v.Rencoded(),m.pubBytes(),p),y=this.g.mul(v.S());return v.R().add(m.pub().mul(b)).eq(y)},f.prototype.hashInt=function(){for(var p=this.hash(),v=0;v<arguments.length;v++)p.update(arguments[v]);return c.intFromLE(p.digest()).umod(this.curve.n)},f.prototype.keyFromPublic=function(p){return d.fromPublic(this,p)},f.prototype.keyFromSecret=function(p){return d.fromSecret(this,p)},f.prototype.makeSignature=function(p){return p instanceof h?p:new h(this,p)},f.prototype.encodePoint=function(p){var v=p.getY().toArray("le",this.encodingLength);return v[this.encodingLength-1]|=p.getX().isOdd()?128:0,v},f.prototype.decodePoint=function(p){var v=(p=c.parseBytes(p)).length-1,g=p.slice(0,v).concat(-129&p[v]),m=(128&p[v])!=0,b=c.intFromLE(g);return this.curve.pointFromY(b,m)},f.prototype.encodeInt=function(p){return p.toArray("le",this.encodingLength)},f.prototype.decodeInt=function(p){return c.intFromLE(p)},f.prototype.isPoint=function(p){return p instanceof this.pointClass}},{"../curves":411,"../utils":419,"./key":416,"./signature":417,"hash.js":426}],416:[function(t,n,s){var o=t("../utils"),i=o.assert,c=o.parseBytes,u=o.cachedProperty;function l(d,h){this.eddsa=d,this._secret=c(h.secret),d.isPoint(h.pub)?this._pub=h.pub:this._pubBytes=c(h.pub)}l.fromPublic=function(d,h){return h instanceof l?h:new l(d,{pub:h})},l.fromSecret=function(d,h){return h instanceof l?h:new l(d,{secret:h})},l.prototype.secret=function(){return this._secret},u(l,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),u(l,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),u(l,"privBytes",function(){var d=this.eddsa,h=this.hash(),f=d.encodingLength-1,p=h.slice(0,d.encodingLength);return p[0]&=248,p[f]&=127,p[f]|=64,p}),u(l,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),u(l,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),u(l,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),l.prototype.sign=function(d){return i(this._secret,"KeyPair can only verify"),this.eddsa.sign(d,this)},l.prototype.verify=function(d,h){return this.eddsa.verify(d,h,this)},l.prototype.getSecret=function(d){return i(this._secret,"KeyPair is public only"),o.encode(this.secret(),d)},l.prototype.getPublic=function(d){return o.encode(this.pubBytes(),d)},n.exports=l},{"../utils":419}],417:[function(t,n,s){var o=t("bn.js"),i=t("../utils"),c=i.assert,u=i.cachedProperty,l=i.parseBytes;function d(h,f){this.eddsa=h,typeof f!="object"&&(f=l(f)),Array.isArray(f)&&(f={R:f.slice(0,h.encodingLength),S:f.slice(h.encodingLength)}),c(f.R&&f.S,"Signature without R or S"),h.isPoint(f.R)&&(this._R=f.R),f.S instanceof o&&(this._S=f.S),this._Rencoded=Array.isArray(f.R)?f.R:f.Rencoded,this._Sencoded=Array.isArray(f.S)?f.S:f.Sencoded}u(d,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),u(d,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),u(d,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),u(d,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),d.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},d.prototype.toHex=function(){return i.encode(this.toBytes(),"hex").toUpperCase()},n.exports=d},{"../utils":419,"bn.js":420}],418:[function(t,n,s){n.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},{}],419:[function(t,n,s){var o=s,i=t("bn.js"),c=t("minimalistic-assert"),u=t("minimalistic-crypto-utils");o.assert=c,o.toArray=u.toArray,o.zero2=u.zero2,o.toHex=u.toHex,o.encode=u.encode,o.getNAF=function(l,d,h){var f=new Array(Math.max(l.bitLength(),h)+1);f.fill(0);for(var p=1<<d+1,v=l.clone(),g=0;g<f.length;g++){var m,b=v.andln(p-1);v.isOdd()?(m=b>(p>>1)-1?(p>>1)-b:b,v.isubn(m)):m=0,f[g]=m,v.iushrn(1)}return f},o.getJSF=function(l,d){var h=[[],[]];l=l.clone(),d=d.clone();for(var f,p=0,v=0;l.cmpn(-p)>0||d.cmpn(-v)>0;){var g,m,b=l.andln(3)+p&3,y=d.andln(3)+v&3;b===3&&(b=-1),y===3&&(y=-1),g=(1&b)==0?0:(f=l.andln(7)+p&7)!==3&&f!==5||y!==2?b:-b,h[0].push(g),m=(1&y)==0?0:(f=d.andln(7)+v&7)!==3&&f!==5||b!==2?y:-y,h[1].push(m),2*p===g+1&&(p=1-p),2*v===m+1&&(v=1-v),l.iushrn(1),d.iushrn(1)}return h},o.cachedProperty=function(l,d,h){var f="_"+d;l.prototype[d]=function(){return this[f]!==void 0?this[f]:this[f]=h.call(this)}},o.parseBytes=function(l){return typeof l=="string"?o.toArray(l,"hex"):l},o.intFromLE=function(l){return new i(l,"hex","le")}},{"bn.js":420,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],420:[function(t,n,s){arguments[4][184][0].apply(s,arguments)},{buffer:188,dup:184}],421:[function(t,n,s){n.exports={name:"elliptic",version:"6.5.4",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}},{}],422:[function(t,n,s){var o=Object.create||function(z){var q=function(){};return q.prototype=z,new q},i=Object.keys||function(z){var q=[];for(var D in z)Object.prototype.hasOwnProperty.call(z,D)&&q.push(D);return D},c=Function.prototype.bind||function(z){var q=this;return function(){return q.apply(z,arguments)}};function u(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=o(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}n.exports=u,u.EventEmitter=u,u.prototype._events=void 0,u.prototype._maxListeners=void 0;var l,d=10;try{var h={};Object.defineProperty&&Object.defineProperty(h,"x",{value:0}),l=h.x===0}catch{l=!1}function f(z){return z._maxListeners===void 0?u.defaultMaxListeners:z._maxListeners}function p(z,q,D){if(q)z.call(D);else for(var W=z.length,P=H(z,W),I=0;I<W;++I)P[I].call(D)}function v(z,q,D,W){if(q)z.call(D,W);else for(var P=z.length,I=H(z,P),U=0;U<P;++U)I[U].call(D,W)}function g(z,q,D,W,P){if(q)z.call(D,W,P);else for(var I=z.length,U=H(z,I),k=0;k<I;++k)U[k].call(D,W,P)}function m(z,q,D,W,P,I){if(q)z.call(D,W,P,I);else for(var U=z.length,k=H(z,U),_=0;_<U;++_)k[_].call(D,W,P,I)}function b(z,q,D,W){if(q)z.apply(D,W);else for(var P=z.length,I=H(z,P),U=0;U<P;++U)I[U].apply(D,W)}function y(z,q,D,W){var P,I,U;if(typeof D!="function")throw new TypeError('"listener" argument must be a function');if((I=z._events)?(I.newListener&&(z.emit("newListener",q,D.listener?D.listener:D),I=z._events),U=I[q]):(I=z._events=o(null),z._eventsCount=0),U){if(typeof U=="function"?U=I[q]=W?[D,U]:[U,D]:W?U.unshift(D):U.push(D),!U.warned&&(P=f(z))&&P>0&&U.length>P){U.warned=!0;var k=new Error("Possible EventEmitter memory leak detected. "+U.length+' "'+String(q)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');k.name="MaxListenersExceededWarning",k.emitter=z,k.type=q,k.count=U.length,typeof console=="object"&&console.warn&&console.warn("%s: %s",k.name,k.message)}}else U=I[q]=D,++z._eventsCount;return z}function S(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var z=new Array(arguments.length),q=0;q<z.length;++q)z[q]=arguments[q];this.listener.apply(this.target,z)}}function C(z,q,D){var W={fired:!1,wrapFn:void 0,target:z,type:q,listener:D},P=c.call(S,W);return P.listener=D,W.wrapFn=P,P}function L(z,q,D){var W=z._events;if(!W)return[];var P=W[q];return P?typeof P=="function"?D?[P.listener||P]:[P]:D?function(I){for(var U=new Array(I.length),k=0;k<U.length;++k)U[k]=I[k].listener||I[k];return U}(P):H(P,P.length):[]}function O(z){var q=this._events;if(q){var D=q[z];if(typeof D=="function")return 1;if(D)return D.length}return 0}function H(z,q){for(var D=new Array(q),W=0;W<q;++W)D[W]=z[W];return D}l?Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:function(){return d},set:function(z){if(typeof z!="number"||z<0||z!=z)throw new TypeError('"defaultMaxListeners" must be a positive number');d=z}}):u.defaultMaxListeners=d,u.prototype.setMaxListeners=function(z){if(typeof z!="number"||z<0||isNaN(z))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=z,this},u.prototype.getMaxListeners=function(){return f(this)},u.prototype.emit=function(z){var q,D,W,P,I,U,k=z==="error";if(U=this._events)k=k&&U.error==null;else if(!k)return!1;if(k){if(arguments.length>1&&(q=arguments[1]),q instanceof Error)throw q;var _=new Error('Unhandled "error" event. ('+q+")");throw _.context=q,_}if(!(D=U[z]))return!1;var R=typeof D=="function";switch(W=arguments.length){case 1:p(D,R,this);break;case 2:v(D,R,this,arguments[1]);break;case 3:g(D,R,this,arguments[1],arguments[2]);break;case 4:m(D,R,this,arguments[1],arguments[2],arguments[3]);break;default:for(P=new Array(W-1),I=1;I<W;I++)P[I-1]=arguments[I];b(D,R,this,P)}return!0},u.prototype.addListener=function(z,q){return y(this,z,q,!1)},u.prototype.on=u.prototype.addListener,u.prototype.prependListener=function(z,q){return y(this,z,q,!0)},u.prototype.once=function(z,q){if(typeof q!="function")throw new TypeError('"listener" argument must be a function');return this.on(z,C(this,z,q)),this},u.prototype.prependOnceListener=function(z,q){if(typeof q!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(z,C(this,z,q)),this},u.prototype.removeListener=function(z,q){var D,W,P,I,U;if(typeof q!="function")throw new TypeError('"listener" argument must be a function');if(!(W=this._events))return this;if(!(D=W[z]))return this;if(D===q||D.listener===q)--this._eventsCount==0?this._events=o(null):(delete W[z],W.removeListener&&this.emit("removeListener",z,D.listener||q));else if(typeof D!="function"){for(P=-1,I=D.length-1;I>=0;I--)if(D[I]===q||D[I].listener===q){U=D[I].listener,P=I;break}if(P<0)return this;P===0?D.shift():function(k,_){for(var R=_,j=R+1,A=k.length;j<A;R+=1,j+=1)k[R]=k[j];k.pop()}(D,P),D.length===1&&(W[z]=D[0]),W.removeListener&&this.emit("removeListener",z,U||q)}return this},u.prototype.removeAllListeners=function(z){var q,D,W;if(!(D=this._events))return this;if(!D.removeListener)return arguments.length===0?(this._events=o(null),this._eventsCount=0):D[z]&&(--this._eventsCount==0?this._events=o(null):delete D[z]),this;if(arguments.length===0){var P,I=i(D);for(W=0;W<I.length;++W)(P=I[W])!=="removeListener"&&this.removeAllListeners(P);return this.removeAllListeners("removeListener"),this._events=o(null),this._eventsCount=0,this}if(typeof(q=D[z])=="function")this.removeListener(z,q);else if(q)for(W=q.length-1;W>=0;W--)this.removeListener(z,q[W]);return this},u.prototype.listeners=function(z){return L(this,z,!0)},u.prototype.rawListeners=function(z){return L(this,z,!1)},u.listenerCount=function(z,q){return typeof z.listenerCount=="function"?z.listenerCount(q):O.call(z,q)},u.prototype.listenerCount=O,u.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],423:[function(t,n,s){var o=t("safe-buffer").Buffer,i=t("md5.js");n.exports=function(c,u,l,d){if(o.isBuffer(c)||(c=o.from(c,"binary")),u&&(o.isBuffer(u)||(u=o.from(u,"binary")),u.length!==8))throw new RangeError("salt should be Buffer with 8 byte length");for(var h=l/8,f=o.alloc(h),p=o.alloc(d||0),v=o.alloc(0);h>0||d>0;){var g=new i;g.update(v),g.update(c),u&&g.update(u),v=g.digest();var m=0;if(h>0){var b=f.length-h;m=Math.min(h,v.length),v.copy(f,b,0,m),h-=m}if(m<v.length&&d>0){var y=p.length-d,S=Math.min(d,v.length-m);v.copy(p,y,m,m+S),d-=S}}return v.fill(0),{key:f,iv:p}}},{"md5.js":450,"safe-buffer":494}],424:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.CsvParserStream=s.ParserOptions=s.parseFile=s.parseStream=s.parseString=s.parse=s.FormatterOptions=s.CsvFormatterStream=s.writeToPath=s.writeToString=s.writeToBuffer=s.writeToStream=s.write=s.format=void 0;var o=t("@fast-csv/format");Object.defineProperty(s,"format",{enumerable:!0,get:function(){return o.format}}),Object.defineProperty(s,"write",{enumerable:!0,get:function(){return o.write}}),Object.defineProperty(s,"writeToStream",{enumerable:!0,get:function(){return o.writeToStream}}),Object.defineProperty(s,"writeToBuffer",{enumerable:!0,get:function(){return o.writeToBuffer}}),Object.defineProperty(s,"writeToString",{enumerable:!0,get:function(){return o.writeToString}}),Object.defineProperty(s,"writeToPath",{enumerable:!0,get:function(){return o.writeToPath}}),Object.defineProperty(s,"CsvFormatterStream",{enumerable:!0,get:function(){return o.CsvFormatterStream}}),Object.defineProperty(s,"FormatterOptions",{enumerable:!0,get:function(){return o.FormatterOptions}});var i=t("@fast-csv/parse");Object.defineProperty(s,"parse",{enumerable:!0,get:function(){return i.parse}}),Object.defineProperty(s,"parseString",{enumerable:!0,get:function(){return i.parseString}}),Object.defineProperty(s,"parseStream",{enumerable:!0,get:function(){return i.parseStream}}),Object.defineProperty(s,"parseFile",{enumerable:!0,get:function(){return i.parseFile}}),Object.defineProperty(s,"ParserOptions",{enumerable:!0,get:function(){return i.ParserOptions}}),Object.defineProperty(s,"CsvParserStream",{enumerable:!0,get:function(){return i.CsvParserStream}})},{"@fast-csv/format":151,"@fast-csv/parse":155}],425:[function(t,n,s){var o=t("safe-buffer").Buffer,i=t("readable-stream").Transform;function c(u){i.call(this),this._block=o.allocUnsafe(u),this._blockSize=u,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}t("inherits")(c,i),c.prototype._transform=function(u,l,d){var h=null;try{this.update(u,l)}catch(f){h=f}d(h)},c.prototype._flush=function(u){var l=null;try{this.push(this.digest())}catch(d){l=d}u(l)},c.prototype.update=function(u,l){if(function(g,m){if(!o.isBuffer(g)&&typeof g!="string")throw new TypeError(m+" must be a string or a buffer")}(u,"Data"),this._finalized)throw new Error("Digest already called");o.isBuffer(u)||(u=o.from(u,l));for(var d=this._block,h=0;this._blockOffset+u.length-h>=this._blockSize;){for(var f=this._blockOffset;f<this._blockSize;)d[f++]=u[h++];this._update(),this._blockOffset=0}for(;h<u.length;)d[this._blockOffset++]=u[h++];for(var p=0,v=8*u.length;v>0;++p)this._length[p]+=v,(v=this._length[p]/4294967296|0)>0&&(this._length[p]-=4294967296*v);return this},c.prototype._update=function(){throw new Error("_update is not implemented")},c.prototype.digest=function(u){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var l=this._digest();u!==void 0&&(l=l.toString(u)),this._block.fill(0),this._blockOffset=0;for(var d=0;d<4;++d)this._length[d]=0;return l},c.prototype._digest=function(){throw new Error("_digest is not implemented")},n.exports=c},{inherits:440,"readable-stream":491,"safe-buffer":494}],426:[function(t,n,s){var o=s;o.utils=t("./hash/utils"),o.common=t("./hash/common"),o.sha=t("./hash/sha"),o.ripemd=t("./hash/ripemd"),o.hmac=t("./hash/hmac"),o.sha1=o.sha.sha1,o.sha256=o.sha.sha256,o.sha224=o.sha.sha224,o.sha384=o.sha.sha384,o.sha512=o.sha.sha512,o.ripemd160=o.ripemd.ripemd160},{"./hash/common":427,"./hash/hmac":428,"./hash/ripemd":429,"./hash/sha":430,"./hash/utils":437}],427:[function(t,n,s){var o=t("./utils"),i=t("minimalistic-assert");function c(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}s.BlockHash=c,c.prototype.update=function(u,l){if(u=o.toArray(u,l),this.pending?this.pending=this.pending.concat(u):this.pending=u,this.pendingTotal+=u.length,this.pending.length>=this._delta8){var d=(u=this.pending).length%this._delta8;this.pending=u.slice(u.length-d,u.length),this.pending.length===0&&(this.pending=null),u=o.join32(u,0,u.length-d,this.endian);for(var h=0;h<u.length;h+=this._delta32)this._update(u,h,h+this._delta32)}return this},c.prototype.digest=function(u){return this.update(this._pad()),i(this.pending===null),this._digest(u)},c.prototype._pad=function(){var u=this.pendingTotal,l=this._delta8,d=l-(u+this.padLength)%l,h=new Array(d+this.padLength);h[0]=128;for(var f=1;f<d;f++)h[f]=0;if(u<<=3,this.endian==="big"){for(var p=8;p<this.padLength;p++)h[f++]=0;h[f++]=0,h[f++]=0,h[f++]=0,h[f++]=0,h[f++]=u>>>24&255,h[f++]=u>>>16&255,h[f++]=u>>>8&255,h[f++]=255&u}else for(h[f++]=255&u,h[f++]=u>>>8&255,h[f++]=u>>>16&255,h[f++]=u>>>24&255,h[f++]=0,h[f++]=0,h[f++]=0,h[f++]=0,p=8;p<this.padLength;p++)h[f++]=0;return h}},{"./utils":437,"minimalistic-assert":453}],428:[function(t,n,s){var o=t("./utils"),i=t("minimalistic-assert");function c(u,l,d){if(!(this instanceof c))return new c(u,l,d);this.Hash=u,this.blockSize=u.blockSize/8,this.outSize=u.outSize/8,this.inner=null,this.outer=null,this._init(o.toArray(l,d))}n.exports=c,c.prototype._init=function(u){u.length>this.blockSize&&(u=new this.Hash().update(u).digest()),i(u.length<=this.blockSize);for(var l=u.length;l<this.blockSize;l++)u.push(0);for(l=0;l<u.length;l++)u[l]^=54;for(this.inner=new this.Hash().update(u),l=0;l<u.length;l++)u[l]^=106;this.outer=new this.Hash().update(u)},c.prototype.update=function(u,l){return this.inner.update(u,l),this},c.prototype.digest=function(u){return this.outer.update(this.inner.digest()),this.outer.digest(u)}},{"./utils":437,"minimalistic-assert":453}],429:[function(t,n,s){var o=t("./utils"),i=t("./common"),c=o.rotl32,u=o.sum32,l=o.sum32_3,d=o.sum32_4,h=i.BlockHash;function f(){if(!(this instanceof f))return new f;h.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function p(C,L,O,H){return C<=15?L^O^H:C<=31?L&O|~L&H:C<=47?(L|~O)^H:C<=63?L&H|O&~H:L^(O|~H)}function v(C){return C<=15?0:C<=31?1518500249:C<=47?1859775393:C<=63?2400959708:2840853838}function g(C){return C<=15?1352829926:C<=31?1548603684:C<=47?1836072691:C<=63?2053994217:0}o.inherits(f,h),s.ripemd160=f,f.blockSize=512,f.outSize=160,f.hmacStrength=192,f.padLength=64,f.prototype._update=function(C,L){for(var O=this.h[0],H=this.h[1],z=this.h[2],q=this.h[3],D=this.h[4],W=O,P=H,I=z,U=q,k=D,_=0;_<80;_++){var R=u(c(d(O,p(_,H,z,q),C[m[_]+L],v(_)),y[_]),D);O=D,D=q,q=c(z,10),z=H,H=R,R=u(c(d(W,p(79-_,P,I,U),C[b[_]+L],g(_)),S[_]),k),W=k,k=U,U=c(I,10),I=P,P=R}R=l(this.h[1],z,U),this.h[1]=l(this.h[2],q,k),this.h[2]=l(this.h[3],D,W),this.h[3]=l(this.h[4],O,P),this.h[4]=l(this.h[0],H,I),this.h[0]=R},f.prototype._digest=function(C){return C==="hex"?o.toHex32(this.h,"little"):o.split32(this.h,"little")};var m=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],b=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],y=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],S=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"./common":427,"./utils":437}],430:[function(t,n,s){s.sha1=t("./sha/1"),s.sha224=t("./sha/224"),s.sha256=t("./sha/256"),s.sha384=t("./sha/384"),s.sha512=t("./sha/512")},{"./sha/1":431,"./sha/224":432,"./sha/256":433,"./sha/384":434,"./sha/512":435}],431:[function(t,n,s){var o=t("../utils"),i=t("../common"),c=t("./common"),u=o.rotl32,l=o.sum32,d=o.sum32_5,h=c.ft_1,f=i.BlockHash,p=[1518500249,1859775393,2400959708,3395469782];function v(){if(!(this instanceof v))return new v;f.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}o.inherits(v,f),n.exports=v,v.blockSize=512,v.outSize=160,v.hmacStrength=80,v.padLength=64,v.prototype._update=function(g,m){for(var b=this.W,y=0;y<16;y++)b[y]=g[m+y];for(;y<b.length;y++)b[y]=u(b[y-3]^b[y-8]^b[y-14]^b[y-16],1);var S=this.h[0],C=this.h[1],L=this.h[2],O=this.h[3],H=this.h[4];for(y=0;y<b.length;y++){var z=~~(y/20),q=d(u(S,5),h(z,C,L,O),H,b[y],p[z]);H=O,O=L,L=u(C,30),C=S,S=q}this.h[0]=l(this.h[0],S),this.h[1]=l(this.h[1],C),this.h[2]=l(this.h[2],L),this.h[3]=l(this.h[3],O),this.h[4]=l(this.h[4],H)},v.prototype._digest=function(g){return g==="hex"?o.toHex32(this.h,"big"):o.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436}],432:[function(t,n,s){var o=t("../utils"),i=t("./256");function c(){if(!(this instanceof c))return new c;i.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}o.inherits(c,i),n.exports=c,c.blockSize=512,c.outSize=224,c.hmacStrength=192,c.padLength=64,c.prototype._digest=function(u){return u==="hex"?o.toHex32(this.h.slice(0,7),"big"):o.split32(this.h.slice(0,7),"big")}},{"../utils":437,"./256":433}],433:[function(t,n,s){var o=t("../utils"),i=t("../common"),c=t("./common"),u=t("minimalistic-assert"),l=o.sum32,d=o.sum32_4,h=o.sum32_5,f=c.ch32,p=c.maj32,v=c.s0_256,g=c.s1_256,m=c.g0_256,b=c.g1_256,y=i.BlockHash,S=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function C(){if(!(this instanceof C))return new C;y.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=S,this.W=new Array(64)}o.inherits(C,y),n.exports=C,C.blockSize=512,C.outSize=256,C.hmacStrength=192,C.padLength=64,C.prototype._update=function(L,O){for(var H=this.W,z=0;z<16;z++)H[z]=L[O+z];for(;z<H.length;z++)H[z]=d(b(H[z-2]),H[z-7],m(H[z-15]),H[z-16]);var q=this.h[0],D=this.h[1],W=this.h[2],P=this.h[3],I=this.h[4],U=this.h[5],k=this.h[6],_=this.h[7];for(u(this.k.length===H.length),z=0;z<H.length;z++){var R=h(_,g(I),f(I,U,k),this.k[z],H[z]),j=l(v(q),p(q,D,W));_=k,k=U,U=I,I=l(P,R),P=W,W=D,D=q,q=l(R,j)}this.h[0]=l(this.h[0],q),this.h[1]=l(this.h[1],D),this.h[2]=l(this.h[2],W),this.h[3]=l(this.h[3],P),this.h[4]=l(this.h[4],I),this.h[5]=l(this.h[5],U),this.h[6]=l(this.h[6],k),this.h[7]=l(this.h[7],_)},C.prototype._digest=function(L){return L==="hex"?o.toHex32(this.h,"big"):o.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436,"minimalistic-assert":453}],434:[function(t,n,s){var o=t("../utils"),i=t("./512");function c(){if(!(this instanceof c))return new c;i.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}o.inherits(c,i),n.exports=c,c.blockSize=1024,c.outSize=384,c.hmacStrength=192,c.padLength=128,c.prototype._digest=function(u){return u==="hex"?o.toHex32(this.h.slice(0,12),"big"):o.split32(this.h.slice(0,12),"big")}},{"../utils":437,"./512":435}],435:[function(t,n,s){var o=t("../utils"),i=t("../common"),c=t("minimalistic-assert"),u=o.rotr64_hi,l=o.rotr64_lo,d=o.shr64_hi,h=o.shr64_lo,f=o.sum64,p=o.sum64_hi,v=o.sum64_lo,g=o.sum64_4_hi,m=o.sum64_4_lo,b=o.sum64_5_hi,y=o.sum64_5_lo,S=i.BlockHash,C=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function L(){if(!(this instanceof L))return new L;S.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=C,this.W=new Array(160)}function O(j,A,N,V,M){var Z=j&N^~j&M;return Z<0&&(Z+=4294967296),Z}function H(j,A,N,V,M,Z){var J=A&V^~A&Z;return J<0&&(J+=4294967296),J}function z(j,A,N,V,M){var Z=j&N^j&M^N&M;return Z<0&&(Z+=4294967296),Z}function q(j,A,N,V,M,Z){var J=A&V^A&Z^V&Z;return J<0&&(J+=4294967296),J}function D(j,A){var N=u(j,A,28)^u(A,j,2)^u(A,j,7);return N<0&&(N+=4294967296),N}function W(j,A){var N=l(j,A,28)^l(A,j,2)^l(A,j,7);return N<0&&(N+=4294967296),N}function P(j,A){var N=u(j,A,14)^u(j,A,18)^u(A,j,9);return N<0&&(N+=4294967296),N}function I(j,A){var N=l(j,A,14)^l(j,A,18)^l(A,j,9);return N<0&&(N+=4294967296),N}function U(j,A){var N=u(j,A,1)^u(j,A,8)^d(j,A,7);return N<0&&(N+=4294967296),N}function k(j,A){var N=l(j,A,1)^l(j,A,8)^h(j,A,7);return N<0&&(N+=4294967296),N}function _(j,A){var N=u(j,A,19)^u(A,j,29)^d(j,A,6);return N<0&&(N+=4294967296),N}function R(j,A){var N=l(j,A,19)^l(A,j,29)^h(j,A,6);return N<0&&(N+=4294967296),N}o.inherits(L,S),n.exports=L,L.blockSize=1024,L.outSize=512,L.hmacStrength=192,L.padLength=128,L.prototype._prepareBlock=function(j,A){for(var N=this.W,V=0;V<32;V++)N[V]=j[A+V];for(;V<N.length;V+=2){var M=_(N[V-4],N[V-3]),Z=R(N[V-4],N[V-3]),J=N[V-14],re=N[V-13],X=U(N[V-30],N[V-29]),ne=k(N[V-30],N[V-29]),Y=N[V-32],K=N[V-31];N[V]=g(M,Z,J,re,X,ne,Y,K),N[V+1]=m(M,Z,J,re,X,ne,Y,K)}},L.prototype._update=function(j,A){this._prepareBlock(j,A);var N=this.W,V=this.h[0],M=this.h[1],Z=this.h[2],J=this.h[3],re=this.h[4],X=this.h[5],ne=this.h[6],Y=this.h[7],K=this.h[8],ee=this.h[9],ue=this.h[10],se=this.h[11],ce=this.h[12],fe=this.h[13],ve=this.h[14],_e=this.h[15];c(this.k.length===N.length);for(var le=0;le<N.length;le+=2){var ke=ve,Te=_e,pe=P(K,ee),ye=I(K,ee),ge=O(K,ee,ue,se,ce),De=H(K,ee,ue,se,ce,fe),He=this.k[le],Xe=this.k[le+1],at=N[le],dt=N[le+1],wt=b(ke,Te,pe,ye,ge,De,He,Xe,at,dt),$t=y(ke,Te,pe,ye,ge,De,He,Xe,at,dt);ke=D(V,M),Te=W(V,M),pe=z(V,M,Z,J,re),ye=q(V,M,Z,J,re,X);var Bt=p(ke,Te,pe,ye),ft=v(ke,Te,pe,ye);ve=ce,_e=fe,ce=ue,fe=se,ue=K,se=ee,K=p(ne,Y,wt,$t),ee=v(Y,Y,wt,$t),ne=re,Y=X,re=Z,X=J,Z=V,J=M,V=p(wt,$t,Bt,ft),M=v(wt,$t,Bt,ft)}f(this.h,0,V,M),f(this.h,2,Z,J),f(this.h,4,re,X),f(this.h,6,ne,Y),f(this.h,8,K,ee),f(this.h,10,ue,se),f(this.h,12,ce,fe),f(this.h,14,ve,_e)},L.prototype._digest=function(j){return j==="hex"?o.toHex32(this.h,"big"):o.split32(this.h,"big")}},{"../common":427,"../utils":437,"minimalistic-assert":453}],436:[function(t,n,s){var o=t("../utils").rotr32;function i(l,d,h){return l&d^~l&h}function c(l,d,h){return l&d^l&h^d&h}function u(l,d,h){return l^d^h}s.ft_1=function(l,d,h,f){return l===0?i(d,h,f):l===1||l===3?u(d,h,f):l===2?c(d,h,f):void 0},s.ch32=i,s.maj32=c,s.p32=u,s.s0_256=function(l){return o(l,2)^o(l,13)^o(l,22)},s.s1_256=function(l){return o(l,6)^o(l,11)^o(l,25)},s.g0_256=function(l){return o(l,7)^o(l,18)^l>>>3},s.g1_256=function(l){return o(l,17)^o(l,19)^l>>>10}},{"../utils":437}],437:[function(t,n,s){var o=t("minimalistic-assert"),i=t("inherits");function c(h,f){return(64512&h.charCodeAt(f))==55296&&!(f<0||f+1>=h.length)&&(64512&h.charCodeAt(f+1))==56320}function u(h){return(h>>>24|h>>>8&65280|h<<8&16711680|(255&h)<<24)>>>0}function l(h){return h.length===1?"0"+h:h}function d(h){return h.length===7?"0"+h:h.length===6?"00"+h:h.length===5?"000"+h:h.length===4?"0000"+h:h.length===3?"00000"+h:h.length===2?"000000"+h:h.length===1?"0000000"+h:h}s.inherits=i,s.toArray=function(h,f){if(Array.isArray(h))return h.slice();if(!h)return[];var p=[];if(typeof h=="string")if(f){if(f==="hex")for((h=h.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(h="0"+h),g=0;g<h.length;g+=2)p.push(parseInt(h[g]+h[g+1],16))}else for(var v=0,g=0;g<h.length;g++){var m=h.charCodeAt(g);m<128?p[v++]=m:m<2048?(p[v++]=m>>6|192,p[v++]=63&m|128):c(h,g)?(m=65536+((1023&m)<<10)+(1023&h.charCodeAt(++g)),p[v++]=m>>18|240,p[v++]=m>>12&63|128,p[v++]=m>>6&63|128,p[v++]=63&m|128):(p[v++]=m>>12|224,p[v++]=m>>6&63|128,p[v++]=63&m|128)}else for(g=0;g<h.length;g++)p[g]=0|h[g];return p},s.toHex=function(h){for(var f="",p=0;p<h.length;p++)f+=l(h[p].toString(16));return f},s.htonl=u,s.toHex32=function(h,f){for(var p="",v=0;v<h.length;v++){var g=h[v];f==="little"&&(g=u(g)),p+=d(g.toString(16))}return p},s.zero2=l,s.zero8=d,s.join32=function(h,f,p,v){var g=p-f;o(g%4==0);for(var m=new Array(g/4),b=0,y=f;b<m.length;b++,y+=4){var S;S=v==="big"?h[y]<<24|h[y+1]<<16|h[y+2]<<8|h[y+3]:h[y+3]<<24|h[y+2]<<16|h[y+1]<<8|h[y],m[b]=S>>>0}return m},s.split32=function(h,f){for(var p=new Array(4*h.length),v=0,g=0;v<h.length;v++,g+=4){var m=h[v];f==="big"?(p[g]=m>>>24,p[g+1]=m>>>16&255,p[g+2]=m>>>8&255,p[g+3]=255&m):(p[g+3]=m>>>24,p[g+2]=m>>>16&255,p[g+1]=m>>>8&255,p[g]=255&m)}return p},s.rotr32=function(h,f){return h>>>f|h<<32-f},s.rotl32=function(h,f){return h<<f|h>>>32-f},s.sum32=function(h,f){return h+f>>>0},s.sum32_3=function(h,f,p){return h+f+p>>>0},s.sum32_4=function(h,f,p,v){return h+f+p+v>>>0},s.sum32_5=function(h,f,p,v,g){return h+f+p+v+g>>>0},s.sum64=function(h,f,p,v){var g=h[f],m=v+h[f+1]>>>0,b=(m<v?1:0)+p+g;h[f]=b>>>0,h[f+1]=m},s.sum64_hi=function(h,f,p,v){return(f+v>>>0<f?1:0)+h+p>>>0},s.sum64_lo=function(h,f,p,v){return f+v>>>0},s.sum64_4_hi=function(h,f,p,v,g,m,b,y){var S=0,C=f;return S+=(C=C+v>>>0)<f?1:0,S+=(C=C+m>>>0)<m?1:0,h+p+g+b+(S+=(C=C+y>>>0)<y?1:0)>>>0},s.sum64_4_lo=function(h,f,p,v,g,m,b,y){return f+v+m+y>>>0},s.sum64_5_hi=function(h,f,p,v,g,m,b,y,S,C){var L=0,O=f;return L+=(O=O+v>>>0)<f?1:0,L+=(O=O+m>>>0)<m?1:0,L+=(O=O+y>>>0)<y?1:0,h+p+g+b+S+(L+=(O=O+C>>>0)<C?1:0)>>>0},s.sum64_5_lo=function(h,f,p,v,g,m,b,y,S,C){return f+v+m+y+C>>>0},s.rotr64_hi=function(h,f,p){return(f<<32-p|h>>>p)>>>0},s.rotr64_lo=function(h,f,p){return(h<<32-p|f>>>p)>>>0},s.shr64_hi=function(h,f,p){return h>>>p},s.shr64_lo=function(h,f,p){return(h<<32-p|f>>>p)>>>0}},{inherits:440,"minimalistic-assert":453}],438:[function(t,n,s){var o=t("hash.js"),i=t("minimalistic-crypto-utils"),c=t("minimalistic-assert");function u(l){if(!(this instanceof u))return new u(l);this.hash=l.hash,this.predResist=!!l.predResist,this.outLen=this.hash.outSize,this.minEntropy=l.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var d=i.toArray(l.entropy,l.entropyEnc||"hex"),h=i.toArray(l.nonce,l.nonceEnc||"hex"),f=i.toArray(l.pers,l.persEnc||"hex");c(d.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(d,h,f)}n.exports=u,u.prototype._init=function(l,d,h){var f=l.concat(d).concat(h);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var p=0;p<this.V.length;p++)this.K[p]=0,this.V[p]=1;this._update(f),this._reseed=1,this.reseedInterval=281474976710656},u.prototype._hmac=function(){return new o.hmac(this.hash,this.K)},u.prototype._update=function(l){var d=this._hmac().update(this.V).update([0]);l&&(d=d.update(l)),this.K=d.digest(),this.V=this._hmac().update(this.V).digest(),l&&(this.K=this._hmac().update(this.V).update([1]).update(l).digest(),this.V=this._hmac().update(this.V).digest())},u.prototype.reseed=function(l,d,h,f){typeof d!="string"&&(f=h,h=d,d=null),l=i.toArray(l,d),h=i.toArray(h,f),c(l.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(l.concat(h||[])),this._reseed=1},u.prototype.generate=function(l,d,h,f){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof d!="string"&&(f=h,h=d,d=null),h&&(h=i.toArray(h,f||"hex"),this._update(h));for(var p=[];p.length<l;)this.V=this._hmac().update(this.V).digest(),p=p.concat(this.V);var v=p.slice(0,l);return this._update(h),this._reseed++,i.encode(v,d)}},{"hash.js":426,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],439:[function(t,n,s){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */s.read=function(o,i,c,u,l){var d,h,f=8*l-u-1,p=(1<<f)-1,v=p>>1,g=-7,m=c?l-1:0,b=c?-1:1,y=o[i+m];for(m+=b,d=y&(1<<-g)-1,y>>=-g,g+=f;g>0;d=256*d+o[i+m],m+=b,g-=8);for(h=d&(1<<-g)-1,d>>=-g,g+=u;g>0;h=256*h+o[i+m],m+=b,g-=8);if(d===0)d=1-v;else{if(d===p)return h?NaN:1/0*(y?-1:1);h+=Math.pow(2,u),d-=v}return(y?-1:1)*h*Math.pow(2,d-u)},s.write=function(o,i,c,u,l,d){var h,f,p,v=8*d-l-1,g=(1<<v)-1,m=g>>1,b=l===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=u?0:d-1,S=u?1:-1,C=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(f=isNaN(i)?1:0,h=g):(h=Math.floor(Math.log(i)/Math.LN2),i*(p=Math.pow(2,-h))<1&&(h--,p*=2),(i+=h+m>=1?b/p:b*Math.pow(2,1-m))*p>=2&&(h++,p/=2),h+m>=g?(f=0,h=g):h+m>=1?(f=(i*p-1)*Math.pow(2,l),h+=m):(f=i*Math.pow(2,m-1)*Math.pow(2,l),h=0));l>=8;o[c+y]=255&f,y+=S,f/=256,l-=8);for(h=h<<l|f,v+=l;v>0;o[c+y]=255&h,y+=S,h/=256,v-=8);o[c+y-S]|=128*C}},{}],440:[function(t,n,s){typeof Object.create=="function"?n.exports=function(o,i){i&&(o.super_=i,o.prototype=Object.create(i.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}))}:n.exports=function(o,i){if(i){o.super_=i;var c=function(){};c.prototype=i.prototype,o.prototype=new c,o.prototype.constructor=o}}},{}],441:[function(t,n,s){(function(o,i,c,u,l,d,h,f){(function(){/*!

		JSZip v3.10.1 - A JavaScript class for generating and reading zip files
		<http://stuartk.com/jszip>

		(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
		Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

		JSZip uses the library pako released under the MIT license :
		https://github.com/nodeca/pako/blob/main/LICENSE
		*/(function(p){typeof s=="object"&&n!==void 0?n.exports=p():(typeof window<"u"?window:i!==void 0?i:typeof self<"u"?self:this).JSZip=p()})(function(){return function p(v,g,m){function b(C,L){if(!g[C]){if(!v[C]){var O=typeof t=="function"&&t;if(!L&&O)return O(C,!0);if(y)return y(C,!0);var H=new Error("Cannot find module '"+C+"'");throw H.code="MODULE_NOT_FOUND",H}var z=g[C]={exports:{}};v[C][0].call(z.exports,function(q){return b(v[C][1][q]||q)},z,z.exports,p,v,g,m)}return g[C].exports}for(var y=typeof t=="function"&&t,S=0;S<m.length;S++)b(m[S]);return b}({1:[function(p,v,g){var m=p("./utils"),b=p("./support"),y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";g.encode=function(S){for(var C,L,O,H,z,q,D,W=[],P=0,I=S.length,U=I,k=m.getTypeOf(S)!=="string";P<S.length;)U=I-P,O=k?(C=S[P++],L=P<I?S[P++]:0,P<I?S[P++]:0):(C=S.charCodeAt(P++),L=P<I?S.charCodeAt(P++):0,P<I?S.charCodeAt(P++):0),H=C>>2,z=(3&C)<<4|L>>4,q=1<U?(15&L)<<2|O>>6:64,D=2<U?63&O:64,W.push(y.charAt(H)+y.charAt(z)+y.charAt(q)+y.charAt(D));return W.join("")},g.decode=function(S){var C,L,O,H,z,q,D=0,W=0,P="data:";if(S.substr(0,P.length)===P)throw new Error("Invalid base64 input, it looks like a data url.");var I,U=3*(S=S.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(S.charAt(S.length-1)===y.charAt(64)&&U--,S.charAt(S.length-2)===y.charAt(64)&&U--,U%1!=0)throw new Error("Invalid base64 input, bad content length.");for(I=b.uint8array?new Uint8Array(0|U):new Array(0|U);D<S.length;)C=y.indexOf(S.charAt(D++))<<2|(H=y.indexOf(S.charAt(D++)))>>4,L=(15&H)<<4|(z=y.indexOf(S.charAt(D++)))>>2,O=(3&z)<<6|(q=y.indexOf(S.charAt(D++))),I[W++]=C,z!==64&&(I[W++]=L),q!==64&&(I[W++]=O);return I}},{"./support":30,"./utils":32}],2:[function(p,v,g){var m=p("./external"),b=p("./stream/DataWorker"),y=p("./stream/Crc32Probe"),S=p("./stream/DataLengthProbe");function C(L,O,H,z,q){this.compressedSize=L,this.uncompressedSize=O,this.crc32=H,this.compression=z,this.compressedContent=q}C.prototype={getContentWorker:function(){var L=new b(m.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new S("data_length")),O=this;return L.on("end",function(){if(this.streamInfo.data_length!==O.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),L},getCompressedWorker:function(){return new b(m.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},C.createWorkerFrom=function(L,O,H){return L.pipe(new y).pipe(new S("uncompressedSize")).pipe(O.compressWorker(H)).pipe(new S("compressedSize")).withStreamInfo("compression",O)},v.exports=C},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(p,v,g){var m=p("./stream/GenericWorker");g.STORE={magic:"\0\0",compressWorker:function(){return new m("STORE compression")},uncompressWorker:function(){return new m("STORE decompression")}},g.DEFLATE=p("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(p,v,g){var m=p("./utils"),b=function(){for(var y,S=[],C=0;C<256;C++){y=C;for(var L=0;L<8;L++)y=1&y?3988292384^y>>>1:y>>>1;S[C]=y}return S}();v.exports=function(y,S){return y!==void 0&&y.length?m.getTypeOf(y)!=="string"?function(C,L,O,H){var z=b,q=0+O;C^=-1;for(var D=0;D<q;D++)C=C>>>8^z[255&(C^L[D])];return-1^C}(0|S,y,y.length):function(C,L,O,H){var z=b,q=0+O;C^=-1;for(var D=0;D<q;D++)C=C>>>8^z[255&(C^L.charCodeAt(D))];return-1^C}(0|S,y,y.length):0}},{"./utils":32}],5:[function(p,v,g){g.base64=!1,g.binary=!1,g.dir=!1,g.createFolders=!0,g.date=null,g.compression=null,g.compressionOptions=null,g.comment=null,g.unixPermissions=null,g.dosPermissions=null},{}],6:[function(p,v,g){var m;m=typeof Promise<"u"?Promise:p("lie"),v.exports={Promise:m}},{lie:37}],7:[function(p,v,g){var m=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",b=p("pako"),y=p("./utils"),S=p("./stream/GenericWorker"),C=m?"uint8array":"array";function L(O,H){S.call(this,"FlateWorker/"+O),this._pako=null,this._pakoAction=O,this._pakoOptions=H,this.meta={}}g.magic="\b\0",y.inherits(L,S),L.prototype.processChunk=function(O){this.meta=O.meta,this._pako===null&&this._createPako(),this._pako.push(y.transformTo(C,O.data),!1)},L.prototype.flush=function(){S.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},L.prototype.cleanUp=function(){S.prototype.cleanUp.call(this),this._pako=null},L.prototype._createPako=function(){this._pako=new b[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var O=this;this._pako.onData=function(H){O.push({data:H,meta:O.meta})}},g.compressWorker=function(O){return new L("Deflate",O)},g.uncompressWorker=function(){return new L("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(p,v,g){function m(z,q){var D,W="";for(D=0;D<q;D++)W+=String.fromCharCode(255&z),z>>>=8;return W}function b(z,q,D,W,P,I){var U,k,_=z.file,R=z.compression,j=I!==C.utf8encode,A=y.transformTo("string",I(_.name)),N=y.transformTo("string",C.utf8encode(_.name)),V=_.comment,M=y.transformTo("string",I(V)),Z=y.transformTo("string",C.utf8encode(V)),J=N.length!==_.name.length,re=Z.length!==V.length,X="",ne="",Y="",K=_.dir,ee=_.date,ue={crc32:0,compressedSize:0,uncompressedSize:0};q&&!D||(ue.crc32=z.crc32,ue.compressedSize=z.compressedSize,ue.uncompressedSize=z.uncompressedSize);var se=0;q&&(se|=8),j||!J&&!re||(se|=2048);var ce=0,fe=0;K&&(ce|=16),P==="UNIX"?(fe=798,ce|=function(_e,le){var ke=_e;return _e||(ke=le?16893:33204),(65535&ke)<<16}(_.unixPermissions,K)):(fe=20,ce|=function(_e){return 63&(_e||0)}(_.dosPermissions)),U=ee.getUTCHours(),U<<=6,U|=ee.getUTCMinutes(),U<<=5,U|=ee.getUTCSeconds()/2,k=ee.getUTCFullYear()-1980,k<<=4,k|=ee.getUTCMonth()+1,k<<=5,k|=ee.getUTCDate(),J&&(ne=m(1,1)+m(L(A),4)+N,X+="up"+m(ne.length,2)+ne),re&&(Y=m(1,1)+m(L(M),4)+Z,X+="uc"+m(Y.length,2)+Y);var ve="";return ve+=`
\0`,ve+=m(se,2),ve+=R.magic,ve+=m(U,2),ve+=m(k,2),ve+=m(ue.crc32,4),ve+=m(ue.compressedSize,4),ve+=m(ue.uncompressedSize,4),ve+=m(A.length,2),ve+=m(X.length,2),{fileRecord:O.LOCAL_FILE_HEADER+ve+A+X,dirRecord:O.CENTRAL_FILE_HEADER+m(fe,2)+ve+m(M.length,2)+"\0\0\0\0"+m(ce,4)+m(W,4)+A+X+M}}var y=p("../utils"),S=p("../stream/GenericWorker"),C=p("../utf8"),L=p("../crc32"),O=p("../signature");function H(z,q,D,W){S.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=q,this.zipPlatform=D,this.encodeFileName=W,this.streamFiles=z,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}y.inherits(H,S),H.prototype.push=function(z){var q=z.meta.percent||0,D=this.entriesCount,W=this._sources.length;this.accumulate?this.contentBuffer.push(z):(this.bytesWritten+=z.data.length,S.prototype.push.call(this,{data:z.data,meta:{currentFile:this.currentFile,percent:D?(q+100*(D-W-1))/D:100}}))},H.prototype.openedSource=function(z){this.currentSourceOffset=this.bytesWritten,this.currentFile=z.file.name;var q=this.streamFiles&&!z.file.dir;if(q){var D=b(z,q,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:D.fileRecord,meta:{percent:0}})}else this.accumulate=!0},H.prototype.closedSource=function(z){this.accumulate=!1;var q=this.streamFiles&&!z.file.dir,D=b(z,q,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(D.dirRecord),q)this.push({data:function(W){return O.DATA_DESCRIPTOR+m(W.crc32,4)+m(W.compressedSize,4)+m(W.uncompressedSize,4)}(z),meta:{percent:100}});else for(this.push({data:D.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},H.prototype.flush=function(){for(var z=this.bytesWritten,q=0;q<this.dirRecords.length;q++)this.push({data:this.dirRecords[q],meta:{percent:100}});var D=this.bytesWritten-z,W=function(P,I,U,k,_){var R=y.transformTo("string",_(k));return O.CENTRAL_DIRECTORY_END+"\0\0\0\0"+m(P,2)+m(P,2)+m(I,4)+m(U,4)+m(R.length,2)+R}(this.dirRecords.length,D,z,this.zipComment,this.encodeFileName);this.push({data:W,meta:{percent:100}})},H.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},H.prototype.registerPrevious=function(z){this._sources.push(z);var q=this;return z.on("data",function(D){q.processChunk(D)}),z.on("end",function(){q.closedSource(q.previous.streamInfo),q._sources.length?q.prepareNextSource():q.end()}),z.on("error",function(D){q.error(D)}),this},H.prototype.resume=function(){return!!S.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},H.prototype.error=function(z){var q=this._sources;if(!S.prototype.error.call(this,z))return!1;for(var D=0;D<q.length;D++)try{q[D].error(z)}catch{}return!0},H.prototype.lock=function(){S.prototype.lock.call(this);for(var z=this._sources,q=0;q<z.length;q++)z[q].lock()},v.exports=H},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(p,v,g){var m=p("../compressions"),b=p("./ZipFileWorker");g.generateWorker=function(y,S,C){var L=new b(S.streamFiles,C,S.platform,S.encodeFileName),O=0;try{y.forEach(function(H,z){O++;var q=function(I,U){var k=I||U,_=m[k];if(!_)throw new Error(k+" is not a valid compression method !");return _}(z.options.compression,S.compression),D=z.options.compressionOptions||S.compressionOptions||{},W=z.dir,P=z.date;z._compressWorker(q,D).withStreamInfo("file",{name:H,dir:W,date:P,comment:z.comment||"",unixPermissions:z.unixPermissions,dosPermissions:z.dosPermissions}).pipe(L)}),L.entriesCount=O}catch(H){L.error(H)}return L}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(p,v,g){function m(){if(!(this instanceof m))return new m;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var b=new m;for(var y in this)typeof this[y]!="function"&&(b[y]=this[y]);return b}}(m.prototype=p("./object")).loadAsync=p("./load"),m.support=p("./support"),m.defaults=p("./defaults"),m.version="3.10.1",m.loadAsync=function(b,y){return new m().loadAsync(b,y)},m.external=p("./external"),v.exports=m},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(p,v,g){var m=p("./utils"),b=p("./external"),y=p("./utf8"),S=p("./zipEntries"),C=p("./stream/Crc32Probe"),L=p("./nodejsUtils");function O(H){return new b.Promise(function(z,q){var D=H.decompressed.getContentWorker().pipe(new C);D.on("error",function(W){q(W)}).on("end",function(){D.streamInfo.crc32!==H.decompressed.crc32?q(new Error("Corrupted zip : CRC32 mismatch")):z()}).resume()})}v.exports=function(H,z){var q=this;return z=m.extend(z||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:y.utf8decode}),L.isNode&&L.isStream(H)?b.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):m.prepareContent("the loaded zip file",H,!0,z.optimizedBinaryString,z.base64).then(function(D){var W=new S(z);return W.load(D),W}).then(function(D){var W=[b.Promise.resolve(D)],P=D.files;if(z.checkCRC32)for(var I=0;I<P.length;I++)W.push(O(P[I]));return b.Promise.all(W)}).then(function(D){for(var W=D.shift(),P=W.files,I=0;I<P.length;I++){var U=P[I],k=U.fileNameStr,_=m.resolve(U.fileNameStr);q.file(_,U.decompressed,{binary:!0,optimizedBinaryString:!0,date:U.date,dir:U.dir,comment:U.fileCommentStr.length?U.fileCommentStr:null,unixPermissions:U.unixPermissions,dosPermissions:U.dosPermissions,createFolders:z.createFolders}),U.dir||(q.file(_).unsafeOriginalName=k)}return W.zipComment.length&&(q.comment=W.zipComment),q})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(p,v,g){var m=p("../utils"),b=p("../stream/GenericWorker");function y(S,C){b.call(this,"Nodejs stream input adapter for "+S),this._upstreamEnded=!1,this._bindStream(C)}m.inherits(y,b),y.prototype._bindStream=function(S){var C=this;(this._stream=S).pause(),S.on("data",function(L){C.push({data:L,meta:{percent:0}})}).on("error",function(L){C.isPaused?this.generatedError=L:C.error(L)}).on("end",function(){C.isPaused?C._upstreamEnded=!0:C.end()})},y.prototype.pause=function(){return!!b.prototype.pause.call(this)&&(this._stream.pause(),!0)},y.prototype.resume=function(){return!!b.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},v.exports=y},{"../stream/GenericWorker":28,"../utils":32}],13:[function(p,v,g){var m=p("readable-stream").Readable;function b(y,S,C){m.call(this,S),this._helper=y;var L=this;y.on("data",function(O,H){L.push(O)||L._helper.pause(),C&&C(H)}).on("error",function(O){L.emit("error",O)}).on("end",function(){L.push(null)})}p("../utils").inherits(b,m),b.prototype._read=function(){this._helper.resume()},v.exports=b},{"../utils":32,"readable-stream":16}],14:[function(p,v,g){v.exports={isNode:c!==void 0,newBufferFrom:function(m,b){if(c.from&&c.from!==Uint8Array.from)return c.from(m,b);if(typeof m=="number")throw new Error('The "data" argument must not be a number');return new c(m,b)},allocBuffer:function(m){if(c.alloc)return c.alloc(m);var b=new c(m);return b.fill(0),b},isBuffer:function(m){return c.isBuffer(m)},isStream:function(m){return m&&typeof m.on=="function"&&typeof m.pause=="function"&&typeof m.resume=="function"}}},{}],15:[function(p,v,g){function m(_,R,j){var A,N=y.getTypeOf(R),V=y.extend(j||{},L);V.date=V.date||new Date,V.compression!==null&&(V.compression=V.compression.toUpperCase()),typeof V.unixPermissions=="string"&&(V.unixPermissions=parseInt(V.unixPermissions,8)),V.unixPermissions&&16384&V.unixPermissions&&(V.dir=!0),V.dosPermissions&&16&V.dosPermissions&&(V.dir=!0),V.dir&&(_=P(_)),V.createFolders&&(A=W(_))&&I.call(this,A,!0);var M=N==="string"&&V.binary===!1&&V.base64===!1;j&&j.binary!==void 0||(V.binary=!M),(R instanceof O&&R.uncompressedSize===0||V.dir||!R||R.length===0)&&(V.base64=!1,V.binary=!0,R="",V.compression="STORE",N="string");var Z;Z=R instanceof O||R instanceof S?R:q.isNode&&q.isStream(R)?new D(_,R):y.prepareContent(_,R,V.binary,V.optimizedBinaryString,V.base64);var J=new H(_,Z,V);this.files[_]=J}var b=p("./utf8"),y=p("./utils"),S=p("./stream/GenericWorker"),C=p("./stream/StreamHelper"),L=p("./defaults"),O=p("./compressedObject"),H=p("./zipObject"),z=p("./generate"),q=p("./nodejsUtils"),D=p("./nodejs/NodejsStreamInputAdapter"),W=function(_){_.slice(-1)==="/"&&(_=_.substring(0,_.length-1));var R=_.lastIndexOf("/");return 0<R?_.substring(0,R):""},P=function(_){return _.slice(-1)!=="/"&&(_+="/"),_},I=function(_,R){return R=R!==void 0?R:L.createFolders,_=P(_),this.files[_]||m.call(this,_,null,{dir:!0,createFolders:R}),this.files[_]};function U(_){return Object.prototype.toString.call(_)==="[object RegExp]"}var k={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(_){var R,j,A;for(R in this.files)A=this.files[R],(j=R.slice(this.root.length,R.length))&&R.slice(0,this.root.length)===this.root&&_(j,A)},filter:function(_){var R=[];return this.forEach(function(j,A){_(j,A)&&R.push(A)}),R},file:function(_,R,j){if(arguments.length!==1)return _=this.root+_,m.call(this,_,R,j),this;if(U(_)){var A=_;return this.filter(function(V,M){return!M.dir&&A.test(V)})}var N=this.files[this.root+_];return N&&!N.dir?N:null},folder:function(_){if(!_)return this;if(U(_))return this.filter(function(N,V){return V.dir&&_.test(N)});var R=this.root+_,j=I.call(this,R),A=this.clone();return A.root=j.name,A},remove:function(_){_=this.root+_;var R=this.files[_];if(R||(_.slice(-1)!=="/"&&(_+="/"),R=this.files[_]),R&&!R.dir)delete this.files[_];else for(var j=this.filter(function(N,V){return V.name.slice(0,_.length)===_}),A=0;A<j.length;A++)delete this.files[j[A].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(_){var R,j={};try{if((j=y.extend(_||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:b.utf8encode})).type=j.type.toLowerCase(),j.compression=j.compression.toUpperCase(),j.type==="binarystring"&&(j.type="string"),!j.type)throw new Error("No output type specified.");y.checkSupport(j.type),j.platform!=="darwin"&&j.platform!=="freebsd"&&j.platform!=="linux"&&j.platform!=="sunos"||(j.platform="UNIX"),j.platform==="win32"&&(j.platform="DOS");var A=j.comment||this.comment||"";R=z.generateWorker(this,j,A)}catch(N){(R=new S("error")).error(N)}return new C(R,j.type||"string",j.mimeType)},generateAsync:function(_,R){return this.generateInternalStream(_).accumulate(R)},generateNodeStream:function(_,R){return(_=_||{}).type||(_.type="nodebuffer"),this.generateInternalStream(_).toNodejsStream(R)}};v.exports=k},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(p,v,g){v.exports=p("stream")},{stream:void 0}],17:[function(p,v,g){var m=p("./DataReader");function b(y){m.call(this,y);for(var S=0;S<this.data.length;S++)y[S]=255&y[S]}p("../utils").inherits(b,m),b.prototype.byteAt=function(y){return this.data[this.zero+y]},b.prototype.lastIndexOfSignature=function(y){for(var S=y.charCodeAt(0),C=y.charCodeAt(1),L=y.charCodeAt(2),O=y.charCodeAt(3),H=this.length-4;0<=H;--H)if(this.data[H]===S&&this.data[H+1]===C&&this.data[H+2]===L&&this.data[H+3]===O)return H-this.zero;return-1},b.prototype.readAndCheckSignature=function(y){var S=y.charCodeAt(0),C=y.charCodeAt(1),L=y.charCodeAt(2),O=y.charCodeAt(3),H=this.readData(4);return S===H[0]&&C===H[1]&&L===H[2]&&O===H[3]},b.prototype.readData=function(y){if(this.checkOffset(y),y===0)return[];var S=this.data.slice(this.zero+this.index,this.zero+this.index+y);return this.index+=y,S},v.exports=b},{"../utils":32,"./DataReader":18}],18:[function(p,v,g){var m=p("../utils");function b(y){this.data=y,this.length=y.length,this.index=0,this.zero=0}b.prototype={checkOffset:function(y){this.checkIndex(this.index+y)},checkIndex:function(y){if(this.length<this.zero+y||y<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+y+"). Corrupted zip ?")},setIndex:function(y){this.checkIndex(y),this.index=y},skip:function(y){this.setIndex(this.index+y)},byteAt:function(){},readInt:function(y){var S,C=0;for(this.checkOffset(y),S=this.index+y-1;S>=this.index;S--)C=(C<<8)+this.byteAt(S);return this.index+=y,C},readString:function(y){return m.transformTo("string",this.readData(y))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var y=this.readInt(4);return new Date(Date.UTC(1980+(y>>25&127),(y>>21&15)-1,y>>16&31,y>>11&31,y>>5&63,(31&y)<<1))}},v.exports=b},{"../utils":32}],19:[function(p,v,g){var m=p("./Uint8ArrayReader");function b(y){m.call(this,y)}p("../utils").inherits(b,m),b.prototype.readData=function(y){this.checkOffset(y);var S=this.data.slice(this.zero+this.index,this.zero+this.index+y);return this.index+=y,S},v.exports=b},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(p,v,g){var m=p("./DataReader");function b(y){m.call(this,y)}p("../utils").inherits(b,m),b.prototype.byteAt=function(y){return this.data.charCodeAt(this.zero+y)},b.prototype.lastIndexOfSignature=function(y){return this.data.lastIndexOf(y)-this.zero},b.prototype.readAndCheckSignature=function(y){return y===this.readData(4)},b.prototype.readData=function(y){this.checkOffset(y);var S=this.data.slice(this.zero+this.index,this.zero+this.index+y);return this.index+=y,S},v.exports=b},{"../utils":32,"./DataReader":18}],21:[function(p,v,g){var m=p("./ArrayReader");function b(y){m.call(this,y)}p("../utils").inherits(b,m),b.prototype.readData=function(y){if(this.checkOffset(y),y===0)return new Uint8Array(0);var S=this.data.subarray(this.zero+this.index,this.zero+this.index+y);return this.index+=y,S},v.exports=b},{"../utils":32,"./ArrayReader":17}],22:[function(p,v,g){var m=p("../utils"),b=p("../support"),y=p("./ArrayReader"),S=p("./StringReader"),C=p("./NodeBufferReader"),L=p("./Uint8ArrayReader");v.exports=function(O){var H=m.getTypeOf(O);return m.checkSupport(H),H!=="string"||b.uint8array?H==="nodebuffer"?new C(O):b.uint8array?new L(m.transformTo("uint8array",O)):new y(m.transformTo("array",O)):new S(O)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(p,v,g){g.LOCAL_FILE_HEADER="PK",g.CENTRAL_FILE_HEADER="PK",g.CENTRAL_DIRECTORY_END="PK",g.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",g.ZIP64_CENTRAL_DIRECTORY_END="PK",g.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(p,v,g){var m=p("./GenericWorker"),b=p("../utils");function y(S){m.call(this,"ConvertWorker to "+S),this.destType=S}b.inherits(y,m),y.prototype.processChunk=function(S){this.push({data:b.transformTo(this.destType,S.data),meta:S.meta})},v.exports=y},{"../utils":32,"./GenericWorker":28}],25:[function(p,v,g){var m=p("./GenericWorker"),b=p("../crc32");function y(){m.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}p("../utils").inherits(y,m),y.prototype.processChunk=function(S){this.streamInfo.crc32=b(S.data,this.streamInfo.crc32||0),this.push(S)},v.exports=y},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(p,v,g){var m=p("../utils"),b=p("./GenericWorker");function y(S){b.call(this,"DataLengthProbe for "+S),this.propName=S,this.withStreamInfo(S,0)}m.inherits(y,b),y.prototype.processChunk=function(S){if(S){var C=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=C+S.data.length}b.prototype.processChunk.call(this,S)},v.exports=y},{"../utils":32,"./GenericWorker":28}],27:[function(p,v,g){var m=p("../utils"),b=p("./GenericWorker");function y(S){b.call(this,"DataWorker");var C=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,S.then(function(L){C.dataIsReady=!0,C.data=L,C.max=L&&L.length||0,C.type=m.getTypeOf(L),C.isPaused||C._tickAndRepeat()},function(L){C.error(L)})}m.inherits(y,b),y.prototype.cleanUp=function(){b.prototype.cleanUp.call(this),this.data=null},y.prototype.resume=function(){return!!b.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,m.delay(this._tickAndRepeat,[],this)),!0)},y.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(m.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},y.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var S=null,C=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":S=this.data.substring(this.index,C);break;case"uint8array":S=this.data.subarray(this.index,C);break;case"array":case"nodebuffer":S=this.data.slice(this.index,C)}return this.index=C,this.push({data:S,meta:{percent:this.max?this.index/this.max*100:0}})},v.exports=y},{"../utils":32,"./GenericWorker":28}],28:[function(p,v,g){function m(b){this.name=b||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}m.prototype={push:function(b){this.emit("data",b)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(b){this.emit("error",b)}return!0},error:function(b){return!this.isFinished&&(this.isPaused?this.generatedError=b:(this.isFinished=!0,this.emit("error",b),this.previous&&this.previous.error(b),this.cleanUp()),!0)},on:function(b,y){return this._listeners[b].push(y),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(b,y){if(this._listeners[b])for(var S=0;S<this._listeners[b].length;S++)this._listeners[b][S].call(this,y)},pipe:function(b){return b.registerPrevious(this)},registerPrevious:function(b){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=b.streamInfo,this.mergeStreamInfo(),this.previous=b;var y=this;return b.on("data",function(S){y.processChunk(S)}),b.on("end",function(){y.end()}),b.on("error",function(S){y.error(S)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var b=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),b=!0),this.previous&&this.previous.resume(),!b},flush:function(){},processChunk:function(b){this.push(b)},withStreamInfo:function(b,y){return this.extraStreamInfo[b]=y,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var b in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,b)&&(this.streamInfo[b]=this.extraStreamInfo[b])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var b="Worker "+this.name;return this.previous?this.previous+" -> "+b:b}},v.exports=m},{}],29:[function(p,v,g){var m=p("../utils"),b=p("./ConvertWorker"),y=p("./GenericWorker"),S=p("../base64"),C=p("../support"),L=p("../external"),O=null;if(C.nodestream)try{O=p("../nodejs/NodejsStreamOutputAdapter")}catch{}function H(z,q,D){var W=q;switch(q){case"blob":case"arraybuffer":W="uint8array";break;case"base64":W="string"}try{this._internalType=W,this._outputType=q,this._mimeType=D,m.checkSupport(W),this._worker=z.pipe(new b(W)),z.lock()}catch(P){this._worker=new y("error"),this._worker.error(P)}}H.prototype={accumulate:function(z){return function(q,D){return new L.Promise(function(W,P){var I=[],U=q._internalType,k=q._outputType,_=q._mimeType;q.on("data",function(R,j){I.push(R),D&&D(j)}).on("error",function(R){I=[],P(R)}).on("end",function(){try{var R=function(j,A,N){switch(j){case"blob":return m.newBlob(m.transformTo("arraybuffer",A),N);case"base64":return S.encode(A);default:return m.transformTo(j,A)}}(k,function(j,A){var N,V=0,M=null,Z=0;for(N=0;N<A.length;N++)Z+=A[N].length;switch(j){case"string":return A.join("");case"array":return Array.prototype.concat.apply([],A);case"uint8array":for(M=new Uint8Array(Z),N=0;N<A.length;N++)M.set(A[N],V),V+=A[N].length;return M;case"nodebuffer":return c.concat(A);default:throw new Error("concat : unsupported type '"+j+"'")}}(U,I),_);W(R)}catch(j){P(j)}I=[]}).resume()})}(this,z)},on:function(z,q){var D=this;return z==="data"?this._worker.on(z,function(W){q.call(D,W.data,W.meta)}):this._worker.on(z,function(){m.delay(q,arguments,D)}),this},resume:function(){return m.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(z){if(m.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new O(this,{objectMode:this._outputType!=="nodebuffer"},z)}},v.exports=H},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(p,v,g){if(g.base64=!0,g.array=!0,g.string=!0,g.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",g.nodebuffer=c!==void 0,g.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")g.blob=!1;else{var m=new ArrayBuffer(0);try{g.blob=new Blob([m],{type:"application/zip"}).size===0}catch{try{var b=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);b.append(m),g.blob=b.getBlob("application/zip").size===0}catch{g.blob=!1}}}try{g.nodestream=!!p("readable-stream").Readable}catch{g.nodestream=!1}},{"readable-stream":16}],31:[function(p,v,g){for(var m=p("./utils"),b=p("./support"),y=p("./nodejsUtils"),S=p("./stream/GenericWorker"),C=new Array(256),L=0;L<256;L++)C[L]=252<=L?6:248<=L?5:240<=L?4:224<=L?3:192<=L?2:1;function O(){S.call(this,"utf-8 decode"),this.leftOver=null}function H(){S.call(this,"utf-8 encode")}C[254]=C[254]=1,g.utf8encode=function(z){return b.nodebuffer?y.newBufferFrom(z,"utf-8"):function(q){var D,W,P,I,U,k=q.length,_=0;for(I=0;I<k;I++)(64512&(W=q.charCodeAt(I)))==55296&&I+1<k&&(64512&(P=q.charCodeAt(I+1)))==56320&&(W=65536+(W-55296<<10)+(P-56320),I++),_+=W<128?1:W<2048?2:W<65536?3:4;for(D=b.uint8array?new Uint8Array(_):new Array(_),I=U=0;U<_;I++)(64512&(W=q.charCodeAt(I)))==55296&&I+1<k&&(64512&(P=q.charCodeAt(I+1)))==56320&&(W=65536+(W-55296<<10)+(P-56320),I++),W<128?D[U++]=W:(W<2048?D[U++]=192|W>>>6:(W<65536?D[U++]=224|W>>>12:(D[U++]=240|W>>>18,D[U++]=128|W>>>12&63),D[U++]=128|W>>>6&63),D[U++]=128|63&W);return D}(z)},g.utf8decode=function(z){return b.nodebuffer?m.transformTo("nodebuffer",z).toString("utf-8"):function(q){var D,W,P,I,U=q.length,k=new Array(2*U);for(D=W=0;D<U;)if((P=q[D++])<128)k[W++]=P;else if(4<(I=C[P]))k[W++]=65533,D+=I-1;else{for(P&=I===2?31:I===3?15:7;1<I&&D<U;)P=P<<6|63&q[D++],I--;1<I?k[W++]=65533:P<65536?k[W++]=P:(P-=65536,k[W++]=55296|P>>10&1023,k[W++]=56320|1023&P)}return k.length!==W&&(k.subarray?k=k.subarray(0,W):k.length=W),m.applyFromCharCode(k)}(z=m.transformTo(b.uint8array?"uint8array":"array",z))},m.inherits(O,S),O.prototype.processChunk=function(z){var q=m.transformTo(b.uint8array?"uint8array":"array",z.data);if(this.leftOver&&this.leftOver.length){if(b.uint8array){var D=q;(q=new Uint8Array(D.length+this.leftOver.length)).set(this.leftOver,0),q.set(D,this.leftOver.length)}else q=this.leftOver.concat(q);this.leftOver=null}var W=function(I,U){var k;for((U=U||I.length)>I.length&&(U=I.length),k=U-1;0<=k&&(192&I[k])==128;)k--;return k<0||k===0?U:k+C[I[k]]>U?k:U}(q),P=q;W!==q.length&&(b.uint8array?(P=q.subarray(0,W),this.leftOver=q.subarray(W,q.length)):(P=q.slice(0,W),this.leftOver=q.slice(W,q.length))),this.push({data:g.utf8decode(P),meta:z.meta})},O.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:g.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},g.Utf8DecodeWorker=O,m.inherits(H,S),H.prototype.processChunk=function(z){this.push({data:g.utf8encode(z.data),meta:z.meta})},g.Utf8EncodeWorker=H},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(p,v,g){var m=p("./support"),b=p("./base64"),y=p("./nodejsUtils"),S=p("./external");function C(D){return D}function L(D,W){for(var P=0;P<D.length;++P)W[P]=255&D.charCodeAt(P);return W}p("setimmediate"),g.newBlob=function(D,W){g.checkSupport("blob");try{return new Blob([D],{type:W})}catch{try{var P=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return P.append(D),P.getBlob(W)}catch{throw new Error("Bug : can't construct the Blob.")}}};var O={stringifyByChunk:function(D,W,P){var I=[],U=0,k=D.length;if(k<=P)return String.fromCharCode.apply(null,D);for(;U<k;)W==="array"||W==="nodebuffer"?I.push(String.fromCharCode.apply(null,D.slice(U,Math.min(U+P,k)))):I.push(String.fromCharCode.apply(null,D.subarray(U,Math.min(U+P,k)))),U+=P;return I.join("")},stringifyByChar:function(D){for(var W="",P=0;P<D.length;P++)W+=String.fromCharCode(D[P]);return W},applyCanBeUsed:{uint8array:function(){try{return m.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return m.nodebuffer&&String.fromCharCode.apply(null,y.allocBuffer(1)).length===1}catch{return!1}}()}};function H(D){var W=65536,P=g.getTypeOf(D),I=!0;if(P==="uint8array"?I=O.applyCanBeUsed.uint8array:P==="nodebuffer"&&(I=O.applyCanBeUsed.nodebuffer),I)for(;1<W;)try{return O.stringifyByChunk(D,P,W)}catch{W=Math.floor(W/2)}return O.stringifyByChar(D)}function z(D,W){for(var P=0;P<D.length;P++)W[P]=D[P];return W}g.applyFromCharCode=H;var q={};q.string={string:C,array:function(D){return L(D,new Array(D.length))},arraybuffer:function(D){return q.string.uint8array(D).buffer},uint8array:function(D){return L(D,new Uint8Array(D.length))},nodebuffer:function(D){return L(D,y.allocBuffer(D.length))}},q.array={string:H,array:C,arraybuffer:function(D){return new Uint8Array(D).buffer},uint8array:function(D){return new Uint8Array(D)},nodebuffer:function(D){return y.newBufferFrom(D)}},q.arraybuffer={string:function(D){return H(new Uint8Array(D))},array:function(D){return z(new Uint8Array(D),new Array(D.byteLength))},arraybuffer:C,uint8array:function(D){return new Uint8Array(D)},nodebuffer:function(D){return y.newBufferFrom(new Uint8Array(D))}},q.uint8array={string:H,array:function(D){return z(D,new Array(D.length))},arraybuffer:function(D){return D.buffer},uint8array:C,nodebuffer:function(D){return y.newBufferFrom(D)}},q.nodebuffer={string:H,array:function(D){return z(D,new Array(D.length))},arraybuffer:function(D){return q.nodebuffer.uint8array(D).buffer},uint8array:function(D){return z(D,new Uint8Array(D.length))},nodebuffer:C},g.transformTo=function(D,W){if(W=W||"",!D)return W;g.checkSupport(D);var P=g.getTypeOf(W);return q[P][D](W)},g.resolve=function(D){for(var W=D.split("/"),P=[],I=0;I<W.length;I++){var U=W[I];U==="."||U===""&&I!==0&&I!==W.length-1||(U===".."?P.pop():P.push(U))}return P.join("/")},g.getTypeOf=function(D){return typeof D=="string"?"string":Object.prototype.toString.call(D)==="[object Array]"?"array":m.nodebuffer&&y.isBuffer(D)?"nodebuffer":m.uint8array&&D instanceof Uint8Array?"uint8array":m.arraybuffer&&D instanceof ArrayBuffer?"arraybuffer":void 0},g.checkSupport=function(D){if(!m[D.toLowerCase()])throw new Error(D+" is not supported by this platform")},g.MAX_VALUE_16BITS=65535,g.MAX_VALUE_32BITS=-1,g.pretty=function(D){var W,P,I="";for(P=0;P<(D||"").length;P++)I+="\\x"+((W=D.charCodeAt(P))<16?"0":"")+W.toString(16).toUpperCase();return I},g.delay=function(D,W,P){f(function(){D.apply(P||null,W||[])})},g.inherits=function(D,W){function P(){}P.prototype=W.prototype,D.prototype=new P},g.extend=function(){var D,W,P={};for(D=0;D<arguments.length;D++)for(W in arguments[D])Object.prototype.hasOwnProperty.call(arguments[D],W)&&P[W]===void 0&&(P[W]=arguments[D][W]);return P},g.prepareContent=function(D,W,P,I,U){return S.Promise.resolve(W).then(function(k){return m.blob&&(k instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(k))!==-1)&&typeof FileReader<"u"?new S.Promise(function(_,R){var j=new FileReader;j.onload=function(A){_(A.target.result)},j.onerror=function(A){R(A.target.error)},j.readAsArrayBuffer(k)}):k}).then(function(k){var _=g.getTypeOf(k);return _?(_==="arraybuffer"?k=g.transformTo("uint8array",k):_==="string"&&(U?k=b.decode(k):P&&I!==!0&&(k=function(R){return L(R,m.uint8array?new Uint8Array(R.length):new Array(R.length))}(k))),k):S.Promise.reject(new Error("Can't read the data of '"+D+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(p,v,g){var m=p("./reader/readerFor"),b=p("./utils"),y=p("./signature"),S=p("./zipEntry"),C=p("./support");function L(O){this.files=[],this.loadOptions=O}L.prototype={checkSignature:function(O){if(!this.reader.readAndCheckSignature(O)){this.reader.index-=4;var H=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+b.pretty(H)+", expected "+b.pretty(O)+")")}},isSignature:function(O,H){var z=this.reader.index;this.reader.setIndex(O);var q=this.reader.readString(4)===H;return this.reader.setIndex(z),q},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var O=this.reader.readData(this.zipCommentLength),H=C.uint8array?"uint8array":"array",z=b.transformTo(H,O);this.zipComment=this.loadOptions.decodeFileName(z)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var O,H,z,q=this.zip64EndOfCentralSize-44;0<q;)O=this.reader.readInt(2),H=this.reader.readInt(4),z=this.reader.readData(H),this.zip64ExtensibleData[O]={id:O,length:H,value:z}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var O,H;for(O=0;O<this.files.length;O++)H=this.files[O],this.reader.setIndex(H.localHeaderOffset),this.checkSignature(y.LOCAL_FILE_HEADER),H.readLocalPart(this.reader),H.handleUTF8(),H.processAttributes()},readCentralDir:function(){var O;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(y.CENTRAL_FILE_HEADER);)(O=new S({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(O);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var O=this.reader.lastIndexOfSignature(y.CENTRAL_DIRECTORY_END);if(O<0)throw this.isSignature(0,y.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(O);var H=O;if(this.checkSignature(y.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===b.MAX_VALUE_16BITS||this.diskWithCentralDirStart===b.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===b.MAX_VALUE_16BITS||this.centralDirRecords===b.MAX_VALUE_16BITS||this.centralDirSize===b.MAX_VALUE_32BITS||this.centralDirOffset===b.MAX_VALUE_32BITS){if(this.zip64=!0,(O=this.reader.lastIndexOfSignature(y.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(O),this.checkSignature(y.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,y.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(y.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(y.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var z=this.centralDirOffset+this.centralDirSize;this.zip64&&(z+=20,z+=12+this.zip64EndOfCentralSize);var q=H-z;if(0<q)this.isSignature(H,y.CENTRAL_FILE_HEADER)||(this.reader.zero=q);else if(q<0)throw new Error("Corrupted zip: missing "+Math.abs(q)+" bytes.")},prepareReader:function(O){this.reader=m(O)},load:function(O){this.prepareReader(O),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},v.exports=L},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(p,v,g){var m=p("./reader/readerFor"),b=p("./utils"),y=p("./compressedObject"),S=p("./crc32"),C=p("./utf8"),L=p("./compressions"),O=p("./support");function H(z,q){this.options=z,this.loadOptions=q}H.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(z){var q,D;if(z.skip(22),this.fileNameLength=z.readInt(2),D=z.readInt(2),this.fileName=z.readData(this.fileNameLength),z.skip(D),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((q=function(W){for(var P in L)if(Object.prototype.hasOwnProperty.call(L,P)&&L[P].magic===W)return L[P];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+b.pretty(this.compressionMethod)+" unknown (inner file : "+b.transformTo("string",this.fileName)+")");this.decompressed=new y(this.compressedSize,this.uncompressedSize,this.crc32,q,z.readData(this.compressedSize))},readCentralPart:function(z){this.versionMadeBy=z.readInt(2),z.skip(2),this.bitFlag=z.readInt(2),this.compressionMethod=z.readString(2),this.date=z.readDate(),this.crc32=z.readInt(4),this.compressedSize=z.readInt(4),this.uncompressedSize=z.readInt(4);var q=z.readInt(2);if(this.extraFieldsLength=z.readInt(2),this.fileCommentLength=z.readInt(2),this.diskNumberStart=z.readInt(2),this.internalFileAttributes=z.readInt(2),this.externalFileAttributes=z.readInt(4),this.localHeaderOffset=z.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");z.skip(q),this.readExtraFields(z),this.parseZIP64ExtraField(z),this.fileComment=z.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var z=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),z==0&&(this.dosPermissions=63&this.externalFileAttributes),z==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var z=m(this.extraFields[1].value);this.uncompressedSize===b.MAX_VALUE_32BITS&&(this.uncompressedSize=z.readInt(8)),this.compressedSize===b.MAX_VALUE_32BITS&&(this.compressedSize=z.readInt(8)),this.localHeaderOffset===b.MAX_VALUE_32BITS&&(this.localHeaderOffset=z.readInt(8)),this.diskNumberStart===b.MAX_VALUE_32BITS&&(this.diskNumberStart=z.readInt(4))}},readExtraFields:function(z){var q,D,W,P=z.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});z.index+4<P;)q=z.readInt(2),D=z.readInt(2),W=z.readData(D),this.extraFields[q]={id:q,length:D,value:W};z.setIndex(P)},handleUTF8:function(){var z=O.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=C.utf8decode(this.fileName),this.fileCommentStr=C.utf8decode(this.fileComment);else{var q=this.findExtraFieldUnicodePath();if(q!==null)this.fileNameStr=q;else{var D=b.transformTo(z,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(D)}var W=this.findExtraFieldUnicodeComment();if(W!==null)this.fileCommentStr=W;else{var P=b.transformTo(z,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(P)}}},findExtraFieldUnicodePath:function(){var z=this.extraFields[28789];if(z){var q=m(z.value);return q.readInt(1)!==1||S(this.fileName)!==q.readInt(4)?null:C.utf8decode(q.readData(z.length-5))}return null},findExtraFieldUnicodeComment:function(){var z=this.extraFields[25461];if(z){var q=m(z.value);return q.readInt(1)!==1||S(this.fileComment)!==q.readInt(4)?null:C.utf8decode(q.readData(z.length-5))}return null}},v.exports=H},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(p,v,g){function m(q,D,W){this.name=q,this.dir=W.dir,this.date=W.date,this.comment=W.comment,this.unixPermissions=W.unixPermissions,this.dosPermissions=W.dosPermissions,this._data=D,this._dataBinary=W.binary,this.options={compression:W.compression,compressionOptions:W.compressionOptions}}var b=p("./stream/StreamHelper"),y=p("./stream/DataWorker"),S=p("./utf8"),C=p("./compressedObject"),L=p("./stream/GenericWorker");m.prototype={internalStream:function(q){var D=null,W="string";try{if(!q)throw new Error("No output type specified.");var P=(W=q.toLowerCase())==="string"||W==="text";W!=="binarystring"&&W!=="text"||(W="string"),D=this._decompressWorker();var I=!this._dataBinary;I&&!P&&(D=D.pipe(new S.Utf8EncodeWorker)),!I&&P&&(D=D.pipe(new S.Utf8DecodeWorker))}catch(U){(D=new L("error")).error(U)}return new b(D,W,"")},async:function(q,D){return this.internalStream(q).accumulate(D)},nodeStream:function(q,D){return this.internalStream(q||"nodebuffer").toNodejsStream(D)},_compressWorker:function(q,D){if(this._data instanceof C&&this._data.compression.magic===q.magic)return this._data.getCompressedWorker();var W=this._decompressWorker();return this._dataBinary||(W=W.pipe(new S.Utf8EncodeWorker)),C.createWorkerFrom(W,q,D)},_decompressWorker:function(){return this._data instanceof C?this._data.getContentWorker():this._data instanceof L?this._data:new y(this._data)}};for(var O=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],H=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},z=0;z<O.length;z++)m.prototype[O[z]]=H;v.exports=m},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(p,v,g){(function(m){var b,y,S=m.MutationObserver||m.WebKitMutationObserver;if(S){var C=0,L=new S(q),O=m.document.createTextNode("");L.observe(O,{characterData:!0}),b=function(){O.data=C=++C%2}}else if(m.setImmediate||m.MessageChannel===void 0)b="document"in m&&"onreadystatechange"in m.document.createElement("script")?function(){var D=m.document.createElement("script");D.onreadystatechange=function(){q(),D.onreadystatechange=null,D.parentNode.removeChild(D),D=null},m.document.documentElement.appendChild(D)}:function(){setTimeout(q,0)};else{var H=new m.MessageChannel;H.port1.onmessage=q,b=function(){H.port2.postMessage(0)}}var z=[];function q(){var D,W;y=!0;for(var P=z.length;P;){for(W=z,z=[],D=-1;++D<P;)W[D]();P=z.length}y=!1}v.exports=function(D){z.push(D)!==1||y||b()}}).call(this,i!==void 0?i:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(p,v,g){var m=p("immediate");function b(){}var y={},S=["REJECTED"],C=["FULFILLED"],L=["PENDING"];function O(P){if(typeof P!="function")throw new TypeError("resolver must be a function");this.state=L,this.queue=[],this.outcome=void 0,P!==b&&D(this,P)}function H(P,I,U){this.promise=P,typeof I=="function"&&(this.onFulfilled=I,this.callFulfilled=this.otherCallFulfilled),typeof U=="function"&&(this.onRejected=U,this.callRejected=this.otherCallRejected)}function z(P,I,U){m(function(){var k;try{k=I(U)}catch(_){return y.reject(P,_)}k===P?y.reject(P,new TypeError("Cannot resolve promise with itself")):y.resolve(P,k)})}function q(P){var I=P&&P.then;if(P&&(typeof P=="object"||typeof P=="function")&&typeof I=="function")return function(){I.apply(P,arguments)}}function D(P,I){var U=!1;function k(j){U||(U=!0,y.reject(P,j))}function _(j){U||(U=!0,y.resolve(P,j))}var R=W(function(){I(_,k)});R.status==="error"&&k(R.value)}function W(P,I){var U={};try{U.value=P(I),U.status="success"}catch(k){U.status="error",U.value=k}return U}(v.exports=O).prototype.finally=function(P){if(typeof P!="function")return this;var I=this.constructor;return this.then(function(U){return I.resolve(P()).then(function(){return U})},function(U){return I.resolve(P()).then(function(){throw U})})},O.prototype.catch=function(P){return this.then(null,P)},O.prototype.then=function(P,I){if(typeof P!="function"&&this.state===C||typeof I!="function"&&this.state===S)return this;var U=new this.constructor(b);return this.state!==L?z(U,this.state===C?P:I,this.outcome):this.queue.push(new H(U,P,I)),U},H.prototype.callFulfilled=function(P){y.resolve(this.promise,P)},H.prototype.otherCallFulfilled=function(P){z(this.promise,this.onFulfilled,P)},H.prototype.callRejected=function(P){y.reject(this.promise,P)},H.prototype.otherCallRejected=function(P){z(this.promise,this.onRejected,P)},y.resolve=function(P,I){var U=W(q,I);if(U.status==="error")return y.reject(P,U.value);var k=U.value;if(k)D(P,k);else{P.state=C,P.outcome=I;for(var _=-1,R=P.queue.length;++_<R;)P.queue[_].callFulfilled(I)}return P},y.reject=function(P,I){P.state=S,P.outcome=I;for(var U=-1,k=P.queue.length;++U<k;)P.queue[U].callRejected(I);return P},O.resolve=function(P){return P instanceof this?P:y.resolve(new this(b),P)},O.reject=function(P){var I=new this(b);return y.reject(I,P)},O.all=function(P){var I=this;if(Object.prototype.toString.call(P)!=="[object Array]")return this.reject(new TypeError("must be an array"));var U=P.length,k=!1;if(!U)return this.resolve([]);for(var _=new Array(U),R=0,j=-1,A=new this(b);++j<U;)N(P[j],j);return A;function N(V,M){I.resolve(V).then(function(Z){_[M]=Z,++R!==U||k||(k=!0,y.resolve(A,_))},function(Z){k||(k=!0,y.reject(A,Z))})}},O.race=function(P){if(Object.prototype.toString.call(P)!=="[object Array]")return this.reject(new TypeError("must be an array"));var I=P.length,U=!1;if(!I)return this.resolve([]);for(var k,_=-1,R=new this(b);++_<I;)k=P[_],this.resolve(k).then(function(j){U||(U=!0,y.resolve(R,j))},function(j){U||(U=!0,y.reject(R,j))});return R}},{immediate:36}],38:[function(p,v,g){var m={};(0,p("./lib/utils/common").assign)(m,p("./lib/deflate"),p("./lib/inflate"),p("./lib/zlib/constants")),v.exports=m},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(p,v,g){var m=p("./zlib/deflate"),b=p("./utils/common"),y=p("./utils/strings"),S=p("./zlib/messages"),C=p("./zlib/zstream"),L=Object.prototype.toString;function O(z){if(!(this instanceof O))return new O(z);this.options=b.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},z||{});var q=this.options;q.raw&&0<q.windowBits?q.windowBits=-q.windowBits:q.gzip&&0<q.windowBits&&q.windowBits<16&&(q.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new C,this.strm.avail_out=0;var D=m.deflateInit2(this.strm,q.level,q.method,q.windowBits,q.memLevel,q.strategy);if(D!==0)throw new Error(S[D]);if(q.header&&m.deflateSetHeader(this.strm,q.header),q.dictionary){var W;if(W=typeof q.dictionary=="string"?y.string2buf(q.dictionary):L.call(q.dictionary)==="[object ArrayBuffer]"?new Uint8Array(q.dictionary):q.dictionary,(D=m.deflateSetDictionary(this.strm,W))!==0)throw new Error(S[D]);this._dict_set=!0}}function H(z,q){var D=new O(q);if(D.push(z,!0),D.err)throw D.msg||S[D.err];return D.result}O.prototype.push=function(z,q){var D,W,P=this.strm,I=this.options.chunkSize;if(this.ended)return!1;W=q===~~q?q:q===!0?4:0,typeof z=="string"?P.input=y.string2buf(z):L.call(z)==="[object ArrayBuffer]"?P.input=new Uint8Array(z):P.input=z,P.next_in=0,P.avail_in=P.input.length;do{if(P.avail_out===0&&(P.output=new b.Buf8(I),P.next_out=0,P.avail_out=I),(D=m.deflate(P,W))!==1&&D!==0)return this.onEnd(D),!(this.ended=!0);P.avail_out!==0&&(P.avail_in!==0||W!==4&&W!==2)||(this.options.to==="string"?this.onData(y.buf2binstring(b.shrinkBuf(P.output,P.next_out))):this.onData(b.shrinkBuf(P.output,P.next_out)))}while((0<P.avail_in||P.avail_out===0)&&D!==1);return W===4?(D=m.deflateEnd(this.strm),this.onEnd(D),this.ended=!0,D===0):W!==2||(this.onEnd(0),!(P.avail_out=0))},O.prototype.onData=function(z){this.chunks.push(z)},O.prototype.onEnd=function(z){z===0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=b.flattenChunks(this.chunks)),this.chunks=[],this.err=z,this.msg=this.strm.msg},g.Deflate=O,g.deflate=H,g.deflateRaw=function(z,q){return(q=q||{}).raw=!0,H(z,q)},g.gzip=function(z,q){return(q=q||{}).gzip=!0,H(z,q)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(p,v,g){var m=p("./zlib/inflate"),b=p("./utils/common"),y=p("./utils/strings"),S=p("./zlib/constants"),C=p("./zlib/messages"),L=p("./zlib/zstream"),O=p("./zlib/gzheader"),H=Object.prototype.toString;function z(D){if(!(this instanceof z))return new z(D);this.options=b.assign({chunkSize:16384,windowBits:0,to:""},D||{});var W=this.options;W.raw&&0<=W.windowBits&&W.windowBits<16&&(W.windowBits=-W.windowBits,W.windowBits===0&&(W.windowBits=-15)),!(0<=W.windowBits&&W.windowBits<16)||D&&D.windowBits||(W.windowBits+=32),15<W.windowBits&&W.windowBits<48&&(15&W.windowBits)==0&&(W.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new L,this.strm.avail_out=0;var P=m.inflateInit2(this.strm,W.windowBits);if(P!==S.Z_OK)throw new Error(C[P]);this.header=new O,m.inflateGetHeader(this.strm,this.header)}function q(D,W){var P=new z(W);if(P.push(D,!0),P.err)throw P.msg||C[P.err];return P.result}z.prototype.push=function(D,W){var P,I,U,k,_,R,j=this.strm,A=this.options.chunkSize,N=this.options.dictionary,V=!1;if(this.ended)return!1;I=W===~~W?W:W===!0?S.Z_FINISH:S.Z_NO_FLUSH,typeof D=="string"?j.input=y.binstring2buf(D):H.call(D)==="[object ArrayBuffer]"?j.input=new Uint8Array(D):j.input=D,j.next_in=0,j.avail_in=j.input.length;do{if(j.avail_out===0&&(j.output=new b.Buf8(A),j.next_out=0,j.avail_out=A),(P=m.inflate(j,S.Z_NO_FLUSH))===S.Z_NEED_DICT&&N&&(R=typeof N=="string"?y.string2buf(N):H.call(N)==="[object ArrayBuffer]"?new Uint8Array(N):N,P=m.inflateSetDictionary(this.strm,R)),P===S.Z_BUF_ERROR&&V===!0&&(P=S.Z_OK,V=!1),P!==S.Z_STREAM_END&&P!==S.Z_OK)return this.onEnd(P),!(this.ended=!0);j.next_out&&(j.avail_out!==0&&P!==S.Z_STREAM_END&&(j.avail_in!==0||I!==S.Z_FINISH&&I!==S.Z_SYNC_FLUSH)||(this.options.to==="string"?(U=y.utf8border(j.output,j.next_out),k=j.next_out-U,_=y.buf2string(j.output,U),j.next_out=k,j.avail_out=A-k,k&&b.arraySet(j.output,j.output,U,k,0),this.onData(_)):this.onData(b.shrinkBuf(j.output,j.next_out)))),j.avail_in===0&&j.avail_out===0&&(V=!0)}while((0<j.avail_in||j.avail_out===0)&&P!==S.Z_STREAM_END);return P===S.Z_STREAM_END&&(I=S.Z_FINISH),I===S.Z_FINISH?(P=m.inflateEnd(this.strm),this.onEnd(P),this.ended=!0,P===S.Z_OK):I!==S.Z_SYNC_FLUSH||(this.onEnd(S.Z_OK),!(j.avail_out=0))},z.prototype.onData=function(D){this.chunks.push(D)},z.prototype.onEnd=function(D){D===S.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=b.flattenChunks(this.chunks)),this.chunks=[],this.err=D,this.msg=this.strm.msg},g.Inflate=z,g.inflate=q,g.inflateRaw=function(D,W){return(W=W||{}).raw=!0,q(D,W)},g.ungzip=q},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(p,v,g){var m=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";g.assign=function(S){for(var C=Array.prototype.slice.call(arguments,1);C.length;){var L=C.shift();if(L){if(typeof L!="object")throw new TypeError(L+"must be non-object");for(var O in L)L.hasOwnProperty(O)&&(S[O]=L[O])}}return S},g.shrinkBuf=function(S,C){return S.length===C?S:S.subarray?S.subarray(0,C):(S.length=C,S)};var b={arraySet:function(S,C,L,O,H){if(C.subarray&&S.subarray)S.set(C.subarray(L,L+O),H);else for(var z=0;z<O;z++)S[H+z]=C[L+z]},flattenChunks:function(S){var C,L,O,H,z,q;for(C=O=0,L=S.length;C<L;C++)O+=S[C].length;for(q=new Uint8Array(O),C=H=0,L=S.length;C<L;C++)z=S[C],q.set(z,H),H+=z.length;return q}},y={arraySet:function(S,C,L,O,H){for(var z=0;z<O;z++)S[H+z]=C[L+z]},flattenChunks:function(S){return[].concat.apply([],S)}};g.setTyped=function(S){S?(g.Buf8=Uint8Array,g.Buf16=Uint16Array,g.Buf32=Int32Array,g.assign(g,b)):(g.Buf8=Array,g.Buf16=Array,g.Buf32=Array,g.assign(g,y))},g.setTyped(m)},{}],42:[function(p,v,g){var m=p("./common"),b=!0,y=!0;try{String.fromCharCode.apply(null,[0])}catch{b=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{y=!1}for(var S=new m.Buf8(256),C=0;C<256;C++)S[C]=252<=C?6:248<=C?5:240<=C?4:224<=C?3:192<=C?2:1;function L(O,H){if(H<65537&&(O.subarray&&y||!O.subarray&&b))return String.fromCharCode.apply(null,m.shrinkBuf(O,H));for(var z="",q=0;q<H;q++)z+=String.fromCharCode(O[q]);return z}S[254]=S[254]=1,g.string2buf=function(O){var H,z,q,D,W,P=O.length,I=0;for(D=0;D<P;D++)(64512&(z=O.charCodeAt(D)))==55296&&D+1<P&&(64512&(q=O.charCodeAt(D+1)))==56320&&(z=65536+(z-55296<<10)+(q-56320),D++),I+=z<128?1:z<2048?2:z<65536?3:4;for(H=new m.Buf8(I),D=W=0;W<I;D++)(64512&(z=O.charCodeAt(D)))==55296&&D+1<P&&(64512&(q=O.charCodeAt(D+1)))==56320&&(z=65536+(z-55296<<10)+(q-56320),D++),z<128?H[W++]=z:(z<2048?H[W++]=192|z>>>6:(z<65536?H[W++]=224|z>>>12:(H[W++]=240|z>>>18,H[W++]=128|z>>>12&63),H[W++]=128|z>>>6&63),H[W++]=128|63&z);return H},g.buf2binstring=function(O){return L(O,O.length)},g.binstring2buf=function(O){for(var H=new m.Buf8(O.length),z=0,q=H.length;z<q;z++)H[z]=O.charCodeAt(z);return H},g.buf2string=function(O,H){var z,q,D,W,P=H||O.length,I=new Array(2*P);for(z=q=0;z<P;)if((D=O[z++])<128)I[q++]=D;else if(4<(W=S[D]))I[q++]=65533,z+=W-1;else{for(D&=W===2?31:W===3?15:7;1<W&&z<P;)D=D<<6|63&O[z++],W--;1<W?I[q++]=65533:D<65536?I[q++]=D:(D-=65536,I[q++]=55296|D>>10&1023,I[q++]=56320|1023&D)}return L(I,q)},g.utf8border=function(O,H){var z;for((H=H||O.length)>O.length&&(H=O.length),z=H-1;0<=z&&(192&O[z])==128;)z--;return z<0||z===0?H:z+S[O[z]]>H?z:H}},{"./common":41}],43:[function(p,v,g){v.exports=function(m,b,y,S){for(var C=65535&m|0,L=m>>>16&65535|0,O=0;y!==0;){for(y-=O=2e3<y?2e3:y;L=L+(C=C+b[S++]|0)|0,--O;);C%=65521,L%=65521}return C|L<<16|0}},{}],44:[function(p,v,g){v.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(p,v,g){var m=function(){for(var b,y=[],S=0;S<256;S++){b=S;for(var C=0;C<8;C++)b=1&b?3988292384^b>>>1:b>>>1;y[S]=b}return y}();v.exports=function(b,y,S,C){var L=m,O=C+S;b^=-1;for(var H=C;H<O;H++)b=b>>>8^L[255&(b^y[H])];return-1^b}},{}],46:[function(p,v,g){var m,b=p("../utils/common"),y=p("./trees"),S=p("./adler32"),C=p("./crc32"),L=p("./messages"),O=-2,H=258,z=262,q=113;function D(X,ne){return X.msg=L[ne],ne}function W(X){return(X<<1)-(4<X?9:0)}function P(X){for(var ne=X.length;0<=--ne;)X[ne]=0}function I(X){var ne=X.state,Y=ne.pending;Y>X.avail_out&&(Y=X.avail_out),Y!==0&&(b.arraySet(X.output,ne.pending_buf,ne.pending_out,Y,X.next_out),X.next_out+=Y,ne.pending_out+=Y,X.total_out+=Y,X.avail_out-=Y,ne.pending-=Y,ne.pending===0&&(ne.pending_out=0))}function U(X,ne){y._tr_flush_block(X,0<=X.block_start?X.block_start:-1,X.strstart-X.block_start,ne),X.block_start=X.strstart,I(X.strm)}function k(X,ne){X.pending_buf[X.pending++]=ne}function _(X,ne){X.pending_buf[X.pending++]=ne>>>8&255,X.pending_buf[X.pending++]=255&ne}function R(X,ne){var Y,K,ee=X.max_chain_length,ue=X.strstart,se=X.prev_length,ce=X.nice_match,fe=X.strstart>X.w_size-z?X.strstart-(X.w_size-z):0,ve=X.window,_e=X.w_mask,le=X.prev,ke=X.strstart+H,Te=ve[ue+se-1],pe=ve[ue+se];X.prev_length>=X.good_match&&(ee>>=2),ce>X.lookahead&&(ce=X.lookahead);do if(ve[(Y=ne)+se]===pe&&ve[Y+se-1]===Te&&ve[Y]===ve[ue]&&ve[++Y]===ve[ue+1]){ue+=2,Y++;do;while(ve[++ue]===ve[++Y]&&ve[++ue]===ve[++Y]&&ve[++ue]===ve[++Y]&&ve[++ue]===ve[++Y]&&ve[++ue]===ve[++Y]&&ve[++ue]===ve[++Y]&&ve[++ue]===ve[++Y]&&ve[++ue]===ve[++Y]&&ue<ke);if(K=H-(ke-ue),ue=ke-H,se<K){if(X.match_start=ne,ce<=(se=K))break;Te=ve[ue+se-1],pe=ve[ue+se]}}while((ne=le[ne&_e])>fe&&--ee!=0);return se<=X.lookahead?se:X.lookahead}function j(X){var ne,Y,K,ee,ue,se,ce,fe,ve,_e,le=X.w_size;do{if(ee=X.window_size-X.lookahead-X.strstart,X.strstart>=le+(le-z)){for(b.arraySet(X.window,X.window,le,le,0),X.match_start-=le,X.strstart-=le,X.block_start-=le,ne=Y=X.hash_size;K=X.head[--ne],X.head[ne]=le<=K?K-le:0,--Y;);for(ne=Y=le;K=X.prev[--ne],X.prev[ne]=le<=K?K-le:0,--Y;);ee+=le}if(X.strm.avail_in===0)break;if(se=X.strm,ce=X.window,fe=X.strstart+X.lookahead,_e=void 0,(ve=ee)<(_e=se.avail_in)&&(_e=ve),Y=_e===0?0:(se.avail_in-=_e,b.arraySet(ce,se.input,se.next_in,_e,fe),se.state.wrap===1?se.adler=S(se.adler,ce,_e,fe):se.state.wrap===2&&(se.adler=C(se.adler,ce,_e,fe)),se.next_in+=_e,se.total_in+=_e,_e),X.lookahead+=Y,X.lookahead+X.insert>=3)for(ue=X.strstart-X.insert,X.ins_h=X.window[ue],X.ins_h=(X.ins_h<<X.hash_shift^X.window[ue+1])&X.hash_mask;X.insert&&(X.ins_h=(X.ins_h<<X.hash_shift^X.window[ue+3-1])&X.hash_mask,X.prev[ue&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=ue,ue++,X.insert--,!(X.lookahead+X.insert<3)););}while(X.lookahead<z&&X.strm.avail_in!==0)}function A(X,ne){for(var Y,K;;){if(X.lookahead<z){if(j(X),X.lookahead<z&&ne===0)return 1;if(X.lookahead===0)break}if(Y=0,X.lookahead>=3&&(X.ins_h=(X.ins_h<<X.hash_shift^X.window[X.strstart+3-1])&X.hash_mask,Y=X.prev[X.strstart&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=X.strstart),Y!==0&&X.strstart-Y<=X.w_size-z&&(X.match_length=R(X,Y)),X.match_length>=3)if(K=y._tr_tally(X,X.strstart-X.match_start,X.match_length-3),X.lookahead-=X.match_length,X.match_length<=X.max_lazy_match&&X.lookahead>=3){for(X.match_length--;X.strstart++,X.ins_h=(X.ins_h<<X.hash_shift^X.window[X.strstart+3-1])&X.hash_mask,Y=X.prev[X.strstart&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=X.strstart,--X.match_length!=0;);X.strstart++}else X.strstart+=X.match_length,X.match_length=0,X.ins_h=X.window[X.strstart],X.ins_h=(X.ins_h<<X.hash_shift^X.window[X.strstart+1])&X.hash_mask;else K=y._tr_tally(X,0,X.window[X.strstart]),X.lookahead--,X.strstart++;if(K&&(U(X,!1),X.strm.avail_out===0))return 1}return X.insert=X.strstart<2?X.strstart:2,ne===4?(U(X,!0),X.strm.avail_out===0?3:4):X.last_lit&&(U(X,!1),X.strm.avail_out===0)?1:2}function N(X,ne){for(var Y,K,ee;;){if(X.lookahead<z){if(j(X),X.lookahead<z&&ne===0)return 1;if(X.lookahead===0)break}if(Y=0,X.lookahead>=3&&(X.ins_h=(X.ins_h<<X.hash_shift^X.window[X.strstart+3-1])&X.hash_mask,Y=X.prev[X.strstart&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=X.strstart),X.prev_length=X.match_length,X.prev_match=X.match_start,X.match_length=2,Y!==0&&X.prev_length<X.max_lazy_match&&X.strstart-Y<=X.w_size-z&&(X.match_length=R(X,Y),X.match_length<=5&&(X.strategy===1||X.match_length===3&&4096<X.strstart-X.match_start)&&(X.match_length=2)),X.prev_length>=3&&X.match_length<=X.prev_length){for(ee=X.strstart+X.lookahead-3,K=y._tr_tally(X,X.strstart-1-X.prev_match,X.prev_length-3),X.lookahead-=X.prev_length-1,X.prev_length-=2;++X.strstart<=ee&&(X.ins_h=(X.ins_h<<X.hash_shift^X.window[X.strstart+3-1])&X.hash_mask,Y=X.prev[X.strstart&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=X.strstart),--X.prev_length!=0;);if(X.match_available=0,X.match_length=2,X.strstart++,K&&(U(X,!1),X.strm.avail_out===0))return 1}else if(X.match_available){if((K=y._tr_tally(X,0,X.window[X.strstart-1]))&&U(X,!1),X.strstart++,X.lookahead--,X.strm.avail_out===0)return 1}else X.match_available=1,X.strstart++,X.lookahead--}return X.match_available&&(K=y._tr_tally(X,0,X.window[X.strstart-1]),X.match_available=0),X.insert=X.strstart<2?X.strstart:2,ne===4?(U(X,!0),X.strm.avail_out===0?3:4):X.last_lit&&(U(X,!1),X.strm.avail_out===0)?1:2}function V(X,ne,Y,K,ee){this.good_length=X,this.max_lazy=ne,this.nice_length=Y,this.max_chain=K,this.func=ee}function M(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new b.Buf16(1146),this.dyn_dtree=new b.Buf16(122),this.bl_tree=new b.Buf16(78),P(this.dyn_ltree),P(this.dyn_dtree),P(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new b.Buf16(16),this.heap=new b.Buf16(573),P(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new b.Buf16(573),P(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Z(X){var ne;return X&&X.state?(X.total_in=X.total_out=0,X.data_type=2,(ne=X.state).pending=0,ne.pending_out=0,ne.wrap<0&&(ne.wrap=-ne.wrap),ne.status=ne.wrap?42:q,X.adler=ne.wrap===2?0:1,ne.last_flush=0,y._tr_init(ne),0):D(X,O)}function J(X){var ne=Z(X);return ne===0&&function(Y){Y.window_size=2*Y.w_size,P(Y.head),Y.max_lazy_match=m[Y.level].max_lazy,Y.good_match=m[Y.level].good_length,Y.nice_match=m[Y.level].nice_length,Y.max_chain_length=m[Y.level].max_chain,Y.strstart=0,Y.block_start=0,Y.lookahead=0,Y.insert=0,Y.match_length=Y.prev_length=2,Y.match_available=0,Y.ins_h=0}(X.state),ne}function re(X,ne,Y,K,ee,ue){if(!X)return O;var se=1;if(ne===-1&&(ne=6),K<0?(se=0,K=-K):15<K&&(se=2,K-=16),ee<1||9<ee||Y!==8||K<8||15<K||ne<0||9<ne||ue<0||4<ue)return D(X,O);K===8&&(K=9);var ce=new M;return(X.state=ce).strm=X,ce.wrap=se,ce.gzhead=null,ce.w_bits=K,ce.w_size=1<<ce.w_bits,ce.w_mask=ce.w_size-1,ce.hash_bits=ee+7,ce.hash_size=1<<ce.hash_bits,ce.hash_mask=ce.hash_size-1,ce.hash_shift=~~((ce.hash_bits+3-1)/3),ce.window=new b.Buf8(2*ce.w_size),ce.head=new b.Buf16(ce.hash_size),ce.prev=new b.Buf16(ce.w_size),ce.lit_bufsize=1<<ee+6,ce.pending_buf_size=4*ce.lit_bufsize,ce.pending_buf=new b.Buf8(ce.pending_buf_size),ce.d_buf=1*ce.lit_bufsize,ce.l_buf=3*ce.lit_bufsize,ce.level=ne,ce.strategy=ue,ce.method=Y,J(X)}m=[new V(0,0,0,0,function(X,ne){var Y=65535;for(Y>X.pending_buf_size-5&&(Y=X.pending_buf_size-5);;){if(X.lookahead<=1){if(j(X),X.lookahead===0&&ne===0)return 1;if(X.lookahead===0)break}X.strstart+=X.lookahead,X.lookahead=0;var K=X.block_start+Y;if((X.strstart===0||X.strstart>=K)&&(X.lookahead=X.strstart-K,X.strstart=K,U(X,!1),X.strm.avail_out===0)||X.strstart-X.block_start>=X.w_size-z&&(U(X,!1),X.strm.avail_out===0))return 1}return X.insert=0,ne===4?(U(X,!0),X.strm.avail_out===0?3:4):(X.strstart>X.block_start&&(U(X,!1),X.strm.avail_out),1)}),new V(4,4,8,4,A),new V(4,5,16,8,A),new V(4,6,32,32,A),new V(4,4,16,16,N),new V(8,16,32,32,N),new V(8,16,128,128,N),new V(8,32,128,256,N),new V(32,128,258,1024,N),new V(32,258,258,4096,N)],g.deflateInit=function(X,ne){return re(X,ne,8,15,8,0)},g.deflateInit2=re,g.deflateReset=J,g.deflateResetKeep=Z,g.deflateSetHeader=function(X,ne){return X&&X.state?X.state.wrap!==2?O:(X.state.gzhead=ne,0):O},g.deflate=function(X,ne){var Y,K,ee,ue;if(!X||!X.state||5<ne||ne<0)return X?D(X,O):O;if(K=X.state,!X.output||!X.input&&X.avail_in!==0||K.status===666&&ne!==4)return D(X,X.avail_out===0?-5:O);if(K.strm=X,Y=K.last_flush,K.last_flush=ne,K.status===42)if(K.wrap===2)X.adler=0,k(K,31),k(K,139),k(K,8),K.gzhead?(k(K,(K.gzhead.text?1:0)+(K.gzhead.hcrc?2:0)+(K.gzhead.extra?4:0)+(K.gzhead.name?8:0)+(K.gzhead.comment?16:0)),k(K,255&K.gzhead.time),k(K,K.gzhead.time>>8&255),k(K,K.gzhead.time>>16&255),k(K,K.gzhead.time>>24&255),k(K,K.level===9?2:2<=K.strategy||K.level<2?4:0),k(K,255&K.gzhead.os),K.gzhead.extra&&K.gzhead.extra.length&&(k(K,255&K.gzhead.extra.length),k(K,K.gzhead.extra.length>>8&255)),K.gzhead.hcrc&&(X.adler=C(X.adler,K.pending_buf,K.pending,0)),K.gzindex=0,K.status=69):(k(K,0),k(K,0),k(K,0),k(K,0),k(K,0),k(K,K.level===9?2:2<=K.strategy||K.level<2?4:0),k(K,3),K.status=q);else{var se=8+(K.w_bits-8<<4)<<8;se|=(2<=K.strategy||K.level<2?0:K.level<6?1:K.level===6?2:3)<<6,K.strstart!==0&&(se|=32),se+=31-se%31,K.status=q,_(K,se),K.strstart!==0&&(_(K,X.adler>>>16),_(K,65535&X.adler)),X.adler=1}if(K.status===69)if(K.gzhead.extra){for(ee=K.pending;K.gzindex<(65535&K.gzhead.extra.length)&&(K.pending!==K.pending_buf_size||(K.gzhead.hcrc&&K.pending>ee&&(X.adler=C(X.adler,K.pending_buf,K.pending-ee,ee)),I(X),ee=K.pending,K.pending!==K.pending_buf_size));)k(K,255&K.gzhead.extra[K.gzindex]),K.gzindex++;K.gzhead.hcrc&&K.pending>ee&&(X.adler=C(X.adler,K.pending_buf,K.pending-ee,ee)),K.gzindex===K.gzhead.extra.length&&(K.gzindex=0,K.status=73)}else K.status=73;if(K.status===73)if(K.gzhead.name){ee=K.pending;do{if(K.pending===K.pending_buf_size&&(K.gzhead.hcrc&&K.pending>ee&&(X.adler=C(X.adler,K.pending_buf,K.pending-ee,ee)),I(X),ee=K.pending,K.pending===K.pending_buf_size)){ue=1;break}ue=K.gzindex<K.gzhead.name.length?255&K.gzhead.name.charCodeAt(K.gzindex++):0,k(K,ue)}while(ue!==0);K.gzhead.hcrc&&K.pending>ee&&(X.adler=C(X.adler,K.pending_buf,K.pending-ee,ee)),ue===0&&(K.gzindex=0,K.status=91)}else K.status=91;if(K.status===91)if(K.gzhead.comment){ee=K.pending;do{if(K.pending===K.pending_buf_size&&(K.gzhead.hcrc&&K.pending>ee&&(X.adler=C(X.adler,K.pending_buf,K.pending-ee,ee)),I(X),ee=K.pending,K.pending===K.pending_buf_size)){ue=1;break}ue=K.gzindex<K.gzhead.comment.length?255&K.gzhead.comment.charCodeAt(K.gzindex++):0,k(K,ue)}while(ue!==0);K.gzhead.hcrc&&K.pending>ee&&(X.adler=C(X.adler,K.pending_buf,K.pending-ee,ee)),ue===0&&(K.status=103)}else K.status=103;if(K.status===103&&(K.gzhead.hcrc?(K.pending+2>K.pending_buf_size&&I(X),K.pending+2<=K.pending_buf_size&&(k(K,255&X.adler),k(K,X.adler>>8&255),X.adler=0,K.status=q)):K.status=q),K.pending!==0){if(I(X),X.avail_out===0)return K.last_flush=-1,0}else if(X.avail_in===0&&W(ne)<=W(Y)&&ne!==4)return D(X,-5);if(K.status===666&&X.avail_in!==0)return D(X,-5);if(X.avail_in!==0||K.lookahead!==0||ne!==0&&K.status!==666){var ce=K.strategy===2?function(fe,ve){for(var _e;;){if(fe.lookahead===0&&(j(fe),fe.lookahead===0)){if(ve===0)return 1;break}if(fe.match_length=0,_e=y._tr_tally(fe,0,fe.window[fe.strstart]),fe.lookahead--,fe.strstart++,_e&&(U(fe,!1),fe.strm.avail_out===0))return 1}return fe.insert=0,ve===4?(U(fe,!0),fe.strm.avail_out===0?3:4):fe.last_lit&&(U(fe,!1),fe.strm.avail_out===0)?1:2}(K,ne):K.strategy===3?function(fe,ve){for(var _e,le,ke,Te,pe=fe.window;;){if(fe.lookahead<=H){if(j(fe),fe.lookahead<=H&&ve===0)return 1;if(fe.lookahead===0)break}if(fe.match_length=0,fe.lookahead>=3&&0<fe.strstart&&(le=pe[ke=fe.strstart-1])===pe[++ke]&&le===pe[++ke]&&le===pe[++ke]){Te=fe.strstart+H;do;while(le===pe[++ke]&&le===pe[++ke]&&le===pe[++ke]&&le===pe[++ke]&&le===pe[++ke]&&le===pe[++ke]&&le===pe[++ke]&&le===pe[++ke]&&ke<Te);fe.match_length=H-(Te-ke),fe.match_length>fe.lookahead&&(fe.match_length=fe.lookahead)}if(fe.match_length>=3?(_e=y._tr_tally(fe,1,fe.match_length-3),fe.lookahead-=fe.match_length,fe.strstart+=fe.match_length,fe.match_length=0):(_e=y._tr_tally(fe,0,fe.window[fe.strstart]),fe.lookahead--,fe.strstart++),_e&&(U(fe,!1),fe.strm.avail_out===0))return 1}return fe.insert=0,ve===4?(U(fe,!0),fe.strm.avail_out===0?3:4):fe.last_lit&&(U(fe,!1),fe.strm.avail_out===0)?1:2}(K,ne):m[K.level].func(K,ne);if(ce!==3&&ce!==4||(K.status=666),ce===1||ce===3)return X.avail_out===0&&(K.last_flush=-1),0;if(ce===2&&(ne===1?y._tr_align(K):ne!==5&&(y._tr_stored_block(K,0,0,!1),ne===3&&(P(K.head),K.lookahead===0&&(K.strstart=0,K.block_start=0,K.insert=0))),I(X),X.avail_out===0))return K.last_flush=-1,0}return ne!==4?0:K.wrap<=0?1:(K.wrap===2?(k(K,255&X.adler),k(K,X.adler>>8&255),k(K,X.adler>>16&255),k(K,X.adler>>24&255),k(K,255&X.total_in),k(K,X.total_in>>8&255),k(K,X.total_in>>16&255),k(K,X.total_in>>24&255)):(_(K,X.adler>>>16),_(K,65535&X.adler)),I(X),0<K.wrap&&(K.wrap=-K.wrap),K.pending!==0?0:1)},g.deflateEnd=function(X){var ne;return X&&X.state?(ne=X.state.status)!==42&&ne!==69&&ne!==73&&ne!==91&&ne!==103&&ne!==q&&ne!==666?D(X,O):(X.state=null,ne===q?D(X,-3):0):O},g.deflateSetDictionary=function(X,ne){var Y,K,ee,ue,se,ce,fe,ve,_e=ne.length;if(!X||!X.state||(ue=(Y=X.state).wrap)===2||ue===1&&Y.status!==42||Y.lookahead)return O;for(ue===1&&(X.adler=S(X.adler,ne,_e,0)),Y.wrap=0,_e>=Y.w_size&&(ue===0&&(P(Y.head),Y.strstart=0,Y.block_start=0,Y.insert=0),ve=new b.Buf8(Y.w_size),b.arraySet(ve,ne,_e-Y.w_size,Y.w_size,0),ne=ve,_e=Y.w_size),se=X.avail_in,ce=X.next_in,fe=X.input,X.avail_in=_e,X.next_in=0,X.input=ne,j(Y);Y.lookahead>=3;){for(K=Y.strstart,ee=Y.lookahead-2;Y.ins_h=(Y.ins_h<<Y.hash_shift^Y.window[K+3-1])&Y.hash_mask,Y.prev[K&Y.w_mask]=Y.head[Y.ins_h],Y.head[Y.ins_h]=K,K++,--ee;);Y.strstart=K,Y.lookahead=2,j(Y)}return Y.strstart+=Y.lookahead,Y.block_start=Y.strstart,Y.insert=Y.lookahead,Y.lookahead=0,Y.match_length=Y.prev_length=2,Y.match_available=0,X.next_in=ce,X.input=fe,X.avail_in=se,Y.wrap=ue,0},g.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(p,v,g){v.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(p,v,g){v.exports=function(m,b){var y,S,C,L,O,H,z,q,D,W,P,I,U,k,_,R,j,A,N,V,M,Z,J,re,X;y=m.state,S=m.next_in,re=m.input,C=S+(m.avail_in-5),L=m.next_out,X=m.output,O=L-(b-m.avail_out),H=L+(m.avail_out-257),z=y.dmax,q=y.wsize,D=y.whave,W=y.wnext,P=y.window,I=y.hold,U=y.bits,k=y.lencode,_=y.distcode,R=(1<<y.lenbits)-1,j=(1<<y.distbits)-1;e:do{U<15&&(I+=re[S++]<<U,U+=8,I+=re[S++]<<U,U+=8),A=k[I&R];t:for(;;){if(I>>>=N=A>>>24,U-=N,(N=A>>>16&255)==0)X[L++]=65535&A;else{if(!(16&N)){if((64&N)==0){A=k[(65535&A)+(I&(1<<N)-1)];continue t}if(32&N){y.mode=12;break e}m.msg="invalid literal/length code",y.mode=30;break e}V=65535&A,(N&=15)&&(U<N&&(I+=re[S++]<<U,U+=8),V+=I&(1<<N)-1,I>>>=N,U-=N),U<15&&(I+=re[S++]<<U,U+=8,I+=re[S++]<<U,U+=8),A=_[I&j];r:for(;;){if(I>>>=N=A>>>24,U-=N,!(16&(N=A>>>16&255))){if((64&N)==0){A=_[(65535&A)+(I&(1<<N)-1)];continue r}m.msg="invalid distance code",y.mode=30;break e}if(M=65535&A,U<(N&=15)&&(I+=re[S++]<<U,(U+=8)<N&&(I+=re[S++]<<U,U+=8)),z<(M+=I&(1<<N)-1)){m.msg="invalid distance too far back",y.mode=30;break e}if(I>>>=N,U-=N,(N=L-O)<M){if(D<(N=M-N)&&y.sane){m.msg="invalid distance too far back",y.mode=30;break e}if(J=P,(Z=0)===W){if(Z+=q-N,N<V){for(V-=N;X[L++]=P[Z++],--N;);Z=L-M,J=X}}else if(W<N){if(Z+=q+W-N,(N-=W)<V){for(V-=N;X[L++]=P[Z++],--N;);if(Z=0,W<V){for(V-=N=W;X[L++]=P[Z++],--N;);Z=L-M,J=X}}}else if(Z+=W-N,N<V){for(V-=N;X[L++]=P[Z++],--N;);Z=L-M,J=X}for(;2<V;)X[L++]=J[Z++],X[L++]=J[Z++],X[L++]=J[Z++],V-=3;V&&(X[L++]=J[Z++],1<V&&(X[L++]=J[Z++]))}else{for(Z=L-M;X[L++]=X[Z++],X[L++]=X[Z++],X[L++]=X[Z++],2<(V-=3););V&&(X[L++]=X[Z++],1<V&&(X[L++]=X[Z++]))}break}}break}}while(S<C&&L<H);S-=V=U>>3,I&=(1<<(U-=V<<3))-1,m.next_in=S,m.next_out=L,m.avail_in=S<C?C-S+5:5-(S-C),m.avail_out=L<H?H-L+257:257-(L-H),y.hold=I,y.bits=U}},{}],49:[function(p,v,g){var m=p("../utils/common"),b=p("./adler32"),y=p("./crc32"),S=p("./inffast"),C=p("./inftrees"),L=-2;function O(R){return(R>>>24&255)+(R>>>8&65280)+((65280&R)<<8)+((255&R)<<24)}function H(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new m.Buf16(320),this.work=new m.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function z(R){var j;return R&&R.state?(j=R.state,R.total_in=R.total_out=j.total=0,R.msg="",j.wrap&&(R.adler=1&j.wrap),j.mode=1,j.last=0,j.havedict=0,j.dmax=32768,j.head=null,j.hold=0,j.bits=0,j.lencode=j.lendyn=new m.Buf32(852),j.distcode=j.distdyn=new m.Buf32(592),j.sane=1,j.back=-1,0):L}function q(R){var j;return R&&R.state?((j=R.state).wsize=0,j.whave=0,j.wnext=0,z(R)):L}function D(R,j){var A,N;return R&&R.state?(N=R.state,j<0?(A=0,j=-j):(A=1+(j>>4),j<48&&(j&=15)),j&&(j<8||15<j)?L:(N.window!==null&&N.wbits!==j&&(N.window=null),N.wrap=A,N.wbits=j,q(R))):L}function W(R,j){var A,N;return R?(N=new H,(R.state=N).window=null,(A=D(R,j))!==0&&(R.state=null),A):L}var P,I,U=!0;function k(R){if(U){var j;for(P=new m.Buf32(512),I=new m.Buf32(32),j=0;j<144;)R.lens[j++]=8;for(;j<256;)R.lens[j++]=9;for(;j<280;)R.lens[j++]=7;for(;j<288;)R.lens[j++]=8;for(C(1,R.lens,0,288,P,0,R.work,{bits:9}),j=0;j<32;)R.lens[j++]=5;C(2,R.lens,0,32,I,0,R.work,{bits:5}),U=!1}R.lencode=P,R.lenbits=9,R.distcode=I,R.distbits=5}function _(R,j,A,N){var V,M=R.state;return M.window===null&&(M.wsize=1<<M.wbits,M.wnext=0,M.whave=0,M.window=new m.Buf8(M.wsize)),N>=M.wsize?(m.arraySet(M.window,j,A-M.wsize,M.wsize,0),M.wnext=0,M.whave=M.wsize):(N<(V=M.wsize-M.wnext)&&(V=N),m.arraySet(M.window,j,A-N,V,M.wnext),(N-=V)?(m.arraySet(M.window,j,A-N,N,0),M.wnext=N,M.whave=M.wsize):(M.wnext+=V,M.wnext===M.wsize&&(M.wnext=0),M.whave<M.wsize&&(M.whave+=V))),0}g.inflateReset=q,g.inflateReset2=D,g.inflateResetKeep=z,g.inflateInit=function(R){return W(R,15)},g.inflateInit2=W,g.inflate=function(R,j){var A,N,V,M,Z,J,re,X,ne,Y,K,ee,ue,se,ce,fe,ve,_e,le,ke,Te,pe,ye,ge,De=0,He=new m.Buf8(4),Xe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!R||!R.state||!R.output||!R.input&&R.avail_in!==0)return L;(A=R.state).mode===12&&(A.mode=13),Z=R.next_out,V=R.output,re=R.avail_out,M=R.next_in,N=R.input,J=R.avail_in,X=A.hold,ne=A.bits,Y=J,K=re,pe=0;e:for(;;)switch(A.mode){case 1:if(A.wrap===0){A.mode=13;break}for(;ne<16;){if(J===0)break e;J--,X+=N[M++]<<ne,ne+=8}if(2&A.wrap&&X===35615){He[A.check=0]=255&X,He[1]=X>>>8&255,A.check=y(A.check,He,2,0),ne=X=0,A.mode=2;break}if(A.flags=0,A.head&&(A.head.done=!1),!(1&A.wrap)||(((255&X)<<8)+(X>>8))%31){R.msg="incorrect header check",A.mode=30;break}if((15&X)!=8){R.msg="unknown compression method",A.mode=30;break}if(ne-=4,Te=8+(15&(X>>>=4)),A.wbits===0)A.wbits=Te;else if(Te>A.wbits){R.msg="invalid window size",A.mode=30;break}A.dmax=1<<Te,R.adler=A.check=1,A.mode=512&X?10:12,ne=X=0;break;case 2:for(;ne<16;){if(J===0)break e;J--,X+=N[M++]<<ne,ne+=8}if(A.flags=X,(255&A.flags)!=8){R.msg="unknown compression method",A.mode=30;break}if(57344&A.flags){R.msg="unknown header flags set",A.mode=30;break}A.head&&(A.head.text=X>>8&1),512&A.flags&&(He[0]=255&X,He[1]=X>>>8&255,A.check=y(A.check,He,2,0)),ne=X=0,A.mode=3;case 3:for(;ne<32;){if(J===0)break e;J--,X+=N[M++]<<ne,ne+=8}A.head&&(A.head.time=X),512&A.flags&&(He[0]=255&X,He[1]=X>>>8&255,He[2]=X>>>16&255,He[3]=X>>>24&255,A.check=y(A.check,He,4,0)),ne=X=0,A.mode=4;case 4:for(;ne<16;){if(J===0)break e;J--,X+=N[M++]<<ne,ne+=8}A.head&&(A.head.xflags=255&X,A.head.os=X>>8),512&A.flags&&(He[0]=255&X,He[1]=X>>>8&255,A.check=y(A.check,He,2,0)),ne=X=0,A.mode=5;case 5:if(1024&A.flags){for(;ne<16;){if(J===0)break e;J--,X+=N[M++]<<ne,ne+=8}A.length=X,A.head&&(A.head.extra_len=X),512&A.flags&&(He[0]=255&X,He[1]=X>>>8&255,A.check=y(A.check,He,2,0)),ne=X=0}else A.head&&(A.head.extra=null);A.mode=6;case 6:if(1024&A.flags&&(J<(ee=A.length)&&(ee=J),ee&&(A.head&&(Te=A.head.extra_len-A.length,A.head.extra||(A.head.extra=new Array(A.head.extra_len)),m.arraySet(A.head.extra,N,M,ee,Te)),512&A.flags&&(A.check=y(A.check,N,ee,M)),J-=ee,M+=ee,A.length-=ee),A.length))break e;A.length=0,A.mode=7;case 7:if(2048&A.flags){if(J===0)break e;for(ee=0;Te=N[M+ee++],A.head&&Te&&A.length<65536&&(A.head.name+=String.fromCharCode(Te)),Te&&ee<J;);if(512&A.flags&&(A.check=y(A.check,N,ee,M)),J-=ee,M+=ee,Te)break e}else A.head&&(A.head.name=null);A.length=0,A.mode=8;case 8:if(4096&A.flags){if(J===0)break e;for(ee=0;Te=N[M+ee++],A.head&&Te&&A.length<65536&&(A.head.comment+=String.fromCharCode(Te)),Te&&ee<J;);if(512&A.flags&&(A.check=y(A.check,N,ee,M)),J-=ee,M+=ee,Te)break e}else A.head&&(A.head.comment=null);A.mode=9;case 9:if(512&A.flags){for(;ne<16;){if(J===0)break e;J--,X+=N[M++]<<ne,ne+=8}if(X!==(65535&A.check)){R.msg="header crc mismatch",A.mode=30;break}ne=X=0}A.head&&(A.head.hcrc=A.flags>>9&1,A.head.done=!0),R.adler=A.check=0,A.mode=12;break;case 10:for(;ne<32;){if(J===0)break e;J--,X+=N[M++]<<ne,ne+=8}R.adler=A.check=O(X),ne=X=0,A.mode=11;case 11:if(A.havedict===0)return R.next_out=Z,R.avail_out=re,R.next_in=M,R.avail_in=J,A.hold=X,A.bits=ne,2;R.adler=A.check=1,A.mode=12;case 12:if(j===5||j===6)break e;case 13:if(A.last){X>>>=7&ne,ne-=7&ne,A.mode=27;break}for(;ne<3;){if(J===0)break e;J--,X+=N[M++]<<ne,ne+=8}switch(A.last=1&X,ne-=1,3&(X>>>=1)){case 0:A.mode=14;break;case 1:if(k(A),A.mode=20,j!==6)break;X>>>=2,ne-=2;break e;case 2:A.mode=17;break;case 3:R.msg="invalid block type",A.mode=30}X>>>=2,ne-=2;break;case 14:for(X>>>=7&ne,ne-=7&ne;ne<32;){if(J===0)break e;J--,X+=N[M++]<<ne,ne+=8}if((65535&X)!=(X>>>16^65535)){R.msg="invalid stored block lengths",A.mode=30;break}if(A.length=65535&X,ne=X=0,A.mode=15,j===6)break e;case 15:A.mode=16;case 16:if(ee=A.length){if(J<ee&&(ee=J),re<ee&&(ee=re),ee===0)break e;m.arraySet(V,N,M,ee,Z),J-=ee,M+=ee,re-=ee,Z+=ee,A.length-=ee;break}A.mode=12;break;case 17:for(;ne<14;){if(J===0)break e;J--,X+=N[M++]<<ne,ne+=8}if(A.nlen=257+(31&X),X>>>=5,ne-=5,A.ndist=1+(31&X),X>>>=5,ne-=5,A.ncode=4+(15&X),X>>>=4,ne-=4,286<A.nlen||30<A.ndist){R.msg="too many length or distance symbols",A.mode=30;break}A.have=0,A.mode=18;case 18:for(;A.have<A.ncode;){for(;ne<3;){if(J===0)break e;J--,X+=N[M++]<<ne,ne+=8}A.lens[Xe[A.have++]]=7&X,X>>>=3,ne-=3}for(;A.have<19;)A.lens[Xe[A.have++]]=0;if(A.lencode=A.lendyn,A.lenbits=7,ye={bits:A.lenbits},pe=C(0,A.lens,0,19,A.lencode,0,A.work,ye),A.lenbits=ye.bits,pe){R.msg="invalid code lengths set",A.mode=30;break}A.have=0,A.mode=19;case 19:for(;A.have<A.nlen+A.ndist;){for(;fe=(De=A.lencode[X&(1<<A.lenbits)-1])>>>16&255,ve=65535&De,!((ce=De>>>24)<=ne);){if(J===0)break e;J--,X+=N[M++]<<ne,ne+=8}if(ve<16)X>>>=ce,ne-=ce,A.lens[A.have++]=ve;else{if(ve===16){for(ge=ce+2;ne<ge;){if(J===0)break e;J--,X+=N[M++]<<ne,ne+=8}if(X>>>=ce,ne-=ce,A.have===0){R.msg="invalid bit length repeat",A.mode=30;break}Te=A.lens[A.have-1],ee=3+(3&X),X>>>=2,ne-=2}else if(ve===17){for(ge=ce+3;ne<ge;){if(J===0)break e;J--,X+=N[M++]<<ne,ne+=8}ne-=ce,Te=0,ee=3+(7&(X>>>=ce)),X>>>=3,ne-=3}else{for(ge=ce+7;ne<ge;){if(J===0)break e;J--,X+=N[M++]<<ne,ne+=8}ne-=ce,Te=0,ee=11+(127&(X>>>=ce)),X>>>=7,ne-=7}if(A.have+ee>A.nlen+A.ndist){R.msg="invalid bit length repeat",A.mode=30;break}for(;ee--;)A.lens[A.have++]=Te}}if(A.mode===30)break;if(A.lens[256]===0){R.msg="invalid code -- missing end-of-block",A.mode=30;break}if(A.lenbits=9,ye={bits:A.lenbits},pe=C(1,A.lens,0,A.nlen,A.lencode,0,A.work,ye),A.lenbits=ye.bits,pe){R.msg="invalid literal/lengths set",A.mode=30;break}if(A.distbits=6,A.distcode=A.distdyn,ye={bits:A.distbits},pe=C(2,A.lens,A.nlen,A.ndist,A.distcode,0,A.work,ye),A.distbits=ye.bits,pe){R.msg="invalid distances set",A.mode=30;break}if(A.mode=20,j===6)break e;case 20:A.mode=21;case 21:if(6<=J&&258<=re){R.next_out=Z,R.avail_out=re,R.next_in=M,R.avail_in=J,A.hold=X,A.bits=ne,S(R,K),Z=R.next_out,V=R.output,re=R.avail_out,M=R.next_in,N=R.input,J=R.avail_in,X=A.hold,ne=A.bits,A.mode===12&&(A.back=-1);break}for(A.back=0;fe=(De=A.lencode[X&(1<<A.lenbits)-1])>>>16&255,ve=65535&De,!((ce=De>>>24)<=ne);){if(J===0)break e;J--,X+=N[M++]<<ne,ne+=8}if(fe&&(240&fe)==0){for(_e=ce,le=fe,ke=ve;fe=(De=A.lencode[ke+((X&(1<<_e+le)-1)>>_e)])>>>16&255,ve=65535&De,!(_e+(ce=De>>>24)<=ne);){if(J===0)break e;J--,X+=N[M++]<<ne,ne+=8}X>>>=_e,ne-=_e,A.back+=_e}if(X>>>=ce,ne-=ce,A.back+=ce,A.length=ve,fe===0){A.mode=26;break}if(32&fe){A.back=-1,A.mode=12;break}if(64&fe){R.msg="invalid literal/length code",A.mode=30;break}A.extra=15&fe,A.mode=22;case 22:if(A.extra){for(ge=A.extra;ne<ge;){if(J===0)break e;J--,X+=N[M++]<<ne,ne+=8}A.length+=X&(1<<A.extra)-1,X>>>=A.extra,ne-=A.extra,A.back+=A.extra}A.was=A.length,A.mode=23;case 23:for(;fe=(De=A.distcode[X&(1<<A.distbits)-1])>>>16&255,ve=65535&De,!((ce=De>>>24)<=ne);){if(J===0)break e;J--,X+=N[M++]<<ne,ne+=8}if((240&fe)==0){for(_e=ce,le=fe,ke=ve;fe=(De=A.distcode[ke+((X&(1<<_e+le)-1)>>_e)])>>>16&255,ve=65535&De,!(_e+(ce=De>>>24)<=ne);){if(J===0)break e;J--,X+=N[M++]<<ne,ne+=8}X>>>=_e,ne-=_e,A.back+=_e}if(X>>>=ce,ne-=ce,A.back+=ce,64&fe){R.msg="invalid distance code",A.mode=30;break}A.offset=ve,A.extra=15&fe,A.mode=24;case 24:if(A.extra){for(ge=A.extra;ne<ge;){if(J===0)break e;J--,X+=N[M++]<<ne,ne+=8}A.offset+=X&(1<<A.extra)-1,X>>>=A.extra,ne-=A.extra,A.back+=A.extra}if(A.offset>A.dmax){R.msg="invalid distance too far back",A.mode=30;break}A.mode=25;case 25:if(re===0)break e;if(ee=K-re,A.offset>ee){if((ee=A.offset-ee)>A.whave&&A.sane){R.msg="invalid distance too far back",A.mode=30;break}ue=ee>A.wnext?(ee-=A.wnext,A.wsize-ee):A.wnext-ee,ee>A.length&&(ee=A.length),se=A.window}else se=V,ue=Z-A.offset,ee=A.length;for(re<ee&&(ee=re),re-=ee,A.length-=ee;V[Z++]=se[ue++],--ee;);A.length===0&&(A.mode=21);break;case 26:if(re===0)break e;V[Z++]=A.length,re--,A.mode=21;break;case 27:if(A.wrap){for(;ne<32;){if(J===0)break e;J--,X|=N[M++]<<ne,ne+=8}if(K-=re,R.total_out+=K,A.total+=K,K&&(R.adler=A.check=A.flags?y(A.check,V,K,Z-K):b(A.check,V,K,Z-K)),K=re,(A.flags?X:O(X))!==A.check){R.msg="incorrect data check",A.mode=30;break}ne=X=0}A.mode=28;case 28:if(A.wrap&&A.flags){for(;ne<32;){if(J===0)break e;J--,X+=N[M++]<<ne,ne+=8}if(X!==(4294967295&A.total)){R.msg="incorrect length check",A.mode=30;break}ne=X=0}A.mode=29;case 29:pe=1;break e;case 30:pe=-3;break e;case 31:return-4;case 32:default:return L}return R.next_out=Z,R.avail_out=re,R.next_in=M,R.avail_in=J,A.hold=X,A.bits=ne,(A.wsize||K!==R.avail_out&&A.mode<30&&(A.mode<27||j!==4))&&_(R,R.output,R.next_out,K-R.avail_out)?(A.mode=31,-4):(Y-=R.avail_in,K-=R.avail_out,R.total_in+=Y,R.total_out+=K,A.total+=K,A.wrap&&K&&(R.adler=A.check=A.flags?y(A.check,V,K,R.next_out-K):b(A.check,V,K,R.next_out-K)),R.data_type=A.bits+(A.last?64:0)+(A.mode===12?128:0)+(A.mode===20||A.mode===15?256:0),(Y==0&&K===0||j===4)&&pe===0&&(pe=-5),pe)},g.inflateEnd=function(R){if(!R||!R.state)return L;var j=R.state;return j.window&&(j.window=null),R.state=null,0},g.inflateGetHeader=function(R,j){var A;return R&&R.state?(2&(A=R.state).wrap)==0?L:((A.head=j).done=!1,0):L},g.inflateSetDictionary=function(R,j){var A,N=j.length;return R&&R.state?(A=R.state).wrap!==0&&A.mode!==11?L:A.mode===11&&b(1,j,N,0)!==A.check?-3:_(R,j,N,N)?(A.mode=31,-4):(A.havedict=1,0):L},g.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(p,v,g){var m=p("../utils/common"),b=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],y=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],S=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],C=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];v.exports=function(L,O,H,z,q,D,W,P){var I,U,k,_,R,j,A,N,V,M=P.bits,Z=0,J=0,re=0,X=0,ne=0,Y=0,K=0,ee=0,ue=0,se=0,ce=null,fe=0,ve=new m.Buf16(16),_e=new m.Buf16(16),le=null,ke=0;for(Z=0;Z<=15;Z++)ve[Z]=0;for(J=0;J<z;J++)ve[O[H+J]]++;for(ne=M,X=15;1<=X&&ve[X]===0;X--);if(X<ne&&(ne=X),X===0)return q[D++]=20971520,q[D++]=20971520,P.bits=1,0;for(re=1;re<X&&ve[re]===0;re++);for(ne<re&&(ne=re),Z=ee=1;Z<=15;Z++)if(ee<<=1,(ee-=ve[Z])<0)return-1;if(0<ee&&(L===0||X!==1))return-1;for(_e[1]=0,Z=1;Z<15;Z++)_e[Z+1]=_e[Z]+ve[Z];for(J=0;J<z;J++)O[H+J]!==0&&(W[_e[O[H+J]]++]=J);if(j=L===0?(ce=le=W,19):L===1?(ce=b,fe-=257,le=y,ke-=257,256):(ce=S,le=C,-1),Z=re,R=D,K=J=se=0,k=-1,_=(ue=1<<(Y=ne))-1,L===1&&852<ue||L===2&&592<ue)return 1;for(;;){for(A=Z-K,V=W[J]<j?(N=0,W[J]):W[J]>j?(N=le[ke+W[J]],ce[fe+W[J]]):(N=96,0),I=1<<Z-K,re=U=1<<Y;q[R+(se>>K)+(U-=I)]=A<<24|N<<16|V|0,U!==0;);for(I=1<<Z-1;se&I;)I>>=1;if(I!==0?(se&=I-1,se+=I):se=0,J++,--ve[Z]==0){if(Z===X)break;Z=O[H+W[J]]}if(ne<Z&&(se&_)!==k){for(K===0&&(K=ne),R+=re,ee=1<<(Y=Z-K);Y+K<X&&!((ee-=ve[Y+K])<=0);)Y++,ee<<=1;if(ue+=1<<Y,L===1&&852<ue||L===2&&592<ue)return 1;q[k=se&_]=ne<<24|Y<<16|R-D|0}}return se!==0&&(q[R+se]=Z-K<<24|64<<16|0),P.bits=ne,0}},{"../utils/common":41}],51:[function(p,v,g){v.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(p,v,g){var m=p("../utils/common");function b(le){for(var ke=le.length;0<=--ke;)le[ke]=0}var y=256,S=286,C=30,L=15,O=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],H=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],D=new Array(576);b(D);var W=new Array(60);b(W);var P=new Array(512);b(P);var I=new Array(256);b(I);var U=new Array(29);b(U);var k,_,R,j=new Array(C);function A(le,ke,Te,pe,ye){this.static_tree=le,this.extra_bits=ke,this.extra_base=Te,this.elems=pe,this.max_length=ye,this.has_stree=le&&le.length}function N(le,ke){this.dyn_tree=le,this.max_code=0,this.stat_desc=ke}function V(le){return le<256?P[le]:P[256+(le>>>7)]}function M(le,ke){le.pending_buf[le.pending++]=255&ke,le.pending_buf[le.pending++]=ke>>>8&255}function Z(le,ke,Te){le.bi_valid>16-Te?(le.bi_buf|=ke<<le.bi_valid&65535,M(le,le.bi_buf),le.bi_buf=ke>>16-le.bi_valid,le.bi_valid+=Te-16):(le.bi_buf|=ke<<le.bi_valid&65535,le.bi_valid+=Te)}function J(le,ke,Te){Z(le,Te[2*ke],Te[2*ke+1])}function re(le,ke){for(var Te=0;Te|=1&le,le>>>=1,Te<<=1,0<--ke;);return Te>>>1}function X(le,ke,Te){var pe,ye,ge=new Array(16),De=0;for(pe=1;pe<=L;pe++)ge[pe]=De=De+Te[pe-1]<<1;for(ye=0;ye<=ke;ye++){var He=le[2*ye+1];He!==0&&(le[2*ye]=re(ge[He]++,He))}}function ne(le){var ke;for(ke=0;ke<S;ke++)le.dyn_ltree[2*ke]=0;for(ke=0;ke<C;ke++)le.dyn_dtree[2*ke]=0;for(ke=0;ke<19;ke++)le.bl_tree[2*ke]=0;le.dyn_ltree[512]=1,le.opt_len=le.static_len=0,le.last_lit=le.matches=0}function Y(le){8<le.bi_valid?M(le,le.bi_buf):0<le.bi_valid&&(le.pending_buf[le.pending++]=le.bi_buf),le.bi_buf=0,le.bi_valid=0}function K(le,ke,Te,pe){var ye=2*ke,ge=2*Te;return le[ye]<le[ge]||le[ye]===le[ge]&&pe[ke]<=pe[Te]}function ee(le,ke,Te){for(var pe=le.heap[Te],ye=Te<<1;ye<=le.heap_len&&(ye<le.heap_len&&K(ke,le.heap[ye+1],le.heap[ye],le.depth)&&ye++,!K(ke,pe,le.heap[ye],le.depth));)le.heap[Te]=le.heap[ye],Te=ye,ye<<=1;le.heap[Te]=pe}function ue(le,ke,Te){var pe,ye,ge,De,He=0;if(le.last_lit!==0)for(;pe=le.pending_buf[le.d_buf+2*He]<<8|le.pending_buf[le.d_buf+2*He+1],ye=le.pending_buf[le.l_buf+He],He++,pe===0?J(le,ye,ke):(J(le,(ge=I[ye])+y+1,ke),(De=O[ge])!==0&&Z(le,ye-=U[ge],De),J(le,ge=V(--pe),Te),(De=H[ge])!==0&&Z(le,pe-=j[ge],De)),He<le.last_lit;);J(le,256,ke)}function se(le,ke){var Te,pe,ye,ge=ke.dyn_tree,De=ke.stat_desc.static_tree,He=ke.stat_desc.has_stree,Xe=ke.stat_desc.elems,at=-1;for(le.heap_len=0,le.heap_max=573,Te=0;Te<Xe;Te++)ge[2*Te]!==0?(le.heap[++le.heap_len]=at=Te,le.depth[Te]=0):ge[2*Te+1]=0;for(;le.heap_len<2;)ge[2*(ye=le.heap[++le.heap_len]=at<2?++at:0)]=1,le.depth[ye]=0,le.opt_len--,He&&(le.static_len-=De[2*ye+1]);for(ke.max_code=at,Te=le.heap_len>>1;1<=Te;Te--)ee(le,ge,Te);for(ye=Xe;Te=le.heap[1],le.heap[1]=le.heap[le.heap_len--],ee(le,ge,1),pe=le.heap[1],le.heap[--le.heap_max]=Te,le.heap[--le.heap_max]=pe,ge[2*ye]=ge[2*Te]+ge[2*pe],le.depth[ye]=(le.depth[Te]>=le.depth[pe]?le.depth[Te]:le.depth[pe])+1,ge[2*Te+1]=ge[2*pe+1]=ye,le.heap[1]=ye++,ee(le,ge,1),2<=le.heap_len;);le.heap[--le.heap_max]=le.heap[1],function(dt,wt){var $t,Bt,ft,tr,Me,tt,Ze=wt.dyn_tree,St=wt.max_code,et=wt.stat_desc.static_tree,Ht=wt.stat_desc.has_stree,Nt=wt.stat_desc.extra_bits,kt=wt.stat_desc.extra_base,kr=wt.stat_desc.max_length,Jt=0;for(tr=0;tr<=L;tr++)dt.bl_count[tr]=0;for(Ze[2*dt.heap[dt.heap_max]+1]=0,$t=dt.heap_max+1;$t<573;$t++)kr<(tr=Ze[2*Ze[2*(Bt=dt.heap[$t])+1]+1]+1)&&(tr=kr,Jt++),Ze[2*Bt+1]=tr,St<Bt||(dt.bl_count[tr]++,Me=0,kt<=Bt&&(Me=Nt[Bt-kt]),tt=Ze[2*Bt],dt.opt_len+=tt*(tr+Me),Ht&&(dt.static_len+=tt*(et[2*Bt+1]+Me)));if(Jt!==0){do{for(tr=kr-1;dt.bl_count[tr]===0;)tr--;dt.bl_count[tr]--,dt.bl_count[tr+1]+=2,dt.bl_count[kr]--,Jt-=2}while(0<Jt);for(tr=kr;tr!==0;tr--)for(Bt=dt.bl_count[tr];Bt!==0;)St<(ft=dt.heap[--$t])||(Ze[2*ft+1]!==tr&&(dt.opt_len+=(tr-Ze[2*ft+1])*Ze[2*ft],Ze[2*ft+1]=tr),Bt--)}}(le,ke),X(ge,at,le.bl_count)}function ce(le,ke,Te){var pe,ye,ge=-1,De=ke[1],He=0,Xe=7,at=4;for(De===0&&(Xe=138,at=3),ke[2*(Te+1)+1]=65535,pe=0;pe<=Te;pe++)ye=De,De=ke[2*(pe+1)+1],++He<Xe&&ye===De||(He<at?le.bl_tree[2*ye]+=He:ye!==0?(ye!==ge&&le.bl_tree[2*ye]++,le.bl_tree[32]++):He<=10?le.bl_tree[34]++:le.bl_tree[36]++,ge=ye,at=(He=0)===De?(Xe=138,3):ye===De?(Xe=6,3):(Xe=7,4))}function fe(le,ke,Te){var pe,ye,ge=-1,De=ke[1],He=0,Xe=7,at=4;for(De===0&&(Xe=138,at=3),pe=0;pe<=Te;pe++)if(ye=De,De=ke[2*(pe+1)+1],!(++He<Xe&&ye===De)){if(He<at)for(;J(le,ye,le.bl_tree),--He!=0;);else ye!==0?(ye!==ge&&(J(le,ye,le.bl_tree),He--),J(le,16,le.bl_tree),Z(le,He-3,2)):He<=10?(J(le,17,le.bl_tree),Z(le,He-3,3)):(J(le,18,le.bl_tree),Z(le,He-11,7));ge=ye,at=(He=0)===De?(Xe=138,3):ye===De?(Xe=6,3):(Xe=7,4)}}b(j);var ve=!1;function _e(le,ke,Te,pe){Z(le,0+(pe?1:0),3),function(ye,ge,De,He){Y(ye),M(ye,De),M(ye,~De),m.arraySet(ye.pending_buf,ye.window,ge,De,ye.pending),ye.pending+=De}(le,ke,Te)}g._tr_init=function(le){ve||(function(){var ke,Te,pe,ye,ge,De=new Array(16);for(ye=pe=0;ye<28;ye++)for(U[ye]=pe,ke=0;ke<1<<O[ye];ke++)I[pe++]=ye;for(I[pe-1]=ye,ye=ge=0;ye<16;ye++)for(j[ye]=ge,ke=0;ke<1<<H[ye];ke++)P[ge++]=ye;for(ge>>=7;ye<C;ye++)for(j[ye]=ge<<7,ke=0;ke<1<<H[ye]-7;ke++)P[256+ge++]=ye;for(Te=0;Te<=L;Te++)De[Te]=0;for(ke=0;ke<=143;)D[2*ke+1]=8,ke++,De[8]++;for(;ke<=255;)D[2*ke+1]=9,ke++,De[9]++;for(;ke<=279;)D[2*ke+1]=7,ke++,De[7]++;for(;ke<=287;)D[2*ke+1]=8,ke++,De[8]++;for(X(D,287,De),ke=0;ke<C;ke++)W[2*ke+1]=5,W[2*ke]=re(ke,5);k=new A(D,O,257,S,L),_=new A(W,H,0,C,L),R=new A(new Array(0),z,0,19,7)}(),ve=!0),le.l_desc=new N(le.dyn_ltree,k),le.d_desc=new N(le.dyn_dtree,_),le.bl_desc=new N(le.bl_tree,R),le.bi_buf=0,le.bi_valid=0,ne(le)},g._tr_stored_block=_e,g._tr_flush_block=function(le,ke,Te,pe){var ye,ge,De=0;0<le.level?(le.strm.data_type===2&&(le.strm.data_type=function(He){var Xe,at=4093624447;for(Xe=0;Xe<=31;Xe++,at>>>=1)if(1&at&&He.dyn_ltree[2*Xe]!==0)return 0;if(He.dyn_ltree[18]!==0||He.dyn_ltree[20]!==0||He.dyn_ltree[26]!==0)return 1;for(Xe=32;Xe<y;Xe++)if(He.dyn_ltree[2*Xe]!==0)return 1;return 0}(le)),se(le,le.l_desc),se(le,le.d_desc),De=function(He){var Xe;for(ce(He,He.dyn_ltree,He.l_desc.max_code),ce(He,He.dyn_dtree,He.d_desc.max_code),se(He,He.bl_desc),Xe=18;3<=Xe&&He.bl_tree[2*q[Xe]+1]===0;Xe--);return He.opt_len+=3*(Xe+1)+5+5+4,Xe}(le),ye=le.opt_len+3+7>>>3,(ge=le.static_len+3+7>>>3)<=ye&&(ye=ge)):ye=ge=Te+5,Te+4<=ye&&ke!==-1?_e(le,ke,Te,pe):le.strategy===4||ge===ye?(Z(le,2+(pe?1:0),3),ue(le,D,W)):(Z(le,4+(pe?1:0),3),function(He,Xe,at,dt){var wt;for(Z(He,Xe-257,5),Z(He,at-1,5),Z(He,dt-4,4),wt=0;wt<dt;wt++)Z(He,He.bl_tree[2*q[wt]+1],3);fe(He,He.dyn_ltree,Xe-1),fe(He,He.dyn_dtree,at-1)}(le,le.l_desc.max_code+1,le.d_desc.max_code+1,De+1),ue(le,le.dyn_ltree,le.dyn_dtree)),ne(le),pe&&Y(le)},g._tr_tally=function(le,ke,Te){return le.pending_buf[le.d_buf+2*le.last_lit]=ke>>>8&255,le.pending_buf[le.d_buf+2*le.last_lit+1]=255&ke,le.pending_buf[le.l_buf+le.last_lit]=255&Te,le.last_lit++,ke===0?le.dyn_ltree[2*Te]++:(le.matches++,ke--,le.dyn_ltree[2*(I[Te]+y+1)]++,le.dyn_dtree[2*V(ke)]++),le.last_lit===le.lit_bufsize-1},g._tr_align=function(le){Z(le,2,3),J(le,256,D),function(ke){ke.bi_valid===16?(M(ke,ke.bi_buf),ke.bi_buf=0,ke.bi_valid=0):8<=ke.bi_valid&&(ke.pending_buf[ke.pending++]=255&ke.bi_buf,ke.bi_buf>>=8,ke.bi_valid-=8)}(le)}},{"../utils/common":41}],53:[function(p,v,g){v.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(p,v,g){(function(m){(function(b,y){if(!b.setImmediate){var S,C,L,O,H=1,z={},q=!1,D=b.document,W=Object.getPrototypeOf&&Object.getPrototypeOf(b);W=W&&W.setTimeout?W:b,S={}.toString.call(b.process)==="[object process]"?function(k){o.nextTick(function(){I(k)})}:function(){if(b.postMessage&&!b.importScripts){var k=!0,_=b.onmessage;return b.onmessage=function(){k=!1},b.postMessage("","*"),b.onmessage=_,k}}()?(O="setImmediate$"+Math.random()+"$",b.addEventListener?b.addEventListener("message",U,!1):b.attachEvent("onmessage",U),function(k){b.postMessage(O+k,"*")}):b.MessageChannel?((L=new MessageChannel).port1.onmessage=function(k){I(k.data)},function(k){L.port2.postMessage(k)}):D&&"onreadystatechange"in D.createElement("script")?(C=D.documentElement,function(k){var _=D.createElement("script");_.onreadystatechange=function(){I(k),_.onreadystatechange=null,C.removeChild(_),_=null},C.appendChild(_)}):function(k){setTimeout(I,0,k)},W.setImmediate=function(k){typeof k!="function"&&(k=new Function(""+k));for(var _=new Array(arguments.length-1),R=0;R<_.length;R++)_[R]=arguments[R+1];var j={callback:k,args:_};return z[H]=j,S(H),H++},W.clearImmediate=P}function P(k){delete z[k]}function I(k){if(q)setTimeout(I,0,k);else{var _=z[k];if(_){q=!0;try{(function(R){var j=R.callback,A=R.args;switch(A.length){case 0:j();break;case 1:j(A[0]);break;case 2:j(A[0],A[1]);break;case 3:j(A[0],A[1],A[2]);break;default:j.apply(void 0,A)}})(_)}finally{P(k),q=!1}}}}function U(k){k.source===b&&typeof k.data=="string"&&k.data.indexOf(O)===0&&I(+k.data.slice(O.length))}})(typeof self>"u"?m===void 0?this:m:self)}).call(this,i!==void 0?i:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}).call(this)}).call(this,t("_process"),typeof Kn<"u"?Kn:typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],t("timers").setImmediate)},{_process:467,buffer:220,timers:523}],442:[function(t,n,s){(function(o){(function(){var i=/[\\^$.*+?()[\]{}|]/g,c=RegExp(i.source),u=typeof o=="object"&&o&&o.Object===Object&&o,l=typeof self=="object"&&self&&self.Object===Object&&self,d=u||l||Function("return this")(),h=Object.prototype.toString,f=d.Symbol,p=f?f.prototype:void 0,v=p?p.toString:void 0;function g(m){if(typeof m=="string")return m;if(function(y){return typeof y=="symbol"||function(S){return!!S&&typeof S=="object"}(y)&&h.call(y)=="[object Symbol]"}(m))return v?v.call(m):"";var b=m+"";return b=="0"&&1/m==-1/0?"-0":b}n.exports=function(m){var b;return(m=(b=m)==null?"":g(b))&&c.test(m)?m.replace(i,"\\$&"):m}}).call(this)}).call(this,typeof Kn<"u"?Kn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],443:[function(t,n,s){(function(o){(function(){var i="[object Arguments]",c="[object Map]",u="[object Object]",l="[object Set]",d=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,h=/^\w*$/,f=/^\./,p=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,v=/\\(\\)?/g,g=/^\[object .+?Constructor\]$/,m=/^(?:0|[1-9]\d*)$/,b={};b["[object Float32Array]"]=b["[object Float64Array]"]=b["[object Int8Array]"]=b["[object Int16Array]"]=b["[object Int32Array]"]=b["[object Uint8Array]"]=b["[object Uint8ClampedArray]"]=b["[object Uint16Array]"]=b["[object Uint32Array]"]=!0,b[i]=b["[object Array]"]=b["[object ArrayBuffer]"]=b["[object Boolean]"]=b["[object DataView]"]=b["[object Date]"]=b["[object Error]"]=b["[object Function]"]=b[c]=b["[object Number]"]=b[u]=b["[object RegExp]"]=b[l]=b["[object String]"]=b["[object WeakMap]"]=!1;var y=typeof o=="object"&&o&&o.Object===Object&&o,S=typeof self=="object"&&self&&self.Object===Object&&self,C=y||S||Function("return this")(),L=typeof s=="object"&&s&&!s.nodeType&&s,O=L&&typeof n=="object"&&n&&!n.nodeType&&n,H=O&&O.exports===L&&y.process,z=function(){try{return H&&H.binding("util")}catch{}}(),q=z&&z.isTypedArray;function D(me,Be,Ge,mt){for(var _t=-1,ot=me?me.length:0;++_t<ot;){var xt=me[_t];Be(mt,xt,Ge(xt),me)}return mt}function W(me,Be){for(var Ge=-1,mt=me?me.length:0;++Ge<mt;)if(Be(me[Ge],Ge,me))return!0;return!1}function P(me){var Be=!1;if(me!=null&&typeof me.toString!="function")try{Be=!!(me+"")}catch{}return Be}function I(me){var Be=-1,Ge=Array(me.size);return me.forEach(function(mt,_t){Ge[++Be]=[_t,mt]}),Ge}function U(me){var Be=-1,Ge=Array(me.size);return me.forEach(function(mt){Ge[++Be]=mt}),Ge}var k,_,R,j=Array.prototype,A=Function.prototype,N=Object.prototype,V=C["__core-js_shared__"],M=(k=/[^.]+$/.exec(V&&V.keys&&V.keys.IE_PROTO||""))?"Symbol(src)_1."+k:"",Z=A.toString,J=N.hasOwnProperty,re=N.toString,X=RegExp("^"+Z.call(J).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ne=C.Symbol,Y=C.Uint8Array,K=N.propertyIsEnumerable,ee=j.splice,ue=(_=Object.keys,R=Object,function(me){return _(R(me))}),se=vt(C,"DataView"),ce=vt(C,"Map"),fe=vt(C,"Promise"),ve=vt(C,"Set"),_e=vt(C,"WeakMap"),le=vt(Object,"create"),ke=Qe(se),Te=Qe(ce),pe=Qe(fe),ye=Qe(ve),ge=Qe(_e),De=ne?ne.prototype:void 0,He=De?De.valueOf:void 0,Xe=De?De.toString:void 0;function at(me){var Be=-1,Ge=me?me.length:0;for(this.clear();++Be<Ge;){var mt=me[Be];this.set(mt[0],mt[1])}}function dt(me){var Be=-1,Ge=me?me.length:0;for(this.clear();++Be<Ge;){var mt=me[Be];this.set(mt[0],mt[1])}}function wt(me){var Be=-1,Ge=me?me.length:0;for(this.clear();++Be<Ge;){var mt=me[Be];this.set(mt[0],mt[1])}}function $t(me){var Be=-1,Ge=me?me.length:0;for(this.__data__=new wt;++Be<Ge;)this.add(me[Be])}function Bt(me){this.__data__=new dt(me)}function ft(me,Be){var Ge=be(me)||de(me)?function(xt,zt){for(var Vt=-1,Ar=Array(xt);++Vt<xt;)Ar[Vt]=zt(Vt);return Ar}(me.length,String):[],mt=Ge.length,_t=!!mt;for(var ot in me)!J.call(me,ot)||_t&&(ot=="length"||Cr(ot,mt))||Ge.push(ot);return Ge}function tr(me,Be){for(var Ge=me.length;Ge--;)if(Ce(me[Ge][0],Be))return Ge;return-1}function Me(me,Be,Ge,mt){return Ze(me,function(_t,ot,xt){Be(mt,_t,Ge(_t),xt)}),mt}at.prototype.clear=function(){this.__data__=le?le(null):{}},at.prototype.delete=function(me){return this.has(me)&&delete this.__data__[me]},at.prototype.get=function(me){var Be=this.__data__;if(le){var Ge=Be[me];return Ge==="__lodash_hash_undefined__"?void 0:Ge}return J.call(Be,me)?Be[me]:void 0},at.prototype.has=function(me){var Be=this.__data__;return le?Be[me]!==void 0:J.call(Be,me)},at.prototype.set=function(me,Be){return this.__data__[me]=le&&Be===void 0?"__lodash_hash_undefined__":Be,this},dt.prototype.clear=function(){this.__data__=[]},dt.prototype.delete=function(me){var Be=this.__data__,Ge=tr(Be,me);return!(Ge<0)&&(Ge==Be.length-1?Be.pop():ee.call(Be,Ge,1),!0)},dt.prototype.get=function(me){var Be=this.__data__,Ge=tr(Be,me);return Ge<0?void 0:Be[Ge][1]},dt.prototype.has=function(me){return tr(this.__data__,me)>-1},dt.prototype.set=function(me,Be){var Ge=this.__data__,mt=tr(Ge,me);return mt<0?Ge.push([me,Be]):Ge[mt][1]=Be,this},wt.prototype.clear=function(){this.__data__={hash:new at,map:new(ce||dt),string:new at}},wt.prototype.delete=function(me){return Lr(this,me).delete(me)},wt.prototype.get=function(me){return Lr(this,me).get(me)},wt.prototype.has=function(me){return Lr(this,me).has(me)},wt.prototype.set=function(me,Be){return Lr(this,me).set(me,Be),this},$t.prototype.add=$t.prototype.push=function(me){return this.__data__.set(me,"__lodash_hash_undefined__"),this},$t.prototype.has=function(me){return this.__data__.has(me)},Bt.prototype.clear=function(){this.__data__=new dt},Bt.prototype.delete=function(me){return this.__data__.delete(me)},Bt.prototype.get=function(me){return this.__data__.get(me)},Bt.prototype.has=function(me){return this.__data__.has(me)},Bt.prototype.set=function(me,Be){var Ge=this.__data__;if(Ge instanceof dt){var mt=Ge.__data__;if(!ce||mt.length<199)return mt.push([me,Be]),this;Ge=this.__data__=new wt(mt)}return Ge.set(me,Be),this};var tt,Ze=(tt=function(me,Be){return me&&St(me,Be,Fe)},function(me,Be){if(me==null)return me;if(!Se(me))return tt(me,Be);for(var Ge=me.length,mt=-1,_t=Object(me);++mt<Ge&&Be(_t[mt],mt,_t)!==!1;);return me}),St=function(me){return function(Be,Ge,mt){for(var _t=-1,ot=Object(Be),xt=mt(Be),zt=xt.length;zt--;){var Vt=xt[++_t];if(Ge(ot[Vt],Vt,ot)===!1)break}return Be}}();function et(me,Be){for(var Ge=0,mt=(Be=Dt(Be,me)?[Be]:Pt(Be)).length;me!=null&&Ge<mt;)me=me[Pe(Be[Ge++])];return Ge&&Ge==mt?me:void 0}function Ht(me,Be){return me!=null&&Be in Object(me)}function Nt(me,Be,Ge,mt,_t){return me===Be||(me==null||Be==null||!Re(me)&&!Ie(Be)?me!=me&&Be!=Be:function(ot,xt,zt,Vt,Ar,wr){var Nr=be(ot),Dr=be(xt),Yr="[object Array]",Vr="[object Array]";Nr||(Yr=(Yr=nr(ot))==i?u:Yr),Dr||(Vr=(Vr=nr(xt))==i?u:Vr);var on=Yr==u&&!P(ot),xn=Vr==u&&!P(xt),ia=Yr==Vr;if(ia&&!on)return wr||(wr=new Bt),Nr||we(ot)?Ur(ot,xt,zt,Vt,Ar,wr):function(pr,Ir,$n,Fr,jr,Le,rt){switch($n){case"[object DataView]":if(pr.byteLength!=Ir.byteLength||pr.byteOffset!=Ir.byteOffset)return!1;pr=pr.buffer,Ir=Ir.buffer;case"[object ArrayBuffer]":return!(pr.byteLength!=Ir.byteLength||!Fr(new Y(pr),new Y(Ir)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Ce(+pr,+Ir);case"[object Error]":return pr.name==Ir.name&&pr.message==Ir.message;case"[object RegExp]":case"[object String]":return pr==Ir+"";case c:var Ke=I;case l:var pt=2&Le;if(Ke||(Ke=U),pr.size!=Ir.size&&!pt)return!1;var rr=rt.get(pr);if(rr)return rr==Ir;Le|=1,rt.set(pr,Ir);var ur=Ur(Ke(pr),Ke(Ir),Fr,jr,Le,rt);return rt.delete(pr),ur;case"[object Symbol]":if(He)return He.call(pr)==He.call(Ir)}return!1}(ot,xt,Yr,zt,Vt,Ar,wr);if(!(2&Ar)){var yn=on&&J.call(ot,"__wrapped__"),oa=xn&&J.call(xt,"__wrapped__");if(yn||oa){var Qn=yn?ot.value():ot,za=oa?xt.value():xt;return wr||(wr=new Bt),zt(Qn,za,Vt,Ar,wr)}}return ia?(wr||(wr=new Bt),function(pr,Ir,$n,Fr,jr,Le){var rt=2&jr,Ke=Fe(pr),pt=Ke.length,rr=Fe(Ir).length;if(pt!=rr&&!rt)return!1;for(var ur=pt;ur--;){var Rr=Ke[ur];if(!(rt?Rr in Ir:J.call(Ir,Rr)))return!1}var Kr=Le.get(pr);if(Kr&&Le.get(Ir))return Kr==Ir;var sr=!0;Le.set(pr,Ir),Le.set(Ir,pr);for(var jn=rt;++ur<pt;){Rr=Ke[ur];var Kt=pr[Rr],qt=Ir[Rr];if(Fr)var Gr=rt?Fr(qt,Kt,Rr,Ir,pr,Le):Fr(Kt,qt,Rr,pr,Ir,Le);if(!(Gr===void 0?Kt===qt||$n(Kt,qt,Fr,jr,Le):Gr)){sr=!1;break}jn||(jn=Rr=="constructor")}if(sr&&!jn){var fn=pr.constructor,rn=Ir.constructor;fn==rn||!("constructor"in pr)||!("constructor"in Ir)||typeof fn=="function"&&fn instanceof fn&&typeof rn=="function"&&rn instanceof rn||(sr=!1)}return Le.delete(pr),Le.delete(Ir),sr}(ot,xt,zt,Vt,Ar,wr)):!1}(me,Be,Nt,Ge,mt,_t))}function kt(me){return!(!Re(me)||function(Be){return!!M&&M in Be}(me))&&(Ne(me)||P(me)?X:g).test(Qe(me))}function kr(me){return typeof me=="function"?me:me==null?Ye:typeof me=="object"?be(me)?function(mt,_t){return Dt(mt)&&je(_t)?ct(Pe(mt),_t):function(ot){var xt=function(zt,Vt,Ar){var wr=zt==null?void 0:et(zt,Vt);return wr===void 0?Ar:wr}(ot,mt);return xt===void 0&&xt===_t?function(zt,Vt){return zt!=null&&function(Ar,wr,Nr){wr=Dt(wr,Ar)?[wr]:Pt(wr);for(var Dr,Yr=-1,Vr=wr.length;++Yr<Vr;){var on=Pe(wr[Yr]);if(!(Dr=Ar!=null&&Nr(Ar,on)))break;Ar=Ar[on]}return Dr||!!(Vr=Ar?Ar.length:0)&&ze(Vr)&&Cr(on,Vr)&&(be(Ar)||de(Ar))}(zt,Vt,Ht)}(ot,mt):Nt(_t,xt,void 0,3)}}(me[0],me[1]):function(mt){var _t=function(ot){for(var xt=Fe(ot),zt=xt.length;zt--;){var Vt=xt[zt],Ar=ot[Vt];xt[zt]=[Vt,Ar,je(Ar)]}return xt}(mt);return _t.length==1&&_t[0][2]?ct(_t[0][0],_t[0][1]):function(ot){return ot===mt||function(xt,zt,Vt,Ar){var wr=Vt.length,Nr=wr;if(xt==null)return!Nr;for(xt=Object(xt);wr--;){var Dr=Vt[wr];if(Dr[2]?Dr[1]!==xt[Dr[0]]:!(Dr[0]in xt))return!1}for(;++wr<Nr;){var Yr=(Dr=Vt[wr])[0],Vr=xt[Yr],on=Dr[1];if(Dr[2]){if(Vr===void 0&&!(Yr in xt))return!1}else{var xn=new Bt,ia;if(!(ia===void 0?Nt(on,Vr,Ar,3,xn):ia))return!1}}return!0}(ot,mt,_t)}}(me):Dt(Be=me)?(Ge=Pe(Be),function(mt){return mt==null?void 0:mt[Ge]}):function(mt){return function(_t){return et(_t,mt)}}(Be);var Be,Ge}function Jt(me){if(Ge=(Be=me)&&Be.constructor,mt=typeof Ge=="function"&&Ge.prototype||N,Be!==mt)return ue(me);var Be,Ge,mt,_t=[];for(var ot in Object(me))J.call(me,ot)&&ot!="constructor"&&_t.push(ot);return _t}function Pt(me){return be(me)?me:nt(me)}function Ur(me,Be,Ge,mt,_t,ot){var xt=2&_t,zt=me.length,Vt=Be.length;if(zt!=Vt&&!(xt&&Vt>zt))return!1;var Ar=ot.get(me);if(Ar&&ot.get(Be))return Ar==Be;var wr=-1,Nr=!0,Dr=1&_t?new $t:void 0;for(ot.set(me,Be),ot.set(Be,me);++wr<zt;){var Yr=me[wr],Vr=Be[wr];if(mt)var on=xt?mt(Vr,Yr,wr,Be,me,ot):mt(Yr,Vr,wr,me,Be,ot);if(on!==void 0){if(on)continue;Nr=!1;break}if(Dr){if(!W(Be,function(xn,ia){if(!Dr.has(ia)&&(Yr===xn||Ge(Yr,xn,mt,_t,ot)))return Dr.add(ia)})){Nr=!1;break}}else if(Yr!==Vr&&!Ge(Yr,Vr,mt,_t,ot)){Nr=!1;break}}return ot.delete(me),ot.delete(Be),Nr}function Lr(me,Be){var Ge,mt,_t=me.__data__;return((mt=typeof(Ge=Be))=="string"||mt=="number"||mt=="symbol"||mt=="boolean"?Ge!=="__proto__":Ge===null)?_t[typeof Be=="string"?"string":"hash"]:_t.map}function vt(me,Be){var Ge=function(mt,_t){return mt==null?void 0:mt[_t]}(me,Be);return kt(Ge)?Ge:void 0}var nr=function(me){return re.call(me)};function Cr(me,Be){return!!(Be=Be??9007199254740991)&&(typeof me=="number"||m.test(me))&&me>-1&&me%1==0&&me<Be}function Dt(me,Be){if(be(me))return!1;var Ge=typeof me;return!(Ge!="number"&&Ge!="symbol"&&Ge!="boolean"&&me!=null&&!ae(me))||h.test(me)||!d.test(me)||Be!=null&&me in Object(Be)}function je(me){return me==me&&!Re(me)}function ct(me,Be){return function(Ge){return Ge!=null&&Ge[me]===Be&&(Be!==void 0||me in Object(Ge))}}(se&&nr(new se(new ArrayBuffer(1)))!="[object DataView]"||ce&&nr(new ce)!=c||fe&&nr(fe.resolve())!="[object Promise]"||ve&&nr(new ve)!=l||_e&&nr(new _e)!="[object WeakMap]")&&(nr=function(me){var Be=re.call(me),Ge=Be==u?me.constructor:void 0,mt=Ge?Qe(Ge):void 0;if(mt)switch(mt){case ke:return"[object DataView]";case Te:return c;case pe:return"[object Promise]";case ye:return l;case ge:return"[object WeakMap]"}return Be});var nt=Oe(function(me){var Be;me=(Be=me)==null?"":function(mt){if(typeof mt=="string")return mt;if(ae(mt))return Xe?Xe.call(mt):"";var _t=mt+"";return _t=="0"&&1/mt==-1/0?"-0":_t}(Be);var Ge=[];return f.test(me)&&Ge.push(""),me.replace(p,function(mt,_t,ot,xt){Ge.push(ot?xt.replace(v,"$1"):_t||mt)}),Ge});function Pe(me){if(typeof me=="string"||ae(me))return me;var Be=me+"";return Be=="0"&&1/me==-1/0?"-0":Be}function Qe(me){if(me!=null){try{return Z.call(me)}catch{}try{return me+""}catch{}}return""}var gt,xe=(gt=function(me,Be,Ge){J.call(me,Ge)?me[Ge].push(Be):me[Ge]=[Be]},function(me,Be){var Ge=be(me)?D:Me,mt={};return Ge(me,gt,kr(Be),mt)});function Oe(me,Be){if(typeof me!="function"||Be&&typeof Be!="function")throw new TypeError("Expected a function");var Ge=function(){var mt=arguments,_t=Be?Be.apply(this,mt):mt[0],ot=Ge.cache;if(ot.has(_t))return ot.get(_t);var xt=me.apply(this,mt);return Ge.cache=ot.set(_t,xt),xt};return Ge.cache=new(Oe.Cache||wt),Ge}function Ce(me,Be){return me===Be||me!=me&&Be!=Be}function de(me){return function(Be){return Ie(Be)&&Se(Be)}(me)&&J.call(me,"callee")&&(!K.call(me,"callee")||re.call(me)==i)}Oe.Cache=wt;var be=Array.isArray;function Se(me){return me!=null&&ze(me.length)&&!Ne(me)}function Ne(me){var Be=Re(me)?re.call(me):"";return Be=="[object Function]"||Be=="[object GeneratorFunction]"}function ze(me){return typeof me=="number"&&me>-1&&me%1==0&&me<=9007199254740991}function Re(me){var Be=typeof me;return!!me&&(Be=="object"||Be=="function")}function Ie(me){return!!me&&typeof me=="object"}function ae(me){return typeof me=="symbol"||Ie(me)&&re.call(me)=="[object Symbol]"}var we=q?function(me){return function(Be){return me(Be)}}(q):function(me){return Ie(me)&&ze(me.length)&&!!b[re.call(me)]};function Fe(me){return Se(me)?ft(me):Jt(me)}function Ye(me){return me}n.exports=xe}).call(this)}).call(this,typeof Kn<"u"?Kn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],444:[function(t,n,s){var o=Object.prototype.toString;n.exports=function(i){return i===!0||i===!1||function(c){return!!c&&typeof c=="object"}(i)&&o.call(i)=="[object Boolean]"}},{}],445:[function(t,n,s){(function(o){(function(){var i="[object Arguments]",c="[object Map]",u="[object Object]",l="[object Set]",d=/^\[object .+?Constructor\]$/,h=/^(?:0|[1-9]\d*)$/,f={};f["[object Float32Array]"]=f["[object Float64Array]"]=f["[object Int8Array]"]=f["[object Int16Array]"]=f["[object Int32Array]"]=f["[object Uint8Array]"]=f["[object Uint8ClampedArray]"]=f["[object Uint16Array]"]=f["[object Uint32Array]"]=!0,f[i]=f["[object Array]"]=f["[object ArrayBuffer]"]=f["[object Boolean]"]=f["[object DataView]"]=f["[object Date]"]=f["[object Error]"]=f["[object Function]"]=f[c]=f["[object Number]"]=f[u]=f["[object RegExp]"]=f[l]=f["[object String]"]=f["[object WeakMap]"]=!1;var p=typeof o=="object"&&o&&o.Object===Object&&o,v=typeof self=="object"&&self&&self.Object===Object&&self,g=p||v||Function("return this")(),m=typeof s=="object"&&s&&!s.nodeType&&s,b=m&&typeof n=="object"&&n&&!n.nodeType&&n,y=b&&b.exports===m,S=y&&p.process,C=function(){try{return S&&S.binding&&S.binding("util")}catch{}}(),L=C&&C.isTypedArray;function O(Pe,Qe){for(var gt=-1,xe=Pe==null?0:Pe.length;++gt<xe;)if(Qe(Pe[gt],gt,Pe))return!0;return!1}function H(Pe){var Qe=-1,gt=Array(Pe.size);return Pe.forEach(function(xe,Oe){gt[++Qe]=[Oe,xe]}),gt}function z(Pe){var Qe=-1,gt=Array(Pe.size);return Pe.forEach(function(xe){gt[++Qe]=xe}),gt}var q,D,W,P=Array.prototype,I=Function.prototype,U=Object.prototype,k=g["__core-js_shared__"],_=I.toString,R=U.hasOwnProperty,j=(q=/[^.]+$/.exec(k&&k.keys&&k.keys.IE_PROTO||""))?"Symbol(src)_1."+q:"",A=U.toString,N=RegExp("^"+_.call(R).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),V=y?g.Buffer:void 0,M=g.Symbol,Z=g.Uint8Array,J=U.propertyIsEnumerable,re=P.splice,X=M?M.toStringTag:void 0,ne=Object.getOwnPropertySymbols,Y=V?V.isBuffer:void 0,K=(D=Object.keys,W=Object,function(Pe){return D(W(Pe))}),ee=Ht(g,"DataView"),ue=Ht(g,"Map"),se=Ht(g,"Promise"),ce=Ht(g,"Set"),fe=Ht(g,"WeakMap"),ve=Ht(Object,"create"),_e=Jt(ee),le=Jt(ue),ke=Jt(se),Te=Jt(ce),pe=Jt(fe),ye=M?M.prototype:void 0,ge=ye?ye.valueOf:void 0;function De(Pe){var Qe=-1,gt=Pe==null?0:Pe.length;for(this.clear();++Qe<gt;){var xe=Pe[Qe];this.set(xe[0],xe[1])}}function He(Pe){var Qe=-1,gt=Pe==null?0:Pe.length;for(this.clear();++Qe<gt;){var xe=Pe[Qe];this.set(xe[0],xe[1])}}function Xe(Pe){var Qe=-1,gt=Pe==null?0:Pe.length;for(this.clear();++Qe<gt;){var xe=Pe[Qe];this.set(xe[0],xe[1])}}function at(Pe){var Qe=-1,gt=Pe==null?0:Pe.length;for(this.__data__=new Xe;++Qe<gt;)this.add(Pe[Qe])}function dt(Pe){var Qe=this.__data__=new He(Pe);this.size=Qe.size}function wt(Pe,Qe){var gt=Lr(Pe),xe=!gt&&Ur(Pe),Oe=!gt&&!xe&&vt(Pe),Ce=!gt&&!xe&&!Oe&&ct(Pe),de=gt||xe||Oe||Ce,be=de?function(ze,Re){for(var Ie=-1,ae=Array(ze);++Ie<ze;)ae[Ie]=Re(Ie);return ae}(Pe.length,String):[],Se=be.length;for(var Ne in Pe)!R.call(Pe,Ne)||de&&(Ne=="length"||Oe&&(Ne=="offset"||Ne=="parent")||Ce&&(Ne=="buffer"||Ne=="byteLength"||Ne=="byteOffset")||kr(Ne,Se))||be.push(Ne);return be}function $t(Pe,Qe){for(var gt=Pe.length;gt--;)if(Pt(Pe[gt][0],Qe))return gt;return-1}function Bt(Pe){return Pe==null?Pe===void 0?"[object Undefined]":"[object Null]":X&&X in Object(Pe)?function(Qe){var gt=R.call(Qe,X),xe=Qe[X];try{Qe[X]=void 0;var Oe=!0}catch{}var Ce=A.call(Qe);return Oe&&(gt?Qe[X]=xe:delete Qe[X]),Ce}(Pe):function(Qe){return A.call(Qe)}(Pe)}function ft(Pe){return je(Pe)&&Bt(Pe)==i}function tr(Pe,Qe,gt,xe,Oe){return Pe===Qe||(Pe==null||Qe==null||!je(Pe)&&!je(Qe)?Pe!=Pe&&Qe!=Qe:function(Ce,de,be,Se,Ne,ze){var Re=Lr(Ce),Ie=Lr(de),ae=Re?"[object Array]":kt(Ce),we=Ie?"[object Array]":kt(de),Fe=(ae=ae==i?u:ae)==u,Ye=(we=we==i?u:we)==u,me=ae==we;if(me&&vt(Ce)){if(!vt(de))return!1;Re=!0,Fe=!1}if(me&&!Fe)return ze||(ze=new dt),Re||ct(Ce)?Ze(Ce,de,be,Se,Ne,ze):function(ot,xt,zt,Vt,Ar,wr,Nr){switch(zt){case"[object DataView]":if(ot.byteLength!=xt.byteLength||ot.byteOffset!=xt.byteOffset)return!1;ot=ot.buffer,xt=xt.buffer;case"[object ArrayBuffer]":return!(ot.byteLength!=xt.byteLength||!wr(new Z(ot),new Z(xt)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Pt(+ot,+xt);case"[object Error]":return ot.name==xt.name&&ot.message==xt.message;case"[object RegExp]":case"[object String]":return ot==xt+"";case c:var Dr=H;case l:var Yr=1&Vt;if(Dr||(Dr=z),ot.size!=xt.size&&!Yr)return!1;var Vr=Nr.get(ot);if(Vr)return Vr==xt;Vt|=2,Nr.set(ot,xt);var on=Ze(Dr(ot),Dr(xt),Vt,Ar,wr,Nr);return Nr.delete(ot),on;case"[object Symbol]":if(ge)return ge.call(ot)==ge.call(xt)}return!1}(Ce,de,ae,be,Se,Ne,ze);if(!(1&be)){var Be=Fe&&R.call(Ce,"__wrapped__"),Ge=Ye&&R.call(de,"__wrapped__");if(Be||Ge){var mt=Be?Ce.value():Ce,_t=Ge?de.value():de;return ze||(ze=new dt),Ne(mt,_t,be,Se,ze)}}return me?(ze||(ze=new dt),function(ot,xt,zt,Vt,Ar,wr){var Nr=1&zt,Dr=St(ot),Yr=Dr.length,Vr=St(xt).length;if(Yr!=Vr&&!Nr)return!1;for(var on=Yr;on--;){var xn=Dr[on];if(!(Nr?xn in xt:R.call(xt,xn)))return!1}var ia=wr.get(ot);if(ia&&wr.get(xt))return ia==xt;var yn=!0;wr.set(ot,xt),wr.set(xt,ot);for(var oa=Nr;++on<Yr;){xn=Dr[on];var Qn=ot[xn],za=xt[xn];if(Vt)var pr=Nr?Vt(za,Qn,xn,xt,ot,wr):Vt(Qn,za,xn,ot,xt,wr);if(!(pr===void 0?Qn===za||Ar(Qn,za,zt,Vt,wr):pr)){yn=!1;break}oa||(oa=xn=="constructor")}if(yn&&!oa){var Ir=ot.constructor,$n=xt.constructor;Ir==$n||!("constructor"in ot)||!("constructor"in xt)||typeof Ir=="function"&&Ir instanceof Ir&&typeof $n=="function"&&$n instanceof $n||(yn=!1)}return wr.delete(ot),wr.delete(xt),yn}(Ce,de,be,Se,Ne,ze)):!1}(Pe,Qe,gt,xe,tr,Oe))}function Me(Pe){return!(!Dt(Pe)||function(Qe){return!!j&&j in Qe}(Pe))&&(nr(Pe)?N:d).test(Jt(Pe))}function tt(Pe){if(gt=(Qe=Pe)&&Qe.constructor,xe=typeof gt=="function"&&gt.prototype||U,Qe!==xe)return K(Pe);var Qe,gt,xe,Oe=[];for(var Ce in Object(Pe))R.call(Pe,Ce)&&Ce!="constructor"&&Oe.push(Ce);return Oe}function Ze(Pe,Qe,gt,xe,Oe,Ce){var de=1&gt,be=Pe.length,Se=Qe.length;if(be!=Se&&!(de&&Se>be))return!1;var Ne=Ce.get(Pe);if(Ne&&Ce.get(Qe))return Ne==Qe;var ze=-1,Re=!0,Ie=2&gt?new at:void 0;for(Ce.set(Pe,Qe),Ce.set(Qe,Pe);++ze<be;){var ae=Pe[ze],we=Qe[ze];if(xe)var Fe=de?xe(we,ae,ze,Qe,Pe,Ce):xe(ae,we,ze,Pe,Qe,Ce);if(Fe!==void 0){if(Fe)continue;Re=!1;break}if(Ie){if(!O(Qe,function(Ye,me){if(Be=me,!Ie.has(Be)&&(ae===Ye||Oe(ae,Ye,gt,xe,Ce)))return Ie.push(me);var Be})){Re=!1;break}}else if(ae!==we&&!Oe(ae,we,gt,xe,Ce)){Re=!1;break}}return Ce.delete(Pe),Ce.delete(Qe),Re}function St(Pe){return function(Qe,gt,xe){var Oe=gt(Qe);return Lr(Qe)?Oe:function(Ce,de){for(var be=-1,Se=de.length,Ne=Ce.length;++be<Se;)Ce[Ne+be]=de[be];return Ce}(Oe,xe(Qe))}(Pe,nt,Nt)}function et(Pe,Qe){var gt,xe,Oe=Pe.__data__;return((xe=typeof(gt=Qe))=="string"||xe=="number"||xe=="symbol"||xe=="boolean"?gt!=="__proto__":gt===null)?Oe[typeof Qe=="string"?"string":"hash"]:Oe.map}function Ht(Pe,Qe){var gt=function(xe,Oe){return xe==null?void 0:xe[Oe]}(Pe,Qe);return Me(gt)?gt:void 0}De.prototype.clear=function(){this.__data__=ve?ve(null):{},this.size=0},De.prototype.delete=function(Pe){var Qe=this.has(Pe)&&delete this.__data__[Pe];return this.size-=Qe?1:0,Qe},De.prototype.get=function(Pe){var Qe=this.__data__;if(ve){var gt=Qe[Pe];return gt==="__lodash_hash_undefined__"?void 0:gt}return R.call(Qe,Pe)?Qe[Pe]:void 0},De.prototype.has=function(Pe){var Qe=this.__data__;return ve?Qe[Pe]!==void 0:R.call(Qe,Pe)},De.prototype.set=function(Pe,Qe){var gt=this.__data__;return this.size+=this.has(Pe)?0:1,gt[Pe]=ve&&Qe===void 0?"__lodash_hash_undefined__":Qe,this},He.prototype.clear=function(){this.__data__=[],this.size=0},He.prototype.delete=function(Pe){var Qe=this.__data__,gt=$t(Qe,Pe);return!(gt<0)&&(gt==Qe.length-1?Qe.pop():re.call(Qe,gt,1),--this.size,!0)},He.prototype.get=function(Pe){var Qe=this.__data__,gt=$t(Qe,Pe);return gt<0?void 0:Qe[gt][1]},He.prototype.has=function(Pe){return $t(this.__data__,Pe)>-1},He.prototype.set=function(Pe,Qe){var gt=this.__data__,xe=$t(gt,Pe);return xe<0?(++this.size,gt.push([Pe,Qe])):gt[xe][1]=Qe,this},Xe.prototype.clear=function(){this.size=0,this.__data__={hash:new De,map:new(ue||He),string:new De}},Xe.prototype.delete=function(Pe){var Qe=et(this,Pe).delete(Pe);return this.size-=Qe?1:0,Qe},Xe.prototype.get=function(Pe){return et(this,Pe).get(Pe)},Xe.prototype.has=function(Pe){return et(this,Pe).has(Pe)},Xe.prototype.set=function(Pe,Qe){var gt=et(this,Pe),xe=gt.size;return gt.set(Pe,Qe),this.size+=gt.size==xe?0:1,this},at.prototype.add=at.prototype.push=function(Pe){return this.__data__.set(Pe,"__lodash_hash_undefined__"),this},at.prototype.has=function(Pe){return this.__data__.has(Pe)},dt.prototype.clear=function(){this.__data__=new He,this.size=0},dt.prototype.delete=function(Pe){var Qe=this.__data__,gt=Qe.delete(Pe);return this.size=Qe.size,gt},dt.prototype.get=function(Pe){return this.__data__.get(Pe)},dt.prototype.has=function(Pe){return this.__data__.has(Pe)},dt.prototype.set=function(Pe,Qe){var gt=this.__data__;if(gt instanceof He){var xe=gt.__data__;if(!ue||xe.length<199)return xe.push([Pe,Qe]),this.size=++gt.size,this;gt=this.__data__=new Xe(xe)}return gt.set(Pe,Qe),this.size=gt.size,this};var Nt=ne?function(Pe){return Pe==null?[]:(Pe=Object(Pe),function(Qe,gt){for(var xe=-1,Oe=Qe==null?0:Qe.length,Ce=0,de=[];++xe<Oe;){var be=Qe[xe];gt(be,xe,Qe)&&(de[Ce++]=be)}return de}(ne(Pe),function(Qe){return J.call(Pe,Qe)}))}:function(){return[]},kt=Bt;function kr(Pe,Qe){return!!(Qe=Qe??9007199254740991)&&(typeof Pe=="number"||h.test(Pe))&&Pe>-1&&Pe%1==0&&Pe<Qe}function Jt(Pe){if(Pe!=null){try{return _.call(Pe)}catch{}try{return Pe+""}catch{}}return""}function Pt(Pe,Qe){return Pe===Qe||Pe!=Pe&&Qe!=Qe}(ee&&kt(new ee(new ArrayBuffer(1)))!="[object DataView]"||ue&&kt(new ue)!=c||se&&kt(se.resolve())!="[object Promise]"||ce&&kt(new ce)!=l||fe&&kt(new fe)!="[object WeakMap]")&&(kt=function(Pe){var Qe=Bt(Pe),gt=Qe==u?Pe.constructor:void 0,xe=gt?Jt(gt):"";if(xe)switch(xe){case _e:return"[object DataView]";case le:return c;case ke:return"[object Promise]";case Te:return l;case pe:return"[object WeakMap]"}return Qe});var Ur=ft(function(){return arguments}())?ft:function(Pe){return je(Pe)&&R.call(Pe,"callee")&&!J.call(Pe,"callee")},Lr=Array.isArray,vt=Y||function(){return!1};function nr(Pe){if(!Dt(Pe))return!1;var Qe=Bt(Pe);return Qe=="[object Function]"||Qe=="[object GeneratorFunction]"||Qe=="[object AsyncFunction]"||Qe=="[object Proxy]"}function Cr(Pe){return typeof Pe=="number"&&Pe>-1&&Pe%1==0&&Pe<=9007199254740991}function Dt(Pe){var Qe=typeof Pe;return Pe!=null&&(Qe=="object"||Qe=="function")}function je(Pe){return Pe!=null&&typeof Pe=="object"}var ct=L?function(Pe){return function(Qe){return Pe(Qe)}}(L):function(Pe){return je(Pe)&&Cr(Pe.length)&&!!f[Bt(Pe)]};function nt(Pe){return(Qe=Pe)!=null&&Cr(Qe.length)&&!nr(Qe)?wt(Pe):tt(Pe);var Qe}n.exports=function(Pe,Qe){return tr(Pe,Qe)}}).call(this)}).call(this,typeof Kn<"u"?Kn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],446:[function(t,n,s){(function(o){(function(){var i=typeof o=="object"&&o&&o.Object===Object&&o,c=typeof self=="object"&&self&&self.Object===Object&&self,u=i||c||Function("return this")(),l=Object.prototype,d=l.hasOwnProperty,h=l.toString,f=u.Symbol,p=f?f.toStringTag:void 0;function v(g){return g==null?g===void 0?"[object Undefined]":"[object Null]":p&&p in Object(g)?function(m){var b=d.call(m,p),y=m[p];try{m[p]=void 0;var S=!0}catch{}var C=h.call(m);return S&&(b?m[p]=y:delete m[p]),C}(g):function(m){return h.call(m)}(g)}n.exports=function(g){if(!function(b){var y=typeof b;return b!=null&&(y=="object"||y=="function")}(g))return!1;var m=v(g);return m=="[object Function]"||m=="[object GeneratorFunction]"||m=="[object AsyncFunction]"||m=="[object Proxy]"}}).call(this)}).call(this,typeof Kn<"u"?Kn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],447:[function(t,n,s){n.exports=function(o){return o==null}},{}],448:[function(t,n,s){n.exports=function(o){return o===void 0}},{}],449:[function(t,n,s){(function(o){(function(){var i=/^\[object .+?Constructor\]$/,c=typeof o=="object"&&o&&o.Object===Object&&o,u=typeof self=="object"&&self&&self.Object===Object&&self,l=c||u||Function("return this")();function d(M,Z){return!!(M&&M.length)&&function(J,re,X){if(re!=re)return function(K,ee,ue,se){for(var ce=K.length,fe=ue+-1;++fe<ce;)if(ee(K[fe],fe,K))return fe;return-1}(J,h,X);for(var ne=X-1,Y=J.length;++ne<Y;)if(J[ne]===re)return ne;return-1}(M,Z,0)>-1}function h(M){return M!=M}function f(M,Z){return M.has(Z)}function p(M){var Z=-1,J=Array(M.size);return M.forEach(function(re){J[++Z]=re}),J}var v,g=Array.prototype,m=Function.prototype,b=Object.prototype,y=l["__core-js_shared__"],S=(v=/[^.]+$/.exec(y&&y.keys&&y.keys.IE_PROTO||""))?"Symbol(src)_1."+v:"",C=m.toString,L=b.hasOwnProperty,O=b.toString,H=RegExp("^"+C.call(L).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),z=g.splice,q=N(l,"Map"),D=N(l,"Set"),W=N(Object,"create");function P(M){var Z=-1,J=M?M.length:0;for(this.clear();++Z<J;){var re=M[Z];this.set(re[0],re[1])}}function I(M){var Z=-1,J=M?M.length:0;for(this.clear();++Z<J;){var re=M[Z];this.set(re[0],re[1])}}function U(M){var Z=-1,J=M?M.length:0;for(this.clear();++Z<J;){var re=M[Z];this.set(re[0],re[1])}}function k(M){var Z=-1,J=M?M.length:0;for(this.__data__=new U;++Z<J;)this.add(M[Z])}function _(M,Z){for(var J,re,X=M.length;X--;)if((J=M[X][0])===(re=Z)||J!=J&&re!=re)return X;return-1}function R(M){return!(!V(M)||(Z=M,S&&S in Z))&&(function(J){var re=V(J)?O.call(J):"";return re=="[object Function]"||re=="[object GeneratorFunction]"}(M)||function(J){var re=!1;if(J!=null&&typeof J.toString!="function")try{re=!!(J+"")}catch{}return re}(M)?H:i).test(function(J){if(J!=null){try{return C.call(J)}catch{}try{return J+""}catch{}}return""}(M));var Z}P.prototype.clear=function(){this.__data__=W?W(null):{}},P.prototype.delete=function(M){return this.has(M)&&delete this.__data__[M]},P.prototype.get=function(M){var Z=this.__data__;if(W){var J=Z[M];return J==="__lodash_hash_undefined__"?void 0:J}return L.call(Z,M)?Z[M]:void 0},P.prototype.has=function(M){var Z=this.__data__;return W?Z[M]!==void 0:L.call(Z,M)},P.prototype.set=function(M,Z){return this.__data__[M]=W&&Z===void 0?"__lodash_hash_undefined__":Z,this},I.prototype.clear=function(){this.__data__=[]},I.prototype.delete=function(M){var Z=this.__data__,J=_(Z,M);return!(J<0)&&(J==Z.length-1?Z.pop():z.call(Z,J,1),!0)},I.prototype.get=function(M){var Z=this.__data__,J=_(Z,M);return J<0?void 0:Z[J][1]},I.prototype.has=function(M){return _(this.__data__,M)>-1},I.prototype.set=function(M,Z){var J=this.__data__,re=_(J,M);return re<0?J.push([M,Z]):J[re][1]=Z,this},U.prototype.clear=function(){this.__data__={hash:new P,map:new(q||I),string:new P}},U.prototype.delete=function(M){return A(this,M).delete(M)},U.prototype.get=function(M){return A(this,M).get(M)},U.prototype.has=function(M){return A(this,M).has(M)},U.prototype.set=function(M,Z){return A(this,M).set(M,Z),this},k.prototype.add=k.prototype.push=function(M){return this.__data__.set(M,"__lodash_hash_undefined__"),this},k.prototype.has=function(M){return this.__data__.has(M)};var j=D&&1/p(new D([,-0]))[1]==1/0?function(M){return new D(M)}:function(){};function A(M,Z){var J,re,X=M.__data__;return((re=typeof(J=Z))=="string"||re=="number"||re=="symbol"||re=="boolean"?J!=="__proto__":J===null)?X[typeof Z=="string"?"string":"hash"]:X.map}function N(M,Z){var J=function(re,X){return re==null?void 0:re[X]}(M,Z);return R(J)?J:void 0}function V(M){var Z=typeof M;return!!M&&(Z=="object"||Z=="function")}n.exports=function(M){return M&&M.length?function(Z,J,re){var X=-1,ne=d,Y=Z.length,K=!0,ee=[],ue=ee;if(Y>=200){var se=j(Z);if(se)return p(se);K=!1,ne=f,ue=new k}else ue=ee;e:for(;++X<Y;){var ce=Z[X],fe=ce;if(ce=ce!==0?ce:0,K&&fe==fe){for(var ve=ue.length;ve--;)if(ue[ve]===fe)continue e;ee.push(ce)}else ne(ue,fe,re)||(ue!==ee&&ue.push(fe),ee.push(ce))}return ee}(M):[]}}).call(this)}).call(this,typeof Kn<"u"?Kn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],450:[function(t,n,s){var o=t("inherits"),i=t("hash-base"),c=t("safe-buffer").Buffer,u=new Array(16);function l(){i.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function d(g,m){return g<<m|g>>>32-m}function h(g,m,b,y,S,C,L){return d(g+(m&b|~m&y)+S+C|0,L)+m|0}function f(g,m,b,y,S,C,L){return d(g+(m&y|b&~y)+S+C|0,L)+m|0}function p(g,m,b,y,S,C,L){return d(g+(m^b^y)+S+C|0,L)+m|0}function v(g,m,b,y,S,C,L){return d(g+(b^(m|~y))+S+C|0,L)+m|0}o(l,i),l.prototype._update=function(){for(var g=u,m=0;m<16;++m)g[m]=this._block.readInt32LE(4*m);var b=this._a,y=this._b,S=this._c,C=this._d;b=h(b,y,S,C,g[0],3614090360,7),C=h(C,b,y,S,g[1],3905402710,12),S=h(S,C,b,y,g[2],606105819,17),y=h(y,S,C,b,g[3],3250441966,22),b=h(b,y,S,C,g[4],4118548399,7),C=h(C,b,y,S,g[5],1200080426,12),S=h(S,C,b,y,g[6],2821735955,17),y=h(y,S,C,b,g[7],4249261313,22),b=h(b,y,S,C,g[8],1770035416,7),C=h(C,b,y,S,g[9],2336552879,12),S=h(S,C,b,y,g[10],4294925233,17),y=h(y,S,C,b,g[11],2304563134,22),b=h(b,y,S,C,g[12],1804603682,7),C=h(C,b,y,S,g[13],4254626195,12),S=h(S,C,b,y,g[14],2792965006,17),b=f(b,y=h(y,S,C,b,g[15],1236535329,22),S,C,g[1],4129170786,5),C=f(C,b,y,S,g[6],3225465664,9),S=f(S,C,b,y,g[11],643717713,14),y=f(y,S,C,b,g[0],3921069994,20),b=f(b,y,S,C,g[5],3593408605,5),C=f(C,b,y,S,g[10],38016083,9),S=f(S,C,b,y,g[15],3634488961,14),y=f(y,S,C,b,g[4],3889429448,20),b=f(b,y,S,C,g[9],568446438,5),C=f(C,b,y,S,g[14],3275163606,9),S=f(S,C,b,y,g[3],4107603335,14),y=f(y,S,C,b,g[8],1163531501,20),b=f(b,y,S,C,g[13],2850285829,5),C=f(C,b,y,S,g[2],4243563512,9),S=f(S,C,b,y,g[7],1735328473,14),b=p(b,y=f(y,S,C,b,g[12],2368359562,20),S,C,g[5],4294588738,4),C=p(C,b,y,S,g[8],2272392833,11),S=p(S,C,b,y,g[11],1839030562,16),y=p(y,S,C,b,g[14],4259657740,23),b=p(b,y,S,C,g[1],2763975236,4),C=p(C,b,y,S,g[4],1272893353,11),S=p(S,C,b,y,g[7],4139469664,16),y=p(y,S,C,b,g[10],3200236656,23),b=p(b,y,S,C,g[13],681279174,4),C=p(C,b,y,S,g[0],3936430074,11),S=p(S,C,b,y,g[3],3572445317,16),y=p(y,S,C,b,g[6],76029189,23),b=p(b,y,S,C,g[9],3654602809,4),C=p(C,b,y,S,g[12],3873151461,11),S=p(S,C,b,y,g[15],530742520,16),b=v(b,y=p(y,S,C,b,g[2],3299628645,23),S,C,g[0],4096336452,6),C=v(C,b,y,S,g[7],1126891415,10),S=v(S,C,b,y,g[14],2878612391,15),y=v(y,S,C,b,g[5],4237533241,21),b=v(b,y,S,C,g[12],1700485571,6),C=v(C,b,y,S,g[3],2399980690,10),S=v(S,C,b,y,g[10],4293915773,15),y=v(y,S,C,b,g[1],2240044497,21),b=v(b,y,S,C,g[8],1873313359,6),C=v(C,b,y,S,g[15],4264355552,10),S=v(S,C,b,y,g[6],2734768916,15),y=v(y,S,C,b,g[13],1309151649,21),b=v(b,y,S,C,g[4],4149444226,6),C=v(C,b,y,S,g[11],3174756917,10),S=v(S,C,b,y,g[2],718787259,15),y=v(y,S,C,b,g[9],3951481745,21),this._a=this._a+b|0,this._b=this._b+y|0,this._c=this._c+S|0,this._d=this._d+C|0},l.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var g=c.allocUnsafe(16);return g.writeInt32LE(this._a,0),g.writeInt32LE(this._b,4),g.writeInt32LE(this._c,8),g.writeInt32LE(this._d,12),g},n.exports=l},{"hash-base":425,inherits:440,"safe-buffer":494}],451:[function(t,n,s){var o=t("bn.js"),i=t("brorand");function c(u){this.rand=u||new i.Rand}n.exports=c,c.create=function(u){return new c(u)},c.prototype._randbelow=function(u){var l=u.bitLength(),d=Math.ceil(l/8);do var h=new o(this.rand.generate(d));while(h.cmp(u)>=0);return h},c.prototype._randrange=function(u,l){var d=l.sub(u);return u.add(this._randbelow(d))},c.prototype.test=function(u,l,d){var h=u.bitLength(),f=o.mont(u),p=new o(1).toRed(f);l||(l=Math.max(1,h/48|0));for(var v=u.subn(1),g=0;!v.testn(g);g++);for(var m=u.shrn(g),b=v.toRed(f);l>0;l--){var y=this._randrange(new o(2),v);d&&d(y);var S=y.toRed(f).redPow(m);if(S.cmp(p)!==0&&S.cmp(b)!==0){for(var C=1;C<g;C++){if((S=S.redSqr()).cmp(p)===0)return!1;if(S.cmp(b)===0)break}if(C===g)return!1}}return!0},c.prototype.getDivisor=function(u,l){var d=u.bitLength(),h=o.mont(u),f=new o(1).toRed(h);l||(l=Math.max(1,d/48|0));for(var p=u.subn(1),v=0;!p.testn(v);v++);for(var g=u.shrn(v),m=p.toRed(h);l>0;l--){var b=this._randrange(new o(2),p),y=u.gcd(b);if(y.cmpn(1)!==0)return y;var S=b.toRed(h).redPow(g);if(S.cmp(f)!==0&&S.cmp(m)!==0){for(var C=1;C<v;C++){if((S=S.redSqr()).cmp(f)===0)return S.fromRed().subn(1).gcd(u);if(S.cmp(m)===0)break}if(C===v)return(S=S.redSqr()).fromRed().subn(1).gcd(u)}}return!1}},{"bn.js":452,brorand:187}],452:[function(t,n,s){arguments[4][184][0].apply(s,arguments)},{buffer:188,dup:184}],453:[function(t,n,s){function o(i,c){if(!i)throw new Error(c||"Assertion failed")}n.exports=o,o.equal=function(i,c,u){if(i!=c)throw new Error(u||"Assertion failed: "+i+" != "+c)}},{}],454:[function(t,n,s){var o=s;function i(u){return u.length===1?"0"+u:u}function c(u){for(var l="",d=0;d<u.length;d++)l+=i(u[d].toString(16));return l}o.toArray=function(u,l){if(Array.isArray(u))return u.slice();if(!u)return[];var d=[];if(typeof u!="string"){for(var h=0;h<u.length;h++)d[h]=0|u[h];return d}if(l==="hex")for((u=u.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(u="0"+u),h=0;h<u.length;h+=2)d.push(parseInt(u[h]+u[h+1],16));else for(h=0;h<u.length;h++){var f=u.charCodeAt(h),p=f>>8,v=255&f;p?d.push(p,v):d.push(v)}return d},o.zero2=i,o.toHex=c,o.encode=function(u,l){return l==="hex"?c(u):u}},{}],455:[function(t,n,s){n.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},{}],456:[function(t,n,s){var o=t("asn1.js");s.certificate=t("./certificate");var i=o.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});s.RSAPrivateKey=i;var c=o.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});s.RSAPublicKey=c;var u=o.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(l),this.key("subjectPublicKey").bitstr())});s.PublicKey=u;var l=o.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),d=o.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(l),this.key("subjectPrivateKey").octstr())});s.PrivateKey=d;var h=o.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});s.EncryptedPrivateKey=h;var f=o.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});s.DSAPrivateKey=f,s.DSAparam=o.define("DSAparam",function(){this.int()});var p=o.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(v),this.key("publicKey").optional().explicit(1).bitstr())});s.ECPrivateKey=p;var v=o.define("ECParameters",function(){this.choice({namedCurve:this.objid()})});s.signature=o.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())})},{"./certificate":457,"asn1.js":170}],457:[function(t,n,s){var o=t("asn1.js"),i=o.define("Time",function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}),c=o.define("AttributeTypeValue",function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}),u=o.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())}),l=o.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(u),this.key("subjectPublicKey").bitstr())}),d=o.define("RelativeDistinguishedName",function(){this.setof(c)}),h=o.define("RDNSequence",function(){this.seqof(d)}),f=o.define("Name",function(){this.choice({rdnSequence:this.use(h)})}),p=o.define("Validity",function(){this.seq().obj(this.key("notBefore").use(i),this.key("notAfter").use(i))}),v=o.define("Extension",function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())}),g=o.define("TBSCertificate",function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(u),this.key("issuer").use(f),this.key("validity").use(p),this.key("subject").use(f),this.key("subjectPublicKeyInfo").use(l),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(v).optional())}),m=o.define("X509Certificate",function(){this.seq().obj(this.key("tbsCertificate").use(g),this.key("signatureAlgorithm").use(u),this.key("signatureValue").bitstr())});n.exports=m},{"asn1.js":170}],458:[function(t,n,s){var o=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,i=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,c=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,u=t("evp_bytestokey"),l=t("browserify-aes"),d=t("safe-buffer").Buffer;n.exports=function(h,f){var p,v=h.toString(),g=v.match(o);if(g){var m="aes"+g[1],b=d.from(g[2],"hex"),y=d.from(g[3].replace(/[\r\n]/g,""),"base64"),S=u(f,b.slice(0,8),parseInt(g[1],10)).key,C=[],L=l.createDecipheriv(m,S,b);C.push(L.update(y)),C.push(L.final()),p=d.concat(C)}else{var O=v.match(c);p=d.from(O[2].replace(/[\r\n]/g,""),"base64")}return{tag:v.match(i)[1],data:p}}},{"browserify-aes":191,evp_bytestokey:423,"safe-buffer":494}],459:[function(t,n,s){var o=t("./asn1"),i=t("./aesid.json"),c=t("./fixProc"),u=t("browserify-aes"),l=t("pbkdf2"),d=t("safe-buffer").Buffer;function h(f){var p;typeof f!="object"||d.isBuffer(f)||(p=f.passphrase,f=f.key),typeof f=="string"&&(f=d.from(f));var v,g,m=c(f,p),b=m.tag,y=m.data;switch(b){case"CERTIFICATE":g=o.certificate.decode(y,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(g||(g=o.PublicKey.decode(y,"der")),v=g.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return o.RSAPublicKey.decode(g.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return g.subjectPrivateKey=g.subjectPublicKey,{type:"ec",data:g};case"1.2.840.10040.4.1":return g.algorithm.params.pub_key=o.DSAparam.decode(g.subjectPublicKey.data,"der"),{type:"dsa",data:g.algorithm.params};default:throw new Error("unknown key id "+v)}case"ENCRYPTED PRIVATE KEY":y=function(S,C){var L=S.algorithm.decrypt.kde.kdeparams.salt,O=parseInt(S.algorithm.decrypt.kde.kdeparams.iters.toString(),10),H=i[S.algorithm.decrypt.cipher.algo.join(".")],z=S.algorithm.decrypt.cipher.iv,q=S.subjectPrivateKey,D=parseInt(H.split("-")[1],10)/8,W=l.pbkdf2Sync(C,L,O,D,"sha1"),P=u.createDecipheriv(H,W,z),I=[];return I.push(P.update(q)),I.push(P.final()),d.concat(I)}(y=o.EncryptedPrivateKey.decode(y,"der"),p);case"PRIVATE KEY":switch(v=(g=o.PrivateKey.decode(y,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return o.RSAPrivateKey.decode(g.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:g.algorithm.curve,privateKey:o.ECPrivateKey.decode(g.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return g.algorithm.params.priv_key=o.DSAparam.decode(g.subjectPrivateKey,"der"),{type:"dsa",params:g.algorithm.params};default:throw new Error("unknown key id "+v)}case"RSA PUBLIC KEY":return o.RSAPublicKey.decode(y,"der");case"RSA PRIVATE KEY":return o.RSAPrivateKey.decode(y,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:o.DSAPrivateKey.decode(y,"der")};case"EC PRIVATE KEY":return{curve:(y=o.ECPrivateKey.decode(y,"der")).parameters.value,privateKey:y.privateKey};default:throw new Error("unknown key type "+b)}}n.exports=h,h.signature=o.signature},{"./aesid.json":455,"./asn1":456,"./fixProc":458,"browserify-aes":191,pbkdf2:460,"safe-buffer":494}],460:[function(t,n,s){s.pbkdf2=t("./lib/async"),s.pbkdf2Sync=t("./lib/sync")},{"./lib/async":461,"./lib/sync":464}],461:[function(t,n,s){(function(o){(function(){var i,c,u=t("safe-buffer").Buffer,l=t("./precondition"),d=t("./default-encoding"),h=t("./sync"),f=t("./to-buffer"),p=o.crypto&&o.crypto.subtle,v={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},g=[];function m(){return c||(c=o.process&&o.process.nextTick?o.process.nextTick:o.queueMicrotask?o.queueMicrotask:o.setImmediate?o.setImmediate:o.setTimeout)}function b(y,S,C,L,O){return p.importKey("raw",y,{name:"PBKDF2"},!1,["deriveBits"]).then(function(H){return p.deriveBits({name:"PBKDF2",salt:S,iterations:C,hash:{name:O}},H,L<<3)}).then(function(H){return u.from(H)})}n.exports=function(y,S,C,L,O,H){typeof O=="function"&&(H=O,O=void 0);var z=v[(O=O||"sha1").toLowerCase()];if(z&&typeof o.Promise=="function"){if(l(C,L),y=f(y,d,"Password"),S=f(S,d,"Salt"),typeof H!="function")throw new Error("No callback provided to pbkdf2");(function(q,D){q.then(function(W){m()(function(){D(null,W)})},function(W){m()(function(){D(W)})})})(function(q){if(o.process&&!o.process.browser||!p||!p.importKey||!p.deriveBits)return Promise.resolve(!1);if(g[q]!==void 0)return g[q];var D=b(i=i||u.alloc(8),i,10,128,q).then(function(){return!0}).catch(function(){return!1});return g[q]=D,D}(z).then(function(q){return q?b(y,S,C,L,z):h(y,S,C,L,O)}),H)}else m()(function(){var q;try{q=h(y,S,C,L,O)}catch(D){return H(D)}H(null,q)})}}).call(this)}).call(this,typeof Kn<"u"?Kn:typeof self<"u"?self:typeof window<"u"?window:{})},{"./default-encoding":462,"./precondition":463,"./sync":464,"./to-buffer":465,"safe-buffer":494}],462:[function(t,n,s){(function(o,i){(function(){var c;i.process&&i.process.browser?c="utf-8":i.process&&i.process.version?c=parseInt(o.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary":c="utf-8",n.exports=c}).call(this)}).call(this,t("_process"),typeof Kn<"u"?Kn:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467}],463:[function(t,n,s){var o=Math.pow(2,30)-1;n.exports=function(i,c){if(typeof i!="number")throw new TypeError("Iterations not a number");if(i<0)throw new TypeError("Bad iterations");if(typeof c!="number")throw new TypeError("Key length not a number");if(c<0||c>o||c!=c)throw new TypeError("Bad key length")}},{}],464:[function(t,n,s){var o=t("create-hash/md5"),i=t("ripemd160"),c=t("sha.js"),u=t("safe-buffer").Buffer,l=t("./precondition"),d=t("./default-encoding"),h=t("./to-buffer"),f=u.alloc(128),p={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function v(g,m,b){var y=function(z){function q(D){return c(z).update(D).digest()}return z==="rmd160"||z==="ripemd160"?function(D){return new i().update(D).digest()}:z==="md5"?o:q}(g),S=g==="sha512"||g==="sha384"?128:64;m.length>S?m=y(m):m.length<S&&(m=u.concat([m,f],S));for(var C=u.allocUnsafe(S+p[g]),L=u.allocUnsafe(S+p[g]),O=0;O<S;O++)C[O]=54^m[O],L[O]=92^m[O];var H=u.allocUnsafe(S+b+4);C.copy(H,0,0,S),this.ipad1=H,this.ipad2=C,this.opad=L,this.alg=g,this.blocksize=S,this.hash=y,this.size=p[g]}v.prototype.run=function(g,m){return g.copy(m,this.blocksize),this.hash(m).copy(this.opad,this.blocksize),this.hash(this.opad)},n.exports=function(g,m,b,y,S){l(b,y);var C=new v(S=S||"sha1",g=h(g,d,"Password"),(m=h(m,d,"Salt")).length),L=u.allocUnsafe(y),O=u.allocUnsafe(m.length+4);m.copy(O,0,0,m.length);for(var H=0,z=p[S],q=Math.ceil(y/z),D=1;D<=q;D++){O.writeUInt32BE(D,m.length);for(var W=C.run(O,C.ipad1),P=W,I=1;I<b;I++){P=C.run(P,C.ipad2);for(var U=0;U<z;U++)W[U]^=P[U]}W.copy(L,H),H+=z}return L}},{"./default-encoding":462,"./precondition":463,"./to-buffer":465,"create-hash/md5":387,ripemd160:493,"safe-buffer":494,"sha.js":498}],465:[function(t,n,s){var o=t("safe-buffer").Buffer;n.exports=function(i,c,u){if(o.isBuffer(i))return i;if(typeof i=="string")return o.from(i,c);if(ArrayBuffer.isView(i))return o.from(i.buffer);throw new TypeError(u+" must be a string, a Buffer, a typed array or a DataView")}},{"safe-buffer":494}],466:[function(t,n,s){(function(o){(function(){o===void 0||!o.version||o.version.indexOf("v0.")===0||o.version.indexOf("v1.")===0&&o.version.indexOf("v1.8.")!==0?n.exports={nextTick:function(i,c,u,l){if(typeof i!="function")throw new TypeError('"callback" argument must be a function');var d,h,f=arguments.length;switch(f){case 0:case 1:return o.nextTick(i);case 2:return o.nextTick(function(){i.call(null,c)});case 3:return o.nextTick(function(){i.call(null,c,u)});case 4:return o.nextTick(function(){i.call(null,c,u,l)});default:for(d=new Array(f-1),h=0;h<d.length;)d[h++]=arguments[h];return o.nextTick(function(){i.apply(null,d)})}}}:n.exports=o}).call(this)}).call(this,t("_process"))},{_process:467}],467:[function(t,n,s){var o,i,c=n.exports={};function u(){throw new Error("setTimeout has not been defined")}function l(){throw new Error("clearTimeout has not been defined")}function d(S){if(o===setTimeout)return setTimeout(S,0);if((o===u||!o)&&setTimeout)return o=setTimeout,setTimeout(S,0);try{return o(S,0)}catch{try{return o.call(null,S,0)}catch{return o.call(this,S,0)}}}(function(){try{o=typeof setTimeout=="function"?setTimeout:u}catch{o=u}try{i=typeof clearTimeout=="function"?clearTimeout:l}catch{i=l}})();var h,f=[],p=!1,v=-1;function g(){p&&h&&(p=!1,h.length?f=h.concat(f):v=-1,f.length&&m())}function m(){if(!p){var S=d(g);p=!0;for(var C=f.length;C;){for(h=f,f=[];++v<C;)h&&h[v].run();v=-1,C=f.length}h=null,p=!1,function(L){if(i===clearTimeout)return clearTimeout(L);if((i===l||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(L);try{i(L)}catch{try{return i.call(null,L)}catch{return i.call(this,L)}}}(S)}}function b(S,C){this.fun=S,this.array=C}function y(){}c.nextTick=function(S){var C=new Array(arguments.length-1);if(arguments.length>1)for(var L=1;L<arguments.length;L++)C[L-1]=arguments[L];f.push(new b(S,C)),f.length!==1||p||d(m)},b.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=y,c.addListener=y,c.once=y,c.off=y,c.removeListener=y,c.removeAllListeners=y,c.emit=y,c.prependListener=y,c.prependOnceListener=y,c.listeners=function(S){return[]},c.binding=function(S){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(S){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},{}],468:[function(t,n,s){s.publicEncrypt=t("./publicEncrypt"),s.privateDecrypt=t("./privateDecrypt"),s.privateEncrypt=function(o,i){return s.publicEncrypt(o,i,!0)},s.publicDecrypt=function(o,i){return s.privateDecrypt(o,i,!0)}},{"./privateDecrypt":471,"./publicEncrypt":472}],469:[function(t,n,s){var o=t("create-hash"),i=t("safe-buffer").Buffer;function c(u){var l=i.allocUnsafe(4);return l.writeUInt32BE(u,0),l}n.exports=function(u,l){for(var d,h=i.alloc(0),f=0;h.length<l;)d=c(f++),h=i.concat([h,o("sha1").update(u).update(d).digest()]);return h.slice(0,l)}},{"create-hash":386,"safe-buffer":494}],470:[function(t,n,s){arguments[4][184][0].apply(s,arguments)},{buffer:188,dup:184}],471:[function(t,n,s){var o=t("parse-asn1"),i=t("./mgf"),c=t("./xor"),u=t("bn.js"),l=t("browserify-rsa"),d=t("create-hash"),h=t("./withPublic"),f=t("safe-buffer").Buffer;n.exports=function(p,v,g){var m;m=p.padding?p.padding:g?1:4;var b,y=o(p),S=y.modulus.byteLength();if(v.length>S||new u(v).cmp(y.modulus)>=0)throw new Error("decryption error");b=g?h(new u(v),y):l(v,y);var C=f.alloc(S-b.length);if(b=f.concat([C,b],S),m===4)return function(L,O){var H=L.modulus.byteLength(),z=d("sha1").update(f.alloc(0)).digest(),q=z.length;if(O[0]!==0)throw new Error("decryption error");var D=O.slice(1,q+1),W=O.slice(q+1),P=c(D,i(W,q)),I=c(W,i(P,H-q-1));if(function(k,_){k=f.from(k),_=f.from(_);var R=0,j=k.length;k.length!==_.length&&(R++,j=Math.min(k.length,_.length));for(var A=-1;++A<j;)R+=k[A]^_[A];return R}(z,I.slice(0,q)))throw new Error("decryption error");for(var U=q;I[U]===0;)U++;if(I[U++]!==1)throw new Error("decryption error");return I.slice(U)}(y,b);if(m===1)return function(L,O,H){for(var z=O.slice(0,2),q=2,D=0;O[q++]!==0;)if(q>=O.length){D++;break}var W=O.slice(2,q-1);if((z.toString("hex")!=="0002"&&!H||z.toString("hex")!=="0001"&&H)&&D++,W.length<8&&D++,D)throw new Error("decryption error");return O.slice(q)}(0,b,g);if(m===3)return b;throw new Error("unknown padding")}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,"safe-buffer":494}],472:[function(t,n,s){var o=t("parse-asn1"),i=t("randombytes"),c=t("create-hash"),u=t("./mgf"),l=t("./xor"),d=t("bn.js"),h=t("./withPublic"),f=t("browserify-rsa"),p=t("safe-buffer").Buffer;n.exports=function(v,g,m){var b;b=v.padding?v.padding:m?1:4;var y,S=o(v);if(b===4)y=function(C,L){var O=C.modulus.byteLength(),H=L.length,z=c("sha1").update(p.alloc(0)).digest(),q=z.length,D=2*q;if(H>O-D-2)throw new Error("message too long");var W=p.alloc(O-H-D-2),P=O-q-1,I=i(q),U=l(p.concat([z,W,p.alloc(1,1),L],P),u(I,P)),k=l(I,u(U,q));return new d(p.concat([p.alloc(1),k,U],O))}(S,g);else if(b===1)y=function(C,L,O){var H,z=L.length,q=C.modulus.byteLength();if(z>q-11)throw new Error("message too long");return H=O?p.alloc(q-z-3,255):function(D){for(var W,P=p.allocUnsafe(D),I=0,U=i(2*D),k=0;I<D;)k===U.length&&(U=i(2*D),k=0),(W=U[k++])&&(P[I++]=W);return P}(q-z-3),new d(p.concat([p.from([0,O?1:2]),H,p.alloc(1),L],q))}(S,g,m);else{if(b!==3)throw new Error("unknown padding");if((y=new d(g)).cmp(S.modulus)>=0)throw new Error("data too long for modulus")}return m?f(y,S):h(y,S)}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,randombytes:475,"safe-buffer":494}],473:[function(t,n,s){var o=t("bn.js"),i=t("safe-buffer").Buffer;n.exports=function(c,u){return i.from(c.toRed(o.mont(u.modulus)).redPow(new o(u.publicExponent)).fromRed().toArray())}},{"bn.js":470,"safe-buffer":494}],474:[function(t,n,s){n.exports=function(o,i){for(var c=o.length,u=-1;++u<c;)o[u]^=i[u];return o}},{}],475:[function(t,n,s){(function(o,i){(function(){var c=t("safe-buffer").Buffer,u=i.crypto||i.msCrypto;u&&u.getRandomValues?n.exports=function(l,d){if(l>4294967295)throw new RangeError("requested too many random bytes");var h=c.allocUnsafe(l);if(l>0)if(l>65536)for(var f=0;f<l;f+=65536)u.getRandomValues(h.slice(f,f+65536));else u.getRandomValues(h);return typeof d=="function"?o.nextTick(function(){d(null,h)}):h}:n.exports=function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,t("_process"),typeof Kn<"u"?Kn:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467,"safe-buffer":494}],476:[function(t,n,s){(function(o,i){(function(){function c(){throw new Error(`secure random number generation not supported by this browser
use chrome, FireFox or Internet Explorer 11`)}var u=t("safe-buffer"),l=t("randombytes"),d=u.Buffer,h=u.kMaxLength,f=i.crypto||i.msCrypto,p=Math.pow(2,32)-1;function v(b,y){if(typeof b!="number"||b!=b)throw new TypeError("offset must be a number");if(b>p||b<0)throw new TypeError("offset must be a uint32");if(b>h||b>y)throw new RangeError("offset out of range")}function g(b,y,S){if(typeof b!="number"||b!=b)throw new TypeError("size must be a number");if(b>p||b<0)throw new TypeError("size must be a uint32");if(b+y>S||b>h)throw new RangeError("buffer too small")}function m(b,y,S,C){if(o.browser){var L=b.buffer,O=new Uint8Array(L,y,S);return f.getRandomValues(O),C?void o.nextTick(function(){C(null,b)}):b}if(!C)return l(S).copy(b,y),b;l(S,function(H,z){if(H)return C(H);z.copy(b,y),C(null,b)})}f&&f.getRandomValues||!o.browser?(s.randomFill=function(b,y,S,C){if(!(d.isBuffer(b)||b instanceof i.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if(typeof y=="function")C=y,y=0,S=b.length;else if(typeof S=="function")C=S,S=b.length-y;else if(typeof C!="function")throw new TypeError('"cb" argument must be a function');return v(y,b.length),g(S,y,b.length),m(b,y,S,C)},s.randomFillSync=function(b,y,S){if(y===void 0&&(y=0),!(d.isBuffer(b)||b instanceof i.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return v(y,b.length),S===void 0&&(S=b.length-y),g(S,y,b.length),m(b,y,S)}):(s.randomFill=c,s.randomFillSync=c)}).call(this)}).call(this,t("_process"),typeof Kn<"u"?Kn:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467,randombytes:475,"safe-buffer":494}],477:[function(t,n,s){var o={};function i(u,l,d){d||(d=Error);var h=function(f){var p,v;function g(m,b,y){return f.call(this,function(S,C,L){return typeof l=="string"?l:l(S,C,L)}(m,b,y))||this}return v=f,(p=g).prototype=Object.create(v.prototype),p.prototype.constructor=p,p.__proto__=v,g}(d);h.prototype.name=d.name,h.prototype.code=u,o[u]=h}function c(u,l){if(Array.isArray(u)){var d=u.length;return u=u.map(function(h){return String(h)}),d>2?"one of ".concat(l," ").concat(u.slice(0,d-1).join(", "),", or ")+u[d-1]:d===2?"one of ".concat(l," ").concat(u[0]," or ").concat(u[1]):"of ".concat(l," ").concat(u[0])}return"of ".concat(l," ").concat(String(u))}i("ERR_INVALID_OPT_VALUE",function(u,l){return'The value "'+l+'" is invalid for option "'+u+'"'},TypeError),i("ERR_INVALID_ARG_TYPE",function(u,l,d){var h,f,p;if(typeof l=="string"&&(f="not ",l.substr(0,f.length)===f)?(h="must not be",l=l.replace(/^not /,"")):h="must be",function(g,m,b){return(b===void 0||b>g.length)&&(b=g.length),g.substring(b-m.length,b)===m}(u," argument"))p="The ".concat(u," ").concat(h," ").concat(c(l,"type"));else{var v=function(g,m,b){return typeof b!="number"&&(b=0),!(b+m.length>g.length)&&g.indexOf(m,b)!==-1}(u,".")?"property":"argument";p='The "'.concat(u,'" ').concat(v," ").concat(h," ").concat(c(l,"type"))}return p+=". Received type ".concat(typeof d)},TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",function(u){return"The "+u+" method is not implemented"}),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",function(u){return"Cannot call "+u+" after a stream was destroyed"}),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",function(u){return"Unknown encoding: "+u},TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),n.exports.codes=o},{}],478:[function(t,n,s){(function(o){(function(){var i=Object.keys||function(g){var m=[];for(var b in g)m.push(b);return m};n.exports=f;var c=t("./_stream_readable"),u=t("./_stream_writable");t("inherits")(f,c);for(var l=i(u.prototype),d=0;d<l.length;d++){var h=l[d];f.prototype[h]||(f.prototype[h]=u.prototype[h])}function f(g){if(!(this instanceof f))return new f(g);c.call(this,g),u.call(this,g),this.allowHalfOpen=!0,g&&(g.readable===!1&&(this.readable=!1),g.writable===!1&&(this.writable=!1),g.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",p)))}function p(){this._writableState.ended||o.nextTick(v,this)}function v(g){g.end()}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(f.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(f.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(f.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(g){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=g,this._writableState.destroyed=g)}})}).call(this)}).call(this,t("_process"))},{"./_stream_readable":480,"./_stream_writable":482,_process:467,inherits:440}],479:[function(t,n,s){n.exports=i;var o=t("./_stream_transform");function i(c){if(!(this instanceof i))return new i(c);o.call(this,c)}t("inherits")(i,o),i.prototype._transform=function(c,u,l){l(null,c)}},{"./_stream_transform":481,inherits:440}],480:[function(t,n,s){(function(o,i){(function(){var c;n.exports=P,P.ReadableState=W,t("events").EventEmitter;var u=function(Y,K){return Y.listeners(K).length},l=t("./internal/streams/stream"),d=t("buffer").Buffer,h=(i!==void 0?i:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},f,p=t("util");f=p&&p.debuglog?p.debuglog("stream"):function(){};var v,g,m,b=t("./internal/streams/buffer_list"),y=t("./internal/streams/destroy"),S=t("./internal/streams/state").getHighWaterMark,C=t("../errors").codes,L=C.ERR_INVALID_ARG_TYPE,O=C.ERR_STREAM_PUSH_AFTER_EOF,H=C.ERR_METHOD_NOT_IMPLEMENTED,z=C.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;t("inherits")(P,l);var q=y.errorOrDestroy,D=["error","close","destroy","pause","resume"];function W(Y,K,ee){c=c||t("./_stream_duplex"),Y=Y||{},typeof ee!="boolean"&&(ee=K instanceof c),this.objectMode=!!Y.objectMode,ee&&(this.objectMode=this.objectMode||!!Y.readableObjectMode),this.highWaterMark=S(this,Y,"readableHighWaterMark",ee),this.buffer=new b,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=Y.emitClose!==!1,this.autoDestroy=!!Y.autoDestroy,this.destroyed=!1,this.defaultEncoding=Y.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,Y.encoding&&(v||(v=t("string_decoder/").StringDecoder),this.decoder=new v(Y.encoding),this.encoding=Y.encoding)}function P(Y){if(c=c||t("./_stream_duplex"),!(this instanceof P))return new P(Y);var K=this instanceof c;this._readableState=new W(Y,this,K),this.readable=!0,Y&&(typeof Y.read=="function"&&(this._read=Y.read),typeof Y.destroy=="function"&&(this._destroy=Y.destroy)),l.call(this)}function I(Y,K,ee,ue,se){f("readableAddChunk",K);var ce,fe=Y._readableState;if(K===null)fe.reading=!1,function(ve,_e){if(f("onEofChunk"),!_e.ended){if(_e.decoder){var le=_e.decoder.end();le&&le.length&&(_e.buffer.push(le),_e.length+=_e.objectMode?1:le.length)}_e.ended=!0,_e.sync?_(ve):(_e.needReadable=!1,_e.emittedReadable||(_e.emittedReadable=!0,R(ve)))}}(Y,fe);else if(se||(ce=function(ve,_e){var le;ke=_e,d.isBuffer(ke)||ke instanceof h||typeof _e=="string"||_e===void 0||ve.objectMode||(le=new L("chunk",["string","Buffer","Uint8Array"],_e));var ke;return le}(fe,K)),ce)q(Y,ce);else if(fe.objectMode||K&&K.length>0)if(typeof K=="string"||fe.objectMode||Object.getPrototypeOf(K)===d.prototype||(K=function(ve){return d.from(ve)}(K)),ue)fe.endEmitted?q(Y,new z):U(Y,fe,K,!0);else if(fe.ended)q(Y,new O);else{if(fe.destroyed)return!1;fe.reading=!1,fe.decoder&&!ee?(K=fe.decoder.write(K),fe.objectMode||K.length!==0?U(Y,fe,K,!1):j(Y,fe)):U(Y,fe,K,!1)}else ue||(fe.reading=!1,j(Y,fe));return!fe.ended&&(fe.length<fe.highWaterMark||fe.length===0)}function U(Y,K,ee,ue){K.flowing&&K.length===0&&!K.sync?(K.awaitDrain=0,Y.emit("data",ee)):(K.length+=K.objectMode?1:ee.length,ue?K.buffer.unshift(ee):K.buffer.push(ee),K.needReadable&&_(Y)),j(Y,K)}Object.defineProperty(P.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(Y){this._readableState&&(this._readableState.destroyed=Y)}}),P.prototype.destroy=y.destroy,P.prototype._undestroy=y.undestroy,P.prototype._destroy=function(Y,K){K(Y)},P.prototype.push=function(Y,K){var ee,ue=this._readableState;return ue.objectMode?ee=!0:typeof Y=="string"&&((K=K||ue.defaultEncoding)!==ue.encoding&&(Y=d.from(Y,K),K=""),ee=!0),I(this,Y,K,!1,ee)},P.prototype.unshift=function(Y){return I(this,Y,null,!0,!1)},P.prototype.isPaused=function(){return this._readableState.flowing===!1},P.prototype.setEncoding=function(Y){v||(v=t("string_decoder/").StringDecoder);var K=new v(Y);this._readableState.decoder=K,this._readableState.encoding=this._readableState.decoder.encoding;for(var ee=this._readableState.buffer.head,ue="";ee!==null;)ue+=K.write(ee.data),ee=ee.next;return this._readableState.buffer.clear(),ue!==""&&this._readableState.buffer.push(ue),this._readableState.length=ue.length,this};function k(Y,K){return Y<=0||K.length===0&&K.ended?0:K.objectMode?1:Y!=Y?K.flowing&&K.length?K.buffer.head.data.length:K.length:(Y>K.highWaterMark&&(K.highWaterMark=function(ee){return ee>=1073741824?ee=1073741824:(ee--,ee|=ee>>>1,ee|=ee>>>2,ee|=ee>>>4,ee|=ee>>>8,ee|=ee>>>16,ee++),ee}(Y)),Y<=K.length?Y:K.ended?K.length:(K.needReadable=!0,0))}function _(Y){var K=Y._readableState;f("emitReadable",K.needReadable,K.emittedReadable),K.needReadable=!1,K.emittedReadable||(f("emitReadable",K.flowing),K.emittedReadable=!0,o.nextTick(R,Y))}function R(Y){var K=Y._readableState;f("emitReadable_",K.destroyed,K.length,K.ended),K.destroyed||!K.length&&!K.ended||(Y.emit("readable"),K.emittedReadable=!1),K.needReadable=!K.flowing&&!K.ended&&K.length<=K.highWaterMark,Z(Y)}function j(Y,K){K.readingMore||(K.readingMore=!0,o.nextTick(A,Y,K))}function A(Y,K){for(;!K.reading&&!K.ended&&(K.length<K.highWaterMark||K.flowing&&K.length===0);){var ee=K.length;if(f("maybeReadMore read 0"),Y.read(0),ee===K.length)break}K.readingMore=!1}function N(Y){var K=Y._readableState;K.readableListening=Y.listenerCount("readable")>0,K.resumeScheduled&&!K.paused?K.flowing=!0:Y.listenerCount("data")>0&&Y.resume()}function V(Y){f("readable nexttick read 0"),Y.read(0)}function M(Y,K){f("resume",K.reading),K.reading||Y.read(0),K.resumeScheduled=!1,Y.emit("resume"),Z(Y),K.flowing&&!K.reading&&Y.read(0)}function Z(Y){var K=Y._readableState;for(f("flow",K.flowing);K.flowing&&Y.read()!==null;);}function J(Y,K){return K.length===0?null:(K.objectMode?ee=K.buffer.shift():!Y||Y>=K.length?(ee=K.decoder?K.buffer.join(""):K.buffer.length===1?K.buffer.first():K.buffer.concat(K.length),K.buffer.clear()):ee=K.buffer.consume(Y,K.decoder),ee);var ee}function re(Y){var K=Y._readableState;f("endReadable",K.endEmitted),K.endEmitted||(K.ended=!0,o.nextTick(X,K,Y))}function X(Y,K){if(f("endReadableNT",Y.endEmitted,Y.length),!Y.endEmitted&&Y.length===0&&(Y.endEmitted=!0,K.readable=!1,K.emit("end"),Y.autoDestroy)){var ee=K._writableState;(!ee||ee.autoDestroy&&ee.finished)&&K.destroy()}}function ne(Y,K){for(var ee=0,ue=Y.length;ee<ue;ee++)if(Y[ee]===K)return ee;return-1}P.prototype.read=function(Y){f("read",Y),Y=parseInt(Y,10);var K=this._readableState,ee=Y;if(Y!==0&&(K.emittedReadable=!1),Y===0&&K.needReadable&&((K.highWaterMark!==0?K.length>=K.highWaterMark:K.length>0)||K.ended))return f("read: emitReadable",K.length,K.ended),K.length===0&&K.ended?re(this):_(this),null;if((Y=k(Y,K))===0&&K.ended)return K.length===0&&re(this),null;var ue,se=K.needReadable;return f("need readable",se),(K.length===0||K.length-Y<K.highWaterMark)&&f("length less than watermark",se=!0),K.ended||K.reading?f("reading or ended",se=!1):se&&(f("do read"),K.reading=!0,K.sync=!0,K.length===0&&(K.needReadable=!0),this._read(K.highWaterMark),K.sync=!1,K.reading||(Y=k(ee,K))),(ue=Y>0?J(Y,K):null)===null?(K.needReadable=K.length<=K.highWaterMark,Y=0):(K.length-=Y,K.awaitDrain=0),K.length===0&&(K.ended||(K.needReadable=!0),ee!==Y&&K.ended&&re(this)),ue!==null&&this.emit("data",ue),ue},P.prototype._read=function(Y){q(this,new H("_read()"))},P.prototype.pipe=function(Y,K){var ee=this,ue=this._readableState;switch(ue.pipesCount){case 0:ue.pipes=Y;break;case 1:ue.pipes=[ue.pipes,Y];break;default:ue.pipes.push(Y)}ue.pipesCount+=1,f("pipe count=%d opts=%j",ue.pipesCount,K);var se=(!K||K.end!==!1)&&Y!==o.stdout&&Y!==o.stderr?fe:ye;function ce(ge,De){f("onunpipe"),ge===ee&&De&&De.hasUnpiped===!1&&(De.hasUnpiped=!0,f("cleanup"),Y.removeListener("close",Te),Y.removeListener("finish",pe),Y.removeListener("drain",ve),Y.removeListener("error",ke),Y.removeListener("unpipe",ce),ee.removeListener("end",fe),ee.removeListener("end",ye),ee.removeListener("data",le),_e=!0,!ue.awaitDrain||Y._writableState&&!Y._writableState.needDrain||ve())}function fe(){f("onend"),Y.end()}ue.endEmitted?o.nextTick(se):ee.once("end",se),Y.on("unpipe",ce);var ve=function(ge){return function(){var De=ge._readableState;f("pipeOnDrain",De.awaitDrain),De.awaitDrain&&De.awaitDrain--,De.awaitDrain===0&&u(ge,"data")&&(De.flowing=!0,Z(ge))}}(ee);Y.on("drain",ve);var _e=!1;function le(ge){f("ondata");var De=Y.write(ge);f("dest.write",De),De===!1&&((ue.pipesCount===1&&ue.pipes===Y||ue.pipesCount>1&&ne(ue.pipes,Y)!==-1)&&!_e&&(f("false write response, pause",ue.awaitDrain),ue.awaitDrain++),ee.pause())}function ke(ge){f("onerror",ge),ye(),Y.removeListener("error",ke),u(Y,"error")===0&&q(Y,ge)}function Te(){Y.removeListener("finish",pe),ye()}function pe(){f("onfinish"),Y.removeListener("close",Te),ye()}function ye(){f("unpipe"),ee.unpipe(Y)}return ee.on("data",le),function(ge,De,He){if(typeof ge.prependListener=="function")return ge.prependListener(De,He);ge._events&&ge._events[De]?Array.isArray(ge._events[De])?ge._events[De].unshift(He):ge._events[De]=[He,ge._events[De]]:ge.on(De,He)}(Y,"error",ke),Y.once("close",Te),Y.once("finish",pe),Y.emit("pipe",ee),ue.flowing||(f("pipe resume"),ee.resume()),Y},P.prototype.unpipe=function(Y){var K=this._readableState,ee={hasUnpiped:!1};if(K.pipesCount===0)return this;if(K.pipesCount===1)return Y&&Y!==K.pipes||(Y||(Y=K.pipes),K.pipes=null,K.pipesCount=0,K.flowing=!1,Y&&Y.emit("unpipe",this,ee)),this;if(!Y){var ue=K.pipes,se=K.pipesCount;K.pipes=null,K.pipesCount=0,K.flowing=!1;for(var ce=0;ce<se;ce++)ue[ce].emit("unpipe",this,{hasUnpiped:!1});return this}var fe=ne(K.pipes,Y);return fe===-1||(K.pipes.splice(fe,1),K.pipesCount-=1,K.pipesCount===1&&(K.pipes=K.pipes[0]),Y.emit("unpipe",this,ee)),this},P.prototype.on=function(Y,K){var ee=l.prototype.on.call(this,Y,K),ue=this._readableState;return Y==="data"?(ue.readableListening=this.listenerCount("readable")>0,ue.flowing!==!1&&this.resume()):Y==="readable"&&(ue.endEmitted||ue.readableListening||(ue.readableListening=ue.needReadable=!0,ue.flowing=!1,ue.emittedReadable=!1,f("on readable",ue.length,ue.reading),ue.length?_(this):ue.reading||o.nextTick(V,this))),ee},P.prototype.addListener=P.prototype.on,P.prototype.removeListener=function(Y,K){var ee=l.prototype.removeListener.call(this,Y,K);return Y==="readable"&&o.nextTick(N,this),ee},P.prototype.removeAllListeners=function(Y){var K=l.prototype.removeAllListeners.apply(this,arguments);return Y!=="readable"&&Y!==void 0||o.nextTick(N,this),K},P.prototype.resume=function(){var Y=this._readableState;return Y.flowing||(f("resume"),Y.flowing=!Y.readableListening,function(K,ee){ee.resumeScheduled||(ee.resumeScheduled=!0,o.nextTick(M,K,ee))}(this,Y)),Y.paused=!1,this},P.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},P.prototype.wrap=function(Y){var K=this,ee=this._readableState,ue=!1;for(var se in Y.on("end",function(){if(f("wrapped end"),ee.decoder&&!ee.ended){var fe=ee.decoder.end();fe&&fe.length&&K.push(fe)}K.push(null)}),Y.on("data",function(fe){f("wrapped data"),ee.decoder&&(fe=ee.decoder.write(fe)),ee.objectMode&&fe==null||(ee.objectMode||fe&&fe.length)&&(K.push(fe)||(ue=!0,Y.pause()))}),Y)this[se]===void 0&&typeof Y[se]=="function"&&(this[se]=function(fe){return function(){return Y[fe].apply(Y,arguments)}}(se));for(var ce=0;ce<D.length;ce++)Y.on(D[ce],this.emit.bind(this,D[ce]));return this._read=function(fe){f("wrapped _read",fe),ue&&(ue=!1,Y.resume())},this},typeof Symbol=="function"&&(P.prototype[Symbol.asyncIterator]=function(){return g===void 0&&(g=t("./internal/streams/async_iterator")),g(this)}),Object.defineProperty(P.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(P.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(P.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(Y){this._readableState&&(this._readableState.flowing=Y)}}),P._fromList=J,Object.defineProperty(P.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(P.from=function(Y,K){return m===void 0&&(m=t("./internal/streams/from")),m(P,Y,K)})}).call(this)}).call(this,t("_process"),typeof Kn<"u"?Kn:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/async_iterator":483,"./internal/streams/buffer_list":484,"./internal/streams/destroy":485,"./internal/streams/from":487,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,events:422,inherits:440,"string_decoder/":522,util:188}],481:[function(t,n,s){n.exports=f;var o=t("../errors").codes,i=o.ERR_METHOD_NOT_IMPLEMENTED,c=o.ERR_MULTIPLE_CALLBACK,u=o.ERR_TRANSFORM_ALREADY_TRANSFORMING,l=o.ERR_TRANSFORM_WITH_LENGTH_0,d=t("./_stream_duplex");function h(g,m){var b=this._transformState;b.transforming=!1;var y=b.writecb;if(y===null)return this.emit("error",new c);b.writechunk=null,b.writecb=null,m!=null&&this.push(m),y(g);var S=this._readableState;S.reading=!1,(S.needReadable||S.length<S.highWaterMark)&&this._read(S.highWaterMark)}function f(g){if(!(this instanceof f))return new f(g);d.call(this,g),this._transformState={afterTransform:h.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,g&&(typeof g.transform=="function"&&(this._transform=g.transform),typeof g.flush=="function"&&(this._flush=g.flush)),this.on("prefinish",p)}function p(){var g=this;typeof this._flush!="function"||this._readableState.destroyed?v(this,null,null):this._flush(function(m,b){v(g,m,b)})}function v(g,m,b){if(m)return g.emit("error",m);if(b!=null&&g.push(b),g._writableState.length)throw new l;if(g._transformState.transforming)throw new u;return g.push(null)}t("inherits")(f,d),f.prototype.push=function(g,m){return this._transformState.needTransform=!1,d.prototype.push.call(this,g,m)},f.prototype._transform=function(g,m,b){b(new i("_transform()"))},f.prototype._write=function(g,m,b){var y=this._transformState;if(y.writecb=b,y.writechunk=g,y.writeencoding=m,!y.transforming){var S=this._readableState;(y.needTransform||S.needReadable||S.length<S.highWaterMark)&&this._read(S.highWaterMark)}},f.prototype._read=function(g){var m=this._transformState;m.writechunk===null||m.transforming?m.needTransform=!0:(m.transforming=!0,this._transform(m.writechunk,m.writeencoding,m.afterTransform))},f.prototype._destroy=function(g,m){d.prototype._destroy.call(this,g,function(b){m(b)})}},{"../errors":477,"./_stream_duplex":478,inherits:440}],482:[function(t,n,s){(function(o,i){(function(){function c(A){var N=this;this.next=null,this.entry=null,this.finish=function(){(function(V,M,Z){var J=V.entry;for(V.entry=null;J;){var re=J.callback;M.pendingcb--,re(Z),J=J.next}M.corkedRequestsFree.next=V})(N,A)}}var u;n.exports=P,P.WritableState=W;var l={deprecate:t("util-deprecate")},d=t("./internal/streams/stream"),h=t("buffer").Buffer,f=(i!==void 0?i:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},p,v=t("./internal/streams/destroy"),g=t("./internal/streams/state").getHighWaterMark,m=t("../errors").codes,b=m.ERR_INVALID_ARG_TYPE,y=m.ERR_METHOD_NOT_IMPLEMENTED,S=m.ERR_MULTIPLE_CALLBACK,C=m.ERR_STREAM_CANNOT_PIPE,L=m.ERR_STREAM_DESTROYED,O=m.ERR_STREAM_NULL_VALUES,H=m.ERR_STREAM_WRITE_AFTER_END,z=m.ERR_UNKNOWN_ENCODING,q=v.errorOrDestroy;function D(){}function W(A,N,V){u=u||t("./_stream_duplex"),A=A||{},typeof V!="boolean"&&(V=N instanceof u),this.objectMode=!!A.objectMode,V&&(this.objectMode=this.objectMode||!!A.writableObjectMode),this.highWaterMark=g(this,A,"writableHighWaterMark",V),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var M=A.decodeStrings===!1;this.decodeStrings=!M,this.defaultEncoding=A.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Z){(function(J,re){var X=J._writableState,ne=X.sync,Y=X.writecb;if(typeof Y!="function")throw new S;if(function(ee){ee.writing=!1,ee.writecb=null,ee.length-=ee.writelen,ee.writelen=0}(X),re)(function(ee,ue,se,ce,fe){--ue.pendingcb,se?(o.nextTick(fe,ce),o.nextTick(j,ee,ue),ee._writableState.errorEmitted=!0,q(ee,ce)):(fe(ce),ee._writableState.errorEmitted=!0,q(ee,ce),j(ee,ue))})(J,X,ne,re,Y);else{var K=_(X)||J.destroyed;K||X.corked||X.bufferProcessing||!X.bufferedRequest||k(J,X),ne?o.nextTick(U,J,X,K,Y):U(J,X,K,Y)}})(N,Z)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=A.emitClose!==!1,this.autoDestroy=!!A.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new c(this)}function P(A){var N=this instanceof(u=u||t("./_stream_duplex"));if(!N&&!p.call(P,this))return new P(A);this._writableState=new W(A,this,N),this.writable=!0,A&&(typeof A.write=="function"&&(this._write=A.write),typeof A.writev=="function"&&(this._writev=A.writev),typeof A.destroy=="function"&&(this._destroy=A.destroy),typeof A.final=="function"&&(this._final=A.final)),d.call(this)}function I(A,N,V,M,Z,J,re){N.writelen=M,N.writecb=re,N.writing=!0,N.sync=!0,N.destroyed?N.onwrite(new L("write")):V?A._writev(Z,N.onwrite):A._write(Z,J,N.onwrite),N.sync=!1}function U(A,N,V,M){V||function(Z,J){J.length===0&&J.needDrain&&(J.needDrain=!1,Z.emit("drain"))}(A,N),N.pendingcb--,M(),j(A,N)}function k(A,N){N.bufferProcessing=!0;var V=N.bufferedRequest;if(A._writev&&V&&V.next){var M=N.bufferedRequestCount,Z=new Array(M),J=N.corkedRequestsFree;J.entry=V;for(var re=0,X=!0;V;)Z[re]=V,V.isBuf||(X=!1),V=V.next,re+=1;Z.allBuffers=X,I(A,N,!0,N.length,Z,"",J.finish),N.pendingcb++,N.lastBufferedRequest=null,J.next?(N.corkedRequestsFree=J.next,J.next=null):N.corkedRequestsFree=new c(N),N.bufferedRequestCount=0}else{for(;V;){var ne=V.chunk,Y=V.encoding,K=V.callback;if(I(A,N,!1,N.objectMode?1:ne.length,ne,Y,K),V=V.next,N.bufferedRequestCount--,N.writing)break}V===null&&(N.lastBufferedRequest=null)}N.bufferedRequest=V,N.bufferProcessing=!1}function _(A){return A.ending&&A.length===0&&A.bufferedRequest===null&&!A.finished&&!A.writing}function R(A,N){A._final(function(V){N.pendingcb--,V&&q(A,V),N.prefinished=!0,A.emit("prefinish"),j(A,N)})}function j(A,N){var V=_(N);if(V&&(function(Z,J){J.prefinished||J.finalCalled||(typeof Z._final!="function"||J.destroyed?(J.prefinished=!0,Z.emit("prefinish")):(J.pendingcb++,J.finalCalled=!0,o.nextTick(R,Z,J)))}(A,N),N.pendingcb===0&&(N.finished=!0,A.emit("finish"),N.autoDestroy))){var M=A._readableState;(!M||M.autoDestroy&&M.endEmitted)&&A.destroy()}return V}t("inherits")(P,d),W.prototype.getBuffer=function(){for(var A=this.bufferedRequest,N=[];A;)N.push(A),A=A.next;return N},function(){try{Object.defineProperty(W.prototype,"buffer",{get:l.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(p=Function.prototype[Symbol.hasInstance],Object.defineProperty(P,Symbol.hasInstance,{value:function(A){return!!p.call(this,A)||this===P&&A&&A._writableState instanceof W}})):p=function(A){return A instanceof this},P.prototype.pipe=function(){q(this,new C)},P.prototype.write=function(A,N,V){var M,Z=this._writableState,J=!1,re=!Z.objectMode&&(M=A,h.isBuffer(M)||M instanceof f);return re&&!h.isBuffer(A)&&(A=function(X){return h.from(X)}(A)),typeof N=="function"&&(V=N,N=null),re?N="buffer":N||(N=Z.defaultEncoding),typeof V!="function"&&(V=D),Z.ending?function(X,ne){var Y=new H;q(X,Y),o.nextTick(ne,Y)}(this,V):(re||function(X,ne,Y,K){var ee;return Y===null?ee=new O:typeof Y=="string"||ne.objectMode||(ee=new b("chunk",["string","Buffer"],Y)),!ee||(q(X,ee),o.nextTick(K,ee),!1)}(this,Z,A,V))&&(Z.pendingcb++,J=function(X,ne,Y,K,ee,ue){if(!Y){var se=function(_e,le,ke){return _e.objectMode||_e.decodeStrings===!1||typeof le!="string"||(le=h.from(le,ke)),le}(ne,K,ee);K!==se&&(Y=!0,ee="buffer",K=se)}var ce=ne.objectMode?1:K.length;ne.length+=ce;var fe=ne.length<ne.highWaterMark;if(fe||(ne.needDrain=!0),ne.writing||ne.corked){var ve=ne.lastBufferedRequest;ne.lastBufferedRequest={chunk:K,encoding:ee,isBuf:Y,callback:ue,next:null},ve?ve.next=ne.lastBufferedRequest:ne.bufferedRequest=ne.lastBufferedRequest,ne.bufferedRequestCount+=1}else I(X,ne,!1,ce,K,ee,ue);return fe}(this,Z,re,A,N,V)),J},P.prototype.cork=function(){this._writableState.corked++},P.prototype.uncork=function(){var A=this._writableState;A.corked&&(A.corked--,A.writing||A.corked||A.bufferProcessing||!A.bufferedRequest||k(this,A))},P.prototype.setDefaultEncoding=function(A){if(typeof A=="string"&&(A=A.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((A+"").toLowerCase())>-1))throw new z(A);return this._writableState.defaultEncoding=A,this},Object.defineProperty(P.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(P.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),P.prototype._write=function(A,N,V){V(new y("_write()"))},P.prototype._writev=null,P.prototype.end=function(A,N,V){var M=this._writableState;return typeof A=="function"?(V=A,A=null,N=null):typeof N=="function"&&(V=N,N=null),A!=null&&this.write(A,N),M.corked&&(M.corked=1,this.uncork()),M.ending||function(Z,J,re){J.ending=!0,j(Z,J),re&&(J.finished?o.nextTick(re):Z.once("finish",re)),J.ended=!0,Z.writable=!1}(this,M,V),this},Object.defineProperty(P.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(P.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(A){this._writableState&&(this._writableState.destroyed=A)}}),P.prototype.destroy=v.destroy,P.prototype._undestroy=v.undestroy,P.prototype._destroy=function(A,N){N(A)}}).call(this)}).call(this,t("_process"),typeof Kn<"u"?Kn:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/destroy":485,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,inherits:440,"util-deprecate":524}],483:[function(t,n,s){(function(o){(function(){var i;function c(L,O,H){return(O=function(z){var q=function(D,W){if(typeof D!="object"||D===null)return D;var P=D[Symbol.toPrimitive];if(P!==void 0){var I=P.call(D,W);if(typeof I!="object")return I;throw new TypeError("@@toPrimitive must return a primitive value.")}return(W==="string"?String:Number)(D)}(z,"string");return typeof q=="symbol"?q:String(q)}(O))in L?Object.defineProperty(L,O,{value:H,enumerable:!0,configurable:!0,writable:!0}):L[O]=H,L}var u=t("./end-of-stream"),l=Symbol("lastResolve"),d=Symbol("lastReject"),h=Symbol("error"),f=Symbol("ended"),p=Symbol("lastPromise"),v=Symbol("handlePromise"),g=Symbol("stream");function m(L,O){return{value:L,done:O}}function b(L){var O=L[l];if(O!==null){var H=L[g].read();H!==null&&(L[p]=null,L[l]=null,L[d]=null,O(m(H,!1)))}}function y(L){o.nextTick(b,L)}var S=Object.getPrototypeOf(function(){}),C=Object.setPrototypeOf((c(i={get stream(){return this[g]},next:function(){var L=this,O=this[h];if(O!==null)return Promise.reject(O);if(this[f])return Promise.resolve(m(void 0,!0));if(this[g].destroyed)return new Promise(function(D,W){o.nextTick(function(){L[h]?W(L[h]):D(m(void 0,!0))})});var H,z=this[p];if(z)H=new Promise(function(D,W){return function(P,I){D.then(function(){W[f]?P(m(void 0,!0)):W[v](P,I)},I)}}(z,this));else{var q=this[g].read();if(q!==null)return Promise.resolve(m(q,!1));H=new Promise(this[v])}return this[p]=H,H}},Symbol.asyncIterator,function(){return this}),c(i,"return",function(){var L=this;return new Promise(function(O,H){L[g].destroy(null,function(z){z?H(z):O(m(void 0,!0))})})}),i),S);n.exports=function(L){var O,H=Object.create(C,(c(O={},g,{value:L,writable:!0}),c(O,l,{value:null,writable:!0}),c(O,d,{value:null,writable:!0}),c(O,h,{value:null,writable:!0}),c(O,f,{value:L._readableState.endEmitted,writable:!0}),c(O,v,{value:function(z,q){var D=H[g].read();D?(H[p]=null,H[l]=null,H[d]=null,z(m(D,!1))):(H[l]=z,H[d]=q)},writable:!0}),O));return H[p]=null,u(L,function(z){if(z&&z.code!=="ERR_STREAM_PREMATURE_CLOSE"){var q=H[d];return q!==null&&(H[p]=null,H[l]=null,H[d]=null,q(z)),void(H[h]=z)}var D=H[l];D!==null&&(H[p]=null,H[l]=null,H[d]=null,D(m(void 0,!0))),H[f]=!0}),L.on("readable",y.bind(null,H)),H}}).call(this)}).call(this,t("_process"))},{"./end-of-stream":486,_process:467}],484:[function(t,n,s){function o(p,v){var g=Object.keys(p);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(p);v&&(m=m.filter(function(b){return Object.getOwnPropertyDescriptor(p,b).enumerable})),g.push.apply(g,m)}return g}function i(p){for(var v=1;v<arguments.length;v++){var g=arguments[v]!=null?arguments[v]:{};v%2?o(Object(g),!0).forEach(function(m){c(p,m,g[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(p,Object.getOwnPropertyDescriptors(g)):o(Object(g)).forEach(function(m){Object.defineProperty(p,m,Object.getOwnPropertyDescriptor(g,m))})}return p}function c(p,v,g){return(v=l(v))in p?Object.defineProperty(p,v,{value:g,enumerable:!0,configurable:!0,writable:!0}):p[v]=g,p}function u(p,v){for(var g=0;g<v.length;g++){var m=v[g];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(p,l(m.key),m)}}function l(p){var v=function(g,m){if(typeof g!="object"||g===null)return g;var b=g[Symbol.toPrimitive];if(b!==void 0){var y=b.call(g,m);if(typeof y!="object")return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return(m==="string"?String:Number)(g)}(p,"string");return typeof v=="symbol"?v:String(v)}var d=t("buffer").Buffer,h=t("util").inspect,f=h&&h.custom||"inspect";n.exports=function(){function p(){(function(m,b){if(!(m instanceof b))throw new TypeError("Cannot call a class as a function")})(this,p),this.head=null,this.tail=null,this.length=0}var v,g;return v=p,(g=[{key:"push",value:function(m){var b={data:m,next:null};this.length>0?this.tail.next=b:this.head=b,this.tail=b,++this.length}},{key:"unshift",value:function(m){var b={data:m,next:this.head};this.length===0&&(this.tail=b),this.head=b,++this.length}},{key:"shift",value:function(){if(this.length!==0){var m=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,m}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(m){if(this.length===0)return"";for(var b=this.head,y=""+b.data;b=b.next;)y+=m+b.data;return y}},{key:"concat",value:function(m){if(this.length===0)return d.alloc(0);for(var b,y,S,C=d.allocUnsafe(m>>>0),L=this.head,O=0;L;)b=L.data,y=C,S=O,d.prototype.copy.call(b,y,S),O+=L.data.length,L=L.next;return C}},{key:"consume",value:function(m,b){var y;return m<this.head.data.length?(y=this.head.data.slice(0,m),this.head.data=this.head.data.slice(m)):y=m===this.head.data.length?this.shift():b?this._getString(m):this._getBuffer(m),y}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(m){var b=this.head,y=1,S=b.data;for(m-=S.length;b=b.next;){var C=b.data,L=m>C.length?C.length:m;if(L===C.length?S+=C:S+=C.slice(0,m),(m-=L)==0){L===C.length?(++y,b.next?this.head=b.next:this.head=this.tail=null):(this.head=b,b.data=C.slice(L));break}++y}return this.length-=y,S}},{key:"_getBuffer",value:function(m){var b=d.allocUnsafe(m),y=this.head,S=1;for(y.data.copy(b),m-=y.data.length;y=y.next;){var C=y.data,L=m>C.length?C.length:m;if(C.copy(b,b.length-m,0,L),(m-=L)==0){L===C.length?(++S,y.next?this.head=y.next:this.head=this.tail=null):(this.head=y,y.data=C.slice(L));break}++S}return this.length-=S,b}},{key:f,value:function(m,b){return h(this,i(i({},b),{},{depth:0,customInspect:!1}))}}])&&u(v.prototype,g),Object.defineProperty(v,"prototype",{writable:!1}),p}()},{buffer:220,util:188}],485:[function(t,n,s){(function(o){(function(){function i(l,d){u(l,d),c(l)}function c(l){l._writableState&&!l._writableState.emitClose||l._readableState&&!l._readableState.emitClose||l.emit("close")}function u(l,d){l.emit("error",d)}n.exports={destroy:function(l,d){var h=this,f=this._readableState&&this._readableState.destroyed,p=this._writableState&&this._writableState.destroyed;return f||p?(d?d(l):l&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,o.nextTick(u,this,l)):o.nextTick(u,this,l)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(l||null,function(v){!d&&v?h._writableState?h._writableState.errorEmitted?o.nextTick(c,h):(h._writableState.errorEmitted=!0,o.nextTick(i,h,v)):o.nextTick(i,h,v):d?(o.nextTick(c,h),d(v)):o.nextTick(c,h)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(l,d){var h=l._readableState,f=l._writableState;h&&h.autoDestroy||f&&f.autoDestroy?l.destroy(d):l.emit("error",d)}}}).call(this)}).call(this,t("_process"))},{_process:467}],486:[function(t,n,s){var o=t("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function i(){}n.exports=function c(u,l,d){if(typeof l=="function")return c(u,null,l);l||(l={}),d=function(L){var O=!1;return function(){if(!O){O=!0;for(var H=arguments.length,z=new Array(H),q=0;q<H;q++)z[q]=arguments[q];L.apply(this,z)}}}(d||i);var h=l.readable||l.readable!==!1&&u.readable,f=l.writable||l.writable!==!1&&u.writable,p=function(){u.writable||g()},v=u._writableState&&u._writableState.finished,g=function(){f=!1,v=!0,h||d.call(u)},m=u._readableState&&u._readableState.endEmitted,b=function(){h=!1,m=!0,f||d.call(u)},y=function(L){d.call(u,L)},S=function(){var L;return h&&!m?(u._readableState&&u._readableState.ended||(L=new o),d.call(u,L)):f&&!v?(u._writableState&&u._writableState.ended||(L=new o),d.call(u,L)):void 0},C=function(){u.req.on("finish",g)};return function(L){return L.setHeader&&typeof L.abort=="function"}(u)?(u.on("complete",g),u.on("abort",S),u.req?C():u.on("request",C)):f&&!u._writableState&&(u.on("end",p),u.on("close",p)),u.on("end",b),u.on("finish",g),l.error!==!1&&u.on("error",y),u.on("close",S),function(){u.removeListener("complete",g),u.removeListener("abort",S),u.removeListener("request",C),u.req&&u.req.removeListener("finish",g),u.removeListener("end",p),u.removeListener("close",p),u.removeListener("finish",g),u.removeListener("end",b),u.removeListener("error",y),u.removeListener("close",S)}}},{"../../../errors":477}],487:[function(t,n,s){n.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],488:[function(t,n,s){var o,i=t("../../../errors").codes,c=i.ERR_MISSING_ARGS,u=i.ERR_STREAM_DESTROYED;function l(v){if(v)throw v}function d(v,g,m,b){b=function(C){var L=!1;return function(){L||(L=!0,C.apply(void 0,arguments))}}(b);var y=!1;v.on("close",function(){y=!0}),o===void 0&&(o=t("./end-of-stream")),o(v,{readable:g,writable:m},function(C){if(C)return b(C);y=!0,b()});var S=!1;return function(C){if(!y&&!S)return S=!0,function(L){return L.setHeader&&typeof L.abort=="function"}(v)?v.abort():typeof v.destroy=="function"?v.destroy():void b(C||new u("pipe"))}}function h(v){v()}function f(v,g){return v.pipe(g)}function p(v){return v.length?typeof v[v.length-1]!="function"?l:v.pop():l}n.exports=function(){for(var v=arguments.length,g=new Array(v),m=0;m<v;m++)g[m]=arguments[m];var b,y=p(g);if(Array.isArray(g[0])&&(g=g[0]),g.length<2)throw new c("streams");var S=g.map(function(C,L){var O=L<g.length-1;return d(C,O,L>0,function(H){b||(b=H),H&&S.forEach(h),O||(S.forEach(h),y(b))})});return g.reduce(f)}},{"../../../errors":477,"./end-of-stream":486}],489:[function(t,n,s){var o=t("../../../errors").codes.ERR_INVALID_OPT_VALUE;n.exports={getHighWaterMark:function(i,c,u,l){var d=function(h,f,p){return h.highWaterMark!=null?h.highWaterMark:f?h[p]:null}(c,l,u);if(d!=null){if(!isFinite(d)||Math.floor(d)!==d||d<0)throw new o(l?u:"highWaterMark",d);return Math.floor(d)}return i.objectMode?16:16384}}},{"../../../errors":477}],490:[function(t,n,s){n.exports=t("events").EventEmitter},{events:422}],491:[function(t,n,s){(s=n.exports=t("./lib/_stream_readable.js")).Stream=s,s.Readable=s,s.Writable=t("./lib/_stream_writable.js"),s.Duplex=t("./lib/_stream_duplex.js"),s.Transform=t("./lib/_stream_transform.js"),s.PassThrough=t("./lib/_stream_passthrough.js"),s.finished=t("./lib/internal/streams/end-of-stream.js"),s.pipeline=t("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":478,"./lib/_stream_passthrough.js":479,"./lib/_stream_readable.js":480,"./lib/_stream_transform.js":481,"./lib/_stream_writable.js":482,"./lib/internal/streams/end-of-stream.js":486,"./lib/internal/streams/pipeline.js":488}],492:[function(t,n,s){var o=function(i){var c=Object.prototype,u=c.hasOwnProperty,l=Object.defineProperty||function(j,A,N){j[A]=N.value},d=typeof Symbol=="function"?Symbol:{},h=d.iterator||"@@iterator",f=d.asyncIterator||"@@asyncIterator",p=d.toStringTag||"@@toStringTag";function v(j,A,N){return Object.defineProperty(j,A,{value:N,enumerable:!0,configurable:!0,writable:!0}),j[A]}try{v({},"")}catch{v=function(A,N,V){return A[N]=V}}function g(j,A,N,V){var M=A&&A.prototype instanceof y?A:y,Z=Object.create(M.prototype),J=new k(V||[]);return l(Z,"_invoke",{value:W(j,N,J)}),Z}function m(j,A,N){try{return{type:"normal",arg:j.call(A,N)}}catch(V){return{type:"throw",arg:V}}}i.wrap=g;var b={};function y(){}function S(){}function C(){}var L={};v(L,h,function(){return this});var O=Object.getPrototypeOf,H=O&&O(O(_([])));H&&H!==c&&u.call(H,h)&&(L=H);var z=C.prototype=y.prototype=Object.create(L);function q(j){["next","throw","return"].forEach(function(A){v(j,A,function(N){return this._invoke(A,N)})})}function D(j,A){var N;l(this,"_invoke",{value:function(V,M){function Z(){return new A(function(J,re){(function X(ne,Y,K,ee){var ue=m(j[ne],j,Y);if(ue.type!=="throw"){var se=ue.arg,ce=se.value;return ce&&typeof ce=="object"&&u.call(ce,"__await")?A.resolve(ce.__await).then(function(fe){X("next",fe,K,ee)},function(fe){X("throw",fe,K,ee)}):A.resolve(ce).then(function(fe){se.value=fe,K(se)},function(fe){return X("throw",fe,K,ee)})}ee(ue.arg)})(V,M,J,re)})}return N=N?N.then(Z,Z):Z()}})}function W(j,A,N){var V="suspendedStart";return function(M,Z){if(V==="executing")throw new Error("Generator is already running");if(V==="completed"){if(M==="throw")throw Z;return R()}for(N.method=M,N.arg=Z;;){var J=N.delegate;if(J){var re=P(J,N);if(re){if(re===b)continue;return re}}if(N.method==="next")N.sent=N._sent=N.arg;else if(N.method==="throw"){if(V==="suspendedStart")throw V="completed",N.arg;N.dispatchException(N.arg)}else N.method==="return"&&N.abrupt("return",N.arg);V="executing";var X=m(j,A,N);if(X.type==="normal"){if(V=N.done?"completed":"suspendedYield",X.arg===b)continue;return{value:X.arg,done:N.done}}X.type==="throw"&&(V="completed",N.method="throw",N.arg=X.arg)}}}function P(j,A){var N=A.method,V=j.iterator[N];if(V===void 0)return A.delegate=null,N==="throw"&&j.iterator.return&&(A.method="return",A.arg=void 0,P(j,A),A.method==="throw")||N!=="return"&&(A.method="throw",A.arg=new TypeError("The iterator does not provide a '"+N+"' method")),b;var M=m(V,j.iterator,A.arg);if(M.type==="throw")return A.method="throw",A.arg=M.arg,A.delegate=null,b;var Z=M.arg;return Z?Z.done?(A[j.resultName]=Z.value,A.next=j.nextLoc,A.method!=="return"&&(A.method="next",A.arg=void 0),A.delegate=null,b):Z:(A.method="throw",A.arg=new TypeError("iterator result is not an object"),A.delegate=null,b)}function I(j){var A={tryLoc:j[0]};1 in j&&(A.catchLoc=j[1]),2 in j&&(A.finallyLoc=j[2],A.afterLoc=j[3]),this.tryEntries.push(A)}function U(j){var A=j.completion||{};A.type="normal",delete A.arg,j.completion=A}function k(j){this.tryEntries=[{tryLoc:"root"}],j.forEach(I,this),this.reset(!0)}function _(j){if(j){var A=j[h];if(A)return A.call(j);if(typeof j.next=="function")return j;if(!isNaN(j.length)){var N=-1,V=function M(){for(;++N<j.length;)if(u.call(j,N))return M.value=j[N],M.done=!1,M;return M.value=void 0,M.done=!0,M};return V.next=V}}return{next:R}}function R(){return{value:void 0,done:!0}}return S.prototype=C,l(z,"constructor",{value:C,configurable:!0}),l(C,"constructor",{value:S,configurable:!0}),S.displayName=v(C,p,"GeneratorFunction"),i.isGeneratorFunction=function(j){var A=typeof j=="function"&&j.constructor;return!!A&&(A===S||(A.displayName||A.name)==="GeneratorFunction")},i.mark=function(j){return Object.setPrototypeOf?Object.setPrototypeOf(j,C):(j.__proto__=C,v(j,p,"GeneratorFunction")),j.prototype=Object.create(z),j},i.awrap=function(j){return{__await:j}},q(D.prototype),v(D.prototype,f,function(){return this}),i.AsyncIterator=D,i.async=function(j,A,N,V,M){M===void 0&&(M=Promise);var Z=new D(g(j,A,N,V),M);return i.isGeneratorFunction(A)?Z:Z.next().then(function(J){return J.done?J.value:Z.next()})},q(z),v(z,p,"Generator"),v(z,h,function(){return this}),v(z,"toString",function(){return"[object Generator]"}),i.keys=function(j){var A=Object(j),N=[];for(var V in A)N.push(V);return N.reverse(),function M(){for(;N.length;){var Z=N.pop();if(Z in A)return M.value=Z,M.done=!1,M}return M.done=!0,M}},i.values=_,k.prototype={constructor:k,reset:function(j){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(U),!j)for(var A in this)A.charAt(0)==="t"&&u.call(this,A)&&!isNaN(+A.slice(1))&&(this[A]=void 0)},stop:function(){this.done=!0;var j=this.tryEntries[0].completion;if(j.type==="throw")throw j.arg;return this.rval},dispatchException:function(j){if(this.done)throw j;var A=this;function N(X,ne){return Z.type="throw",Z.arg=j,A.next=X,ne&&(A.method="next",A.arg=void 0),!!ne}for(var V=this.tryEntries.length-1;V>=0;--V){var M=this.tryEntries[V],Z=M.completion;if(M.tryLoc==="root")return N("end");if(M.tryLoc<=this.prev){var J=u.call(M,"catchLoc"),re=u.call(M,"finallyLoc");if(J&&re){if(this.prev<M.catchLoc)return N(M.catchLoc,!0);if(this.prev<M.finallyLoc)return N(M.finallyLoc)}else if(J){if(this.prev<M.catchLoc)return N(M.catchLoc,!0)}else{if(!re)throw new Error("try statement without catch or finally");if(this.prev<M.finallyLoc)return N(M.finallyLoc)}}}},abrupt:function(j,A){for(var N=this.tryEntries.length-1;N>=0;--N){var V=this.tryEntries[N];if(V.tryLoc<=this.prev&&u.call(V,"finallyLoc")&&this.prev<V.finallyLoc){var M=V;break}}M&&(j==="break"||j==="continue")&&M.tryLoc<=A&&A<=M.finallyLoc&&(M=null);var Z=M?M.completion:{};return Z.type=j,Z.arg=A,M?(this.method="next",this.next=M.finallyLoc,b):this.complete(Z)},complete:function(j,A){if(j.type==="throw")throw j.arg;return j.type==="break"||j.type==="continue"?this.next=j.arg:j.type==="return"?(this.rval=this.arg=j.arg,this.method="return",this.next="end"):j.type==="normal"&&A&&(this.next=A),b},finish:function(j){for(var A=this.tryEntries.length-1;A>=0;--A){var N=this.tryEntries[A];if(N.finallyLoc===j)return this.complete(N.completion,N.afterLoc),U(N),b}},catch:function(j){for(var A=this.tryEntries.length-1;A>=0;--A){var N=this.tryEntries[A];if(N.tryLoc===j){var V=N.completion;if(V.type==="throw"){var M=V.arg;U(N)}return M}}throw new Error("illegal catch attempt")},delegateYield:function(j,A,N){return this.delegate={iterator:_(j),resultName:A,nextLoc:N},this.method==="next"&&(this.arg=void 0),b}},i}(typeof n=="object"?n.exports:{});try{regeneratorRuntime=o}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=o:Function("r","regeneratorRuntime = r")(o)}},{}],493:[function(t,n,s){var o=t("buffer").Buffer,i=t("inherits"),c=t("hash-base"),u=new Array(16),l=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],d=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],h=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],f=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],p=[0,1518500249,1859775393,2400959708,2840853838],v=[1352829926,1548603684,1836072691,2053994217,0];function g(){c.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function m(O,H){return O<<H|O>>>32-H}function b(O,H,z,q,D,W,P,I){return m(O+(H^z^q)+W+P|0,I)+D|0}function y(O,H,z,q,D,W,P,I){return m(O+(H&z|~H&q)+W+P|0,I)+D|0}function S(O,H,z,q,D,W,P,I){return m(O+((H|~z)^q)+W+P|0,I)+D|0}function C(O,H,z,q,D,W,P,I){return m(O+(H&q|z&~q)+W+P|0,I)+D|0}function L(O,H,z,q,D,W,P,I){return m(O+(H^(z|~q))+W+P|0,I)+D|0}i(g,c),g.prototype._update=function(){for(var O=u,H=0;H<16;++H)O[H]=this._block.readInt32LE(4*H);for(var z=0|this._a,q=0|this._b,D=0|this._c,W=0|this._d,P=0|this._e,I=0|this._a,U=0|this._b,k=0|this._c,_=0|this._d,R=0|this._e,j=0;j<80;j+=1){var A,N;j<16?(A=b(z,q,D,W,P,O[l[j]],p[0],h[j]),N=L(I,U,k,_,R,O[d[j]],v[0],f[j])):j<32?(A=y(z,q,D,W,P,O[l[j]],p[1],h[j]),N=C(I,U,k,_,R,O[d[j]],v[1],f[j])):j<48?(A=S(z,q,D,W,P,O[l[j]],p[2],h[j]),N=S(I,U,k,_,R,O[d[j]],v[2],f[j])):j<64?(A=C(z,q,D,W,P,O[l[j]],p[3],h[j]),N=y(I,U,k,_,R,O[d[j]],v[3],f[j])):(A=L(z,q,D,W,P,O[l[j]],p[4],h[j]),N=b(I,U,k,_,R,O[d[j]],v[4],f[j])),z=P,P=W,W=m(D,10),D=q,q=A,I=R,R=_,_=m(k,10),k=U,U=N}var V=this._b+D+_|0;this._b=this._c+W+R|0,this._c=this._d+P+I|0,this._d=this._e+z+U|0,this._e=this._a+q+k|0,this._a=V},g.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var O=o.alloc?o.alloc(20):new o(20);return O.writeInt32LE(this._a,0),O.writeInt32LE(this._b,4),O.writeInt32LE(this._c,8),O.writeInt32LE(this._d,12),O.writeInt32LE(this._e,16),O},n.exports=g},{buffer:220,"hash-base":425,inherits:440}],494:[function(t,n,s){/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var o=t("buffer"),i=o.Buffer;function c(l,d){for(var h in l)d[h]=l[h]}function u(l,d,h){return i(l,d,h)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?n.exports=o:(c(o,s),s.Buffer=u),u.prototype=Object.create(i.prototype),c(i,u),u.from=function(l,d,h){if(typeof l=="number")throw new TypeError("Argument must not be a number");return i(l,d,h)},u.alloc=function(l,d,h){if(typeof l!="number")throw new TypeError("Argument must be a number");var f=i(l);return d!==void 0?typeof h=="string"?f.fill(d,h):f.fill(d):f.fill(0),f},u.allocUnsafe=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return i(l)},u.allocUnsafeSlow=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return o.SlowBuffer(l)}},{buffer:220}],495:[function(t,n,s){(function(o){(function(){var i,c=t("buffer"),u=c.Buffer,l={};for(i in c)c.hasOwnProperty(i)&&i!=="SlowBuffer"&&i!=="Buffer"&&(l[i]=c[i]);var d=l.Buffer={};for(i in u)u.hasOwnProperty(i)&&i!=="allocUnsafe"&&i!=="allocUnsafeSlow"&&(d[i]=u[i]);if(l.Buffer.prototype=u.prototype,d.from&&d.from!==Uint8Array.from||(d.from=function(h,f,p){if(typeof h=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+typeof h);if(h&&h.length===void 0)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof h);return u(h,f,p)}),d.alloc||(d.alloc=function(h,f,p){if(typeof h!="number")throw new TypeError('The "size" argument must be of type number. Received type '+typeof h);if(h<0||h>=2*(1<<30))throw new RangeError('The value "'+h+'" is invalid for option "size"');var v=u(h);return f&&f.length!==0?typeof p=="string"?v.fill(f,p):v.fill(f):v.fill(0),v}),!l.kStringMaxLength)try{l.kStringMaxLength=o.binding("buffer").kStringMaxLength}catch{}l.constants||(l.constants={MAX_LENGTH:l.kMaxLength},l.kStringMaxLength&&(l.constants.MAX_STRING_LENGTH=l.kStringMaxLength)),n.exports=l}).call(this)}).call(this,t("_process"))},{_process:467,buffer:220}],496:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0});const o=t("xmlchars/xml/1.0/ed5"),i=t("xmlchars/xml/1.1/ed2"),c=t("xmlchars/xmlns/1.0/ed3");var u=o.isS,l=o.isChar,d=o.isNameStartChar,h=o.isNameChar,f=o.S_LIST,p=o.NAME_RE,v=i.isChar,g=c.isNCNameStartChar,m=c.isNCNameChar,b=c.NC_NAME_RE;const y="http://www.w3.org/XML/1998/namespace",S="http://www.w3.org/2000/xmlns/",C={__proto__:null,xml:y,xmlns:S},L={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},O=_=>_===34||_===39,H=[34,39],z=[...H,91,62],q=[...H,60,93],D=[61,63,...f],W=[...f,62,38,60];function P(_,R,j){switch(R){case"xml":j!==y&&_.fail(`xml prefix must be bound to ${y}.`);break;case"xmlns":j!==S&&_.fail(`xmlns prefix must be bound to ${S}.`)}switch(j){case S:_.fail(R===""?`the default namespace may not be set to ${j}.`:`may not assign a prefix (even "xmlns") to the URI ${S}.`);break;case y:switch(R){case"xml":break;case"":_.fail(`the default namespace may not be set to ${j}.`);break;default:_.fail("may not assign the xml namespace to another prefix.")}}}const I=_=>b.test(_),U=_=>p.test(_);s.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];const k={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"};s.SaxesParser=class{constructor(_){this.opt=_??{},this.fragmentOpt=!!this.opt.fragment;const R=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=this.opt.position!==!1,this.fileName=this.opt.fileName,R){this.nameStartCheck=g,this.nameCheck=m,this.isName=I,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},C);const j=this.opt.additionalNamespaces;j!=null&&(function(A,N){for(const V of Object.keys(N))P(A,V,N[V])}(this,j),Object.assign(this.ns,j))}else this.nameStartCheck=d,this.nameCheck=h,this.isName=U,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}get closed(){return this._closed}_init(){var _;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=0,this.attribList=[];const{fragmentOpt:R}=this;this.state=R?13:0,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=R,this.xmlDeclPossible=!R,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:j}=this.opt;if(j===void 0){if(this.opt.forceXMLVersion===!0)throw new Error("forceXMLVersion set but defaultXMLVersion is not set");j="1.0"}this.setXMLVersion(j),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(L),(_=this.readyHandler)===null||_===void 0||_.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(_,R){this[k[_]]=R}off(_){this[k[_]]=void 0}makeError(_){var R;let j=(R=this.fileName)!==null&&R!==void 0?R:"";return this.trackPosition&&(j.length>0&&(j+=":"),j+=`${this.line}:${this.column}`),j.length>0&&(j+=": "),new Error(j+_)}fail(_){const R=this.makeError(_),j=this.errorHandler;if(j===void 0)throw R;return j(R),this}write(_){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let R=!1;_===null?(R=!0,_=""):typeof _=="object"&&(_=_.toString()),this.carriedFromPrevious!==void 0&&(_=`${this.carriedFromPrevious}${_}`,this.carriedFromPrevious=void 0);let j=_.length;const A=_.charCodeAt(j-1);!R&&(A===13||A>=55296&&A<=56319)&&(this.carriedFromPrevious=_[j-1],j--,_=_.slice(0,j));const{stateTable:N}=this;for(this.chunk=_,this.i=0;this.i<j;)N[this.state].call(this);return this.chunkPosition+=j,R?this.end():this}close(){return this.write(null)}getCode10(){const{chunk:_,i:R}=this;if(this.prevI=R,this.i=R+1,R>=_.length)return-1;const j=_.charCodeAt(R);if(this.column++,j<55296){if(j>=32||j===9)return j;switch(j){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:return _.charCodeAt(R+1)===10&&(this.i=R+2),this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),j}}if(j>56319)return j>=57344&&j<=65533||this.fail("disallowed character."),j;const A=65536+1024*(j-55296)+(_.charCodeAt(R+1)-56320);return this.i=R+2,A>1114111&&this.fail("disallowed character."),A}getCode11(){const{chunk:_,i:R}=this;if(this.prevI=R,this.i=R+1,R>=_.length)return-1;const j=_.charCodeAt(R);if(this.column++,j<55296){if(j>31&&j<127||j>159&&j!==8232||j===9)return j;switch(j){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:{const N=_.charCodeAt(R+1);N!==10&&N!==133||(this.i=R+2)}case 133:case 8232:return this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),j}}if(j>56319)return j>=57344&&j<=65533||this.fail("disallowed character."),j;const A=65536+1024*(j-55296)+(_.charCodeAt(R+1)-56320);return this.i=R+2,A>1114111&&this.fail("disallowed character."),A}getCodeNorm(){const _=this.getCode();return _===-2?10:_}unget(){this.i=this.prevI,this.column--}captureTo(_){let{i:R}=this;const{chunk:j}=this;for(;;){const A=this.getCode(),N=A===-2,V=N?10:A;if(V===-1||_.includes(V))return this.text+=j.slice(R,this.prevI),V;N&&(this.text+=j.slice(R,this.prevI)+`
`,R=this.i)}}captureToChar(_){let{i:R}=this;const{chunk:j}=this;for(;;){let A=this.getCode();switch(A){case-2:this.text+=j.slice(R,this.prevI)+`
`,R=this.i,A=10;break;case-1:return this.text+=j.slice(R),!1}if(A===_)return this.text+=j.slice(R,this.prevI),!0}}captureNameChars(){const{chunk:_,i:R}=this;for(;;){const j=this.getCode();if(j===-1)return this.name+=_.slice(R),-1;if(!h(j))return this.name+=_.slice(R,this.prevI),j===-2?10:j}}skipSpaces(){for(;;){const _=this.getCodeNorm();if(_===-1||!u(_))return _}}setXMLVersion(_){this.currentXMLVersion=_,_==="1.0"?(this.isChar=l,this.getCode=this.getCode10):(this.isChar=v,this.getCode=this.getCode11)}sBegin(){this.chunk.charCodeAt(0)===65279&&(this.i++,this.column++),this.state=1}sBeginWhitespace(){const _=this.i,R=this.skipSpaces();switch(this.prevI!==_&&(this.xmlDeclPossible=!1),R){case 60:if(this.state=15,this.text.length!==0)throw new Error("no-empty text at start");break;case-1:break;default:this.unget(),this.state=13,this.xmlDeclPossible=!1}}sDoctype(){var _;const R=this.captureTo(z);switch(R){case 62:(_=this.doctypeHandler)===null||_===void 0||_.call(this,this.text),this.text="",this.state=13,this.doctype=!0;break;case-1:break;default:this.text+=String.fromCodePoint(R),R===91?this.state=4:O(R)&&(this.state=3,this.q=R)}}sDoctypeQuote(){const _=this.q;this.captureToChar(_)&&(this.text+=String.fromCodePoint(_),this.q=null,this.state=2)}sDTD(){const _=this.captureTo(q);_!==-1&&(this.text+=String.fromCodePoint(_),_===93?this.state=2:_===60?this.state=6:O(_)&&(this.state=5,this.q=_))}sDTDQuoted(){const _=this.q;this.captureToChar(_)&&(this.text+=String.fromCodePoint(_),this.state=4,this.q=null)}sDTDOpenWaka(){const _=this.getCodeNorm();switch(this.text+=String.fromCodePoint(_),_){case 33:this.state=7,this.openWakaBang="";break;case 63:this.state=11;break;default:this.state=4}}sDTDOpenWakaBang(){const _=String.fromCodePoint(this.getCodeNorm()),R=this.openWakaBang+=_;this.text+=_,R!=="-"&&(this.state=R==="--"?8:4,this.openWakaBang="")}sDTDComment(){this.captureToChar(45)&&(this.text+="-",this.state=9)}sDTDCommentEnding(){const _=this.getCodeNorm();this.text+=String.fromCodePoint(_),this.state=_===45?10:8}sDTDCommentEnded(){const _=this.getCodeNorm();this.text+=String.fromCodePoint(_),_===62?this.state=4:(this.fail("malformed comment."),this.state=8)}sDTDPI(){this.captureToChar(63)&&(this.text+="?",this.state=12)}sDTDPIEnding(){const _=this.getCodeNorm();this.text+=String.fromCodePoint(_),_===62&&(this.state=4)}sText(){this.tags.length!==0?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:_}=this;const{chunk:R}=this;e:for(;;)switch(this.getCode()){case-2:this.entity+=R.slice(_,this.prevI)+`
`,_=this.i;break;case 59:{const{entityReturnState:j}=this,A=this.entity+R.slice(_,this.prevI);let N;this.state=j,A===""?(this.fail("empty entity name."),N="&;"):(N=this.parseEntity(A),this.entity=""),j===13&&this.textHandler===void 0||(this.text+=N);break e}case-1:this.entity+=R.slice(_);break e}}sOpenWaka(){const _=this.getCode();if(d(_))this.state=34,this.unget(),this.xmlDeclPossible=!1;else switch(_){case 47:this.state=43,this.xmlDeclPossible=!1;break;case 33:this.state=16,this.openWakaBang="",this.xmlDeclPossible=!1;break;case 63:this.state=23;break;default:this.fail("disallowed character in tag name"),this.state=13,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=20,this.openWakaBang="";break;case"--":this.state=17,this.openWakaBang="";break;case"DOCTYPE":this.state=2,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(45)&&(this.state=18)}sCommentEnding(){var _;const R=this.getCodeNorm();R===45?(this.state=19,(_=this.commentHandler)===null||_===void 0||_.call(this,this.text),this.text=""):(this.text+="-"+String.fromCodePoint(R),this.state=17)}sCommentEnded(){const _=this.getCodeNorm();_!==62?(this.fail("malformed comment."),this.text+="--"+String.fromCodePoint(_),this.state=17):this.state=13}sCData(){this.captureToChar(93)&&(this.state=21)}sCDataEnding(){const _=this.getCodeNorm();_===93?this.state=22:(this.text+="]"+String.fromCodePoint(_),this.state=20)}sCDataEnding2(){var _;const R=this.getCodeNorm();switch(R){case 62:(_=this.cdataHandler)===null||_===void 0||_.call(this,this.text),this.text="",this.state=13;break;case 93:this.text+="]";break;default:this.text+="]]"+String.fromCodePoint(R),this.state=20}}sPIFirstChar(){const _=this.getCodeNorm();this.nameStartCheck(_)?(this.piTarget+=String.fromCodePoint(_),this.state=24):_===63||u(_)?(this.fail("processing instruction without a target."),this.state=_===63?26:25):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(_),this.state=24)}sPIRest(){const{chunk:_,i:R}=this;for(;;){const j=this.getCodeNorm();if(j===-1)return void(this.piTarget+=_.slice(R));if(!this.nameCheck(j)){this.piTarget+=_.slice(R,this.prevI);const A=j===63;A||u(j)?this.piTarget==="xml"?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=A?33:27):this.state=A?26:25:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(j));break}}}sPIBody(){if(this.text.length===0){const _=this.getCodeNorm();_===63?this.state=26:u(_)||(this.text=String.fromCodePoint(_))}else this.captureToChar(63)&&(this.state=26)}sPIEnding(){var _;const R=this.getCodeNorm();if(R===62){const{piTarget:j}=this;j.toLowerCase()==="xml"&&this.fail("the XML declaration must appear at the start of the document."),(_=this.piHandler)===null||_===void 0||_.call(this,{target:j,body:this.text}),this.piTarget=this.text="",this.state=13}else R===63?this.text+="?":(this.text+="?"+String.fromCodePoint(R),this.state=25);this.xmlDeclPossible=!1}sXMLDeclNameStart(){const _=this.skipSpaces();_!==63?_!==-1&&(this.state=28,this.name=String.fromCodePoint(_)):this.state=33}sXMLDeclName(){const _=this.captureTo(D);if(_===63)return this.state=33,this.name+=this.text,this.text="",void this.fail("XML declaration is incomplete.");if(u(_)||_===61){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail("expected one of "+this.xmlDeclExpects.join(", "))}this.state=_===61?30:29}}sXMLDeclEq(){const _=this.getCodeNorm();if(_===63)return this.state=33,void this.fail("XML declaration is incomplete.");u(_)||(_!==61&&this.fail("value required."),this.state=30)}sXMLDeclValueStart(){const _=this.getCodeNorm();if(_===63)return this.state=33,void this.fail("XML declaration is incomplete.");u(_)||(O(_)?this.q=_:(this.fail("value must be quoted."),this.q=32),this.state=31)}sXMLDeclValue(){const _=this.captureTo([this.q,63]);if(_===63)return this.state=33,this.text="",void this.fail("XML declaration is incomplete.");if(_===-1)return;const R=this.text;switch(this.text="",this.name){case"version":{this.xmlDeclExpects=["encoding","standalone"];const j=R;this.xmlDecl.version=j,/^1\.[0-9]+$/.test(j)?this.opt.forceXMLVersion||this.setXMLVersion(j):this.fail("version number must match /^1\\.[0-9]+$/.");break}case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(R)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=R;break;case"standalone":R!=="yes"&&R!=="no"&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=R}this.name="",this.state=32}sXMLDeclSeparator(){const _=this.getCodeNorm();_!==63?(u(_)||(this.fail("whitespace required."),this.unget()),this.state=27):this.state=33}sXMLDeclEnding(){var _;this.getCodeNorm()===62?(this.piTarget!=="xml"?this.fail("processing instructions are not allowed before root."):this.name!=="version"&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),(_=this.xmldeclHandler)===null||_===void 0||_.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=13):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var _;const R=this.captureNameChars();if(R===-1)return;const j=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=j.ns=Object.create(null)),(_=this.openTagStartHandler)===null||_===void 0||_.call(this,j),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),R){case 62:this.openTag();break;case 47:this.state=35;break;default:u(R)||this.fail("disallowed character in tag name."),this.state=36}}sOpenTagSlash(){this.getCode()===62?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=36)}sAttrib(){const _=this.skipSpaces();_!==-1&&(d(_)?(this.unget(),this.state=37):_===62?this.openTag():_===47?this.state=35:this.fail("disallowed character in attribute name."))}sAttribName(){const _=this.captureNameChars();_===61?this.state=39:u(_)?this.state=38:_===62?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):_!==-1&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){const _=this.skipSpaces();switch(_){case-1:return;case 61:this.state=39;break;default:this.fail("attribute without value."),this.text="",this.name="",_===62?this.openTag():d(_)?(this.unget(),this.state=37):(this.fail("disallowed character in attribute name."),this.state=36)}}sAttribValue(){const _=this.getCodeNorm();O(_)?(this.q=_,this.state=40):u(_)||(this.fail("unquoted attribute value."),this.state=42,this.unget())}sAttribValueQuoted(){const{q:_,chunk:R}=this;let{i:j}=this;for(;;)switch(this.getCode()){case _:return this.pushAttrib(this.name,this.text+R.slice(j,this.prevI)),this.name=this.text="",this.q=null,void(this.state=41);case 38:return this.text+=R.slice(j,this.prevI),this.state=14,void(this.entityReturnState=40);case 10:case-2:case 9:this.text+=R.slice(j,this.prevI)+" ",j=this.i;break;case 60:return this.text+=R.slice(j,this.prevI),void this.fail("disallowed character.");case-1:return void(this.text+=R.slice(j))}}sAttribValueClosed(){const _=this.getCodeNorm();u(_)?this.state=36:_===62?this.openTag():_===47?this.state=35:d(_)?(this.fail("no whitespace between attributes."),this.unget(),this.state=37):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){const _=this.captureTo(W);switch(_){case 38:this.state=14,this.entityReturnState=42;break;case 60:this.fail("disallowed character.");break;case-1:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",_===62?this.openTag():this.state=36}}sCloseTag(){const _=this.captureNameChars();_===62?this.closeTag():u(_)?this.state=44:_!==-1&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case 62:this.closeTag();break;case-1:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:_,forbiddenState:R}=this;const{chunk:j,textHandler:A}=this;e:for(;;)switch(this.getCode()){case 60:if(this.state=15,A!==void 0){const{text:N}=this,V=j.slice(_,this.prevI);N.length!==0?(A(N+V),this.text=""):V.length!==0&&A(V)}R=0;break e;case 38:this.state=14,this.entityReturnState=13,A!==void 0&&(this.text+=j.slice(_,this.prevI)),R=0;break e;case 93:switch(R){case 0:R=1;break;case 1:R=2;break;case 2:break;default:throw new Error("impossible state")}break;case 62:R===2&&this.fail('the string "]]>" is disallowed in char data.'),R=0;break;case-2:A!==void 0&&(this.text+=j.slice(_,this.prevI)+`
`),_=this.i,R=0;break;case-1:A!==void 0&&(this.text+=j.slice(_));break e;default:R=0}this.forbiddenState=R}handleTextOutsideRoot(){let{i:_}=this;const{chunk:R,textHandler:j}=this;let A=!1;e:for(;;){const N=this.getCode();switch(N){case 60:if(this.state=15,j!==void 0){const{text:V}=this,M=R.slice(_,this.prevI);V.length!==0?(j(V+M),this.text=""):M.length!==0&&j(M)}break e;case 38:this.state=14,this.entityReturnState=13,j!==void 0&&(this.text+=R.slice(_,this.prevI)),A=!0;break e;case-2:j!==void 0&&(this.text+=R.slice(_,this.prevI)+`
`),_=this.i;break;case-1:j!==void 0&&(this.text+=R.slice(_));break e;default:u(N)||(A=!0)}}A&&(this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(_,R){var j;const{prefix:A,local:N}=this.qname(_),V={name:_,prefix:A,local:N,value:R};if(this.attribList.push(V),(j=this.attributeHandler)===null||j===void 0||j.call(this,V),A==="xmlns"){const M=R.trim();this.currentXMLVersion==="1.0"&&M===""&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[N]=M,P(this,N,M)}else if(_==="xmlns"){const M=R.trim();this.topNS[""]=M,P(this,"",M)}}pushAttribPlain(_,R){var j;const A={name:_,value:R};this.attribList.push(A),(j=this.attributeHandler)===null||j===void 0||j.call(this,A)}end(){var _,R;this.sawRoot||this.fail("document must contain a root element.");const{tags:j}=this;for(;j.length>0;){const N=j.pop();this.fail("unclosed tag: "+N.name)}this.state!==0&&this.state!==13&&this.fail("unexpected end.");const{text:A}=this;return A.length!==0&&((_=this.textHandler)===null||_===void 0||_.call(this,A),this.text=""),this._closed=!0,(R=this.endHandler)===null||R===void 0||R.call(this),this._init(),this}resolve(_){var R,j;let A=this.topNS[_];if(A!==void 0)return A;const{tags:N}=this;for(let V=N.length-1;V>=0;V--)if(A=N[V].ns[_],A!==void 0)return A;return A=this.ns[_],A!==void 0?A:(j=(R=this.opt).resolvePrefix)===null||j===void 0?void 0:j.call(R,_)}qname(_){const R=_.indexOf(":");if(R===-1)return{prefix:"",local:_};const j=_.slice(R+1),A=_.slice(0,R);return(A===""||j===""||j.includes(":"))&&this.fail(`malformed name: ${_}.`),{prefix:A,local:j}}processAttribsNS(){var _;const{attribList:R}=this,j=this.tag;{const{prefix:V,local:M}=this.qname(j.name);j.prefix=V,j.local=M;const Z=j.uri=(_=this.resolve(V))!==null&&_!==void 0?_:"";V!==""&&(V==="xmlns"&&this.fail('tags may not have "xmlns" as prefix.'),Z===""&&(this.fail(`unbound namespace prefix: ${JSON.stringify(V)}.`),j.uri=V))}if(R.length===0)return;const{attributes:A}=j,N=new Set;for(const V of R){const{name:M,prefix:Z,local:J}=V;let re,X;Z===""?(re=M==="xmlns"?S:"",X=M):(re=this.resolve(Z),re===void 0&&(this.fail(`unbound namespace prefix: ${JSON.stringify(Z)}.`),re=Z),X=`{${re}}${J}`),N.has(X)&&this.fail(`duplicate attribute: ${X}.`),N.add(X),V.uri=re,A[M]=V}this.attribList=[]}processAttribsPlain(){const{attribList:_}=this,R=this.tag.attributes;for(const{name:j,value:A}of _)R[j]!==void 0&&this.fail(`duplicate attribute: ${j}.`),R[j]=A;this.attribList=[]}openTag(){var _;this.processAttribs();const{tags:R}=this,j=this.tag;j.isSelfClosing=!1,(_=this.openTagHandler)===null||_===void 0||_.call(this,j),R.push(j),this.state=13,this.name=""}openSelfClosingTag(){var _,R,j;this.processAttribs();const{tags:A}=this,N=this.tag;N.isSelfClosing=!0,(_=this.openTagHandler)===null||_===void 0||_.call(this,N),(R=this.closeTagHandler)===null||R===void 0||R.call(this,N),(this.tag=(j=A[A.length-1])!==null&&j!==void 0?j:null)===null&&(this.closedRoot=!0),this.state=13,this.name=""}closeTag(){const{tags:_,name:R}=this;if(this.state=13,this.name="",R==="")return this.fail("weird empty close tag."),void(this.text+="</>");const j=this.closeTagHandler;let A=_.length;for(;A-- >0;){const N=this.tag=_.pop();if(this.topNS=N.ns,j==null||j(N),N.name===R)break;this.fail("unexpected close tag.")}A===0?this.closedRoot=!0:A<0&&(this.fail(`unmatched closing tag: ${R}.`),this.text+=`</${R}>`)}parseEntity(_){if(_[0]!=="#"){const j=this.ENTITIES[_];return j!==void 0?j:(this.fail(this.isName(_)?"undefined entity.":"disallowed character in entity name."),`&${_};`)}let R=NaN;return _[1]==="x"&&/^#x[0-9a-f]+$/i.test(_)?R=parseInt(_.slice(2),16):/^#[0-9]+$/.test(_)&&(R=parseInt(_.slice(1),10)),this.isChar(R)?String.fromCodePoint(R):(this.fail("malformed character entity."),`&${_};`)}}},{"xmlchars/xml/1.0/ed5":543,"xmlchars/xml/1.1/ed2":544,"xmlchars/xmlns/1.0/ed3":545}],497:[function(t,n,s){var o=t("safe-buffer").Buffer;function i(c,u){this._block=o.alloc(c),this._finalSize=u,this._blockSize=c,this._len=0}i.prototype.update=function(c,u){typeof c=="string"&&(u=u||"utf8",c=o.from(c,u));for(var l=this._block,d=this._blockSize,h=c.length,f=this._len,p=0;p<h;){for(var v=f%d,g=Math.min(h-p,d-v),m=0;m<g;m++)l[v+m]=c[p+m];p+=g,(f+=g)%d==0&&this._update(l)}return this._len+=h,this},i.prototype.digest=function(c){var u=this._len%this._blockSize;this._block[u]=128,this._block.fill(0,u+1),u>=this._finalSize&&(this._update(this._block),this._block.fill(0));var l=8*this._len;if(l<=4294967295)this._block.writeUInt32BE(l,this._blockSize-4);else{var d=(4294967295&l)>>>0,h=(l-d)/4294967296;this._block.writeUInt32BE(h,this._blockSize-8),this._block.writeUInt32BE(d,this._blockSize-4)}this._update(this._block);var f=this._hash();return c?f.toString(c):f},i.prototype._update=function(){throw new Error("_update must be implemented by subclass")},n.exports=i},{"safe-buffer":494}],498:[function(t,n,s){var o=n.exports=function(i){i=i.toLowerCase();var c=o[i];if(!c)throw new Error(i+" is not supported (we accept pull requests)");return new c};o.sha=t("./sha"),o.sha1=t("./sha1"),o.sha224=t("./sha224"),o.sha256=t("./sha256"),o.sha384=t("./sha384"),o.sha512=t("./sha512")},{"./sha":499,"./sha1":500,"./sha224":501,"./sha256":502,"./sha384":503,"./sha512":504}],499:[function(t,n,s){var o=t("inherits"),i=t("./hash"),c=t("safe-buffer").Buffer,u=[1518500249,1859775393,-1894007588,-899497514],l=new Array(80);function d(){this.init(),this._w=l,i.call(this,64,56)}function h(p){return p<<30|p>>>2}function f(p,v,g,m){return p===0?v&g|~v&m:p===2?v&g|v&m|g&m:v^g^m}o(d,i),d.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},d.prototype._update=function(p){for(var v,g=this._w,m=0|this._a,b=0|this._b,y=0|this._c,S=0|this._d,C=0|this._e,L=0;L<16;++L)g[L]=p.readInt32BE(4*L);for(;L<80;++L)g[L]=g[L-3]^g[L-8]^g[L-14]^g[L-16];for(var O=0;O<80;++O){var H=~~(O/20),z=0|((v=m)<<5|v>>>27)+f(H,b,y,S)+C+g[O]+u[H];C=S,S=y,y=h(b),b=m,m=z}this._a=m+this._a|0,this._b=b+this._b|0,this._c=y+this._c|0,this._d=S+this._d|0,this._e=C+this._e|0},d.prototype._hash=function(){var p=c.allocUnsafe(20);return p.writeInt32BE(0|this._a,0),p.writeInt32BE(0|this._b,4),p.writeInt32BE(0|this._c,8),p.writeInt32BE(0|this._d,12),p.writeInt32BE(0|this._e,16),p},n.exports=d},{"./hash":497,inherits:440,"safe-buffer":494}],500:[function(t,n,s){var o=t("inherits"),i=t("./hash"),c=t("safe-buffer").Buffer,u=[1518500249,1859775393,-1894007588,-899497514],l=new Array(80);function d(){this.init(),this._w=l,i.call(this,64,56)}function h(v){return v<<5|v>>>27}function f(v){return v<<30|v>>>2}function p(v,g,m,b){return v===0?g&m|~g&b:v===2?g&m|g&b|m&b:g^m^b}o(d,i),d.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},d.prototype._update=function(v){for(var g,m=this._w,b=0|this._a,y=0|this._b,S=0|this._c,C=0|this._d,L=0|this._e,O=0;O<16;++O)m[O]=v.readInt32BE(4*O);for(;O<80;++O)m[O]=(g=m[O-3]^m[O-8]^m[O-14]^m[O-16])<<1|g>>>31;for(var H=0;H<80;++H){var z=~~(H/20),q=h(b)+p(z,y,S,C)+L+m[H]+u[z]|0;L=C,C=S,S=f(y),y=b,b=q}this._a=b+this._a|0,this._b=y+this._b|0,this._c=S+this._c|0,this._d=C+this._d|0,this._e=L+this._e|0},d.prototype._hash=function(){var v=c.allocUnsafe(20);return v.writeInt32BE(0|this._a,0),v.writeInt32BE(0|this._b,4),v.writeInt32BE(0|this._c,8),v.writeInt32BE(0|this._d,12),v.writeInt32BE(0|this._e,16),v},n.exports=d},{"./hash":497,inherits:440,"safe-buffer":494}],501:[function(t,n,s){var o=t("inherits"),i=t("./sha256"),c=t("./hash"),u=t("safe-buffer").Buffer,l=new Array(64);function d(){this.init(),this._w=l,c.call(this,64,56)}o(d,i),d.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},d.prototype._hash=function(){var h=u.allocUnsafe(28);return h.writeInt32BE(this._a,0),h.writeInt32BE(this._b,4),h.writeInt32BE(this._c,8),h.writeInt32BE(this._d,12),h.writeInt32BE(this._e,16),h.writeInt32BE(this._f,20),h.writeInt32BE(this._g,24),h},n.exports=d},{"./hash":497,"./sha256":502,inherits:440,"safe-buffer":494}],502:[function(t,n,s){var o=t("inherits"),i=t("./hash"),c=t("safe-buffer").Buffer,u=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],l=new Array(64);function d(){this.init(),this._w=l,i.call(this,64,56)}function h(m,b,y){return y^m&(b^y)}function f(m,b,y){return m&b|y&(m|b)}function p(m){return(m>>>2|m<<30)^(m>>>13|m<<19)^(m>>>22|m<<10)}function v(m){return(m>>>6|m<<26)^(m>>>11|m<<21)^(m>>>25|m<<7)}function g(m){return(m>>>7|m<<25)^(m>>>18|m<<14)^m>>>3}o(d,i),d.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},d.prototype._update=function(m){for(var b,y=this._w,S=0|this._a,C=0|this._b,L=0|this._c,O=0|this._d,H=0|this._e,z=0|this._f,q=0|this._g,D=0|this._h,W=0;W<16;++W)y[W]=m.readInt32BE(4*W);for(;W<64;++W)y[W]=0|(((b=y[W-2])>>>17|b<<15)^(b>>>19|b<<13)^b>>>10)+y[W-7]+g(y[W-15])+y[W-16];for(var P=0;P<64;++P){var I=D+v(H)+h(H,z,q)+u[P]+y[P]|0,U=p(S)+f(S,C,L)|0;D=q,q=z,z=H,H=O+I|0,O=L,L=C,C=S,S=I+U|0}this._a=S+this._a|0,this._b=C+this._b|0,this._c=L+this._c|0,this._d=O+this._d|0,this._e=H+this._e|0,this._f=z+this._f|0,this._g=q+this._g|0,this._h=D+this._h|0},d.prototype._hash=function(){var m=c.allocUnsafe(32);return m.writeInt32BE(this._a,0),m.writeInt32BE(this._b,4),m.writeInt32BE(this._c,8),m.writeInt32BE(this._d,12),m.writeInt32BE(this._e,16),m.writeInt32BE(this._f,20),m.writeInt32BE(this._g,24),m.writeInt32BE(this._h,28),m},n.exports=d},{"./hash":497,inherits:440,"safe-buffer":494}],503:[function(t,n,s){var o=t("inherits"),i=t("./sha512"),c=t("./hash"),u=t("safe-buffer").Buffer,l=new Array(160);function d(){this.init(),this._w=l,c.call(this,128,112)}o(d,i),d.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},d.prototype._hash=function(){var h=u.allocUnsafe(48);function f(p,v,g){h.writeInt32BE(p,g),h.writeInt32BE(v,g+4)}return f(this._ah,this._al,0),f(this._bh,this._bl,8),f(this._ch,this._cl,16),f(this._dh,this._dl,24),f(this._eh,this._el,32),f(this._fh,this._fl,40),h},n.exports=d},{"./hash":497,"./sha512":504,inherits:440,"safe-buffer":494}],504:[function(t,n,s){var o=t("inherits"),i=t("./hash"),c=t("safe-buffer").Buffer,u=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],l=new Array(160);function d(){this.init(),this._w=l,i.call(this,128,112)}function h(C,L,O){return O^C&(L^O)}function f(C,L,O){return C&L|O&(C|L)}function p(C,L){return(C>>>28|L<<4)^(L>>>2|C<<30)^(L>>>7|C<<25)}function v(C,L){return(C>>>14|L<<18)^(C>>>18|L<<14)^(L>>>9|C<<23)}function g(C,L){return(C>>>1|L<<31)^(C>>>8|L<<24)^C>>>7}function m(C,L){return(C>>>1|L<<31)^(C>>>8|L<<24)^(C>>>7|L<<25)}function b(C,L){return(C>>>19|L<<13)^(L>>>29|C<<3)^C>>>6}function y(C,L){return(C>>>19|L<<13)^(L>>>29|C<<3)^(C>>>6|L<<26)}function S(C,L){return C>>>0<L>>>0?1:0}o(d,i),d.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},d.prototype._update=function(C){for(var L=this._w,O=0|this._ah,H=0|this._bh,z=0|this._ch,q=0|this._dh,D=0|this._eh,W=0|this._fh,P=0|this._gh,I=0|this._hh,U=0|this._al,k=0|this._bl,_=0|this._cl,R=0|this._dl,j=0|this._el,A=0|this._fl,N=0|this._gl,V=0|this._hl,M=0;M<32;M+=2)L[M]=C.readInt32BE(4*M),L[M+1]=C.readInt32BE(4*M+4);for(;M<160;M+=2){var Z=L[M-30],J=L[M-30+1],re=g(Z,J),X=m(J,Z),ne=b(Z=L[M-4],J=L[M-4+1]),Y=y(J,Z),K=L[M-14],ee=L[M-14+1],ue=L[M-32],se=L[M-32+1],ce=X+ee|0,fe=re+K+S(ce,X)|0;fe=(fe=fe+ne+S(ce=ce+Y|0,Y)|0)+ue+S(ce=ce+se|0,se)|0,L[M]=fe,L[M+1]=ce}for(var ve=0;ve<160;ve+=2){fe=L[ve],ce=L[ve+1];var _e=f(O,H,z),le=f(U,k,_),ke=p(O,U),Te=p(U,O),pe=v(D,j),ye=v(j,D),ge=u[ve],De=u[ve+1],He=h(D,W,P),Xe=h(j,A,N),at=V+ye|0,dt=I+pe+S(at,V)|0;dt=(dt=(dt=dt+He+S(at=at+Xe|0,Xe)|0)+ge+S(at=at+De|0,De)|0)+fe+S(at=at+ce|0,ce)|0;var wt=Te+le|0,$t=ke+_e+S(wt,Te)|0;I=P,V=N,P=W,N=A,W=D,A=j,D=q+dt+S(j=R+at|0,R)|0,q=z,R=_,z=H,_=k,H=O,k=U,O=dt+$t+S(U=at+wt|0,at)|0}this._al=this._al+U|0,this._bl=this._bl+k|0,this._cl=this._cl+_|0,this._dl=this._dl+R|0,this._el=this._el+j|0,this._fl=this._fl+A|0,this._gl=this._gl+N|0,this._hl=this._hl+V|0,this._ah=this._ah+O+S(this._al,U)|0,this._bh=this._bh+H+S(this._bl,k)|0,this._ch=this._ch+z+S(this._cl,_)|0,this._dh=this._dh+q+S(this._dl,R)|0,this._eh=this._eh+D+S(this._el,j)|0,this._fh=this._fh+W+S(this._fl,A)|0,this._gh=this._gh+P+S(this._gl,N)|0,this._hh=this._hh+I+S(this._hl,V)|0},d.prototype._hash=function(){var C=c.allocUnsafe(64);function L(O,H,z){C.writeInt32BE(O,z),C.writeInt32BE(H,z+4)}return L(this._ah,this._al,0),L(this._bh,this._bl,8),L(this._ch,this._cl,16),L(this._dh,this._dl,24),L(this._eh,this._el,32),L(this._fh,this._fl,40),L(this._gh,this._gl,48),L(this._hh,this._hl,56),C},n.exports=d},{"./hash":497,inherits:440,"safe-buffer":494}],505:[function(t,n,s){n.exports=i;var o=t("events").EventEmitter;function i(){o.call(this)}t("inherits")(i,o),i.Readable=t("readable-stream/readable.js"),i.Writable=t("readable-stream/writable.js"),i.Duplex=t("readable-stream/duplex.js"),i.Transform=t("readable-stream/transform.js"),i.PassThrough=t("readable-stream/passthrough.js"),i.Stream=i,i.prototype.pipe=function(c,u){var l=this;function d(b){c.writable&&c.write(b)===!1&&l.pause&&l.pause()}function h(){l.readable&&l.resume&&l.resume()}l.on("data",d),c.on("drain",h),c._isStdio||u&&u.end===!1||(l.on("end",p),l.on("close",v));var f=!1;function p(){f||(f=!0,c.end())}function v(){f||(f=!0,typeof c.destroy=="function"&&c.destroy())}function g(b){if(m(),o.listenerCount(this,"error")===0)throw b}function m(){l.removeListener("data",d),c.removeListener("drain",h),l.removeListener("end",p),l.removeListener("close",v),l.removeListener("error",g),c.removeListener("error",g),l.removeListener("end",m),l.removeListener("close",m),c.removeListener("close",m)}return l.on("error",g),c.on("error",g),l.on("end",m),l.on("close",m),c.on("close",m),c.emit("pipe",l),c}},{events:422,inherits:440,"readable-stream/duplex.js":507,"readable-stream/passthrough.js":516,"readable-stream/readable.js":517,"readable-stream/transform.js":518,"readable-stream/writable.js":519}],506:[function(t,n,s){var o={}.toString;n.exports=Array.isArray||function(i){return o.call(i)=="[object Array]"}},{}],507:[function(t,n,s){n.exports=t("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":508}],508:[function(t,n,s){var o=t("process-nextick-args"),i=Object.keys||function(m){var b=[];for(var y in m)b.push(y);return b};n.exports=p;var c=Object.create(t("core-util-is"));c.inherits=t("inherits");var u=t("./_stream_readable"),l=t("./_stream_writable");c.inherits(p,u);for(var d=i(l.prototype),h=0;h<d.length;h++){var f=d[h];p.prototype[f]||(p.prototype[f]=l.prototype[f])}function p(m){if(!(this instanceof p))return new p(m);u.call(this,m),l.call(this,m),m&&m.readable===!1&&(this.readable=!1),m&&m.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,m&&m.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",v)}function v(){this.allowHalfOpen||this._writableState.ended||o.nextTick(g,this)}function g(m){m.end()}Object.defineProperty(p.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(p.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(m){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=m,this._writableState.destroyed=m)}}),p.prototype._destroy=function(m,b){this.push(null),this.end(),o.nextTick(b,m)}},{"./_stream_readable":510,"./_stream_writable":512,"core-util-is":383,inherits:440,"process-nextick-args":466}],509:[function(t,n,s){n.exports=c;var o=t("./_stream_transform"),i=Object.create(t("core-util-is"));function c(u){if(!(this instanceof c))return new c(u);o.call(this,u)}i.inherits=t("inherits"),i.inherits(c,o),c.prototype._transform=function(u,l,d){d(null,u)}},{"./_stream_transform":511,"core-util-is":383,inherits:440}],510:[function(t,n,s){(function(o,i){(function(){var c=t("process-nextick-args");n.exports=O;var u,l=t("isarray");O.ReadableState=L,t("events").EventEmitter;var d=function(V,M){return V.listeners(M).length},h=t("./internal/streams/stream"),f=t("safe-buffer").Buffer,p=(i!==void 0?i:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},v=Object.create(t("core-util-is"));v.inherits=t("inherits");var g=t("util"),m=void 0;m=g&&g.debuglog?g.debuglog("stream"):function(){};var b,y=t("./internal/streams/BufferList"),S=t("./internal/streams/destroy");v.inherits(O,h);var C=["error","close","destroy","pause","resume"];function L(V,M){V=V||{};var Z=M instanceof(u=u||t("./_stream_duplex"));this.objectMode=!!V.objectMode,Z&&(this.objectMode=this.objectMode||!!V.readableObjectMode);var J=V.highWaterMark,re=V.readableHighWaterMark,X=this.objectMode?16:16384;this.highWaterMark=J||J===0?J:Z&&(re||re===0)?re:X,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new y,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=V.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,V.encoding&&(b||(b=t("string_decoder/").StringDecoder),this.decoder=new b(V.encoding),this.encoding=V.encoding)}function O(V){if(u=u||t("./_stream_duplex"),!(this instanceof O))return new O(V);this._readableState=new L(V,this),this.readable=!0,V&&(typeof V.read=="function"&&(this._read=V.read),typeof V.destroy=="function"&&(this._destroy=V.destroy)),h.call(this)}function H(V,M,Z,J,re){var X,ne=V._readableState;return M===null?(ne.reading=!1,function(Y,K){if(!K.ended){if(K.decoder){var ee=K.decoder.end();ee&&ee.length&&(K.buffer.push(ee),K.length+=K.objectMode?1:ee.length)}K.ended=!0,D(Y)}}(V,ne)):(re||(X=function(Y,K){var ee;ue=K,f.isBuffer(ue)||ue instanceof p||typeof K=="string"||K===void 0||Y.objectMode||(ee=new TypeError("Invalid non-string/buffer chunk"));var ue;return ee}(ne,M)),X?V.emit("error",X):ne.objectMode||M&&M.length>0?(typeof M=="string"||ne.objectMode||Object.getPrototypeOf(M)===f.prototype||(M=function(Y){return f.from(Y)}(M)),J?ne.endEmitted?V.emit("error",new Error("stream.unshift() after end event")):z(V,ne,M,!0):ne.ended?V.emit("error",new Error("stream.push() after EOF")):(ne.reading=!1,ne.decoder&&!Z?(M=ne.decoder.write(M),ne.objectMode||M.length!==0?z(V,ne,M,!1):P(V,ne)):z(V,ne,M,!1))):J||(ne.reading=!1)),function(Y){return!Y.ended&&(Y.needReadable||Y.length<Y.highWaterMark||Y.length===0)}(ne)}function z(V,M,Z,J){M.flowing&&M.length===0&&!M.sync?(V.emit("data",Z),V.read(0)):(M.length+=M.objectMode?1:Z.length,J?M.buffer.unshift(Z):M.buffer.push(Z),M.needReadable&&D(V)),P(V,M)}Object.defineProperty(O.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(V){this._readableState&&(this._readableState.destroyed=V)}}),O.prototype.destroy=S.destroy,O.prototype._undestroy=S.undestroy,O.prototype._destroy=function(V,M){this.push(null),M(V)},O.prototype.push=function(V,M){var Z,J=this._readableState;return J.objectMode?Z=!0:typeof V=="string"&&((M=M||J.defaultEncoding)!==J.encoding&&(V=f.from(V,M),M=""),Z=!0),H(this,V,M,!1,Z)},O.prototype.unshift=function(V){return H(this,V,null,!0,!1)},O.prototype.isPaused=function(){return this._readableState.flowing===!1},O.prototype.setEncoding=function(V){return b||(b=t("string_decoder/").StringDecoder),this._readableState.decoder=new b(V),this._readableState.encoding=V,this};function q(V,M){return V<=0||M.length===0&&M.ended?0:M.objectMode?1:V!=V?M.flowing&&M.length?M.buffer.head.data.length:M.length:(V>M.highWaterMark&&(M.highWaterMark=function(Z){return Z>=8388608?Z=8388608:(Z--,Z|=Z>>>1,Z|=Z>>>2,Z|=Z>>>4,Z|=Z>>>8,Z|=Z>>>16,Z++),Z}(V)),V<=M.length?V:M.ended?M.length:(M.needReadable=!0,0))}function D(V){var M=V._readableState;M.needReadable=!1,M.emittedReadable||(m("emitReadable",M.flowing),M.emittedReadable=!0,M.sync?c.nextTick(W,V):W(V))}function W(V){m("emit readable"),V.emit("readable"),_(V)}function P(V,M){M.readingMore||(M.readingMore=!0,c.nextTick(I,V,M))}function I(V,M){for(var Z=M.length;!M.reading&&!M.flowing&&!M.ended&&M.length<M.highWaterMark&&(m("maybeReadMore read 0"),V.read(0),Z!==M.length);)Z=M.length;M.readingMore=!1}function U(V){m("readable nexttick read 0"),V.read(0)}function k(V,M){M.reading||(m("resume read 0"),V.read(0)),M.resumeScheduled=!1,M.awaitDrain=0,V.emit("resume"),_(V),M.flowing&&!M.reading&&V.read(0)}function _(V){var M=V._readableState;for(m("flow",M.flowing);M.flowing&&V.read()!==null;);}function R(V,M){return M.length===0?null:(M.objectMode?Z=M.buffer.shift():!V||V>=M.length?(Z=M.decoder?M.buffer.join(""):M.buffer.length===1?M.buffer.head.data:M.buffer.concat(M.length),M.buffer.clear()):Z=function(J,re,X){var ne;return J<re.head.data.length?(ne=re.head.data.slice(0,J),re.head.data=re.head.data.slice(J)):ne=J===re.head.data.length?re.shift():X?function(Y,K){var ee=K.head,ue=1,se=ee.data;for(Y-=se.length;ee=ee.next;){var ce=ee.data,fe=Y>ce.length?ce.length:Y;if(fe===ce.length?se+=ce:se+=ce.slice(0,Y),(Y-=fe)===0){fe===ce.length?(++ue,ee.next?K.head=ee.next:K.head=K.tail=null):(K.head=ee,ee.data=ce.slice(fe));break}++ue}return K.length-=ue,se}(J,re):function(Y,K){var ee=f.allocUnsafe(Y),ue=K.head,se=1;for(ue.data.copy(ee),Y-=ue.data.length;ue=ue.next;){var ce=ue.data,fe=Y>ce.length?ce.length:Y;if(ce.copy(ee,ee.length-Y,0,fe),(Y-=fe)===0){fe===ce.length?(++se,ue.next?K.head=ue.next:K.head=K.tail=null):(K.head=ue,ue.data=ce.slice(fe));break}++se}return K.length-=se,ee}(J,re),ne}(V,M.buffer,M.decoder),Z);var Z}function j(V){var M=V._readableState;if(M.length>0)throw new Error('"endReadable()" called on non-empty stream');M.endEmitted||(M.ended=!0,c.nextTick(A,M,V))}function A(V,M){V.endEmitted||V.length!==0||(V.endEmitted=!0,M.readable=!1,M.emit("end"))}function N(V,M){for(var Z=0,J=V.length;Z<J;Z++)if(V[Z]===M)return Z;return-1}O.prototype.read=function(V){m("read",V),V=parseInt(V,10);var M=this._readableState,Z=V;if(V!==0&&(M.emittedReadable=!1),V===0&&M.needReadable&&(M.length>=M.highWaterMark||M.ended))return m("read: emitReadable",M.length,M.ended),M.length===0&&M.ended?j(this):D(this),null;if((V=q(V,M))===0&&M.ended)return M.length===0&&j(this),null;var J,re=M.needReadable;return m("need readable",re),(M.length===0||M.length-V<M.highWaterMark)&&m("length less than watermark",re=!0),M.ended||M.reading?m("reading or ended",re=!1):re&&(m("do read"),M.reading=!0,M.sync=!0,M.length===0&&(M.needReadable=!0),this._read(M.highWaterMark),M.sync=!1,M.reading||(V=q(Z,M))),(J=V>0?R(V,M):null)===null?(M.needReadable=!0,V=0):M.length-=V,M.length===0&&(M.ended||(M.needReadable=!0),Z!==V&&M.ended&&j(this)),J!==null&&this.emit("data",J),J},O.prototype._read=function(V){this.emit("error",new Error("_read() is not implemented"))},O.prototype.pipe=function(V,M){var Z=this,J=this._readableState;switch(J.pipesCount){case 0:J.pipes=V;break;case 1:J.pipes=[J.pipes,V];break;default:J.pipes.push(V)}J.pipesCount+=1,m("pipe count=%d opts=%j",J.pipesCount,M);var re=(!M||M.end!==!1)&&V!==o.stdout&&V!==o.stderr?ne:ve;function X(_e,le){m("onunpipe"),_e===Z&&le&&le.hasUnpiped===!1&&(le.hasUnpiped=!0,m("cleanup"),V.removeListener("close",ce),V.removeListener("finish",fe),V.removeListener("drain",Y),V.removeListener("error",se),V.removeListener("unpipe",X),Z.removeListener("end",ne),Z.removeListener("end",ve),Z.removeListener("data",ue),K=!0,!J.awaitDrain||V._writableState&&!V._writableState.needDrain||Y())}function ne(){m("onend"),V.end()}J.endEmitted?c.nextTick(re):Z.once("end",re),V.on("unpipe",X);var Y=function(_e){return function(){var le=_e._readableState;m("pipeOnDrain",le.awaitDrain),le.awaitDrain&&le.awaitDrain--,le.awaitDrain===0&&d(_e,"data")&&(le.flowing=!0,_(_e))}}(Z);V.on("drain",Y);var K=!1,ee=!1;function ue(_e){m("ondata"),ee=!1,V.write(_e)!==!1||ee||((J.pipesCount===1&&J.pipes===V||J.pipesCount>1&&N(J.pipes,V)!==-1)&&!K&&(m("false write response, pause",J.awaitDrain),J.awaitDrain++,ee=!0),Z.pause())}function se(_e){m("onerror",_e),ve(),V.removeListener("error",se),d(V,"error")===0&&V.emit("error",_e)}function ce(){V.removeListener("finish",fe),ve()}function fe(){m("onfinish"),V.removeListener("close",ce),ve()}function ve(){m("unpipe"),Z.unpipe(V)}return Z.on("data",ue),function(_e,le,ke){if(typeof _e.prependListener=="function")return _e.prependListener(le,ke);_e._events&&_e._events[le]?l(_e._events[le])?_e._events[le].unshift(ke):_e._events[le]=[ke,_e._events[le]]:_e.on(le,ke)}(V,"error",se),V.once("close",ce),V.once("finish",fe),V.emit("pipe",Z),J.flowing||(m("pipe resume"),Z.resume()),V},O.prototype.unpipe=function(V){var M=this._readableState,Z={hasUnpiped:!1};if(M.pipesCount===0)return this;if(M.pipesCount===1)return V&&V!==M.pipes||(V||(V=M.pipes),M.pipes=null,M.pipesCount=0,M.flowing=!1,V&&V.emit("unpipe",this,Z)),this;if(!V){var J=M.pipes,re=M.pipesCount;M.pipes=null,M.pipesCount=0,M.flowing=!1;for(var X=0;X<re;X++)J[X].emit("unpipe",this,{hasUnpiped:!1});return this}var ne=N(M.pipes,V);return ne===-1||(M.pipes.splice(ne,1),M.pipesCount-=1,M.pipesCount===1&&(M.pipes=M.pipes[0]),V.emit("unpipe",this,Z)),this},O.prototype.on=function(V,M){var Z=h.prototype.on.call(this,V,M);if(V==="data")this._readableState.flowing!==!1&&this.resume();else if(V==="readable"){var J=this._readableState;J.endEmitted||J.readableListening||(J.readableListening=J.needReadable=!0,J.emittedReadable=!1,J.reading?J.length&&D(this):c.nextTick(U,this))}return Z},O.prototype.addListener=O.prototype.on,O.prototype.resume=function(){var V=this._readableState;return V.flowing||(m("resume"),V.flowing=!0,function(M,Z){Z.resumeScheduled||(Z.resumeScheduled=!0,c.nextTick(k,M,Z))}(this,V)),this},O.prototype.pause=function(){return m("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(m("pause"),this._readableState.flowing=!1,this.emit("pause")),this},O.prototype.wrap=function(V){var M=this,Z=this._readableState,J=!1;for(var re in V.on("end",function(){if(m("wrapped end"),Z.decoder&&!Z.ended){var ne=Z.decoder.end();ne&&ne.length&&M.push(ne)}M.push(null)}),V.on("data",function(ne){m("wrapped data"),Z.decoder&&(ne=Z.decoder.write(ne)),Z.objectMode&&ne==null||(Z.objectMode||ne&&ne.length)&&(M.push(ne)||(J=!0,V.pause()))}),V)this[re]===void 0&&typeof V[re]=="function"&&(this[re]=function(ne){return function(){return V[ne].apply(V,arguments)}}(re));for(var X=0;X<C.length;X++)V.on(C[X],this.emit.bind(this,C[X]));return this._read=function(ne){m("wrapped _read",ne),J&&(J=!1,V.resume())},this},Object.defineProperty(O.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),O._fromList=R}).call(this)}).call(this,t("_process"),typeof Kn<"u"?Kn:typeof self<"u"?self:typeof window<"u"?window:{})},{"./_stream_duplex":508,"./internal/streams/BufferList":513,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,events:422,inherits:440,isarray:506,"process-nextick-args":466,"safe-buffer":520,"string_decoder/":521,util:188}],511:[function(t,n,s){n.exports=u;var o=t("./_stream_duplex"),i=Object.create(t("core-util-is"));function c(h,f){var p=this._transformState;p.transforming=!1;var v=p.writecb;if(!v)return this.emit("error",new Error("write callback called multiple times"));p.writechunk=null,p.writecb=null,f!=null&&this.push(f),v(h);var g=this._readableState;g.reading=!1,(g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}function u(h){if(!(this instanceof u))return new u(h);o.call(this,h),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,h&&(typeof h.transform=="function"&&(this._transform=h.transform),typeof h.flush=="function"&&(this._flush=h.flush)),this.on("prefinish",l)}function l(){var h=this;typeof this._flush=="function"?this._flush(function(f,p){d(h,f,p)}):d(this,null,null)}function d(h,f,p){if(f)return h.emit("error",f);if(p!=null&&h.push(p),h._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(h._transformState.transforming)throw new Error("Calling transform done when still transforming");return h.push(null)}i.inherits=t("inherits"),i.inherits(u,o),u.prototype.push=function(h,f){return this._transformState.needTransform=!1,o.prototype.push.call(this,h,f)},u.prototype._transform=function(h,f,p){throw new Error("_transform() is not implemented")},u.prototype._write=function(h,f,p){var v=this._transformState;if(v.writecb=p,v.writechunk=h,v.writeencoding=f,!v.transforming){var g=this._readableState;(v.needTransform||g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}},u.prototype._read=function(h){var f=this._transformState;f.writechunk!==null&&f.writecb&&!f.transforming?(f.transforming=!0,this._transform(f.writechunk,f.writeencoding,f.afterTransform)):f.needTransform=!0},u.prototype._destroy=function(h,f){var p=this;o.prototype._destroy.call(this,h,function(v){f(v),p.emit("close")})}},{"./_stream_duplex":508,"core-util-is":383,inherits:440}],512:[function(t,n,s){(function(o,i,c){(function(){var u=t("process-nextick-args");function l(P){var I=this;this.next=null,this.entry=null,this.finish=function(){(function(U,k,_){var R=U.entry;for(U.entry=null;R;){var j=R.callback;k.pendingcb--,j(_),R=R.next}k.corkedRequestsFree.next=U})(I,P)}}n.exports=L;var d,h=!o.browser&&["v0.10","v0.9."].indexOf(o.version.slice(0,5))>-1?c:u.nextTick;L.WritableState=C;var f=Object.create(t("core-util-is"));f.inherits=t("inherits");var p={deprecate:t("util-deprecate")},v=t("./internal/streams/stream"),g=t("safe-buffer").Buffer,m=(i!==void 0?i:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},b,y=t("./internal/streams/destroy");function S(){}function C(P,I){d=d||t("./_stream_duplex"),P=P||{};var U=I instanceof d;this.objectMode=!!P.objectMode,U&&(this.objectMode=this.objectMode||!!P.writableObjectMode);var k=P.highWaterMark,_=P.writableHighWaterMark,R=this.objectMode?16:16384;this.highWaterMark=k||k===0?k:U&&(_||_===0)?_:R,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var j=P.decodeStrings===!1;this.decodeStrings=!j,this.defaultEncoding=P.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(A){(function(N,V){var M=N._writableState,Z=M.sync,J=M.writecb;if(function(X){X.writing=!1,X.writecb=null,X.length-=X.writelen,X.writelen=0}(M),V)(function(X,ne,Y,K,ee){--ne.pendingcb,Y?(u.nextTick(ee,K),u.nextTick(W,X,ne),X._writableState.errorEmitted=!0,X.emit("error",K)):(ee(K),X._writableState.errorEmitted=!0,X.emit("error",K),W(X,ne))})(N,M,Z,V,J);else{var re=q(M);re||M.corked||M.bufferProcessing||!M.bufferedRequest||z(N,M),Z?h(H,N,M,re,J):H(N,M,re,J)}})(I,A)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new l(this)}function L(P){if(d=d||t("./_stream_duplex"),!(b.call(L,this)||this instanceof d))return new L(P);this._writableState=new C(P,this),this.writable=!0,P&&(typeof P.write=="function"&&(this._write=P.write),typeof P.writev=="function"&&(this._writev=P.writev),typeof P.destroy=="function"&&(this._destroy=P.destroy),typeof P.final=="function"&&(this._final=P.final)),v.call(this)}function O(P,I,U,k,_,R,j){I.writelen=k,I.writecb=j,I.writing=!0,I.sync=!0,U?P._writev(_,I.onwrite):P._write(_,R,I.onwrite),I.sync=!1}function H(P,I,U,k){U||function(_,R){R.length===0&&R.needDrain&&(R.needDrain=!1,_.emit("drain"))}(P,I),I.pendingcb--,k(),W(P,I)}function z(P,I){I.bufferProcessing=!0;var U=I.bufferedRequest;if(P._writev&&U&&U.next){var k=I.bufferedRequestCount,_=new Array(k),R=I.corkedRequestsFree;R.entry=U;for(var j=0,A=!0;U;)_[j]=U,U.isBuf||(A=!1),U=U.next,j+=1;_.allBuffers=A,O(P,I,!0,I.length,_,"",R.finish),I.pendingcb++,I.lastBufferedRequest=null,R.next?(I.corkedRequestsFree=R.next,R.next=null):I.corkedRequestsFree=new l(I),I.bufferedRequestCount=0}else{for(;U;){var N=U.chunk,V=U.encoding,M=U.callback;if(O(P,I,!1,I.objectMode?1:N.length,N,V,M),U=U.next,I.bufferedRequestCount--,I.writing)break}U===null&&(I.lastBufferedRequest=null)}I.bufferedRequest=U,I.bufferProcessing=!1}function q(P){return P.ending&&P.length===0&&P.bufferedRequest===null&&!P.finished&&!P.writing}function D(P,I){P._final(function(U){I.pendingcb--,U&&P.emit("error",U),I.prefinished=!0,P.emit("prefinish"),W(P,I)})}function W(P,I){var U=q(I);return U&&(function(k,_){_.prefinished||_.finalCalled||(typeof k._final=="function"?(_.pendingcb++,_.finalCalled=!0,u.nextTick(D,k,_)):(_.prefinished=!0,k.emit("prefinish")))}(P,I),I.pendingcb===0&&(I.finished=!0,P.emit("finish"))),U}f.inherits(L,v),C.prototype.getBuffer=function(){for(var P=this.bufferedRequest,I=[];P;)I.push(P),P=P.next;return I},function(){try{Object.defineProperty(C.prototype,"buffer",{get:p.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(b=Function.prototype[Symbol.hasInstance],Object.defineProperty(L,Symbol.hasInstance,{value:function(P){return!!b.call(this,P)||this===L&&P&&P._writableState instanceof C}})):b=function(P){return P instanceof this},L.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},L.prototype.write=function(P,I,U){var k,_=this._writableState,R=!1,j=!_.objectMode&&(k=P,g.isBuffer(k)||k instanceof m);return j&&!g.isBuffer(P)&&(P=function(A){return g.from(A)}(P)),typeof I=="function"&&(U=I,I=null),j?I="buffer":I||(I=_.defaultEncoding),typeof U!="function"&&(U=S),_.ended?function(A,N){var V=new Error("write after end");A.emit("error",V),u.nextTick(N,V)}(this,U):(j||function(A,N,V,M){var Z=!0,J=!1;return V===null?J=new TypeError("May not write null values to stream"):typeof V=="string"||V===void 0||N.objectMode||(J=new TypeError("Invalid non-string/buffer chunk")),J&&(A.emit("error",J),u.nextTick(M,J),Z=!1),Z}(this,_,P,U))&&(_.pendingcb++,R=function(A,N,V,M,Z,J){if(!V){var re=function(K,ee,ue){return K.objectMode||K.decodeStrings===!1||typeof ee!="string"||(ee=g.from(ee,ue)),ee}(N,M,Z);M!==re&&(V=!0,Z="buffer",M=re)}var X=N.objectMode?1:M.length;N.length+=X;var ne=N.length<N.highWaterMark;if(ne||(N.needDrain=!0),N.writing||N.corked){var Y=N.lastBufferedRequest;N.lastBufferedRequest={chunk:M,encoding:Z,isBuf:V,callback:J,next:null},Y?Y.next=N.lastBufferedRequest:N.bufferedRequest=N.lastBufferedRequest,N.bufferedRequestCount+=1}else O(A,N,!1,X,M,Z,J);return ne}(this,_,j,P,I,U)),R},L.prototype.cork=function(){this._writableState.corked++},L.prototype.uncork=function(){var P=this._writableState;P.corked&&(P.corked--,P.writing||P.corked||P.bufferProcessing||!P.bufferedRequest||z(this,P))},L.prototype.setDefaultEncoding=function(P){if(typeof P=="string"&&(P=P.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((P+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+P);return this._writableState.defaultEncoding=P,this},Object.defineProperty(L.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),L.prototype._write=function(P,I,U){U(new Error("_write() is not implemented"))},L.prototype._writev=null,L.prototype.end=function(P,I,U){var k=this._writableState;typeof P=="function"?(U=P,P=null,I=null):typeof I=="function"&&(U=I,I=null),P!=null&&this.write(P,I),k.corked&&(k.corked=1,this.uncork()),k.ending||function(_,R,j){R.ending=!0,W(_,R),j&&(R.finished?u.nextTick(j):_.once("finish",j)),R.ended=!0,_.writable=!1}(this,k,U)},Object.defineProperty(L.prototype,"destroyed",{get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(P){this._writableState&&(this._writableState.destroyed=P)}}),L.prototype.destroy=y.destroy,L.prototype._undestroy=y.undestroy,L.prototype._destroy=function(P,I){this.end(),I(P)}}).call(this)}).call(this,t("_process"),typeof Kn<"u"?Kn:typeof self<"u"?self:typeof window<"u"?window:{},t("timers").setImmediate)},{"./_stream_duplex":508,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,inherits:440,"process-nextick-args":466,"safe-buffer":520,timers:523,"util-deprecate":524}],513:[function(t,n,s){var o=t("safe-buffer").Buffer,i=t("util");n.exports=function(){function c(){(function(u,l){if(!(u instanceof l))throw new TypeError("Cannot call a class as a function")})(this,c),this.head=null,this.tail=null,this.length=0}return c.prototype.push=function(u){var l={data:u,next:null};this.length>0?this.tail.next=l:this.head=l,this.tail=l,++this.length},c.prototype.unshift=function(u){var l={data:u,next:this.head};this.length===0&&(this.tail=l),this.head=l,++this.length},c.prototype.shift=function(){if(this.length!==0){var u=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,u}},c.prototype.clear=function(){this.head=this.tail=null,this.length=0},c.prototype.join=function(u){if(this.length===0)return"";for(var l=this.head,d=""+l.data;l=l.next;)d+=u+l.data;return d},c.prototype.concat=function(u){if(this.length===0)return o.alloc(0);for(var l,d,h,f=o.allocUnsafe(u>>>0),p=this.head,v=0;p;)l=p.data,d=f,h=v,l.copy(d,h),v+=p.data.length,p=p.next;return f},c}(),i&&i.inspect&&i.inspect.custom&&(n.exports.prototype[i.inspect.custom]=function(){var c=i.inspect({length:this.length});return this.constructor.name+" "+c})},{"safe-buffer":520,util:188}],514:[function(t,n,s){var o=t("process-nextick-args");function i(c,u){c.emit("error",u)}n.exports={destroy:function(c,u){var l=this,d=this._readableState&&this._readableState.destroyed,h=this._writableState&&this._writableState.destroyed;return d||h?(u?u(c):c&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,o.nextTick(i,this,c)):o.nextTick(i,this,c)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(c||null,function(f){!u&&f?l._writableState?l._writableState.errorEmitted||(l._writableState.errorEmitted=!0,o.nextTick(i,l,f)):o.nextTick(i,l,f):u&&u(f)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":466}],515:[function(t,n,s){arguments[4][490][0].apply(s,arguments)},{dup:490,events:422}],516:[function(t,n,s){n.exports=t("./readable").PassThrough},{"./readable":517}],517:[function(t,n,s){(s=n.exports=t("./lib/_stream_readable.js")).Stream=s,s.Readable=s,s.Writable=t("./lib/_stream_writable.js"),s.Duplex=t("./lib/_stream_duplex.js"),s.Transform=t("./lib/_stream_transform.js"),s.PassThrough=t("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":508,"./lib/_stream_passthrough.js":509,"./lib/_stream_readable.js":510,"./lib/_stream_transform.js":511,"./lib/_stream_writable.js":512}],518:[function(t,n,s){n.exports=t("./readable").Transform},{"./readable":517}],519:[function(t,n,s){n.exports=t("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":512}],520:[function(t,n,s){arguments[4][217][0].apply(s,arguments)},{buffer:220,dup:217}],521:[function(t,n,s){arguments[4][218][0].apply(s,arguments)},{dup:218,"safe-buffer":520}],522:[function(t,n,s){arguments[4][218][0].apply(s,arguments)},{dup:218,"safe-buffer":494}],523:[function(t,n,s){(function(o,i){(function(){var c=t("process/browser.js").nextTick,u=Function.prototype.apply,l=Array.prototype.slice,d={},h=0;function f(p,v){this._id=p,this._clearFn=v}s.setTimeout=function(){return new f(u.call(setTimeout,window,arguments),clearTimeout)},s.setInterval=function(){return new f(u.call(setInterval,window,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(p){p.close()},f.prototype.unref=f.prototype.ref=function(){},f.prototype.close=function(){this._clearFn.call(window,this._id)},s.enroll=function(p,v){clearTimeout(p._idleTimeoutId),p._idleTimeout=v},s.unenroll=function(p){clearTimeout(p._idleTimeoutId),p._idleTimeout=-1},s._unrefActive=s.active=function(p){clearTimeout(p._idleTimeoutId);var v=p._idleTimeout;v>=0&&(p._idleTimeoutId=setTimeout(function(){p._onTimeout&&p._onTimeout()},v))},s.setImmediate=typeof o=="function"?o:function(p){var v=h++,g=!(arguments.length<2)&&l.call(arguments,1);return d[v]=!0,c(function(){d[v]&&(g?p.apply(null,g):p.call(null),s.clearImmediate(v))}),v},s.clearImmediate=typeof i=="function"?i:function(p){delete d[p]}}).call(this)}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":467,timers:523}],524:[function(t,n,s){(function(o){(function(){function i(c){try{if(!o.localStorage)return!1}catch{return!1}var u=o.localStorage[c];return u!=null&&String(u).toLowerCase()==="true"}n.exports=function(c,u){if(i("noDeprecation"))return c;var l=!1;return function(){if(!l){if(i("throwDeprecation"))throw new Error(u);i("traceDeprecation")?console.trace(u):console.warn(u),l=!0}return c.apply(this,arguments)}}}).call(this)}).call(this,typeof Kn<"u"?Kn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],525:[function(t,n,s){typeof Object.create=="function"?n.exports=function(o,i){o.super_=i,o.prototype=Object.create(i.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}})}:n.exports=function(o,i){o.super_=i;var c=function(){};c.prototype=i.prototype,o.prototype=new c,o.prototype.constructor=o}},{}],526:[function(t,n,s){n.exports=function(o){return o&&typeof o=="object"&&typeof o.copy=="function"&&typeof o.fill=="function"&&typeof o.readUInt8=="function"}},{}],527:[function(t,n,s){(function(o,i){(function(){var c=/%[sdj%]/g;s.format=function(_){if(!C(_)){for(var R=[],j=0;j<arguments.length;j++)R.push(d(arguments[j]));return R.join(" ")}j=1;for(var A=arguments,N=A.length,V=String(_).replace(c,function(Z){if(Z==="%%")return"%";if(j>=N)return Z;switch(Z){case"%s":return String(A[j++]);case"%d":return Number(A[j++]);case"%j":try{return JSON.stringify(A[j++])}catch{return"[Circular]"}default:return Z}}),M=A[j];j<N;M=A[++j])y(M)||!H(M)?V+=" "+M:V+=" "+d(M);return V},s.deprecate=function(_,R){if(L(i.process))return function(){return s.deprecate(_,R).apply(this,arguments)};if(o.noDeprecation===!0)return _;var j=!1;return function(){if(!j){if(o.throwDeprecation)throw new Error(R);o.traceDeprecation?console.trace(R):console.error(R),j=!0}return _.apply(this,arguments)}};var u,l={};function d(_,R){var j={seen:[],stylize:f};return arguments.length>=3&&(j.depth=arguments[2]),arguments.length>=4&&(j.colors=arguments[3]),b(R)?j.showHidden=R:R&&s._extend(j,R),L(j.showHidden)&&(j.showHidden=!1),L(j.depth)&&(j.depth=2),L(j.colors)&&(j.colors=!1),L(j.customInspect)&&(j.customInspect=!0),j.colors&&(j.stylize=h),p(j,_,j.depth)}function h(_,R){var j=d.styles[R];return j?"\x1B["+d.colors[j][0]+"m"+_+"\x1B["+d.colors[j][1]+"m":_}function f(_,R){return _}function p(_,R,j){if(_.customInspect&&R&&D(R.inspect)&&R.inspect!==s.inspect&&(!R.constructor||R.constructor.prototype!==R)){var A=R.inspect(j,_);return C(A)||(A=p(_,A,j)),A}var N=function(Y,K){if(L(K))return Y.stylize("undefined","undefined");if(C(K)){var ee="'"+JSON.stringify(K).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return Y.stylize(ee,"string")}if(S(K))return Y.stylize(""+K,"number");if(b(K))return Y.stylize(""+K,"boolean");if(y(K))return Y.stylize("null","null")}(_,R);if(N)return N;var V=Object.keys(R),M=function(Y){var K={};return Y.forEach(function(ee,ue){K[ee]=!0}),K}(V);if(_.showHidden&&(V=Object.getOwnPropertyNames(R)),q(R)&&(V.indexOf("message")>=0||V.indexOf("description")>=0))return v(R);if(V.length===0){if(D(R)){var Z=R.name?": "+R.name:"";return _.stylize("[Function"+Z+"]","special")}if(O(R))return _.stylize(RegExp.prototype.toString.call(R),"regexp");if(z(R))return _.stylize(Date.prototype.toString.call(R),"date");if(q(R))return v(R)}var J,re="",X=!1,ne=["{","}"];return m(R)&&(X=!0,ne=["[","]"]),D(R)&&(re=" [Function"+(R.name?": "+R.name:"")+"]"),O(R)&&(re=" "+RegExp.prototype.toString.call(R)),z(R)&&(re=" "+Date.prototype.toUTCString.call(R)),q(R)&&(re=" "+v(R)),V.length!==0||X&&R.length!=0?j<0?O(R)?_.stylize(RegExp.prototype.toString.call(R),"regexp"):_.stylize("[Object]","special"):(_.seen.push(R),J=X?function(Y,K,ee,ue,se){for(var ce=[],fe=0,ve=K.length;fe<ve;++fe)k(K,String(fe))?ce.push(g(Y,K,ee,ue,String(fe),!0)):ce.push("");return se.forEach(function(_e){_e.match(/^\d+$/)||ce.push(g(Y,K,ee,ue,_e,!0))}),ce}(_,R,j,M,V):V.map(function(Y){return g(_,R,j,M,Y,X)}),_.seen.pop(),function(Y,K,ee){return Y.reduce(function(ue,se){return se.indexOf(`
`)>=0,ue+se.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?ee[0]+(K===""?"":K+`
 `)+" "+Y.join(`,
  `)+" "+ee[1]:ee[0]+K+" "+Y.join(", ")+" "+ee[1]}(J,re,ne)):ne[0]+re+ne[1]}function v(_){return"["+Error.prototype.toString.call(_)+"]"}function g(_,R,j,A,N,V){var M,Z,J;if((J=Object.getOwnPropertyDescriptor(R,N)||{value:R[N]}).get?Z=J.set?_.stylize("[Getter/Setter]","special"):_.stylize("[Getter]","special"):J.set&&(Z=_.stylize("[Setter]","special")),k(A,N)||(M="["+N+"]"),Z||(_.seen.indexOf(J.value)<0?(Z=y(j)?p(_,J.value,null):p(_,J.value,j-1)).indexOf(`
`)>-1&&(Z=V?Z.split(`
`).map(function(re){return"  "+re}).join(`
`).substr(2):`
`+Z.split(`
`).map(function(re){return"   "+re}).join(`
`)):Z=_.stylize("[Circular]","special")),L(M)){if(V&&N.match(/^\d+$/))return Z;(M=JSON.stringify(""+N)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(M=M.substr(1,M.length-2),M=_.stylize(M,"name")):(M=M.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),M=_.stylize(M,"string"))}return M+": "+Z}function m(_){return Array.isArray(_)}function b(_){return typeof _=="boolean"}function y(_){return _===null}function S(_){return typeof _=="number"}function C(_){return typeof _=="string"}function L(_){return _===void 0}function O(_){return H(_)&&W(_)==="[object RegExp]"}function H(_){return typeof _=="object"&&_!==null}function z(_){return H(_)&&W(_)==="[object Date]"}function q(_){return H(_)&&(W(_)==="[object Error]"||_ instanceof Error)}function D(_){return typeof _=="function"}function W(_){return Object.prototype.toString.call(_)}function P(_){return _<10?"0"+_.toString(10):_.toString(10)}s.debuglog=function(_){if(L(u)&&(u=o.env.NODE_DEBUG||""),_=_.toUpperCase(),!l[_])if(new RegExp("\\b"+_+"\\b","i").test(u)){var R=o.pid;l[_]=function(){var j=s.format.apply(s,arguments);console.error("%s %d: %s",_,R,j)}}else l[_]=function(){};return l[_]},s.inspect=d,d.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},d.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},s.isArray=m,s.isBoolean=b,s.isNull=y,s.isNullOrUndefined=function(_){return _==null},s.isNumber=S,s.isString=C,s.isSymbol=function(_){return typeof _=="symbol"},s.isUndefined=L,s.isRegExp=O,s.isObject=H,s.isDate=z,s.isError=q,s.isFunction=D,s.isPrimitive=function(_){return _===null||typeof _=="boolean"||typeof _=="number"||typeof _=="string"||typeof _=="symbol"||_===void 0},s.isBuffer=t("./support/isBuffer");var I=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function U(){var _=new Date,R=[P(_.getHours()),P(_.getMinutes()),P(_.getSeconds())].join(":");return[_.getDate(),I[_.getMonth()],R].join(" ")}function k(_,R){return Object.prototype.hasOwnProperty.call(_,R)}s.log=function(){console.log("%s - %s",U(),s.format.apply(s,arguments))},s.inherits=t("inherits"),s._extend=function(_,R){if(!R||!H(R))return _;for(var j=Object.keys(R),A=j.length;A--;)_[j[A]]=R[j[A]];return _}}).call(this)}).call(this,t("_process"),typeof Kn<"u"?Kn:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":526,_process:467,inherits:525}],528:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"v1",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(s,"v3",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(s,"v4",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(s,"v5",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(s,"NIL",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(s,"version",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(s,"validate",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(s,"stringify",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(s,"parse",{enumerable:!0,get:function(){return p.default}});var o=v(t("./v1.js")),i=v(t("./v3.js")),c=v(t("./v4.js")),u=v(t("./v5.js")),l=v(t("./nil.js")),d=v(t("./version.js")),h=v(t("./validate.js")),f=v(t("./stringify.js")),p=v(t("./parse.js"));function v(g){return g&&g.__esModule?g:{default:g}}},{"./nil.js":530,"./parse.js":531,"./stringify.js":535,"./v1.js":536,"./v3.js":537,"./v4.js":539,"./v5.js":540,"./validate.js":541,"./version.js":542}],529:[function(t,n,s){function o(p){return 14+(p+64>>>9<<4)+1}function i(p,v){const g=(65535&p)+(65535&v);return(p>>16)+(v>>16)+(g>>16)<<16|65535&g}function c(p,v,g,m,b,y){return i((S=i(i(v,p),i(m,y)))<<(C=b)|S>>>32-C,g);var S,C}function u(p,v,g,m,b,y,S){return c(v&g|~v&m,p,v,b,y,S)}function l(p,v,g,m,b,y,S){return c(v&m|g&~m,p,v,b,y,S)}function d(p,v,g,m,b,y,S){return c(v^g^m,p,v,b,y,S)}function h(p,v,g,m,b,y,S){return c(g^(v|~m),p,v,b,y,S)}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var f=function(p){if(typeof p=="string"){const v=unescape(encodeURIComponent(p));p=new Uint8Array(v.length);for(let g=0;g<v.length;++g)p[g]=v.charCodeAt(g)}return function(v){const g=[],m=32*v.length;for(let b=0;b<m;b+=8){const y=v[b>>5]>>>b%32&255,S=parseInt("0123456789abcdef".charAt(y>>>4&15)+"0123456789abcdef".charAt(15&y),16);g.push(S)}return g}(function(v,g){v[g>>5]|=128<<g%32,v[o(g)-1]=g;let m=1732584193,b=-271733879,y=-1732584194,S=271733878;for(let C=0;C<v.length;C+=16){const L=m,O=b,H=y,z=S;m=u(m,b,y,S,v[C],7,-680876936),S=u(S,m,b,y,v[C+1],12,-389564586),y=u(y,S,m,b,v[C+2],17,606105819),b=u(b,y,S,m,v[C+3],22,-1044525330),m=u(m,b,y,S,v[C+4],7,-176418897),S=u(S,m,b,y,v[C+5],12,1200080426),y=u(y,S,m,b,v[C+6],17,-1473231341),b=u(b,y,S,m,v[C+7],22,-45705983),m=u(m,b,y,S,v[C+8],7,1770035416),S=u(S,m,b,y,v[C+9],12,-1958414417),y=u(y,S,m,b,v[C+10],17,-42063),b=u(b,y,S,m,v[C+11],22,-1990404162),m=u(m,b,y,S,v[C+12],7,1804603682),S=u(S,m,b,y,v[C+13],12,-40341101),y=u(y,S,m,b,v[C+14],17,-1502002290),b=u(b,y,S,m,v[C+15],22,1236535329),m=l(m,b,y,S,v[C+1],5,-165796510),S=l(S,m,b,y,v[C+6],9,-1069501632),y=l(y,S,m,b,v[C+11],14,643717713),b=l(b,y,S,m,v[C],20,-373897302),m=l(m,b,y,S,v[C+5],5,-701558691),S=l(S,m,b,y,v[C+10],9,38016083),y=l(y,S,m,b,v[C+15],14,-660478335),b=l(b,y,S,m,v[C+4],20,-405537848),m=l(m,b,y,S,v[C+9],5,568446438),S=l(S,m,b,y,v[C+14],9,-1019803690),y=l(y,S,m,b,v[C+3],14,-187363961),b=l(b,y,S,m,v[C+8],20,1163531501),m=l(m,b,y,S,v[C+13],5,-1444681467),S=l(S,m,b,y,v[C+2],9,-51403784),y=l(y,S,m,b,v[C+7],14,1735328473),b=l(b,y,S,m,v[C+12],20,-1926607734),m=d(m,b,y,S,v[C+5],4,-378558),S=d(S,m,b,y,v[C+8],11,-2022574463),y=d(y,S,m,b,v[C+11],16,1839030562),b=d(b,y,S,m,v[C+14],23,-35309556),m=d(m,b,y,S,v[C+1],4,-1530992060),S=d(S,m,b,y,v[C+4],11,1272893353),y=d(y,S,m,b,v[C+7],16,-155497632),b=d(b,y,S,m,v[C+10],23,-1094730640),m=d(m,b,y,S,v[C+13],4,681279174),S=d(S,m,b,y,v[C],11,-358537222),y=d(y,S,m,b,v[C+3],16,-722521979),b=d(b,y,S,m,v[C+6],23,76029189),m=d(m,b,y,S,v[C+9],4,-640364487),S=d(S,m,b,y,v[C+12],11,-421815835),y=d(y,S,m,b,v[C+15],16,530742520),b=d(b,y,S,m,v[C+2],23,-995338651),m=h(m,b,y,S,v[C],6,-198630844),S=h(S,m,b,y,v[C+7],10,1126891415),y=h(y,S,m,b,v[C+14],15,-1416354905),b=h(b,y,S,m,v[C+5],21,-57434055),m=h(m,b,y,S,v[C+12],6,1700485571),S=h(S,m,b,y,v[C+3],10,-1894986606),y=h(y,S,m,b,v[C+10],15,-1051523),b=h(b,y,S,m,v[C+1],21,-2054922799),m=h(m,b,y,S,v[C+8],6,1873313359),S=h(S,m,b,y,v[C+15],10,-30611744),y=h(y,S,m,b,v[C+6],15,-1560198380),b=h(b,y,S,m,v[C+13],21,1309151649),m=h(m,b,y,S,v[C+4],6,-145523070),S=h(S,m,b,y,v[C+11],10,-1120210379),y=h(y,S,m,b,v[C+2],15,718787259),b=h(b,y,S,m,v[C+9],21,-343485551),m=i(m,L),b=i(b,O),y=i(y,H),S=i(S,z)}return[m,b,y,S]}(function(v){if(v.length===0)return[];const g=8*v.length,m=new Uint32Array(o(g));for(let b=0;b<g;b+=8)m[b>>5]|=(255&v[b/8])<<b%32;return m}(p),8*p.length))};s.default=f},{}],530:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,s.default="00000000-0000-0000-0000-000000000000"},{}],531:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var o,i=(o=t("./validate.js"))&&o.__esModule?o:{default:o},c=function(u){if(!(0,i.default)(u))throw TypeError("Invalid UUID");let l;const d=new Uint8Array(16);return d[0]=(l=parseInt(u.slice(0,8),16))>>>24,d[1]=l>>>16&255,d[2]=l>>>8&255,d[3]=255&l,d[4]=(l=parseInt(u.slice(9,13),16))>>>8,d[5]=255&l,d[6]=(l=parseInt(u.slice(14,18),16))>>>8,d[7]=255&l,d[8]=(l=parseInt(u.slice(19,23),16))>>>8,d[9]=255&l,d[10]=(l=parseInt(u.slice(24,36),16))/1099511627776&255,d[11]=l/4294967296&255,d[12]=l>>>24&255,d[13]=l>>>16&255,d[14]=l>>>8&255,d[15]=255&l,d};s.default=c},{"./validate.js":541}],532:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,s.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},{}],533:[function(t,n,s){let o;Object.defineProperty(s,"__esModule",{value:!0}),s.default=function(){if(!o&&(o=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!o))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(i)};const i=new Uint8Array(16)},{}],534:[function(t,n,s){function o(u,l,d,h){switch(u){case 0:return l&d^~l&h;case 1:return l^d^h;case 2:return l&d^l&h^d&h;case 3:return l^d^h}}function i(u,l){return u<<l|u>>>32-l}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var c=function(u){const l=[1518500249,1859775393,2400959708,3395469782],d=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof u=="string"){const v=unescape(encodeURIComponent(u));u=[];for(let g=0;g<v.length;++g)u.push(v.charCodeAt(g))}else Array.isArray(u)||(u=Array.prototype.slice.call(u));u.push(128);const h=u.length/4+2,f=Math.ceil(h/16),p=new Array(f);for(let v=0;v<f;++v){const g=new Uint32Array(16);for(let m=0;m<16;++m)g[m]=u[64*v+4*m]<<24|u[64*v+4*m+1]<<16|u[64*v+4*m+2]<<8|u[64*v+4*m+3];p[v]=g}p[f-1][14]=8*(u.length-1)/Math.pow(2,32),p[f-1][14]=Math.floor(p[f-1][14]),p[f-1][15]=8*(u.length-1)&4294967295;for(let v=0;v<f;++v){const g=new Uint32Array(80);for(let L=0;L<16;++L)g[L]=p[v][L];for(let L=16;L<80;++L)g[L]=i(g[L-3]^g[L-8]^g[L-14]^g[L-16],1);let m=d[0],b=d[1],y=d[2],S=d[3],C=d[4];for(let L=0;L<80;++L){const O=Math.floor(L/20),H=i(m,5)+o(O,b,y,S)+C+l[O]+g[L]>>>0;C=S,S=y,y=i(b,30)>>>0,b=m,m=H}d[0]=d[0]+m>>>0,d[1]=d[1]+b>>>0,d[2]=d[2]+y>>>0,d[3]=d[3]+S>>>0,d[4]=d[4]+C>>>0}return[d[0]>>24&255,d[0]>>16&255,d[0]>>8&255,255&d[0],d[1]>>24&255,d[1]>>16&255,d[1]>>8&255,255&d[1],d[2]>>24&255,d[2]>>16&255,d[2]>>8&255,255&d[2],d[3]>>24&255,d[3]>>16&255,d[3]>>8&255,255&d[3],d[4]>>24&255,d[4]>>16&255,d[4]>>8&255,255&d[4]]};s.default=c},{}],535:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var o,i=(o=t("./validate.js"))&&o.__esModule?o:{default:o};const c=[];for(let l=0;l<256;++l)c.push((l+256).toString(16).substr(1));var u=function(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const h=(c[l[d+0]]+c[l[d+1]]+c[l[d+2]]+c[l[d+3]]+"-"+c[l[d+4]]+c[l[d+5]]+"-"+c[l[d+6]]+c[l[d+7]]+"-"+c[l[d+8]]+c[l[d+9]]+"-"+c[l[d+10]]+c[l[d+11]]+c[l[d+12]]+c[l[d+13]]+c[l[d+14]]+c[l[d+15]]).toLowerCase();if(!(0,i.default)(h))throw TypeError("Stringified UUID is invalid");return h};s.default=u},{"./validate.js":541}],536:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var o=c(t("./rng.js")),i=c(t("./stringify.js"));function c(p){return p&&p.__esModule?p:{default:p}}let u,l,d=0,h=0;var f=function(p,v,g){let m=v&&g||0;const b=v||new Array(16);let y=(p=p||{}).node||u,S=p.clockseq!==void 0?p.clockseq:l;if(y==null||S==null){const q=p.random||(p.rng||o.default)();y==null&&(y=u=[1|q[0],q[1],q[2],q[3],q[4],q[5]]),S==null&&(S=l=16383&(q[6]<<8|q[7]))}let C=p.msecs!==void 0?p.msecs:Date.now(),L=p.nsecs!==void 0?p.nsecs:h+1;const O=C-d+(L-h)/1e4;if(O<0&&p.clockseq===void 0&&(S=S+1&16383),(O<0||C>d)&&p.nsecs===void 0&&(L=0),L>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");d=C,h=L,l=S,C+=122192928e5;const H=(1e4*(268435455&C)+L)%4294967296;b[m++]=H>>>24&255,b[m++]=H>>>16&255,b[m++]=H>>>8&255,b[m++]=255&H;const z=C/4294967296*1e4&268435455;b[m++]=z>>>8&255,b[m++]=255&z,b[m++]=z>>>24&15|16,b[m++]=z>>>16&255,b[m++]=S>>>8|128,b[m++]=255&S;for(let q=0;q<6;++q)b[m+q]=y[q];return v||(0,i.default)(b)};s.default=f},{"./rng.js":533,"./stringify.js":535}],537:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var o=c(t("./v35.js")),i=c(t("./md5.js"));function c(l){return l&&l.__esModule?l:{default:l}}var u=(0,o.default)("v3",48,i.default);s.default=u},{"./md5.js":529,"./v35.js":538}],538:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=function(d,h,f){function p(v,g,m,b){if(typeof v=="string"&&(v=function(S){S=unescape(encodeURIComponent(S));const C=[];for(let L=0;L<S.length;++L)C.push(S.charCodeAt(L));return C}(v)),typeof g=="string"&&(g=(0,i.default)(g)),g.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let y=new Uint8Array(16+v.length);if(y.set(g),y.set(v,g.length),y=f(y),y[6]=15&y[6]|h,y[8]=63&y[8]|128,m){b=b||0;for(let S=0;S<16;++S)m[b+S]=y[S];return m}return(0,o.default)(y)}try{p.name=d}catch{}return p.DNS=u,p.URL=l,p},s.URL=s.DNS=void 0;var o=c(t("./stringify.js")),i=c(t("./parse.js"));function c(d){return d&&d.__esModule?d:{default:d}}const u="6ba7b810-9dad-11d1-80b4-00c04fd430c8";s.DNS=u;const l="6ba7b811-9dad-11d1-80b4-00c04fd430c8";s.URL=l},{"./parse.js":531,"./stringify.js":535}],539:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var o=c(t("./rng.js")),i=c(t("./stringify.js"));function c(l){return l&&l.__esModule?l:{default:l}}var u=function(l,d,h){const f=(l=l||{}).random||(l.rng||o.default)();if(f[6]=15&f[6]|64,f[8]=63&f[8]|128,d){h=h||0;for(let p=0;p<16;++p)d[h+p]=f[p];return d}return(0,i.default)(f)};s.default=u},{"./rng.js":533,"./stringify.js":535}],540:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var o=c(t("./v35.js")),i=c(t("./sha1.js"));function c(l){return l&&l.__esModule?l:{default:l}}var u=(0,o.default)("v5",80,i.default);s.default=u},{"./sha1.js":534,"./v35.js":538}],541:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var o,i=(o=t("./regex.js"))&&o.__esModule?o:{default:o},c=function(u){return typeof u=="string"&&i.default.test(u)};s.default=c},{"./regex.js":532}],542:[function(t,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var o,i=(o=t("./validate.js"))&&o.__esModule?o:{default:o},c=function(u){if(!(0,i.default)(u))throw TypeError("Invalid UUID");return parseInt(u.substr(14,1),16)};s.default=c},{"./validate.js":541}],543:[function(t,n,s){/**
* Character classes and associated utilities for the 5th edition of XML 1.0.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/Object.defineProperty(s,"__esModule",{value:!0}),s.CHAR=`	
\r ---`,s.S=` 	\r
`,s.NAME_START_CHAR=":A-Z_a-z-----------",s.NAME_CHAR="-"+s.NAME_START_CHAR+".0-9--",s.CHAR_RE=new RegExp("^["+s.CHAR+"]$","u"),s.S_RE=new RegExp("^["+s.S+"]+$","u"),s.NAME_START_CHAR_RE=new RegExp("^["+s.NAME_START_CHAR+"]$","u"),s.NAME_CHAR_RE=new RegExp("^["+s.NAME_CHAR+"]$","u"),s.NAME_RE=new RegExp("^["+s.NAME_START_CHAR+"]["+s.NAME_CHAR+"]*$","u"),s.NMTOKEN_RE=new RegExp("^["+s.NAME_CHAR+"]+$","u");function o(i){return i>=65&&i<=90||i>=97&&i<=122||i===58||i===95||i===8204||i===8205||i>=192&&i<=214||i>=216&&i<=246||i>=248&&i<=767||i>=880&&i<=893||i>=895&&i<=8191||i>=8304&&i<=8591||i>=11264&&i<=12271||i>=12289&&i<=55295||i>=63744&&i<=64975||i>=65008&&i<=65533||i>=65536&&i<=983039}s.S_LIST=[32,10,13,9],s.isChar=function(i){return i>=32&&i<=55295||i===10||i===13||i===9||i>=57344&&i<=65533||i>=65536&&i<=1114111},s.isS=function(i){return i===32||i===10||i===13||i===9},s.isNameStartChar=o,s.isNameChar=function(i){return o(i)||i>=48&&i<=57||i===45||i===46||i===183||i>=768&&i<=879||i>=8255&&i<=8256}},{}],544:[function(t,n,s){/**
* Character classes and associated utilities for the 2nd edition of XML 1.1.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/Object.defineProperty(s,"__esModule",{value:!0}),s.CHAR="---",s.RESTRICTED_CHAR="-\b\v\f---",s.S=` 	\r
`,s.NAME_START_CHAR=":A-Z_a-z-----------",s.NAME_CHAR="-"+s.NAME_START_CHAR+".0-9--",s.CHAR_RE=new RegExp("^["+s.CHAR+"]$","u"),s.RESTRICTED_CHAR_RE=new RegExp("^["+s.RESTRICTED_CHAR+"]$","u"),s.S_RE=new RegExp("^["+s.S+"]+$","u"),s.NAME_START_CHAR_RE=new RegExp("^["+s.NAME_START_CHAR+"]$","u"),s.NAME_CHAR_RE=new RegExp("^["+s.NAME_CHAR+"]$","u"),s.NAME_RE=new RegExp("^["+s.NAME_START_CHAR+"]["+s.NAME_CHAR+"]*$","u"),s.NMTOKEN_RE=new RegExp("^["+s.NAME_CHAR+"]+$","u");function o(i){return i>=65&&i<=90||i>=97&&i<=122||i===58||i===95||i===8204||i===8205||i>=192&&i<=214||i>=216&&i<=246||i>=248&&i<=767||i>=880&&i<=893||i>=895&&i<=8191||i>=8304&&i<=8591||i>=11264&&i<=12271||i>=12289&&i<=55295||i>=63744&&i<=64975||i>=65008&&i<=65533||i>=65536&&i<=983039}s.S_LIST=[32,10,13,9],s.isChar=function(i){return i>=1&&i<=55295||i>=57344&&i<=65533||i>=65536&&i<=1114111},s.isRestrictedChar=function(i){return i>=1&&i<=8||i===11||i===12||i>=14&&i<=31||i>=127&&i<=132||i>=134&&i<=159},s.isCharAndNotRestricted=function(i){return i===9||i===10||i===13||i>31&&i<127||i===133||i>159&&i<=55295||i>=57344&&i<=65533||i>=65536&&i<=1114111},s.isS=function(i){return i===32||i===10||i===13||i===9},s.isNameStartChar=o,s.isNameChar=function(i){return o(i)||i>=48&&i<=57||i===45||i===46||i===183||i>=768&&i<=879||i>=8255&&i<=8256}},{}],545:[function(t,n,s){/**
* Character class utilities for XML NS 1.0 edition 3.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/function o(i){return i>=65&&i<=90||i===95||i>=97&&i<=122||i>=192&&i<=214||i>=216&&i<=246||i>=248&&i<=767||i>=880&&i<=893||i>=895&&i<=8191||i>=8204&&i<=8205||i>=8304&&i<=8591||i>=11264&&i<=12271||i>=12289&&i<=55295||i>=63744&&i<=64975||i>=65008&&i<=65533||i>=65536&&i<=983039}Object.defineProperty(s,"__esModule",{value:!0}),s.NC_NAME_START_CHAR="A-Z_a-z------------",s.NC_NAME_CHAR="-"+s.NC_NAME_START_CHAR+".0-9--",s.NC_NAME_START_CHAR_RE=new RegExp("^["+s.NC_NAME_START_CHAR+"]$","u"),s.NC_NAME_CHAR_RE=new RegExp("^["+s.NC_NAME_CHAR+"]$","u"),s.NC_NAME_RE=new RegExp("^["+s.NC_NAME_START_CHAR+"]["+s.NC_NAME_CHAR+"]*$","u"),s.isNCNameStartChar=o,s.isNCNameChar=function(i){return o(i)||i===45||i===46||i>=48&&i<=57||i===183||i>=768&&i<=879||i>=8255&&i<=8256}},{}]},{},[15])(15)})}(q3)),q3.exports}var jE=Hie();const B2=Xv(jE),kE=Pj({__proto__:null,default:B2},[jE]),Vie="Andaman and Nicobar",Wie="Andhra Pradesh",qie="Arunachal Pradesh",Gie="Assam",Kie="Bihar",Xie="Chandigarh",Yie="Chhattisgarh",Zie="Ddra and Nagar Haveli and Damn and Diu",Jie="Delhi",Qie="Goa",eoe="Gujarat",toe="Himachal Pradesh",roe="Haryana",noe="Jharkhand",aoe="Jammu and Kashmir",soe="Karnataka",ioe="Kerala",ooe="Ladakh",loe="Lakshadweep",coe="Maharashtra",uoe="Meghalaya",doe="Manipur",foe="Madhya Pradesh",hoe="Mizoram",poe="Nagaland",moe="Orissa",goe="Punjab",voe="Puducherry",xoe="Rajasthan",boe="Sikkim",yoe="Telangana",woe="Tamil Nadu",Soe="Tripura",_oe="Uttar Pradesh",Aoe="Uttaranchal",Coe="West Bengal",Bf={INAN:Vie,INAP:Wie,INAR:qie,INAS:Gie,INBR:Kie,INCH:Xie,INCT:Yie,INDH:Zie,INDL:Jie,INGA:Qie,INGJ:eoe,INHP:toe,INHR:roe,INJH:noe,INJK:aoe,INKA:soe,INKL:ioe,INLA:ooe,INLD:loe,INMH:coe,INML:uoe,INMN:doe,INMP:foe,INMZ:hoe,INNL:poe,INOR:moe,INPB:goe,INPY:voe,INRJ:xoe,INSK:boe,INTG:yoe,INTN:woe,INTR:Soe,INUP:_oe,INUT:Aoe,INWB:Coe},nv=Array.isArray(Hs)?Hs.map(e=>{const r=String(e.code||"").trim(),t=r?r.startsWith("+")?r:"+"+r.replace(/^\+/,""):"";return`${e.name} (${t})`}):[],joe=({value:e,rowIndex:r,columnKey:t,onUpdate:n,error:s,errorMessages:o,cellSx:i={},row:c})=>{const[u,l]=G.useState(!1),[d,h]=G.useState(e);G.useEffect(()=>{const C=g(t);if(C&&C.multiple)if(typeof e=="string"&&e.trim()!==""){const L=e.split(",").map(O=>O.trim()).filter(Boolean);h(L)}else Array.isArray(e)?h(e):h([]);else h(e)},[e]);try{setImportFieldErrors(buildFieldErrorMapFromErrors(parsedErrors,normalizedArray))}catch(C){console.warn("Failed to map parsed backend errors to fields",C)}const f=()=>{n(r,t,d),l(!1)},p=C=>{C.key==="Enter"?f():C.key==="Escape"&&(h(e),l(!1))},v=["Customer","Supplier","Dealer","Distributor"],g=(C,L={})=>{const H=String(C).replace(/\s*\*\s*$/g,"").toLowerCase().replace(/[^a-z0-9]/g,"");return H==="salutation"?{options:["Mr","Mrs","Ms","Dr","Prof","Sir","Madam"],multiple:!1}:H==="gender"?{options:["Male","Female","Other"],multiple:!1}:H==="active"?{options:["Yes","No"],multiple:!1}:H==="country"||H==="permanentcountry"?{options:nv,multiple:!1}:H==="state"&&(L.Country==="India (+91)"||L["Permanent Country"]==="India (+91)")?{options:Object.values(Bf),multiple:!1}:H==="city"&&(L.Country==="India (+91)"||L["Permanent Country"]==="India (+91)")?{options:Kc,multiple:!1}:H.includes("accounttype")||H.includes("account")&&H.includes("type")?{options:v,multiple:!0}:null},m=g(t,c),b=m?m.options:null,y=m?m.multiple:!1,S={cursor:u?"default":"pointer",padding:u?"4px":void 0,borderLeft:s?"4px solid rgba(244,67,54,0.6)":void 0,backgroundColor:s?"rgba(255,235,238,0.6)":void 0,"&:hover":u?{}:{backgroundColor:s?"rgba(255, 205, 210, 0.6)":"rgba(0, 0, 0, 0.04)"}};return a.jsx(qe,{onClick:()=>!u&&l(!0),sx:{...S,...i},children:u?b?a.jsx(eh,{autoFocus:!0,fullWidth:!0,size:"small",multiple:y,value:d||(y?[]:""),onChange:C=>h(C.target.value),onBlur:()=>{y&&Array.isArray(d)?n(r,t,d.join(",")):n(r,t,d),l(!1)},renderValue:C=>y&&Array.isArray(C)?C.join(", "):C,sx:{margin:"-8px 0"},children:b.map(C=>a.jsx(zl,{value:C,children:y?a.jsxs(a.Fragment,{children:[a.jsx(Wn,{checked:Array.isArray(d)?d.indexOf(C)>-1:!1}),a.jsx(pF,{primary:C})]}):C},C))}):a.jsx(ri,{autoFocus:!0,fullWidth:!0,size:"small",variant:"outlined",value:d||"",onChange:C=>h(C.target.value),onKeyDown:p,onBlur:f,sx:{margin:"-8px 0"}}):e})};function koe(){var xe,Oe,Ce,de,be,Se,Ne,ze,Re,Ie;const e=ii(),[r,t]=G.useState([]),[n,s]=G.useState({name:"",deptHead:"",userType:"",executiveID:""}),[o,i]=G.useState(0),[c,u]=G.useState(10),[l,d]=G.useState(0),[h,f]=G.useState(!1),[p,v]=G.useState([]),[g,m]=G.useState([]),[b,y]=G.useState(!1),S=["User Code","CompanyName","Name","DOB","Gender","Country","MobileNumber","EmergencyNumber","AlternateNumber","WhatsappNumber","Email","Website","Address1","Address2","Address3","City","State","Country","Pincode","BusinessName","IndustrySegment","Designation","Title","BankName","BranchName","BranchAddress","AccountNumber","IFSCCode","AadharNumber","PANNumber","GSTIN","MSMENo","Additional Address","Additional Bank Info","Uploaded Documents","Active","IsCustomer","IsSupplier","IsDealer","IsDistributor"],[C,L]=G.useState(()=>{const ae=localStorage.getItem("userListCheckedFields");return ae?JSON.parse(ae):S}),O=()=>y(!0),H=()=>y(!1);G.useEffect(()=>{localStorage.setItem("userListCheckedFields",JSON.stringify(C))},[C]);const z=ae=>{const we=["IsCustomer","IsSupplier","IsDealer","IsDistributor"];if(ae==="Account Type"){L(Fe=>{const Ye=we.every(Be=>Fe.includes(Be));let me;if(Ye)me=Fe.filter(Be=>!we.includes(Be));else{const Be=we.filter(Ge=>!Fe.includes(Ge));me=[...Fe,...Be]}return localStorage.setItem("userListCheckedFields",JSON.stringify(me)),me});return}L(Fe=>{const Ye=Fe.includes(ae)?Fe.filter(me=>me!==ae):[...Fe,ae];return localStorage.setItem("userListCheckedFields",JSON.stringify(Ye)),Ye})};G.useEffect(()=>{q()},[o,c]),G.useEffect(()=>{let ae=!1;return(async()=>{try{const Fe=await ut.get(`${Je}/departments`,{params:{limit:1e3}}),Ye=Fe.data&&(Fe.data.departments!==void 0?Fe.data.departments:Fe.data),me=Array.isArray(Ye)?Ye:[],Be=new Map;me.forEach(mt=>{const _t=mt.head||mt.Head||mt.head_user||null;if(_t&&(_t.id||_t.ID)){const ot=_t.id||_t.ID;if(!Be.has(String(ot))){const xt=_t.usercode||_t.user_code||_t.code||"",zt=_t.salutation||_t.Salutation||"",Vt=_t.firstname||_t.Firstname||"",Ar=_t.lastname||_t.Lastname||"",wr=`${Vt} ${Ar}`.trim(),Nr=`${xt?xt+"  ":""}${zt?zt+" ":""}${wr||"Unknown"}`;Be.set(String(ot),{id:ot,label:Nr,raw:_t,deptId:mt.id})}}});const Ge=Array.from(Be.values());ae||v([{id:"",label:"All"},...Ge])}catch(Fe){console.error("Failed to load dept heads",Fe)}})(),()=>{ae=!0}},[]),G.useEffect(()=>{let ae=!1;return(async()=>{if(!n.deptHead){m([]);return}try{const Fe=p.find(Ge=>String(Ge.id)===String(n.deptHead));if(!(Fe!=null&&Fe.deptId)){m([]);return}const me=(await ut.get(`${Je}/departments/${Fe.deptId}/employees`)).data,Be=Array.isArray(me)?me.map(Ge=>{const mt=Ge.employee||Ge.Employee;if(!mt)return null;const _t=mt.usercode||mt.user_code||mt.code||"",ot=mt.salutation||mt.Salutation||"",xt=mt.firstname||mt.Firstname||"",zt=mt.lastname||mt.Lastname||"",Vt=`${xt} ${zt}`.trim(),Ar=`${_t?_t+"  ":""}${ot?ot+" ":""}${Vt||"Unknown"}`;return{id:mt.id||mt.ID,label:Ar,raw:mt}}).filter(Boolean):[];ae||m([{id:"",label:"All"},...Be])}catch(Fe){console.error("Failed to load executives",Fe),ae||m([])}})(),()=>{ae=!0}},[n.deptHead,p]),G.useEffect(()=>{const ae=setTimeout(()=>{i(0),q()},300);return()=>clearTimeout(ae)},[n.name,n.deptHead,n.userType,n.executiveID]);const q=async()=>{f(!0);try{const ae={page:o+1,limit:c,filter:n.name,user_type:n.userType};n.executiveID?ae.employee_id=n.executiveID:n.deptHead&&(ae.dept_head=n.deptHead);const we=await ut.get(`${Je}/api/users`,{params:ae}),Fe=we.data&&(we.data.data!==void 0?we.data.data:we.data),Ye=Array.isArray(Fe)?Fe:[];t(Ye);const me=we.data&&(we.data.total??we.data.totalItems??null);d(me!==null?me:Ye.length)}catch(ae){console.error("Error fetching users:",ae)}finally{f(!1)}},D=()=>{i(0),q()},W=(ae,we)=>{var Fe,Ye,me,Be,Ge,mt,_t,ot,xt,zt,Vt,Ar,wr,Nr,Dr,Yr,Vr,on,xn,ia,yn,oa,Qn,za;if(!ae)return"";try{if(we==="User Code")return(ae.usercode||ae.user_code||ae.userCode||ae.username||ae.email||"")+"";if(we==="CompanyName")return ae.company_name||ae.companyname||"";if(we==="Name")return[ae.salutation,ae.firstname,ae.lastname].filter(Boolean).join(" ")+"";if(we==="DOB")return ae.dob?new Date(ae.dob).toLocaleDateString():"";if(we==="Gender")return ae.gender||"";if(we==="Country"){const pr=(Fe=ae.addresses)==null?void 0:Fe.find(Ir=>Ir.title==="Permanent");return _(ae.country,ae.country_code)||""}if(we==="MobileNumber")return ae.mobile_number||"";if(we==="EmergencyNumber")return ae.emergency_number||"";if(we==="AlternateNumber")return ae.alternate_number||"";if(we==="WhatsappNumber")return ae.whatsapp_number||"";if(we==="Email")return ae.email||"";if(we==="Website")return ae.website||"";if(we==="BusinessName")return ae.business_name||"";if(we==="Title")return ae.title||"";if(we==="Designation")return ae.designation||"";if(we==="IndustrySegment")return ae.industry_segment||"";if(we==="Address1")return(((me=(Ye=ae.addresses)==null?void 0:Ye.find(pr=>pr.title==="Permanent"))==null?void 0:me.address1)||"")+"";if(we==="Address2")return(((Ge=(Be=ae.addresses)==null?void 0:Be.find(pr=>pr.title==="Permanent"))==null?void 0:Ge.address2)||"")+"";if(we==="Address3")return(((_t=(mt=ae.addresses)==null?void 0:mt.find(pr=>pr.title==="Permanent"))==null?void 0:_t.address3)||"")+"";if(we==="City")return(((xt=(ot=ae.addresses)==null?void 0:ot.find(pr=>pr.title==="Permanent"))==null?void 0:xt.city)||"")+"";if(we==="State")return(((Vt=(zt=ae.addresses)==null?void 0:zt.find(pr=>pr.title==="Permanent"))==null?void 0:Vt.state)||"")+"";if(we==="Permanent Country"){const pr=(Ar=ae.addresses)==null?void 0:Ar.find(Ir=>Ir.title==="Permanent");return _(ae.permanent_country||(pr==null?void 0:pr.country),ae.permanent_country_code||(pr==null?void 0:pr.country_code))||""}if(we==="Pincode")return(((Nr=(wr=ae.addresses)==null?void 0:wr.find(pr=>pr.title==="Permanent"))==null?void 0:Nr.pincode)||"")+"";if(we==="AadharNumber")return k(ae,["aadhaar","aadhar","aadhaar card","aadhar card"],["aadhar_number","aadhaar"],["aadhar_number","doc_number"])+"";if(we==="PANNumber")return k(ae,["pan","pan card","permanent account number"],["pan_number","pan"],["pan_number","doc_number"])+"";if(we==="GSTIN")return k(ae,["gstin","gst","goods and services tax"],["gstin_number","gstin"],["gstin_number","doc_number"])+"";if(we==="Uploaded Documents"){const pr=ae.documents||ae.uploaded_documents||[];return!Array.isArray(pr)||pr.length===0?"":pr.map(Ir=>{const $n=Ir.doc_type||Ir.type||"",Fr=Ir.doc_number||Ir.number||Ir.doc_no||"",jr=Ir.file_name||Ir.file_url||Ir.url||Ir.file_path||"";return`${$n}${Fr?" No:"+Fr:""}: ${jr}`.trim()}).join(" | ")}return we==="MSMENo"?k(ae,["msme","micro small medium enterprise"],["msme_no","msmeno"],["msme_no","doc_number"])+"":we==="BankName"?(((Yr=(Dr=ae.bank_accounts)==null?void 0:Dr[0])==null?void 0:Yr.bank_name)||"")+"":we==="BranchName"?(((on=(Vr=ae.bank_accounts)==null?void 0:Vr[0])==null?void 0:on.branch_name)||"")+"":we==="BranchAddress"?(((ia=(xn=ae.bank_accounts)==null?void 0:xn[0])==null?void 0:ia.branch_address)||"")+"":we==="AccountNumber"?(((oa=(yn=ae.bank_accounts)==null?void 0:yn[0])==null?void 0:oa.account_number)||"")+"":we==="IFSCCode"?(((za=(Qn=ae.bank_accounts)==null?void 0:Qn[0])==null?void 0:za.ifsc_code)||"")+"":we==="Active"?ae.active?"Yes":"No":we==="Additional Address"?!Array.isArray(ae.addresses)||ae.addresses.length===0?"":ae.addresses.filter(pr=>pr.title!=="Permanent").map(pr=>{const Ir=[];pr.title&&Ir.push(`Title: ${pr.title}`),(pr.gstin||pr.gstin_number)&&Ir.push(`GSTIN: ${pr.gstin||pr.gstin_number}`),pr.address1&&Ir.push(`Address1: ${pr.address1}`),pr.address2&&Ir.push(`Address2: ${pr.address2}`),pr.address3&&Ir.push(`Address3: ${pr.address3}`),pr.city&&Ir.push(`City: ${pr.city}`),pr.state&&Ir.push(`State: ${pr.state}`),pr.country&&Ir.push(`Country: ${pr.country}`),pr.pincode&&Ir.push(`Pincode: ${pr.pincode}`);const $n=pr.keyValues||pr.key_values||pr.key_value||pr.keyvalue||[];return Array.isArray($n)&&$n.length>0&&Ir.push("Additional: "+$n.map(Fr=>`${Fr.key}:${Fr.value}`).join("; ")),Ir.join(" | ")}).join(` 
 `):we==="Additional Bank Info"?!Array.isArray(ae.bank_accounts)||ae.bank_accounts.length<=1?"":ae.bank_accounts.slice(1).map(pr=>{const Ir=[];pr.bank_name&&Ir.push(`Bank: ${pr.bank_name}`),pr.branch_name&&Ir.push(`Branch: ${pr.branch_name}`),pr.branch_address&&Ir.push(`Address: ${pr.branch_address}`),pr.account_number&&Ir.push(`Account: ${pr.account_number}`),pr.ifsc_code&&Ir.push(`IFSC: ${pr.ifsc_code}`);const $n=pr.keyValues||pr.key_values||pr.key_value||pr.keyvalue||[];return Array.isArray($n)&&$n.length>0&&Ir.push("Additional: "+$n.map(Fr=>`${Fr.key}:${Fr.value}`).join("; ")),Ir.join(" | ")}).join(` 
 `):""}catch{return""}},P=async()=>{f(!0);try{const ae=l&&l>0?l:1e4,we=await ut.get(`${Je}/api/users`,{params:{page:1,limit:ae,filter:n.name,dept_head:n.deptHead,user_type:n.userType}}),Fe=we.data&&(we.data.data!==void 0?we.data.data:we.data),Ye=Array.isArray(Fe)?Fe:[],me=dt.length>0?Ye.filter(Vt=>dt.includes(Vt.id)):Ye,Be=["IsCustomer","IsSupplier","IsDealer","IsDistributor"],Ge=S.filter(Vt=>C.includes(Vt)),mt=Ge.some(Vt=>Be.includes(Vt)),_t=Ge.filter(Vt=>!Be.includes(Vt)),ot=me.map(Vt=>{const Ar={};if(_t.forEach(wr=>{Ar[wr]=W(Vt,wr)}),mt){const wr=[];(Vt.is_customer||Vt.IsCustomer||Vt.isCustomer)&&wr.push("Customer"),(Vt.is_supplier||Vt.IsSupplier||Vt.isSupplier)&&wr.push("Supplier"),(Vt.is_dealer||Vt.IsDealer||Vt.isDealer)&&wr.push("Dealer"),(Vt.is_distributor||Vt.IsDistributor||Vt.isDistributor)&&wr.push("Distributor"),Ar["Account Type"]=wr.length>0?wr.join(", "):"No"}return Ar}),xt=Wi.json_to_sheet(ot),zt=Wi.book_new();Wi.book_append_sheet(zt,xt,"Users"),xx(zt,`users_export${dt.length>0?"_selected":""}.xlsx`)}catch(ae){console.error("Export failed",ae),De("Export failed"),Xe("error"),ye(!0)}finally{f(!1)}},I=ae=>ae?ae.keyValues||ae.key_values||ae.key_value||ae.keyvalue||[]:[],U=(ae,we=[])=>{if(!ae)return null;const Fe=ae.documents||ae.uploaded_documents||[],Ye=we.map(me=>String(me).toLowerCase());return Fe.find(me=>{const Be=String((me==null?void 0:me.doc_type)||(me==null?void 0:me.type)||"").toLowerCase();return Ye.some(Ge=>Ge&&Be.includes(Ge))})||null},k=(ae,we=[],Fe=[],Ye=["doc_number"])=>{if(!ae)return"";for(const Be of Fe)if(ae[Be])return ae[Be];const me=U(ae,we);if(me){for(const Be of Ye)if(me[Be])return me[Be]}return""},_=(ae,we)=>{const Fe=(_t,ot)=>{let xt="",zt="";return _t&&typeof _t=="object"?(xt=_t.name||_t.country||_t.label||_t.title||"",zt=_t.code||_t.dial_code||_t.dialCode||_t.country_code||_t.phone_code||""):typeof _t=="string"&&(/^\+/.test(_t)||/^\d+$/.test(_t)?zt=_t:xt=_t),ot&&typeof ot=="object"?(zt=zt||ot.code||ot.dial_code||ot.dialCode||ot.country_code||ot.phone_code||"",xt=xt||ot.name||ot.country||ot.label||""):typeof ot=="string"&&(zt?xt=xt||ot:/^\+/.test(ot)||/^\d+$/.test(ot)?zt=ot:xt=xt||ot),{name:xt,code:zt}},{name:Ye,code:me}=Fe(ae,we);let Be=Ye;if(!Be&&me){const _t=String(me).trim();typeof zu<"u"&&zu&&(Be=zu[_t]||zu[_t.replace(/^\+/,"")])}const Ge=me?String(me).trim():"",mt=Ge?Ge.startsWith("+")?Ge:"+"+Ge.replace(/^\+/,""):"";return Be&&mt?`${Be} ${mt}`:Be||mt||""},R=ae=>{if(!ae)return"";if(ae.company_name||ae.companyname)return ae.company_name||ae.companyname;const we=ae.salutation||ae.Salutation||ae.title||"",Fe=ae.firstname||ae.first_name||ae.Firstname||ae.FirstName||ae.name||ae.fullname||ae.full_name||"",Ye=ae.lastname||ae.last_name||ae.Lastname||ae.LastName||"";return[we,Fe,Ye].filter(Boolean).join(" ").trim()},j=ae=>String(ae).replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),A=ae=>{const we=(n.name||"").trim();if(!we)return ae;if(ae==null)return"";if(typeof ae!="string")return ae;const Fe=j(we),Ye=new RegExp(`(${Fe})`,"ig");return ae.split(Ye).map((Be,Ge)=>Be.toLowerCase()===we.toLowerCase()?a.jsx("span",{style:{backgroundColor:"#fff59d",padding:"0 2px",borderRadius:2},children:Be},Ge):Be)},[N,V]=G.useState(!1),[M,Z]=G.useState(null),[J,re]=G.useState(!1),[X,ne]=G.useState([]),[Y,K]=G.useState([]),[ee,ue]=G.useState(!1),[se,ce]=G.useState(!1),[fe,ve]=G.useState(!1),[_e,le]=G.useState(null),ke=ae=>{le(ae),ve(!0)},Te=async()=>{var ae,we,Fe,Ye;if(_e)try{await ut.delete(`${Je}/api/users/${_e.id}`),t(me=>me.filter(Be=>Be.id!==_e.id)),d(me=>typeof me=="number"?Math.max(0,me-1):me),De("User deleted successfully"),Xe("success"),ye(!0)}catch(me){const Be=((we=(ae=me==null?void 0:me.response)==null?void 0:ae.data)==null?void 0:we.details)||((Ye=(Fe=me==null?void 0:me.response)==null?void 0:Fe.data)==null?void 0:Ye.error)||(me==null?void 0:me.message)||"Failed to delete user";De(Be),Xe("error"),ye(!0)}finally{ve(!1),le(null)}},[pe,ye]=G.useState(!1),[ge,De]=G.useState(""),[He,Xe]=G.useState("info"),at=(ae,we)=>{we!=="clickaway"&&ye(!1)},[dt,wt]=G.useState([]),[$t,Bt]=G.useState(!1),[ft,tr]=G.useState(null),[Me,tt]=G.useState(!1),[Ze,St]=G.useState([]),[et,Ht]=G.useState(!1),[Nt,kt]=G.useState(new Set),[kr,Jt]=G.useState(!1),[Pt,Ur]=G.useState(null),[Lr,vt]=G.useState({}),nr=ae=>String(ae||"").toLowerCase().replace(/[^a-z0-9]/g,""),Cr=(ae=[],we=[])=>{const Fe={};return Array.isArray(ae)&&ae.forEach(Ye=>{const me=typeof Ye.row=="number"?Ye.row-1:null,Be=me!==null&&Array.isArray(we)&&we[me]?we[me]:Ye.data||{};if(me===null)return;Fe[me]=Fe[me]||{},(Array.isArray(Ye.errors)?Ye.errors:[Ye.errors].filter(Boolean)).forEach(mt=>{const _t=String(mt||""),ot=_t.toLowerCase();let xt=!1;if(Object.keys(Be||{}).forEach(Vt=>{if(xt)return;const Ar=nr(Vt);Ar&&ot.includes(Ar)&&(Fe[me][Vt]=Fe[me][Vt]||[],Fe[me][Vt].push(_t),xt=!0)}),xt)return;const zt=[["bank",["BankName","BranchName","BranchAddress","AccountNumber","IFSCCode"]],["account",["AccountNumber"]],["ifsc",["IFSCCode"]],["email",["Email"]],["mobile",["MobileNumber"]],["aadhar",["AadharNumber"]],["pan",["PANNumber"]],["gst",["GSTIN"]],["name",["FirstName","LastName","CompanyName"]],["country",["Country","Permanent Country"]],["active",["Active"]]];for(const[Vt,Ar]of zt)if(ot.includes(Vt)){Ar.forEach(wr=>{const Nr=Object.keys(Be||{}).find(Dr=>nr(Dr)===nr(wr))||Object.keys(Be||{}).find(Dr=>nr(Dr).includes(nr(wr)));Nr&&(Fe[me][Nr]=Fe[me][Nr]||[],Fe[me][Nr].push(_t))}),xt=!0;break}xt||Object.keys(Be||{}).forEach(Vt=>{Fe[me][Vt]=Fe[me][Vt]||[],Fe[me][Vt].push(_t)})})}),Fe},Dt=ae=>{const we=ae.target.checked;wt(we?r.map(Fe=>Fe.id):[])},je=ae=>{wt(we=>we.includes(ae)?we.filter(Fe=>Fe!==ae):[...we,ae])},ct=async()=>{const ae=new B2.Workbook,we=ae.addWorksheet("User Import Template"),Fe=["User Code","Salutation *","FirstName *","LastName","DOB","Gender *","Country *","MobileNumber *","Email *","EmergencyNumber","AlternateNumber","WhatsappNumber","Website","Address1","Address2","Address3","City *","State *","Permanent Country *","Pincode","BusinessName","CompanyName","IndustrySegment","Designation","Title","BankName","BranchName","BranchAddress","AccountNumber","IFSCCode","AadharNumber","PANNumber","GSTIN","MSMENo","Additional Address","Additional Bank Info","Active *","Account Type *"];we.addRow(Fe);const Ye=["USR001","Mr","John","Doe","1990-01-15","Male","India (+91)","9876543210","john.doe@example.com","9876543211","","9876543210","https://example.com","123 Main St","Apt 4B","Near Park","Mumbai","Maharashtra","India (+91)","400001","Acme Trading","Acme Pvt Ltd","Manufacturing","Manager","Mr","HDFC Bank","Andheri Branch","Andheri West","1234567890","HDFC0001234","123456789012","ABCDE1234F","27ABCDE1234F1Z5","MSME12345","Title: Alt address title|GSTIN:XXXXX|Address1:Somewhere|Additional: CustomField:Value; AnotherField:AnotherValue","Bank: ICICI|Branch: Andheri|Account: 0987654321|Additional: BankType:Savings; Priority:High","Yes","Customer,Dealer"];we.addRow(Ye);for(let Dr=0;Dr<10;Dr++)we.addRow(new Array(Fe.length).fill(""));const me=ae.addWorksheet("Lists"),Be=["Mr","Mrs","Ms","Miss","Dr","Prof","Mx"],Ge=["Male","Female","Other","Prefer not to say"],mt=["Yes","No"],_t=["Customer","Supplier","Dealer","Distributor"],ot=typeof nv<"u"&&Array.isArray(nv)&&nv.length>0?nv:Array.isArray(Hs)?Hs.map(Dr=>`${Dr.name} (${Dr.code})`):[];[Be,Ge,ot,mt,_t].forEach((Dr,Yr)=>{for(let Vr=0;Vr<Dr.length;Vr++)me.getCell(Vr+1,Yr+1).value=Dr[Vr]}),me.state="veryHidden";const zt={2:{sheetCol:"A",length:Be.length},6:{sheetCol:"B",length:Ge.length},7:{sheetCol:"C",length:ot.length},19:{sheetCol:"C",length:ot.length},37:{sheetCol:"D",length:mt.length},38:{sheetCol:"E",length:_t.length}};Object.keys(zt).forEach(Dr=>{const Yr=parseInt(Dr,10),{sheetCol:Vr,length:on}=zt[Yr];if(!Vr||!on)return;const xn=`=Lists!$${Vr}$1:$${Vr}$${on}`;we.getColumn(Yr).eachCell((ia,yn)=>{yn>1&&(ia.dataValidation={type:"list",allowBlank:!0,showInputMessage:!0,formulae:[xn]},ia.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF7F7F7"}})})});const Vt=await ae.xlsx.writeBuffer(),Ar=new Blob([Vt],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),wr=URL.createObjectURL(Ar),Nr=document.createElement("a");Nr.setAttribute("href",wr),Nr.setAttribute("download","user_import_template.xlsx"),Nr.style.visibility="hidden",document.body.appendChild(Nr),Nr.click(),document.body.removeChild(Nr)},nt=async()=>{if(!ft){alert("Please select a file to import.");return}tt(!0);try{const ae=new FileReader;ae.onload=async we=>{try{const Fe=we.target.result;if(console.log("Raw CSV data:",Fe),!Fe.trim()){alert("The CSV file appears to be empty."),tt(!1);return}let Ye=Fe.split(`
`).filter(Nr=>Nr.trim());if(Ye.length===0){alert("The CSV file appears to be empty."),tt(!1);return}Ye.length===1&&Ye[0].includes("\r")&&(Ye=Fe.split("\r").filter(Nr=>Nr.trim()));const me=Ye[0].includes(";")?";":",",Be=Ye[0].split(me).map(Nr=>Nr.trim().replace(/^"|"$/g,"").replace(/""/g,'"')),Ge=Ye.slice(1);console.log("Headers:",Be),console.log("Data rows:",Ge.length);const mt=Be.map(Nr=>String(Nr).toLowerCase().replace(/[^a-z0-9]/g,"")),ot=["firstname","lastname","mobilenumber","email","active"].filter(Nr=>!mt.includes(Nr));if(ot.length>0){const Nr=ot.map(Dr=>Dr==="firstname"?"FirstName":Dr==="lastname"?"LastName":Dr==="mobilenumber"?"MobileNumber":Dr==="msmeno"?"MSMENo":Dr.charAt(0).toUpperCase()+Dr.slice(1));alert(`Missing required headers: ${Nr.join(", ")}. Please check your CSV file format.`),tt(!1);return}const xt=Ge.map(Nr=>{let Dr=[],Yr=!1,Vr="";if(me===";")Dr=Nr.split(me).map(xn=>xn.trim().replace(/^"|"$/g,"").replace(/""/g,'"'));else{for(let xn=0;xn<Nr.length;xn++){const ia=Nr[xn];ia==='"'&&(xn===0||Nr[xn-1]!=="\\")?Yr=!Yr:ia===me&&!Yr?(Dr.push(Vr.trim().replace(/^"|"$/g,"").replace(/""/g,'"')),Vr=""):Vr+=ia}Dr.push(Vr.trim().replace(/^"|"$/g,"").replace(/""/g,'"'))}const on={};return Be.forEach((xn,ia)=>{on[xn]=Dr[ia]||""}),on});console.log("Converted object data:",xt);const zt=xt.filter(Nr=>Object.values(Nr).some(Dr=>Dr&&Dr.toString().trim()!==""));if(zt.length===0){alert("The CSV file has headers but no valid data rows."),tt(!1);return}mt.includes("country")||mt.includes("permanentcountry")||zt.forEach(Nr=>{Nr.Country="India (+91)"}),mt.includes("permanentcountry")||zt.forEach(Nr=>{const Dr={},Yr=Object.keys(Nr);let Vr=!1;Yr.forEach(on=>{Dr[on]=Nr[on];const xn=String(on).replace(/\s*\*\s*$/g,"").toLowerCase();!Vr&&xn==="pincode"&&(Dr["Permanent Country"]=Nr["Permanent Country"]||"India (+91)",Vr=!0)}),Vr||(Dr["Permanent Country"]=Nr["Permanent Country"]||"India (+91)"),Object.keys(Nr).forEach(on=>delete Nr[on]),Object.assign(Nr,Dr)}),St(zt);const wr=new Set(zt.map((Nr,Dr)=>Dr));kt(wr),Bt(!1),Ht(!0),tt(!1)}catch(Fe){console.error("Error importing users:",Fe),alert(`Failed to import users: ${Fe.message}`),tt(!1)}},ae.readAsText(ft)}catch(ae){console.error("Error reading file:",ae),alert("Failed to read the selected file."),tt(!1)}},Pe=ae=>{const we=[],Fe=["Salutation","FirstName","Gender","Country","MobileNumber","Email","City","State","Active","Account Type"];return ae.forEach((Ye,me)=>{const Be=[],Ge=zt=>{if(Ye[zt]!==void 0)return Ye[zt];if(Ye[`${zt} *`]!==void 0)return Ye[`${zt} *`];const Vt=zt.toLowerCase().replace(/\s+/g,"").replace(/\*/g,"");for(const Ar in Ye)if(Ar.toLowerCase().replace(/\s+/g,"").replace(/\*/g,"")===Vt)return Ye[Ar]};Fe.forEach(zt=>{const Vt=Ge(zt);(!Vt||Vt.toString().trim()==="")&&Be.push(`${zt} is mandatory and cannot be empty`)});const mt=Ge("Email");mt&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(mt).trim())&&Be.push("Email must be in valid format");const _t=Ge("MobileNumber")||Ge("Mobile Number")||Ge("Mobile");if(_t){const zt=String(_t).replace(/\D/g,"");(zt.length<7||zt.length>15)&&Be.push("MobileNumber must be a valid phone number (7-15 digits)")}const ot=Ge("Active");if(ot&&String(ot).trim()!==""){const zt=String(ot).toLowerCase().trim();["yes","no","true","false","active","inactive","1","0"].includes(zt)||Be.push("Active must be one of: yes/no/true/false/active/inactive/1/0")}const xt=Ge("Account Type")||Ge("AccountType")||Ge("Account");if(xt&&String(xt).trim()!==""){const zt=String(xt).split(",").map(wr=>wr.trim().toLowerCase()).filter(Boolean),Vt=["customer","supplier","dealer","distributor","user"],Ar=zt.filter(wr=>!Vt.includes(wr));Ar.length>0&&Be.push(`Account Type contains invalid values: ${Ar.join(", ")}`)}Be.length>0&&we.push({row:me+1,data:Ye,errors:Be})}),we},Qe=async()=>{var ae;tt(!0);try{const we=Ze.filter((_t,ot)=>Nt.has(ot));if(we.length===0){alert("No rows selected for import. Please select at least one row."),tt(!1);return}const Fe=Pe(we);if(Fe.length>0){vt(Cr(Fe,we)),Ur({type:"validation_error",totalRows:we.length,successCount:0,errorCount:Fe.length,errors:Fe,successes:[]}),Jt(!0),tt(!1);return}const Ye=we.map(_t=>{const ot={};Object.keys(_t).forEach(zt=>{const Vt=zt.replace(/\s*\*\s*/g,"").trim();ot[Vt]=_t[zt]});const xt=["Country","Permanent Country","Country Code","country_code"];for(const zt of xt)if(ot[zt]!==void 0&&ot[zt]!==null){let Vt=String(ot[zt]).trim();Vt!==""&&/^\d+$/.test(Vt)&&!Vt.startsWith("+")&&(ot[zt]="+"+Vt)}return ot}),me=Ye.map(_t=>{const ot=mn=>{for(const Or of mn)if(_t[Or]!==void 0&&_t[Or]!==null)return String(_t[Or]).trim()},xt={},zt=ot(["User Code","UserCode","user code","usercode","user_code"]);zt&&(xt.usercode=zt,xt.user_code=zt);const Vt=ot(["CompanyName","Company Name","companyname"]);Vt&&(xt.company_name=Vt);const Ar=ot(["Salutation"]);Ar&&(xt.salutation=Ar);const wr=ot(["FirstName","First Name"]);wr&&(xt.firstname=wr);const Nr=ot(["LastName","Last Name"]);Nr&&(xt.lastname=Nr);const Dr=ot(["DOB","Date of Birth","dob"]);Dr&&(xt.dob=Dr);const Yr=ot(["Gender"]);Yr&&(xt.gender=Yr);const Vr=ot(["Country"]);Vr&&(xt.country=Vr);const on=ot(["MobileNumber","Mobile Number","mobile","mobile_number"]);on&&(xt.mobile_number=on);const xn=ot(["EmergencyNumber","Emergency Number"]);xn&&(xt.emergency_number=xn);const ia=ot(["AlternateNumber","Alternate Number"]);ia&&(xt.alternate_number=ia);const yn=ot(["WhatsappNumber","WhatsApp Number"]);yn&&(xt.whatsapp_number=yn);const oa=ot(["Email"]);oa&&(xt.email=oa);const Qn=ot(["Website"]);Qn&&(xt.website=Qn);const za=ot(["Address1","Address 1"]);za&&(xt.permanent_address1=za);const pr=ot(["Address2","Address 2"]);pr&&(xt.permanent_address2=pr);const Ir=ot(["Address3","Address 3"]);Ir&&(xt.permanent_address3=Ir);const $n=ot(["City"]);$n&&(xt.permanent_city=$n);const Fr=ot(["State"]);Fr&&(xt.permanent_state=Fr);const jr=ot(["Permanent Country","PermanentCountry","Country"]);jr&&(xt.permanent_country=jr);const Le=ot(["Pincode"]);Le&&(xt.permanent_pincode=Le);const rt=ot(["BusinessName","Business Name"]);rt&&(xt.business_name=rt);const Ke=ot(["IndustrySegment","Industry Segment"]);Ke&&(xt.industry_segment=Ke);const pt=ot(["Designation"]);pt&&(xt.designation=pt);const rr=ot(["Title"]);rr&&(xt.title=rr);const ur=ot(["BankName","Bank Name"]);ur&&(xt.primary_bank_name=ur);const Rr=ot(["BranchName","Branch Name"]);Rr&&(xt.primary_branch_name=Rr);const Kr=ot(["BranchAddress","Branch Address"]);Kr&&(xt.primary_branch_address=Kr);const sr=ot(["AccountNumber","Account Number"]);sr&&(xt.primary_account_number=sr);const jn=ot(["IFSCCode","IFSC Code"]);jn&&(xt.primary_ifsc_code=jn);const Kt=ot(["AadharNumber","Aadhar Number"]);Kt&&(xt.aadhar_number=Kt);const qt=ot(["PANNumber","PAN Number"]);qt&&(xt.pan_number=qt);const Gr=ot(["GSTIN"]);Gr&&(xt.gstin_number=Gr);const fn=ot(["MSMENo","MSME No"]);fn&&(xt.msme_no=fn);const rn=ot(["Additional Address"]);if(rn)try{const mn=JSON.parse(rn);Array.isArray(mn)?xt.addresses=mn.map(Or=>({title:Or.title||Or.Title||"Additional",address1:Or.address1||Or.Address1,address2:Or.address2||Or.Address2,address3:Or.address3||Or.Address3,city:Or.city||Or.City,state:Or.state||Or.State,country:Or.country||Or.Country,pincode:Or.pincode||Or.Pincode,gstin:Or.gstin||Or.GSTIN})):xt.addresses=[{title:mn.title||mn.Title||"Additional",address1:mn.address1||mn.Address1,address2:mn.address2||mn.Address2,address3:mn.address3||mn.Address3,city:mn.city||mn.City,state:mn.state||mn.State,country:mn.country||mn.Country,pincode:mn.pincode||mn.Pincode,gstin:mn.gstin||mn.GSTIN}]}catch{const Or=rn.split(`
`).filter(wa=>wa.trim());xt.addresses=Or.map(wa=>{const Vn={};return wa.split("|").map(Qr=>Qr.trim()).forEach(Qr=>{if(Qr.includes(":")){const[qn,...ks]=Qr.split(":"),wn=ks.join(":").trim(),ka=qn.trim().toLowerCase();if(ka==="title")Vn.title=wn;else if(ka==="gstin")Vn.gstin=wn;else if(ka==="address1")Vn.address1=wn;else if(ka==="address2")Vn.address2=wn;else if(ka==="address3")Vn.address3=wn;else if(ka==="city")Vn.city=wn;else if(ka==="state")Vn.state=wn;else if(ka==="country")Vn.country=wn;else if(ka==="pincode")Vn.pincode=wn;else if(ka==="additional"){const Xn=wn.split(";").map(st=>st.trim());Vn.keyValues=Xn.map(st=>{const[Wt,...At]=st.split(":");return{key:Wt.trim(),value:At.join(":").trim()}}).filter(st=>st.key)}}else Vn.title||(Vn.title=Qr)}),Vn.title||(Vn.title="Additional"),Vn})}const $a=ot(["Additional Bank Info"]);if($a){const Or=$a.split(`
`).filter(wa=>wa.trim()).map(wa=>{const Vn={};return wa.split("|").map(Qr=>Qr.trim()).forEach(Qr=>{const[qn,...ks]=Qr.split(":"),wn=ks.join(":").trim(),ka=qn.trim().toLowerCase();if(ka==="bank")Vn.bank_name=wn;else if(ka==="branch")Vn.branch_name=wn;else if(ka==="address")Vn.branch_address=wn;else if(ka==="account")Vn.account_number=wn;else if(ka==="ifsc")Vn.ifsc_code=wn;else if(ka==="additional"){const Xn=wn.split(";").map(st=>st.trim());Vn.keyValues=Xn.map(st=>{const[Wt,...At]=st.split(":");return{key:Wt.trim(),value:At.join(":").trim()}}).filter(st=>st.key)}}),Vn}).filter(wa=>Object.keys(wa).length>0);Or.length>0&&(xt.bank_accounts=Or)}const la=ot(["Active"]);if(la!==void 0){const mn=String(la).toLowerCase().trim();xt.active=["yes","true","active","1"].includes(mn)}const ja=ot(["Account Type","AccountType"]);if(ja){const mn=String(ja).split(",").map(Or=>Or.trim().toLowerCase());xt.is_customer=mn.includes("customer"),xt.is_supplier=mn.includes("supplier"),xt.is_dealer=mn.includes("dealer"),xt.is_distributor=mn.includes("distributor")}return xt});console.log("Sending import data:",me);const Be=await ut.post(`${Je}/api/users/import`,me,{headers:{"Content-Type":"application/json"}});console.log("Import response:",Be.data);const Ge=[];Be.data.errors&&Array.isArray(Be.data.errors)&&Be.data.errors.forEach(_t=>{const ot=_t.match(/^Row (\d+):\s*(.+)$/);if(ot){const xt=parseInt(ot[1],10),zt=ot[2],Vt=xt-1,Ar=Ye[Vt]||{};Ge.push({row:xt,data:Ar,userName:Ar.Name||(Ar["First Name"]?(Ar["First Name"]||"")+" "+(Ar["Last Name"]||""):"N/A"),userCode:Ar["User Code"]||Ar.usercode||"N/A",errors:[zt]})}else Ge.push({row:"N/A",data:{},userName:"N/A",userCode:"N/A",errors:[_t]})});const mt={type:"import_complete",totalRows:we.length,successCount:Be.data.imported||0,errorCount:Ge.length,errors:Ge,successes:Be.data.successes||[],skipped:Be.data.skipped||0};Ht(!1),Ge.length===0&&(tr(null),St([]),kt(new Set)),Ur(mt),Jt(!0),Be.data.imported>0&&(i(0),s({name:"",deptHead:"",userType:""}),setTimeout(()=>{q()},300))}catch(we){console.error("Error importing users:",we);let Fe="Unknown server error",Ye=[];(ae=we.response)!=null&&ae.data?(we.response.data.error?Fe=we.response.data.error:we.response.data.message&&(Fe=we.response.data.message),we.response.data.errors&&Array.isArray(we.response.data.errors)&&we.response.data.errors.forEach(Be=>{const Ge=Be.match(/^Row (\d+):\s*(.+)$/);if(Ge){const mt=parseInt(Ge[1],10),_t=Ge[2];Ye.push({row:mt,userName:"N/A",userCode:"N/A",errors:[_t]})}else Ye.push({row:"N/A",userName:"N/A",userCode:"N/A",errors:[Be]})})):we.message&&(Fe=we.message);const me=Ze.filter((Be,Ge)=>Nt.has(Ge));vt(Cr(Ye,me)),Ur({type:"import_failed",totalRows:Ze.filter((Be,Ge)=>Nt.has(Ge)).length,successCount:0,errorCount:Ye.length>0?Ye.length:1,errors:Ye.length>0?Ye:[{row:"Server Error",userName:"N/A",userCode:"N/A",errors:[Fe]}],successes:[]}),Jt(!0)}finally{tt(!1)}},gt=ae=>{const we=["Uploaded Documents","Additional Address","Additional Bank Info"],Fe=["Address1","Address2","Address3","BusinessName","CompanyName","Email","Website","Title","Designation","IndustrySegment"],Ye=["User Code","S.No","Name","DOB","Gender","Country","MobileNumber","EmergencyNumber","AlternateNumber","WhatsappNumber","Pincode","City","State"];return we.includes(ae)?300:Fe.includes(ae)?200:Ye.includes(ae)?120:160};return a.jsxs(Ut,{p:1,mt:8,children:[a.jsxs(Ut,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2,children:[a.jsx(Et,{variant:"h5",children:"User Master"}),a.jsxs("div",{className:"header-search",style:{width:400},children:[a.jsx("input",{className:"search-input",type:"text",placeholder:"Search",value:n.name,onChange:ae=>s({...n,name:ae.target.value}),onKeyDown:ae=>ae.key==="Enter"&&D(),"aria-label":"Search"}),a.jsx("button",{className:"search-btn",type:"button",onClick:D,"aria-label":"search",children:""})]})]}),a.jsx(sa,{sx:{p:1,mb:2},children:a.jsxs(Ut,{display:"flex",alignItems:"center",width:"100%",children:[a.jsx(Ut,{flex:.5,sx:{mr:1},children:a.jsx(bc,{size:"small",options:p,getOptionLabel:ae=>ae.label||"",value:p.find(ae=>ae.id===n.deptHead)||null,onChange:(ae,we)=>{s({...n,deptHead:we?we.id:"",executiveID:""})},renderInput:ae=>a.jsx(ri,{...ae,label:"Dept Head"}),isOptionEqualToValue:(ae,we)=>ae.id===we.id})}),a.jsx(Ut,{flex:.4,sx:{mr:1},children:a.jsx(bc,{size:"small",options:g,getOptionLabel:ae=>ae.label||"",value:g.find(ae=>ae.id===n.executiveID)||null,onChange:(ae,we)=>{s({...n,executiveID:we?we.id:""})},renderInput:ae=>a.jsx(ri,{...ae,label:"Select Executive"}),isOptionEqualToValue:(ae,we)=>ae.id===we.id,disabled:!n.deptHead})}),a.jsx(Ut,{flex:.3,children:a.jsxs(O6,{fullWidth:!0,size:"small",children:[a.jsx(F6,{children:"Account Type"}),a.jsxs(eh,{value:n.userType,label:"Account Type",onChange:ae=>s({...n,userType:ae.target.value}),children:[a.jsx(zl,{value:"",children:"All"}),a.jsx(zl,{value:"customer",children:"Customer"}),a.jsx(zl,{value:"supplier",children:"Supplier"}),a.jsx(zl,{value:"dealer",children:"Dealer"}),a.jsx(zl,{value:"distributor",children:"Distributor"})]})]})}),a.jsx(bs,{title:"Display Preferences",children:a.jsx(sn,{sx:{mx:2},"aria-label":"table view",onClick:O,children:a.jsx(v7,{})})}),a.jsx(bs,{title:"Import",children:a.jsx(sn,{sx:{mx:2},"aria-label":"import",onClick:()=>Bt(!0),children:a.jsx(D6,{})})}),a.jsx(bs,{title:"Export",children:a.jsx(sn,{sx:{mx:2},"aria-label":"export",onClick:P,children:a.jsx(g7,{})})}),a.jsx(Br,{variant:"contained",color:"primary",sx:{ml:2,flex:.2},onClick:()=>e("/users/add"),children:"+ Add User"})]})}),a.jsxs(sa,{children:[h?a.jsx(Ut,{p:3,textAlign:"center",children:a.jsx(Vs,{})}):r.length===0?a.jsx(Ut,{p:3,textAlign:"center",children:"No users found."}):a.jsx(Ws,{sx:{width:"100%",overflowX:"auto"},children:a.jsxs(Cs,{size:"small",sx:{width:"100%",tableLayout:"auto"},children:[a.jsx(js,{children:a.jsxs(pn,{children:[a.jsx(qe,{padding:"checkbox",children:a.jsx(Wn,{checked:r.length>0&&dt.length===r.length,indeterminate:dt.length>0&&dt.length<r.length,onChange:Dt,size:"small"})}),a.jsx(qe,{sx:{fontWeight:"bold"},children:"S.No"}),(()=>{const ae=S.filter(me=>C.includes(me)),we=["IsCustomer","IsSupplier","IsDealer","IsDistributor"],Fe=ae.some(me=>we.includes(me)),Ye=ae.filter(me=>!we.includes(me));return a.jsxs(a.Fragment,{children:[Ye.map(me=>a.jsx(qe,{sx:{fontWeight:"bold",minWidth:gt(me)},children:me},me)),Fe&&a.jsx(qe,{sx:{fontWeight:"bold",minWidth:160},children:"Account Type"},"AccountType")]})})(),C.length>0&&a.jsx(qe,{sx:{fontWeight:"bold",minWidth:140},align:"center",children:"Actions"})]})}),a.jsx(fs,{children:r.map((ae,we)=>a.jsxs(pn,{selected:dt.includes(ae.id),hover:!0,sx:{cursor:"pointer"},onClick:()=>{Z(ae),V(!0)},children:[a.jsx(qe,{padding:"checkbox",children:a.jsx(Wn,{checked:dt.includes(ae.id),onChange:()=>je(ae.id),onClick:Fe=>Fe.stopPropagation(),size:"small"})}),a.jsx(qe,{children:o*c+we+1}),(()=>{const Fe=S.filter(Ge=>C.includes(Ge)),Ye=["IsCustomer","IsSupplier","IsDealer","IsDistributor"],me=Fe.some(Ge=>Ye.includes(Ge)),Be=Fe.filter(Ge=>!Ye.includes(Ge));return a.jsxs(a.Fragment,{children:[Be.map((Ge,mt)=>{var _t,ot,xt,zt,Vt,Ar,wr,Nr,Dr,Yr,Vr,on,xn,ia,yn,oa,Qn,za,pr,Ir,$n,Fr;return a.jsx(qe,{sx:{minWidth:gt(Ge),whiteSpace:["Name","User Code","Email","MobileNumber","Country","Permanent Country","Pincode"].includes(Ge)?"nowrap":"normal",overflow:["Name","User Code","Email","MobileNumber","Country","Permanent Country","Pincode"].includes(Ge)?"hidden":"visible",textOverflow:["Name","User Code","Email","MobileNumber","Country","Permanent Country","Pincode"].includes(Ge)?"ellipsis":"clip"},children:A(Ge==="User Code"?ae.usercode||ae.user_code||ae.userCode||ae.username||ae.email||"":Ge==="Name"?[ae.salutation,ae.firstname,ae.lastname].filter(Boolean).join(" "):Ge==="DOB"?ae.dob?new Date(ae.dob).toLocaleDateString():"":Ge==="Gender"?ae.gender:Ge==="Country"?_(ae.country,ae.country_code)||"":Ge==="MobileNumber"?ae.mobile_number:Ge==="EmergencyNumber"?ae.emergency_number:Ge==="AlternateNumber"?ae.alternate_number:Ge==="WhatsappNumber"?ae.whatsapp_number:Ge==="Email"?ae.email:Ge==="Website"?ae.website:Ge==="BusinessName"?ae.business_name:Ge==="Title"?ae.title:Ge==="CompanyName"?ae.company_name:Ge==="Designation"?ae.designation:Ge==="IndustrySegment"?ae.industry_segment:Ge==="Address1"?((ot=(_t=ae.addresses)==null?void 0:_t.find(jr=>jr.title==="Permanent"))==null?void 0:ot.address1)||"":Ge==="Address2"?((zt=(xt=ae.addresses)==null?void 0:xt.find(jr=>jr.title==="Permanent"))==null?void 0:zt.address2)||"":Ge==="Address3"?((Ar=(Vt=ae.addresses)==null?void 0:Vt.find(jr=>jr.title==="Permanent"))==null?void 0:Ar.address3)||"":Ge==="City"?((Nr=(wr=ae.addresses)==null?void 0:wr.find(jr=>jr.title==="Permanent"))==null?void 0:Nr.city)||"":Ge==="State"?((Yr=(Dr=ae.addresses)==null?void 0:Dr.find(jr=>jr.title==="Permanent"))==null?void 0:Yr.state)||"":Ge==="Permanent Country"?(()=>{var Le;const jr=(Le=ae.addresses)==null?void 0:Le.find(rt=>rt.title==="Permanent");return _(ae.permanent_country||(jr==null?void 0:jr.country),ae.permanent_country_code||(jr==null?void 0:jr.country_code))||""})():Ge==="Pincode"?((on=(Vr=ae.addresses)==null?void 0:Vr.find(jr=>jr.title==="Permanent"))==null?void 0:on.pincode)||"":Ge==="AadharNumber"?k(ae,["aadhaar","aadhar","aadhaar card","aadhar card"],["aadhar_number","aadhaar"],["aadhar_number","doc_number"]):Ge==="PANNumber"?k(ae,["pan","pan card","permanent account number"],["pan_number","pan"],["pan_number","doc_number"]):Ge==="GSTIN"?k(ae,["gstin","gst","goods and services tax"],["gstin_number","gstin"],["gstin_number","doc_number"]):Ge==="Uploaded Documents"?(()=>{const jr=ae.documents||ae.uploaded_documents||[];return!Array.isArray(jr)||jr.length===0?"":jr.map((Le,rt)=>{const Ke=Le.doc_type||Le.type||"",pt=Le.doc_number||Le.number||Le.doc_no||"",rr=Le.file_name||Le.file_url||Le.url||Le.file_path||"";return a.jsxs("div",{style:{marginBottom:8},children:[a.jsxs("div",{children:[a.jsx("b",{children:"Type:"})," ",Ke,pt?a.jsxs("span",{style:{marginLeft:8},children:[a.jsx("b",{children:"No:"})," ",pt]}):null]}),a.jsx("div",{style:{whiteSpace:"pre-wrap"},children:rr})]},rt)})})():Ge==="MSMENo"?k(ae,["msme","micro small medium enterprise"],["msme_no","msmeno"],["msme_no","doc_number"]):Ge==="BankName"?((ia=(xn=ae.bank_accounts)==null?void 0:xn[0])==null?void 0:ia.bank_name)||"":Ge==="BranchName"?((oa=(yn=ae.bank_accounts)==null?void 0:yn[0])==null?void 0:oa.branch_name)||"":Ge==="BranchAddress"?((za=(Qn=ae.bank_accounts)==null?void 0:Qn[0])==null?void 0:za.branch_address)||"":Ge==="AccountNumber"?((Ir=(pr=ae.bank_accounts)==null?void 0:pr[0])==null?void 0:Ir.account_number)||"":Ge==="IFSCCode"?((Fr=($n=ae.bank_accounts)==null?void 0:$n[0])==null?void 0:Fr.ifsc_code)||"":Ge==="Active"?ae.active?"Yes":"No":Ge==="Additional Address"?Array.isArray(ae.addresses)&&ae.addresses.length>0?ae.addresses.filter(jr=>jr.title!=="Permanent").map((jr,Le)=>a.jsxs("div",{style:{marginBottom:8},children:[a.jsxs("div",{children:[a.jsx("b",{children:"Title:"})," ",jr.title]}),(jr.gstin||jr.gstin_number)&&a.jsxs("div",{children:[a.jsx("b",{children:"GSTIN:"})," ",jr.gstin||jr.gstin_number]}),jr.address1&&a.jsxs("div",{children:[a.jsx("b",{children:"Address1:"})," ",jr.address1]}),jr.address2&&a.jsxs("div",{children:[a.jsx("b",{children:"Address2:"})," ",jr.address2]}),jr.address3&&a.jsxs("div",{children:[a.jsx("b",{children:"Address3:"})," ",jr.address3]}),jr.city&&a.jsxs("div",{children:[a.jsx("b",{children:"City:"})," ",jr.city]}),jr.state&&a.jsxs("div",{children:[a.jsx("b",{children:"State:"})," ",jr.state]}),jr.country&&a.jsxs("div",{children:[a.jsx("b",{children:"Country:"})," ",jr.country]}),jr.pincode&&a.jsxs("div",{children:[a.jsx("b",{children:"Pincode:"})," ",jr.pincode]}),Array.isArray(jr.keyValues||jr.key_values||jr.key_value||jr.keyvalue)&&(jr.keyValues||jr.key_values||jr.key_value||jr.keyvalue).length>0&&a.jsxs("div",{style:{marginTop:6},children:[a.jsx("b",{children:"Additional Info:"}),a.jsx("div",{children:(jr.keyValues||jr.key_values||jr.key_value||jr.keyvalue).map((rt,Ke)=>a.jsx("div",{children:a.jsxs("small",{children:[rt.key,": ",rt.value]})},Ke))})]})]},Le)):"":Ge==="Additional Bank Info"&&Array.isArray(ae.bank_accounts)&&ae.bank_accounts.length>1?ae.bank_accounts.slice(1).map((jr,Le)=>a.jsxs("div",{style:{marginBottom:8},children:[jr.bank_name&&a.jsxs("div",{children:[a.jsx("b",{children:"Bank:"})," ",jr.bank_name]}),jr.branch_name&&a.jsxs("div",{children:[a.jsx("b",{children:"Branch:"})," ",jr.branch_name]}),jr.branch_address&&a.jsxs("div",{children:[a.jsx("b",{children:"Address:"})," ",jr.branch_address]}),jr.account_number&&a.jsxs("div",{children:[a.jsx("b",{children:"Account:"})," ",jr.account_number]}),jr.ifsc_code&&a.jsxs("div",{children:[a.jsx("b",{children:"IFSC:"})," ",jr.ifsc_code]}),Array.isArray(jr.keyValues||jr.key_values||jr.key_value||jr.keyvalue)&&(jr.keyValues||jr.key_values||jr.key_value||jr.keyvalue).length>0&&a.jsxs("div",{style:{marginTop:6},children:[a.jsx("b",{children:"Additional:"}),a.jsx("div",{children:(jr.keyValues||jr.key_values||jr.key_value||jr.keyvalue).map((rt,Ke)=>a.jsx("div",{children:a.jsxs("small",{children:[rt.key,": ",rt.value]})},Ke))})]})]},Le)):"")},`${Ge}-${mt}`)}),me&&a.jsx(qe,{sx:{minWidth:160},children:(()=>{const Ge=[];return ae.is_customer&&Ge.push("Customer"),ae.is_supplier&&Ge.push("Supplier"),ae.is_dealer&&Ge.push("Dealer"),ae.is_distributor&&Ge.push("Distributor"),Ge.length>0?Ge.join(", "):"No"})()}),C.length>0&&a.jsxs(qe,{align:"center",sx:{whiteSpace:"nowrap"},children:[a.jsx(bs,{title:"View",children:a.jsx(sn,{onClick:async()=>{var Ge;V(!0);try{const mt=await ut.get(`${Je}/api/users/${ae.id}`);Z(((Ge=mt.data)==null?void 0:Ge.user)||mt.data)}catch(mt){console.error("Failed to fetch user details, falling back to list item:",mt),Z(ae)}},children:a.jsx(cv,{})})}),a.jsx(bs,{title:"Edit",children:a.jsx(sn,{onClick:()=>e(`/users/${ae.id}/edit`),children:a.jsx(bl,{})})}),a.jsx(bs,{title:"Delete",children:a.jsx(sn,{onClick:Ge=>{Ge.stopPropagation(),ke(ae)},children:a.jsx(ql,{})})}),(ae.whatsapp_number||ae.mobile_number)&&(ae.whatsapp_number||ae.mobile_number).toString().trim()!==""?a.jsx(bs,{title:"WhatsApp",children:a.jsx(sn,{component:"a",href:`https://wa.me/${String(ae.whatsapp_number||ae.mobile_number).replace(/\D/g,"")}`,target:"_blank",rel:"noopener noreferrer",children:a.jsx(S8,{})})}):a.jsx(bs,{title:"WhatsApp",children:a.jsx("span",{style:{display:"inline-block"},children:a.jsx(sn,{disabled:!0,children:a.jsx(S8,{})})})}),ae.email?a.jsx(bs,{title:"Mail",children:a.jsx(sn,{component:"a",href:`mailto:${ae.email}`,children:a.jsx(w8,{})})}):a.jsx(bs,{title:"Mail",children:a.jsx("span",{style:{display:"inline-block"},children:a.jsx(sn,{disabled:!0,children:a.jsx(w8,{})})})})]})]})})()]},ae.id))})]})}),a.jsx(Ut,{p:2,display:"flex",justifyContent:"flex-end",alignItems:"center",children:a.jsx(Zm,{component:"div",count:l,page:o,onPageChange:(ae,we)=>i(we),rowsPerPage:c,onRowsPerPageChange:ae=>{u(parseInt(ae.target.value,10)),i(0)},rowsPerPageOptions:[5,10,25]})})]}),a.jsxs(Oa,{open:b,onClose:H,maxWidth:"lg",fullWidth:!0,sx:{"& .MuiDialog-paper":{width:"90%",maxWidth:1200}},children:[a.jsx(Wa,{children:"Display Preferences"}),a.jsxs(Pa,{children:[a.jsxs(Ut,{display:"flex",alignItems:"center",mb:2,children:[a.jsx(Wn,{checked:C.length===S.length,indeterminate:C.length>0&&C.length<S.length,onChange:ae=>{ae.target.checked?(L(S),localStorage.setItem("userListCheckedFields",JSON.stringify(S))):(L([]),localStorage.setItem("userListCheckedFields",JSON.stringify([])))},size:"small",sx:{p:.5,mr:1}}),a.jsx("span",{style:{fontWeight:500,fontSize:15},children:"Select All"})]}),(()=>{const ae=["IsCustomer","IsSupplier","IsDealer","IsDistributor"],we=[];let Fe=!1;for(const Ye of S)ae.includes(Ye)?Fe||(we.push("Account Type"),Fe=!0):we.push(Ye);return a.jsx(Ut,{sx:{display:"grid",gridTemplateColumns:"repeat(5, minmax(0, 1fr))",gap:2},children:we.map(Ye=>{const me=Ye==="Account Type",Be=me?ae.every(mt=>C.includes(mt)):C.includes(Ye),Ge=me&&ae.some(mt=>C.includes(mt))&&!ae.every(mt=>C.includes(mt));return a.jsxs(Ut,{sx:{display:"flex",alignItems:"center",minHeight:20},children:[a.jsx(Wn,{checked:Be,indeterminate:Ge,onChange:()=>z(Ye),size:"small",sx:{p:.5,mr:1}}),a.jsx("span",{style:{fontSize:14},children:Ye})]},Ye)})})})()]}),a.jsx(Va,{children:a.jsx(Br,{onClick:H,children:"Close"})})]}),a.jsxs(Oa,{open:J,onClose:()=>re(!1),maxWidth:"md",fullWidth:!0,children:[a.jsxs(Wa,{children:["Hierarchy for ",M?R(M):""]}),a.jsx(Pa,{dividers:!0,sx:{maxHeight:"70vh",overflowY:"auto"},children:ee?a.jsx(Ut,{display:"flex",justifyContent:"center",alignItems:"center",sx:{py:4},children:a.jsx(Vs,{})}):a.jsxs(is,{container:!0,direction:"column",spacing:2,sx:{alignItems:"stretch"},children:[a.jsxs(is,{item:!0,sx:{borderBottom:"1px solid rgba(0,0,0,0.12)",pb:2},children:[a.jsx(Et,{variant:"h6",sx:{mb:1,display:"flex",justifyContent:"center"},children:"Parent(s) (Above)"}),X.length===0?a.jsx(Et,{color:"text.secondary",sx:{display:"flex",justifyContent:"center"},children:"No parent relations found."}):a.jsx(Ut,{sx:{display:"flex",flexDirection:"row",gap:2,flexWrap:"wrap",justifyContent:"center"},children:X.map(ae=>a.jsx(sa,{sx:{p:.5,mb:1,flex:"0 0 auto"},elevation:0,children:a.jsxs(Ut,{display:"flex",alignItems:"center",sx:{gap:1},children:[a.jsxs(Ut,{sx:{minWidth:0,mr:.5},children:[a.jsx(Et,{noWrap:!0,children:R(ae)}),a.jsx(Et,{variant:"caption",color:"text.secondary",children:(()=>{const we=[];return ae.is_customer&&we.push("Customer"),ae.is_dealer&&we.push("Dealer"),ae.is_distributor&&we.push("Distributor"),ae.is_supplier&&we.push("Supplier"),we.length>0?we.join(", "):"No account type"})()})]}),a.jsx(Ut,{sx:{display:"flex",alignItems:"center"},children:a.jsx(bs,{title:"View",children:a.jsx(sn,{size:"small",sx:{p:.5},onClick:async()=>{var we;try{V(!0);const Fe=await ut.get(`${Je}/api/users/${ae.id}`);Z(((we=Fe.data)==null?void 0:we.user)||Fe.data),re(!1)}catch(Fe){console.error("Failed opening parent user",Fe)}},children:a.jsx(cv,{fontSize:"small"})})})})]})},ae.id))})]}),a.jsx(is,{item:!0,children:a.jsx(sa,{elevation:0,sx:{py:2,display:"flex",justifyContent:"center",alignItems:"center",border:"2px solid",borderColor:"primary.main",borderRadius:1,mx:"auto",px:2},children:a.jsx(Et,{variant:"h6",sx:{fontWeight:700,textAlign:"center"},children:M?R(M):""})})}),a.jsxs(is,{item:!0,sx:{borderTop:"1px solid rgba(0,0,0,0.12)",pt:2},children:[a.jsx(Et,{variant:"h6",sx:{mb:1,display:"flex",justifyContent:"center"},children:"Child(ren) (Below)"}),Y.length===0?a.jsx(Et,{color:"text.secondary",sx:{display:"flex",justifyContent:"center"},children:"No child relations found."}):a.jsx(Ut,{sx:{display:"grid",gridTemplateColumns:{xs:"repeat(auto-fit, minmax(220px, 1fr))",sm:"repeat(auto-fit, minmax(220px, 1fr))",md:"repeat(auto-fit, minmax(220px, 1fr))"},gap:2,justifyContent:Y.length<3?"center":"stretch",justifyItems:"center",textAlign:"center",maxWidth:Y.length<3?"400px":"100%",mx:Y.length<3?"auto":"0"},children:Y.map(ae=>a.jsx(sa,{sx:{p:.5,mb:1,width:"100%",display:"flex",justifyContent:"center"},elevation:0,children:a.jsxs(Ut,{display:"flex",alignItems:"center",sx:{gap:1,justifyContent:"center",width:"100%"},children:[a.jsxs(Ut,{sx:{minWidth:0,mr:.5},children:[a.jsx(Et,{noWrap:!0,children:R(ae)}),a.jsx(Et,{variant:"caption",color:"text.secondary",children:(()=>{const we=[];return ae.is_customer&&we.push("Customer"),ae.is_dealer&&we.push("Dealer"),ae.is_distributor&&we.push("Distributor"),ae.is_supplier&&we.push("Supplier"),we.length>0?we.join(", "):"No account type"})()})]}),a.jsx(Ut,{sx:{display:"flex",alignItems:"center"},children:a.jsx(bs,{title:"View",children:a.jsx(sn,{size:"small",sx:{p:.5},onClick:async()=>{var we;try{V(!0);const Fe=await ut.get(`${Je}/api/users/${ae.id}`);Z(((we=Fe.data)==null?void 0:we.user)||Fe.data),re(!1)}catch(Fe){console.error("Failed opening child user",Fe)}},children:a.jsx(cv,{fontSize:"small"})})})})]})},ae.id))})]})]})}),a.jsx(Va,{children:a.jsx(Br,{onClick:()=>re(!1),children:"Close"})})]}),a.jsx(G0,{open:fe,title:"Delete User",message:_e?`Are you sure you want to delete ${_e.firstname||_e.Firstname||_e.name||""}?`:"Are you sure you want to delete this user?",onCancel:()=>{ve(!1),le(null)},onConfirm:Te}),a.jsx(tu,{open:pe,autoHideDuration:6e3,onClose:at,children:a.jsx(eu,{onClose:at,severity:He,sx:{width:"100%"},children:ge})}),a.jsx("div",{className:`user-view-dialog ${N?"open":""}`,children:a.jsxs("div",{className:"user-view-dialog-content",children:[a.jsxs("div",{className:"user-view-dialog-header",children:[a.jsxs("div",{className:"user-view-dialog-title-section",children:[a.jsx("h2",{className:"user-view-dialog-title",children:"User Details"}),M&&R(M)&&a.jsx("p",{className:"user-view-dialog-subtitle",children:R(M)})]}),M?a.jsx("div",{className:`user-view-dialog-status ${M.active?"active":"inactive"}`,children:M.active?"Active":"Inactive"}):null]}),a.jsx("div",{className:"user-view-dialog-body",children:M?a.jsxs("div",{children:[a.jsxs("div",{className:"user-details-section",children:[a.jsx("h3",{className:"section-title",children:"Account Type"}),a.jsxs("div",{className:"flex between center wrap gap-2",children:[a.jsxs("div",{className:"account-types-container",children:[[{value:"is_user",label:"User"},{value:"is_customer",label:"Customer"},{value:"is_supplier",label:"Supplier"},{value:"is_dealer",label:"Dealer"},{value:"is_distributor",label:"Distributor"}].filter(ae=>M[ae.value]).map(ae=>a.jsx("div",{className:"account-type-badge",children:ae.label},ae.value)),!M.is_user&&!M.is_customer&&!M.is_supplier&&!M.is_dealer&&!M.is_distributor&&a.jsx("p",{className:"no-data-message",children:"No account types assigned"})]}),a.jsx("div",{children:a.jsx("button",{className:"btn btn-outline btn-small",onClick:async()=>{var ae,we;if(!(!M||!M.id)){re(!0),ue(!0);try{const Fe=await ut.get(`${Je}/api/hierarchical-users`,{params:{child_id:M.id}}),Ye=Array.isArray(Fe.data)?Fe.data:((ae=Fe.data)==null?void 0:ae.hierarchy)||[],me=[...new Set(Ye.map(xt=>xt.parent_id).filter(Boolean))],Be=await Promise.all(me.map(async xt=>{var zt;try{const Vt=await ut.get(`${Je}/api/users/${xt}`);return((zt=Vt.data)==null?void 0:zt.user)||Vt.data}catch{return{id:xt,firstname:"Unknown",lastname:"",fetchError:!0}}})),Ge=await ut.get(`${Je}/api/hierarchical-users`,{params:{parent_id:M.id}}),mt=Array.isArray(Ge.data)?Ge.data:((we=Ge.data)==null?void 0:we.hierarchy)||[],_t=[...new Set(mt.map(xt=>xt.child_id).filter(Boolean))],ot=await Promise.all(_t.map(async xt=>{var zt;try{const Vt=await ut.get(`${Je}/api/users/${xt}`);return((zt=Vt.data)==null?void 0:zt.user)||Vt.data}catch{return{id:xt,firstname:"Unknown",lastname:"",fetchError:!0}}}));ne(Be),K(ot)}catch(Fe){console.error("Failed to load hierarchy",Fe),ne([]),K([])}finally{ue(!1)}}},title:"View user hierarchy",children:" Hierarchy"})})]})]}),a.jsxs("div",{className:"user-details-section",children:[a.jsx("h3",{className:"section-title",children:"Personal Information"}),a.jsxs("div",{className:"form-grid col-12",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Salutation"}),a.jsx("input",{type:"text",value:M.salutation||M.Salutation||M.title||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"First Name"}),a.jsx("input",{type:"text",value:M.firstname||M.first_name||M.Firstname||M.FirstName||M.name||M.fullname||M.full_name||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Last Name"}),a.jsx("input",{type:"text",value:M.lastname||M.last_name||M.Lastname||M.LastName||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Date of Birth"}),a.jsx("input",{type:"text",value:M.dob?new Date(M.dob).toLocaleDateString():"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Gender"}),a.jsx("input",{type:"text",value:M.gender||"",disabled:!0})]})]})]}),a.jsxs("div",{className:"user-details-section",children:[a.jsx("h3",{className:"section-title",children:"Contact Information"}),a.jsxs("div",{className:"form-grid col-12",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Country"}),a.jsx("input",{type:"text",value:(()=>{const ae=Array.isArray(M.addresses)?M.addresses.find(Ye=>Ye.title==="Permanent"):null,we=M.country||M.country_code?M.country||"":(ae==null?void 0:ae.country)||M.permanent_country||"",Fe=M.country_code?M.country_code:(ae==null?void 0:ae.country_code)||M.permanent_country_code||"";return _(we,Fe)})(),disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Mobile Number"}),a.jsx("input",{type:"text",value:M.mobile_number||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Emergency Number"}),a.jsx("input",{type:"text",value:M.emergency_number||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Alternate Number"}),a.jsx("input",{type:"text",value:M.alternate_number||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"WhatsApp Number"}),a.jsx("input",{type:"text",value:M.whatsapp_number||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Email"}),a.jsx("input",{type:"text",value:M.email||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Website"}),a.jsx("input",{type:"text",value:M.website||"",disabled:!0})]})]})]}),(M.is_customer||M.is_supplier||M.is_dealer||M.is_distributor)&&a.jsxs("div",{className:"user-details-section",children:[a.jsx("h3",{className:"section-title",children:"Business Information"}),a.jsxs("div",{className:"form-grid col-12",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Business Name"}),a.jsx("input",{type:"text",value:M.business_name||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Company Name"}),a.jsx("input",{type:"text",value:M.company_name||M.companyname||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Industry Segment"}),a.jsx("input",{type:"text",value:M.industry_segment||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Designation"}),a.jsx("input",{type:"text",value:M.designation||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Title"}),a.jsx("input",{type:"text",value:M.title||"",disabled:!0})]})]})]}),a.jsxs("div",{className:"user-details-section",children:[a.jsx("h3",{className:"section-title",children:"Permanent Address"}),a.jsxs("div",{className:"form-grid col-12",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"GSTIN"}),a.jsx("input",{type:"text",value:(()=>{const ae=Array.isArray(M.addresses)?M.addresses.find(we=>we.title==="Permanent"):null;return(ae==null?void 0:ae.gstin)||(ae==null?void 0:ae.gstin_number)||M.permanent_gstin||""})(),disabled:!0})]}),[1,2,3].map(ae=>a.jsxs("div",{className:"form-field",children:[a.jsxs("label",{children:["Address ",ae]}),a.jsx("input",{type:"text",value:(()=>{const we=Array.isArray(M.addresses)?M.addresses.find(Fe=>Fe.title==="Permanent"):null;return(we==null?void 0:we[`address${ae}`])||M[`permanent_address${ae}`]||M[`address${ae}`]||""})(),disabled:!0})]},`address${ae}`)),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"City"}),a.jsx("input",{type:"text",value:(()=>{const ae=Array.isArray(M.addresses)?M.addresses.find(we=>we.title==="Permanent"):null;return(ae==null?void 0:ae.city)||M.permanent_city||M.city||M.City||""})(),disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"State"}),a.jsx("input",{type:"text",value:(()=>{const ae=Array.isArray(M.addresses)?M.addresses.find(we=>we.title==="Permanent"):null;return(ae==null?void 0:ae.state)||M.permanent_state||M.state||""})(),disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Country"}),a.jsx("input",{type:"text",value:(()=>{const ae=Array.isArray(M.addresses)?M.addresses.find(Ye=>Ye.title==="Permanent"):null,we=(ae==null?void 0:ae.country)||M.permanent_country||M.country||null,Fe=(ae==null?void 0:ae.country_code)||M.permanent_country_code||M.country_code||null;return _(we,Fe)})(),disabled:!0})]})]})]}),a.jsxs("div",{className:"user-details-section",children:[a.jsx("h3",{className:"section-title",children:"Additional Addresses"}),Array.isArray(M.addresses)&&M.addresses.filter(ae=>ae.title!=="Permanent").length>0?M.addresses.filter(ae=>ae.title!=="Permanent").map((ae,we)=>a.jsxs("div",{className:"address-block",children:[a.jsxs("h4",{className:"address-title",children:["Additional Address ",String(we+1).padStart(2,"0")]}),a.jsxs("div",{className:"form-grid col-12",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Title"}),a.jsx("input",{type:"text",value:ae.title||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"GSTIN"}),a.jsx("input",{type:"text",value:ae.gstin||ae.gstin_number||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Address 1"}),a.jsx("input",{type:"text",value:ae.address1||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Address 2"}),a.jsx("input",{type:"text",value:ae.address2||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Address 3"}),a.jsx("input",{type:"text",value:ae.address3||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"City"}),a.jsx("input",{type:"text",value:ae.city||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"State"}),a.jsx("input",{type:"text",value:ae.state||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Country"}),a.jsx("input",{type:"text",value:_(ae.country,ae.country_code),disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Pincode"}),a.jsx("input",{type:"text",value:ae.pincode||"",disabled:!0})]}),(()=>{const Fe=I(ae);return Fe.length>0?Fe.map((Ye,me)=>a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:Ye.key}),a.jsx("input",{type:"text",value:Ye.value||"",disabled:!0})]},me)):null})()]})]},we)):a.jsx("p",{className:"no-data-message",children:"No additional addresses"})]}),a.jsxs("div",{className:"user-details-section",children:[a.jsx("h3",{className:"section-title",children:"Legal Information"}),a.jsxs("div",{className:"form-grid col-12",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Aadhar Number"}),a.jsx("input",{type:"text",value:k(M,["aadhaar","aadhar","aadhaar card","aadhar card"],["aadhar_number","aadhaar"],["aadhar_number","doc_number"]),disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"PAN Number"}),a.jsx("input",{type:"text",value:k(M,["pan","pan card","permanent account number"],["pan_number","pan"],["pan_number","doc_number"]),disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"GSTIN"}),a.jsx("input",{type:"text",value:k(M,["gstin","gst","goods and services tax"],["gstin_number","gstin"],["gstin_number","doc_number"]),disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"MSME No"}),a.jsx("input",{type:"text",value:k(M,["msme","micro small medium enterprise"],["msme_no","msmeno"],["msme_no","doc_number"]),disabled:!0})]})]})]}),a.jsxs("div",{className:"user-details-section",children:[a.jsx("h3",{className:"section-title",children:"Bank Information"}),a.jsxs("div",{className:"form-grid col-12",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Bank Name"}),a.jsx("input",{type:"text",value:((Oe=(xe=M.bank_accounts)==null?void 0:xe[0])==null?void 0:Oe.bank_name)||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Branch Name"}),a.jsx("input",{type:"text",value:((de=(Ce=M.bank_accounts)==null?void 0:Ce[0])==null?void 0:de.branch_name)||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Branch Address"}),a.jsx("input",{type:"text",value:((Se=(be=M.bank_accounts)==null?void 0:be[0])==null?void 0:Se.branch_address)||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Account Number"}),a.jsx("input",{type:"text",value:((ze=(Ne=M.bank_accounts)==null?void 0:Ne[0])==null?void 0:ze.account_number)||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"IFSC Code"}),a.jsx("input",{type:"text",value:((Ie=(Re=M.bank_accounts)==null?void 0:Re[0])==null?void 0:Ie.ifsc_code)||"",disabled:!0})]})]})]}),a.jsxs("div",{className:"user-details-section",children:[a.jsx("h3",{className:"section-title",children:"Additional Bank Information"}),Array.isArray(M.bank_accounts)&&M.bank_accounts.length>1?M.bank_accounts.slice(1).map((ae,we)=>a.jsxs("div",{className:"bank-block",children:[a.jsxs("h4",{className:"bank-title",children:["Bank Info ",we+1]}),a.jsxs("div",{className:"form-grid col-12",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Bank Name"}),a.jsx("input",{type:"text",value:ae.bank_name||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Branch Name"}),a.jsx("input",{type:"text",value:ae.branch_name||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Branch Address"}),a.jsx("input",{type:"text",value:ae.branch_address||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Account Number"}),a.jsx("input",{type:"text",value:ae.account_number||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"IFSC Code"}),a.jsx("input",{type:"text",value:ae.ifsc_code||"",disabled:!0})]}),(()=>{const Fe=I(ae);return Fe.length>0?Fe.map((Ye,me)=>a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:Ye.key}),a.jsx("input",{type:"text",value:Ye.value||"",disabled:!0})]},me)):null})()]})]},we)):a.jsx("p",{className:"no-data-message",children:"No additional bank information"})]}),a.jsxs("div",{className:"user-details-section",children:[a.jsx("h3",{className:"section-title",children:"Uploaded Documents"}),Array.isArray(M.documents)&&M.documents.length>0?a.jsx("div",{className:"documents-grid",children:M.documents.map((ae,we)=>{const Fe=ae.doc_type||ae.type||ae.document_type||"Document",Ye=ae.doc_number||ae.number||ae.docno||"",me=ae.file_url||ae.url||ae.file_path||ae.file||ae.filePath||ae.path||null,Be=ae.file_name||ae.fileName||ae.name||(me?me.split("/").pop():""),Ge=me?String(me).startsWith("http")?me:`${Je.replace(/\/$/,"")}/${String(me).replace(/^\.\//,"").replace(/^\/+/,"")}`:null;return a.jsxs("div",{className:"document-card",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"document-type",children:Fe}),Ye&&a.jsxs("p",{className:"document-number",children:["No: ",Ye]}),Be&&a.jsx("p",{className:"document-filename",children:Be})]}),a.jsx("div",{className:"document-actions",children:Ge?a.jsxs(a.Fragment,{children:[a.jsx("a",{href:Ge,target:"_blank",rel:"noreferrer",style:{textDecoration:"none"},children:a.jsx("button",{type:"button",title:`View ${Fe}`,children:""})}),a.jsx("button",{type:"button",title:`Download ${Fe}`,onClick:mt=>{mt.preventDefault();const _t=document.createElement("a");_t.href=Ge,_t.download=Be||"",document.body.appendChild(_t),_t.click(),_t.remove()},children:""})]}):a.jsx("button",{type:"button",disabled:!0,title:"No file available",children:""})})]},we)})}):a.jsx("p",{className:"no-data-message",children:"No uploaded documents"})]}),a.jsxs("div",{className:"user-details-section",children:[a.jsx("h3",{className:"section-title",children:"Authentication"}),a.jsxs("div",{className:"form-grid col-12",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"User Code"}),a.jsx("input",{type:"text",value:M.usercode||M.user_code||M.userCode||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Username"}),a.jsx("input",{type:"text",value:M.username||"",disabled:!0})]}),a.jsxs("div",{className:"form-field password-input-container",children:[a.jsx("label",{children:"Password"}),a.jsx("input",{type:se?"text":"password",value:M.plain_password||"",disabled:!0}),M.plain_password&&a.jsx("button",{type:"button",className:"password-toggle",onClick:()=>ce(!se),title:se?"Hide password":"Show password",children:se?"":""}),!M.plain_password&&a.jsx("p",{className:"helper-text",children:"Password not available"})]})]})]})]}):a.jsx("p",{children:"No user selected."})}),a.jsxs("div",{className:"user-view-dialog-footer",children:[a.jsx("button",{className:"btn btn-secondary",onClick:()=>V(!1),children:"Close"}),a.jsx("button",{className:"btn btn-outline",onClick:()=>{V(!1),e(`/users/${M.id}/edit`)},children:"Edit User"})]})]})}),N&&a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:1299},onClick:()=>V(!1)}),a.jsxs(Oa,{open:$t,onClose:()=>{Bt(!1),tr(null),tt(!1)},maxWidth:"md",fullWidth:!0,children:[a.jsx(Wa,{children:"Import Users"}),a.jsxs(Pa,{children:[a.jsx(Et,{variant:"body2",color:"textSecondary",sx:{mb:2},children:"Import users from a CSV file. Make sure you have downloaded the template and filled it correctly."}),a.jsxs(Ut,{sx:{mb:2,p:2,bgcolor:"info.lighter",borderRadius:1},children:[a.jsx(Et,{variant:"body2",sx:{mb:1},children:a.jsx("strong",{children:"Instructions:"})}),a.jsxs(Et,{variant:"body2",component:"ul",sx:{pl:2,mb:0},children:[a.jsx("li",{children:"Download the template Excel file below"}),a.jsx("li",{children:"Fill in your user data following the template format"}),a.jsx("li",{children:"Required fields are marked with asterisk (*)"}),a.jsx("li",{children:"You can edit the info after upload the CSV file"}),a.jsx("li",{style:{color:"red"},children:"Upload the completed CSV file"})]})]}),a.jsx(Ut,{sx:{mb:2},children:a.jsx(Br,{variant:"outlined",color:"primary",onClick:ct,startIcon:a.jsx(Lz,{}),children:"Download Template Excel"})}),a.jsx("input",{type:"file",accept:".csv",onChange:ae=>tr(ae.target.files[0]),style:{marginBottom:"16px"}}),ft&&a.jsxs(Et,{variant:"body2",sx:{mb:2},children:["Selected file: ",a.jsx("strong",{children:ft.name})]})]}),a.jsxs(Va,{children:[a.jsx(Br,{onClick:()=>Bt(!1),children:"Cancel"}),a.jsx(Br,{variant:"contained",color:"primary",onClick:nt,disabled:!ft||Me,children:Me?a.jsx(Vs,{size:20}):"Upload & Preview"})]})]}),a.jsxs(Oa,{open:et,onClose:(ae,we)=>{we==="backdropClick"||we==="escapeKeyDown"||Ht(!1)},maxWidth:"xl",fullWidth:!0,children:[a.jsx(Wa,{children:a.jsxs(Ut,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[a.jsx(Et,{variant:"h6",children:"Preview and Edit Import Data"}),a.jsxs(Et,{variant:"subtitle2",color:"textSecondary",children:[Ze.length," records to import"]})]})}),a.jsxs(Pa,{children:[a.jsx(Et,{variant:"body2",color:"textSecondary",sx:{mb:2},children:"Review and edit the data before finalizing the import. Click on any cell to edit directly in the table."}),a.jsx(Ws,{component:sa,sx:{maxHeight:600},children:a.jsxs(Cs,{stickyHeader:!0,size:"small",children:[a.jsx(js,{children:a.jsxs(pn,{children:[a.jsx(qe,{sx:{width:60},children:a.jsx(Wn,{size:"small",checked:Ze.length>0&&Nt.size===Ze.length,indeterminate:Nt.size>0&&Nt.size<Ze.length,onChange:ae=>{ae.target.checked?kt(new Set(Ze.map((we,Fe)=>Fe))):kt(new Set)}})}),a.jsx(qe,{sx:{fontWeight:"bold"},children:"No."}),Ze.length>0&&Object.keys(Ze[0]).map(ae=>{const we=String(ae).replace(/\s*\*\s*$/g,""),Fe=we.toLowerCase().replace(/[^a-z0-9]/g,""),Ye=we==="Permanent Country"?"Country":we,me=Fe==="permanentcountry"?"country":Fe,mt=["salutation","firstname","gender","country","mobilenumber","email","city","state","active","accounttype"].includes(me)?`${Ye} *`:Ye;return a.jsx(qe,{sx:{fontWeight:"bold",minWidth:gt(Ye)},children:mt},ae)})]})}),a.jsx(fs,{children:Ze.map((ae,we)=>a.jsxs(pn,{hover:!0,children:[a.jsx(qe,{children:a.jsx(Wn,{size:"small",checked:Nt.has(we),onChange:Fe=>{kt(Ye=>{const me=new Set(Ye);return Fe.target.checked?me.add(we):me.delete(we),me})}})}),a.jsx(qe,{children:we+1}),Object.keys(ae).map((Fe,Ye)=>{const me=Lr&&Lr[we]?Lr[we][Fe]:void 0,Ge=String(Fe==="Permanent Country"?"Country":Fe).replace(/\s*\*\s*$/g,""),mt={minWidth:gt(Ge),whiteSpace:"normal",wordBreak:"break-word"};return a.jsx(joe,{value:ae[Fe],rowIndex:we,columnKey:Fe,error:!!me,errorMessages:me,cellSx:mt,row:ae,onUpdate:(_t,ot,xt)=>{const zt=[...Ze];zt[_t]={...zt[_t],[ot]:xt},St(zt),vt(Vt=>{if(!Vt||!Vt[_t]||!Vt[_t][ot])return Vt;const Ar={...Vt},wr={...Ar[_t]};return delete wr[ot],Ar[_t]=wr,Ar})}},`${we}-${Ye}`)})]},we))})]})})]}),a.jsxs(Va,{children:[a.jsx(Br,{onClick:()=>{Ht(!1),St([])},children:"Cancel"}),a.jsx(Br,{variant:"contained",color:"primary",onClick:Qe,disabled:Me,children:Me?a.jsx(Vs,{size:20}):"Finalize Import"})]})]}),a.jsxs(Oa,{open:kr,onClose:()=>Jt(!1),maxWidth:"md",fullWidth:!0,children:[a.jsx(Wa,{children:a.jsxs(Ut,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[a.jsx(Et,{variant:"h6",children:(Pt==null?void 0:Pt.type)==="validation_error"?"Validation Errors":(Pt==null?void 0:Pt.type)==="import_failed"?"Import Failed":"Import Report"}),a.jsx(Ut,{display:"flex",gap:2,children:(Pt==null?void 0:Pt.type)==="import_complete"&&a.jsxs(a.Fragment,{children:[a.jsxs(Et,{variant:"body2",color:"success.main",children:[" ",Pt.successCount," Imported"]}),Pt.errorCount>0&&a.jsxs(Et,{variant:"body2",color:"error.main",children:[" ",Pt.errorCount," Errors"]}),Pt.skipped>0&&a.jsxs(Et,{variant:"body2",color:"warning.main",children:[" ",Pt.skipped," Skipped"]})]})})]})}),a.jsx(Pa,{children:Pt&&a.jsxs(Ut,{children:[a.jsxs(Ut,{sx:{mb:3,p:2,bgcolor:"background.paper",borderRadius:1,border:"1px solid",borderColor:"divider"},children:[a.jsx(Et,{variant:"subtitle2",gutterBottom:!0,children:"Summary"}),a.jsxs(is,{container:!0,spacing:2,children:[a.jsxs(is,{item:!0,xs:3,children:[a.jsx(Et,{variant:"body2",color:"textSecondary",children:"Total Rows:"}),a.jsx(Et,{variant:"h6",children:Pt.totalRows})]}),a.jsxs(is,{item:!0,xs:3,children:[a.jsx(Et,{variant:"body2",color:"success.main",children:"Successful:"}),a.jsx(Et,{variant:"h6",color:"success.main",children:Pt.successCount})]}),a.jsxs(is,{item:!0,xs:3,children:[a.jsx(Et,{variant:"body2",color:"error.main",children:"Errors:"}),a.jsx(Et,{variant:"h6",color:"error.main",children:Pt.errorCount})]}),Pt.skipped>0&&a.jsxs(is,{item:!0,xs:3,children:[a.jsx(Et,{variant:"body2",color:"warning.main",children:"Skipped:"}),a.jsx(Et,{variant:"h6",color:"warning.main",children:Pt.skipped})]})]})]}),Pt.errors&&Pt.errors.length>0&&a.jsxs(Ut,{sx:{mb:3},children:[a.jsxs(Et,{variant:"subtitle2",color:"error.main",gutterBottom:!0,children:["Errors (",Pt.errors.length,")"]}),a.jsx(Ws,{component:sa,sx:{maxHeight:300},children:a.jsxs(Cs,{size:"small",children:[a.jsx(js,{children:a.jsxs(pn,{children:[a.jsx(qe,{sx:{fontWeight:"bold"},children:"Row"}),a.jsx(qe,{sx:{fontWeight:"bold"},children:"User Name"}),a.jsx(qe,{sx:{fontWeight:"bold"},children:"User Code"}),a.jsx(qe,{sx:{fontWeight:"bold"},children:"Error Details"})]})}),a.jsx(fs,{children:Pt.errors.map((ae,we)=>{var Fe,Ye,me;return a.jsxs(pn,{children:[a.jsx(qe,{children:ae.row||"N/A"}),a.jsx(qe,{children:ae.userName||((Fe=ae.data)==null?void 0:Fe.Name)||((Ye=ae.data)!=null&&Ye["First Name"]?(ae.data["First Name"]||"")+" "+(ae.data["Last Name"]||""):null)||"N/A"}),a.jsx(qe,{children:ae.userCode||((me=ae.data)==null?void 0:me["User Code"])||"N/A"}),a.jsx(qe,{children:a.jsx(Ut,{children:Array.isArray(ae.errors)?ae.errors.map((Be,Ge)=>a.jsxs(Et,{variant:"body2",color:"error.main",sx:{mb:.5},children:[" ",Be]},Ge)):a.jsx(Et,{variant:"body2",color:"error.main",children:ae.errors||"Unknown error"})})})]},we)})})]})})]}),Pt.successCount>0&&a.jsx(Ut,{sx:{p:2,bgcolor:"success.lighter",borderRadius:1},children:a.jsxs(Et,{variant:"body2",color:"success.main",children:[" Successfully imported ",Pt.successCount," user",Pt.successCount>1?"s":""]})})]})}),a.jsxs(Va,{children:[a.jsx(Br,{onClick:()=>{if(Jt(!1),Pt!=null&&Pt.errors&&Array.isArray(Pt.errors)){const ae=new Set(Nt);Pt.errors.forEach(we=>{const Fe=we==null?void 0:we.row;typeof Fe=="number"&&Fe>0&&ae.add(Fe-1)}),kt(ae)}Ht(!0)},variant:"outlined",children:"Edit"}),a.jsx(Br,{onClick:()=>{Jt(!1),(Pt==null?void 0:Pt.successCount)>0&&q()},variant:"contained",color:"primary",children:"Close"})]})]})]})}function G3(){ii();const[e,r]=G.useState([]),[t,n]=G.useState({title:""}),[s,o]=G.useState(0),[i,c]=G.useState(10),[u,l]=G.useState(0),[d,h]=G.useState(!1),[f,p]=G.useState(!1),v=["User Code","Name","AddressTitle","AddressType","AddressLine1","AddressLine2","AddressLine3","AddressLine4","City","District","State","Country","Pincode"],g=k=>{if(!Array.isArray(k))return[];const _=new Set(["id","ID","Id"]);return k.filter(R=>!_.has(String(R).trim()))},[m,b]=G.useState(()=>{const k=localStorage.getItem("addressDisplayPrefs"),_=v.slice(0,7),R=k?JSON.parse(k):_;return g(R)}),y=()=>p(!0),S=()=>p(!1);G.useEffect(()=>{localStorage.setItem("addressDisplayPrefs",JSON.stringify(m))},[m]);const C=k=>{b(_=>_.includes(k)?_.filter(R=>R!==k):[..._,k])},L=(k,_)=>{const R=(M,Z)=>{let J="",re="";return M&&typeof M=="object"?(J=M.name||M.country||M.label||M.title||"",re=M.code||M.dial_code||M.dialCode||M.country_code||M.phone_code||""):typeof M=="string"&&(/^\+/.test(M)||/^\d+$/.test(M)?re=M:J=M),Z&&typeof Z=="object"?(re=re||Z.code||Z.dial_code||Z.dialCode||Z.country_code||Z.phone_code||"",J=J||Z.name||Z.country||Z.label||""):typeof Z=="string"&&(re?J=J||Z:/^\+/.test(Z)||/^\d+$/.test(Z)?re=Z:J=J||Z),{name:J,code:re}},{name:j,code:A}=R(k,_),N=A?String(A).trim():"",V=N?N.startsWith("+")?N:"+"+N.replace(/^\+/,""):"";return j&&V?`${j} ${V}`:j||V||""},O=(k,_)=>{if(!k)return"";if(_==="User Code"){const j=k.user||k.User;if(j)return j.code||"";const A=k.originalUser;return A?A.UserCode||A.Usercode||A.usercode||"":k.usercode||k.Usercode||k.user_code||""}if(_==="Name"){const j=k.user||k.User;if(j){const N=j.firstname||"",V=j.lastname||"";return[N,V].filter(Boolean).join(" ")}const A=k.originalUser;if(A){const N=A.FirstName||A.Firstname||A.firstname||"",V=A.LastName||A.Lastname||A.lastname||"";return[N,V].filter(Boolean).join(" ")}return k.name||k.AddressTitle||""}if(_==="Country"){const j=k.Country||k.country||"",A=k.CountryCode||k.country_code||k.countrycode||"";return L(j,A)}const R=[];R.push(_),R.push(_.toLowerCase()),R.push(_.toLowerCase().replace(/\s+/g,"")),R.push(_.toLowerCase().replace(/\s+/g,"_")),R.push(_.replace(/\s+/g,"")),R.push(_.replace(/\s+/g,"_"));for(const j of R)if(j in k&&k[j]!==void 0&&k[j]!==null)return k[j];return""},H=k=>{b(k?g([...v]):[])};G.useEffect(()=>{P()},[s,i]),G.useEffect(()=>{const k=setTimeout(()=>{s===0?P():o(0)},500);return()=>clearTimeout(k)},[t.title]);const[z,q]=G.useState(`${Je}/api/users`),[D,W]=G.useState(""),P=async()=>{h(!0),W("");try{console.log("Fetching users with addresses from:",z);const k=await ut.get(z,{params:{page:s+1,limit:100,filter:t.title}});console.log("API Response:",k);let _=[];k.data&&k.data.data?_=k.data.data:Array.isArray(k.data)?_=k.data:typeof k.data=="object"&&(_=k.data.users||k.data.items||[]),console.log("Users data:",_);const R=[];_.forEach(j=>{if(j&&(j.address1||j.Address1||j.address2||j.Address2||j.address3||j.Address3||j.city||j.City)){const N={user:{id:j.ID||j.id,code:j.UserCode||j.Usercode||j.usercode||"",firstname:j.FirstName||j.Firstname||j.firstname||"",lastname:j.LastName||j.Lastname||j.lastname||""},AddressTitle:"Primary Address",AddressType:"User Address",AddressLine1:j.address1||j.Address1||"",AddressLine2:j.address2||j.Address2||"",AddressLine3:j.address3||j.Address3||"",City:j.city||j.City||"",District:j.district||j.District||"",State:j.state||j.State||"",Country:j.country||j.Country||"",CountryCode:j.country_code||j.CountryCode||j.countrycode||"",Pincode:j.pincode||j.Pincode||"",originalUser:j};if(R.push(N),t.title&&!Object.values(N).some(V=>typeof V=="string"&&V.toLowerCase().includes(t.title.toLowerCase())))return}}),console.log("Processed address data:",R),r(R),l(R.length),console.log("Total items set to:",R.length)}catch(k){console.error("Error fetching users with addresses:",k),W(`Failed to load users with addresses: ${k.message}`),r([]),l(0)}finally{h(!1)}},I=()=>{o(0),P()},U=(k,_)=>{const R=k&&(k.user||k.User),j=R&&R.id;if(j)return`user-${j}`;const A=k&&k.originalUser;if(A&&(A.ID||A.id))return`user-${A.ID||A.id}`;const N=R?R.code:"";return N?`user-code-${N}`:`row-${_}`};return a.jsxs(Ut,{mt:6,p:3,children:[a.jsx(is,{container:!0,justifyContent:"space-between",alignItems:"center",mb:2,children:a.jsx(is,{item:!0,children:a.jsx(Et,{variant:"h5",children:"User Addresses"})})}),a.jsxs(sa,{sx:{p:2,mb:3},children:[a.jsxs(is,{container:!0,spacing:2,alignItems:"center",mb:2,children:[a.jsx(is,{item:!0,xs:12,sm:4,children:a.jsx(ri,{label:"Search by User Name or Address",variant:"outlined",size:"small",fullWidth:!0,value:t.title,onChange:k=>n({...t,title:k.target.value}),onKeyPress:k=>k.key==="Enter"&&I()})}),a.jsx(is,{item:!0,xs:12,sm:8,container:!0,justifyContent:"flex-end",spacing:1,children:a.jsx(is,{item:!0,children:a.jsx(bs,{title:"Display Preferences",children:a.jsx(sn,{onClick:y,children:a.jsx(l7,{})})})})})]}),a.jsx(Ws,{component:sa,elevation:0,children:a.jsxs(Cs,{sx:{minWidth:650},size:"small",children:[a.jsx(js,{children:a.jsxs(pn,{children:[a.jsx(qe,{children:"Sl No."}),m.map(k=>a.jsx(qe,{children:k},k))]})}),a.jsx(fs,{children:d?a.jsx(pn,{children:a.jsx(qe,{colSpan:m.length+1,align:"center",children:a.jsx(Vs,{size:24})})}):e.length===0?a.jsx(pn,{children:a.jsx(qe,{colSpan:m.length+1,align:"center",children:"No addresses found."})}):e.map((k,_)=>a.jsxs(pn,{hover:!0,children:[a.jsx(qe,{children:s*i+_+1}),m.map(R=>a.jsx(qe,{children:O(k,R)||""},R))]},U(k,_)))})]})}),a.jsx(Zm,{component:"div",count:u,page:s,onPageChange:(k,_)=>o(_),rowsPerPage:i,onRowsPerPageChange:k=>{c(parseInt(k.target.value,10)),o(0)}})]}),a.jsxs(Oa,{open:f,onClose:S,children:[a.jsx(Wa,{children:"Display Preferences"}),a.jsx(Pa,{children:a.jsxs(Ut,{sx:{pt:1},children:[a.jsx(As,{control:a.jsx(Wn,{indeterminate:m.length>0&&m.length<v.length,checked:m.length===v.length,onChange:k=>H(k.target.checked)}),label:"Select All"}),v.map(k=>a.jsx(As,{control:a.jsx(Wn,{checked:m.includes(k),onChange:()=>C(k)}),label:k},k))]})}),a.jsx(Va,{children:a.jsx(Br,{onClick:S,children:"Close"})})]})]})}function Roe(){const[e,r]=G.useState([]),[t,n]=G.useState(!1),[s,o]=G.useState(!1),[i,c]=G.useState(null),[u,l]=G.useState({code:"",name:"",gst_number:"",address:"",city:"",state:"",pincode:"",is_head_office:!1}),d=()=>{n(!0),fetch(`${Je}/api/company-branches?limit=1000`).then(async b=>{const y=await b.json();if(!b.ok)throw new Error(y.error||"Failed to fetch branches");const S=Array.isArray(y.data)?y.data:y,C=Array.isArray(S)?S.map(L=>({id:L.id,code:L.code,name:L.name,gst_number:L.gst_number,address:L.address,city:L.city,state:L.state,pincode:L.pincode,is_head_office:L.is_head_office})):[];r(C)}).catch(b=>{console.error("Fetch branches failed",b),alert("Failed to fetch branches")}).finally(()=>n(!1))};G.useEffect(()=>{d()},[]);const h=()=>{c(null),l({code:"",name:"",gst_number:"",address:"",city:"",state:"",pincode:"",is_head_office:!1}),o(!0)},f=b=>{c(b),l({code:b.code||"",name:b.name||"",gst_number:b.gst_number||"",address:b.address||"",city:b.city||"",state:b.state||"",pincode:b.pincode||"",is_head_office:b.is_head_office||!1}),o(!0)},p=b=>{window.confirm("Are you sure you want to delete this branch?")&&fetch(`${Je}/api/company-branches/${b.id}`,{method:"DELETE"}).then(y=>{if(!y.ok)throw new Error("Failed to delete branch");r(S=>S.filter(C=>String(C.id)!==String(b.id)))}).catch(y=>{console.error("Delete failed",y),alert("Failed to delete branch")})},v=()=>{const{code:b,name:y,state:S}=u;if(!y.trim()||!S.trim()||!b.trim()){alert("Code, Name, and State are required");return}const C={company_id:1,code:b.trim(),name:y.trim(),gst_number:u.gst_number.trim(),address:u.address.trim(),city:u.city.trim(),state:S.trim(),pincode:u.pincode.trim(),is_head_office:u.is_head_office},L=i?`${Je}/api/company-branches/${i.id}`:`${Je}/api/company-branches`;fetch(L,{method:i?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)}).then(async H=>{const z=await H.json();if(!H.ok)throw new Error(z.error||"Failed to save branch");const q=z;r(i?e.map(D=>D.id===i.id?{id:q.id,code:q.code,name:q.name,gst_number:q.gst_number,address:q.address,city:q.city,state:q.state,pincode:q.pincode,is_head_office:q.is_head_office}:D):[...e,{id:q.id,code:q.code,name:q.name,gst_number:q.gst_number,address:q.address,city:q.city,state:q.state,pincode:q.pincode,is_head_office:q.is_head_office}]),o(!1),l({code:"",name:"",gst_number:"",address:"",city:"",state:"",pincode:"",is_head_office:!1})}).catch(H=>{console.error("Save failed",H),alert(H.message||"Failed to save branch")})},g=()=>{o(!1),c(null),l({code:"",name:"",gst_number:"",address:"",city:"",state:"",pincode:"",is_head_office:!1})},m=e;return a.jsxs("div",{className:"branch-container",children:[a.jsxs("section",{className:"title-section",children:[a.jsx("div",{children:a.jsx("h1",{className:"page-title",children:"Branch Master"})}),a.jsx("div",{className:"actions-row",children:a.jsx("button",{className:"add-btn",onClick:h,children:"Add Branch"})})]}),s&&a.jsx("div",{className:"modal-overlay",onClick:g,children:a.jsxs("div",{className:"modal-content",onClick:b=>b.stopPropagation(),children:[a.jsx("h2",{children:i?"Edit Branch":"Add New Branch"}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Code"}),a.jsx("input",{type:"text",value:u.code,onChange:b=>l({...u,code:b.target.value}),placeholder:"Enter branch code"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Name"}),a.jsx("input",{type:"text",value:u.name,onChange:b=>l({...u,name:b.target.value}),placeholder:"Enter branch name"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"GST Number"}),a.jsx("input",{type:"text",value:u.gst_number,onChange:b=>l({...u,gst_number:b.target.value}),placeholder:"Enter 15-char GSTIN",maxLength:"15"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Address"}),a.jsx("input",{type:"text",value:u.address,onChange:b=>l({...u,address:b.target.value}),placeholder:"Enter address"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"City"}),a.jsx("input",{type:"text",value:u.city,onChange:b=>l({...u,city:b.target.value}),placeholder:"Enter city"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"State"}),a.jsx("input",{type:"text",value:u.state,onChange:b=>l({...u,state:b.target.value}),placeholder:"Enter state"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Pincode"}),a.jsx("input",{type:"text",value:u.pincode,onChange:b=>l({...u,pincode:b.target.value}),placeholder:"Enter pincode"})]}),a.jsx("div",{className:"form-field",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:u.is_head_office,onChange:b=>l({...u,is_head_office:b.target.checked})}),"Is Head Office"]})}),a.jsxs("div",{className:"form-buttons",children:[a.jsx("button",{onClick:g,children:"Cancel"}),a.jsxs("button",{onClick:v,children:[i?"Update":"Add"," Branch"]})]})]})}),a.jsxs("table",{className:"branches-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Code"}),a.jsx("th",{children:"Name"}),a.jsx("th",{children:"GST Number"}),a.jsx("th",{children:"Address"}),a.jsx("th",{children:"City"}),a.jsx("th",{children:"State"}),a.jsx("th",{children:"Pincode"}),a.jsx("th",{children:"Head Office"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:m.map(b=>a.jsxs("tr",{children:[a.jsx("td",{children:b.code}),a.jsx("td",{children:b.name}),a.jsx("td",{children:b.gst_number}),a.jsx("td",{children:b.address}),a.jsx("td",{children:b.city}),a.jsx("td",{children:b.state}),a.jsx("td",{children:b.pincode}),a.jsx("td",{children:b.is_head_office?"Yes":"No"}),a.jsxs("td",{children:[a.jsx("button",{className:"action-btn edit-btn",onClick:()=>f(b),children:a.jsx(Yf,{})}),a.jsx("button",{className:"action-btn delete-btn",onClick:()=>p(b),children:a.jsx(Zf,{})})]})]},b.id))})]})]})}function Eoe(){const[e,r]=G.useState([]),[t,n]=G.useState([]),[s,o]=G.useState(!1),[i,c]=G.useState(!1),[u,l]=G.useState(null),[d,h]=G.useState(""),[f,p]=G.useState({page:1,limit:10,total:0}),[v,g]=G.useState({name:"",prefix:"",postfix:"",prefix_number:1,remarks:"",company_id:null,company_branch_id:null,is_active:!0});G.useEffect(()=>{m(),b()},[f.page,f.limit,d]);const m=async()=>{try{const P=await(await fetch(`${Je}/api/company-branches?limit=1000`)).json(),I=Array.isArray(P.data)?P.data:P;n(Array.isArray(I)?I:[])}catch(W){console.error("Fetch branches failed",W),n([])}},b=async()=>{o(!0);try{const W=new URLSearchParams({page:f.page,limit:f.limit});d&&W.append("search",d);const I=await(await fetch(`${Je}/api/series?${W}`)).json();r(Array.isArray(I.data)?I.data:[]),p(U=>({...U,total:I.total||0}))}catch(W){console.error("Fetch series failed",W),r([])}finally{o(!1)}},y=()=>{l(null),g({name:"",prefix:"",postfix:"",prefix_number:1,remarks:"",company_id:null,company_branch_id:null,is_active:!0}),c(!0)},S=W=>{l(W),g({name:W.name||"",prefix:W.prefix||"",postfix:W.postfix||"",prefix_number:W.prefix_number||1,remarks:W.remarks||"",company_id:W.company_id||null,company_branch_id:W.company_branch_id||null,is_active:W.is_active!==void 0?W.is_active:!0}),c(!0)},C=async W=>{if(window.confirm(`Are you sure you want to delete series "${W.prefix}"?`))try{const P=await fetch(`${Je}/api/series/${W.id}`,{method:"DELETE"});if(!P.ok){const I=await P.json();throw new Error(I.error||"Failed to delete series")}b()}catch(P){console.error("Delete failed",P),alert(P.message||"Failed to delete series")}},L=async()=>{const{name:W,prefix:P,postfix:I,prefix_number:U}=v;if(!W.trim()||!P.trim()||!I.trim()){alert("Name, Prefix, and Postfix are required");return}const k={name:W.trim(),prefix:P.trim(),postfix:I.trim(),remarks:v.remarks.trim(),prefix_number:v.prefix_number,company_id:v.company_id||null,company_branch_id:v.company_branch_id||null,is_active:v.is_active},_=u?`${Je}/api/series/${u.id}`:`${Je}/api/series`,R=u?"PUT":"POST";try{const j=await fetch(_,{method:R,headers:{"Content-Type":"application/json"},body:JSON.stringify(k)}),A=await j.json();if(!j.ok)throw new Error(A.error||"Failed to save series");c(!1),g({name:"",prefix:"",postfix:"",prefix_number:1,remarks:"",company_id:null,company_branch_id:null,is_active:!0}),b()}catch(j){console.error("Save failed",j),alert(j.message||"Failed to save series")}},O=()=>{c(!1),l(null),g({name:"",prefix:"",postfix:"",prefix_number:1,remarks:"",company_id:null,company_branch_id:null,is_active:!0})},H=W=>{h(W.target.value),p(P=>({...P,page:1}))},z=W=>{p(P=>({...P,page:W}))},q=Math.ceil(f.total/f.limit),D=W=>{const P=t.find(I=>I.id===W);return P?P.name:"-"};return a.jsxs("div",{className:"series-container",children:[a.jsxs("section",{className:"title-section",children:[a.jsx("div",{children:a.jsx("h1",{className:"page-title",children:"Series Master"})}),a.jsxs("div",{className:"actions-row",children:[a.jsx("input",{type:"text",className:"search-input",placeholder:"Search by prefix or remarks...",value:d,onChange:H}),a.jsx("button",{className:"add-btn",onClick:y,children:"Add Series"})]})]}),i&&a.jsx("div",{className:"modal-overlay",onClick:O,children:a.jsxs("div",{className:"modal-content",onClick:W=>W.stopPropagation(),children:[a.jsx("h2",{children:u?"Edit Series":"Add New Series"}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Name *"}),a.jsx("input",{type:"text",value:v.name,onChange:W=>g({...v,name:W.target.value}),placeholder:"e.g. Estimate, Invoice, Purchase Order"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Prefix *"}),a.jsx("input",{type:"text",value:v.prefix,onChange:W=>g({...v,prefix:W.target.value}),placeholder:"e.g. EC, INV, PO, DN, CN"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Postfix *"}),a.jsx("input",{type:"text",value:v.postfix,onChange:W=>g({...v,postfix:W.target.value}),placeholder:"e.g. /2024, /12, -A"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Remarks"}),a.jsx("textarea",{value:v.remarks,onChange:W=>g({...v,remarks:W.target.value}),placeholder:"Enter remarks",rows:"3"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Company Branch"}),a.jsxs("select",{value:v.company_branch_id||"",onChange:W=>g({...v,company_branch_id:W.target.value?parseInt(W.target.value):null}),children:[a.jsx("option",{value:"",children:"-- Select Branch --"}),t.map(W=>a.jsx("option",{value:W.id,children:W.name},W.id))]})]}),a.jsx("div",{className:"form-field checkbox-field",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:v.is_active,onChange:W=>g({...v,is_active:W.target.checked})}),"Is Active"]})}),a.jsxs("div",{className:"form-buttons",children:[a.jsx("button",{onClick:O,children:"Cancel"}),a.jsxs("button",{onClick:L,children:[u?"Update":"Add"," Series"]})]})]})}),s?a.jsx("div",{className:"loading",children:"Loading..."}):a.jsxs(a.Fragment,{children:[a.jsxs("table",{className:"series-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"S.No"}),a.jsx("th",{children:"Name"}),a.jsx("th",{children:"Prefix"}),a.jsx("th",{children:"Postfix"}),a.jsx("th",{children:"Remarks"}),a.jsx("th",{children:"Company Branch"}),a.jsx("th",{children:"Status"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:e.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:"8",className:"no-data",children:"No series found"})}):e.map((W,P)=>a.jsxs("tr",{children:[a.jsx("td",{children:(f.page-1)*f.limit+P+1}),a.jsx("td",{children:a.jsx("strong",{children:W.name})}),a.jsx("td",{children:W.prefix}),a.jsx("td",{children:W.postfix}),a.jsx("td",{children:W.remarks||"-"}),a.jsx("td",{children:D(W.company_branch_id)}),a.jsx("td",{children:a.jsx("span",{className:`status-badge ${W.is_active?"active":"inactive"}`,children:W.is_active?"Active":"Inactive"})}),a.jsxs("td",{children:[a.jsx("button",{className:"action-btn edit-btn",onClick:()=>S(W),title:"Edit",children:a.jsx(Yf,{})}),a.jsx("button",{className:"action-btn delete-btn",onClick:()=>C(W),title:"Delete",children:a.jsx(Zf,{})})]})]},W.id))})]}),q>1&&a.jsxs("div",{className:"pagination",children:[a.jsx("button",{disabled:f.page===1,onClick:()=>z(f.page-1),children:"Previous"}),a.jsxs("span",{children:["Page ",f.page," of ",q," (Total: ",f.total,")"]}),a.jsx("button",{disabled:f.page>=q,onClick:()=>z(f.page+1),children:"Next"})]})]})]})}function Noe(){const[e,r]=G.useState([]),[t,n]=G.useState(!1),[s,o]=G.useState(!1),[i,c]=G.useState(null),[u,l]=G.useState(""),[d,h]=G.useState({code:"",name:""});console.log(" Component rendered, companies state:",e),G.useEffect(()=>{f()},[]);const f=async()=>{var S,C;console.log("=== fetchCompanies called ==="),console.log("BASE_URL:",Je),n(!0);try{const L=`${Je}/api/companies?limit=1000`;console.log("Fetching from:",L);const O=await ut.get(L);console.log(" Full response:",O),console.log("Response data:",O.data);const H=O.data&&O.data.data?O.data.data:O.data;console.log("Extracted data:",H),console.log("Is array?",Array.isArray(H)),Array.isArray(H)?(console.log("Setting companies to:",H),r(H)):(console.warn("Data is not an array, setting empty array"),r([]))}catch(L){console.error(" Error fetching companies:",L),alert("Failed to fetch companies: "+(((C=(S=L.response)==null?void 0:S.data)==null?void 0:C.error)||L.message)),r([])}finally{n(!1)}},p=()=>{c(null),h({code:"",name:""}),o(!0)},v=S=>{c(S),h({code:S.code||"",name:S.name||""}),o(!0)},g=async S=>{var C,L;if(window.confirm("Are you sure you want to delete this company?"))try{await ut.delete(`${Je}/api/companies/${S.id}`),r(e.filter(O=>O.id!==S.id))}catch(O){console.error("Delete failed:",O),alert("Failed to delete company: "+(((L=(C=O.response)==null?void 0:C.data)==null?void 0:L.error)||O.message))}},m=async()=>{var O,H;const{code:S,name:C}=d;if(!S.trim()||!C.trim()){alert("Code and Name are required");return}const L={code:S.trim(),name:C.trim()};try{if(i){const q=(await ut.put(`${Je}/api/companies/${i.id}`,L)).data;r(e.map(D=>D.id===i.id?q:D))}else{const q=(await ut.post(`${Je}/api/companies`,L)).data;r([q,...e])}b()}catch(z){console.error("Save failed:",z),alert("Failed to save company: "+(((H=(O=z.response)==null?void 0:O.data)==null?void 0:H.error)||z.message))}},b=()=>{o(!1),c(null),h({code:"",name:""})},y=e.filter(S=>{if(!u)return!0;const C=u.toLowerCase();return String(S.code||"").toLowerCase().includes(C)||String(S.name||"").toLowerCase().includes(C)});return a.jsxs("div",{className:"company-container",children:[a.jsxs("section",{className:"title-section",children:[a.jsx("div",{children:a.jsx("h1",{className:"page-title",children:"Company Master"})}),a.jsxs("div",{className:"actions-row",children:[a.jsx("input",{type:"text",className:"search-input",placeholder:"Search by code or name...",value:u,onChange:S=>l(S.target.value)}),a.jsx("button",{className:"add-btn",onClick:p,children:"+ Add Company"})]})]}),s&&a.jsx("div",{className:"modal-overlay",onClick:b,children:a.jsxs("div",{className:"modal-content",onClick:S=>S.stopPropagation(),children:[a.jsx("h2",{children:i?"Edit Company":"Add New Company"}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Code"}),a.jsx("input",{type:"text",value:d.code,onChange:S=>h({...d,code:S.target.value}),placeholder:"Enter company code"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Name"}),a.jsx("input",{type:"text",value:d.name,onChange:S=>h({...d,name:S.target.value}),placeholder:"Enter company name"})]}),a.jsxs("div",{className:"form-buttons",children:[a.jsx("button",{className:"cancel-btn",onClick:b,children:"Cancel"}),a.jsxs("button",{className:"submit-btn",onClick:m,children:[i?"Update":"Add"," Company"]})]})]})}),a.jsx("div",{className:"companies-table-wrapper",children:t?a.jsx("div",{className:"loading",children:"Loading..."}):y.length===0?a.jsx("div",{className:"empty-state",children:a.jsx("p",{children:"No companies found"})}):a.jsxs("table",{className:"companies-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Code"}),a.jsx("th",{children:"Name"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:y.map(S=>a.jsxs("tr",{children:[a.jsx("td",{children:S.code}),a.jsx("td",{children:S.name}),a.jsxs("td",{className:"actions-cell",children:[a.jsx("button",{className:"action-btn edit-btn",onClick:()=>v(S),title:"Edit",children:a.jsx(Yf,{})}),a.jsx("button",{className:"action-btn delete-btn",onClick:()=>g(S),title:"Delete",children:a.jsx(Zf,{})})]})]},S.id))})]})})]})}const Toe=Array.isArray(Hs)?Hs.map(e=>`${e.name} (${e.code})`):[],Loe=Bf&&typeof Bf=="object"?Object.values(Bf):[],Moe=({value:e,rowIndex:r,columnKey:t,onUpdate:n,error:s=!1,errorMessages:o=[],cellSx:i={}})=>{const[c,u]=G.useState(!1),[l,d]=G.useState(e);G.useEffect(()=>{d(e)},[e]);const f=(b=>{const S=String(b).replace(/\s*\*\s*$/g,"").toLowerCase().replace(/[^a-z0-9]/g,"");return S==="salutation"?{options:["Mr","Mrs","Ms","Miss","Dr","Prof","Mx"],multiple:!1}:S==="gender"?{options:["Male","Female","Other","Prefer not to say"],multiple:!1}:S==="active"?{options:["Yes","No"],multiple:!1}:S.includes("country")?{options:Toe,multiple:!1}:S==="city"?{options:Kc,multiple:!1}:S==="state"?{options:Loe,multiple:!1}:null})(t),p=f?f.options:null;f&&f.multiple;const v={cursor:c?"default":"pointer",padding:c?"4px":void 0,borderLeft:s?"4px solid rgba(244,67,54,0.6)":void 0,backgroundColor:s?"rgba(255,235,238,0.6)":void 0,"&:hover":c?{}:{backgroundColor:s?"rgba(255, 205, 210, 0.6)":"rgba(0, 0, 0, 0.04)"}},g=()=>{n(r,t,l),u(!1)},m=b=>{b.key==="Enter"?g():b.key==="Escape"&&(d(e),u(!1))};return a.jsx(qe,{onClick:()=>!c&&u(!0),sx:{...v,...i},children:c?p?a.jsx(eh,{autoFocus:!0,fullWidth:!0,size:"small",value:l||"",onChange:b=>d(b.target.value),onBlur:()=>{n(r,t,l),u(!1)},sx:{margin:"-8px 0"},children:p.map(b=>a.jsx(zl,{value:b,children:b},b))}):a.jsx(ri,{autoFocus:!0,fullWidth:!0,size:"small",variant:"outlined",value:l||"",onChange:b=>d(b.target.value),onKeyDown:m,onBlur:g,sx:{margin:"-8px 0"}}):String(e||"")})};function Doe(){const e=ii(),[r,t]=G.useState([]),[n,s]=G.useState({search:""}),[o,i]=G.useState(0),[c,u]=G.useState(10),[l,d]=G.useState(0),[h,f]=G.useState(!1),[p,v]=G.useState(!1),g=["Photo","Employee Code","Name","DOB","Gender","Country","MobileNumber","Email","Aadhaar","PAN","Address 1","Address 2","Address 3","City","State","Add. Country","Pincode","Bank Info","Documents","Status"],m=je=>{switch(je){case"Photo":return 80;case"Employee Code":return 150;case"Name":return 200;case"DOB":return 120;case"Gender":return 100;case"Country":return 160;case"MobileNumber":return 140;case"Email":return 220;case"Aadhaar":return 150;case"PAN":return 120;case"Address 1":return 150;case"Address 2":return 150;case"Address 3":return 150;case"City":return 120;case"State":return 120;case"Add. Country":return 120;case"Pincode":return 100;case"Bank Info":return 260;case"Documents":return 300;case"Status":return 120;case"Actions":return 180;default:return 150}},[b,y]=G.useState(()=>{const je=localStorage.getItem("employeeListCheckedFields");if(je)try{const ct=JSON.parse(je),nt=g.filter(Pe=>ct.includes(Pe));return nt.length>0?nt:g}catch{return g}return g}),[S,C]=G.useState(!1),[L,O]=G.useState(null),[H,z]=G.useState(!1),[q,D]=G.useState(""),[W,P]=G.useState("info"),[I,U]=G.useState(!1),[k,_]=G.useState(null),[R,j]=G.useState(!1),[A,N]=G.useState([]),[V,M]=G.useState(!1),[Z,J]=G.useState(null),[re,X]=G.useState(!1),[ne,Y]=G.useState([]),[K,ee]=G.useState(!1),[ue,se]=G.useState(new Set),[ce,fe]=G.useState(!1),[ve,_e]=G.useState(null),[le,ke]=G.useState({}),Te=()=>v(!0),pe=()=>v(!1);G.useEffect(()=>{localStorage.setItem("employeeListCheckedFields",JSON.stringify(b))},[b]);const ye=je=>{y(ct=>{let nt;if(ct.includes(je))nt=ct.filter(Pe=>Pe!==je);else{const Pe=new Set(ct);Pe.add(je),nt=g.filter(Qe=>Pe.has(Qe))}return localStorage.setItem("employeeListCheckedFields",JSON.stringify(nt)),nt})},ge=b&&b.length>0?b:["Name"];G.useEffect(()=>{De()},[o,c]),G.useEffect(()=>{const je=setTimeout(()=>{i(0),De()},300);return()=>clearTimeout(je)},[n.search]);const De=async()=>{f(!0);try{const je={page:o+1,limit:c,search:n.search},ct=await ut.get(`${Je}/api/employees`,{params:je}),nt=ct.data.employees||ct.data,Pe=Array.isArray(nt)?nt:[];t(Pe),d(ct.data.total||Pe.length)}catch(je){console.error("Error fetching employees:",je),kr("Error fetching employees","error")}finally{f(!1)}},He=je=>{const ct=je.target.checked;N(ct?r.map(nt=>nt.id):[])},Xe=je=>{N(ct=>ct.includes(je)?ct.filter(nt=>nt!==je):[...ct,je])},at=async()=>{f(!0);try{const ct=(A.length>0?r.filter(Qe=>A.includes(Qe.id)):r).map(Qe=>{const gt={};return b.forEach(xe=>{gt[xe]=Me(Qe,xe)}),gt}),nt=Wi.json_to_sheet(ct),Pe=Wi.book_new();Wi.book_append_sheet(Pe,nt,"Employees"),xx(Pe,`employees_export${A.length>0?"_selected":""}.xlsx`)}catch(je){console.error("Export failed",je),kr("Export failed","error")}finally{f(!1)}},dt=async()=>{const je=new B2.Workbook,ct=je.addWorksheet("Employee Import Template"),nt=["Employee Code","Salutation *","First Name *","Last Name","Date of Birth","Gender *","Country *","Mobile Number *","Email *","Aadhaar","PAN","Address 1","Address 2","Address 3","City","State","Add. Country","Pincode","Bank Name","Branch Name","Branch Address","Account Number","IFSC Code","Active *"];ct.addRow(nt);const Pe=["EMP001","Mr","John","Doe","1990-01-15","Male","India (+91)","9876543210","john.doe@example.com","123456789012","ABCDE1234F","123 Main St","Suite 4B","","Mumbai","Maharashtra","India","400001","Example Bank","Main Branch","1 Bank Plaza","1234567890","IFSC0001234","Yes"];ct.addRow(Pe);for(let Fe=0;Fe<10;Fe++)ct.addRow(new Array(nt.length).fill(""));const Qe=je.addWorksheet("Lists"),gt=["Mr","Mrs","Ms","Miss","Dr","Prof","Mx"],xe=["Male","Female","Other","Prefer not to say"],Oe=["Yes","No"],Ce=Hs.map(Fe=>`${Fe.name} (${Fe.code})`),de=Hs.map(Fe=>Fe.name),be=["Andaman and Nicobar","Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chandigarh","Chhattisgarh","Ddra and Nagar Haveli and Damn and Diu","Delhi","Goa","Gujarat","Himachal Pradesh","Haryana","Jharkhand","Jammu and Kashmir","Karnataka","Kerala","Ladakh","Lakshadweep","Maharashtra","Meghalaya","Manipur","Madhya Pradesh","Mizoram","Nagaland","Orissa","Punjab","Puducherry","Rajasthan","Sikkim","Telangana","Tamil Nadu","Tripura","Uttar Pradesh","Uttaranchal","West Bengal"],Se=Kc;[gt,xe,Oe,Ce,de,be,Se].forEach((Fe,Ye)=>{for(let me=0;me<Fe.length;me++)Qe.getCell(me+1,Ye+1).value=Fe[me]}),Qe.state="veryHidden";const ze={2:{sheetCol:"A",length:gt.length},6:{sheetCol:"B",length:xe.length},7:{sheetCol:"D",length:Ce.length},15:{sheetCol:"G",length:Se.length},16:{sheetCol:"F",length:be.length},17:{sheetCol:"E",length:de.length},24:{sheetCol:"C",length:Oe.length}};Object.keys(ze).forEach(Fe=>{const Ye=parseInt(Fe,10),{sheetCol:me,length:Be}=ze[Ye],Ge=`=Lists!$${me}$1:$${me}$${Be}`;ct.getColumn(Ye).eachCell((mt,_t)=>{_t>1&&(mt.dataValidation={type:"list",allowBlank:!0,showInputMessage:!0,formulae:[Ge]})})});const Re=await je.xlsx.writeBuffer(),Ie=new Blob([Re],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),ae=URL.createObjectURL(Ie),we=document.createElement("a");we.setAttribute("href",ae),we.setAttribute("download","employee_import_template.xlsx"),we.style.visibility="hidden",document.body.appendChild(we),we.click(),document.body.removeChild(we)},wt=async()=>{if(!Z){alert("Please select a file to import.");return}X(!0);try{const je=new FileReader;je.onload=async nt=>{try{if((Z&&Z.name?Z.name.toLowerCase():"").endsWith(".csv")){const de=nt.target.result,be=Ie=>{const ae=[];let we="",Fe=!1;for(let Ye=0;Ye<Ie.length;Ye++){const me=Ie[Ye];Fe?me==='"'?Ie[Ye+1]==='"'?(we+='"',Ye++):Fe=!1:we+=me:me==='"'?Fe=!0:me===","?(ae.push(we),we=""):we+=me}return ae.push(we),ae},Se=String(de).split(/\r?\n/).filter(Ie=>Ie.trim()!=="");if(Se.length===0){alert("No valid data found in the file."),X(!1);return}const Ne=be(Se[0]).map(Ie=>String(Ie||"").replace(/\s*\*\s*$/g,"").trim()),ze=[];for(let Ie=1;Ie<Se.length;Ie++){const ae=be(Se[Ie]);if(ae.every(Fe=>String(Fe||"").trim()===""))continue;const we={};for(let Fe=0;Fe<Ne.length;Fe++)we[Ne[Fe]]=ae[Fe]!==void 0?ae[Fe]:"";ze.push(we)}const Re=ze.filter(Ie=>Object.values(Ie).some(ae=>String(ae||"").trim()!==""));if(Re.length===0){alert("No valid data found in the file."),X(!1);return}Y(Re),se(new Set(Re.map((Ie,ae)=>ae))),M(!1),ee(!0),X(!1);return}const Qe=new Uint8Array(nt.target.result),gt=new B2.Workbook;await gt.xlsx.load(Qe);const xe=gt.getWorksheet(1),Oe=[];xe.eachRow((de,be)=>{if(be>1){const Se={};de.eachCell((Ne,ze)=>{const Re=xe.getCell(1,ze).value,Ie=String(Re||"").replace(/\s*\*\s*$/g,"").trim();Se[Ie]=Ne.value}),Oe.push(Se)}});const Ce=Oe.filter(de=>Object.values(de).some(be=>be&&String(be).trim()!==""));if(Ce.length===0){alert("No valid data found in the file."),X(!1);return}Y(Ce),se(new Set(Ce.map((de,be)=>be))),M(!1),ee(!0),X(!1)}catch(Pe){console.error("Error parsing file:",Pe),alert("Failed to parse the file. Please ensure it's a valid Excel or CSV file."),X(!1)}},(Z&&Z.name?Z.name.toLowerCase():"").endsWith(".csv")?je.readAsText(Z):je.readAsArrayBuffer(Z)}catch(je){console.error("Error reading file:",je),alert("Failed to read the selected file."),X(!1)}},$t=je=>{const ct=[];return je.forEach((nt,Pe)=>{const Qe={};(!nt["First Name"]||String(nt["First Name"]).trim()==="")&&(Qe["First Name"]=["First name is required"]),(!nt["Mobile Number"]||String(nt["Mobile Number"]).trim()==="")&&(Qe["Mobile Number"]=["Mobile number is required"]),(!nt.Email||String(nt.Email).trim()==="")&&(Qe.Email=["Email is required"]),(!nt.Gender||String(nt.Gender).trim()==="")&&(Qe.Gender=["Gender is required"]),(!nt.Active||String(nt.Active).trim()==="")&&(Qe.Active=["Active status is required"]),Object.keys(Qe).length>0&&ct.push({rowIndex:Pe,errors:Qe})}),ct},Bt=async()=>{const je=ne.filter((gt,xe)=>ue.has(xe));if(je.length===0){alert("Please select at least one row to import.");return}const ct=$t(je);if(ct.length>0){ke(ft(ct,je));const gt=ct.map(({rowIndex:xe,errors:Oe})=>{var be,Se,Ne;const Ce=[];Object.entries(Oe).forEach(([ze,Re])=>{Array.isArray(Re)?Ce.push(...Re):Ce.push(String(Re))});const de=xe;return{row:de+1,employeeName:((be=je[de])==null?void 0:be.Name)||((Se=je[de])!=null&&Se["First Name"]?String(je[de]["First Name"]||"")+" "+String(je[de]["Last Name"]||""):"N/A"),employeeCode:((Ne=je[de])==null?void 0:Ne["Employee Code"])||"N/A",errors:Ce,data:je[de]}});_e({type:"validation_error",totalRows:je.length,successCount:0,errorCount:ct.length,skipped:0,errors:gt}),fe(!0),X(!1);return}const nt={},Pe={},Qe=[];if(je.forEach((gt,xe)=>{const Oe=String(gt.Email||"").trim().toLowerCase(),Ce=String(gt["Mobile Number"]||"").trim();Oe&&(nt[Oe]!==void 0?Qe.push({rowIndex:xe,errors:{Email:["Duplicate email in selected rows"]}}):nt[Oe]=xe),Ce&&(Pe[Ce]!==void 0?Qe.push({rowIndex:xe,errors:{"Mobile Number":["Duplicate mobile number in selected rows"]}}):Pe[Ce]=xe)}),Qe.length>0){ke(ft(Qe,je));const gt=Qe.map(({rowIndex:xe,errors:Oe})=>{var de,be,Se;const Ce=[];return Object.entries(Oe).forEach(([Ne,ze])=>{Array.isArray(ze)?Ce.push(...ze):Ce.push(String(ze))}),{row:xe+1,employeeName:((de=je[xe])==null?void 0:de.Name)||((be=je[xe])!=null&&be["First Name"]?String(je[xe]["First Name"]||"")+" "+String(je[xe]["Last Name"]||""):"N/A"),employeeCode:((Se=je[xe])==null?void 0:Se["Employee Code"])||"N/A",errors:Ce,data:je[xe]}});_e({type:"validation_error",totalRows:je.length,successCount:0,errorCount:Qe.length,skipped:0,errors:gt}),fe(!0),X(!1);return}X(!0);try{const gt=je.map(async be=>{const Se=be.Country||"";let Ne="",ze="";if(Se&&String(Se).includes("(")){const Ye=String(Se).match(/^\s*(.*?)\s*\(([^)]+)\)\s*$/);Ye?(Ne=Ye[1]||"",ze=Ye[2]||""):Ne=String(Se)}else Ne=Se||be.Country||"";const Re=[];(be["Address 1"]||be["Address 2"]||be["Address 3"]||be.City||be.State||be.Country||be.Pincode)&&Re.push({address1:be["Address 1"]||"",address2:be["Address 2"]||"",address3:be["Address 3"]||"",city:be.City||"",state:be.State||"",country:be.Country||Ne||"",pincode:be.Pincode||""});const ae=[];(be["Bank Name"]||be["Account Number"])&&ae.push({bank_name:be["Bank Name"]||"",branch_name:be["Branch Name"]||"",branch_address:be["Branch Address"]||"",account_number:be["Account Number"]||"",ifsc_code:be["IFSC Code"]||""});const we={salutation:be.Salutation||null,firstname:be["First Name"],lastname:be["Last Name"]||"",dob:tr(be["Date of Birth"]),gender:be.Gender,country:Ne||null,country_code:ze||null,mobile_number:be["Mobile Number"],email:be.Email,aadhar_number:be.Aadhaar||"",pan_number:be.PAN||"",addresses:Re,bank_accounts:ae,active:String(be.Active||"").toLowerCase()==="yes"};if(be["Employee Code"]&&String(be["Employee Code"]).trim()!==""&&(we.empcode=be["Employee Code"]),Re&&Re.length>0){const Ye=Re[0];Ye.address1&&(we.permanent_address1=Ye.address1),Ye.address2&&(we.permanent_address2=Ye.address2),Ye.address3&&(we.permanent_address3=Ye.address3),Ye.city&&(we.permanent_city=Ye.city),Ye.state&&(we.permanent_state=Ye.state),Ye.country&&(we.permanent_country=Ye.country),Ye.pincode&&(we.permanent_pincode=Ye.pincode)}if(ae&&ae.length>0){const Ye=ae[0];Ye.bank_name&&(we.primary_bank_name=Ye.bank_name),Ye.branch_name&&(we.primary_branch_name=Ye.branch_name),Ye.branch_address&&(we.primary_branch_address=Ye.branch_address),Ye.account_number&&(we.primary_account_number=Ye.account_number),Ye.ifsc_code&&(we.primary_ifsc_code=Ye.ifsc_code)}return(await ut.post(`${Je}/api/employees`,we)).data}),xe=await Promise.allSettled(gt),Oe=xe.filter(be=>be.status==="fulfilled").length,Ce=xe.filter(be=>be.status==="rejected").length,de=xe.map((be,Se)=>{var Ne,ze,Re,Ie,ae,we;if(be.status==="rejected"){let Fe=[];const Ye=(ze=(Ne=be.reason)==null?void 0:Ne.response)==null?void 0:ze.data;return Ye&&(Array.isArray(Ye.errors)?Fe=Ye.errors:typeof Ye.error=="string"?Fe=[Ye.error]:typeof Ye.details=="string"?Fe=[Ye.details]:typeof Ye.message=="string"&&(Fe=[Ye.message])),Fe.length===0&&(Fe=[((Re=be.reason)==null?void 0:Re.message)||"Unknown error"]),{row:Se+1,employeeName:((Ie=je[Se])==null?void 0:Ie.Name)||((ae=je[Se])!=null&&ae["First Name"]?je[Se]["First Name"]+" "+je[Se]["Last Name"]:"N/A"),employeeCode:((we=je[Se])==null?void 0:we["Employee Code"])||"N/A",errors:Fe,data:je[Se]}}return null}).filter(Boolean);_e({type:Ce>0?"import_failed":"import_complete",totalRows:je.length,successCount:Oe,errorCount:Ce,skipped:0,errors:de}),fe(!0),ee(!1),Oe>0&&De()}catch(gt){console.error("Import failed:",gt),alert("Import failed: "+gt.message)}finally{X(!1)}},ft=(je=[],ct=[])=>{const nt={};return je.forEach(({rowIndex:Pe,errors:Qe})=>{nt[Pe]=Qe}),nt},tr=je=>{if(je==null||je==="")return null;if(je instanceof Date)return isNaN(je.getTime())?null:je.toISOString();if(typeof je=="number"){const ct=new Date(je);if(!isNaN(ct.getTime()))return ct.toISOString();const nt=new Date(Math.round((je-25569)*86400*1e3));return isNaN(nt.getTime())?null:nt.toISOString()}if(typeof je=="string"){const ct=je.trim();if(ct==="")return null;const nt=new Date(ct);if(!isNaN(nt.getTime()))return nt.toISOString();let Pe=ct.match(/^(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})$/);if(Pe){const Qe=parseInt(Pe[1],10),gt=parseInt(Pe[2],10)-1,xe=parseInt(Pe[3],10),Oe=new Date(xe,gt,Qe);if(!isNaN(Oe.getTime()))return Oe.toISOString()}if(Pe=ct.match(/^(\d{4})[\/\-](\d{1,2})[\/\-](\d{1,2})$/),Pe){const Qe=parseInt(Pe[1],10),gt=parseInt(Pe[2],10)-1,xe=parseInt(Pe[3],10),Oe=new Date(Qe,gt,xe);if(!isNaN(Oe.getTime()))return Oe.toISOString()}if(!isNaN(Number(ct))){const Qe=Number(ct),gt=new Date(Qe);if(!isNaN(gt.getTime()))return gt.toISOString();const xe=new Date(Math.round((Qe-25569)*86400*1e3));if(!isNaN(xe.getTime()))return xe.toISOString()}return null}return null},Me=(je,ct)=>{if(!je)return"";try{if(ct==="Employee Code")return je.usercode||"";if(ct==="Name")return[je.salutation,je.firstname,je.lastname].filter(Boolean).join(" ")||"";if(ct==="DOB")return je.dob?new Date(je.dob).toLocaleDateString():"";if(ct==="Gender")return je.gender||"";if(ct==="Country"){const nt=je.country||"",Pe=je.country_code||"";return nt&&Pe?`${nt} (${Pe})`:nt||Pe||""}if(ct==="MobileNumber")return je.mobile_number||"";if(ct==="Email")return je.email||"";if(ct==="Aadhaar")return je.aadhar_number||"";if(ct==="PAN")return je.pan_number||"";if(ct==="Address 1")return je.addresses&&je.addresses[0]&&je.addresses[0].address1||"";if(ct==="Address 2")return je.addresses&&je.addresses[0]&&je.addresses[0].address2||"";if(ct==="Address 3")return je.addresses&&je.addresses[0]&&je.addresses[0].address3||"";if(ct==="City")return je.addresses&&je.addresses[0]&&je.addresses[0].city||"";if(ct==="State")return je.addresses&&je.addresses[0]&&je.addresses[0].state||"";if(ct==="Address Country")return je.addresses&&je.addresses[0]&&je.addresses[0].country||"";if(ct==="Pincode")return je.addresses&&je.addresses[0]&&je.addresses[0].pincode||"";if(ct==="Bank Info")return!Array.isArray(je.bank_accounts)||je.bank_accounts.length===0?"":je.bank_accounts.map(nt=>{const Pe=[];return nt.bank_name&&Pe.push(`Bank: ${nt.bank_name}`),nt.branch_name&&Pe.push(`Branch: ${nt.branch_name}`),nt.branch_address&&Pe.push(`Address: ${nt.branch_address}`),nt.account_number&&Pe.push(`Account: ${nt.account_number}`),nt.ifsc_code&&Pe.push(`IFSC: ${nt.ifsc_code}`),Pe.join(" | ")}).join(` 
 `);if(ct==="Documents")return!Array.isArray(je.documents)||je.documents.length===0?"":je.documents.map(nt=>{const Pe=nt.doc_type||nt.type||nt.document_type||nt.name||"",Qe=nt.doc_number||nt.number||nt.doc_no||nt.document_number||"";return`${Pe}${Qe?" No:"+Qe:""}`.trim()}).join(" | ");if(ct==="Status"){const nt=je.is_active!==void 0?je.is_active:je.active!==void 0?je.active:je.status!==void 0?je.status:je.isActive;return typeof nt=="boolean"?nt?"Active":"Inactive":typeof nt=="string"?nt:""}return""}catch{return""}},tt=(je,ct)=>{i(ct)},Ze=je=>{u(parseInt(je.target.value,10)),i(0)},St=()=>{e("/employeemaster")},et=je=>{e(`/employeemaster/${je.id}`)},Ht=je=>{_(je),U(!0)},Nt=je=>{O(je),C(!0)},kt=async()=>{if(L)try{await ut.delete(`${Je}/api/employees/${L.id}`),kr("Employee deleted successfully","success"),De()}catch(je){console.error("Error deleting employee:",je),kr("Error deleting employee","error")}finally{C(!1),O(null)}},kr=(je,ct)=>{D(je),P(ct),z(!0)},Jt=()=>{z(!1)},Pt=je=>je?new Date(je).toLocaleDateString():"",Ur=je=>{if(!je)return"";const ct=je.country||Array.isArray(je.addresses)&&je.addresses[0]&&(je.addresses[0].country||"")||"",nt=je.country_code||Array.isArray(je.addresses)&&je.addresses[0]&&(je.addresses[0].country_code||"")||"";return ct&&nt?`${ct} (${nt})`:ct||nt||""},Lr=je=>je.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),vt=je=>{const ct=(n.search||"").trim();if(!ct||typeof je!="string")return je;const nt=new RegExp(`(${Lr(ct)})`,"gi");return je.split(nt).map((Qe,gt)=>nt.test(Qe)?a.jsx("mark",{style:{backgroundColor:"#ffff00",padding:"0 2px"},children:Qe},gt):Qe)},nr=je=>{if(!je)return null;const ct=je.file_url||je.file_name||je.url||je.path||"";if(!ct)return null;const nt=String(ct);if(/^https?:\/\//i.test(nt))return nt;try{const Pe=String(Je||"").replace(/\/$/,""),Qe=nt.replace(/^\.\//,"").replace(/^\/+/,"");return`${Pe}/${Qe}`}catch{return nt}},Cr=je=>{const ct=nr(je);if(!ct)return kr("No file available to view","warning");window.open(ct,"_blank","noopener,noreferrer")},Dt=async je=>{try{const ct=nr(je);if(!ct)return kr("No file available to download","warning");const nt=document.createElement("a");nt.href=ct,nt.download=je.file_name||ct.split("/").pop()||"document",document.body.appendChild(nt),nt.click(),nt.remove()}catch(ct){console.error("Download failed",ct),kr("Download failed","error")}};return a.jsx("section",{className:"right-content",children:a.jsxs(Ut,{sx:{p:1,mt:1},children:[a.jsx(Et,{variant:"h5",gutterBottom:!0,children:"All Employees List"}),a.jsx(sa,{sx:{p:2,mb:2},children:a.jsxs(Ut,{display:"flex",alignItems:"center",width:"100%",className:"list-toolbar",children:[a.jsxs(Ut,{display:"flex",alignItems:"center",children:[a.jsx("div",{className:"search-wrap",style:{marginRight:16},children:a.jsxs("div",{className:"search-input",children:[a.jsx("input",{type:"text",placeholder:"Search here...",value:n.search,onChange:je=>s({...n,search:je.target.value}),"aria-label":"Search"}),n.search?a.jsx("button",{type:"button",className:"search-clear",onClick:()=>s({...n,search:""}),"aria-label":"clear-search",children:""}):a.jsx("button",{type:"button",className:"search-btn","aria-label":"search",children:""})]})}),a.jsxs("div",{className:"toolbar-actions",children:[a.jsxs("button",{type:"button",className:"plain-action",onClick:Te,title:"Display Preferences",children:[a.jsx(v7,{}),a.jsx("span",{className:"action-label",children:"Display"})]}),a.jsxs("button",{type:"button",className:"plain-action",onClick:()=>M(!0),title:"Import",children:[a.jsx(D6,{}),a.jsx("span",{className:"action-label",children:"Import"})]}),a.jsxs("button",{type:"button",className:"plain-action",onClick:at,title:"Export",children:[a.jsx(g7,{}),a.jsx("span",{className:"action-label",children:"Export"})]})]})]}),a.jsx(Br,{variant:"contained",startIcon:a.jsx(jz,{}),onClick:St,sx:{ml:"auto"},children:"Add Employee"})]})}),a.jsx(Ws,{component:sa,children:a.jsxs(Cs,{sx:{width:"100%",tableLayout:"auto"},children:[a.jsx(js,{children:a.jsxs(pn,{children:[a.jsx(qe,{padding:"checkbox",sx:{minWidth:56},children:a.jsx(Wn,{checked:r.length>0&&A.length===r.length,indeterminate:A.length>0&&A.length<r.length,onChange:He,size:"small"})}),a.jsx(qe,{sx:{minWidth:80},children:"S.No"}),ge.map(je=>a.jsx(qe,{sx:{minWidth:m(je)},children:je},je)),a.jsx(qe,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:"Actions"})]})}),a.jsx(fs,{children:h?a.jsx(pn,{children:a.jsx(qe,{colSpan:ge.length+3,align:"center",children:a.jsx(Vs,{})})}):r.length===0?a.jsx(pn,{children:a.jsx(qe,{colSpan:ge.length+3,align:"center",children:"No employees found"})}):r.map((je,ct)=>a.jsxs(pn,{selected:A.includes(je.id),hover:!0,sx:{cursor:"pointer","& td":{borderBottom:"1px solid rgba(224,224,224,1)",verticalAlign:"middle"}},onClick:()=>{_(je),U(!0)},children:[a.jsx(qe,{padding:"checkbox",sx:{minWidth:56},children:a.jsx(Wn,{checked:A.includes(je.id),onChange:()=>Xe(je.id),onClick:nt=>nt.stopPropagation(),size:"small"})}),a.jsx(qe,{sx:{minWidth:80},children:o*c+ct+1}),ge.map(nt=>a.jsxs(qe,{sx:{minWidth:m(nt),whiteSpace:"normal",wordBreak:"break-word"},children:[nt==="Photo"&&(()=>{var gt;const Pe=(gt=je.documents)==null?void 0:gt.find(xe=>{var Oe,Ce,de;return((Oe=xe.doc_type)==null?void 0:Oe.toLowerCase())==="photo"||((Ce=xe.doc_type)==null?void 0:Ce.toLowerCase())==="employee photo"||((de=xe.doc_type)==null?void 0:de.toLowerCase())==="profile"}),Qe=je.photo||je.profile_picture||(Pe?nr(Pe):null);return a.jsx(H$,{src:Qe,alt:"Photo",variant:"square",sx:{width:80,height:80,cursor:Qe?"pointer":"default"},onClick:xe=>{xe.stopPropagation(),Qe&&Pe?Cr(Pe):Qe&&window.open(Qe,"_blank","noopener,noreferrer")},children:[je.firstname,je.lastname].filter(Boolean).join(" ").charAt(0).toUpperCase()})})(),nt==="Employee Code"&&vt(je.usercode),nt==="Name"&&vt([je.salutation,je.firstname,je.lastname].filter(Boolean).join(" ")),nt==="DOB"&&Pt(je.dob),nt==="Gender"&&vt(je.gender),nt==="Country"&&vt(Ur(je)),nt==="MobileNumber"&&vt(je.mobile_number),nt==="Email"&&vt(je.email),nt==="Aadhaar"&&vt(je.aadhar_number),nt==="PAN"&&vt(je.pan_number),nt==="Address 1"&&vt(je.addresses&&je.addresses[0]&&je.addresses[0].address1||""),nt==="Address 2"&&vt(je.addresses&&je.addresses[0]&&je.addresses[0].address2||""),nt==="Address 3"&&vt(je.addresses&&je.addresses[0]&&je.addresses[0].address3||""),nt==="City"&&vt(je.addresses&&je.addresses[0]&&je.addresses[0].city||""),nt==="State"&&vt(je.addresses&&je.addresses[0]&&je.addresses[0].state||""),nt==="Add. Country"&&vt(je.addresses&&je.addresses[0]?je.addresses[0].country&&je.addresses[0].country_code?`${je.addresses[0].country} (${je.addresses[0].country_code})`:je.addresses[0].country||je.addresses[0].country_code||"":""),nt==="Pincode"&&vt(je.addresses&&je.addresses[0]&&je.addresses[0].pincode||""),nt==="Bank Info"&&(Array.isArray(je.bank_accounts)&&je.bank_accounts.length>0?je.bank_accounts.map((Pe,Qe)=>a.jsxs("div",{style:{marginBottom:8},children:[Pe.bank_name&&a.jsxs("div",{children:[a.jsx("b",{children:"Bank:"})," ",Pe.bank_name]}),Pe.branch_name&&a.jsxs("div",{children:[a.jsx("b",{children:"Branch:"})," ",Pe.branch_name]}),Pe.branch_address&&a.jsxs("div",{children:[a.jsx("b",{children:"Address:"})," ",Pe.branch_address]}),Pe.account_number&&a.jsxs("div",{children:[a.jsx("b",{children:"Account:"})," ",Pe.account_number]}),Pe.ifsc_code&&a.jsxs("div",{children:[a.jsx("b",{children:"IFSC:"})," ",Pe.ifsc_code]})]},Qe)):""),nt==="Documents"&&(Array.isArray(je.documents)&&je.documents.length>0?je.documents.map((Pe,Qe)=>a.jsxs("div",{style:{marginBottom:8},children:[a.jsxs("div",{children:[a.jsx("b",{children:"Type:"})," ",Pe.doc_type||Pe.type]}),Pe.doc_number&&a.jsxs("div",{children:[a.jsx("b",{children:"No:"})," ",Pe.doc_number]}),a.jsx("div",{children:Pe.file_name||Pe.file_url})]},Qe)):""),nt==="Status"&&(()=>{const Pe=je.is_active!==void 0?je.is_active:je.active!==void 0?je.active:je.status!==void 0?je.status:je.isActive,Qe=typeof Pe=="boolean"?Pe:typeof Pe=="string"?Pe.toLowerCase()==="active"||Pe.toLowerCase()==="true":!!Pe;return a.jsx(b7,{label:Qe?"Active":"Inactive",color:Qe?"success":"default",size:"small"})})()]},nt)),a.jsx(qe,{sx:{minWidth:220,verticalAlign:"middle",textAlign:"center",py:1.25},children:a.jsxs(Ut,{sx:{display:"inline-flex",gap:1,alignItems:"center",justifyContent:"center"},children:[a.jsx(bs,{title:"View",children:a.jsx(sn,{size:"small",onClick:nt=>{nt.stopPropagation(),Ht(je)},sx:{p:.5},children:a.jsx(cv,{})})}),a.jsx(bs,{title:"Edit",children:a.jsx(sn,{size:"small",onClick:nt=>{nt.stopPropagation(),et(je)},sx:{p:.5},children:a.jsx(bl,{})})}),a.jsx(bs,{title:"Delete",children:a.jsx(sn,{size:"small",onClick:nt=>{nt.stopPropagation(),Nt(je)},sx:{p:.5},children:a.jsx(ql,{})})})]})})]},je.id))})]})}),a.jsx(Zm,{component:"div",count:l,page:o,onPageChange:tt,rowsPerPage:c,onRowsPerPageChange:Ze,rowsPerPageOptions:[5,10,25,50]}),a.jsxs(Oa,{open:S,onClose:()=>C(!1),children:[a.jsx(Wa,{children:"Confirm Delete"}),a.jsx(Pa,{children:"Are you sure you want to delete this employee? This action cannot be undone."}),a.jsxs(Va,{children:[a.jsx(Br,{onClick:()=>C(!1),children:"Cancel"}),a.jsx(Br,{onClick:kt,color:"error",children:"Delete"})]})]}),a.jsx(tu,{open:H,autoHideDuration:6e3,onClose:Jt,children:a.jsx(eu,{onClose:Jt,severity:W,children:q})}),a.jsxs(Oa,{open:p,onClose:pe,maxWidth:"lg",fullWidth:!0,sx:{"& .MuiDialog-paper":{width:"90%",maxWidth:1200}},children:[a.jsx(Wa,{children:"Display Preferences"}),a.jsxs(Pa,{children:[a.jsxs(Ut,{display:"flex",alignItems:"center",mb:2,children:[a.jsx(Wn,{checked:b.length===g.length,indeterminate:b.length>0&&b.length<g.length,onChange:je=>{je.target.checked?(y(g),localStorage.setItem("employeeListCheckedFields",JSON.stringify(g))):(y([]),localStorage.setItem("employeeListCheckedFields",JSON.stringify([])))},size:"small",sx:{p:.5,mr:1}}),a.jsx("span",{style:{fontWeight:500,fontSize:15},children:"Select All"})]}),a.jsx(Ut,{sx:{display:"grid",gridTemplateColumns:"repeat(6, minmax(0, 1fr))",gap:2},children:g.map(je=>a.jsxs(Ut,{sx:{display:"flex",alignItems:"center",minHeight:20},children:[a.jsx(Wn,{checked:b.includes(je),onChange:()=>ye(je),size:"small",sx:{p:.5,mr:1}}),a.jsx("span",{style:{fontSize:14},children:je})]},je))})]}),a.jsx(Va,{children:a.jsx(Br,{onClick:pe,children:"Close"})})]}),a.jsxs(Oa,{open:V,onClose:()=>{M(!1),J(null),X(!1)},maxWidth:"md",fullWidth:!0,children:[a.jsx(Wa,{children:"Import Employees"}),a.jsxs(Pa,{children:[a.jsx(Et,{variant:"body2",color:"textSecondary",sx:{mb:2},children:"Import employees from a CSV file. Make sure you have downloaded the template and filled it correctly."}),a.jsxs(Ut,{sx:{mb:2,p:2,bgcolor:"info.lighter",borderRadius:1},children:[a.jsx(Et,{variant:"body2",sx:{mb:1},children:a.jsx("strong",{children:"Instructions:"})}),a.jsxs(Et,{variant:"body2",component:"ul",sx:{pl:2,mb:0},children:[a.jsx("li",{children:"Download the template Excel file below"}),a.jsx("li",{children:"Fill in your employee data following the template format"}),a.jsx("li",{children:"Required fields are marked with asterisk (*)"}),a.jsx("li",{children:"You can edit the info after upload the CSV file"}),a.jsx("li",{style:{color:"red"},children:"Upload the completed CSV file"})]})]}),a.jsx(Ut,{sx:{mb:2},children:a.jsx(Br,{variant:"outlined",color:"primary",onClick:dt,startIcon:a.jsx(Nz,{}),children:"Download Template Excel"})}),a.jsx("input",{type:"file",accept:".csv",onChange:je=>J(je.target.files[0]),style:{marginBottom:"16px"}}),Z&&a.jsxs(Et,{variant:"body2",sx:{mb:2},children:["Selected file: ",a.jsx("strong",{children:Z.name})]})]}),a.jsxs(Va,{children:[a.jsx(Br,{onClick:()=>M(!1),children:"Cancel"}),a.jsx(Br,{variant:"contained",color:"primary",onClick:wt,disabled:!Z||re,children:re?a.jsx(Vs,{size:20}):"Upload & Preview"})]})]}),a.jsxs(Oa,{open:K,onClose:(je,ct)=>{ct==="backdropClick"||ct==="escapeKeyDown"||ee(!1)},maxWidth:"lg",fullWidth:!0,children:[a.jsx(Wa,{children:"Import Preview"}),a.jsxs(Pa,{children:[a.jsx(Et,{variant:"body2",sx:{mb:2},children:"Review the data before importing. Select the rows you want to import."}),(()=>{const je=[];je.push("Employee Code"),ne&&ne[0]&&Object.keys(ne[0]).forEach(nt=>{String(nt).trim()!==""&&nt!=="Employee Code"&&je.push(nt)});var ct=je;return a.jsx(Ws,{component:sa,sx:{maxHeight:400},children:a.jsxs(Cs,{stickyHeader:!0,children:[a.jsx(js,{children:a.jsxs(pn,{children:[a.jsx(qe,{padding:"checkbox",children:a.jsx(Wn,{checked:ue.size===ne.length,onChange:nt=>{nt.target.checked?se(new Set(ne.map((Pe,Qe)=>Qe))):se(new Set)}})}),ct.map(nt=>{const Pe=new Set(["salutation","firstname","gender","countrynamecode","mobilenumber","email","active"]),Qe=String(nt||"").toLowerCase().replace(/[^a-z0-9]/g,""),gt=Pe.has(Qe);return a.jsxs(qe,{sx:{fontWeight:600},children:[nt,gt?a.jsx("span",{style:{color:"red",marginLeft:6},children:"*"}):null]},nt)})]})}),a.jsx(fs,{children:ne.map((nt,Pe)=>a.jsxs(pn,{children:[a.jsx(qe,{padding:"checkbox",children:a.jsx(Wn,{checked:ue.has(Pe),onChange:Qe=>{const gt=new Set(ue);Qe.target.checked?gt.add(Pe):gt.delete(Pe),se(gt)}})}),ct.map((Qe,gt)=>{const xe=nt&&Object.prototype.hasOwnProperty.call(nt,Qe)?nt[Qe]:"",Oe=le[Pe]&&le[Pe][Qe];return a.jsx(Moe,{value:xe,rowIndex:Pe,columnKey:Qe,onUpdate:(Ce,de,be)=>{Y(Se=>{const Ne=[...Se];return Ne[Ce]={...Ne[Ce],[de]:be},Ne}),ke(Se=>{if(!Se||!Se[Ce]||!Se[Ce][de])return Se;const Ne={...Se},ze={...Ne[Ce]};return delete ze[de],Object.keys(ze).length===0?delete Ne[Ce]:Ne[Ce]=ze,Ne})},error:!!Oe,errorMessages:Oe||[],cellSx:{backgroundColor:Oe?"rgba(244, 67, 54, 0.05)":"inherit"}},gt)})]},Pe))})]})})})()]}),a.jsxs(Va,{children:[a.jsx(Br,{onClick:()=>ee(!1),children:"Cancel"}),a.jsx(Br,{onClick:Bt,variant:"contained",disabled:ue.size===0||re,children:re?a.jsx(Vs,{size:20}):`Import ${ue.size} Employees`})]})]}),a.jsxs(Oa,{open:ce,onClose:(je,ct)=>{ct==="backdropClick"||ct==="escapeKeyDown"||fe(!1)},maxWidth:"md",fullWidth:!0,children:[a.jsx(Wa,{children:a.jsxs(Ut,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[a.jsx(Et,{variant:"h6",children:(ve==null?void 0:ve.type)==="validation_error"?"Validation Errors":(ve==null?void 0:ve.type)==="import_failed"?"Import Failed":"Import Report"}),a.jsx(Ut,{display:"flex",gap:2,children:(ve==null?void 0:ve.type)==="import_complete"&&a.jsxs(a.Fragment,{children:[a.jsxs(Et,{variant:"body2",color:"success.main",children:[" ",ve.successCount," Imported"]}),ve.errorCount>0&&a.jsxs(Et,{variant:"body2",color:"error.main",children:[" ",ve.errorCount," Errors"]}),ve.skipped>0&&a.jsxs(Et,{variant:"body2",color:"warning.main",children:[" ",ve.skipped," Skipped"]})]})})]})}),a.jsx(Pa,{children:ve&&a.jsxs(Ut,{children:[a.jsxs(Ut,{sx:{mb:3,p:2,bgcolor:"background.paper",borderRadius:1,border:"1px solid",borderColor:"divider"},children:[a.jsx(Et,{variant:"subtitle2",gutterBottom:!0,children:"Summary"}),a.jsxs(Ut,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[a.jsxs(Ut,{sx:{flex:"1 1 25%"},children:[a.jsx(Et,{variant:"body2",color:"textSecondary",children:"Total Rows:"}),a.jsx(Et,{variant:"h6",children:ve.totalRows})]}),a.jsxs(Ut,{sx:{flex:"1 1 25%"},children:[a.jsx(Et,{variant:"body2",color:"success.main",children:"Successful:"}),a.jsx(Et,{variant:"h6",color:"success.main",children:ve.successCount})]}),a.jsxs(Ut,{sx:{flex:"1 1 25%"},children:[a.jsx(Et,{variant:"body2",color:"error.main",children:"Errors:"}),a.jsx(Et,{variant:"h6",color:"error.main",children:ve.errorCount})]}),ve.skipped>0&&a.jsxs(Ut,{sx:{flex:"1 1 25%"},children:[a.jsx(Et,{variant:"body2",color:"warning.main",children:"Skipped:"}),a.jsx(Et,{variant:"h6",color:"warning.main",children:ve.skipped})]})]})]}),ve.errors&&ve.errors.length>0&&a.jsxs(Ut,{sx:{mb:3},children:[a.jsxs(Et,{variant:"subtitle2",color:"error.main",gutterBottom:!0,children:["Errors (",ve.errors.length,")"]}),a.jsx(Ws,{component:sa,sx:{maxHeight:300},children:a.jsxs(Cs,{size:"small",children:[a.jsx(js,{children:a.jsxs(pn,{children:[a.jsx(qe,{sx:{fontWeight:"bold"},children:"Row"}),a.jsx(qe,{sx:{fontWeight:"bold"},children:"Employee Name"}),a.jsx(qe,{sx:{fontWeight:"bold"},children:"Employee Code"}),a.jsx(qe,{sx:{fontWeight:"bold"},children:"Error Details"})]})}),a.jsx(fs,{children:ve.errors.map((je,ct)=>a.jsxs(pn,{children:[a.jsx(qe,{children:je.row||"N/A"}),a.jsx(qe,{children:je.employeeName||"N/A"}),a.jsx(qe,{children:je.employeeCode||"N/A"}),a.jsx(qe,{children:a.jsx(Ut,{children:Array.isArray(je.errors)?je.errors.map((nt,Pe)=>a.jsxs(Et,{variant:"body2",color:"error.main",sx:{mb:.5},children:[" ",nt]},Pe)):a.jsx(Et,{variant:"body2",color:"error.main",children:je.errors||"Unknown error"})})})]},ct))})]})})]}),ve.successCount>0&&a.jsx(Ut,{sx:{p:2,bgcolor:"success.lighter",borderRadius:1},children:a.jsxs(Et,{variant:"body2",color:"success.main",children:[" Successfully imported ",ve.successCount," employee",ve.successCount>1?"s":""]})})]})}),a.jsxs(Va,{children:[a.jsx(Br,{onClick:()=>{if(fe(!1),ve!=null&&ve.errors&&Array.isArray(ve.errors)){const je=new Set(ue);ve.errors.forEach(ct=>{const nt=ct==null?void 0:ct.row;typeof nt=="number"&&nt>0&&je.add(nt-1)}),se(je)}ee(!0)},variant:"outlined",children:"Edit"}),a.jsx(Br,{onClick:()=>{fe(!1),(ve==null?void 0:ve.successCount)>0&&De()},variant:"contained",color:"primary",children:"Close"})]})]}),a.jsx("div",{className:`employee-view-dialog ${I?"open":""}`,children:a.jsxs("div",{className:"employee-view-dialog-content",children:[a.jsxs("div",{className:"employee-view-dialog-header",children:[a.jsxs("div",{className:"employee-view-dialog-title-section",children:[a.jsx("h2",{className:"employee-view-dialog-title",children:"Employee Details"}),k&&a.jsx("p",{className:"employee-view-dialog-subtitle",children:[k.salutation,k.firstname,k.lastname].filter(Boolean).join(" ")})]}),a.jsx("div",{children:k&&(()=>{const je=k.is_active!==void 0?k.is_active:k.active!==void 0?k.active:k.status!==void 0?k.status:k.isActive,ct=typeof je=="boolean"?je:typeof je=="string"?je.toLowerCase()==="active"||je.toLowerCase()==="true":!!je;return a.jsx("div",{className:`employee-view-dialog-status ${ct?"active":"inactive"}`,children:ct?"Active":"Inactive"})})()})]}),a.jsx("div",{className:"employee-view-dialog-body",children:k?a.jsxs("div",{children:[a.jsxs("div",{className:"employee-details-section",children:[a.jsx("h3",{className:"section-title",children:"Employee Information"}),a.jsxs("div",{className:"form-grid col-12",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Employee Code"}),a.jsx("input",{type:"text",value:k.usercode||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Name"}),a.jsx("input",{type:"text",value:[k.salutation,k.firstname,k.lastname].filter(Boolean).join(" "),disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"DOB"}),a.jsx("input",{type:"text",value:k.dob?new Date(k.dob).toLocaleDateString():"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Gender"}),a.jsx("input",{type:"text",value:k.gender||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Country"}),a.jsx("input",{type:"text",value:Ur(k),disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Mobile Number"}),a.jsx("input",{type:"text",value:k.mobile_number||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",style:{gridColumn:"1 / 3"},children:[a.jsx("label",{children:"Email"}),a.jsx("input",{type:"text",value:k.email||"",disabled:!0})]})]})]}),a.jsxs("div",{className:"employee-details-section",children:[a.jsx("h3",{className:"section-title",children:"Address Information"}),Array.isArray(k.addresses)&&k.addresses.length>0?a.jsx("div",{children:k.addresses.map((je,ct)=>a.jsxs("div",{className:"address-block",children:[a.jsx("h4",{className:"address-title",children:je.title||`Address ${ct+1}`}),a.jsxs("div",{className:"form-grid col-12",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Address 1"}),a.jsx("input",{type:"text",value:je.address1||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Address 2"}),a.jsx("input",{type:"text",value:je.address2||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Address 3"}),a.jsx("input",{type:"text",value:je.address3||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"City"}),a.jsx("input",{type:"text",value:je.city||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"State"}),a.jsx("input",{type:"text",value:je.state||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Country"}),a.jsx("input",{type:"text",value:je.country&&je.country_code?`${je.country} (${je.country_code})`:je.country||je.country_code||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Pincode"}),a.jsx("input",{type:"text",value:je.pincode||"",disabled:!0})]})]})]},ct))}):a.jsx("p",{className:"no-data-message",children:"No addresses available"})]}),a.jsxs("div",{className:"employee-details-section",children:[a.jsx("h3",{className:"section-title",children:"Bank Information"}),Array.isArray(k.bank_accounts)&&k.bank_accounts.length>0?a.jsx("div",{children:k.bank_accounts.map((je,ct)=>a.jsxs("div",{className:"bank-block",children:[a.jsxs("h4",{className:"bank-title",children:["Bank Account ",ct+1]}),a.jsxs("div",{className:"form-grid col-12",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Bank Name"}),a.jsx("input",{type:"text",value:je.bank_name||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Branch Name"}),a.jsx("input",{type:"text",value:je.branch_name||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Branch Address"}),a.jsx("input",{type:"text",value:je.branch_address||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Account Number"}),a.jsx("input",{type:"text",value:je.account_number||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"IFSC Code"}),a.jsx("input",{type:"text",value:je.ifsc_code||"",disabled:!0})]})]})]},ct))}):a.jsx("p",{className:"no-data-message",children:"No bank information available"})]}),a.jsxs("div",{className:"employee-details-section",children:[a.jsx("h3",{className:"section-title",children:"Documents"}),Array.isArray(k.documents)&&k.documents.length>0?a.jsx("div",{className:"documents-grid",children:k.documents.map((je,ct)=>{const nt=je.doc_type||je.type||"Document",Pe=je.doc_number||je.number||"",Qe=je.file_name||je.file_url||je.url||"",gt=nr(je),xe=/\.(jpg|jpeg|png|gif|bmp|webp)$/i.test(Qe||"");return a.jsxs("div",{className:"document-card",children:[xe&&gt?a.jsx("div",{className:"document-preview-container",children:a.jsx("img",{src:gt,alt:nt,className:"document-preview-image"})}):a.jsxs("div",{className:"document-preview-placeholder",children:[a.jsx("div",{className:"document-icon",children:""}),a.jsx("span",{className:"document-placeholder-text",children:"Non-image document"})]}),a.jsxs("div",{className:"document-info",children:[a.jsx("h4",{className:"document-type",children:nt}),Pe&&a.jsxs("p",{className:"document-number",children:["No: ",Pe]}),Qe&&a.jsx("p",{className:"document-filename",children:Qe})]}),a.jsxs("div",{className:"document-actions",children:[a.jsx("button",{type:"button",className:"doc-action-btn",onClick:()=>Cr(je),title:"View",children:" View"}),a.jsx("button",{type:"button",className:"doc-action-btn",onClick:()=>Dt(je),title:"Download",children:" Download"})]})]},ct)})}):a.jsx("p",{className:"no-data-message",children:"No documents available"})]}),a.jsxs("div",{className:"employee-details-section",children:[a.jsx("h3",{className:"section-title",children:"Legal Information"}),a.jsxs("div",{className:"form-grid col-12",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Aadhaar"}),a.jsx("input",{type:"text",value:k.aadhar_number||"",disabled:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"PAN"}),a.jsx("input",{type:"text",value:k.pan_number||"",disabled:!0})]})]})]}),a.jsxs("div",{className:"employee-details-section",children:[a.jsx("h3",{className:"section-title",children:"Authentication"}),a.jsxs("div",{className:"form-grid col-12",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Username"}),a.jsx("input",{type:"text",value:k.username||"",disabled:!0})]}),a.jsxs("div",{className:"form-field password-input-container",children:[a.jsx("label",{children:"Password"}),a.jsx("input",{type:R?"text":"password",value:k.plain_password||k.plainPassword||k.password||"",disabled:!0}),(k.plain_password||k.plainPassword||k.password)&&a.jsx("button",{type:"button",className:"password-toggle",onClick:()=>j(!R),title:R?"Hide password":"Show password",children:R?"":""})]})]})]})]}):a.jsx("p",{children:"No employee selected."})}),a.jsxs("div",{className:"employee-view-dialog-footer",children:[a.jsx("button",{className:"btn btn-secondary",onClick:()=>U(!1),children:"Close"}),a.jsx("button",{className:"btn btn-outline",onClick:()=>{U(!1),e(`/employeemaster/${k.id}`)},children:"Edit Employee"})]})]})}),I&&a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:1299},onClick:()=>U(!1)})]})})}const Ioe=["Mr","Mrs","Miss","Dr","Prof"],Ooe=["Employee Photo","Passport","Aadhaar Card","PAN Card","Driving License","Voter ID","Bank Statement","Address Proof","Photo","Certificate","Other"],Poe=Object.values(Bf),Foe=[{label:"Employee",value:"is_employee"}];function oj({children:e,value:r,index:t}){return r===t?a.jsx("div",{className:"tab-content active",style:{paddingTop:"16px"},children:e}):null}const Boe=({defaultValues:e=null,onSubmitUser:r})=>{var Oe,Ce;const t=ii(),{register:n,handleSubmit:s,control:o,reset:i,watch:c,getValues:u,trigger:l,setValue:d,clearErrors:h,formState:{isDirty:f,errors:p}}=Gl({mode:"onChange",defaultValues:{active:!0,salutation:"",gender:"",username:"",usercode:"",aadhar_number:"",pan_number:""},shouldUnregister:!1}),v=vr.useRef(null);vr.useEffect(()=>{const de=v.current;if(!de)return;const be=(Re,Ie,ae)=>{const we=document.createElement("input");return we.type=Re,we.name=Ie,we.autocomplete=ae,we.style.position="absolute",we.style.left="-9999px",we.style.top="-9999px",we.style.width="1px",we.style.height="1px",we.style.opacity="0",we.setAttribute("aria-hidden","true"),we},Se=be("text","prevent_autofill_username","username"),Ne=be("password","prevent_autofill_password","new-password");try{de.prepend(Ne),de.prepend(Se)}catch{}return de.querySelectorAll("input, textarea, select").forEach(Re=>{try{Re.setAttribute("autocomplete","off"),Re.setAttribute("autocorrect","off"),Re.setAttribute("autocapitalize","off"),Re.setAttribute("spellcheck","false")}catch{}}),()=>{try{Se.remove()}catch{}try{Ne.remove()}catch{}}},[]);const[g,m]=vr.useState((e==null?void 0:e.additional_addresses)||[]),[b,y]=vr.useState([]),[S,C]=vr.useState([]),[L,O]=vr.useState([]),[H,z]=vr.useState(!1),[q,D]=vr.useState(null),[W,P]=vr.useState(null),[I,U]=vr.useState(!1),[k,_]=vr.useState(!1),R=()=>U(de=>!de),j=()=>_(de=>!de),A=de=>{de.preventDefault()};c("is_user",!1);const N=c("account_types",""),V=String(N)==="is_dealer",M=String(N)==="is_distributor";c("same_as_permanent");const Z=c("active",!0),J=c("permanent_country",""),[re,X]=vr.useState([]),[ne,Y]=vr.useState(!1),[K,ee]=vr.useState([]),[ue,se]=vr.useState(!1),[ce,fe]=vr.useState([]),[ve,_e]=vr.useState(!1),[le,ke]=vr.useState([]),[Te,pe]=vr.useState(!1),ye=String(N)==="is_customer",ge=c("under_type","");c("distributor_id",null),c("dealer_id",null),c("supplier_id",null),G.useEffect(()=>{ye||(d("dealer_id",null),d("under_type",""))},[ye,d]),G.useEffect(()=>{let de=!1;return(V||ye)&&(async()=>{Y(!0);try{const Se=await ut.get(`${Je}/api/users`,{params:{user_type:"distributor",limit:1e3}});if(!de){const Ne=Array.isArray(Se.data.data)?Se.data.data:Se.data;X(Ne||[]),ge==="distributor"&&ke(Ne||[])}}catch(Se){console.error("Failed to fetch distributors",Se),X([])}finally{de||Y(!1)}})(),()=>{de=!0}},[V,ye]),G.useEffect(()=>{let de=!1;return(V||ye)&&(async()=>{_e(!0);try{const Se=await ut.get(`${Je}/api/users`,{params:{user_type:"supplier",limit:1e3}}),{data:Ne}=Se,ze=(Ne==null?void 0:Ne.data)||Ne;de||(fe(ze||[]),ge==="supplier"&&ke(ze||[]))}catch(Se){console.error("Failed to fetch suppliers",Se),fe([])}finally{de||_e(!1)}})(),()=>{de=!0}},[V,ye,ge]),G.useEffect(()=>{let de=!1;return(M||ye)&&(async()=>{se(!0);try{const Se=await ut.get(`${Je}/api/users`,{params:{user_type:"dealer",limit:1e3}});if(!de){const Ne=Array.isArray(Se.data.data)?Se.data.data:Se.data;ee(Ne||[]),ge==="dealer"&&ke(Ne||[])}}catch(Se){console.error("Failed to fetch dealers",Se),ee([])}finally{de||se(!1)}})(),()=>{de=!0}},[M,ye,ge]),G.useEffect(()=>{let de=!1;return V&&ge==="supplier"&&(async()=>{_e(!0);try{const Se=await ut.get(`${Je}/api/users`,{params:{user_type:"supplier",limit:1e3}});if(!de){const Ne=Array.isArray(Se.data.data)?Se.data.data:Se.data;fe(Ne||[]),ge==="supplier"&&ke(Ne||[])}}catch(Se){console.error("Failed to fetch suppliers",Se),fe([])}finally{de||_e(!1)}})(),()=>{de=!0}},[ge,V]),G.useEffect(()=>{if(!ye){ke([]);return}ke(ge==="distributor"?re||[]:ge==="dealer"?K||[]:ge==="supplier"?ce||[]:[])},[ge,re,K,ce,ye]),G.useEffect(()=>{let de=!1;return(async()=>{if(!ge){ke([]);return}pe(!0);try{const Se=await ut.get(`${Je}/api/users`,{params:{user_type:ge,limit:1e3}});if(!de){const Ne=Array.isArray(Se.data.data)?Se.data.data:Se.data;ke(Ne||[])}}catch(Se){console.error("Failed to fetch under-type users",Se),de||ke([])}finally{de||pe(!1)}})(),()=>{de=!0}},[ge]),Dv({control:o,name:["address1","address2","address3","city","state","permanent_country","pincode"]}),G.useEffect(()=>{if(e){const de=(ae=[])=>{const we=e.documents||e.uploaded_documents||[],Fe=ae.map(Ye=>String(Ye).toLowerCase());return we.find(Ye=>{const me=String((Ye==null?void 0:Ye.doc_type)||(Ye==null?void 0:Ye.type)||"").toLowerCase();return Fe.some(Be=>Be&&me.includes(Be))})||null},be=(ae=[],we=[],Fe=["doc_number"])=>{for(const me of we)if(e[me])return e[me];const Ye=de(ae);if(Ye){for(const me of Fe)if(Ye[me])return Ye[me]}return""},Se=ae=>ae?typeof ae=="string"?ae:typeof ae=="object"&&(ae.name||ae.country||ae.label)||"":"",Ne=ae=>ae?typeof ae=="string"?/^\+/.test(ae)||/^\d+$/.test(ae)?ae:"":typeof ae=="object"&&(ae.code||ae.dial_code||ae.dialCode||ae.country_code)||"":"",ze=Array.isArray(e.addresses)?e.addresses.find(ae=>ae.title==="Permanent"):null,Re=Array.isArray(e.bank_accounts)&&e.bank_accounts.length>0?e.bank_accounts[0]:null;i({...e,dob:e.dob?e.dob.split("T")[0]:"",is_user:!!e.is_user,is_customer:!!e.is_customer,is_supplier:!!e.is_supplier,is_employee:!!e.is_employee,is_dealer:!!e.is_dealer,is_distributor:!!e.is_distributor,active:typeof e.active=="boolean"?e.active:!0,username:e.username||e.user_name||"",usercode:e.usercode||"",password:e.plain_password||e.plainPassword||e.password||"",confirmPassword:e.plain_password||e.plainPassword||e.password||"",distributor_id:e.distributor_id||null,dealer_id:e.dealer_id||null,business_name:e.business_name||"",companyname:e.company_name||"",industry_segment:e.industry_segment||"",designation:e.designation||"",title:e.title||"",address1:(ze==null?void 0:ze.address1)||e.permanent_address1||"",address2:(ze==null?void 0:ze.address2)||e.permanent_address2||"",address3:(ze==null?void 0:ze.address3)||e.permanent_address3||"",city:(ze==null?void 0:ze.city)||e.permanent_city||"",state:(ze==null?void 0:ze.state)||e.permanent_state||"",pincode:(ze==null?void 0:ze.pincode)||e.permanent_pincode||"",permanent_country:Se((ze==null?void 0:ze.country)||e.permanent_country),permanent_country_code:Ne((ze==null?void 0:ze.country_code)||(ze==null?void 0:ze.country)||e.permanent_country_code),permanent_gstin:(ze==null?void 0:ze.gstin)||(ze==null?void 0:ze.gstin_number)||e.permanent_gstin||"",country:Se(e.country||e.permanent_country||(ze==null?void 0:ze.country)),country_code:Ne(e.country_code||e.country||e.permanent_country_code||(ze==null?void 0:ze.country_code)||(ze==null?void 0:ze.country)),aadhar_number:be(["aadhaar","aadhar","aadhaar card","aadhar card"],["aadhar_number","aadhaar"],["aadhar_number","doc_number"]),pan_number:be(["pan","pan card","permanent account number"],["pan_number","pan"],["pan_number","doc_number"]),gstin_number:be(["gstin","gst","goods and services tax"],["gstin_number","gstin"],["gstin_number","doc_number"]),msme_no:be(["msme","micro small medium enterprise"],["msme_no","msmeno"],["msme_no","doc_number"]),bank_name:(Re==null?void 0:Re.bank_name)||"",branch_name:(Re==null?void 0:Re.branch_name)||"",branch_address:(Re==null?void 0:Re.branch_address)||"",account_number:(Re==null?void 0:Re.account_number)||"",ifsc_code:(Re==null?void 0:Re.ifsc_code)||""}),m(Array.isArray(e.addresses)?e.addresses.filter(ae=>ae.title!=="Permanent").map(ae=>({id:ae.id,address_type:ae.title||"",address1:ae.address1||"",address2:ae.address2||"",address3:ae.address3||"",city:ae.city||"",state:ae.state||"",country:Se(ae.country),country_code:Ne(ae.country_code||ae.country),pincode:ae.pincode||"",gstin:ae.gstin||ae.gstin_number||"",keyValues:ae.keyValues||ae.key_values||ae.key_value||[]})):[]),y(Array.isArray(e.bank_accounts)&&e.bank_accounts.length>1?e.bank_accounts.slice(1).map(ae=>({id:ae.id,bank_name:ae.bank_name||"",branch_name:ae.branch_name||"",branch_address:ae.branch_address||"",account_number:ae.account_number||"",ifsc_code:ae.ifsc_code||"",keyValues:ae.keyValues||ae.key_values||ae.key_value||[]})):[]),O(Array.isArray(e.documents)?e.documents.map(ae=>{const we=ae.file_url?ae.file_url.split(".").pop().toLowerCase():"";let Fe="";["jpg","jpeg","png","gif","webp"].includes(we)?Fe="image/"+(we==="jpg"?"jpeg":we):we==="pdf"&&(Fe="application/pdf");const Ye=ae.file_url?(()=>{try{const me=String(Je||"").replace(/\/$/,""),Be=String(ae.file_url).replace(/^\.\//,"").replace(/^\/+/,"");return`${me}/${Be}`}catch{return ae.file_url}})():"";return{id:ae.id,document_type:ae.doc_type||"",document_number:ae.doc_number||"",file_url:ae.file_url||"",preview:Ye,type:Fe,name:ae.doc_type||"Document"}}):[]);const Ie=[];e.is_user&&Ie.push("is_user"),e.is_customer&&Ie.push("is_customer"),e.is_supplier&&Ie.push("is_supplier"),e.is_employee&&Ie.push("is_employee"),e.is_dealer&&Ie.push("is_dealer"),e.is_distributor&&Ie.push("is_distributor"),d("account_types",Ie.length?Ie[0]:""),e.distributor_id?(d("under_type","distributor"),d("distributor_id",e.distributor_id)):e.dealer_id?(d("under_type","dealer"),d("dealer_id",e.dealer_id)):e.supplier_id?(d("under_type","supplier"),d("supplier_id",e.supplier_id)):d("under_type",""),e.distributor_id&&d("distributor_id",e.distributor_id),e.dealer_id&&d("dealer_id",e.dealer_id)}},[e,i,d]);const De=async(de,be,Se=null)=>{try{const Ne=await ut.get(`${Je}/api/users`),ze=Array.isArray(Ne.data)?Ne.data:Ne.data.data||[],Re=Se?ze.filter(we=>we.id!==Se):ze;return Re.some(we=>we.email&&we.email.toLowerCase()===de.toLowerCase())?{isValid:!1,field:"email",message:"A user with this email already exists. Please use a different email address."}:Re.some(we=>we.mobile_number===be)?{isValid:!1,field:"mobile_number",message:"A user with this mobile number already exists. Please use a different mobile number."}:{isValid:!0}}catch(Ne){return console.error("Error validating unique fields:",Ne),{isValid:!0}}},He=async de=>await Xe(de,!1),Xe=async(de,be=!1)=>{var Se;try{if(!(e!=null&&e.id)){const ae=await De(de.email,de.mobile_number);if(!ae.isValid)return alert(ae.message),!1}let Ne=null;if(de.dob)try{const ae=new Date(de.dob);isNaN(ae.getTime())||(Ne=ae.toISOString().split("T")[0])}catch(ae){console.error("Error formatting DOB:",ae)}const ze={empcode:de.usercode||void 0,username:de.username||void 0,salutation:de.salutation||void 0,firstname:de.firstname||"",lastname:de.lastname||"",dob:Ne,gender:de.gender||"",country:de.country||void 0,country_code:de.country_code||"",mobile_number:de.mobile_number||"",email:de.email||"",aadhar_number:de.aadhar_number||void 0,pan_number:de.pan_number||void 0,password:de.password||void 0,permanent_address1:de.address1||void 0,permanent_address2:de.address2||void 0,permanent_address3:de.address3||void 0,permanent_city:de.city||void 0,permanent_state:de.state||void 0,permanent_country:de.permanent_country||void 0,permanent_pincode:de.pincode||void 0,permanent_gstin:de.permanent_gstin||void 0,primary_bank_name:de.bank_name||void 0,primary_branch_name:de.branch_name||void 0,primary_branch_address:de.branch_address||void 0,primary_account_number:de.account_number||void 0,primary_ifsc_code:de.ifsc_code||void 0,active:de.active===void 0?void 0:de.active,is_active:de.active===void 0?void 0:de.active,status:typeof de.active=="boolean"?de.active?"active":"inactive":void 0},Re=[{field:"salutation",label:"Salutation"},{field:"firstname",label:"First name"},{field:"gender",label:"Gender"},{field:"country",label:"Country"},{field:"mobile_number",label:"Mobile number"},{field:"email",label:"Email"},{field:"username",label:"User Name"},{field:"usercode",label:"Employee Code"}];e!=null&&e.id||(Re.push({field:"password",label:"Password"}),Re.push({field:"confirmPassword",label:"Confirm Password"}));for(const{field:ae,label:we}of Re){if(ae==="country"){if(!(de.country||de.country_code))return be||alert("Country is required."),!1;continue}if(!de[ae])return be||alert(`${we} is required.`),!1}if(L&&L.length>0&&L.filter(we=>!String(we.document_type||"").trim()).length>0)return be||alert("Please select a Document Type for all documents before saving."),!1;if(!(e!=null&&e.id)&&de.password!==de.confirmPassword)return be||alert("Passwords do not match."),!1;let Ie;if(e!=null&&e.id?(console.log("Updating employee with payload:",ze),Ie=(await ut.put(`${Je}/api/employees/${e.id}`,ze)).data):(console.log("Creating new employee with payload:",ze),Ie=(await ut.post(`${Je}/api/employees`,ze)).data),g&&g.length>0)try{for(const ae of g){const we={user_id:Ie.id,title:ae.address_type||"",address1:ae.address1||"",address2:ae.address2||"",address3:ae.address3||"",city:ae.city||"",state:ae.state||"",country:ae.country||"",country_code:ae.country_code||"",pincode:ae.pincode||"",gstin:ae.gstin||ae.gstin_number||ae.gst||ae.gst_number||void 0,keyValues:ae.keyValues||[]};ae.id?await ut.put(`${Je}/api/user-address/${ae.id}`,we):await ut.post(`${Je}/api/user-address`,we)}}catch(ae){console.error("Failed to save additional addresses:",ae)}if(b&&b.length>0)try{for(const ae of b){const we={user_id:Ie.id,bank_name:ae.bank_name||"",branch_name:ae.branch_name||"",branch_address:ae.branch_address||"",account_number:ae.account_number||"",ifsc_code:ae.ifsc_code||"",keyValues:ae.keyValues||[]};ae.id?await ut.put(`${Je}/api/user-bank/${ae.id}`,we):await ut.post(`${Je}/api/user-bank`,we)}}catch(ae){console.error("Failed to save additional bank accounts:",ae)}if(L&&L.length>0)try{for(const ae of L){const we=new FormData;we.append("user_id",Ie.id),we.append("doc_type",ae.document_type||ae.name||""),we.append("doc_number",ae.document_number||ae.documentNumber||""),ae.file&&we.append("file",ae.file);const Fe=ae.id&&typeof ae.id=="number"&&ae.id<1e12&&(e==null?void 0:e.id);try{if(Fe)await ut.put(`${Je}/api/document/${ae.id}`,we,{headers:{"Content-Type":"multipart/form-data"}});else{if(!ae.file){console.warn("Skipping creating document without file:",ae);continue}if(!ae.document_type&&!ae.name){console.warn("Skipping document upload - missing document_type:",ae);continue}await ut.post(`${Je}/api/document`,we,{headers:{"Content-Type":"multipart/form-data"}})}}catch(Ye){console.error("Failed to save document:",ae.document_type||ae.name,((Se=Ye.response)==null?void 0:Se.data)||Ye.message)}}}catch(ae){console.error("Failed to save user documents:",ae)}return be||(vt(Ie),Cr(Ie.usercode||Ie.username||""),Ur(!0)),r&&r(Ie),!0}catch(Ne){if(console.error("Error submitting user form:",Ne),Ne!=null&&Ne.response){console.error("Server responded with:",Ne.response.status,Ne.response.data);const ze=Ne.response.data,Re=Ne.response.status;if(Re===409){const Ie=(ze==null?void 0:ze.message)||(ze==null?void 0:ze.error)||"This information already exists",ae=ze==null?void 0:ze.field;alert(ae==="email"?"A user with this email already exists. Please use a different email address.":ae==="mobile_number"?"A user with this mobile number already exists. Please use a different mobile number.":ae==="usercode"?"A user with this usercode already exists. Please use a different usercode.":Ie)}else if(Re===400){const Ie=(ze==null?void 0:ze.message)||(ze==null?void 0:ze.error)||"Invalid request. Please check your input.";ze==null||ze.field;const ae=ze==null?void 0:ze.details;let we=Ie;ae&&(we+=`
Details: ${ae}`),alert(we)}else if(Re===500){const Ie=String((ze==null?void 0:ze.error)||(ze==null?void 0:ze.message)||"").toLowerCase();if(Ie.includes("duplicate key")||Ie.includes("unique constraint"))Ie.includes("email")?alert("A user with this email already exists. Please use a different email address."):Ie.includes("mobile_number")?alert("A user with this mobile number already exists. Please use a different mobile number."):Ie.includes("usercode")?alert("A user with this usercode already exists. Please use a different usercode."):alert("This information already exists for another user. Please check and try again with different values.");else{const ae=(ze==null?void 0:ze.details)||(ze==null?void 0:ze.error)||(ze==null?void 0:ze.message)||JSON.stringify(ze);alert(`Server error: ${ae}`)}}else{const Ie=(ze==null?void 0:ze.message)||(ze==null?void 0:ze.error)||`Server error (${Re})`;alert(Ie)}}else Ne!=null&&Ne.request?(console.error("No response received, request was:",Ne.request),alert("No response received from server. Please check if the backend is running.")):alert(`Error: ${Ne.message||"Something went wrong. Please try again."}`);return!1}},at=de=>{const Se=Array.from(de.target.files).map((Ne,ze)=>({id:Date.now()+ze,file:Ne,preview:URL.createObjectURL(Ne),name:Ne.name,type:Ne.type,documentNumber:"",document_type:"",document_number:""}));O(Ne=>[...Ne,...Se])},dt=de=>{const be=L.find(Ne=>Ne.id===de);if(!be)return;be.id&&typeof be.id=="number"&&be.id<1e12?ut.delete(`${Je}/api/document/${be.id}`).then(()=>{O(Ne=>Ne.filter(ze=>ze.id!==de))}).catch(Ne=>{var ze;console.error("Failed to delete document on server:",((ze=Ne==null?void 0:Ne.response)==null?void 0:ze.data)||Ne.message),O(Re=>Re.filter(Ie=>Ie.id!==de))}):(be.preview&&URL.revokeObjectURL(be.preview),O(Ne=>Ne.filter(ze=>ze.id!==de)))},wt=de=>{if(!(de.type&&de.type.startsWith("image/"))){alert("Edit is only available for image documents");return}const Se={...de,preview:de.preview||$t(de)};D(Se),Me({x:0,y:0}),Ze(1),z(!0)},$t=de=>{if(!de)return null;if(de.preview)return de.preview;if(de.file_url)try{const be=String(Je||"").replace(/\/$/,""),Se=String(de.file_url).replace(/^\.\//,"").replace(/^\/+/,"");return`${be}/${Se}`}catch{return de.file_url}return null},Bt=de=>{const be=$t(de);if(!be){alert("No file available to view");return}window.open(be,"_blank","noopener,noreferrer")},ft=async de=>{try{if(de.file instanceof File){const ae=URL.createObjectURL(de.file),we=document.createElement("a");we.href=ae,we.download=de.name||de.file.name||"document",document.body.appendChild(we),we.click(),we.remove(),URL.revokeObjectURL(ae);return}const be=$t(de);if(!be){alert("No file available to download");return}const Se=await fetch(be,{credentials:"include"});if(!Se.ok)throw new Error("Failed to fetch file");const Ne=await Se.blob(),ze=URL.createObjectURL(Ne),Re=document.createElement("a");Re.href=ze;const Ie=de.name||de.document_type||be.split("/").pop()||"document";Re.download=Ie,document.body.appendChild(Re),Re.click(),Re.remove(),URL.revokeObjectURL(ze)}catch(be){console.error("Download failed",be),alert("Failed to download file")}},[tr,Me]=vr.useState({x:0,y:0}),[tt,Ze]=vr.useState(1),[St,et]=vr.useState(null),Ht=vr.useCallback((de,be)=>{et(be)},[]),Nt=de=>new Promise((be,Se)=>{const Ne=new Image;Ne.addEventListener("load",()=>be(Ne)),Ne.addEventListener("error",ze=>Se(ze)),Ne.src=de}),kt=async(de,be)=>{const Se=await Nt(de),Ne=document.createElement("canvas"),ze=Ne.getContext("2d");return Ne.width=be.width,Ne.height=be.height,ze.drawImage(Se,be.x,be.y,be.width,be.height,0,0,be.width,be.height),new Promise(Re=>{Ne.toBlob(Ie=>{Re(Ie)},"image/jpeg")})},kr=async()=>{var de,be;if(q){if(!(q.document_type||q.name)||String(q.document_type||q.name).trim()===""){alert("Please select a document type.");return}try{let Se={...q};if((be=(de=q==null?void 0:q.type)==null?void 0:de.startsWith)!=null&&be.call(de,"image/")){const Ne=await kt(q.preview,St),ze=URL.createObjectURL(Ne),Re=new File([Ne],q.name,{type:q.type});Se={...Se,file:Re,preview:ze},q.preview&&URL.revokeObjectURL(q.preview)}Se={...Se,document_type:Se.name||Se.document_type||"",document_number:Se.documentNumber||Se.document_number||""},Se.documentNumber===void 0&&(Se.documentNumber=Se.document_number||""),O(Ne=>Ne.map(ze=>ze.id===q.id?Se:ze)),z(!1),D(null),Me({x:0,y:0}),Ze(1)}catch(Se){console.error("Error saving document changes:",Se)}}},Jt=Dv({control:o,name:"account_types",defaultValue:""});G.useEffect(()=>{typeof Jt=="string"&&Foe.forEach(de=>{d(de.value,Jt===de.value,{shouldDirty:!0,shouldTouch:!0})})},[Jt,d]);const[Pt,Ur]=vr.useState(!1),[Lr,vt]=vr.useState(null),[nr,Cr]=vr.useState(""),Dt=()=>{Ur(!1),vt(null),Cr("")},je=async()=>{if(!Lr){Dt(),t("/employeemanagement");return}try{if(nr&&Lr.usercode!==nr){const de={...Lr,usercode:nr};await ut.put(`${Je}/api/users/${Lr.id}`,de)}}catch(de){console.error("Failed to update usercode:",de)}Dt(),t("/employeemanagement")},[ct,nt]=vr.useState(0),Pe=()=>{let de=[];ct===0?(()=>{const Ne={active:!0,salutation:"",firstname:"",lastname:"",dob:"",gender:"",country:"",country_code:"",mobile_number:"",email:"",username:"",password:"",confirmPassword:"",usercode:""};Object.entries(Ne).forEach(([ze,Re])=>d(ze,Re,{shouldDirty:!0})),de=Object.keys(Ne)})():ct===1&&(()=>{const Ne={active:!0,address1:"",address2:"",address3:"",city:"",state:"",permanent_country:"",permanent_country_code:"",pincode:"",bank_name:"",branch_name:"",branch_address:"",account_number:"",ifsc_code:""};Object.entries(Ne).forEach(([ze,Re])=>d(ze,Re,{shouldDirty:!0})),Array.isArray(L)&&L.length&&L.forEach(ze=>{if(ze&&ze.preview)try{URL.revokeObjectURL(ze.preview)}catch{}}),O([]),de=Object.keys(Ne)})();try{de&&de.length?h(de):console.debug("No specific fields to clear errors for; skipping clearErrors()")}catch(Ne){console.debug("clearErrors not available or failed",Ne)}},Qe=async()=>{const de=xe[ct]||[];de.length&&!await l(de)||nt(be=>Math.min(be+1,1))},gt=()=>{nt(de=>Math.max(de-1,0))},xe={0:["salutation","firstname","gender","mobile_number","email","country","username","password","confirmPassword","usercode"],1:[]};return a.jsxs(a.Fragment,{children:[a.jsxs("form",{ref:v,onSubmitCapture:de=>{de.preventDefault(),s(He)()},onKeyDown:de=>{de.key==="Enter"&&de.preventDefault()},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[a.jsx("h5",{style:{margin:0},children:e?"Edit Employee":"Add Employee"}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[a.jsxs("div",{className:"toggle-switch",children:[a.jsx("input",{type:"checkbox",checked:Z,onChange:de=>d("active",de.target.checked,{shouldDirty:!0,shouldTouch:!0}),id:"active-switch"}),a.jsx("label",{htmlFor:"active-switch",children:Z?"Active":"Inactive"})]}),a.jsx("button",{type:"button",className:"btn btn-outline",onClick:()=>t("/employeemanagement"),children:"View"})]})]}),a.jsxs("div",{className:"form-tabs",children:[a.jsx("button",{type:"button",className:`form-tab ${ct===0?"active":""}`,onClick:()=>nt(0),children:"Personal"}),a.jsx("button",{type:"button",className:`form-tab ${ct===1?"active":""}`,onClick:()=>nt(1),children:"Addresses / Bank / Docs"})]}),a.jsx(oj,{value:ct,index:0,children:a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:[a.jsx("div",{style:{gridColumn:"1 / -1"},children:a.jsx("h6",{style:{marginTop:0},children:"Personal Information"})}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"salutation",className:"required",children:"Salutation"}),a.jsx("div",{className:"form-select-wrapper",children:a.jsx(En,{name:"salutation",control:o,rules:{required:"Salutation is required"},render:({field:de})=>a.jsxs("select",{...de,id:"salutation",className:p.salutation?"error":"",children:[a.jsx("option",{value:"",children:"Select Salutation"}),Ioe.map(be=>a.jsx("option",{value:be,children:be},be))]})})}),p.salutation&&a.jsx("div",{className:"error-message",children:p.salutation.message})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"firstname",className:"required",children:"First Name"}),a.jsx("input",{id:"firstname",type:"text",...n("firstname",{required:"First name is required"}),className:p.firstname?"error":""}),p.firstname&&a.jsx("div",{className:"error-message",children:p.firstname.message})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"lastname",children:"Last Name"}),a.jsx("input",{id:"lastname",type:"text",...n("lastname"),className:p.lastname?"error":""}),p.lastname&&a.jsx("div",{className:"error-message",children:p.lastname.message})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"dob",children:"Date of Birth"}),a.jsx("input",{id:"dob",type:"date",...n("dob"),className:p.dob?"error":""}),p.dob&&a.jsx("div",{className:"error-message",children:p.dob.message})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"gender",className:"required",children:"Gender"}),a.jsx("div",{className:"form-select-wrapper",children:a.jsx(En,{name:"gender",control:o,rules:{required:"Gender is required"},render:({field:de})=>a.jsxs("select",{...de,id:"gender",className:p.gender?"error":"",children:[a.jsx("option",{value:"",children:"Select Gender"}),a.jsx("option",{value:"Male",children:"Male"}),a.jsx("option",{value:"Female",children:"Female"}),a.jsx("option",{value:"Other",children:"Other"})]})})}),p.gender&&a.jsx("div",{className:"error-message",children:p.gender.message})]}),a.jsx("div",{style:{gridColumn:"1 / -1"},children:a.jsx("h6",{children:"Contact Information"})}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"country",className:"required",children:"Country"}),a.jsx(En,{name:"country",control:o,rules:{required:"Country is required"},render:({field:de})=>a.jsx("div",{className:"form-select-wrapper",children:a.jsxs("select",{id:"country",...de,value:de.value||"",onChange:be=>{const Se=be.target.value;de.onChange(Se);const Ne=Hs.find(ze=>ze.name===Se);d("country_code",(Ne==null?void 0:Ne.code)||"")},className:p.country?"error":"",children:[a.jsx("option",{value:"",children:"Select Country"}),Hs.map((be,Se)=>a.jsxs("option",{value:be.name,children:[be.name," (",be.code,")"]},`${be.name}-${Se}`))]})})}),p.country&&a.jsx("div",{className:"error-message",children:p.country.message})]}),a.jsx(En,{name:"country_code",control:o,render:({field:de})=>a.jsx("input",{type:"hidden",...de})}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"mobile_number",className:"required",children:"Mobile Number"}),a.jsx("input",{id:"mobile_number",type:"tel",...n("mobile_number",{required:"Mobile number is required",pattern:{value:/^\d{10}$/,message:"Mobile number must be 10 digits"}}),placeholder:"10 digit number",className:p.mobile_number?"error":""}),p.mobile_number&&a.jsx("div",{className:"error-message",children:p.mobile_number.message})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"email",className:"required",children:"Email"}),a.jsx("input",{id:"email",type:"email",...n("email",{required:"Email is required",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Invalid email format"}}),className:p.email?"error":""}),p.email&&a.jsx("div",{className:"error-message",children:p.email.message})]}),a.jsx("div",{style:{gridColumn:"1 / -1"},children:a.jsx("h6",{children:"Legal Information"})}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"aadhar_number",children:"Aadhaar Number"}),a.jsx("input",{id:"aadhar_number",type:"text",...n("aadhar_number"),className:p.aadhar_number?"error":""}),p.aadhar_number&&a.jsx("div",{className:"error-message",children:p.aadhar_number.message})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"pan_number",children:"PAN Number"}),a.jsx("input",{id:"pan_number",type:"text",...n("pan_number"),className:p.pan_number?"error":""}),p.pan_number&&a.jsx("div",{className:"error-message",children:p.pan_number.message})]}),a.jsx("div",{style:{gridColumn:"1 / -1"},children:a.jsx("h6",{children:"Authentication"})}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"username",className:"required",children:"User Name"}),a.jsx(En,{name:"username",control:o,rules:{required:"Username is required"},render:({field:de})=>a.jsx("input",{id:"username",type:"text",...de,className:p.username?"error":""})}),p.username&&a.jsx("div",{className:"error-message",children:p.username.message})]}),a.jsxs("div",{className:"form-field password-input-container",children:[a.jsx("label",{htmlFor:"password",className:e!=null&&e.id?"":"required",children:e!=null&&e.id?"Password":"Password *"}),a.jsx(En,{name:"password",control:o,rules:(()=>{const de={pattern:{value:/^(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]).{8,}$/,message:"Password must be at least 8 characters, include an uppercase letter, a number, and a special character."}};return e!=null&&e.id?de:{required:"Password is required",...de}})(),render:({field:de})=>a.jsxs("div",{style:{position:"relative"},children:[a.jsx("input",{id:"password",type:I?"text":"password",...de,className:p.password?"error":""}),a.jsx("button",{type:"button",className:"password-toggle-btn",onClick:R,onMouseDown:A,children:I?"":""})]})}),p.password&&a.jsx("div",{className:"error-message",children:p.password.message})]}),a.jsxs("div",{className:"form-field password-input-container",children:[a.jsx("label",{htmlFor:"confirmPassword",className:e!=null&&e.id?"":"required",children:e!=null&&e.id?"Confirm Password":"Confirm Password *"}),a.jsx(En,{name:"confirmPassword",control:o,rules:{validate:de=>{const be=u("password");if(!(e!=null&&e.id))return de?de!==be?"Passwords do not match":!0:"Confirm password is required";if(be){if(!de)return"Confirm password is required when changing password";if(de!==be)return"Passwords do not match"}return!0}},render:({field:de})=>a.jsxs("div",{style:{position:"relative"},children:[a.jsx("input",{id:"confirmPassword",type:k?"text":"password",...de,className:p.confirmPassword?"error":""}),a.jsx("button",{type:"button",className:"password-toggle-btn",onClick:j,onMouseDown:A,children:k?"":""})]})}),p.confirmPassword&&a.jsx("div",{className:"error-message",children:p.confirmPassword.message})]}),(e==null?void 0:e.id)&&a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"primarykey",children:"Primary Key (ID)"}),a.jsx("input",{id:"primarykey",type:"text",value:(e==null?void 0:e.id)||"",readOnly:!0})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"usercode",className:"required",children:"Employee Code"}),a.jsx(En,{name:"usercode",control:o,rules:{required:"Employee code is required"},render:({field:de})=>a.jsx("input",{id:"usercode",type:"text",...de,className:p.usercode?"error":""})}),p.usercode&&a.jsx("div",{className:"error-message",children:p.usercode.message})]})]})}),a.jsx(oj,{value:ct,index:1,children:a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:[a.jsx("div",{style:{gridColumn:"1 / -1"},children:a.jsx("h6",{style:{marginTop:0},children:"Employee Address"})}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"address1",children:"Address 1"}),a.jsx("input",{id:"address1",type:"text",...n("address1")})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"address2",children:"Address 2"}),a.jsx("input",{id:"address2",type:"text",...n("address2")})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"address3",children:"Address 3"}),a.jsx("input",{id:"address3",type:"text",...n("address3")})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"city",children:"City"}),String(J||"").toLowerCase()==="india"?a.jsx("div",{className:"form-select-wrapper",children:a.jsx(En,{name:"city",control:o,render:({field:de})=>a.jsxs("select",{...de,id:"city",className:p.city?"error":"",children:[a.jsx("option",{value:"",children:"Select City"}),Kc.map(be=>a.jsx("option",{value:be,children:be},be))]})})}):a.jsx("input",{id:"city",type:"text",...n("city")}),p.city&&a.jsx("div",{className:"error-message",children:p.city.message})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"state",children:"State"}),String(J||"").toLowerCase()==="india"?a.jsx("div",{className:"form-select-wrapper",children:a.jsx(En,{name:"state",control:o,render:({field:de})=>a.jsxs("select",{...de,id:"state",className:p.state?"error":"",children:[a.jsx("option",{value:"",children:"Select State"}),Poe.map(be=>a.jsx("option",{value:be,children:be},be))]})})}):a.jsx("input",{id:"state",type:"text",...n("state")}),p.state&&a.jsx("div",{className:"error-message",children:p.state.message})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"permanent_country",children:"Country"}),a.jsx(En,{name:"permanent_country",control:o,render:({field:de})=>a.jsx("div",{className:"form-select-wrapper",children:a.jsxs("select",{id:"permanent_country",...de,value:de.value||"",onChange:be=>{const Se=be.target.value;de.onChange(Se);const Ne=Hs.find(ze=>ze.name===Se);d("permanent_country_code",(Ne==null?void 0:Ne.code)||"")},children:[a.jsx("option",{value:"",children:"Select Country"}),Hs.map((be,Se)=>a.jsxs("option",{value:be.name,children:[be.name," (",be.code,")"]},`${be.name}-perm-${Se}`))]})})}),a.jsx(En,{name:"permanent_country_code",control:o,render:({field:de})=>a.jsx("input",{type:"hidden",...de})})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"pincode",children:"Pincode"}),a.jsx("input",{id:"pincode",type:"text",...n("pincode")})]}),a.jsx("div",{style:{gridColumn:"1 / -1"},children:a.jsx("h6",{children:"Bank Information"})}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"bank_name",children:"Bank Name"}),a.jsx("input",{id:"bank_name",type:"text",...n("bank_name")})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"branch_name",children:"Branch Name"}),a.jsx("input",{id:"branch_name",type:"text",...n("branch_name")})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"branch_address",children:"Branch Address"}),a.jsx("input",{id:"branch_address",type:"text",...n("branch_address")})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"account_number",children:"Account Number"}),a.jsx("input",{id:"account_number",type:"text",...n("account_number")})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"ifsc_code",children:"IFSC Code"}),a.jsx("input",{id:"ifsc_code",type:"text",...n("ifsc_code")})]}),a.jsx("div",{style:{gridColumn:"1 / -1"},children:a.jsx("h6",{children:"Documents"})}),a.jsxs("div",{style:{gridColumn:"1 / -1"},children:[a.jsx("label",{htmlFor:"doc-upload",className:"btn btn-primary",style:{display:"inline-block",marginBottom:"16px"},children:" Upload Documents"}),a.jsx("input",{id:"doc-upload",type:"file",multiple:!0,hidden:!0,accept:"image/*,.pdf,.doc,.docx",onChange:at}),a.jsx("div",{className:"document-grid",children:L.map(de=>{var Ne,ze;const be=((ze=(Ne=de.type)==null?void 0:Ne.startsWith)==null?void 0:ze.call(Ne,"image/"))||de.file_url&&/\.(jpg|jpeg|png|gif|webp)$/i.test(de.file_url)||de.name&&/\.(jpg|jpeg|png|gif|webp)$/i.test(de.name),Se=de.preview||(de.file_url?de.file_url.startsWith("http")?de.file_url:Je+de.file_url:"");return a.jsxs("div",{className:"document-card",children:[a.jsx("div",{className:"document-preview",children:be&&Se?a.jsx("img",{src:Se,alt:de.name||de.document_type||"Document",onError:Re=>{Re.target.style.display="none"}}):a.jsx("div",{className:"file-type",children:de.name?de.name.split(".").pop().toUpperCase():de.document_type||"DOC"})}),a.jsxs("div",{className:"document-info",children:[a.jsxs("select",{value:de.document_type||de.name||"",onChange:Re=>{const Ie=Re.target.value;O(ae=>ae.map(we=>we.id===de.id?{...we,document_type:Ie||"",name:Ie||we.name}:we))},style:{marginBottom:"8px"},required:!0,children:[a.jsx("option",{value:"",children:"Select Document Type"}),Ooe.map(Re=>a.jsx("option",{value:Re,children:Re},Re))]}),a.jsx("input",{type:"text",placeholder:"Document Number",value:de.document_number||de.documentNumber||"",onChange:Re=>{const Ie=Re.target.value;O(ae=>ae.map(we=>we.id===de.id?{...we,document_number:Ie,documentNumber:Ie}:we))}})]}),a.jsxs("div",{className:"document-actions",children:[a.jsx("button",{type:"button",onClick:()=>Bt(de),title:"View",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M1 12C1 12 5 4 12 4C19 4 23 12 23 12C23 12 19 20 12 20C5 20 1 12 1 12Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("circle",{cx:"12",cy:"12",r:"3",stroke:"currentColor",strokeWidth:"2"})]})}),a.jsx("button",{type:"button",onClick:()=>ft(de),title:"Download",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("polyline",{points:"7,10 12,15 17,10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),a.jsx("button",{type:"button",onClick:()=>wt(de),title:"Edit/Crop",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M11 4H4C3.46957 4 2.96086 4.21071 2.58579 4.58579C2.21071 4.96086 2 5.46957 2 6V20C2 20.5304 2.21071 20.9609 2.58579 21.3359C2.96086 21.711 3.46957 21.9217 4 21.9217H18C18.5304 21.9217 19.0391 21.711 19.4142 21.3359C19.7893 20.9609 20 20.5304 20 20V13",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M18.5 2.5C18.8978 2.10217 19.4374 1.87868 20 1.87868C20.5626 1.87868 21.1022 2.10217 21.5 2.5C21.8978 2.89782 22.1213 3.43739 22.1213 4C22.1213 4.56261 21.8978 5.10218 21.5 5.5L12 15L8 16L9 12L18.5 2.5Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),a.jsx("button",{type:"button",onClick:()=>dt(de.id),title:"Delete",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M3 6H5H21",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M19 6V20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 22 17 22H7C6.46957 22 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20V6M8 6V4C8 3.46957 8.21071 2.96086 8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M10 11V17",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M14 11V17",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})})]})]},de.id)})})]})]})}),a.jsx("div",{style:{marginTop:"16px"},children:a.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[a.jsx("div",{children:a.jsx("button",{type:"button",className:"btn btn-outline",onClick:Pe,children:"Reset"})}),a.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:"8px"},children:[a.jsx("button",{type:"button",className:"btn btn-primary",onClick:de=>{de.preventDefault(),gt()},disabled:ct===0,children:"Back"}),ct===1?a.jsx("button",{type:"submit",className:"btn btn-primary",children:"Submit"}):a.jsx("button",{type:"button",className:"btn btn-primary",onClick:de=>{de.preventDefault(),Qe()},disabled:ct===1,children:"Next"})]})]})})]}),Pt&&Lr&&a.jsx("div",{className:"dialog-overlay open",onClick:Dt,children:a.jsxs("div",{className:"dialog-content sm",onClick:de=>de.stopPropagation(),children:[a.jsx("div",{className:"dialog-header",children:e?"Employee Updated":"Employee Created"}),a.jsxs("div",{className:"dialog-body",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"dialog-id",children:"Primary Key (ID)"}),a.jsx("input",{id:"dialog-id",type:"text",value:(Lr==null?void 0:Lr.id)??"",readOnly:!0})]}),a.jsxs("div",{className:"form-field",style:{marginTop:"16px"},children:[a.jsx("label",{htmlFor:"dialog-usercode",children:"Employee Code"}),a.jsx("input",{id:"dialog-usercode",type:"text",value:nr,onChange:de=>Cr(de.target.value)}),a.jsx("p",{className:"helper-text",children:"Edit employee code if you want to change it. Ex : EMP - 0001"})]})]}),a.jsxs("div",{className:"dialog-footer",children:[a.jsx("button",{type:"button",className:"btn btn-outline",onClick:Dt,children:"Cancel"}),a.jsx("button",{type:"button",className:"btn btn-primary",onClick:je,children:"Confirm"})]})]})}),H&&q&&a.jsx("div",{className:"dialog-overlay open",onClick:()=>{z(!1),D(null)},children:a.jsxs("div",{className:"dialog-content lg",onClick:de=>de.stopPropagation(),children:[a.jsx("div",{className:"dialog-header",children:"Edit Document"}),a.jsxs("div",{className:"dialog-body",children:[a.jsx("h6",{style:{marginTop:0},children:"Preview / Crop"}),q&&a.jsx(a.Fragment,{children:(Ce=(Oe=q==null?void 0:q.type)==null?void 0:Oe.startsWith)!=null&&Ce.call(Oe,"image/")||q!=null&&q.file_url?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"cropper-wrapper",children:a.jsx(Lw,{image:q.preview||$t(q),crop:tr,zoom:tt,aspect:4/3,onCropChange:Me,onZoomChange:Ze,onCropComplete:Ht})}),a.jsxs("div",{className:"slider-wrapper",children:[a.jsx("label",{children:"Zoom"}),a.jsx("input",{type:"range",min:"1",max:"3",step:"0.1",value:tt,onChange:de=>Ze(Number(de.target.value))})]})]}):a.jsx("div",{style:{padding:"16px",backgroundColor:"#f5f5f5",textAlign:"center",borderRadius:"4px"},children:a.jsx("p",{style:{color:"#999",margin:0},children:"This document type cannot be cropped. View or download to see the full document."})})})]}),a.jsxs("div",{className:"dialog-footer",children:[a.jsx("button",{type:"button",className:"btn btn-outline",onClick:()=>{z(!1),D(null)},children:"Cancel"}),a.jsx("button",{type:"button",className:"btn btn-primary",onClick:kr,children:"Save"})]})]})})]})},lj=()=>{const{id:e}=Jv();ii();const[r,t]=G.useState(null),[n,s]=G.useState(!!e);G.useEffect(()=>{e&&ut.get(`${Je}/api/employees/${e}`).then(i=>{t(i.data),console.log(i.data)}).catch(i=>{console.error("Error fetching employee:",i)}).finally(()=>{s(!1)})},[e]);const o=async i=>{console.log("Employee form submitted, received:",i)};return n?a.jsx("section",{className:"right-content",children:a.jsxs(b2,{sx:{mt:5},children:[a.jsx(Et,{variant:"h6",children:"Loading employee..."}),a.jsx(Vs,{})]})}):a.jsx("section",{className:"right-content",children:a.jsx(sa,{sx:{p:2,mb:2},children:a.jsx(b2,{maxWidth:"xl",sx:{mt:5},children:a.jsx(Boe,{defaultValues:r,onSubmitUser:o})})})})};function zoe(){ii();const[e,r]=G.useState([]),[t,n]=G.useState({search:"",name:"",designation:"",employee_id:""}),[s,o]=G.useState(0),[i,c]=G.useState(10),[u,l]=G.useState(0),[d,h]=G.useState(!1),[f,p]=G.useState([]),[v,g]=G.useState([]),[m,b]=G.useState(null),[y,S]=G.useState(!1),[C,L]=G.useState(null),[O,H]=G.useState(!1),[z,q]=G.useState(""),[D,W]=G.useState("info");G.useEffect(()=>{P()},[s,i,t.search,t.name,t.designation,t.employee_id]),G.useEffect(()=>{const ne=Y=>{o(0),P(0);try{U()}catch{}try{I()}catch{}};return window.addEventListener("erp:departments-updated",ne),()=>window.removeEventListener("erp:departments-updated",ne)},[]);const P=async ne=>{h(!0);try{const K={page:(typeof ne=="number"?ne:s)+1,limit:i,search:t.search,name:t.name,designation:t.designation,employee_id:t.employee_id},ee=await ut.get(`${Je}/departments`,{params:K});r(ee.data.departments||ee.data),l(ee.data.total||ee.data.length)}catch(Y){console.error("Error fetching departments:",Y),J("Error fetching departments","error")}finally{h(!1)}},I=async()=>{const ne={page:1,limit:1e3},Y=[`${Je}/api/employees`,`${Je}/employees`];for(const K of Y)try{const ee=await ut.get(K,{params:ne}),ue=ee.data.employees||ee.data||[],se=Array.isArray(ue)?ue:[];p(se);return}catch{}console.error("Error fetching employees for dropdown: no endpoints succeeded")};G.useEffect(()=>{I()},[]);const U=async()=>{try{const ne={page:1,limit:1e3},Y=await ut.get(`${Je}/departments`,{params:ne}),K=Y.data.departments||Y.data||[],ee=Array.isArray(K)?K:[];g(ee)}catch(ne){console.warn("Failed to fetch all departments for head-exclusion:",ne),g([])}};G.useEffect(()=>{U()},[]);const k=ne=>{n(Y=>({...Y,search:ne.target.value})),o(0)},_=ne=>Y=>{var ee;const K=(ee=Y==null?void 0:Y.target)==null?void 0:ee.value;n(ue=>({...ue,[ne]:K})),o(0)},R=(ne,Y)=>{o(Y)},j=async()=>{var ce,fe;const ne=t.name?t.name.trim():"";if(!ne){J("Department name is required","warning");return}const Y=t.designation?t.designation.trim():"",K=ve=>(ve||"").trim().toLowerCase();if(((v&&v.length?v:e)||[]).find(ve=>K(ve.name)===ne.toLowerCase()&&K(ve.designation)===Y.toLowerCase()&&ve.id!==m)){J("Department with same designation already exists","warning");return}try{const ve={page:1,limit:1,name:ne,designation:Y},_e=await ut.get(`${Je}/departments`,{params:ve}),le=_e.data&&(_e.data.departments?_e.data.departments[0]:Array.isArray(_e.data)?_e.data[0]:null);if(le&&le.id!==m&&K(le.name)===ne.toLowerCase()&&K(le.designation)===Y.toLowerCase()){J("Department with same designation already exists","warning");return}}catch(ve){console.warn("Name+designation uniqueness check failed, proceeding to save:",ve)}const se={name:ne,designation:t.designation||null,head_id:t.employee_id||null};h(!0);try{if(m?(await ut.put(`${Je}/departments/${m}`,se),J("Department updated successfully","success"),b(null)):(await ut.post(`${Je}/departments`,se),J("Department created successfully","success")),se.head_id)try{await ut.put(`${Je}/api/users/${se.head_id}`,{designation:"Department Head"})}catch(ve){console.warn("Failed to update employee designation:",ve)}n(ve=>({...ve,name:"",designation:"",employee_id:""})),o(0),await P(0);try{await U()}catch{}try{await I()}catch{}try{window.dispatchEvent(new CustomEvent("erp:departments-updated",{detail:{source:"department",id:m||null}}))}catch{}}catch(ve){console.error("Error saving department:",ve);const _e=((fe=(ce=ve==null?void 0:ve.response)==null?void 0:ce.data)==null?void 0:fe.error)||"Error saving department";J(_e,"error")}finally{h(!1)}},A=()=>{b(null),n(ne=>({...ne,name:"",designation:"",employee_id:""}))},N=ne=>{c(parseInt(ne.target.value,10)),o(0)},V=ne=>{b(ne.id),n(Y=>({...Y,name:ne.name||"",designation:ne.designation||"",employee_id:ne.head&&ne.head.id||ne.head_id||""}))},M=ne=>{L(ne),S(!0)},Z=async()=>{if(C)try{await ut.delete(`${Je}/departments/${C.id}`),J("Department deleted successfully","success"),o(0),await P(0);try{await U()}catch{}try{await I()}catch{}try{window.dispatchEvent(new CustomEvent("erp:departments-updated",{detail:{source:"department",id:C.id}}))}catch{}}catch(ne){console.error("Error deleting department:",ne),J("Error deleting department","error")}finally{S(!1),L(null)}},J=(ne,Y)=>{q(ne),W(Y),H(!0)},re=()=>{H(!1)},X=f.filter(ne=>{if(!ne)return!1;const Y=ne.id!=null?String(ne.id):"",ee=(v||[]).reduce((ue,se)=>{var fe;const ce=((fe=se==null?void 0:se.head)==null?void 0:fe.id)??(se==null?void 0:se.head_id);return ce!=null&&(ue[String(ce)]=se.id),ue},{})[Y];return!(ee!=null&&(!m||String(m)!==String(ee)))});return a.jsx("section",{className:"right-content",children:a.jsxs(Ut,{sx:{p:1},children:[a.jsx(Et,{variant:"h5",gutterBottom:!0,children:"Department Management"}),a.jsxs(Ut,{sx:{mb:3},children:[a.jsx(Ut,{sx:{mb:2},children:a.jsx(ri,{placeholder:"Search",variant:"outlined",size:"small",value:t.search,onChange:k,InputProps:{endAdornment:a.jsx(Qf,{position:"end",children:a.jsx(Oz,{sx:{color:"#1976d2"}})})},sx:{minWidth:300,"& .MuiOutlinedInput-root":{borderRadius:"4px",height:40,backgroundColor:"#fff"},"& .MuiOutlinedInput-notchedOutline":{borderRadius:"4px"}}})}),a.jsxs(Ut,{sx:{display:"flex",gap:2,alignItems:"center",flexWrap:"wrap"},children:[a.jsx(ri,{label:"Department",variant:"outlined",size:"small",value:t.name,onChange:_("name"),sx:{minWidth:220,"& .MuiOutlinedInput-root":{height:45,borderRadius:1}}}),a.jsx(ri,{label:"Designation",variant:"outlined",size:"small",value:t.designation,onChange:_("designation"),sx:{minWidth:300,"& .MuiOutlinedInput-root":{height:45,borderRadius:1}}}),a.jsx(bc,{options:X,size:"small",getOptionLabel:ne=>`${ne.usercode?`${ne.usercode} - `:""}${`${ne.salutation||""} ${ne.firstname||""} ${ne.lastname||""}`.trim()}`,value:f.find(ne=>String(ne.id)===String(t.employee_id))||null,onChange:(ne,Y)=>{_("employee_id")({target:{value:Y?Y.id:""}})},renderInput:ne=>a.jsx(ri,{...ne,label:"Employee",size:"small",variant:"outlined",sx:{minWidth:260,"& .MuiOutlinedInput-root":{height:45,borderRadius:1}}}),isOptionEqualToValue:(ne,Y)=>String(ne==null?void 0:ne.id)===String(Y==null?void 0:Y.id),clearOnEscape:!0}),a.jsx(Br,{variant:"contained",color:"primary",onClick:j,sx:{height:36,ml:1},disabled:d,children:m?"Update":"Save"}),m&&a.jsx(Br,{variant:"outlined",color:"secondary",onClick:A,sx:{height:36,ml:1},children:"Cancel"})]})]}),a.jsx(Ws,{component:sa,children:a.jsxs(Cs,{children:[a.jsx(js,{children:a.jsxs(pn,{children:[a.jsx(qe,{children:"Sl No."}),a.jsx(qe,{children:"Emp. Code"}),a.jsx(qe,{children:"Dept. Head"}),a.jsx(qe,{children:"Department"}),a.jsx(qe,{children:"Designation"}),a.jsx(qe,{children:"Actions"})]})}),a.jsx(fs,{children:d?a.jsx(pn,{children:a.jsx(qe,{colSpan:6,align:"center",children:"Loading..."})}):e.length===0?a.jsx(pn,{children:a.jsx(qe,{colSpan:6,align:"center",children:"No departments found"})}):e.map((ne,Y)=>a.jsxs(pn,{children:[a.jsx(qe,{children:s*i+Y+1}),a.jsx(qe,{children:ne.head&&(ne.head.usercode||ne.head.user_code)||"-"}),a.jsx(qe,{children:ne.head?`${ne.head.salutation?ne.head.salutation+" ":""}${ne.head.firstname||""} ${ne.head.lastname||""}`.trim():"-"}),a.jsx(qe,{children:ne.name}),a.jsx(qe,{children:ne.designation||"-"}),a.jsxs(qe,{children:[a.jsx(sn,{onClick:()=>V(ne),children:a.jsx(bl,{})}),a.jsx(sn,{onClick:()=>M(ne),children:a.jsx(ql,{})})]})]},ne.id))})]})}),a.jsx(Zm,{component:"div",count:u,page:s,onPageChange:R,rowsPerPage:i,onRowsPerPageChange:N,rowsPerPageOptions:[5,10,25,50]}),a.jsxs(Oa,{open:y,onClose:()=>S(!1),children:[a.jsx(Wa,{children:"Confirm Delete"}),a.jsx(Pa,{children:"Are you sure you want to delete this department? This action cannot be undone."}),a.jsxs(Va,{children:[a.jsx(Br,{onClick:()=>S(!1),children:"Cancel"}),a.jsx(Br,{onClick:Z,color:"error",children:"Delete"})]})]}),a.jsx(tu,{open:O,autoHideDuration:6e3,onClose:re,anchorOrigin:{vertical:"bottom",horizontal:"left"},children:a.jsx(eu,{onClose:re,severity:D,children:z})})]})})}const $oe=({departments:e})=>{const[r,t]=G.useState([]),[n,s]=G.useState(null),[o,i]=G.useState(null),[c,u]=G.useState([]),[l,d]=G.useState([]),[h,f]=G.useState(!1),[p,v]=G.useState(!1),[g,m]=G.useState(!1),[b,y]=G.useState(!1),[S,C]=G.useState({open:!1,message:"",severity:"info"}),[L,O]=G.useState(null),[H,z]=G.useState(""),[q,D]=G.useState(0),[W,P]=G.useState(10),[I,U]=G.useState(!1),[k,_]=G.useState(!1);G.useEffect(()=>{if(Array.isArray(e)&&e.length){t(e);return}(async()=>{f(!0);try{const fe=await fetch(`${Je}/departments?limit=1000`);if(!fe.ok)throw new Error(`Failed to fetch departments: ${fe.status}`);const ve=await fe.json();t(Array.isArray(ve.departments)?ve.departments:ve)}catch(fe){console.error(fe)}finally{f(!1)}})()},[e]),G.useEffect(()=>{(async()=>{m(!0);try{const fe=[`${Je}/api/employees/non-heads`,`${Je}/api/employees/non-heads`,`${Je}/api/employees`,`${Je}/api/employees`,`${Je}/users`];for(const ve of fe)try{const _e=await fetch(`${ve}?limit=1000`);if(!_e.ok)continue;const le=await _e.json();let ke=[];if(Array.isArray(le)?ke=le:Array.isArray(le.data)?ke=le.data:Array.isArray(le.users)?ke=le.users:Array.isArray(le.employees)?ke=le.employees:ke=[],ke.length){d(ke);return}}catch{continue}d([])}catch(fe){console.error(fe),d([])}finally{m(!1)}})()},[]);const R=async ce=>{if(!ce){u([]);return}v(!0);try{const fe=await fetch(`${Je}/departments/${ce}/employees`);if(!fe.ok)throw new Error(`Failed to fetch employees: ${fe.status}`);const ve=await fe.json(),_e=r.find(pe=>String(pe.id)===String(ce))||n,le=Array.isArray(ve)?ve.map(pe=>{const ye=pe.employee||pe.Employee;return ye?{...ye,relationId:pe.ID||pe.id||pe.RelationID||pe.ID}:null}).filter(Boolean):[],ke=_e&&_e.head?String(_e.head.id):null,Te=le.filter(pe=>String(pe.id)!==String(ke));u(Te)}catch(fe){console.error(fe),u([])}finally{v(!1)}};G.useEffect(()=>{if(!(n!=null&&n.id)){u([]),i(null);return}R(n.id)},[n,r]),G.useEffect(()=>{const ce=fe=>{var _e;const ve=((_e=fe==null?void 0:fe.detail)==null?void 0:_e.deptId)||null;ve?(n&&String(n.id)===String(ve)&&R(ve),(async()=>{f(!0);try{const le=await fetch(`${Je}/departments?limit=1000`);if(le.ok){const ke=await le.json();t(Array.isArray(ke.departments)?ke.departments:ke)}}catch(le){console.error(le)}finally{f(!1)}})()):(R(n==null?void 0:n.id),(async()=>{f(!0);try{const le=await fetch(`${Je}/departments?limit=1000`);if(le.ok){const ke=await le.json();t(Array.isArray(ke.departments)?ke.departments:ke)}}catch(le){console.error(le)}finally{f(!1)}})())};return window.addEventListener("erp:departments-updated",ce),()=>window.removeEventListener("erp:departments-updated",ce)},[n,r]);const j=(ce,fe)=>{s(fe),u([]),i(null)},A=(ce,fe)=>{i(fe)},N=ce=>{z(ce.target.value||"")},V=(ce,fe)=>{D(fe)},M=ce=>{P(parseInt(ce.target.value,10)),D(0)},Z=async()=>{var fe;if(!n||!o){C({open:!0,message:"Please select both department and employee",severity:"warning"});return}if(c.some(ve=>String(ve.id)===String(o.id))){C({open:!0,message:"Employee is already assigned to this department",severity:"warning"});return}y(!0);try{if(L)try{await fetch(`${Je}/departments/employee/${L}`,{method:"DELETE"})}catch(ke){console.warn("Failed to delete old relation before update:",ke)}const ve={department_id:n.id,employee_id:o.id,assigned_by_id:((fe=n.head)==null?void 0:fe.id)||null},_e=await fetch(`${Je}/departments/assign`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ve)});if(!_e.ok){const ke=await _e.json().catch(()=>({}));throw new Error(ke.error||"Failed to assign employee")}C({open:!0,message:L?"Assignment updated successfully":"Employee assigned successfully",severity:"success"}),i(null),O(null);const le=await fetch(`${Je}/departments/${n.id}/employees`);if(le.ok){const ke=await le.json(),Te=r.find(De=>String(De.id)===String(n.id))||n,pe=Array.isArray(ke)?ke.map(De=>{const He=De.employee||De.Employee;return He?{...He,relationId:De.ID||De.id}:null}).filter(Boolean):[],ye=Te&&Te.head?String(Te.head.id):null,ge=pe.filter(De=>String(De.id)!==String(ye));u(ge);try{window.dispatchEvent(new CustomEvent("erp:departments-updated",{detail:{source:"designation",deptId:(n==null?void 0:n.id)||null}}))}catch{}}}catch(ve){console.error(ve),C({open:!0,message:ve.message||"Error assigning employee",severity:"error"})}finally{y(!1)}},J=n||r.find(ce=>String(ce.id)===String(n==null?void 0:n.id))||null,re=(()=>{if(n!=null&&n.id)return J?c.map(fe=>({type:"emp",emp:fe,dept:J})):[];const ce=[];return r.forEach(fe=>{if(!fe)return;const ve=fe.Employees||fe.employees||[];!Array.isArray(ve)||ve.length===0||ve.forEach(_e=>{const le=_e.employee||_e.Employee||_e.EmployeeID||null;let ke=null;le&&typeof le=="object"?ke={...le,relationId:_e.ID||_e.id||_e.RelationID||_e.relation_id}:_e.Employee&&typeof _e.Employee=="object"&&(ke={..._e.Employee,relationId:_e.ID||_e.id||_e.RelationID||_e.relation_id}),ke&&ce.push({type:"emp",emp:ke,dept:fe})})}),ce})(),X=(()=>{const ce=(H||"").trim().toLowerCase();return ce?re.filter(({emp:fe,dept:ve})=>{const _e=(ve&&(ve.department&&ve.department.name||ve.departmentName||ve.name)||"").toString().toLowerCase(),le=(ee(fe)||"").toString().toLowerCase(),ke=(Y(fe)||"").toString().toLowerCase();return _e.includes(ce)||le.includes(ce)||ke.includes(ce)}):re})(),ne=(()=>{const ce=q*W;return X.slice(ce,ce+W)})();G.useEffect(()=>{q>0&&q*W>=X.length&&D(0)},[X,q,W]);const Y=ce=>{if(!ce)return"-";const fe=ce.salutation||ce.Salutation||ce.sal||"",ve=ce.firstname||ce.Firstname||"",_e=ce.lastname||ce.Lastname||"",le=`${ve} ${_e}`.trim()||ce.usercode||"-";return`${fe?fe+" ":""}${le}`.trim()},K=ce=>{if(!ce)return"-";const fe=ce.salutation||ce.Salutation||ce.sal||"",ve=ce.firstname||ce.Firstname||ce.firstname||"",_e=ce.lastname||ce.Lastname||ce.lastname||"",le=`${ve} ${_e}`.trim()||ce.usercode||"-";return`${fe?fe+" ":""}${le}`.trim()},ee=ce=>(ce==null?void 0:ce.usercode)||(ce==null?void 0:ce.code)||(ce==null?void 0:ce.user_code)||"-",ue=async ce=>{if(!(ce!=null&&ce.relationId)){C({open:!0,message:"Cannot delete: missing relation id",severity:"error"});return}if(confirm(`Remove ${Y(ce)} from this department?`))try{const fe=await fetch(`${Je}/departments/employee/${ce.relationId}`,{method:"DELETE"});if(!fe.ok)throw new Error(await fe.text());u(ve=>ve.filter(_e=>String(_e.relationId)!==String(ce.relationId))),C({open:!0,message:"Employee removed successfully",severity:"success"});try{window.dispatchEvent(new CustomEvent("erp:departments-updated",{detail:{source:"designation",deptId:(n==null?void 0:n.id)||null}}))}catch{}}catch(fe){console.error(fe),C({open:!0,message:"Failed to remove employee from department",severity:"error"})}},se=(ce,fe)=>{s(fe),i(ce),O(ce.relationId||ce.id||null)};return a.jsx("div",{className:"designation-container",children:a.jsxs("div",{className:"designation-paper",children:[a.jsx("h2",{className:"designation-title",children:"Assign Employee to Head"}),a.jsxs("div",{className:"designation-controls",children:[a.jsxs("div",{className:"control-group",children:[a.jsx("label",{className:"control-label",children:"Select Department / Head"}),a.jsxs("select",{className:"control-select",value:n?n.id:"",onChange:ce=>{const fe=r.find(ve=>String(ve.id)===ce.target.value);j(null,fe||null)},children:[a.jsx("option",{value:"",children:"-- Select Department --"}),r.map(ce=>{var fe;return a.jsxs("option",{value:ce.id,children:[((fe=ce.department)==null?void 0:fe.name)||ce.name||ce.departmentName||"",ee(ce==null?void 0:ce.head)?`(${ee(ce==null?void 0:ce.head)})`:""," - ",K(ce==null?void 0:ce.head)]},ce.id)})]})]}),a.jsxs("div",{className:"control-group",children:[a.jsx("label",{className:"control-label",children:"Select Employee"}),a.jsxs("select",{className:"control-select",value:o?o.id:"",onChange:ce=>{const fe=l.find(ve=>String(ve.id)===ce.target.value);A(null,fe||null)},disabled:!n,children:[a.jsx("option",{value:"",children:"-- Select Employee --"}),l.filter(ce=>{if(!ce)return!1;const fe=r.some(ke=>{var pe;const Te=((pe=ke==null?void 0:ke.head)==null?void 0:pe.id)??(ke==null?void 0:ke.head_id);return Te!=null&&String(Te)===String(ce.id)}),ve=(n==null?void 0:n.head)&&String(n.head.id)===String(ce.id),_e=r.some(ke=>{const Te=ke.Employees||ke.employees||[];return Array.isArray(Te)?Te.some(pe=>{const ye=pe.employee||pe.Employee,ge=(ye==null?void 0:ye.id)||pe.employee_id||pe.EmployeeID;return ge!=null&&String(ge)===String(ce.id)}):!1}),le=L&&o&&String(ce.id)===String(o.id);return!fe&&!ve&&(!_e||le)}).map(ce=>a.jsxs("option",{value:ce.id,children:[Y(ce)," (",ee(ce),")"]},ce.id))]})]}),L&&a.jsx("button",{className:"btn btn-secondary",onClick:()=>{O(null),i(null),s(null)},children:"Cancel"}),a.jsx("button",{className:"btn btn-primary",onClick:Z,disabled:!n||!o||b,children:b?L?"Updating...":"Saving...":L?"Update":"Assign"}),a.jsxs("div",{className:"search-group",children:[a.jsx("input",{type:"text",className:"search-input",placeholder:"Search by anything...",value:H,onChange:N}),H&&a.jsx("button",{className:"search-clear",type:"button",onClick:()=>z(""),title:"Clear search",children:""})]})]}),a.jsx("div",{className:"designation-table-wrapper",children:a.jsxs("table",{className:"designation-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Sl No."}),a.jsx("th",{children:"Department"}),a.jsx("th",{children:"Head Emp Code"}),a.jsx("th",{children:"Head"}),a.jsx("th",{children:"Emp Code"}),a.jsx("th",{children:"Employee Name"}),a.jsx("th",{children:"Action"})]})}),a.jsx("tbody",{children:re.length?X.length?ne.map((ce,fe)=>{const ve=ce.emp,_e=ce.dept,le=q*W+fe;return a.jsxs("tr",{children:[a.jsx("td",{children:le+1}),a.jsx("td",{children:_e&&(_e.department&&_e.department.name||_e.departmentName||_e.name)||"-"}),a.jsx("td",{children:ee(_e==null?void 0:_e.head)}),a.jsx("td",{children:K(_e==null?void 0:_e.head)}),a.jsx("td",{children:ee(ve)}),a.jsx("td",{children:Y(ve)}),a.jsxs("td",{className:"action-cell",children:[a.jsx("button",{className:"action-btn edit-btn",onClick:()=>se(ve,_e),title:"Edit",children:""}),a.jsx("button",{className:"action-btn delete-btn",onClick:()=>ue(ve),title:"Delete",children:""})]})]},ve.relationId||ve.id)}):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"no-data",children:"No matching results."})}):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"no-data",children:h||n!=null&&n.id&&p?a.jsx("div",{className:"spinner",children:"Loading..."}):n?"No employees assigned to this department.":"Please select a department to view assigned employees."})})})]})}),X.length>0&&a.jsxs("div",{className:"pagination-wrapper",children:[a.jsxs("div",{className:"pagination",children:[a.jsx("button",{className:"pagination-btn",onClick:()=>V(null,Math.max(0,q-1)),disabled:q===0,children:" Prev"}),a.jsxs("span",{className:"pagination-info",children:["Page ",q+1," of ",Math.ceil(X.length/W)]}),a.jsx("button",{className:"pagination-btn",onClick:()=>V(null,q+1),disabled:(q+1)*W>=X.length,children:"Next "})]}),a.jsxs("div",{className:"rows-per-page",children:[a.jsx("label",{children:"Rows per page:"}),a.jsxs("select",{value:W,onChange:ce=>M({target:{value:ce.target.value}}),children:[a.jsx("option",{value:5,children:"5"}),a.jsx("option",{value:10,children:"10"}),a.jsx("option",{value:25,children:"25"}),a.jsx("option",{value:50,children:"50"})]})]})]}),S.open&&a.jsxs("div",{className:`snackbar snackbar-${S.severity}`,children:[a.jsx("span",{children:S.message}),a.jsx("button",{className:"snackbar-close",onClick:()=>C({...S,open:!1}),children:""})]})]})})};function Uoe(){const[e,r]=G.useState([]),[t,n]=G.useState([]),[s,o]=G.useState([]),[i,c]=G.useState([]),[u,l]=G.useState(""),[d,h]=G.useState([]),[f,p]=G.useState([]),[v,g]=G.useState(""),[m,b]=G.useState(""),[y,S]=G.useState(!1),[C,L]=G.useState(0),[O,H]=G.useState(10),[z,q]=G.useState(!1),[D,W]=G.useState(!1);G.useEffect(()=>{P()},[]),G.useEffect(()=>{L(0)},[m]);async function P(){S(!0);try{const[M,Z,J,re]=await Promise.all([fetch(`${Je}/api/employees/non-heads`),fetch(`${Je}/api/employees`),fetch(`${Je}/api/users/unassigned`),fetch(`${Je}/api/employee-user-mappings`)]);if(!M.ok)throw new Error("Failed to fetch employees");if(!Z.ok)throw new Error("Failed to fetch all employees");if(!J.ok)throw new Error("Failed to fetch users");if(!re.ok)throw new Error("Failed to fetch mappings");const X=await M.json(),ne=await Z.json(),Y=await J.json(),K=await re.json();r(X||[]),n(ne||[]),o(Y||[]),c(K||[])}catch(M){console.error(M),window.alert("Error loading data: "+M.message)}finally{S(!1)}}async function I(M){var Z;if((Z=M==null?void 0:M.preventDefault)==null||Z.call(M),!u||d.length===0){window.alert("Select employee and at least one user");return}try{if(!e||e.length===0){window.alert("No employees available  create employees before assigning users");return}S(!0);for(const J of d){const re=await fetch(`${Je}/api/employees/assign-user`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({employee_id:Number(u),user_id:Number(J)})}),X=await re.json();if(!re.ok)throw new Error(X.error||X.message||"Assign failed")}window.alert("Users assigned successfully"),l(""),h([]),await P()}catch(J){console.error(J),window.alert("Assign error: "+J.message)}finally{S(!1)}}async function U(M){if(window.confirm("Remove user mapping for this employee?"))try{S(!0);const Z=await fetch(`${Je}/api/employees/remove-user?id=${M}`,{method:"DELETE"}),J=await Z.json();if(!Z.ok)throw new Error(J.error||J.message||"Remove failed");window.alert(J.message||"Removed successfully"),await P()}catch(Z){console.error(Z),window.alert("Remove error: "+Z.message)}finally{S(!1)}}async function k(M){var Z;if((Z=M==null?void 0:M.preventDefault)==null||Z.call(M),f.length===0||!v){window.alert("Select users to shift and target employee");return}try{S(!0);const J=await fetch(`${Je}/api/employees/shift-users`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_ids:f.map(Number),to_employee_id:Number(v)})}),re=await J.json();if(!J.ok)throw new Error(re.error||re.message||"Shift failed");window.alert(re.message||"Users shifted successfully"),p([]),g(""),await P()}catch(J){console.error(J),window.alert("Shift error: "+J.message)}finally{S(!1)}}function _(M){h(Z=>Z.includes(M)?Z.filter(J=>J!==M):[...Z,M])}function R(M){p(Z=>Z.includes(M)?Z.filter(J=>J!==M):[...Z,M])}function j(M){const Z=[];return M?(M.is_customer&&Z.push("Customer"),M.is_supplier&&Z.push("Supplier"),M.is_dealer&&Z.push("Dealer"),M.is_distributor&&Z.push("Distributor"),Z.length>0?Z.join(", "):"User"):"-"}function A(M){if(!M)return"-";const Z=M.salutation?`${M.salutation} `:"",J=M.firstname||"",re=M.lastname||"";return`${Z}${J}${re?` ${re}`:""}`.trim()||"-"}const N=m.trim().toLowerCase(),V=i.filter(M=>{if(!N)return!0;const Z=M.employee&&M.employee.usercode?String(M.employee.usercode):M.employee?String(M.employee.id):String(M.employee_id),J=M.employee?A(M.employee):String(M.employee_id),re=M.user&&M.user.usercode?String(M.user.usercode):M.user?String(M.user.id):String(M.user_id),X=M.user&&(M.user.company_name||M.user.company||M.user.companyName)||"",ne=M.user?j(M.user):"";return`${Z} ${J} ${re} ${X} ${ne}`.toLowerCase().includes(N)});return a.jsxs("div",{className:"assign-container",children:[a.jsx("h1",{className:"assign-title",children:"Assign User to Employee"}),a.jsxs("div",{className:"assign-content",children:[a.jsxs("div",{className:"assign-paper",children:[a.jsx("h2",{className:"section-title",children:"Assign Users"}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:"Select Employee"}),a.jsxs("select",{className:"form-select",value:u,onChange:M=>l(M.target.value),children:[a.jsx("option",{value:"",children:"-- Select Employee --"}),e.map(M=>a.jsxs("option",{value:M.id,children:[A(M),M.usercode?` (${M.usercode})`:""]},M.id))]})]}),a.jsxs("div",{className:"subsection",children:[a.jsx("h3",{className:"subsection-title",children:"Unassigned Users"}),a.jsx("div",{className:"users-grid",children:y&&s.length===0?a.jsx("div",{className:"loading-container",children:a.jsx("div",{className:"spinner",children:"Loading..."})}):s.length===0?a.jsx("div",{className:"empty-message",children:"No unassigned users available"}):s.map(M=>{const Z=M.usercode?`${M.usercode}  ${M.company_name||M.company||M.companyName||""}`:`${M.firstname||""} ${M.lastname||""}`,J=d.includes(M.id);return a.jsxs("div",{className:`user-card ${J?"selected":""}`,onClick:()=>_(M.id),children:[a.jsx("input",{type:"checkbox",checked:J,onChange:re=>{re.stopPropagation(),_(M.id)},onClick:re=>re.stopPropagation()}),a.jsxs("div",{className:"user-info",children:[a.jsx("div",{className:"user-primary",children:Z}),a.jsx("div",{className:"user-secondary",children:j(M)})]})]},M.id)})})]}),a.jsxs("div",{className:"action-footer",children:[a.jsxs("span",{className:"selection-count",children:[d.length," user(s) selected"]}),a.jsxs("div",{className:"button-group",children:[a.jsx("button",{className:"btn btn-secondary",onClick:()=>{l(""),h([])},children:"Clear"}),a.jsx("button",{className:"btn btn-primary",onClick:I,disabled:y||!u||d.length===0,children:y?"Working...":"Assign Selected Users"})]})]})]}),a.jsxs("div",{className:"assign-paper",children:[a.jsx("h2",{className:"section-title",children:"Shift Users Between Employees"}),a.jsxs("form",{className:"shift-form",onSubmit:k,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:"Target Employee"}),a.jsxs("select",{className:"form-select",value:v,onChange:M=>g(M.target.value),children:[a.jsx("option",{value:"",children:"-- Select Employee --"}),e.map(M=>a.jsxs("option",{value:M.id,children:[A(M),M.usercode?` (${M.usercode})`:""]},M.id))]})]}),a.jsxs("button",{type:"submit",className:"btn btn-secondary",disabled:y||f.length===0,children:["Shift Selected Users (",f.length,")"]}),a.jsx("div",{className:"search-group",children:a.jsx("input",{type:"text",className:"search-input",placeholder:"Search mappings...",value:m,onChange:M=>b(M.target.value)})})]}),a.jsxs("div",{className:"subsection",children:[a.jsx("h3",{className:"subsection-title",children:"Current Mappings"}),a.jsx("div",{className:"table-wrapper",children:a.jsxs("table",{className:"mappings-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:"col-select",children:"Select"}),a.jsx("th",{className:"col-slno",children:"Sl No."}),a.jsx("th",{children:"Emp Code"}),a.jsx("th",{children:"Employee Name"}),a.jsx("th",{children:"User Code"}),a.jsx("th",{children:"Company Name"}),a.jsx("th",{children:"User Type"}),a.jsx("th",{className:"col-action",children:"Action"})]})}),a.jsx("tbody",{children:V.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"no-data",children:"No mappings"})}):V.slice(C*O,C*O+O).map((M,Z)=>a.jsxs("tr",{children:[a.jsx("td",{className:"col-select",children:a.jsx("input",{type:"checkbox",checked:f.includes(M.user_id),onChange:()=>R(M.user_id)})}),a.jsx("td",{className:"col-slno",children:C*O+Z+1}),a.jsx("td",{children:M.employee&&M.employee.usercode?M.employee.usercode:M.employee?M.employee.id:M.employee_id}),a.jsx("td",{children:M.employee?A(M.employee):M.employee_id}),a.jsx("td",{children:M.user&&M.user.usercode?M.user.usercode:M.user?M.user.id:M.user_id}),a.jsx("td",{children:M.user&&(M.user.company_name||M.user.company||M.user.companyName)||"-"}),a.jsx("td",{children:M.user?j(M.user):"-"}),a.jsx("td",{className:"col-action",children:a.jsx("button",{className:"action-btn delete-btn",onClick:()=>U(M.id),title:"Delete",children:""})})]},M.id))})]})}),V.length>0&&a.jsxs("div",{className:"pagination-wrapper",children:[a.jsxs("div",{className:"pagination",children:[a.jsx("button",{className:"pagination-btn",onClick:()=>L(Math.max(0,C-1)),disabled:C===0,children:" Prev"}),a.jsxs("span",{className:"pagination-info",children:["Page ",C+1," of ",Math.ceil(V.length/O)]}),a.jsx("button",{className:"pagination-btn",onClick:()=>L(C+1),disabled:(C+1)*O>=V.length,children:"Next "})]}),a.jsxs("div",{className:"rows-per-page",children:[a.jsx("label",{children:"Rows per page:"}),a.jsxs("select",{value:O,onChange:M=>{H(parseInt(M.target.value,10)),L(0)},children:[a.jsx("option",{value:5,children:"5"}),a.jsx("option",{value:10,children:"10"}),a.jsx("option",{value:25,children:"25"})]})]})]})]})]})]})]})}const V1=[{key:"selectall",label:"Select All"},{key:"business",label:"Business"},{key:"name",label:"Name"},{key:"designation",label:"Designation"},{key:"mobile",label:"Mobile"},{key:"email",label:"Email"},{key:"addressLine1",label:"Address Line 1"},{key:"addressLine2",label:"Address Line 2"},{key:"city",label:"City"},{key:"state",label:"State"},{key:"country",label:"Country"},{key:"source",label:"Source"},{key:"stage",label:"Stage"},{key:"potential",label:"Potential"},{key:"since",label:"Since"},{key:"gstin",label:"GSTIN"},{key:"category",label:"Category"},{key:"product",label:"Product"},{key:"website",label:"Website"},{key:"requirements",label:"Requirements"},{key:"notes",label:"Notes"},{key:"tags",label:"Tags"},{key:"lastTalk",label:"LastTalk"},{key:"nextTalk",label:"NextTalk"},{key:"transferredOn",label:"TransferredOn"},{key:"assignedTo",label:"AssignedTo"},{key:"createdAt",label:"CreatedAt"},{key:"updatedAt",label:"UpdatedAt"}],Fy="displayPreferences",Hoe=({onClose:e})=>{const[r,t]=G.useState(()=>{const i=localStorage.getItem(Fy);return i?JSON.parse(i):V1.reduce((c,u)=>({...c,[u.key]:!0}),{})}),n=i=>{t(c=>{if(i==="selectall"){const u=!c.selectall,l={};return V1.forEach(d=>{l[d.key]=u}),localStorage.setItem(Fy,JSON.stringify(l)),l}else{const u={...c,[i]:!c[i]},l=V1.filter(d=>d.key!=="selectall").every(d=>u[d.key]);return u.selectall=l,localStorage.setItem(Fy,JSON.stringify(u)),u}})},s=()=>{localStorage.setItem(Fy,JSON.stringify(r)),e&&e()},o=[];for(let i=0;i<V1.length;i+=5)o.push(V1.slice(i,i+5));return a.jsx("div",{className:"modal-overlay",children:a.jsxs("div",{className:"display-pref-modal",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:"Display Preferences"}),a.jsx("button",{className:"close-button",onClick:e,children:""})]}),a.jsx("div",{className:"modal-body",children:a.jsx("form",{children:a.jsx("div",{className:"field-checkbox-grid",children:o.map((i,c)=>a.jsx("div",{className:"field-checkbox-row",children:i.map(u=>a.jsxs("label",{className:"field-checkbox-cell",children:[a.jsx("input",{type:"checkbox",checked:!!r[u.key],onChange:()=>n(u.key)}),u.label]},u.key))},c))})})}),a.jsxs("button",{className:"save-btn",onClick:s,children:[a.jsx(j0,{className:"save-icon"}),"Save"]})]})})};function U0(e){"@babel/helpers - typeof";return U0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},U0(e)}function Voe(e,r){if(U0(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(U0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function RE(e){var r=Voe(e,"string");return U0(r)=="symbol"?r:r+""}function av(e,r,t){return(r=RE(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function cj(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),t.push.apply(t,n)}return t}function Mn(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?cj(Object(t),!0).forEach(function(n){av(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):cj(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Woe(e){if(Array.isArray(e))return e}function qoe(e,r){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n,s,o,i,c=[],u=!0,l=!1;try{if(o=(t=t.call(e)).next,r===0){if(Object(t)!==t)return;u=!1}else for(;!(u=(n=o.call(t)).done)&&(c.push(n.value),c.length!==r);u=!0);}catch(d){l=!0,s=d}finally{try{if(!u&&t.return!=null&&(i=t.return(),Object(i)!==i))return}finally{if(l)throw s}}return c}}function XS(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}function EE(e,r){if(e){if(typeof e=="string")return XS(e,r);var t={}.toString.call(e).slice(8,-1);return t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set"?Array.from(e):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?XS(e,r):void 0}}function Goe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Md(e,r){return Woe(e)||qoe(e,r)||EE(e,r)||Goe()}function Hd(e,r){if(e==null)return{};var t,n,s=w6(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)t=o[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}var Koe=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function Xoe(e){var r=e.defaultInputValue,t=r===void 0?"":r,n=e.defaultMenuIsOpen,s=n===void 0?!1:n,o=e.defaultValue,i=o===void 0?null:o,c=e.inputValue,u=e.menuIsOpen,l=e.onChange,d=e.onInputChange,h=e.onMenuClose,f=e.onMenuOpen,p=e.value,v=Hd(e,Koe),g=G.useState(c!==void 0?c:t),m=Md(g,2),b=m[0],y=m[1],S=G.useState(u!==void 0?u:s),C=Md(S,2),L=C[0],O=C[1],H=G.useState(p!==void 0?p:i),z=Md(H,2),q=z[0],D=z[1],W=G.useCallback(function(j,A){typeof l=="function"&&l(j,A),D(j)},[l]),P=G.useCallback(function(j,A){var N;typeof d=="function"&&(N=d(j,A)),y(N!==void 0?N:j)},[d]),I=G.useCallback(function(){typeof f=="function"&&f(),O(!0)},[f]),U=G.useCallback(function(){typeof h=="function"&&h(),O(!1)},[h]),k=c!==void 0?c:b,_=u!==void 0?u:L,R=p!==void 0?p:q;return Mn(Mn({},v),{},{inputValue:k,menuIsOpen:_,onChange:W,onInputChange:P,onMenuClose:U,onMenuOpen:I,value:R})}function Yoe(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function uj(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RE(n.key),n)}}function Zoe(e,r,t){return r&&uj(e.prototype,r),t&&uj(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Joe(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&u2(e,r)}function z2(e){return z2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},z2(e)}function NE(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(NE=function(){return!!e})()}function Qoe(e,r){if(r&&(U0(r)=="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fk(e)}function ele(e){var r=NE();return function(){var t,n=z2(e);if(r){var s=z2(this).constructor;t=Reflect.construct(n,arguments,s)}else t=n.apply(this,arguments);return Qoe(this,t)}}function tle(e){if(Array.isArray(e))return XS(e)}function rle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function nle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function B_(e){return tle(e)||rle(e)||EE(e)||nle()}function ale(e,r){return r||(r=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))}const sle=Math.min,ile=Math.max,$2=Math.round,By=Math.floor,U2=e=>({x:e,y:e});function ole(e){const{x:r,y:t,width:n,height:s}=e;return{width:n,height:s,top:t,left:r,right:r+n,bottom:t+s,x:r,y:t}}function Uw(){return typeof window<"u"}function TE(e){return ME(e)?(e.nodeName||"").toLowerCase():"#document"}function Bd(e){var r;return(e==null||(r=e.ownerDocument)==null?void 0:r.defaultView)||window}function LE(e){var r;return(r=(ME(e)?e.ownerDocument:e.document)||window.document)==null?void 0:r.documentElement}function ME(e){return Uw()?e instanceof Node||e instanceof Bd(e).Node:!1}function lle(e){return Uw()?e instanceof Element||e instanceof Bd(e).Element:!1}function z_(e){return Uw()?e instanceof HTMLElement||e instanceof Bd(e).HTMLElement:!1}function dj(e){return!Uw()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Bd(e).ShadowRoot}const cle=new Set(["inline","contents"]);function DE(e){const{overflow:r,overflowX:t,overflowY:n,display:s}=$_(e);return/auto|scroll|overlay|hidden|clip/.test(r+n+t)&&!cle.has(s)}function ule(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const dle=new Set(["html","body","#document"]);function fle(e){return dle.has(TE(e))}function $_(e){return Bd(e).getComputedStyle(e)}function hle(e){if(TE(e)==="html")return e;const r=e.assignedSlot||e.parentNode||dj(e)&&e.host||LE(e);return dj(r)?r.host:r}function IE(e){const r=hle(e);return fle(r)?e.ownerDocument?e.ownerDocument.body:e.body:z_(r)&&DE(r)?r:IE(r)}function H2(e,r,t){var n;r===void 0&&(r=[]),t===void 0&&(t=!0);const s=IE(e),o=s===((n=e.ownerDocument)==null?void 0:n.body),i=Bd(s);if(o){const c=YS(i);return r.concat(i,i.visualViewport||[],DE(s)?s:[],c&&t?H2(c):[])}return r.concat(s,H2(s,[],t))}function YS(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function ple(e){const r=$_(e);let t=parseFloat(r.width)||0,n=parseFloat(r.height)||0;const s=z_(e),o=s?e.offsetWidth:t,i=s?e.offsetHeight:n,c=$2(t)!==o||$2(n)!==i;return c&&(t=o,n=i),{width:t,height:n,$:c}}function U_(e){return lle(e)?e:e.contextElement}function fj(e){const r=U_(e);if(!z_(r))return U2(1);const t=r.getBoundingClientRect(),{width:n,height:s,$:o}=ple(r);let i=(o?$2(t.width):t.width)/n,c=(o?$2(t.height):t.height)/s;return(!i||!Number.isFinite(i))&&(i=1),(!c||!Number.isFinite(c))&&(c=1),{x:i,y:c}}const mle=U2(0);function gle(e){const r=Bd(e);return!ule()||!r.visualViewport?mle:{x:r.visualViewport.offsetLeft,y:r.visualViewport.offsetTop}}function vle(e,r,t){return!1}function hj(e,r,t,n){r===void 0&&(r=!1);const s=e.getBoundingClientRect(),o=U_(e);let i=U2(1);r&&(i=fj(e));const c=vle()?gle(o):U2(0);let u=(s.left+c.x)/i.x,l=(s.top+c.y)/i.y,d=s.width/i.x,h=s.height/i.y;if(o){const f=Bd(o),p=n;let v=f,g=YS(v);for(;g&&n&&p!==v;){const m=fj(g),b=g.getBoundingClientRect(),y=$_(g),S=b.left+(g.clientLeft+parseFloat(y.paddingLeft))*m.x,C=b.top+(g.clientTop+parseFloat(y.paddingTop))*m.y;u*=m.x,l*=m.y,d*=m.x,h*=m.y,u+=S,l+=C,v=Bd(g),g=YS(v)}}return ole({width:d,height:h,x:u,y:l})}function OE(e,r){return e.x===r.x&&e.y===r.y&&e.width===r.width&&e.height===r.height}function xle(e,r){let t=null,n;const s=LE(e);function o(){var c;clearTimeout(n),(c=t)==null||c.disconnect(),t=null}function i(c,u){c===void 0&&(c=!1),u===void 0&&(u=1),o();const l=e.getBoundingClientRect(),{left:d,top:h,width:f,height:p}=l;if(c||r(),!f||!p)return;const v=By(h),g=By(s.clientWidth-(d+f)),m=By(s.clientHeight-(h+p)),b=By(d),S={rootMargin:-v+"px "+-g+"px "+-m+"px "+-b+"px",threshold:ile(0,sle(1,u))||1};let C=!0;function L(O){const H=O[0].intersectionRatio;if(H!==u){if(!C)return i();H?i(!1,H):n=setTimeout(()=>{i(!1,1e-7)},1e3)}H===1&&!OE(l,e.getBoundingClientRect())&&i(),C=!1}try{t=new IntersectionObserver(L,{...S,root:s.ownerDocument})}catch{t=new IntersectionObserver(L,S)}t.observe(e)}return i(!0),o}function ble(e,r,t,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:o=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:u=!1}=n,l=U_(e),d=s||o?[...l?H2(l):[],...H2(r)]:[];d.forEach(b=>{s&&b.addEventListener("scroll",t,{passive:!0}),o&&b.addEventListener("resize",t)});const h=l&&c?xle(l,t):null;let f=-1,p=null;i&&(p=new ResizeObserver(b=>{let[y]=b;y&&y.target===l&&p&&(p.unobserve(r),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var S;(S=p)==null||S.observe(r)})),t()}),l&&!u&&p.observe(l),p.observe(r));let v,g=u?hj(e):null;u&&m();function m(){const b=hj(e);g&&!OE(g,b)&&t(),g=b,v=requestAnimationFrame(m)}return t(),()=>{var b;d.forEach(y=>{s&&y.removeEventListener("scroll",t),o&&y.removeEventListener("resize",t)}),h==null||h(),(b=p)==null||b.disconnect(),p=null,u&&cancelAnimationFrame(v)}}var ZS=G.useLayoutEffect,yle=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],V2=function(){};function wle(e,r){return r?r[0]==="-"?e+r:e+"__"+r:e}function Sle(e,r){for(var t=arguments.length,n=new Array(t>2?t-2:0),s=2;s<t;s++)n[s-2]=arguments[s];var o=[].concat(n);if(r&&e)for(var i in r)r.hasOwnProperty(i)&&r[i]&&o.push("".concat(wle(e,i)));return o.filter(function(c){return c}).map(function(c){return String(c).trim()}).join(" ")}var pj=function(r){return Tle(r)?r.filter(Boolean):U0(r)==="object"&&r!==null?[r]:[]},PE=function(r){r.className,r.clearValue,r.cx,r.getStyles,r.getClassNames,r.getValue,r.hasValue,r.isMulti,r.isRtl,r.options,r.selectOption,r.selectProps,r.setValue,r.theme;var t=Hd(r,yle);return Mn({},t)},ai=function(r,t,n){var s=r.cx,o=r.getStyles,i=r.getClassNames,c=r.className;return{css:o(t,r),className:s(n??{},i(t,r),c)}};function Hw(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function _le(e){return Hw(e)?window.innerHeight:e.clientHeight}function FE(e){return Hw(e)?window.pageYOffset:e.scrollTop}function W2(e,r){if(Hw(e)){window.scrollTo(0,r);return}e.scrollTop=r}function Ale(e){var r=getComputedStyle(e),t=r.position==="absolute",n=/(auto|scroll)/;if(r.position==="fixed")return document.documentElement;for(var s=e;s=s.parentElement;)if(r=getComputedStyle(s),!(t&&r.position==="static")&&n.test(r.overflow+r.overflowY+r.overflowX))return s;return document.documentElement}function Cle(e,r,t,n){return t*((e=e/n-1)*e*e+1)+r}function zy(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:V2,s=FE(e),o=r-s,i=10,c=0;function u(){c+=i;var l=Cle(c,s,o,t);W2(e,l),c<t?window.requestAnimationFrame(u):n(e)}u()}function mj(e,r){var t=e.getBoundingClientRect(),n=r.getBoundingClientRect(),s=r.offsetHeight/3;n.bottom+s>t.bottom?W2(e,Math.min(r.offsetTop+r.clientHeight-e.offsetHeight+s,e.scrollHeight)):n.top-s<t.top&&W2(e,Math.max(r.offsetTop-s,0))}function jle(e){var r=e.getBoundingClientRect();return{bottom:r.bottom,height:r.height,left:r.left,right:r.right,top:r.top,width:r.width}}function gj(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function kle(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var BE=!1,Rle={get passive(){return BE=!0}},$y=typeof window<"u"?window:{};$y.addEventListener&&$y.removeEventListener&&($y.addEventListener("p",V2,Rle),$y.removeEventListener("p",V2,!1));var Ele=BE;function Nle(e){return e!=null}function Tle(e){return Array.isArray(e)}function Uy(e,r,t){return e?r:t}var Lle=function(r){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];var o=Object.entries(r).filter(function(i){var c=Md(i,1),u=c[0];return!n.includes(u)});return o.reduce(function(i,c){var u=Md(c,2),l=u[0],d=u[1];return i[l]=d,i},{})},Mle=["children","innerProps"],Dle=["children","innerProps"];function Ile(e){var r=e.maxHeight,t=e.menuEl,n=e.minHeight,s=e.placement,o=e.shouldScroll,i=e.isFixedPosition,c=e.controlHeight,u=Ale(t),l={placement:"bottom",maxHeight:r};if(!t||!t.offsetParent)return l;var d=u.getBoundingClientRect(),h=d.height,f=t.getBoundingClientRect(),p=f.bottom,v=f.height,g=f.top,m=t.offsetParent.getBoundingClientRect(),b=m.top,y=i?window.innerHeight:_le(u),S=FE(u),C=parseInt(getComputedStyle(t).marginBottom,10),L=parseInt(getComputedStyle(t).marginTop,10),O=b-L,H=y-g,z=O+S,q=h-S-g,D=p-y+S+C,W=S+g-L,P=160;switch(s){case"auto":case"bottom":if(H>=v)return{placement:"bottom",maxHeight:r};if(q>=v&&!i)return o&&zy(u,D,P),{placement:"bottom",maxHeight:r};if(!i&&q>=n||i&&H>=n){o&&zy(u,D,P);var I=i?H-C:q-C;return{placement:"bottom",maxHeight:I}}if(s==="auto"||i){var U=r,k=i?O:z;return k>=n&&(U=Math.min(k-C-c,r)),{placement:"top",maxHeight:U}}if(s==="bottom")return o&&W2(u,D),{placement:"bottom",maxHeight:r};break;case"top":if(O>=v)return{placement:"top",maxHeight:r};if(z>=v&&!i)return o&&zy(u,W,P),{placement:"top",maxHeight:r};if(!i&&z>=n||i&&O>=n){var _=r;return(!i&&z>=n||i&&O>=n)&&(_=i?O-L:z-L),o&&zy(u,W,P),{placement:"top",maxHeight:_}}return{placement:"bottom",maxHeight:r};default:throw new Error('Invalid placement provided "'.concat(s,'".'))}return l}function Ole(e){var r={bottom:"top",top:"bottom"};return e?r[e]:"bottom"}var zE=function(r){return r==="auto"?"bottom":r},Ple=function(r,t){var n,s=r.placement,o=r.theme,i=o.borderRadius,c=o.spacing,u=o.colors;return Mn((n={label:"menu"},av(n,Ole(s),"100%"),av(n,"position","absolute"),av(n,"width","100%"),av(n,"zIndex",1),n),t?{}:{backgroundColor:u.neutral0,borderRadius:i,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:c.menuGutter,marginTop:c.menuGutter})},$E=G.createContext(null),Fle=function(r){var t=r.children,n=r.minMenuHeight,s=r.maxMenuHeight,o=r.menuPlacement,i=r.menuPosition,c=r.menuShouldScrollIntoView,u=r.theme,l=G.useContext($E)||{},d=l.setPortalPlacement,h=G.useRef(null),f=G.useState(s),p=Md(f,2),v=p[0],g=p[1],m=G.useState(null),b=Md(m,2),y=b[0],S=b[1],C=u.spacing.controlHeight;return ZS(function(){var L=h.current;if(L){var O=i==="fixed",H=c&&!O,z=Ile({maxHeight:s,menuEl:L,minHeight:n,placement:o,shouldScroll:H,isFixedPosition:O,controlHeight:C});g(z.maxHeight),S(z.placement),d==null||d(z.placement)}},[s,o,i,c,n,d,C]),t({ref:h,placerProps:Mn(Mn({},r),{},{placement:y||zE(o),maxHeight:v})})},Ble=function(r){var t=r.children,n=r.innerRef,s=r.innerProps;return Cn("div",Ln({},ai(r,"menu",{menu:!0}),{ref:n},s),t)},zle=Ble,$le=function(r,t){var n=r.maxHeight,s=r.theme.spacing.baseUnit;return Mn({maxHeight:n,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},t?{}:{paddingBottom:s,paddingTop:s})},Ule=function(r){var t=r.children,n=r.innerProps,s=r.innerRef,o=r.isMulti;return Cn("div",Ln({},ai(r,"menuList",{"menu-list":!0,"menu-list--is-multi":o}),{ref:s},n),t)},UE=function(r,t){var n=r.theme,s=n.spacing.baseUnit,o=n.colors;return Mn({textAlign:"center"},t?{}:{color:o.neutral40,padding:"".concat(s*2,"px ").concat(s*3,"px")})},Hle=UE,Vle=UE,Wle=function(r){var t=r.children,n=t===void 0?"No options":t,s=r.innerProps,o=Hd(r,Mle);return Cn("div",Ln({},ai(Mn(Mn({},o),{},{children:n,innerProps:s}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),s),n)},qle=function(r){var t=r.children,n=t===void 0?"Loading...":t,s=r.innerProps,o=Hd(r,Dle);return Cn("div",Ln({},ai(Mn(Mn({},o),{},{children:n,innerProps:s}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),s),n)},Gle=function(r){var t=r.rect,n=r.offset,s=r.position;return{left:t.left,position:s,top:n,width:t.width,zIndex:1}},Kle=function(r){var t=r.appendTo,n=r.children,s=r.controlElement,o=r.innerProps,i=r.menuPlacement,c=r.menuPosition,u=G.useRef(null),l=G.useRef(null),d=G.useState(zE(i)),h=Md(d,2),f=h[0],p=h[1],v=G.useMemo(function(){return{setPortalPlacement:p}},[]),g=G.useState(null),m=Md(g,2),b=m[0],y=m[1],S=G.useCallback(function(){if(s){var H=jle(s),z=c==="fixed"?0:window.pageYOffset,q=H[f]+z;(q!==(b==null?void 0:b.offset)||H.left!==(b==null?void 0:b.rect.left)||H.width!==(b==null?void 0:b.rect.width))&&y({offset:q,rect:H})}},[s,c,f,b==null?void 0:b.offset,b==null?void 0:b.rect.left,b==null?void 0:b.rect.width]);ZS(function(){S()},[S]);var C=G.useCallback(function(){typeof l.current=="function"&&(l.current(),l.current=null),s&&u.current&&(l.current=ble(s,u.current,S,{elementResize:"ResizeObserver"in window}))},[s,S]);ZS(function(){C()},[C]);var L=G.useCallback(function(H){u.current=H,C()},[C]);if(!t&&c!=="fixed"||!b)return null;var O=Cn("div",Ln({ref:L},ai(Mn(Mn({},r),{},{offset:b.offset,position:c,rect:b.rect}),"menuPortal",{"menu-portal":!0}),o),n);return Cn($E.Provider,{value:v},t?s6.createPortal(O,t):O)},Xle=function(r){var t=r.isDisabled,n=r.isRtl;return{label:"container",direction:n?"rtl":void 0,pointerEvents:t?"none":void 0,position:"relative"}},Yle=function(r){var t=r.children,n=r.innerProps,s=r.isDisabled,o=r.isRtl;return Cn("div",Ln({},ai(r,"container",{"--is-disabled":s,"--is-rtl":o}),n),t)},Zle=function(r,t){var n=r.theme.spacing,s=r.isMulti,o=r.hasValue,i=r.selectProps.controlShouldRenderValue;return Mn({alignItems:"center",display:s&&o&&i?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},t?{}:{padding:"".concat(n.baseUnit/2,"px ").concat(n.baseUnit*2,"px")})},Jle=function(r){var t=r.children,n=r.innerProps,s=r.isMulti,o=r.hasValue;return Cn("div",Ln({},ai(r,"valueContainer",{"value-container":!0,"value-container--is-multi":s,"value-container--has-value":o}),n),t)},Qle=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},ece=function(r){var t=r.children,n=r.innerProps;return Cn("div",Ln({},ai(r,"indicatorsContainer",{indicators:!0}),n),t)},vj,tce=["size"],rce=["innerProps","isRtl","size"],nce={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},HE=function(r){var t=r.size,n=Hd(r,tce);return Cn("svg",Ln({height:t,width:t,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:nce},n))},H_=function(r){return Cn(HE,Ln({size:20},r),Cn("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},VE=function(r){return Cn(HE,Ln({size:20},r),Cn("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},WE=function(r,t){var n=r.isFocused,s=r.theme,o=s.spacing.baseUnit,i=s.colors;return Mn({label:"indicatorContainer",display:"flex",transition:"color 150ms"},t?{}:{color:n?i.neutral60:i.neutral20,padding:o*2,":hover":{color:n?i.neutral80:i.neutral40}})},ace=WE,sce=function(r){var t=r.children,n=r.innerProps;return Cn("div",Ln({},ai(r,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),n),t||Cn(VE,null))},ice=WE,oce=function(r){var t=r.children,n=r.innerProps;return Cn("div",Ln({},ai(r,"clearIndicator",{indicator:!0,"clear-indicator":!0}),n),t||Cn(H_,null))},lce=function(r,t){var n=r.isDisabled,s=r.theme,o=s.spacing.baseUnit,i=s.colors;return Mn({label:"indicatorSeparator",alignSelf:"stretch",width:1},t?{}:{backgroundColor:n?i.neutral10:i.neutral20,marginBottom:o*2,marginTop:o*2})},cce=function(r){var t=r.innerProps;return Cn("span",Ln({},t,ai(r,"indicatorSeparator",{"indicator-separator":!0})))},uce=Gf(vj||(vj=ale([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),dce=function(r,t){var n=r.isFocused,s=r.size,o=r.theme,i=o.colors,c=o.spacing.baseUnit;return Mn({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:s,lineHeight:1,marginRight:s,textAlign:"center",verticalAlign:"middle"},t?{}:{color:n?i.neutral60:i.neutral20,padding:c*2})},K3=function(r){var t=r.delay,n=r.offset;return Cn("span",{css:H0({animation:"".concat(uce," 1s ease-in-out ").concat(t,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:n?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},fce=function(r){var t=r.innerProps,n=r.isRtl,s=r.size,o=s===void 0?4:s,i=Hd(r,rce);return Cn("div",Ln({},ai(Mn(Mn({},i),{},{innerProps:t,isRtl:n,size:o}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),t),Cn(K3,{delay:0,offset:n}),Cn(K3,{delay:160,offset:!0}),Cn(K3,{delay:320,offset:!n}))},hce=function(r,t){var n=r.isDisabled,s=r.isFocused,o=r.theme,i=o.colors,c=o.borderRadius,u=o.spacing;return Mn({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:u.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},t?{}:{backgroundColor:n?i.neutral5:i.neutral0,borderColor:n?i.neutral10:s?i.primary:i.neutral20,borderRadius:c,borderStyle:"solid",borderWidth:1,boxShadow:s?"0 0 0 1px ".concat(i.primary):void 0,"&:hover":{borderColor:s?i.primary:i.neutral30}})},pce=function(r){var t=r.children,n=r.isDisabled,s=r.isFocused,o=r.innerRef,i=r.innerProps,c=r.menuIsOpen;return Cn("div",Ln({ref:o},ai(r,"control",{control:!0,"control--is-disabled":n,"control--is-focused":s,"control--menu-is-open":c}),i,{"aria-disabled":n||void 0}),t)},mce=pce,gce=["data"],vce=function(r,t){var n=r.theme.spacing;return t?{}:{paddingBottom:n.baseUnit*2,paddingTop:n.baseUnit*2}},xce=function(r){var t=r.children,n=r.cx,s=r.getStyles,o=r.getClassNames,i=r.Heading,c=r.headingProps,u=r.innerProps,l=r.label,d=r.theme,h=r.selectProps;return Cn("div",Ln({},ai(r,"group",{group:!0}),u),Cn(i,Ln({},c,{selectProps:h,theme:d,getStyles:s,getClassNames:o,cx:n}),l),Cn("div",null,t))},bce=function(r,t){var n=r.theme,s=n.colors,o=n.spacing;return Mn({label:"group",cursor:"default",display:"block"},t?{}:{color:s.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:o.baseUnit*3,paddingRight:o.baseUnit*3,textTransform:"uppercase"})},yce=function(r){var t=PE(r);t.data;var n=Hd(t,gce);return Cn("div",Ln({},ai(r,"groupHeading",{"group-heading":!0}),n))},wce=xce,Sce=["innerRef","isDisabled","isHidden","inputClassName"],_ce=function(r,t){var n=r.isDisabled,s=r.value,o=r.theme,i=o.spacing,c=o.colors;return Mn(Mn({visibility:n?"hidden":"visible",transform:s?"translateZ(0)":""},Ace),t?{}:{margin:i.baseUnit/2,paddingBottom:i.baseUnit/2,paddingTop:i.baseUnit/2,color:c.neutral80})},qE={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},Ace={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Mn({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},qE)},Cce=function(r){return Mn({label:"input",color:"inherit",background:0,opacity:r?0:1,width:"100%"},qE)},jce=function(r){var t=r.cx,n=r.value,s=PE(r),o=s.innerRef,i=s.isDisabled,c=s.isHidden,u=s.inputClassName,l=Hd(s,Sce);return Cn("div",Ln({},ai(r,"input",{"input-container":!0}),{"data-value":n||""}),Cn("input",Ln({className:t({input:!0},u),ref:o,style:Cce(c),disabled:i},l)))},kce=jce,Rce=function(r,t){var n=r.theme,s=n.spacing,o=n.borderRadius,i=n.colors;return Mn({label:"multiValue",display:"flex",minWidth:0},t?{}:{backgroundColor:i.neutral10,borderRadius:o/2,margin:s.baseUnit/2})},Ece=function(r,t){var n=r.theme,s=n.borderRadius,o=n.colors,i=r.cropWithEllipsis;return Mn({overflow:"hidden",textOverflow:i||i===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},t?{}:{borderRadius:s/2,color:o.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},Nce=function(r,t){var n=r.theme,s=n.spacing,o=n.borderRadius,i=n.colors,c=r.isFocused;return Mn({alignItems:"center",display:"flex"},t?{}:{borderRadius:o/2,backgroundColor:c?i.dangerLight:void 0,paddingLeft:s.baseUnit,paddingRight:s.baseUnit,":hover":{backgroundColor:i.dangerLight,color:i.danger}})},GE=function(r){var t=r.children,n=r.innerProps;return Cn("div",n,t)},Tce=GE,Lce=GE;function Mce(e){var r=e.children,t=e.innerProps;return Cn("div",Ln({role:"button"},t),r||Cn(H_,{size:14}))}var Dce=function(r){var t=r.children,n=r.components,s=r.data,o=r.innerProps,i=r.isDisabled,c=r.removeProps,u=r.selectProps,l=n.Container,d=n.Label,h=n.Remove;return Cn(l,{data:s,innerProps:Mn(Mn({},ai(r,"multiValue",{"multi-value":!0,"multi-value--is-disabled":i})),o),selectProps:u},Cn(d,{data:s,innerProps:Mn({},ai(r,"multiValueLabel",{"multi-value__label":!0})),selectProps:u},t),Cn(h,{data:s,innerProps:Mn(Mn({},ai(r,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(t||"option")},c),selectProps:u}))},Ice=Dce,Oce=function(r,t){var n=r.isDisabled,s=r.isFocused,o=r.isSelected,i=r.theme,c=i.spacing,u=i.colors;return Mn({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},t?{}:{backgroundColor:o?u.primary:s?u.primary25:"transparent",color:n?u.neutral20:o?u.neutral0:"inherit",padding:"".concat(c.baseUnit*2,"px ").concat(c.baseUnit*3,"px"),":active":{backgroundColor:n?void 0:o?u.primary:u.primary50}})},Pce=function(r){var t=r.children,n=r.isDisabled,s=r.isFocused,o=r.isSelected,i=r.innerRef,c=r.innerProps;return Cn("div",Ln({},ai(r,"option",{option:!0,"option--is-disabled":n,"option--is-focused":s,"option--is-selected":o}),{ref:i,"aria-disabled":n},c),t)},Fce=Pce,Bce=function(r,t){var n=r.theme,s=n.spacing,o=n.colors;return Mn({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},t?{}:{color:o.neutral50,marginLeft:s.baseUnit/2,marginRight:s.baseUnit/2})},zce=function(r){var t=r.children,n=r.innerProps;return Cn("div",Ln({},ai(r,"placeholder",{placeholder:!0}),n),t)},$ce=zce,Uce=function(r,t){var n=r.isDisabled,s=r.theme,o=s.spacing,i=s.colors;return Mn({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t?{}:{color:n?i.neutral40:i.neutral80,marginLeft:o.baseUnit/2,marginRight:o.baseUnit/2})},Hce=function(r){var t=r.children,n=r.isDisabled,s=r.innerProps;return Cn("div",Ln({},ai(r,"singleValue",{"single-value":!0,"single-value--is-disabled":n}),s),t)},Vce=Hce,Wce={ClearIndicator:oce,Control:mce,DropdownIndicator:sce,DownChevron:VE,CrossIcon:H_,Group:wce,GroupHeading:yce,IndicatorsContainer:ece,IndicatorSeparator:cce,Input:kce,LoadingIndicator:fce,Menu:zle,MenuList:Ule,MenuPortal:Kle,LoadingMessage:qle,NoOptionsMessage:Wle,MultiValue:Ice,MultiValueContainer:Tce,MultiValueLabel:Lce,MultiValueRemove:Mce,Option:Fce,Placeholder:$ce,SelectContainer:Yle,SingleValue:Vce,ValueContainer:Jle},qce=function(r){return Mn(Mn({},Wce),r.components)},xj=Number.isNaN||function(r){return typeof r=="number"&&r!==r};function Gce(e,r){return!!(e===r||xj(e)&&xj(r))}function Kce(e,r){if(e.length!==r.length)return!1;for(var t=0;t<e.length;t++)if(!Gce(e[t],r[t]))return!1;return!0}function Xce(e,r){r===void 0&&(r=Kce);var t=null;function n(){for(var s=[],o=0;o<arguments.length;o++)s[o]=arguments[o];if(t&&t.lastThis===this&&r(s,t.lastArgs))return t.lastResult;var i=e.apply(this,s);return t={lastResult:i,lastArgs:s,lastThis:this},i}return n.clear=function(){t=null},n}var Yce={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},Zce=function(r){return Cn("span",Ln({css:Yce},r))},bj=Zce,Jce={guidance:function(r){var t=r.isSearchable,n=r.isMulti,s=r.tabSelectsValue,o=r.context,i=r.isInitialFocus;switch(o){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(s?", press Tab to select the option and exit the menu":"",".");case"input":return i?"".concat(r["aria-label"]||"Select"," is focused ").concat(t?",type to refine list":"",", press Down to open the menu, ").concat(n?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(r){var t=r.action,n=r.label,s=n===void 0?"":n,o=r.labels,i=r.isDisabled;switch(t){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(s,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(o.length>1?"s":""," ").concat(o.join(","),", selected.");case"select-option":return i?"option ".concat(s," is disabled. Select another option."):"option ".concat(s,", selected.");default:return""}},onFocus:function(r){var t=r.context,n=r.focused,s=r.options,o=r.label,i=o===void 0?"":o,c=r.selectValue,u=r.isDisabled,l=r.isSelected,d=r.isAppleDevice,h=function(g,m){return g&&g.length?"".concat(g.indexOf(m)+1," of ").concat(g.length):""};if(t==="value"&&c)return"value ".concat(i," focused, ").concat(h(c,n),".");if(t==="menu"&&d){var f=u?" disabled":"",p="".concat(l?" selected":"").concat(f);return"".concat(i).concat(p,", ").concat(h(s,n),".")}return""},onFilter:function(r){var t=r.inputValue,n=r.resultsMessage;return"".concat(n).concat(t?" for search term "+t:"",".")}},Qce=function(r){var t=r.ariaSelection,n=r.focusedOption,s=r.focusedValue,o=r.focusableOptions,i=r.isFocused,c=r.selectValue,u=r.selectProps,l=r.id,d=r.isAppleDevice,h=u.ariaLiveMessages,f=u.getOptionLabel,p=u.inputValue,v=u.isMulti,g=u.isOptionDisabled,m=u.isSearchable,b=u.menuIsOpen,y=u.options,S=u.screenReaderStatus,C=u.tabSelectsValue,L=u.isLoading,O=u["aria-label"],H=u["aria-live"],z=G.useMemo(function(){return Mn(Mn({},Jce),h||{})},[h]),q=G.useMemo(function(){var k="";if(t&&z.onChange){var _=t.option,R=t.options,j=t.removedValue,A=t.removedValues,N=t.value,V=function(Y){return Array.isArray(Y)?null:Y},M=j||_||V(N),Z=M?f(M):"",J=R||A||void 0,re=J?J.map(f):[],X=Mn({isDisabled:M&&g(M,c),label:Z,labels:re},t);k=z.onChange(X)}return k},[t,z,g,c,f]),D=G.useMemo(function(){var k="",_=n||s,R=!!(n&&c&&c.includes(n));if(_&&z.onFocus){var j={focused:_,label:f(_),isDisabled:g(_,c),isSelected:R,options:o,context:_===n?"menu":"value",selectValue:c,isAppleDevice:d};k=z.onFocus(j)}return k},[n,s,f,g,z,o,c,d]),W=G.useMemo(function(){var k="";if(b&&y.length&&!L&&z.onFilter){var _=S({count:o.length});k=z.onFilter({inputValue:p,resultsMessage:_})}return k},[o,p,b,z,y,S,L]),P=(t==null?void 0:t.action)==="initial-input-focus",I=G.useMemo(function(){var k="";if(z.guidance){var _=s?"value":b?"menu":"input";k=z.guidance({"aria-label":O,context:_,isDisabled:n&&g(n,c),isMulti:v,isSearchable:m,tabSelectsValue:C,isInitialFocus:P})}return k},[O,n,s,v,g,m,b,z,c,C,P]),U=Cn(G.Fragment,null,Cn("span",{id:"aria-selection"},q),Cn("span",{id:"aria-focused"},D),Cn("span",{id:"aria-results"},W),Cn("span",{id:"aria-guidance"},I));return Cn(G.Fragment,null,Cn(bj,{id:l},P&&U),Cn(bj,{"aria-live":H,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},i&&!P&&U))},eue=Qce,JS=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],tue=new RegExp("["+JS.map(function(e){return e.letters}).join("")+"]","g"),KE={};for(var X3=0;X3<JS.length;X3++)for(var Y3=JS[X3],Z3=0;Z3<Y3.letters.length;Z3++)KE[Y3.letters[Z3]]=Y3.base;var XE=function(r){return r.replace(tue,function(t){return KE[t]})},rue=Xce(XE),yj=function(r){return r.replace(/^\s+|\s+$/g,"")},nue=function(r){return"".concat(r.label," ").concat(r.value)},aue=function(r){return function(t,n){if(t.data.__isNew__)return!0;var s=Mn({ignoreCase:!0,ignoreAccents:!0,stringify:nue,trim:!0,matchFrom:"any"},r),o=s.ignoreCase,i=s.ignoreAccents,c=s.stringify,u=s.trim,l=s.matchFrom,d=u?yj(n):n,h=u?yj(c(t)):c(t);return o&&(d=d.toLowerCase(),h=h.toLowerCase()),i&&(d=rue(d),h=XE(h)),l==="start"?h.substr(0,d.length)===d:h.indexOf(d)>-1}},sue=["innerRef"];function iue(e){var r=e.innerRef,t=Hd(e,sue),n=Lle(t,"onExited","in","enter","exit","appear");return Cn("input",Ln({ref:r},n,{css:H0({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var oue=function(r){r.cancelable&&r.preventDefault(),r.stopPropagation()};function lue(e){var r=e.isEnabled,t=e.onBottomArrive,n=e.onBottomLeave,s=e.onTopArrive,o=e.onTopLeave,i=G.useRef(!1),c=G.useRef(!1),u=G.useRef(0),l=G.useRef(null),d=G.useCallback(function(m,b){if(l.current!==null){var y=l.current,S=y.scrollTop,C=y.scrollHeight,L=y.clientHeight,O=l.current,H=b>0,z=C-L-S,q=!1;z>b&&i.current&&(n&&n(m),i.current=!1),H&&c.current&&(o&&o(m),c.current=!1),H&&b>z?(t&&!i.current&&t(m),O.scrollTop=C,q=!0,i.current=!0):!H&&-b>S&&(s&&!c.current&&s(m),O.scrollTop=0,q=!0,c.current=!0),q&&oue(m)}},[t,n,s,o]),h=G.useCallback(function(m){d(m,m.deltaY)},[d]),f=G.useCallback(function(m){u.current=m.changedTouches[0].clientY},[]),p=G.useCallback(function(m){var b=u.current-m.changedTouches[0].clientY;d(m,b)},[d]),v=G.useCallback(function(m){if(m){var b=Ele?{passive:!1}:!1;m.addEventListener("wheel",h,b),m.addEventListener("touchstart",f,b),m.addEventListener("touchmove",p,b)}},[p,f,h]),g=G.useCallback(function(m){m&&(m.removeEventListener("wheel",h,!1),m.removeEventListener("touchstart",f,!1),m.removeEventListener("touchmove",p,!1))},[p,f,h]);return G.useEffect(function(){if(r){var m=l.current;return v(m),function(){g(m)}}},[r,v,g]),function(m){l.current=m}}var wj=["boxSizing","height","overflow","paddingRight","position"],Sj={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function _j(e){e.cancelable&&e.preventDefault()}function Aj(e){e.stopPropagation()}function Cj(){var e=this.scrollTop,r=this.scrollHeight,t=e+this.offsetHeight;e===0?this.scrollTop=1:t===r&&(this.scrollTop=e-1)}function jj(){return"ontouchstart"in window||navigator.maxTouchPoints}var kj=!!(typeof window<"u"&&window.document&&window.document.createElement),W1=0,wm={capture:!1,passive:!1};function cue(e){var r=e.isEnabled,t=e.accountForScrollbars,n=t===void 0?!0:t,s=G.useRef({}),o=G.useRef(null),i=G.useCallback(function(u){if(kj){var l=document.body,d=l&&l.style;if(n&&wj.forEach(function(v){var g=d&&d[v];s.current[v]=g}),n&&W1<1){var h=parseInt(s.current.paddingRight,10)||0,f=document.body?document.body.clientWidth:0,p=window.innerWidth-f+h||0;Object.keys(Sj).forEach(function(v){var g=Sj[v];d&&(d[v]=g)}),d&&(d.paddingRight="".concat(p,"px"))}l&&jj()&&(l.addEventListener("touchmove",_j,wm),u&&(u.addEventListener("touchstart",Cj,wm),u.addEventListener("touchmove",Aj,wm))),W1+=1}},[n]),c=G.useCallback(function(u){if(kj){var l=document.body,d=l&&l.style;W1=Math.max(W1-1,0),n&&W1<1&&wj.forEach(function(h){var f=s.current[h];d&&(d[h]=f)}),l&&jj()&&(l.removeEventListener("touchmove",_j,wm),u&&(u.removeEventListener("touchstart",Cj,wm),u.removeEventListener("touchmove",Aj,wm)))}},[n]);return G.useEffect(function(){if(r){var u=o.current;return i(u),function(){c(u)}}},[r,i,c]),function(u){o.current=u}}var uue=function(r){var t=r.target;return t.ownerDocument.activeElement&&t.ownerDocument.activeElement.blur()},due={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function fue(e){var r=e.children,t=e.lockEnabled,n=e.captureEnabled,s=n===void 0?!0:n,o=e.onBottomArrive,i=e.onBottomLeave,c=e.onTopArrive,u=e.onTopLeave,l=lue({isEnabled:s,onBottomArrive:o,onBottomLeave:i,onTopArrive:c,onTopLeave:u}),d=cue({isEnabled:t}),h=function(p){l(p),d(p)};return Cn(G.Fragment,null,t&&Cn("div",{onClick:uue,css:due}),r(h))}var hue={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},pue=function(r){var t=r.name,n=r.onFocus;return Cn("input",{required:!0,name:t,tabIndex:-1,"aria-hidden":"true",onFocus:n,css:hue,value:"",onChange:function(){}})},mue=pue;function V_(e){var r;return typeof window<"u"&&window.navigator!=null?e.test(((r=window.navigator.userAgentData)===null||r===void 0?void 0:r.platform)||window.navigator.platform):!1}function gue(){return V_(/^iPhone/i)}function YE(){return V_(/^Mac/i)}function vue(){return V_(/^iPad/i)||YE()&&navigator.maxTouchPoints>1}function xue(){return gue()||vue()}function bue(){return YE()||xue()}var yue=function(r){return r.label},wue=function(r){return r.label},Sue=function(r){return r.value},_ue=function(r){return!!r.isDisabled},Aue={clearIndicator:ice,container:Xle,control:hce,dropdownIndicator:ace,group:vce,groupHeading:bce,indicatorsContainer:Qle,indicatorSeparator:lce,input:_ce,loadingIndicator:dce,loadingMessage:Vle,menu:Ple,menuList:$le,menuPortal:Gle,multiValue:Rce,multiValueLabel:Ece,multiValueRemove:Nce,noOptionsMessage:Hle,option:Oce,placeholder:Bce,singleValue:Uce,valueContainer:Zle},Cue={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},jue=4,ZE=4,kue=38,Rue=ZE*2,Eue={baseUnit:ZE,controlHeight:kue,menuGutter:Rue},J3={borderRadius:jue,colors:Cue,spacing:Eue},Nue={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:gj(),captureMenuScroll:!gj(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:aue(),formatGroupLabel:yue,getOptionLabel:wue,getOptionValue:Sue,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:_ue,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!kle(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(r){var t=r.count;return"".concat(t," result").concat(t!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function Rj(e,r,t,n){var s=eN(e,r,t),o=tN(e,r,t),i=QE(e,r),c=q2(e,r);return{type:"option",data:r,isDisabled:s,isSelected:o,label:i,value:c,index:n}}function r2(e,r){return e.options.map(function(t,n){if("options"in t){var s=t.options.map(function(i,c){return Rj(e,i,r,c)}).filter(function(i){return Nj(e,i)});return s.length>0?{type:"group",data:t,options:s,index:n}:void 0}var o=Rj(e,t,r,n);return Nj(e,o)?o:void 0}).filter(Nle)}function JE(e){return e.reduce(function(r,t){return t.type==="group"?r.push.apply(r,B_(t.options.map(function(n){return n.data}))):r.push(t.data),r},[])}function Ej(e,r){return e.reduce(function(t,n){return n.type==="group"?t.push.apply(t,B_(n.options.map(function(s){return{data:s.data,id:"".concat(r,"-").concat(n.index,"-").concat(s.index)}}))):t.push({data:n.data,id:"".concat(r,"-").concat(n.index)}),t},[])}function Tue(e,r){return JE(r2(e,r))}function Nj(e,r){var t=e.inputValue,n=t===void 0?"":t,s=r.data,o=r.isSelected,i=r.label,c=r.value;return(!nN(e)||!o)&&rN(e,{label:i,value:c,data:s},n)}function Lue(e,r){var t=e.focusedValue,n=e.selectValue,s=n.indexOf(t);if(s>-1){var o=r.indexOf(t);if(o>-1)return t;if(s<r.length)return r[s]}return null}function Mue(e,r){var t=e.focusedOption;return t&&r.indexOf(t)>-1?t:r[0]}var Q3=function(r,t){var n,s=(n=r.find(function(o){return o.data===t}))===null||n===void 0?void 0:n.id;return s||null},QE=function(r,t){return r.getOptionLabel(t)},q2=function(r,t){return r.getOptionValue(t)};function eN(e,r,t){return typeof e.isOptionDisabled=="function"?e.isOptionDisabled(r,t):!1}function tN(e,r,t){if(t.indexOf(r)>-1)return!0;if(typeof e.isOptionSelected=="function")return e.isOptionSelected(r,t);var n=q2(e,r);return t.some(function(s){return q2(e,s)===n})}function rN(e,r,t){return e.filterOption?e.filterOption(r,t):!0}var nN=function(r){var t=r.hideSelectedOptions,n=r.isMulti;return t===void 0?n:t},Due=1,aN=function(e){Joe(t,e);var r=ele(t);function t(n){var s;if(Yoe(this,t),s=r.call(this,n),s.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:"",isAppleDevice:!1},s.blockOptionHover=!1,s.isComposing=!1,s.commonProps=void 0,s.initialTouchX=0,s.initialTouchY=0,s.openAfterFocus=!1,s.scrollToFocusedOptionOnUpdate=!1,s.userIsDragging=void 0,s.controlRef=null,s.getControlRef=function(u){s.controlRef=u},s.focusedOptionRef=null,s.getFocusedOptionRef=function(u){s.focusedOptionRef=u},s.menuListRef=null,s.getMenuListRef=function(u){s.menuListRef=u},s.inputRef=null,s.getInputRef=function(u){s.inputRef=u},s.focus=s.focusInput,s.blur=s.blurInput,s.onChange=function(u,l){var d=s.props,h=d.onChange,f=d.name;l.name=f,s.ariaOnChange(u,l),h(u,l)},s.setValue=function(u,l,d){var h=s.props,f=h.closeMenuOnSelect,p=h.isMulti,v=h.inputValue;s.onInputChange("",{action:"set-value",prevInputValue:v}),f&&(s.setState({inputIsHiddenAfterUpdate:!p}),s.onMenuClose()),s.setState({clearFocusValueOnUpdate:!0}),s.onChange(u,{action:l,option:d})},s.selectOption=function(u){var l=s.props,d=l.blurInputOnSelect,h=l.isMulti,f=l.name,p=s.state.selectValue,v=h&&s.isOptionSelected(u,p),g=s.isOptionDisabled(u,p);if(v){var m=s.getOptionValue(u);s.setValue(p.filter(function(b){return s.getOptionValue(b)!==m}),"deselect-option",u)}else if(!g)h?s.setValue([].concat(B_(p),[u]),"select-option",u):s.setValue(u,"select-option");else{s.ariaOnChange(u,{action:"select-option",option:u,name:f});return}d&&s.blurInput()},s.removeValue=function(u){var l=s.props.isMulti,d=s.state.selectValue,h=s.getOptionValue(u),f=d.filter(function(v){return s.getOptionValue(v)!==h}),p=Uy(l,f,f[0]||null);s.onChange(p,{action:"remove-value",removedValue:u}),s.focusInput()},s.clearValue=function(){var u=s.state.selectValue;s.onChange(Uy(s.props.isMulti,[],null),{action:"clear",removedValues:u})},s.popValue=function(){var u=s.props.isMulti,l=s.state.selectValue,d=l[l.length-1],h=l.slice(0,l.length-1),f=Uy(u,h,h[0]||null);d&&s.onChange(f,{action:"pop-value",removedValue:d})},s.getFocusedOptionId=function(u){return Q3(s.state.focusableOptionsWithIds,u)},s.getFocusableOptionsWithIds=function(){return Ej(r2(s.props,s.state.selectValue),s.getElementId("option"))},s.getValue=function(){return s.state.selectValue},s.cx=function(){for(var u=arguments.length,l=new Array(u),d=0;d<u;d++)l[d]=arguments[d];return Sle.apply(void 0,[s.props.classNamePrefix].concat(l))},s.getOptionLabel=function(u){return QE(s.props,u)},s.getOptionValue=function(u){return q2(s.props,u)},s.getStyles=function(u,l){var d=s.props.unstyled,h=Aue[u](l,d);h.boxSizing="border-box";var f=s.props.styles[u];return f?f(h,l):h},s.getClassNames=function(u,l){var d,h;return(d=(h=s.props.classNames)[u])===null||d===void 0?void 0:d.call(h,l)},s.getElementId=function(u){return"".concat(s.state.instancePrefix,"-").concat(u)},s.getComponents=function(){return qce(s.props)},s.buildCategorizedOptions=function(){return r2(s.props,s.state.selectValue)},s.getCategorizedOptions=function(){return s.props.menuIsOpen?s.buildCategorizedOptions():[]},s.buildFocusableOptions=function(){return JE(s.buildCategorizedOptions())},s.getFocusableOptions=function(){return s.props.menuIsOpen?s.buildFocusableOptions():[]},s.ariaOnChange=function(u,l){s.setState({ariaSelection:Mn({value:u},l)})},s.onMenuMouseDown=function(u){u.button===0&&(u.stopPropagation(),u.preventDefault(),s.focusInput())},s.onMenuMouseMove=function(u){s.blockOptionHover=!1},s.onControlMouseDown=function(u){if(!u.defaultPrevented){var l=s.props.openMenuOnClick;s.state.isFocused?s.props.menuIsOpen?u.target.tagName!=="INPUT"&&u.target.tagName!=="TEXTAREA"&&s.onMenuClose():l&&s.openMenu("first"):(l&&(s.openAfterFocus=!0),s.focusInput()),u.target.tagName!=="INPUT"&&u.target.tagName!=="TEXTAREA"&&u.preventDefault()}},s.onDropdownIndicatorMouseDown=function(u){if(!(u&&u.type==="mousedown"&&u.button!==0)&&!s.props.isDisabled){var l=s.props,d=l.isMulti,h=l.menuIsOpen;s.focusInput(),h?(s.setState({inputIsHiddenAfterUpdate:!d}),s.onMenuClose()):s.openMenu("first"),u.preventDefault()}},s.onClearIndicatorMouseDown=function(u){u&&u.type==="mousedown"&&u.button!==0||(s.clearValue(),u.preventDefault(),s.openAfterFocus=!1,u.type==="touchend"?s.focusInput():setTimeout(function(){return s.focusInput()}))},s.onScroll=function(u){typeof s.props.closeMenuOnScroll=="boolean"?u.target instanceof HTMLElement&&Hw(u.target)&&s.props.onMenuClose():typeof s.props.closeMenuOnScroll=="function"&&s.props.closeMenuOnScroll(u)&&s.props.onMenuClose()},s.onCompositionStart=function(){s.isComposing=!0},s.onCompositionEnd=function(){s.isComposing=!1},s.onTouchStart=function(u){var l=u.touches,d=l&&l.item(0);d&&(s.initialTouchX=d.clientX,s.initialTouchY=d.clientY,s.userIsDragging=!1)},s.onTouchMove=function(u){var l=u.touches,d=l&&l.item(0);if(d){var h=Math.abs(d.clientX-s.initialTouchX),f=Math.abs(d.clientY-s.initialTouchY),p=5;s.userIsDragging=h>p||f>p}},s.onTouchEnd=function(u){s.userIsDragging||(s.controlRef&&!s.controlRef.contains(u.target)&&s.menuListRef&&!s.menuListRef.contains(u.target)&&s.blurInput(),s.initialTouchX=0,s.initialTouchY=0)},s.onControlTouchEnd=function(u){s.userIsDragging||s.onControlMouseDown(u)},s.onClearIndicatorTouchEnd=function(u){s.userIsDragging||s.onClearIndicatorMouseDown(u)},s.onDropdownIndicatorTouchEnd=function(u){s.userIsDragging||s.onDropdownIndicatorMouseDown(u)},s.handleInputChange=function(u){var l=s.props.inputValue,d=u.currentTarget.value;s.setState({inputIsHiddenAfterUpdate:!1}),s.onInputChange(d,{action:"input-change",prevInputValue:l}),s.props.menuIsOpen||s.onMenuOpen()},s.onInputFocus=function(u){s.props.onFocus&&s.props.onFocus(u),s.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(s.openAfterFocus||s.props.openMenuOnFocus)&&s.openMenu("first"),s.openAfterFocus=!1},s.onInputBlur=function(u){var l=s.props.inputValue;if(s.menuListRef&&s.menuListRef.contains(document.activeElement)){s.inputRef.focus();return}s.props.onBlur&&s.props.onBlur(u),s.onInputChange("",{action:"input-blur",prevInputValue:l}),s.onMenuClose(),s.setState({focusedValue:null,isFocused:!1})},s.onOptionHover=function(u){if(!(s.blockOptionHover||s.state.focusedOption===u)){var l=s.getFocusableOptions(),d=l.indexOf(u);s.setState({focusedOption:u,focusedOptionId:d>-1?s.getFocusedOptionId(u):null})}},s.shouldHideSelectedOptions=function(){return nN(s.props)},s.onValueInputFocus=function(u){u.preventDefault(),u.stopPropagation(),s.focus()},s.onKeyDown=function(u){var l=s.props,d=l.isMulti,h=l.backspaceRemovesValue,f=l.escapeClearsValue,p=l.inputValue,v=l.isClearable,g=l.isDisabled,m=l.menuIsOpen,b=l.onKeyDown,y=l.tabSelectsValue,S=l.openMenuOnFocus,C=s.state,L=C.focusedOption,O=C.focusedValue,H=C.selectValue;if(!g&&!(typeof b=="function"&&(b(u),u.defaultPrevented))){switch(s.blockOptionHover=!0,u.key){case"ArrowLeft":if(!d||p)return;s.focusValue("previous");break;case"ArrowRight":if(!d||p)return;s.focusValue("next");break;case"Delete":case"Backspace":if(p)return;if(O)s.removeValue(O);else{if(!h)return;d?s.popValue():v&&s.clearValue()}break;case"Tab":if(s.isComposing||u.shiftKey||!m||!y||!L||S&&s.isOptionSelected(L,H))return;s.selectOption(L);break;case"Enter":if(u.keyCode===229)break;if(m){if(!L||s.isComposing)return;s.selectOption(L);break}return;case"Escape":m?(s.setState({inputIsHiddenAfterUpdate:!1}),s.onInputChange("",{action:"menu-close",prevInputValue:p}),s.onMenuClose()):v&&f&&s.clearValue();break;case" ":if(p)return;if(!m){s.openMenu("first");break}if(!L)return;s.selectOption(L);break;case"ArrowUp":m?s.focusOption("up"):s.openMenu("last");break;case"ArrowDown":m?s.focusOption("down"):s.openMenu("first");break;case"PageUp":if(!m)return;s.focusOption("pageup");break;case"PageDown":if(!m)return;s.focusOption("pagedown");break;case"Home":if(!m)return;s.focusOption("first");break;case"End":if(!m)return;s.focusOption("last");break;default:return}u.preventDefault()}},s.state.instancePrefix="react-select-"+(s.props.instanceId||++Due),s.state.selectValue=pj(n.value),n.menuIsOpen&&s.state.selectValue.length){var o=s.getFocusableOptionsWithIds(),i=s.buildFocusableOptions(),c=i.indexOf(s.state.selectValue[0]);s.state.focusableOptionsWithIds=o,s.state.focusedOption=i[c],s.state.focusedOptionId=Q3(o,i[c])}return s}return Zoe(t,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&mj(this.menuListRef,this.focusedOptionRef),bue()&&this.setState({isAppleDevice:!0})}},{key:"componentDidUpdate",value:function(s){var o=this.props,i=o.isDisabled,c=o.menuIsOpen,u=this.state.isFocused;(u&&!i&&s.isDisabled||u&&c&&!s.menuIsOpen)&&this.focusInput(),u&&i&&!s.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!u&&!i&&s.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(mj(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(s,o){this.props.onInputChange(s,o)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(s){var o=this,i=this.state,c=i.selectValue,u=i.isFocused,l=this.buildFocusableOptions(),d=s==="first"?0:l.length-1;if(!this.props.isMulti){var h=l.indexOf(c[0]);h>-1&&(d=h)}this.scrollToFocusedOptionOnUpdate=!(u&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:l[d],focusedOptionId:this.getFocusedOptionId(l[d])},function(){return o.onMenuOpen()})}},{key:"focusValue",value:function(s){var o=this.state,i=o.selectValue,c=o.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var u=i.indexOf(c);c||(u=-1);var l=i.length-1,d=-1;if(i.length){switch(s){case"previous":u===0?d=0:u===-1?d=l:d=u-1;break;case"next":u>-1&&u<l&&(d=u+1);break}this.setState({inputIsHidden:d!==-1,focusedValue:i[d]})}}}},{key:"focusOption",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",o=this.props.pageSize,i=this.state.focusedOption,c=this.getFocusableOptions();if(c.length){var u=0,l=c.indexOf(i);i||(l=-1),s==="up"?u=l>0?l-1:c.length-1:s==="down"?u=(l+1)%c.length:s==="pageup"?(u=l-o,u<0&&(u=0)):s==="pagedown"?(u=l+o,u>c.length-1&&(u=c.length-1)):s==="last"&&(u=c.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:c[u],focusedValue:null,focusedOptionId:this.getFocusedOptionId(c[u])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(J3):Mn(Mn({},J3),this.props.theme):J3}},{key:"getCommonProps",value:function(){var s=this.clearValue,o=this.cx,i=this.getStyles,c=this.getClassNames,u=this.getValue,l=this.selectOption,d=this.setValue,h=this.props,f=h.isMulti,p=h.isRtl,v=h.options,g=this.hasValue();return{clearValue:s,cx:o,getStyles:i,getClassNames:c,getValue:u,hasValue:g,isMulti:f,isRtl:p,options:v,selectOption:l,selectProps:h,setValue:d,theme:this.getTheme()}}},{key:"hasValue",value:function(){var s=this.state.selectValue;return s.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var s=this.props,o=s.isClearable,i=s.isMulti;return o===void 0?i:o}},{key:"isOptionDisabled",value:function(s,o){return eN(this.props,s,o)}},{key:"isOptionSelected",value:function(s,o){return tN(this.props,s,o)}},{key:"filterOption",value:function(s,o){return rN(this.props,s,o)}},{key:"formatOptionLabel",value:function(s,o){if(typeof this.props.formatOptionLabel=="function"){var i=this.props.inputValue,c=this.state.selectValue;return this.props.formatOptionLabel(s,{context:o,inputValue:i,selectValue:c})}else return this.getOptionLabel(s)}},{key:"formatGroupLabel",value:function(s){return this.props.formatGroupLabel(s)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var s=this.props,o=s.isDisabled,i=s.isSearchable,c=s.inputId,u=s.inputValue,l=s.tabIndex,d=s.form,h=s.menuIsOpen,f=s.required,p=this.getComponents(),v=p.Input,g=this.state,m=g.inputIsHidden,b=g.ariaSelection,y=this.commonProps,S=c||this.getElementId("input"),C=Mn(Mn(Mn({"aria-autocomplete":"list","aria-expanded":h,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":f,role:"combobox","aria-activedescendant":this.state.isAppleDevice?void 0:this.state.focusedOptionId||""},h&&{"aria-controls":this.getElementId("listbox")}),!i&&{"aria-readonly":!0}),this.hasValue()?(b==null?void 0:b.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return i?G.createElement(v,Ln({},y,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:S,innerRef:this.getInputRef,isDisabled:o,isHidden:m,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:l,form:d,type:"text",value:u},C)):G.createElement(iue,Ln({id:S,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:V2,onFocus:this.onInputFocus,disabled:o,tabIndex:l,inputMode:"none",form:d,value:""},C))}},{key:"renderPlaceholderOrValue",value:function(){var s=this,o=this.getComponents(),i=o.MultiValue,c=o.MultiValueContainer,u=o.MultiValueLabel,l=o.MultiValueRemove,d=o.SingleValue,h=o.Placeholder,f=this.commonProps,p=this.props,v=p.controlShouldRenderValue,g=p.isDisabled,m=p.isMulti,b=p.inputValue,y=p.placeholder,S=this.state,C=S.selectValue,L=S.focusedValue,O=S.isFocused;if(!this.hasValue()||!v)return b?null:G.createElement(h,Ln({},f,{key:"placeholder",isDisabled:g,isFocused:O,innerProps:{id:this.getElementId("placeholder")}}),y);if(m)return C.map(function(z,q){var D=z===L,W="".concat(s.getOptionLabel(z),"-").concat(s.getOptionValue(z));return G.createElement(i,Ln({},f,{components:{Container:c,Label:u,Remove:l},isFocused:D,isDisabled:g,key:W,index:q,removeProps:{onClick:function(){return s.removeValue(z)},onTouchEnd:function(){return s.removeValue(z)},onMouseDown:function(I){I.preventDefault()}},data:z}),s.formatOptionLabel(z,"value"))});if(b)return null;var H=C[0];return G.createElement(d,Ln({},f,{data:H,isDisabled:g}),this.formatOptionLabel(H,"value"))}},{key:"renderClearIndicator",value:function(){var s=this.getComponents(),o=s.ClearIndicator,i=this.commonProps,c=this.props,u=c.isDisabled,l=c.isLoading,d=this.state.isFocused;if(!this.isClearable()||!o||u||!this.hasValue()||l)return null;var h={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return G.createElement(o,Ln({},i,{innerProps:h,isFocused:d}))}},{key:"renderLoadingIndicator",value:function(){var s=this.getComponents(),o=s.LoadingIndicator,i=this.commonProps,c=this.props,u=c.isDisabled,l=c.isLoading,d=this.state.isFocused;if(!o||!l)return null;var h={"aria-hidden":"true"};return G.createElement(o,Ln({},i,{innerProps:h,isDisabled:u,isFocused:d}))}},{key:"renderIndicatorSeparator",value:function(){var s=this.getComponents(),o=s.DropdownIndicator,i=s.IndicatorSeparator;if(!o||!i)return null;var c=this.commonProps,u=this.props.isDisabled,l=this.state.isFocused;return G.createElement(i,Ln({},c,{isDisabled:u,isFocused:l}))}},{key:"renderDropdownIndicator",value:function(){var s=this.getComponents(),o=s.DropdownIndicator;if(!o)return null;var i=this.commonProps,c=this.props.isDisabled,u=this.state.isFocused,l={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return G.createElement(o,Ln({},i,{innerProps:l,isDisabled:c,isFocused:u}))}},{key:"renderMenu",value:function(){var s=this,o=this.getComponents(),i=o.Group,c=o.GroupHeading,u=o.Menu,l=o.MenuList,d=o.MenuPortal,h=o.LoadingMessage,f=o.NoOptionsMessage,p=o.Option,v=this.commonProps,g=this.state.focusedOption,m=this.props,b=m.captureMenuScroll,y=m.inputValue,S=m.isLoading,C=m.loadingMessage,L=m.minMenuHeight,O=m.maxMenuHeight,H=m.menuIsOpen,z=m.menuPlacement,q=m.menuPosition,D=m.menuPortalTarget,W=m.menuShouldBlockScroll,P=m.menuShouldScrollIntoView,I=m.noOptionsMessage,U=m.onMenuScrollToTop,k=m.onMenuScrollToBottom;if(!H)return null;var _=function(Z,J){var re=Z.type,X=Z.data,ne=Z.isDisabled,Y=Z.isSelected,K=Z.label,ee=Z.value,ue=g===X,se=ne?void 0:function(){return s.onOptionHover(X)},ce=ne?void 0:function(){return s.selectOption(X)},fe="".concat(s.getElementId("option"),"-").concat(J),ve={id:fe,onClick:ce,onMouseMove:se,onMouseOver:se,tabIndex:-1,role:"option","aria-selected":s.state.isAppleDevice?void 0:Y};return G.createElement(p,Ln({},v,{innerProps:ve,data:X,isDisabled:ne,isSelected:Y,key:fe,label:K,type:re,value:ee,isFocused:ue,innerRef:ue?s.getFocusedOptionRef:void 0}),s.formatOptionLabel(Z.data,"menu"))},R;if(this.hasOptions())R=this.getCategorizedOptions().map(function(M){if(M.type==="group"){var Z=M.data,J=M.options,re=M.index,X="".concat(s.getElementId("group"),"-").concat(re),ne="".concat(X,"-heading");return G.createElement(i,Ln({},v,{key:X,data:Z,options:J,Heading:c,headingProps:{id:ne,data:M.data},label:s.formatGroupLabel(M.data)}),M.options.map(function(Y){return _(Y,"".concat(re,"-").concat(Y.index))}))}else if(M.type==="option")return _(M,"".concat(M.index))});else if(S){var j=C({inputValue:y});if(j===null)return null;R=G.createElement(h,v,j)}else{var A=I({inputValue:y});if(A===null)return null;R=G.createElement(f,v,A)}var N={minMenuHeight:L,maxMenuHeight:O,menuPlacement:z,menuPosition:q,menuShouldScrollIntoView:P},V=G.createElement(Fle,Ln({},v,N),function(M){var Z=M.ref,J=M.placerProps,re=J.placement,X=J.maxHeight;return G.createElement(u,Ln({},v,N,{innerRef:Z,innerProps:{onMouseDown:s.onMenuMouseDown,onMouseMove:s.onMenuMouseMove},isLoading:S,placement:re}),G.createElement(fue,{captureEnabled:b,onTopArrive:U,onBottomArrive:k,lockEnabled:W},function(ne){return G.createElement(l,Ln({},v,{innerRef:function(K){s.getMenuListRef(K),ne(K)},innerProps:{role:"listbox","aria-multiselectable":v.isMulti,id:s.getElementId("listbox")},isLoading:S,maxHeight:X,focusedOption:g}),R)}))});return D||q==="fixed"?G.createElement(d,Ln({},v,{appendTo:D,controlElement:this.controlRef,menuPlacement:z,menuPosition:q}),V):V}},{key:"renderFormField",value:function(){var s=this,o=this.props,i=o.delimiter,c=o.isDisabled,u=o.isMulti,l=o.name,d=o.required,h=this.state.selectValue;if(d&&!this.hasValue()&&!c)return G.createElement(mue,{name:l,onFocus:this.onValueInputFocus});if(!(!l||c))if(u)if(i){var f=h.map(function(g){return s.getOptionValue(g)}).join(i);return G.createElement("input",{name:l,type:"hidden",value:f})}else{var p=h.length>0?h.map(function(g,m){return G.createElement("input",{key:"i-".concat(m),name:l,type:"hidden",value:s.getOptionValue(g)})}):G.createElement("input",{name:l,type:"hidden",value:""});return G.createElement("div",null,p)}else{var v=h[0]?this.getOptionValue(h[0]):"";return G.createElement("input",{name:l,type:"hidden",value:v})}}},{key:"renderLiveRegion",value:function(){var s=this.commonProps,o=this.state,i=o.ariaSelection,c=o.focusedOption,u=o.focusedValue,l=o.isFocused,d=o.selectValue,h=this.getFocusableOptions();return G.createElement(eue,Ln({},s,{id:this.getElementId("live-region"),ariaSelection:i,focusedOption:c,focusedValue:u,isFocused:l,selectValue:d,focusableOptions:h,isAppleDevice:this.state.isAppleDevice}))}},{key:"render",value:function(){var s=this.getComponents(),o=s.Control,i=s.IndicatorsContainer,c=s.SelectContainer,u=s.ValueContainer,l=this.props,d=l.className,h=l.id,f=l.isDisabled,p=l.menuIsOpen,v=this.state.isFocused,g=this.commonProps=this.getCommonProps();return G.createElement(c,Ln({},g,{className:d,innerProps:{id:h,onKeyDown:this.onKeyDown},isDisabled:f,isFocused:v}),this.renderLiveRegion(),G.createElement(o,Ln({},g,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:f,isFocused:v,menuIsOpen:p}),G.createElement(u,Ln({},g,{isDisabled:f}),this.renderPlaceholderOrValue(),this.renderInput()),G.createElement(i,Ln({},g,{isDisabled:f}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(s,o){var i=o.prevProps,c=o.clearFocusValueOnUpdate,u=o.inputIsHiddenAfterUpdate,l=o.ariaSelection,d=o.isFocused,h=o.prevWasFocused,f=o.instancePrefix,p=s.options,v=s.value,g=s.menuIsOpen,m=s.inputValue,b=s.isMulti,y=pj(v),S={};if(i&&(v!==i.value||p!==i.options||g!==i.menuIsOpen||m!==i.inputValue)){var C=g?Tue(s,y):[],L=g?Ej(r2(s,y),"".concat(f,"-option")):[],O=c?Lue(o,y):null,H=Mue(o,C),z=Q3(L,H);S={selectValue:y,focusedOption:H,focusedOptionId:z,focusableOptionsWithIds:L,focusedValue:O,clearFocusValueOnUpdate:!1}}var q=u!=null&&s!==i?{inputIsHidden:u,inputIsHiddenAfterUpdate:void 0}:{},D=l,W=d&&h;return d&&!W&&(D={value:Uy(b,y,y[0]||null),options:y,action:"initial-input-focus"},W=!h),(l==null?void 0:l.action)==="initial-input-focus"&&(D=null),Mn(Mn(Mn({},S),q),{},{prevProps:s,ariaSelection:D,prevWasFocused:W})}}]),t}(G.Component);aN.defaultProps=Nue;var Iue=G.forwardRef(function(e,r){var t=Xoe(e);return G.createElement(aN,Ln({ref:r},t))}),q1=Iue;const Oue=({isOpen:e,onClose:r,onAddLeadSubmit:t,leadData:n,products:s=[],assignedToOptions:o=[]})=>{const[i,c]=G.useState({business:"",prefix:"Mr.",firstName:"",lastName:"",designation:"",mobile:"",email:"",website:"",addressLine1:"",addressLine2:"",country:"",city:"",state:"",gstin:"",source:"",since:"",requirement:"",category:"",product:"",potential:"",assignedTo:"",stage:"",notes:"",tags:""}),[u,l]=G.useState({}),[d,h]=G.useState([]),[f,p]=G.useState([]),[v,g]=G.useState("");G.useEffect(()=>{if(n){let N="Mr.",V="",M="";const Z=n.contact||n.name||"";if(Z){const X=Z.split(" ");["Mr.","Ms.","Mrs."].includes(X[0])?(N=X[0],V=X[1]||"",M=X.slice(2).join(" ")):(V=X[0]||"",M=X.slice(1).join(" "))}let J="";if(n.assignedTo)if(typeof n.assignedTo=="number")J=n.assignedTo;else if(typeof n.assignedTo=="string"){const X=q.find(ne=>ne.name===n.assignedTo);J=X?X.id:""}else typeof n.assignedTo=="object"&&n.assignedTo!==null&&(J=n.assignedTo.id||"");else n.assigned_to_id&&(J=n.assigned_to_id);let re="";if(n.product)if(typeof n.product=="number"||typeof n.product=="string"){const X=f.find(ne=>ne.ID===n.product||ne.id===n.product||ne.Name===n.product||ne.name===n.product);re=X?X.ID||X.id:n.product}else typeof n.product=="object"&&n.product!==null&&(re=n.product.ID||n.product.id||"");else n.product_id&&(re=n.product_id);c({business:n.business||"",prefix:N,firstName:V,lastName:M,designation:n.designation||"",mobile:n.mobile||"",email:n.email||"",website:n.website||"",addressLine1:n.addressLine1||n.AddressLine1||n.addressLine1||"",addressLine2:n.addressLine2||n.AddressLine2||n.addressLine2||"",country:n.country||"",city:n.city||"",state:n.state||"",gstin:n.gstin||"",source:n.source||"",since:n.since||"",requirement:n.requirements||n.requirement||"",category:n.category||"",product:re,potential:n.potential||"",assignedTo:J,stage:n.stage||"",notes:n.notes||"",tags:n.tags||n.Tags||""})}else c({business:"",prefix:"Mr.",firstName:"",lastName:"",designation:"",mobile:"",email:"",website:"",addressLine1:"",addressLine2:"",country:"",city:"",state:"",gstin:"",source:"",since:"",requirement:"",category:"",product:"",potential:"",assignedTo:"",stage:"",notes:"",tags:""})},[n,e,f]);const m=N=>{const{name:V,value:M}=N.target;let Z=M;V==="mobile"&&(Z=M.replace(/[^0-9]/g,"").slice(0,10)),c(J=>({...J,[V]:Z})),l(J=>{const re={...J};if(V==="firstName"||V==="lastName"){const X=V==="firstName"?Z:i.firstName,ne=V==="lastName"?Z:i.lastName;return String(X).trim()&&String(ne).trim()&&delete re.name,re}return V==="mobile"?(/^[0-9]{10}$/.test(Z)&&delete re.mobile,re):V==="email"?(/\S+@\S+\.\S+/.test(Z)&&delete re.email,re):V==="business"?(String(Z).trim()&&delete re.business,re):(re[V]&&String(Z).trim()&&delete re[V],re)})},b=()=>{const N={};return i.business.trim()||(N.business="Business is required"),(!i.firstName.trim()||!i.lastName.trim())&&(N.name="Full name is required"),i.mobile.trim()?/^[0-9]{10}$/.test(i.mobile)||(N.mobile="Enter a valid 10-digit mobile number"):N.mobile="Mobile number is required",i.email.trim()?/\S+@\S+\.\S+/.test(i.email)||(N.email="Enter a valid email address"):N.email="Email is required",!i.assignedTo||!String(i.assignedTo).trim()?N.assignedTo="Assignee is required":q.some(M=>String(M.id)===String(i.assignedTo)||M.name&&M.name.toLowerCase()===String(i.assignedTo).toLowerCase())||(N.assignedTo="Please select a valid assignee"),!i.product||!String(i.product).trim()?N.product="Product is required":f.some(M=>String(M.ID)===String(i.product)||String(M.id)===String(i.product)||M.Name&&M.Name.toLowerCase()===String(i.product).toLowerCase()||M.name&&M.name.toLowerCase()===String(i.product).toLowerCase())||(N.product="Please select a valid product"),l(N),Object.keys(N).length===0},y=async()=>{try{const V=await(await fetch(`${Je}/api/leads`)).json();h(V.data||[])}catch{}},S=async()=>{try{const V=await(await fetch(`${Je}/api/products?page=1&limit=1000`)).json();p(V.data||[])}catch{p([])}};G.useEffect(()=>{y(),Array.isArray(s)&&s.length>0?p(s):S()},[]);const C=async N=>{if(N.preventDefault(),g(""),b())try{const V=`${i.prefix} ${i.firstName} ${i.lastName}`.trim();let M;if(i.assignedTo&&i.assignedTo!==""){const K=Number(i.assignedTo);if(!isNaN(K)&&q.some(ee=>Number(ee.id)===K))M=K;else{const ee=q.find(ue=>ue.name&&ue.name.toLowerCase()===String(i.assignedTo).toLowerCase());ee&&(M=ee.id)}}let Z,J="";if(i.product&&i.product!==""){const K=Number(i.product);if(isNaN(K)){const ee=f.find(ue=>String(ue.ID)===String(i.product)||String(ue.id)===String(i.product)||ue.Name&&ue.Name.toLowerCase()===String(i.product).toLowerCase()||ue.name&&ue.name.toLowerCase()===String(i.product).toLowerCase());ee&&(Z=ee.ID||ee.id,J=ee.Name||ee.name||"")}else{Z=K;const ee=f.find(ue=>ue.ID===K||ue.id===K);J=ee&&(ee.Name||ee.name)||""}}let re=parseFloat(i.potential);isNaN(re)&&(re=0);let X={business:i.business,contact:V,name:V,designation:i.designation,mobile:i.mobile,email:i.email,city:i.city,state:i.state,country:i.country,source:i.source,stage:i.stage,potential:re,since:i.since?new Date(i.since).toISOString():new Date().toISOString(),gstin:i.gstin,website:i.website,requirements:i.requirement,notes:i.notes,addressLine1:i.addressLine1,addressLine2:i.addressLine2,category:i.category,tags:i.tags};if(M!==void 0&&(X.assigned_to_id=M),Z!==void 0&&(X.product_id=Z),J&&(X.productName=J),Object.keys(X).forEach(K=>{(X[K]===""||X[K]===void 0||X[K]===null)&&delete X[K]}),n&&(typeof n.id!="number"||String(n.id).startsWith("imported_")))try{n.createdAt&&(X.created_at=n.createdAt),n.updatedAt&&(X.updated_at=n.updatedAt),X.name=X.name||X.contact||`${i.firstName} ${i.lastName}`.trim(),Object.keys(X).forEach(ee=>{(X[ee]===""||X[ee]===void 0||X[ee]===null)&&delete X[ee]});const K=await fetch(`${Je}/api/leads`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(X)});if(K&&K.ok){const ee=await K.json().catch(()=>null);try{const ue=JSON.parse(localStorage.getItem("starredLeads")||"{}");ue&&n.id&&ue[n.id]&&(ee&&ee.id&&(ue[ee.id]=!0),delete ue[n.id],localStorage.setItem("starredLeads",JSON.stringify(ue)))}catch{}try{const se=(JSON.parse(localStorage.getItem("importedLeads")||"[]")||[]).filter(ce=>ce.id!==n.id);localStorage.setItem("importedLeads",JSON.stringify(se))}catch{}typeof t=="function"&&t(ee||null),c({business:"",prefix:"Mr.",firstName:"",lastName:"",designation:"",mobile:"",email:"",website:"",addressLine1:"",addressLine2:"",country:"",city:"",state:"",gstin:"",source:"",since:"",requirement:"",category:"",product:"",potential:"",assignedTo:"",stage:"",notes:"",tags:""}),l({}),r();return}else{const ee=await K.json().catch(()=>({error:"Failed to save imported lead"}));g(ee.error||"Failed to save imported lead");return}}catch(K){console.error("Error saving imported lead to backend:",K),g("Error saving imported lead to backend.");return}let Y;if(n&&n.id&&(Y=await fetch(`${Je}/api/leads/${n.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(X)})),(!n||!n.id)&&(Y=await fetch(`${Je}/api/leads`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(X)})),Y&&Y.ok){const K=await Y.json().catch(()=>null);await y(),c({business:"",prefix:"",firstName:"",lastName:"",designation:"",mobile:"",email:"",website:"",addressLine1:"",addressLine2:"",country:"",city:"",state:"",gstin:"",source:"",since:"",requirement:"",category:"",product:"",potential:"",assignedTo:"",stage:"",notes:"",tags:""}),l({}),g(""),typeof t=="function"&&t(K||null),r()}else if(Y&&!Y.ok){const K=await Y.json().catch(()=>({error:"Failed to save lead"})),ee=K.error||"Failed to save lead",ue=K.detail?`: ${K.detail}`:"",se=ee+ue;g(se.includes("foreign key constraint")?"Error: Invalid assignment. Please select a valid assignee.":se)}}catch(V){console.error("Error saving lead:",V),g("Error saving lead. Please try again.")}},L=["Mr.","Ms.","Mrs."],O=["Website","Referral","Social Media","Direct","Partner"],H=["Software","Hardware","Services","Consulting","Training"],z=["Discussion","Appointment","Demo","Decided","Inactive"],q=Array.isArray(o)&&o.length>0?o:[],D=Hs.map(N=>({value:N.name,label:N.name})),W=Object.entries(Bf).map(([N,V])=>({value:V,label:V})),P=Kc.map(N=>({value:N,label:N})),I=f.map(N=>({value:N.ID||N.id||N.Name||N.name||"",label:`${N.Name||N.name||N.ID||N.id}${N.Code?` (${N.Code})`:""}`})),U=q.map(N=>({value:N.id,label:N.name||String(N.id)})),k=D.find(N=>N.value===i.country)||null,_=W.find(N=>N.value===i.state)||null,R=P.find(N=>N.value===i.city)||null,j=I.find(N=>String(N.value)===String(i.product))||null,A=U.find(N=>String(N.value)===String(i.assignedTo)||String(N.label).toLowerCase()===String(i.assignedTo).toLowerCase())||null;return e?a.jsxs(a.Fragment,{children:[e&&a.jsx("div",{className:"modal-overlay",children:a.jsxs("div",{className:"lead-modal",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:"Enter Lead"}),a.jsx("button",{className:"close-button",onClick:r,children:""})]}),v&&a.jsx("div",{className:"error-message",style:{color:"red",marginBottom:"8px"},children:v}),a.jsxs("form",{onSubmit:C,children:[a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:"Core Data"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{children:["Business ",a.jsx("span",{className:"required",children:"*"})]}),a.jsx("input",{type:"text",name:"business",value:i.business,onChange:m,className:u.business?"error":"","aria-invalid":u.business?"true":"false"}),u.business&&a.jsx("span",{className:"input-error-inside",children:u.business})]}),a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{children:["Name ",a.jsx("span",{className:"required",children:"*"})]}),a.jsxs("div",{className:"name-inputs",children:[a.jsx("select",{name:"prefix",value:i.prefix,onChange:m,children:L.map(N=>a.jsx("option",{value:N,children:N},N))}),a.jsx("input",{type:"text",name:"firstName",placeholder:"First Name",value:i.firstName,onChange:m,className:u.name?"error":"","aria-invalid":u.name?"true":"false"}),a.jsx("input",{type:"text",name:"lastName",placeholder:"Last Name",value:i.lastName,onChange:m,className:u.name?"error":"","aria-invalid":u.name?"true":"false"}),u.name&&a.jsx("span",{className:"input-error-inside",children:u.name})]})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Designation"}),a.jsx("input",{type:"text",name:"designation",value:i.designation,onChange:m})]}),a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{children:["Mobile ",a.jsx("span",{className:"required",children:"*"})]}),a.jsxs("div",{className:"mobile-input",children:[a.jsx("span",{className:"prefix",children:"+91"}),a.jsx("input",{type:"text",name:"mobile",value:i.mobile,onChange:m,maxLength:"10",className:u.mobile?"error":"","aria-invalid":u.mobile?"true":"false"})]}),u.mobile&&a.jsx("span",{className:"input-error-inside",children:u.mobile})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{children:["Email ",a.jsx("span",{className:"required",children:"*"})]}),a.jsx("div",{className:"email-input",children:a.jsx("input",{type:"email",name:"email",value:i.email,onChange:m,className:u.email?"error":"","aria-invalid":u.email?"true":"false"})}),u.email&&a.jsx("span",{className:"input-error-inside",children:u.email})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Website"}),a.jsx("input",{type:"text",name:"website",value:i.website,onChange:m})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Address Line 1"}),a.jsx("input",{type:"text",name:"addressLine1",value:i.addressLine1,onChange:m})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Address Line 2"}),a.jsx("input",{type:"text",name:"addressLine2",value:i.addressLine2,onChange:m})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Country"}),a.jsx(q1,{options:D,value:k,onChange:N=>c(V=>({...V,country:N?N.value:""})),isSearchable:!0,placeholder:"Select country",className:"react-select-container",classNamePrefix:"react-select",styles:{menuPortal:N=>({...N,zIndex:9999})},menuPortalTarget:document.body,isClearable:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"City"}),i.country==="India"?a.jsx(q1,{options:P,value:R,onChange:N=>c(V=>({...V,city:N?N.value:""})),isSearchable:!0,placeholder:"Select city",className:"react-select-container",classNamePrefix:"react-select",styles:{menuPortal:N=>({...N,zIndex:9999})},menuPortalTarget:document.body,isClearable:!0}):a.jsx("input",{type:"text",name:"city",value:i.city,onChange:m})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"State"}),i.country==="India"?a.jsx(q1,{options:W,value:_,onChange:N=>c(V=>({...V,state:N?N.value:""})),isSearchable:!0,placeholder:"Select state",className:"react-select-container",classNamePrefix:"react-select",styles:{menuPortal:N=>({...N,zIndex:9999})},menuPortalTarget:document.body,isClearable:!0}):a.jsx("input",{type:"text",name:"state",value:i.state,onChange:m})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"GSTIN"}),a.jsx("input",{type:"text",name:"gstin",value:i.gstin,onChange:m})]})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:"Business Opportunity"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Source"}),a.jsxs("select",{name:"source",value:i.source,onChange:m,children:[a.jsx("option",{value:"",children:"Select Source"}),O.map(N=>a.jsx("option",{value:N,children:N},N))]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Since"}),a.jsx("input",{type:"date",name:"since",value:i.since?i.since.slice(0,10):"",onChange:m})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Requirement"}),a.jsx("input",{type:"text",name:"requirement",value:i.requirement,onChange:m})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Category"}),a.jsxs("select",{name:"category",value:i.category,onChange:m,children:[a.jsx("option",{value:"",children:"Select Category"}),H.map(N=>a.jsx("option",{value:N,children:N},N))]})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{children:["Product ",a.jsx("span",{className:"required",children:"*"})]}),a.jsx("div",{className:"product-input",children:a.jsx(q1,{options:I,value:j,onChange:N=>{c(V=>({...V,product:N?N.value:""})),N&&l(V=>{const M={...V};return delete M.product,M})},isSearchable:!0,placeholder:"Search or select product",className:u.product?"react-select-container error":"react-select-container",classNamePrefix:"react-select",styles:{menuPortal:N=>({...N,zIndex:9999}),placeholder:N=>({...N,color:u.product?"#d9534f":N.color})},menuPortalTarget:document.body,isClearable:!1})}),u.product&&a.jsx("span",{className:"input-error-inside",children:u.product})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Potential (Rs.)"}),a.jsx("div",{className:"potential-input",children:a.jsx("input",{type:"text",name:"potential",value:i.potential,onChange:m})})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{children:["Assigned To ",a.jsx("span",{className:"required",children:"*"})]}),a.jsx(q1,{options:U,value:A,onChange:N=>{c(V=>({...V,assignedTo:N?N.value:""})),N&&l(V=>{const M={...V};return delete M.assignedTo,M})},isSearchable:!0,placeholder:"Search or select assignee",className:u.assignedTo?"react-select-container error":"react-select-container",classNamePrefix:"react-select",styles:{menuPortal:N=>({...N,zIndex:9999}),placeholder:N=>({...N,color:u.assignedTo?"#d9534f":N.color})},menuPortalTarget:document.body,isClearable:!1}),u.assignedTo&&a.jsx("span",{className:"input-error-inside",children:u.assignedTo})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Stage"}),a.jsxs("select",{name:"stage",value:i.stage,onChange:m,children:[a.jsx("option",{value:"",children:"Select Stage"}),z.map(N=>a.jsx("option",{value:N,children:N},N))]})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Tags"}),a.jsxs("div",{className:"tags-input",children:[a.jsx("input",{type:"text",name:"tags",value:i.tags,onChange:m}),a.jsx("button",{type:"button",className:"add-button",children:"+"})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Notes"}),a.jsx("input",{type:"text",name:"notes",value:i.notes,onChange:m})]})]})]}),a.jsx("div",{className:"modal-footer",children:a.jsxs("button",{type:"submit",className:"save-button",children:[a.jsx("span",{className:"check-icon",children:""})," Save & Close"]})})]})]})}),a.jsxs("div",{className:"leads-table-container",children:[a.jsx("h3",{children:"Leads"}),a.jsxs("table",{className:"leads-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"ID"}),a.jsx("th",{children:"Business"}),a.jsx("th",{children:"Contact"}),a.jsx("th",{children:"Mobile"}),a.jsx("th",{children:"Email"}),a.jsx("th",{children:"City"}),a.jsx("th",{children:"Stage"}),a.jsx("th",{children:"Potential"}),a.jsx("th",{children:"Address Line 1"}),a.jsx("th",{children:"Address Line 2"}),a.jsx("th",{children:"Category"}),a.jsx("th",{children:"Tags"})]})}),a.jsx("tbody",{children:d.map(N=>a.jsxs("tr",{children:[a.jsx("td",{children:N.id}),a.jsx("td",{children:N.business}),a.jsx("td",{children:N.contact}),a.jsx("td",{children:N.mobile}),a.jsx("td",{children:N.email}),a.jsx("td",{children:N.city}),a.jsx("td",{children:N.stage}),a.jsx("td",{children:N.potential}),a.jsx("td",{children:N.addressLine1||N.addressline1||N.address_line1||""}),a.jsx("td",{children:N.addressLine2||N.addressline2||N.address_line2||""}),a.jsx("td",{children:N.category||N.Category||""}),a.jsx("td",{children:N.tags||N.Tags||""})]},N.id))})]})]})]}):null},Pue=({onClose:e,onImport:r})=>{const[t,n]=G.useState(""),[s,o]=G.useState([]),[i,c]=G.useState(!1),[u,l]=G.useState({total:0,today:0,contacted:0,pending:0}),[d,h]=G.useState(new Set),[f,p]=G.useState(1),[v]=G.useState(10),[g,m]=G.useState(""),[b,y]=G.useState(!1),[S,C]=G.useState(""),[L,O]=G.useState(""),[H,z]=G.useState(""),[q,D]=G.useState(""),[W,P]=G.useState(""),[I,U]=G.useState(""),[k,_]=G.useState("manual"),[R,j]=G.useState([]),A="http://localhost:8000/api",N=vr.useRef(!1);G.useEffect(()=>{const ve=localStorage.getItem("indiamart_api_key"),_e=localStorage.getItem("indiamart_recent_keys");_e&&j(JSON.parse(_e)),ve&&(n(ve),y(!0),M(0,ve))},[]);const V=async()=>{if(!t.trim()){m("Please enter an API key");return}try{localStorage.setItem("indiamart_api_key",t);const ve=[t,...R.filter(_e=>_e!==t)].slice(0,5);j(ve),localStorage.setItem("indiamart_recent_keys",JSON.stringify(ve)),y(!0),m(""),await new Promise(_e=>setTimeout(_e,500)),await M(0,t)}catch{m("Failed to connect to IndiaMART")}},M=async(ve=0,_e=t,le=0)=>{var ke,Te,pe,ye;if(N.current){console.debug("IndiaMART fetch already in progress - skipping");return}N.current=!0,c(!0),m("");try{console.debug(`Calling backend /indiamart/fetch-leads start=${ve} retry=${le}`);const ge=await ut.post(`${A}/indiamart/fetch-leads`,{apiKey:_e,start:ve,rows:v},{timeout:3e4,headers:{Accept:"application/json","Content-Type":"application/json"}});if(ge.data.STATUS==="SUCCESS"||ge.data.STATUS==="OK-FALLBACK"){const De=ge.data.DATA||[];o(De),Z(De),h(new Set),p(1),ge.data.STATUS==="OK-FALLBACK"&&m("Note: Showing cached leads (IndiaMART API rate limit reached)")}else m(ge.data.MESSAGE||"Failed to fetch leads");c(!1),N.current=!1}catch(ge){console.error("Error fetching leads:",ge);let De="Failed to connect to IndiaMART API";((ke=ge.response)==null?void 0:ke.status)===429?De=ge.response.data.error||"IndiaMART API rate limit exceeded. Please wait a few minutes and try again.":(pe=(Te=ge.response)==null?void 0:Te.data)!=null&&pe.error?De=ge.response.data.error:((ye=ge.response)==null?void 0:ye.status)===401?De="Invalid API key":ge.code==="ECONNABORTED"?De="Request timeout. Please try again.":ge.message==="Network Error"&&(De="Network connection error. Make sure backend is running."),m(De),c(!1),N.current=!1}},Z=ve=>{const _e=new Date().toISOString().split("T")[0],le=ve.filter(ke=>ke.QUERY_TIME&&ke.QUERY_TIME.includes(_e)).length;l({total:ve.length,today:le,contacted:Math.floor(ve.length*.3),pending:Math.floor(ve.length*.7)})},J=ve=>{const _e=new Set(d);_e.has(ve)?_e.delete(ve):_e.add(ve),h(_e)},re=()=>{d.size===s.length?h(new Set):h(new Set(s.map(ve=>ve.UNIQUE_QUERY_ID)))},X=()=>{if(d.size===0){m("Please select at least one lead");return}try{const ve=s.filter(le=>d.has(le.UNIQUE_QUERY_ID));console.log("Selected leads for import:",ve);const _e=ve.map(le=>({business:le.SENDER_COMPANY||le.buyer_company||"",name:le.SENDER_NAME||le.buyer_name||"",designation:le.designation||"",mobile:le.SENDER_MOBILE||le.buyer_mobile||"",email:le.SENDER_EMAIL||le.buyer_email||"",addressLine1:le.buyer_address||le.SENDER_CITY||"",addressLine2:le.addressLine2||"",city:le.SENDER_CITY||le.buyer_city||"",state:le.SENDER_STATE||le.buyer_state||"",country:le.buyer_country||"",gstin:le.gstin||"",source:le.enquiry_source||"IndiaMART",stage:le.lead_stage||le.STATUS||"New",potential:parseFloat(le.estimated_value)||0,category:le.lead_category||le.QUERY_CATEGORY_NAME||"",product:le.QUERY_PRODUCT_NAME||le.product_name||"",website:le.website||"",requirements:le.QUERY_MESSAGE||le.buyer_requirement||"",notes:le.remarks||"",tags:Array.isArray(le.lead_tags)?le.lead_tags.join(","):le.lead_tags||"",since:le.QUERY_TIME||le.enquiry_date||new Date().toISOString(),lastTalk:le.last_talk||"",nextTalk:le.next_followup||"",transferredOn:le.transferred_on||"",assignedTo:le.assigned_to||"",queryId:le.UNIQUE_QUERY_ID||le.lead_id||"",queryTime:le.QUERY_TIME||le.enquiry_date||""}));if(console.log("Formatted leads for import:",_e),r)console.log("Calling onImport callback"),r(_e),console.log("onImport callback executed successfully");else{console.warn("onImport callback is not defined"),m("Import callback is not configured");return}e()}catch(ve){console.error("Error during import:",ve),m("An error occurred during import: "+ve.message)}},ne=()=>{localStorage.removeItem("indiamart_api_key"),y(!1),n(""),o([]),h(new Set),m("")},Y=f*v,K=Y-v,ee=s.filter(ve=>{if(!S&&!L&&!q&&!W)return!0;const _e=new Date(ve.QUERY_TIME);if(isNaN(_e))return!0;if(S||L){if(S){const le=new Date(S);if(_e<le)return!1}if(L){const le=new Date(L);if(le.setHours(23,59,59,999),_e>le)return!1}}if(q||W){const le=_e.getHours().toString().padStart(2,"0"),ke=_e.getMinutes().toString().padStart(2,"0"),Te=`${le}:${ke}`;if(q&&Te<q||W&&Te>W)return!1}return!0}),ue=ee.slice(K,Y),se=Math.ceil(ee.length/v),ce=(ve,_e)=>{if(z(""),!ve||!_e){C(ve),O(_e),p(1);return}const le=new Date(ve),ke=new Date(_e);if(le>ke){z("From date must be before or equal to To date");return}if((ke-le)/(1e3*60*60*24)>7){z("Date range cannot exceed 7 days");return}C(ve),O(_e),p(1)},fe=(ve,_e)=>{if(U(""),!ve||!_e){D(ve),P(_e),p(1);return}if(ve>_e){U("From time must be before or equal to To time");return}D(ve),P(_e),p(1)};return b?a.jsxs("div",{className:"indiamart-container",children:[a.jsxs("div",{className:"indiamart-header",children:[a.jsxs("div",{className:"header-left",children:[a.jsx("h3",{children:"IndiaMART Leads"}),a.jsx("p",{className:"authenticated-badge",children:" Connected"})]}),a.jsxs("div",{className:"pull-mode-toggle",children:[a.jsx("span",{className:`toggle-label ${k==="manual"?"active":""}`,children:"Manual Pull"}),a.jsx("button",{className:`slide-toggle ${k==="auto"?"active":""}`,onClick:()=>_(k==="manual"?"auto":"manual"),title:`Switch to ${k==="manual"?"auto":"manual"} pull mode`,children:a.jsx("span",{className:"toggle-slider"})}),a.jsx("span",{className:`toggle-label ${k==="auto"?"active":""}`,children:"Auto Pull"})]}),a.jsx("div",{className:"header-right",children:a.jsx("button",{onClick:ne,className:"btn btn-secondary",children:"Disconnect"})})]}),a.jsxs("div",{className:"stats-grid",children:[a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-value",children:u.total}),a.jsx("div",{className:"stat-label",children:"Total Leads"})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-value",children:u.today}),a.jsx("div",{className:"stat-label",children:"Today's Leads"})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-value",children:u.contacted}),a.jsx("div",{className:"stat-label",children:"Contacted"})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-value",children:u.pending}),a.jsx("div",{className:"stat-label",children:"Pending"})]})]}),g&&a.jsx("div",{className:"error-message",children:g}),i?a.jsxs("div",{className:"loading-state",children:[a.jsx(b8,{className:"spinner"}),a.jsx("p",{children:"Fetching leads from IndiaMART..."})]}):s.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx("p",{children:"No leads found"}),a.jsx("button",{onClick:()=>M(0),className:"btn btn-primary btn-small",children:"Try Again"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"filters-container",children:[a.jsxs("div",{className:"date-filter-section",children:[a.jsxs("div",{className:"filter-header",children:[a.jsx("div",{className:"filter-label",children:"Filter by Date (Max 7 days)"}),(S||L)&&a.jsx("button",{onClick:()=>{C(""),O(""),z(""),p(1)},className:"btn btn-secondary btn-small clear-btn",children:"Clear"})]}),a.jsxs("div",{className:"date-filter-inputs",children:[a.jsxs("div",{className:"date-input-group",children:[a.jsx("label",{children:"From"}),a.jsx("input",{type:"date",value:S,onChange:ve=>ce(ve.target.value,L),className:"date-input"})]}),a.jsxs("div",{className:"date-input-group",children:[a.jsx("label",{children:"To"}),a.jsx("input",{type:"date",value:L,onChange:ve=>ce(S,ve.target.value),className:"date-input",min:S})]})]}),H&&a.jsx("div",{className:"error-message",style:{marginTop:"8px"},children:H})]}),a.jsxs("div",{className:"time-filter-section",children:[a.jsxs("div",{className:"filter-header",children:[a.jsx("div",{className:"filter-label",children:"Filter by Time"}),(q||W)&&a.jsx("button",{onClick:()=>{D(""),P(""),U(""),p(1)},className:"btn btn-secondary btn-small clear-btn",children:"Clear"})]}),a.jsxs("div",{className:"time-filter-inputs",children:[a.jsxs("div",{className:"time-input-group",children:[a.jsx("label",{children:"From Time"}),a.jsx("input",{type:"time",value:q,onChange:ve=>fe(ve.target.value,W),className:"time-input"})]}),a.jsxs("div",{className:"time-input-group",children:[a.jsx("label",{children:"To Time"}),a.jsx("input",{type:"time",value:W,onChange:ve=>fe(q,ve.target.value),className:"time-input"})]})]}),I&&a.jsx("div",{className:"error-message",style:{marginTop:"8px"},children:I})]})]}),a.jsx("div",{className:"leads-table-wrapper",children:a.jsxs("table",{className:"leads-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:a.jsx("input",{type:"checkbox",checked:d.size===s.length&&s.length>0,onChange:re,className:"checkbox"})}),a.jsx("th",{children:"Name"}),a.jsx("th",{children:"Designation"}),a.jsx("th",{children:"Email"}),a.jsx("th",{children:"Phone"}),a.jsx("th",{children:"Company"}),a.jsx("th",{children:"Address"}),a.jsx("th",{children:"City"}),a.jsx("th",{children:"State"}),a.jsx("th",{children:"Country"}),a.jsx("th",{children:"GSTIN"}),a.jsx("th",{children:"Product"}),a.jsx("th",{children:"Requirement"}),a.jsx("th",{children:"Source"}),a.jsx("th",{children:"Stage"}),a.jsx("th",{children:"Category"}),a.jsx("th",{children:"Potential ()"}),a.jsx("th",{children:"Assigned To"}),a.jsx("th",{children:"Next Follow-up"}),a.jsx("th",{children:"Notes"}),a.jsx("th",{children:"Date"})]})}),a.jsx("tbody",{children:ue.map(ve=>a.jsxs("tr",{className:d.has(ve.UNIQUE_QUERY_ID||ve.lead_id)?"selected":"",children:[a.jsx("td",{children:a.jsx("input",{type:"checkbox",checked:d.has(ve.UNIQUE_QUERY_ID||ve.lead_id),onChange:()=>J(ve.UNIQUE_QUERY_ID||ve.lead_id),className:"checkbox"})}),a.jsx("td",{children:a.jsx("strong",{children:ve.SENDER_NAME||"-"})}),a.jsx("td",{children:ve.designation||"-"}),a.jsx("td",{children:ve.SENDER_EMAIL||"-"}),a.jsx("td",{children:ve.SENDER_MOBILE||"-"}),a.jsx("td",{className:"truncate",children:ve.SENDER_COMPANY||"-"}),a.jsx("td",{className:"truncate",children:ve.buyer_address||"-"}),a.jsx("td",{children:ve.SENDER_CITY||"-"}),a.jsx("td",{children:ve.SENDER_STATE||"-"}),a.jsx("td",{children:ve.buyer_country||"-"}),a.jsx("td",{children:a.jsx("small",{children:ve.gstin||"-"})}),a.jsx("td",{className:"truncate",children:ve.QUERY_PRODUCT_NAME||"-"}),a.jsx("td",{className:"truncate",children:ve.QUERY_MESSAGE||"-"}),a.jsx("td",{className:"truncate",children:ve.enquiry_source||"-"}),a.jsx("td",{children:ve.lead_stage||"-"}),a.jsx("td",{children:ve.lead_category||"-"}),a.jsx("td",{children:a.jsx("small",{children:ve.estimated_value?`${ve.estimated_value.toLocaleString()}`:"-"})}),a.jsx("td",{className:"truncate",children:ve.assigned_to||"-"}),a.jsx("td",{children:a.jsx("small",{children:ve.next_followup||"-"})}),a.jsx("td",{className:"truncate",children:ve.remarks||"-"}),a.jsx("td",{children:a.jsx("small",{children:ve.QUERY_TIME?new Date(ve.QUERY_TIME).toLocaleDateString("en-IN",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"}):"-"})})]},ve.UNIQUE_QUERY_ID||ve.lead_id))})]})}),se>1&&a.jsxs("div",{className:"pagination",children:[a.jsx("button",{onClick:()=>p(ve=>Math.max(1,ve-1)),disabled:f===1,className:"btn btn-small",children:"Previous"}),a.jsxs("span",{className:"page-info",children:["Page ",f," of ",se]}),a.jsx("button",{onClick:()=>p(ve=>Math.min(se,ve+1)),disabled:f===se,className:"btn btn-small",children:"Next"})]}),a.jsxs("div",{className:"actions",children:[a.jsxs("p",{className:"selection-info",children:[d.size," lead",d.size!==1?"s":""," selected"]}),a.jsxs("div",{className:"action-buttons",children:[a.jsx("button",{onClick:()=>M(0),disabled:i,className:"btn btn-secondary",children:i?"Refreshing...":"Refresh"}),a.jsxs("button",{onClick:X,disabled:d.size===0||i,className:"btn btn-primary",children:["Import Selected (",d.size,")"]})]})]})]})]}):a.jsx("div",{className:"indiamart-container",children:a.jsx("div",{className:"indiamart-auth",children:a.jsxs("div",{className:"auth-card",children:[a.jsxs("h3",{children:[a.jsx(g0,{className:"auth-icon"}),"Connect to IndiaMART"]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"API Key"}),a.jsx("input",{type:"password",value:t,onChange:ve=>{n(ve.target.value),m("")},placeholder:"Enter your IndiaMART API key",className:"form-input"}),a.jsx("small",{className:"help-text",children:"Get your API key from IndiaMART seller account"})]}),g&&a.jsx("div",{className:"error-message",children:g}),a.jsx("button",{onClick:V,disabled:!t.trim()||i,className:"btn btn-primary full-width",children:i?a.jsxs(a.Fragment,{children:[a.jsx(b8,{className:"spinner"})," Connecting..."]}):"Connect to IndiaMART"}),R.length>0&&a.jsxs("div",{className:"recent-keys",children:[a.jsx("small",{children:"Recent Keys:"}),a.jsx("div",{className:"keys-list",children:R.map((ve,_e)=>a.jsxs("button",{className:"btn btn-secondary btn-small key-button",onClick:()=>n(ve),title:ve,children:[ve.substring(0,15),"...",ve.substring(ve.length-10)]},_e))})]})]})})})},Fue=({isOpen:e,onClose:r,onImportSuccess:t})=>{const[n,s]=G.useState(null),[o,i]=G.useState(!1),[c,u]=G.useState([]),[l,d]=G.useState(!1),[h,f]=G.useState(new Set),[p,v]=G.useState(null),[g,m]=G.useState(!1),[b,y]=G.useState(null),[S,C]=G.useState(null),[L,O]=G.useState([]),[H,z]=G.useState([]),q=["Business","Salutation","Name","Mobile","Email","Product"],D={Salutation:["Mr.","Ms.","Mrs."],Source:["Website","Referral","Social Media","Direct","Partner"],Stage:["Discussion","Appointment","Demo","Decided","Inactive"],Category:["Software","Hardware","Services","Consulting","Training"],Country:Hs.map(j=>j.name).slice(0,50),State:Object.values(Bf).slice(0,36),City:Array.isArray(Kc)?Kc.slice(0,100):[],Product:L,"Product *":L,"Assigned To":H,"Assigned To *":H};vr.useEffect(()=>{let j=!0;return(async()=>{var N,V,M;try{const Z=await ut.get(`${Je}/api/products?page=1&limit=1000`),re=(((N=Z.data)==null?void 0:N.data)||Z.data||[]).map(X=>X.Name||X.name||"").filter(Boolean);j&&O(re)}catch(Z){console.warn("Failed to load products for import dropdown:",Z.message||Z)}try{const Z=await ut.get(`${Je}/api/employees?page=1&limit=1000`),J=((V=Z.data)==null?void 0:V.data)||Z.data||[],re=(Array.isArray(J)?J:[]).map(X=>{const ne=X.firstname||X.Firstname||X.firstName||X.first_name||"",Y=X.lastname||X.Lastname||X.lastName||X.last_name||"";return`${ne}${Y?" "+Y:""}`.trim()||X.email||String(X.id||X.ID||"")}).filter(Boolean);j&&z(re)}catch{try{const J=await ut.get(`${Je}/api/users?page=1&limit=1000`),X=(((M=J.data)==null?void 0:M.data)||J.data||[]).map(ne=>ne.name||ne.Name||ne.email||"").filter(Boolean);j&&z(X)}catch(J){console.warn("Failed to load users/employees for import dropdown:",J.message||J)}}})(),()=>{j=!1}},[]);const W=(j,A,N)=>{const V=[...c];V[j]={...V[j],[A]:N},u(V)},P=(j,A,N)=>{const V=A.replace(/\*/g,"").trim(),M=D[V],Z=V.toLowerCase()==="product",J=`${j}-${V}`;return(b==null?void 0:b.row)===j&&(b==null?void 0:b.field)===A?M?a.jsx(eh,{value:N||"",onChange:re=>W(j,A,re.target.value),size:"small",autoFocus:!0,open:S===J,onOpen:()=>C(J),onClose:()=>{C(null),y(null)},sx:{width:"100%"},children:M.map(re=>a.jsx(zl,{value:re,children:re},re))}):a.jsx(ri,{value:N||"",onChange:re=>W(j,A,re.target.value),size:"small",autoFocus:!0,onBlur:()=>y(null),onKeyDown:re=>{(re.key==="Enter"||re.key==="Escape")&&y(null)},sx:{width:"100%"}}):a.jsx(Ut,{onClick:()=>{y({row:j,field:A}),M&&C(J)},sx:{cursor:"pointer",padding:"8px",borderRadius:"4px",minHeight:"36px",display:"flex",alignItems:"center",backgroundColor:M?"#cfdaf5ff":"transparent",border:Z&&N&&!(M!=null&&M.includes(N))?"2px solid #ff6b6b":"none"},title:Z&&N&&!(M!=null&&M.includes(N))?"Invalid product selection. Please select from dropdown.":"",children:N||""})},I=async()=>{const j=["Business *","Salutation *","Name *","Designation","Mobile *","Email *","Address Line 1","Address Line 2","City","State","Country","GSTIN","Source","Stage","Potential ()","Since","Requirement","Category","Product *","Website","Notes","Tags","Assigned To"],A=["ABC Corp","Mr.","John Doe","Manager","9876543210","john@example.com","123 Main Street","Apt 4B","Mumbai","Maharashtra","India","27AABCT1234H1Z0","LinkedIn","Negotiation","50000","2024-01-15","Product A, Product B","Electronics","Sample Product","www.example.com","Internal notes here","VIP, Follow-up","User Name"],N=["Mr.","Ms.","Mrs."],V=["Website","Referral","Social Media","Direct","Partner"],M=["Discussion","Appointment","Demo","Decided","Inactive"],Z=["Software","Hardware","Services","Consulting","Training"],J=Hs.map(Y=>Y.name).slice(0,50),re=Object.values(Bf).slice(0,36),X=Array.isArray(Kc)?Kc.slice(0,100):[];let ne;try{const Y=await hR(()=>Promise.resolve().then(()=>kE),void 0);ne=Y.default||Y}catch(Y){console.error("Failed to load exceljs:",Y),ne=null}if(ne){let Y=function(ft){let tr="";for(;ft>0;){const Me=(ft-1)%26;tr=String.fromCharCode(65+Me)+tr,ft=Math.floor((ft-1)/26)}return tr};const K=new ne.Workbook,ee=K.addWorksheet("Template");ee.addRow(j),ee.addRow(A);try{const ft=ee.getRow(2),tr={argb:"FF9E9E9E"};for(let Me=1;Me<=j.length;Me++){const tt=ft.getCell(Me);tt.font={color:tr,italic:!0},tt.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF9F9F9"}}}}catch(ft){console.warn("Could not apply sample row styling:",ft)}const ue=K.addWorksheet("Lists",{state:"hidden"}),se=["Salutation",...N],ce=["Source",...V],fe=["Stage",...M],ve=["Category",...Z],_e=["Country",...J],le=["State",...re],ke=["City",...X];ue.addRow(se),ue.addRow(ce),ue.addRow(fe),ue.addRow(ve),ue.addRow(_e),ue.addRow(le),ue.addRow(ke);const Te=(ft,tr)=>{const tt=2+tr-1,Ze=Y(tt);return`Lists!$B$${ft}:$${Ze}$${ft}`},pe={};j.forEach((ft,tr)=>{const Me=ft.replace(/\*/g,"").trim().toLowerCase().replace(/\s+/g," ");pe[Me]=tr+1});const ye=(ft,tr)=>{for(let Me=3;Me<=1e3;Me++){const tt=ee.getCell(Me,ft);tt.dataValidation={type:"list",allowBlank:!0,showErrorMessage:!0,formulae:[tr]},tt.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF7F7E8"}}}},ge=pe.salutation,De=pe.source,He=pe.stage,Xe=pe.category,at=pe.country,dt=pe.state,wt=pe.city;ge&&ye(ge,`=${Te(1,N.length)}`),De&&ye(De,`=${Te(2,V.length)}`),He&&ye(He,`=${Te(3,M.length)}`),Xe&&ye(Xe,`=${Te(4,Z.length)}`),at&&ye(at,`=${Te(5,J.length)}`),dt&&ye(dt,`=${Te(6,re.length)}`),wt&&ye(wt,`=${Te(7,X.length)}`);const $t=ee.getRow(1);[ge,De,He,Xe,at,dt,wt].forEach(ft=>{if(!ft)return;const tr=$t.getCell(ft);tr.font={bold:!0},tr.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFEEE8BF"}}});const Bt={business:!0,salutation:!0,name:!0,mobile:!0,email:!0,product:!0};for(let ft=1;ft<=j.length;ft++){const tr=j[ft-1].toLowerCase().replace(/\*/g,"").trim();if(Bt[tr]){const Me=$t.getCell(ft);Me.font={bold:!0,color:{argb:"FFFF0000"}},Me.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFE6E6"}}}else{const Me=$t.getCell(ft);Me.font={bold:!0}}}for(let ft=0;ft<10;ft++)ee.addRow([]);ee.columns.forEach(ft=>{ft.width=15}),K.xlsx.writeBuffer().then(ft=>{const tr=new Blob([ft],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),Me=document.createElement("a");Me.href=URL.createObjectURL(tr),Me.download="leads_import_template.xlsx",document.body.appendChild(Me),Me.click(),document.body.removeChild(Me)}).catch(ft=>{console.error("Failed to generate XLSX template:",ft)})}else{const Y=Wi.aoa_to_sheet([j,A]),K=Wi.book_new();Wi.book_append_sheet(K,Y,"Template"),xx(K,"leads_import_template.xlsx")}},U=async()=>{if(!n){alert("Please select a file to import.");return}i(!0);try{const j=new FileReader;j.onload=async A=>{try{let N=A.target.result;if(N.charCodeAt(0)===65279&&(N=N.slice(1)),!N.trim()){alert("The CSV file appears to be empty."),i(!1);return}let M=N.split(/\r\n|\n|\r/).filter(Y=>Y?Y.replace(/[",;\s]/g,"").length>0:!1);if(M.length===0){alert("The CSV file appears to be empty."),i(!1);return}const Z=M[0].includes(";")?";":",",J=M[0].split(Z).map(Y=>Y.trim().replace(/^"|"$/g,"").replace(/""/g,'"')),X=M.slice(1).map(Y=>{let K=[],ee=!1,ue="";if(Z===";")K=Y.split(Z).map(ce=>ce.trim().replace(/^"|"$/g,"").replace(/""/g,'"'));else{for(let ce=0;ce<Y.length;ce++){const fe=Y[ce];fe==='"'&&(ce===0||Y[ce-1]!=="\\")?ee=!ee:fe===Z&&!ee?(K.push(ue.trim().replace(/^"|"$/g,"").replace(/""/g,'"')),ue=""):ue+=fe}K.push(ue.trim().replace(/^"|"$/g,"").replace(/""/g,'"'))}const se={};return J.forEach((ce,fe)=>{se[ce]=K[fe]||""}),se});if(X.length===0){alert("The CSV file has headers but no data rows."),i(!1);return}u(X);const ne=new Set(X.map((Y,K)=>K));f(ne),i(!1),d(!0)}catch(N){console.error("Error importing leads:",N),alert(`Failed to import leads: ${N.message}`),i(!1)}},j.readAsText(n)}catch(j){console.error("Error reading file:",j),alert("Failed to read the selected file."),i(!1)}},k=j=>{const A=[],N={Business:["Business","Business *","business"],Salutation:["Salutation","Salutation *","salutation"],Name:["Name","Name *","name"],Mobile:["Mobile","Mobile *","mobile"],Email:["Email","Email *","email"],Product:["Product","Product *","product"]};return Object.keys(N).forEach(V=>{N[V].some(J=>j[J]&&String(j[J]).trim()!=="")||A.push(V)}),A},_=j=>{var V;const A=Object.keys(j).find(M=>M.replace(/\*/g,"").trim().toLowerCase()==="product");if(!A)return!0;const N=(V=j[A])==null?void 0:V.trim();return N?L.some(M=>M.toLowerCase()===N.toLowerCase()):!0},R=async()=>{var j,A,N,V,M,Z;i(!0);try{const J=c.filter((ue,se)=>h.has(se));if(J.length===0){alert("No rows selected for import. Please select at least one row."),i(!1);return}const re=[];if(J.forEach((ue,se)=>{const ce=[],fe=k(ue);if(fe.length>0&&ce.push(`Missing required fields: ${fe.join(", ")}`),!_(ue)){const ve=Object.keys(ue).find(le=>le.replace(/\*/g,"").trim().toLowerCase()==="product"),_e=ue[ve];ce.push(`Product "${_e}" is not in the available options. Please select from the dropdown list.`)}ce.length>0&&re.push({row:se+1,leadName:ue.Name||"N/A",business:ue.Business||"N/A",errors:ce})}),re.length>0){v({type:"validation_error",totalRows:J.length,successCount:0,errorCount:re.length,errors:re,successes:[]}),m(!0),i(!1);return}const X=J.map(ue=>{const se={};return Object.keys(ue).forEach(ce=>{const fe=ce.replace(/\s*\*\s*/g,"").trim(),ve=fe.toLowerCase();let _e=fe,le=ue[ce];ve==="address line 1"?_e="addressLine1":ve==="address line 2"?_e="addressLine2":ve==="potential ()"||ve==="potential (?)"?_e="potential":ve==="assigned to"?_e="assignedToName":ve==="notes"?_e="notes":ve==="tags"?_e="tags":ve==="requirement"?_e="requirements":ve==="salutation"?_e="salutation":ve==="product"?_e="productName":ve==="since"?_e="since":ve==="last talk"?_e="lastTalk":ve==="next talk"?_e="nextTalk":ve==="transferred on"&&(_e="transferredOn");const ke=["user name","sample product"];if(le&&typeof le=="string"&&(_e==="assignedToName"||_e==="productName")){const Te=le.toLowerCase().trim();ke.includes(Te)&&(le="")}(le===""||le===null||le===void 0)&&(["potential","since","lastTalk","nextTalk","transferredOn"].includes(_e)?le=null:le=""),_e==="potential"&&le&&(le=parseFloat(le)||0),se[_e]=le}),se});console.log("Sending import data:",JSON.stringify(X,null,2));const ne=await ut.post(`${Je}/api/leads/import`,X,{headers:{"Content-Type":"application/json"}});console.log("Import response:",ne.data);const Y=[];ne.data.errors&&Array.isArray(ne.data.errors)&&ne.data.errors.forEach((ue,se)=>{let ce="Unknown error";typeof ue=="string"?ce=ue:ue.detail?ce=ue.detail:ue.error&&(ce=ue.error),Y.push({row:ue.row||se+1,leadName:ue.lead||"N/A",business:ue.business||"N/A",errors:[ce]})});const K=[];if(ne.data.created&&ne.data.created>0){const ue=new Set(Y.map(se=>se.row-1));X.forEach((se,ce)=>{ue.has(ce)||K.push({row:ce+1,leadName:se.name||se.Name||"N/A",business:se.business||se.Business||"N/A",action:"Imported"})})}const ee={type:"import_complete",totalRows:J.length,successCount:ne.data.created||0,errorCount:Y.length,errors:Y,successes:K,skipped:ne.data.failed||0};v(ee),m(!0),d(!1),Y.length===0&&(u([]),s(null),setTimeout(()=>{t&&t()},1500)),i(!1)}catch(J){console.error("Error finalizing import:",J);const re=((A=(j=J.response)==null?void 0:j.data)==null?void 0:A.error)||((V=(N=J.response)==null?void 0:N.data)==null?void 0:V.detail)||J.message||"Unknown error",X=((Z=(M=J.response)==null?void 0:M.data)==null?void 0:Z.detail)||"",ne=c.filter((Y,K)=>h.has(K));v({type:"import_failed",totalRows:ne.length,successCount:0,errorCount:1,errors:[{row:"Server",leadName:"N/A",business:"N/A",errors:[re+(X?` - ${X}`:"")]}],successes:[]}),m(!0),i(!1)}};return e?a.jsxs(a.Fragment,{children:[a.jsxs(Oa,{open:e&&!l&&!g,onClose:(j,A)=>{A!=="backdropClick"&&r()},maxWidth:"md",fullWidth:!0,children:[a.jsx(Wa,{children:"Import Leads from CSV"}),a.jsxs(Pa,{children:[a.jsxs(Ut,{sx:{mb:2},children:[a.jsx(Et,{variant:"subtitle2",sx:{fontWeight:600,mb:1},children:"Instructions:"}),a.jsxs("ul",{style:{marginTop:0,marginBottom:8,paddingLeft:"1.25rem"},children:[a.jsx("li",{children:a.jsx(Et,{component:"span",variant:"body2",children:"Download the template Excel file below"})}),a.jsx("li",{children:a.jsx(Et,{component:"span",variant:"body2",children:"Fill in your lead data following the template format"})}),a.jsx("li",{children:a.jsx(Et,{component:"span",variant:"body2",children:"Required fields marked with  (Business, Salutation, Name, Mobile, Email, Product)"})}),a.jsx("li",{children:a.jsx(Et,{component:"span",variant:"body2",children:"Save the file as CSV format"})}),a.jsx("li",{children:a.jsx(Et,{component:"span",variant:"body2",children:"Upload the completed CSV file"})})]})]}),a.jsx(Et,{variant:"body2",color:"textSecondary",sx:{mb:2},children:"Import leads from a CSV file. Make sure you have downloaded the template and filled it correctly."}),a.jsx("input",{type:"file",accept:".csv",onChange:j=>s(j.target.files[0]),style:{marginBottom:"16px"}}),n&&a.jsxs(Et,{variant:"body2",sx:{mb:2},children:["Selected file: ",n.name]}),a.jsx(Ut,{sx:{mb:2},children:a.jsx(Et,{variant:"body2",color:"primary",sx:{cursor:"pointer"},onClick:I,children:" Download template Excel file"})})]}),a.jsxs(Va,{children:[a.jsx(Br,{onClick:r,children:"Cancel"}),a.jsx(Br,{variant:"contained",color:"primary",onClick:U,disabled:!n||o,children:o?a.jsx(Vs,{size:20}):"Next"})]})]}),a.jsxs(Oa,{open:l,onClose:(j,A)=>{A!=="backdropClick"&&(d(!1),u([]),f(new Set))},maxWidth:"xl",fullWidth:!0,children:[a.jsx(Wa,{children:a.jsxs(Ut,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[a.jsx(Et,{variant:"h6",children:"Preview and Edit Import Data"}),a.jsxs(Et,{variant:"subtitle2",color:"textSecondary",children:[c.length," records to import"]})]})}),a.jsxs(Pa,{children:[a.jsx(Et,{variant:"body2",color:"textSecondary",sx:{mb:2},children:"Review and edit the data before finalizing the import. Click on any cell to edit."}),a.jsx(Ws,{component:sa,sx:{maxHeight:600},children:a.jsxs(Cs,{stickyHeader:!0,size:"small",children:[a.jsx(js,{children:a.jsxs(pn,{children:[a.jsx(qe,{sx:{width:60},children:a.jsx(Wn,{size:"small",checked:c.length>0&&h.size===c.length,indeterminate:h.size>0&&h.size<c.length,onChange:j=>{j.target.checked?f(new Set(c.map((A,N)=>N))):f(new Set)}})}),a.jsx(qe,{sx:{fontWeight:"bold"},children:"No."}),c.length>0&&Object.keys(c[0]).map(j=>{const A=j.replace(/\*/g,"").trim(),N=q.includes(A);return a.jsxs(qe,{sx:{fontWeight:"bold",color:N?"#d32f2f":"inherit",backgroundColor:N?"#ffebee":"transparent",padding:"12px 8px"},children:[A,N&&a.jsx("span",{style:{color:"#d32f2f",marginLeft:"4px"},children:""})]},j)})]})}),a.jsx(fs,{children:c.map((j,A)=>a.jsxs(pn,{hover:!0,children:[a.jsx(qe,{children:a.jsx(Wn,{size:"small",checked:h.has(A),onChange:N=>{f(V=>{const M=new Set(V);return N.target.checked?M.add(A):M.delete(A),M})}})}),a.jsx(qe,{children:A+1}),Object.keys(j).map((N,V)=>{const M=N.replace(/\*/g,"").trim(),Z=!!D[M];return a.jsx(qe,{sx:{maxWidth:"200px",padding:0,backgroundColor:Z?"#fffef0":q.includes(M)?"#ffebee":"transparent"},children:P(A,N,j[N])},`${A}-${V}`)})]},A))})]})})]}),a.jsxs(Va,{children:[a.jsx(Br,{onClick:()=>{d(!1),u([]),f(new Set)},children:"Cancel"}),a.jsx(Br,{variant:"contained",color:"primary",onClick:R,disabled:o||h.size===0,children:o?a.jsx(Vs,{size:20}):"Import"})]})]}),a.jsxs(Oa,{open:g,onClose:(j,A)=>{A!=="backdropClick"&&(m(!1),v(null),(p==null?void 0:p.errorCount)===0&&r())},maxWidth:"md",fullWidth:!0,children:[a.jsx(Wa,{children:a.jsxs(Ut,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[a.jsx(Et,{variant:"h6",children:(p==null?void 0:p.type)==="validation_error"?"Validation Errors":(p==null?void 0:p.type)==="import_failed"?"Import Failed":"Import Report"}),a.jsx(Ut,{display:"flex",gap:2,children:(p==null?void 0:p.type)==="import_complete"&&a.jsxs(a.Fragment,{children:[a.jsxs(Et,{variant:"body2",color:"success.main",children:[" ",p.successCount," Imported"]}),p.errorCount>0&&a.jsxs(Et,{variant:"body2",color:"error.main",children:[" ",p.errorCount," Errors"]})]})})]})}),a.jsx(Pa,{children:p&&a.jsxs(Ut,{children:[a.jsxs(Ut,{sx:{mb:3,p:2,bgcolor:"background.paper",borderRadius:1,border:"1px solid",borderColor:"divider"},children:[a.jsx(Et,{variant:"subtitle2",gutterBottom:!0,children:"Summary"}),a.jsxs(is,{container:!0,spacing:2,children:[a.jsxs(is,{size:3,children:[a.jsx(Et,{variant:"body2",color:"textSecondary",children:"Total Rows:"}),a.jsx(Et,{variant:"h6",children:p.totalRows})]}),a.jsxs(is,{size:3,children:[a.jsx(Et,{variant:"body2",color:"success.main",children:"Successful:"}),a.jsx(Et,{variant:"h6",color:"success.main",children:p.successCount})]}),a.jsxs(is,{size:3,children:[a.jsx(Et,{variant:"body2",color:"error.main",children:"Errors:"}),a.jsx(Et,{variant:"h6",color:"error.main",children:p.errorCount})]})]})]}),p.errors&&p.errors.length>0&&a.jsxs(Ut,{sx:{mb:3},children:[a.jsxs(Et,{variant:"subtitle2",color:"error.main",gutterBottom:!0,children:["Errors (",p.errors.length,")"]}),a.jsx(Ws,{component:sa,sx:{maxHeight:300},children:a.jsxs(Cs,{size:"small",children:[a.jsx(js,{children:a.jsxs(pn,{sx:{backgroundColor:"#ffebee"},children:[a.jsx(qe,{sx:{fontWeight:"bold"},children:"Row"}),a.jsx(qe,{sx:{fontWeight:"bold"},children:"Business"}),a.jsx(qe,{sx:{fontWeight:"bold"},children:"Error Details"})]})}),a.jsx(fs,{children:p.errors.map((j,A)=>a.jsxs(pn,{children:[a.jsx(qe,{children:j.row||"N/A"}),a.jsx(qe,{children:j.business||"N/A"}),a.jsx(qe,{children:a.jsx(Ut,{children:Array.isArray(j.errors)?j.errors.map((N,V)=>{const M=N.includes("mandatory")||N.includes("required")||N.includes("Missing"),Z=N.includes("not found")||N.includes("does not exist");return a.jsxs(Et,{variant:"body2",color:"error.main",sx:{mb:.5,fontWeight:M||Z?600:400,bgcolor:M?"rgba(255, 152, 0, 0.1)":Z?"rgba(244, 67, 54, 0.1)":"transparent",px:M||Z?1:0,py:M||Z?.5:0,borderRadius:M||Z?1:0},children:[M?" ":Z?" ":" ",N]},V)}):a.jsx(Et,{variant:"body2",color:"error.main",children:j.errors||j.message||"Unknown error"})})})]},A))})]})})]}),p.successes&&p.successes.length>0&&a.jsxs(Ut,{sx:{mb:3},children:[a.jsxs(Et,{variant:"subtitle2",color:"success.main",gutterBottom:!0,children:["Successfully Imported (",p.successes.length,")"]}),a.jsx(Ws,{component:sa,sx:{maxHeight:200},children:a.jsxs(Cs,{size:"small",children:[a.jsx(js,{children:a.jsxs(pn,{sx:{backgroundColor:"#e8f5e9"},children:[a.jsx(qe,{sx:{fontWeight:"bold"},children:"Row"}),a.jsx(qe,{sx:{fontWeight:"bold"},children:"Business"}),a.jsx(qe,{sx:{fontWeight:"bold"},children:"Status"})]})}),a.jsx(fs,{children:p.successes.map((j,A)=>a.jsxs(pn,{children:[a.jsx(qe,{children:j.row}),a.jsx(qe,{children:j.leadName||"N/A"}),a.jsx(qe,{children:j.business||"N/A"}),a.jsx(qe,{children:a.jsxs(Et,{variant:"body2",color:"success.main",children:[" ",j.action||"Imported"]})})]},A))})]})})]}),p.type==="validation_error"&&a.jsxs(Ut,{sx:{p:2,bgcolor:"warning.lighter",borderRadius:1,border:"1px solid",borderColor:"warning.main"},children:[a.jsx(Et,{variant:"subtitle2",color:"warning.dark",gutterBottom:!0,children:" How to Fix These Errors"}),a.jsx(Et,{variant:"body2",color:"warning.dark",sx:{mb:1},children:a.jsx("strong",{children:"Required Fields (must be filled):"})}),a.jsx(Et,{variant:"body2",color:"warning.dark",sx:{mb:1,ml:2},children:" Business, Salutation, Name, Mobile, Email, Product"}),a.jsxs(Et,{variant:"body2",color:"warning.dark",children:[a.jsx("strong",{children:"How to proceed:"}),a.jsx("br",{})," You can edit values directly in the preview table",a.jsx("br",{})," Make sure all required fields marked with  are filled",a.jsx("br",{}),' Click "Back to Edit" to return to the preview and fix these errors']})]}),p.type==="import_complete"&&p.errorCount>0&&a.jsxs(Ut,{sx:{p:2,bgcolor:"error.lighter",borderRadius:1,border:"1px solid",borderColor:"error.main"},children:[a.jsx(Et,{variant:"subtitle2",color:"error.dark",gutterBottom:!0,children:" How to Fix Import Errors"}),a.jsxs(Et,{variant:"body2",color:"error.dark",sx:{mb:1},children:["Click the ",a.jsx("strong",{children:'"Back to Edit"'})," button below to return to the import preview where you can:"]}),a.jsxs(Et,{variant:"body2",color:"error.dark",sx:{ml:2},children:[" Edit field values directly in the table",a.jsx("br",{})," Deselect rows with errors if you don't want to import them",a.jsx("br",{})," Use the dropdown fields to select valid values"]})]})]})}),a.jsxs(Va,{children:[(p==null?void 0:p.type)==="import_complete"&&(p==null?void 0:p.errorCount)>0&&a.jsx(Br,{variant:"outlined",color:"primary",onClick:()=>{m(!1),v(null),d(!0)},children:"Back to Edit"}),(p==null?void 0:p.type)==="validation_error"&&a.jsx(Br,{variant:"outlined",color:"primary",onClick:()=>{m(!1),v(null),d(!0)},children:"Back to Edit"}),a.jsx(Br,{variant:"contained",onClick:()=>{m(!1),v(null),(p==null?void 0:p.errorCount)===0&&r()},children:(p==null?void 0:p.errorCount)===0?"Done":"Close"})]})]})]}):null},Lu=({children:e,onClick:r,title:t})=>a.jsx("div",{className:"import-tile",onClick:r,title:t,children:e}),Bue=({isOpen:e,onClose:r,onExcelClick:t,onLeadsImport:n})=>{const[s,o]=G.useState(null),[i,c]=G.useState(!1);return e?i?a.jsx(Fue,{isOpen:i,onClose:()=>{c(!1),r()},onImportSuccess:()=>{n&&n([]),c(!1),r()}}):s==="indiamart"?a.jsx("div",{className:"import-dialog-overlay",onMouseDown:u=>{u.target.className==="import-dialog-overlay"&&o(null)},children:a.jsxs("div",{className:"dialog-content integration-view",children:[a.jsxs("div",{className:"dialog-header",children:[a.jsx("button",{className:"back-btn",onClick:()=>o(null),children:" Back"}),a.jsx("button",{className:"close-btn",onClick:r,children:""})]}),a.jsx(Pue,{onClose:()=>o(null),onImport:u=>{n&&n(u),r()}})]})}):a.jsx("div",{className:"import-dialog-overlay",onMouseDown:u=>{u.target.className==="import-dialog-overlay"&&r()},children:a.jsxs("div",{className:"dialog-content",children:[a.jsxs("div",{className:"dialog-header",children:[a.jsx("h3",{children:"Import Leads"}),a.jsx("button",{className:"close-btn",onClick:r,children:""})]}),a.jsxs("div",{className:"dialog-body",children:[a.jsxs("section",{className:"integration-section",children:[a.jsx("h4",{children:"Pull Integrations"}),a.jsx("p",{className:"muted",children:"Click below to fetch leads from these sources."}),a.jsxs("div",{className:"tiles",children:[a.jsxs(Lu,{onClick:()=>c(!0),title:"Upload CSV",children:[a.jsx(sz,{className:"tile-icon excel"}),a.jsx("div",{className:"tile-label",children:"Excel/CSV"})]}),a.jsxs(Lu,{onClick:()=>o("indiamart"),title:"Fetch from IndiaMART",children:[a.jsx(g0,{className:"tile-icon"}),a.jsx("div",{className:"tile-label",children:"Indiamart"})]}),a.jsxs(Lu,{children:[a.jsx(JB,{className:"tile-icon"}),a.jsx("div",{className:"tile-label",children:"Meta"})]})]})]}),a.jsxs("section",{className:"integration-section",children:[a.jsx("h4",{children:"Push Integrations"}),a.jsx("p",{className:"muted",children:"Leads from these sources will be directly fetched and imported."}),a.jsxs("div",{className:"tiles",children:[a.jsxs(Lu,{children:[a.jsx(v8,{className:"tile-icon"}),a.jsx("div",{className:"tile-label",children:"Justdial"})]}),a.jsxs(Lu,{children:[a.jsx(v8,{className:"tile-icon"}),a.jsx("div",{className:"tile-label",children:"MB"})]}),a.jsxs(Lu,{children:[a.jsx(g0,{className:"tile-icon"}),a.jsx("div",{className:"tile-label",children:"Indiamart"})]}),a.jsxs(Lu,{children:[a.jsx(g0,{className:"tile-icon"}),a.jsx("div",{className:"tile-label",children:"Website"})]})]})]}),a.jsxs("section",{className:"integration-section",children:[a.jsx("h4",{children:"No Integrations"}),a.jsx("p",{className:"muted",children:"Please visit customization to set up your integrations with these sources."}),a.jsxs("div",{className:"tiles",children:[a.jsxs(Lu,{children:[a.jsx(g0,{className:"tile-icon"}),a.jsx("div",{className:"tile-label",children:"TradeIndia"})]}),a.jsxs(Lu,{children:[a.jsx(g0,{className:"tile-icon"}),a.jsx("div",{className:"tile-label",children:"Housing"})]}),a.jsxs(Lu,{children:[a.jsx(g0,{className:"tile-icon"}),a.jsx("div",{className:"tile-label",children:"99acres"})]})]})]})]})]})}):null},zue=[{id:1,name:"ABC"},{id:2,name:"XYZ"},{id:3,name:"123"}],eS=[{key:"business",label:"Business"},{key:"name",label:"Name"},{key:"designation",label:"Designation"},{key:"mobile",label:"Mobile"},{key:"email",label:"Email"},{key:"addressLine1",label:"Address Line 1"},{key:"addressLine2",label:"Address Line 2"},{key:"city",label:"City"},{key:"state",label:"State"},{key:"country",label:"Country"},{key:"gstin",label:"GSTIN"},{key:"source",label:"Source"},{key:"stage",label:"Stage"},{key:"potential",label:"Potential ()"},{key:"since",label:"Since"},{key:"category",label:"Category"},{key:"product",label:"Product"},{key:"website",label:"Website"},{key:"requirements",label:"Requirements"},{key:"notes",label:"Notes"},{key:"tags",label:"Tags"},{key:"lastTalk",label:"LastTalk"},{key:"nextTalk",label:"NextTalk"},{key:"transferredOn",label:"TransferredOn"},{key:"assignedTo",label:"AssignedTo"},{key:"createdAt",label:"CreatedAt"},{key:"updatedAt",label:"UpdatedAt"},{key:"code",label:"Code"}],Tj="displayPreferences",$ue=()=>{const e=ii(),[r,t]=G.useState([]),[n,s]=G.useState(!1),[o,i]=G.useState("All Active Leads"),[c,u]=G.useState("Newest First"),[l,d]=G.useState(!1),[h,f]=G.useState(!1),[p,v]=G.useState(!1),[g,m]=G.useState(!1),[b,y]=G.useState(null),[S,C]=G.useState(!1),[L,O]=G.useState(!1),H=G.useRef(null),z=G.useRef(null),q=G.useRef(null),[D,W]=G.useState(()=>{const Me=localStorage.getItem(Tj);if(Me){const tt=JSON.parse(Me);return eS.filter(Ze=>tt[Ze.key])}return eS}),[P,I]=G.useState(""),[U,k]=G.useState([]),[_,R]=G.useState(zue);G.useEffect(()=>{j()},[]),G.useEffect(()=>{(async()=>{try{const Ze=await(await fetch(`${Je}/api/products?page=1&limit=1000`)).json();k(Ze.data||[])}catch{k([])}})()},[]),G.useEffect(()=>{(async()=>{try{const Ze=await(await fetch(`${Je}/api/employees?page=1&limit=1000`)).json(),et=(Array.isArray(Ze)?Ze:[]).map(Ht=>({id:Ht.id,name:(Ht.firstname||Ht.Firstname||"")+(Ht.lastname?" "+Ht.lastname:"")||Ht.email||String(Ht.id)}));et.length>0&&R(et)}catch{}})()},[]),G.useEffect(()=>{function Me(tt){z.current&&!z.current.contains(tt.target)&&S&&C(!1),q.current&&!q.current.contains(tt.target)&&L&&(O(!1),d(!1))}return document.addEventListener("mousedown",Me),()=>document.removeEventListener("mousedown",Me)},[S,L]),G.useEffect(()=>{if(!h){const Me=localStorage.getItem(Tj);if(Me){const tt=JSON.parse(Me);W(eS.filter(Ze=>tt[Ze.key]))}}},[h]);const j=async()=>{s(!0);try{const tt=await(await fetch(`${Je}/api/leads?page=1&limit=100`)).json(),Ze=JSON.parse(localStorage.getItem("starredLeads")||"{}"),St=(tt.data||[]).map(Nt=>{var kt,kr,Jt,Pt,Ur;return{...Nt,starred:!!Ze[Nt.id],product:Nt.productName||"",assignedTo:Nt.assignedToName||((kt=_.find(Lr=>Lr.id===Nt.assigned_to_id))==null?void 0:kt.name)||"",addressLine1:Nt.addressLine1||Nt.addressline1||Nt.address_line1||((kr=Nt.formData)==null?void 0:kr.addressLine1)||"",addressLine2:Nt.addressLine2||Nt.addressline2||Nt.address_line2||((Jt=Nt.formData)==null?void 0:Jt.addressLine2)||"",category:Nt.category||Nt.Category||((Pt=Nt.formData)==null?void 0:Pt.category)||"",tags:Nt.tags||Nt.Tags||((Ur=Nt.formData)==null?void 0:Ur.tags)||"",createdAt:Nt.createdAt||Nt.CreatedAt||Nt.created_at||Nt.created_at_time||null,updatedAt:Nt.updatedAt||Nt.UpdatedAt||Nt.updated_at||Nt.updated_at_time||null}}),Ht=(JSON.parse(localStorage.getItem("importedLeads")||"[]")||[]).map(Nt=>({...Nt,createdAt:Nt.createdAt||Nt.CreatedAt||Nt.created_at||new Date().toISOString(),updatedAt:Nt.updatedAt||Nt.UpdatedAt||Nt.updated_at||Nt.createdAt||new Date().toISOString()}));t([...St,...Ht])}catch(Me){console.error("Failed to fetch leads:",Me)}finally{s(!1)}},A=()=>C(Me=>!Me),N=Me=>{i(Me),C(!1)},V=()=>{O(Me=>!Me),d(!l)},M=Me=>{u(Me),O(!1),d(!1)},Z=()=>e("/reports"),J=()=>e("/customize"),re=()=>{const Me=r.length>0&&r.every(tt=>tt.selected);t(tt=>tt.map(Ze=>({...Ze,selected:!Me})))},X=Me=>{t(tt=>tt.map(Ze=>Ze.id===Me?{...Ze,selected:!Ze.selected}:Ze))},ne=()=>m(!0),Y=async Me=>{if(window.confirm("Are you sure you want to delete this lead?"))try{const tt=Number(Me);if(!tt||isNaN(tt)){const et=(JSON.parse(localStorage.getItem("importedLeads")||"[]")||[]).filter(Ht=>Ht.id!==Me);localStorage.setItem("importedLeads",JSON.stringify(et)),t(Ht=>Ht.filter(Nt=>Nt.id!==Me));return}const Ze=await fetch(`${Je}/api/leads/${Me}`,{method:"DELETE"});if(!Ze.ok){const St=await Ze.json().catch(()=>({error:"Failed to delete lead"}));console.error("Delete failed:",St),alert(St.error||"Failed to delete lead");return}await j()}catch(tt){console.error("Failed to delete lead:",tt)}},K=Me=>{let tt=Me.assignedTo;if(typeof tt=="object"&&tt!==null)tt=tt.Name||tt.name||tt.email||"";else if(typeof tt=="number"){const St=_.find(et=>et.id===tt);tt=St?St.name:""}let Ze=Me.product;typeof Ze=="object"&&Ze!==null&&(Ze=Ze.Name||Ze.name||Ze.Code||""),y({...Me,assignedTo:tt,id:Me.id,addressLine1:Me.addressLine1||"",addressLine2:Me.addressLine2||"",category:Me.category||"",product:Ze,tags:Me.tags||"",code:Me.code||"",requirement:Me.requirements||Me.requirement||"",prefix:Me.prefix||"",firstName:Me.firstName||"",lastName:Me.lastName||""}),v(!0)},ee=Me=>{t(tt=>{const Ze=tt.map(Ht=>Ht.id===Me?{...Ht,starred:!Ht.starred}:Ht),St=JSON.parse(localStorage.getItem("starredLeads")||"{}"),et=Ze.find(Ht=>Ht.id===Me);return et&&(et.starred?St[Me]=!0:delete St[Me],localStorage.setItem("starredLeads",JSON.stringify(St))),Ze})},ue=(Me,tt)=>{if(!tt||typeof Me!="string")return Me;const Ze=tt.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),St=new RegExp(`(${Ze})`,"gi");return Me.split(St).map((et,Ht)=>St.test(et)?a.jsx("mark",{style:{background:"#ffe066",padding:0},children:et},Ht):et)},se=Me=>{if(!Me)return"";const tt=new Date(Me);if(isNaN(tt))return Me;const Ze=String(tt.getDate()).padStart(2,"0"),St=String(tt.getMonth()+1).padStart(2,"0"),et=tt.getFullYear();return`${Ze}-${St}-${et}`},ce=Me=>{const tt=parseInt(Me||"0");return new Intl.NumberFormat("en-IN",{maximumSignificantDigits:3,style:"currency",currency:"INR"}).format(tt)},fe=Me=>{if(!Me)return"";const tt=new Date(Me);if(isNaN(tt))return Me;const Ze=String(tt.getDate()).padStart(2,"0"),St=String(tt.getMonth()+1).padStart(2,"0"),et=tt.getFullYear(),Ht=String(tt.getHours()).padStart(2,"0"),Nt=String(tt.getMinutes()).padStart(2,"0");return`${Ze}-${St}-${et} ${Ht}:${Nt}`},ve=Me=>{const tt=Me.target.files[0];if(tt){const Ze=new FileReader;Ze.onload=St=>{try{const et=new Uint8Array(St.target.result),Ht=qS(et,{type:"array"}),Nt=Ht.SheetNames[0],kt=Ht.Sheets[Nt],kr=Wi.sheet_to_json(kt,{raw:!1,defval:""}),Jt=new Date().toISOString(),Pt=kr.map((vt,nr)=>({id:`imported_${Date.now()}_${nr}`,business:vt.Business||vt.business||"",contact:vt.Contact||vt.contact||vt.Name||vt.name||"",name:vt.Name||vt.name||vt.Contact||vt.contact||"",designation:vt.Designation||vt.designation||"",mobile:vt.Mobile||vt.mobile||"",email:vt.Email||vt.email||"",addressLine1:vt["Address Line 1"]||vt.AddressLine1||vt.addressLine1||vt.Address1||vt.address1||"",addressLine2:vt["Address Line 2"]||vt.AddressLine2||vt.addressLine2||vt.Address2||vt.address2||"",city:vt.City||vt.city||"",state:vt.State||vt.state||"",country:vt.Country||vt.country||"",gstin:vt.GSTIN||vt.gstin||"",source:vt.Source||vt.source||"",stage:vt.Stage||vt.stage||"",potential:(vt.Potential||vt["Potential ()"]||vt.potential||"0").toString().replace(/[^\d]/g,""),since:vt.Since||vt.since||Jt,assignedTo:vt["Assigned to"]||vt.AssignedTo||vt["Assigned To"]||"",product:vt.Product||vt.product||"",website:vt.Website||vt.website||"",lastTalk:vt["Last Talk"]||vt.LastTalk||Jt,nextTalk:vt["Next Talk"]||vt.NextTalk||vt.Next||"",transferredOn:vt["Transferred on"]||vt.TransferredOn||vt["Transfer Date"]||Jt,category:vt.Category||vt.category||"",tags:vt.Tags||vt.tags||vt.Tag||vt.tag||"",requirements:vt.Requirements||vt.requirements||"",notes:vt.Notes||vt.notes||"",createdAt:Jt,updatedAt:Jt,selected:!1}));if(Pt.length===0)throw new Error("No valid data found in Excel file");const Lr=[...JSON.parse(localStorage.getItem("importedLeads")||"[]"),...Pt];localStorage.setItem("importedLeads",JSON.stringify(Lr)),t(vt=>[...vt.filter(Cr=>Cr.id&&typeof Cr.id=="number"),...Lr]),H.current&&(H.current.value=""),_e(Pt).then(({successCount:vt,failCount:nr})=>{const Cr=`Imported ${Pt.length} row(s). Saved to database: ${vt}. Failed: ${nr}.`;alert(Cr)})}catch{alert('Error importing file. Please ensure the column names match exactly: "Assigned to" and "Transferred on"')}},Ze.readAsArrayBuffer(tt)}},_e=async Me=>{let tt=0,Ze=0;const St=[];for(const et of Me)try{let Ht;const Nt=et.assignedToName!==void 0&&et.assignedToName!==null?et.assignedToName:et.assignedTo;if(Nt!=null&&Nt!==""){const vt=Number(Nt);if(!isNaN(vt)&&_.some(nr=>Number(nr.id)===vt))Ht=vt;else{const nr=_.find(Cr=>Cr.name===Nt);nr&&(Ht=nr.id)}}let kt;const kr=et.productName!==void 0&&et.productName!==null?et.productName:et.product;if(kr!=null&&kr!==""){const vt=Number(kr);if(!isNaN(vt))kt=vt;else{const nr=U.find(Cr=>Cr.ID&&(String(Cr.ID)===String(kr)||Cr.Name===kr)||Cr.id&&(String(Cr.id)===String(kr)||Cr.name===kr));nr&&(kt=nr.ID||nr.id)}}const Jt={business:et.business||et.SENDER_COMPANY||"",contact:et.contact||et.name||et.SENDER_NAME||[et.prefix,et.firstName,et.lastName].filter(Boolean).join(" "),designation:et.designation,mobile:et.mobile||et.SENDER_MOBILE||"",email:et.email||et.SENDER_EMAIL||"",city:et.city||et.SENDER_CITY||"",state:et.state||et.SENDER_STATE||"",country:et.country||et.buyer_country||"",gstin:et.gstin||"",source:et.source||et.enquiry_source||"IndiaMART",stage:et.stage||et.lead_stage||et.STATUS||"New",potential:parseFloat((et.potential||et.estimated_value||"0").toString())||0,since:(()=>{const vt=new Date(et.since||et.QUERY_TIME||et.enquiry_date||et.createdAt);return isNaN(vt)?new Date().toISOString():vt.toISOString()})(),website:et.website||"",requirements:et.requirements||et.requirement||et.QUERY_MESSAGE||et.buyer_requirement||"",notes:et.notes||et.remarks||"",addressLine1:et.addressLine1||et.buyer_address||"",addressLine2:et.addressLine2||"",category:et.category||et.lead_category||et.QUERY_CATEGORY_NAME||"",tags:et.tags||(Array.isArray(et.lead_tags)?et.lead_tags.join(","):"")};kt!==void 0&&(Jt.product_id=kt),Ht!==void 0&&(Jt.assigned_to_id=Ht);const Pt=et.productName!==void 0&&et.productName!==null&&et.productName!==""?et.productName:et.product;Pt!=null&&Pt!==""&&(Jt.productName=Pt);const Ur=et.assignedToName!==void 0&&et.assignedToName!==null&&et.assignedToName!==""?et.assignedToName:et.assignedTo;if(Ur!=null&&Ur!==""&&(Jt.assignedToName=Ur),et.createdAt&&(Jt.created_at=et.createdAt),et.updatedAt&&(Jt.updated_at=et.updatedAt),Jt.name=Jt.name||Jt.contact,Object.keys(Jt).forEach(vt=>{(Jt[vt]===""||Jt[vt]===void 0||Jt[vt]===null)&&delete Jt[vt]}),!Jt.business||!Jt.contact||!Jt.mobile||!Jt.email){console.warn("Skipping lead due to missing required fields:",Jt),Ze+=1;continue}console.log("Sending payload:",Jt);const Lr=await fetch(`${Je}/api/leads`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Jt)});Lr.ok?(tt+=1,St.push(et.id)):(Ze+=1,console.error(`Failed to save lead ${et.id}:`,Lr.status,await Lr.text()))}catch{Ze+=1}try{const Ht=(JSON.parse(localStorage.getItem("importedLeads")||"[]")||[]).filter(Nt=>!St.includes(Nt.id));localStorage.setItem("importedLeads",JSON.stringify(Ht)),await j()}catch{}return{successCount:tt,failCount:Ze}},le=()=>{const Me=Wi.book_new();D.map(kt=>kt.key);const tt=D.map(kt=>kt.label),Ze=r.filter(kt=>kt.selected),et=(Ze.length>0?Ze:ye).map(kt=>{const kr={};return D.forEach(Jt=>{var Ur,Lr,vt,nr;let Pt;Jt.key==="name"?Pt=kt.name&&kt.name.trim()?kt.name:kt.contact&&kt.contact.trim()?kt.contact:[kt.prefix,kt.firstName,kt.lastName].filter(Boolean).join(" "):Jt.key==="potential"?Pt=kt.potential||"":Jt.key==="since"||Jt.key==="lastTalk"||Jt.key==="nextTalk"||Jt.key==="transferredOn"?Pt=se(kt[Jt.key]):Jt.key==="assignedTo"?Pt=kt.assignedToName||(typeof kt.assignedTo=="object"&&kt.assignedTo!==null?kt.assignedTo.Name||kt.assignedTo.name||kt.assignedTo.email||"":kt.assignedTo||""):Jt.key==="product"?Pt=kt.productName||(typeof kt.product=="object"&&kt.product!==null?kt.product.Name||kt.product.name||kt.product.Code||"":kt.product||""):Jt.key==="addressLine1"?Pt=kt.addressLine1||kt.addressline1||kt.address_line1||((Ur=kt.formData)==null?void 0:Ur.addressLine1)||"":Jt.key==="addressLine2"?Pt=kt.addressLine2||kt.addressline2||kt.address_line2||((Lr=kt.formData)==null?void 0:Lr.addressLine2)||"":Jt.key==="category"?Pt=kt.category||kt.Category||((vt=kt.formData)==null?void 0:vt.category)||"":Jt.key==="tags"?Pt=kt.tags||kt.Tags||((nr=kt.formData)==null?void 0:nr.tags)||"":Jt.key==="lastTalk"?Pt=se(kt.lastTalk||kt.LastTalk||kt.last_talk||kt.lasttalk||kt.createdAt||""):Jt.key==="nextTalk"?Pt=se(kt.nextTalk||kt.NextTalk||kt.next_talk||kt.nexttalk||""):Jt.key==="transferredOn"?Pt=se(kt.transferredOn||kt.TransferredOn||kt.transferred_on||kt.transferredon||""):Jt.key==="assignedToId"?Pt=kt.assigned_to_id||kt.assignedToId||kt.AssignedToID||"":Jt.key==="productId"?Pt=kt.product_id||kt.productId||kt.ProductID||"":Jt.key==="createdAt"?Pt=fe(kt.createdAt||kt.CreatedAt||""):Jt.key==="updatedAt"?Pt=fe(kt.updatedAt||kt.UpdatedAt||""):Pt=kt[Jt.key]||"",kr[Jt.label]=Pt}),kr});let Ht="Leads_";Ze.length>0?Ht+=`Selected_${Ze.length}_`:(o!=="All Active Leads"&&(Ht+=`${o}_`),c!=="Newest First"&&(Ht+=`${c}_`),P&&(Ht+=`Search_${P.replace(/[^a-z0-9]/gi,"_").substring(0,10)}_`)),Ht+="Exported.xlsx";const Nt=Wi.json_to_sheet(et,{header:tt});Wi.book_append_sheet(Me,Nt,"Leads"),xx(Me,Ht)},ye=((Me,tt)=>{if(!tt.trim())return Me;const Ze=tt.toLowerCase();return Me.filter(St=>Object.values(St).some(et=>typeof et=="string"&&et.toLowerCase().includes(Ze)))})(((Me,tt)=>tt==="Newest First"?[...Me].sort((Ze,St)=>new Date(St.since)-new Date(Ze.since)):tt==="Oldest First"?[...Me].sort((Ze,St)=>new Date(Ze.since)-new Date(St.since)):tt==="Star Leads"?Me.filter(Ze=>Ze.starred):Me)(((Me,tt)=>tt==="All Active Leads"?Me:tt==="Discussion"?Me.filter(Ze=>Ze.stage&&Ze.stage.toLowerCase()==="discussion"):tt==="Appointment"?Me.filter(Ze=>Ze.stage&&Ze.stage.toLowerCase()==="appointment"):tt==="Demo"?Me.filter(Ze=>Ze.stage&&Ze.stage.toLowerCase()==="demo"):tt==="Proposal"?Me.filter(Ze=>Ze.stage&&Ze.stage.toLowerCase()==="proposal"):tt==="Decided"?Me.filter(Ze=>Ze.stage&&Ze.stage.toLowerCase()==="decided"):tt==="Inactive"?Me.filter(Ze=>Ze.stage&&Ze.stage.toLowerCase()==="inactive"):Me)(r,o),c),P),ge=r.filter(Me=>Me.selected).length,[De,He]=G.useState(1),[Xe,at]=G.useState(10),dt=Math.max(1,Math.ceil(ye.length/Xe)),wt=ye.slice((De-1)*Xe,De*Xe),$t=()=>He(Me=>Math.max(Me-1,1)),Bt=()=>He(Me=>Math.min(Me+1,dt)),ft=Me=>{at(Number(Me.target.value)),He(1)},tr=async Me=>{var tt,Ze,St,et,Ht;if(Me&&(!Me.id||typeof Me.id!="number"||String(Me.id).startsWith("imported_"))){let Nt=Me.product;const kt=U.find(Pt=>Pt.ID===Me.product||Pt.id===Me.product);Nt=kt?kt.Name||kt.name:Me.product;let kr=Me.assignedTo;const Jt=_.find(Pt=>Pt.id===Number(Me.assignedTo));kr=Jt?Jt.name:Me.assignedTo,t(Pt=>{const Lr=(JSON.parse(localStorage.getItem("importedLeads")||"[]")||[]).map(nr=>nr.id===Me.id?{...nr,...Me,product:Nt,assignedTo:kr}:nr);return localStorage.setItem("importedLeads",JSON.stringify(Lr)),[...Pt.filter(nr=>nr.id&&typeof nr.id=="number"),...Lr]}),v(!1),y(null)}else{if(Me&&Me.id&&typeof Me.id=="number"){const Nt=Me,kt=((tt=_.find(Pt=>Pt.id===Nt.assigned_to_id))==null?void 0:tt.name)||Nt.assignedTo||"";let kr="";if(Nt.productName)kr=Nt.productName;else if(Nt.product)typeof Nt.product=="object"&&Nt.product!==null?kr=Nt.product.Name||Nt.product.name||Nt.product.Code||"":typeof Nt.product=="string"&&Nt.product&&(kr=Nt.product);else if(Nt.product_id){const Pt=U.find(Ur=>Ur.ID===Nt.product_id||Ur.id===Nt.product_id);kr=Pt&&(Pt.Name||Pt.name)||""}const Jt={...Nt,starred:!1,assignedTo:kt,product:kr,addressLine1:Nt.addressLine1||Nt.addressline1||Nt.address_line1||((Ze=Nt.formData)==null?void 0:Ze.addressLine1)||"",addressLine2:Nt.addressLine2||Nt.addressline2||Nt.address_line2||((St=Nt.formData)==null?void 0:St.addressLine2)||"",category:Nt.category||Nt.Category||((et=Nt.formData)==null?void 0:et.category)||"",tags:Nt.tags||Nt.Tags||((Ht=Nt.formData)==null?void 0:Ht.tags)||"",createdAt:Nt.createdAt||Nt.created_at||new Date().toISOString(),updatedAt:Nt.updatedAt||Nt.updated_at||Nt.createdAt||new Date().toISOString()};t(Pt=>{const Ur=Pt.filter(Lr=>!(Lr.id&&Lr.id===Jt.id));return[Jt,...Ur]})}else await j();v(!1),y(null)}};return a.jsxs("div",{className:"top-menu",children:[a.jsxs("div",{className:"header-section",children:[a.jsx("div",{className:"header-title",children:"Leads & Prospects"}),a.jsxs("div",{className:"header-actions",children:[a.jsxs("div",{style:{position:"relative"},ref:z,children:[a.jsxs("button",{className:`all-leads-btn ${S?"active":""}`,onClick:A,children:[o,a.jsx(g8,{className:"dropdown-arrow"})]}),S&&a.jsx("div",{className:"status-dropdown",children:["All Active Leads","Discussion","Appointment","Demo","Proposal","Decided","Inactive"].map(Me=>a.jsx("div",{className:`dropdown-item${o===Me?" active":""}`,onClick:()=>N(Me),children:Me},Me))})]}),a.jsxs("div",{style:{position:"relative",display:"inline-block"},ref:q,children:[a.jsxs("button",{className:`filters-btn ${l?"active":""}`,onClick:V,children:[a.jsx(lz,{}),"Filters",a.jsx(g8,{className:"dropdown-arrow"})]}),L&&a.jsx("div",{className:"view-dropdown",children:["Newest First","Oldest First","Star Leads"].map(Me=>a.jsx("div",{className:`dropdown-item${c===Me?" active":""}`,onClick:()=>M(Me),children:Me},Me))})]}),a.jsxs("div",{className:"search-bar",children:[a.jsx(M6,{className:"search-icon"}),a.jsx("input",{type:"text",placeholder:"Search",value:P,onChange:Me=>I(Me.target.value)})]}),a.jsxs("div",{className:"utility-buttons",children:[a.jsx("button",{className:"icon-btn",title:"Sales Configuration",children:a.jsx(v2,{})}),a.jsx("button",{className:"icon-btn",title:"Display Preferences",onClick:()=>f(!0),children:a.jsx(f7,{})}),a.jsx("button",{className:"icon-btn",title:"Export to Excel",onClick:le,children:a.jsx(p7,{})}),a.jsx("button",{className:"icon-btn",title:"Show Leads Dashboard",children:a.jsx(pz,{})}),a.jsx("button",{className:"icon-btn",title:"Reports",onClick:Z,children:a.jsx(L6,{})})]})]})]}),a.jsx("div",{className:"filter-section",children:a.jsxs("div",{className:"view-filters-container",children:[a.jsx("div",{className:"action-buttons-center",children:a.jsxs("div",{className:"action-buttons",children:[a.jsx("button",{className:"add-lead-btn",onClick:()=>v(!0),children:"+ Add Lead"}),a.jsxs("button",{className:"import-btn",onClick:ne,children:[a.jsx(nz,{})," Import"]}),a.jsxs("button",{className:"customize-btn",onClick:J,children:[a.jsx(xz,{})," Customize"]})]})}),a.jsx("div",{className:"selected-count-overlay-center",children:a.jsxs("div",{className:`selected-count-overlay ${ge>0?"visible":""}`,children:["Selected: ",ge]})}),a.jsxs("div",{className:"stats-section",children:[a.jsxs("div",{className:"count",children:["Count: ",r.length]}),a.jsxs("div",{className:"selected-count",children:["Selected: ",ge]}),a.jsxs("div",{className:"potential",children:["Potential: ",ce(r.reduce((Me,tt)=>Me+parseInt(tt.potential||"0"),0))]})]})]})}),a.jsx("div",{className:"table-container",children:a.jsxs("table",{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:"checkbox-cell",children:a.jsx("input",{type:"checkbox",onChange:re,checked:r.length>0&&r.every(Me=>Me.selected),disabled:r.length===0})}),a.jsx("th",{className:"serial-number",children:"S.No"}),D.map(Me=>a.jsx("th",{children:Me.label},Me.key)),a.jsx("th",{className:"action-column",children:"Actions"})]})}),a.jsx("tbody",{children:D.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:4,style:{textAlign:"center",color:"#888"},children:"No items to display"})}):Array.isArray(wt)&&wt.map((Me,tt)=>a.jsxs("tr",{children:[a.jsx("td",{className:"checkbox-cell",children:a.jsx("input",{type:"checkbox",checked:!!Me.selected,onChange:()=>X(Me.id)})}),a.jsxs("td",{className:"serial-number",children:[a.jsx("span",{className:`star-icon ${Me.starred?"starred":""}`,title:Me.starred?"Unmark as Star":"Mark as Star",onClick:()=>ee(Me.id),children:a.jsx(m7,{})}),(De-1)*Xe+tt+1]}),D.map(Ze=>a.jsx("td",{children:(()=>{var et,Ht,Nt,kt;let St;return Ze.key==="name"?St=Me.name&&Me.name.trim()?Me.name:Me.contact&&Me.contact.trim()?Me.contact:[Me.prefix,Me.firstName,Me.lastName].filter(Boolean).join(" "):Ze.key==="potential"?St=`${Me.potential||""}`:Ze.key==="since"||Ze.key==="lastTalk"||Ze.key==="nextTalk"||Ze.key==="transferredOn"?St=se(Me[Ze.key]):Ze.key==="assignedTo"?St=Me.assignedToName||(typeof Me.assignedTo=="object"&&Me.assignedTo!==null?Me.assignedTo.Name||Me.assignedTo.name||Me.assignedTo.email||JSON.stringify(Me.assignedTo):Me.assignedTo||""):Ze.key==="product"?St=Me.productName||(typeof Me.product=="object"&&Me.product!==null?Me.product.Name||Me.product.name||Me.product.Code||JSON.stringify(Me.product):Me.product||""):Ze.key==="addressLine1"?St=Me.addressLine1||Me.addressline1||Me.address_line1||((et=Me.formData)==null?void 0:et.addressLine1)||"":Ze.key==="addressLine2"?St=Me.addressLine2||Me.addressline2||Me.address_line2||((Ht=Me.formData)==null?void 0:Ht.addressLine2)||"":Ze.key==="category"?St=Me.category||Me.Category||((Nt=Me.formData)==null?void 0:Nt.category)||"":Ze.key==="tags"?St=Me.tags||Me.Tags||((kt=Me.formData)==null?void 0:kt.tags)||"":Ze.key==="lastTalk"?St=se(Me.lastTalk||Me.LastTalk||Me.last_talk||Me.lasttalk||Me.createdAt||""):Ze.key==="nextTalk"?St=se(Me.nextTalk||Me.NextTalk||Me.next_talk||Me.nexttalk||""):Ze.key==="transferredOn"?St=se(Me.transferredOn||Me.TransferredOn||Me.transferred_on||Me.transferredon||""):Ze.key==="assignedToId"?St=Me.assigned_to_id||Me.assignedToId||Me.AssignedToID||"":Ze.key==="productId"?St=Me.product_id||Me.productId||Me.ProductID||"":Ze.key==="createdAt"?St=fe(Me.createdAt||Me.CreatedAt||""):Ze.key==="updatedAt"?St=fe(Me.updatedAt||Me.UpdatedAt||""):St=Me[Ze.key]||"",typeof St=="string"&&P?ue(St,P):St})()},Ze.key)),a.jsxs("td",{className:"action-cell",children:[a.jsx("button",{className:"edit-btn",title:"Edit Lead",onClick:Ze=>{Ze.stopPropagation(),K(Me)},children:a.jsx(Yf,{})}),a.jsx("button",{onClick:Ze=>{Ze.stopPropagation(),Y(Me.id)},className:"delete-btn",title:"Delete Lead",children:a.jsx(Zf,{})})]})]},Me.id||tt))})]})}),a.jsxs("div",{className:"pagination-section",children:[a.jsx("button",{onClick:$t,disabled:De===1,children:"Previous"}),a.jsxs("span",{children:["Page ",De," of ",dt]}),a.jsxs("span",{children:["Rows per page:",a.jsx("select",{value:Xe,onChange:ft,children:[5,10,25,50].map(Me=>a.jsx("option",{value:Me,children:Me},Me))})]}),a.jsx("button",{onClick:Bt,disabled:De===dt,children:"Next"})]}),h&&a.jsx(Hoe,{onClose:()=>f(!1)}),a.jsx(Oue,{isOpen:p,onClose:()=>{v(!1),y(null)},onAddLeadSubmit:tr,leadData:b,products:U,assignedToOptions:_}),g&&a.jsx(Bue,{isOpen:g,onClose:()=>m(!1),onExcelClick:()=>{H.current&&H.current.click()},onLeadsImport:async Me=>{if(console.log("Imported leads received:",Me),Me&&Me.length>0)try{const tt=Me.filter(et=>{const Ht=et.company||et.business||"",Nt=et.name||et.contact||"",kt=et.email||"",kr=et.phone||et.mobile||"";return!Ht||!Nt||!kt||!kr?(console.warn("Skipping lead with missing required fields:",{business:Ht,name:Nt,email:kt,mobile:kr,lead:et}),!1):!0});if(tt.length===0){alert("No valid leads to import. Make sure each lead has company, name, email, and phone."),m(!1);return}const Ze=tt.map(et=>({business:et.company||et.business||"",name:et.name||et.contact||"Unknown",email:et.email||"",mobile:et.phone||et.mobile||"",product:et.product||et.productName||"",requirements:et.message||et.requirement||et.requirements||"",source:et.source||"IndiaMART",stage:et.stage||"New",category:et.category||"",city:et.city||"",state:et.state||"",country:et.country||"",gstin:et.gstin||"",addressLine1:et.addressLine1||"",addressLine2:et.addressLine2||"",designation:et.designation||"",potential:parseInt(et.estimatedValue||et.potential||"0")||0,tags:et.tags||""}));console.log("Sending leads to backend import endpoint:",Ze);const St=await fetch(`${Je}/api/leads/import`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ze)});if(St.ok){const et=await St.json();console.log("Import successful:",et),console.log("Import details - Created:",et.created,"Failed:",et.failed),et.errors&&et.errors.length>0&&console.error("Import errors:",et.errors),alert(`Successfully imported ${et.created||tt.length} lead(s)${et.failed>0?`, ${et.failed} failed`:""}`),await new Promise(Ht=>setTimeout(Ht,500)),console.log("Refreshing leads list..."),await j(),console.log("Leads list refreshed"),m(!1)}else{const et=await St.json();console.error("Import failed:",et),alert("Failed to import leads: "+(et.error||"Unknown error"))}}catch(tt){console.error("Error during import:",tt),alert("Error importing leads: "+tt.message)}else m(!1)}}),a.jsx("input",{type:"file",ref:H,style:{display:"none"},accept:".xlsx,.xls",onChange:ve})]})},Uue=()=>{const e=ii(),[r,t]=G.useState(!1),n=[{name:"Current Assets",value:"1,22,500.00 Cr"},{name:"Fixed Assets",value:"0.00 Db"},{name:"Equity",value:"0.00 Db"},{name:"Long Term Liabilities",value:"0.00 Db"},{name:"Short Term Liabilities",value:"0.00 Db"},{name:"Direct Income",value:"0.00 Db"},{name:"Indirect Income",value:"0.00 Db"},{name:"Sales",value:"0.00 Db"},{name:"Direct Expense",value:"0.00 Db"},{name:"Indirect Expense",value:"0.00 Db"},{name:"Purchase",value:"1,22,500.00 Db"}],s=()=>{e("/reports")};return a.jsxs("div",{className:"accounts-dashboard",children:[a.jsxs("div",{className:"top-bar",children:[a.jsx("h1",{children:"Accounts"}),a.jsxs("select",{className:"year-select",children:[a.jsx("option",{children:"FY 2025-2026"}),a.jsx("option",{children:"FY 2024-2025"}),a.jsx("option",{children:"FY 2023-2024"}),a.jsx("option",{children:"All Year"})]}),a.jsxs("div",{className:"action-buttons",children:[a.jsx("button",{className:"entry-btn",children:"+ Enter Voucher"}),a.jsxs("button",{className:"purchase-btn",children:[a.jsx(x8,{})," Purchases"]}),a.jsxs("button",{className:"sales-btn",children:[a.jsx(iz,{})," Sales"]}),a.jsx("button",{className:"report-btn",title:"Reports",onClick:s,children:a.jsx(h7,{})})]})]}),a.jsxs("div",{className:"dashboard-content",children:[a.jsxs("div",{className:"left-column",children:[a.jsxs("div",{className:"header",children:[a.jsx("h2",{children:"Groups & Ledgers"}),a.jsxs("div",{className:"controls",children:[a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:r,onChange:o=>t(o.target.checked)}),"Hide zeroes"]}),a.jsx("button",{className:"btn-add",title:"Create Sub Group",children:"+"})]})]}),a.jsx("div",{className:"ledger-list",children:n.map(o=>a.jsxs("div",{className:"ledger-item",children:[a.jsx("span",{className:"name",children:o.name}),a.jsx("span",{className:"value",children:o.value})]},o.name))}),a.jsx("button",{className:"create-ledger",children:"Create Sub-Group"})]}),a.jsxs("div",{className:"right-column",children:[a.jsxs("div",{className:"favourite-ledgers",children:[a.jsx("h2",{children:"Favourite Ledgers"}),a.jsx("div",{className:"instructions",children:a.jsxs("p",{children:["Click",a.jsx(m7,{}),"next to the name of a ledger to mark it as favourite."]})}),a.jsxs("button",{className:"find-btn",children:[a.jsx(M6,{})," Find Ledger"]})]}),a.jsxs("div",{className:"quick-access",children:[a.jsx("h2",{children:"Quick Access"}),a.jsxs("div",{className:"button-grid",children:[a.jsxs("button",{className:"btn-blue",children:[a.jsx(QB,{})," Balance Sheet"]}),a.jsxs("button",{className:"btn-blue",children:[a.jsx(L6,{})," Profit & Loss"]}),a.jsxs("button",{className:"btn-blue",children:[a.jsx(rz,{})," Trial Balance"]}),a.jsxs("button",{className:"btn-green",children:[a.jsx(az,{})," GST Ledgers"]}),a.jsxs("button",{className:"btn-green",children:[a.jsx(cz,{})," Reconciliation"]}),a.jsxs("button",{className:"btn-green",children:[a.jsx(ez,{})," Stock Value"]}),a.jsxs("button",{className:"btn-green",children:[a.jsx(x8,{})," Purchase Orders"]}),a.jsxs("button",{className:"btn-green",children:[a.jsx(oz,{})," Credit Notes"]}),a.jsxs("button",{className:"btn-green",children:[a.jsx(fz,{})," Debit Notes"]})]})]})]})]})]})},Hue=()=>{const[e,r]=G.useState({business:!0,name:!0,designation:!0,mobile:!0,email:!0,website:!0,country:!0,state:!0,city:!0,GSTIN:!0,source:!0,product:!0,potential:!0,assignedTo:!0,requirements:!0,notes:!0,since:!0,lastTalk:!0,nextAction:!0,transfer:!0}),[t,n]=G.useState(""),[s,o]=G.useState(!1),i=d=>{d==="business"||d==="name"||r(h=>({...h,[d]:!h[d]}))},c=d=>{n(d.target.value)},u=()=>{o(!s)},l={business:"Business",name:"Name",designation:"Designation",mobile:"Mobile",email:"Email",website:"Website",country:"Country",state:"State",city:"City",GSTIN:"GSTIN",source:"Source",product:"Product",potential:"Potential",assignedTo:"Assigned To",requirements:"Requirements",notes:"Notes",since:"Since",lastTalk:"Last Talk",nextAction:"Next Action",transfer:"Transfer on"};return a.jsxs("div",{className:"data-fields-selector",children:[a.jsx("h3",{children:"Data Fields"}),a.jsx("p",{className:"subtitle",children:"What columns do you wish to see in your lead list?"}),a.jsx("div",{className:"fields-grid",children:Object.entries(l).map(([d,h])=>{const f=d==="business"||d==="name",p=e[d];return a.jsxs("label",{className:`field-option ${f?"disabled":""} ${p?"checked":""}`,children:[a.jsx("input",{type:"checkbox",checked:p,disabled:f,onChange:()=>i(d)}),a.jsx("span",{className:"checkmark",children:p&&a.jsx(j0,{})}),a.jsx("span",{className:"field-label",children:h})]},d)})}),a.jsx("div",{className:"custom-field-section",children:a.jsxs("div",{className:`field-option custom-field ${t?"has-value":""}`,children:[a.jsxs("div",{className:"checkmark",children:[a.jsx("input",{type:"checkbox",checked:s,onChange:u}),s&&a.jsx(j0,{className:"tick-icon"})]}),a.jsx("div",{className:"custom-field-wrapper",children:a.jsx("input",{type:"text",placeholder:"Enter field",value:t,onChange:c,className:"custom-field-input"})}),a.jsx("div",{className:"right-mark",children:""})]})})]})},Vue=()=>{const[e,r]=G.useState(0),t=["Raw Lead","New","Discussion","Demo","Proposal","Decided","Customer"],n=s=>{r(s)};return a.jsxs("div",{className:"prospect-funnel",children:[a.jsx("div",{className:"funnel-header",children:a.jsxs("h3",{children:["Prospect Conversion Funnel",a.jsx(dz,{className:"edit-icon"})]})}),a.jsx("p",{className:"funnel-subtitle",children:"Leads will be auto imported as Raw Leads (i.e. Unqualified). You can set up five stages to track progress till conversion to customer."}),a.jsx("div",{className:"stages-container",children:t.map((s,o)=>a.jsx("button",{className:`stage-button ${e===o?"active":""}`,onClick:()=>n(o),"data-stage":o,children:s},o))})]})},Wue=()=>{const e=ii(),[r,t]=G.useState(""),n=()=>{e(-1)},s=o=>{t(o.target.value)};return a.jsx("div",{className:"customize-main-wrapper",children:a.jsxs("div",{className:"customize-container",children:[a.jsxs("div",{className:"header",children:[a.jsx("h2",{children:"Customization (CRM)"}),a.jsxs("button",{className:"back-btn",onClick:n,children:[a.jsx(u7,{style:{marginRight:"5px"}}),"Back"]})]}),a.jsx("div",{className:"custom-nav-buttons",children:["Customer Type","Data Fields","Prospect Funnel","Platform Integrations","Email Integration","Policies"].map((o,i)=>a.jsx("button",{className:"nav-btn",children:o},i))}),a.jsxs("div",{className:"customer-type-section",children:[a.jsx("h3",{children:"Customer Type"}),a.jsxs("div",{className:"question-row",children:[a.jsx("h4",{children:"Who do you sell to?"}),a.jsxs("div",{className:"radio-group",children:[a.jsxs("label",{className:"radio-option",children:[a.jsx("input",{type:"radio",name:"customerType",value:"business",checked:r==="business",onChange:s}),a.jsx("span",{className:"radio-label",children:"Business"})]}),a.jsxs("label",{className:"radio-option",children:[a.jsx("input",{type:"radio",name:"customerType",value:"individual",checked:r==="individual",onChange:s}),a.jsx("span",{className:"radio-label",children:"Individual"})]}),a.jsxs("label",{className:"radio-option",children:[a.jsx("input",{type:"radio",name:"customerType",value:"both",checked:r==="both",onChange:s}),a.jsx("span",{className:"radio-label",children:"Both"})]})]})]})]}),a.jsx(Hue,{}),a.jsx(Vue,{}),a.jsx(que,{}),a.jsx(Gue,{})]})})},que=()=>{const[e,r]=G.useState(new Set),[t,n]=G.useState(new Set),s=[{id:"indiamart",name:"IndiaMART",icon:null,fallbackClass:"indiamart"},{id:"tradeindia",name:"TradeIndia",icon:null,fallbackClass:"tradeindia"},{id:"justdial",name:"JustDial",icon:null,fallbackClass:"justdial"},{id:"meta",name:"Meta",icon:null,fallbackClass:"meta"},{id:"housing",name:"Housing.com",icon:null,fallbackClass:"housing"},{id:"acres99",name:"99acres",icon:null,fallbackClass:"acres99"},{id:"magicbricks",name:"MagicBricks",icon:null,fallbackClass:"magicbricks"},{id:"website",name:"Custom Website",icon:null,fallbackClass:"website"}],o=u=>{t.has(u)||(n(l=>new Set([...l,u])),setTimeout(()=>{r(l=>{const d=new Set(l);return d.has(u)?d.delete(u):d.add(u),d}),n(l=>{const d=new Set(l);return d.delete(u),d})},1500))},i=u=>{let l="platform-card";return e.has(u)&&(l+=" connected"),t.has(u)&&(l+=" loading"),l},c=u=>{let l="platform-icon";return u.icon||(l+=` fallback-icon ${u.fallbackClass}`),l};return a.jsxs("div",{className:"platform-integrations",children:[a.jsxs("div",{className:"integration-header",children:[a.jsx("h3",{children:"Platform Integrations"}),a.jsx("p",{className:"integration-subtitle",children:"Import leads from popular platforms and your own website."})]}),a.jsx("div",{className:"platforms-container",children:s.map(u=>a.jsxs("div",{className:i(u.id),onClick:()=>o(u.id),children:[a.jsx("div",{className:c(u),children:u.icon?a.jsx("img",{src:u.icon,alt:u.name}):a.jsx("span",{children:u.name.charAt(0)})}),a.jsx("p",{className:"platform-name",children:u.name})]},u.id))}),a.jsx("div",{className:"integration-status",children:a.jsxs("p",{className:"status-text",children:[a.jsx("span",{className:"connected-count",children:e.size})," of ",s.length," platforms connected"]})})]})},Gue=()=>{const[e,r]=G.useState("india"),t=n=>{r(n.target.value)};return a.jsxs("div",{className:"email-policies-section",children:[a.jsxs("div",{className:"email-integration",children:[a.jsx("h3",{children:"Email Integration"}),a.jsx("p",{className:"integration-subtext",children:"Send Lead assignment alerts, follow-ups, quotes, invoices, from your own email account."}),a.jsxs("button",{className:"configure-btn email-configure",children:[a.jsx(v2,{className:"gear-icon"}),"Configure"]})]}),a.jsxs("div",{className:"policies-section",children:[a.jsx("h3",{children:"Policies"}),a.jsxs("div",{className:"policies-cards",children:[a.jsxs("div",{className:"policy-card",children:[a.jsxs("div",{className:"card-header",children:[a.jsx("h4",{children:"Auto-Assignment"}),a.jsx("span",{className:"status-label inactive",children:"Inactive"})]}),a.jsx("p",{className:"card-description",children:"Assign leads automatically by selecting a Sales Executive from the list."}),a.jsxs("button",{className:"configure-btn",children:[a.jsx(v2,{className:"gear-icon"}),"Configure"]})]}),a.jsxs("div",{className:"policy-card",children:[a.jsxs("div",{className:"card-header",children:[a.jsx("h4",{children:"Duplication"}),a.jsx("span",{className:"status-label disallowed",children:"Disallowed"})]}),a.jsx("p",{className:"card-description",children:"Do you want to allow duplicate leads?"}),a.jsxs("button",{className:"allow-btn",children:[a.jsx(j0,{className:"check-icon"}),"Allow"]})]}),a.jsxs("div",{className:"policy-card",children:[a.jsx("div",{className:"card-header",children:a.jsx("h4",{children:"Sales Mode"})}),a.jsx("p",{className:"card-description",children:"Choose your sales mode to define your sales reach."}),a.jsxs("div",{className:"radio-group sales-mode",children:[a.jsxs("label",{className:"radio-option",children:[a.jsx("input",{type:"radio",name:"salesMode",value:"india",checked:e==="india",onChange:t}),a.jsx("span",{className:"radio-label",children:"India only"})]}),a.jsxs("label",{className:"radio-option",children:[a.jsx("input",{type:"radio",name:"salesMode",value:"global",checked:e==="global",onChange:t}),a.jsx("span",{className:"radio-label",children:"Global"})]})]})]})]})]})]})},Kue=({title:e,description:r,icon:t})=>a.jsxs("div",{className:"report-card",children:[a.jsxs("div",{className:"card-header",children:[a.jsx("div",{className:"icon",children:t}),a.jsx("h3",{children:e})]}),a.jsx("p",{children:r})]}),Xue=()=>{const e=ii(),r=()=>{e(-1)},t=[{title:"Sales Interactions",description:"Monitor interaction efforts by your team with your leads.",icon:a.jsx(h7,{})},{title:"No Interactions",description:"Identify team members who have not engaged with assigned leads.",icon:a.jsx(gz,{})},{title:"Follow-ups",description:"Track scheduled follow-ups to ensure timely engagement.",icon:a.jsx(tz,{})},{title:"No Appointments",description:"View sales team performance by tracking leads without scheduled appointments.",icon:a.jsx(mz,{})},{title:"Missed Appointments",description:"Analyze missed meetings per salesperson to improve scheduling and follow-ups.",icon:a.jsx(GO,{})},{title:"Travel History",description:"Track travel record of sales team.",icon:a.jsx(hz,{})}];return a.jsxs("div",{className:"reports-container",children:[a.jsxs("div",{className:"header",children:[a.jsx("h2",{children:"Lead Reports"}),a.jsxs("button",{className:"back-btn",onClick:r,children:[a.jsx(u7,{style:{marginRight:"5px"}}),"Back"]})]}),a.jsx("div",{className:"reports-grid",children:t.map((n,s)=>a.jsx(Kue,{...n},s))})]})},Yue=()=>{const e=ii(),[r,t]=G.useState([]),[n,s]=G.useState([]),[o,i]=G.useState(1),[c]=G.useState(10),[u,l]=G.useState(""),[d,h]=G.useState(""),[f,p]=G.useState("All"),[v,g]=G.useState("All"),[m,b]=G.useState("This Month"),[y,S]=G.useState("All"),[C,L]=G.useState("All Branches"),[O,H]=G.useState("All Executives"),[z,q]=G.useState([]),[D,W]=G.useState([]);G.useEffect(()=>{P()},[o]),G.useEffect(()=>{i(1),P()},[]);const P=async()=>{try{const j=await ut.get(`${Je}/api/quotations`,{params:{page:o,limit:c}});t(j.data.data||[]),s(j.data.data||[])}catch(j){console.error("Failed to fetch quotations",j)}};G.useEffect(()=>{(async()=>{try{try{const A=await ut.get(`${Je}/api/company-branches?limit=1000`),N=A.data&&A.data.data?A.data.data:A.data||[],V=Array.isArray(N)?N.map(M=>({id:M.id||M.ID||M.IDs,name:M.name||M.Name||M.company_branch_name||M.company_branch||""})):[];q(V)}catch(A){console.error("Failed to fetch branches",A),q([])}try{const A=await ut.get(`${Je}/api/employees/non-heads`),N=A.data&&A.data.data?A.data.data:A.data||[];W(Array.isArray(N)?N:[])}catch{try{const N=await ut.get(`${Je}/api/users`,{params:{page:1,limit:1e3,user_type:"employee"}}),V=N.data&&N.data.data?N.data.data:N.data||[];W(Array.isArray(V)?V:[])}catch(N){console.error("Failed to fetch executives",N),W([])}}}catch(A){console.error("Failed to fetch filter options",A)}})()},[]);const I=async j=>{window.confirm("Are you sure to delete this quotation?")&&(await ut.delete(`${Je}/api/quotations/${j}`),P())};G.useEffect(()=>{const j=KS.debounce(()=>{l(d)},400);return j(),()=>j.cancel&&j.cancel()},[d]),G.useEffect(()=>{i(1)},[u,v,m,y,C,O]),G.useEffect(()=>{(()=>{let A=(r||[]).slice();const N=(u||"").trim().toLowerCase();if(N&&(A=A.filter(V=>{var X,ne,Y,K,ee,ue;const M=(((X=V.customer)==null?void 0:X.company_name)||"").toLowerCase(),Z=`${((ne=V.customer)==null?void 0:ne.salutation)||""} ${((Y=V.customer)==null?void 0:Y.firstname)||""} ${((K=V.customer)==null?void 0:K.lastname)||""}`.toLowerCase(),J=(V.quotation_number||"").toLowerCase(),re=`${((ee=V.sales_credit_person)==null?void 0:ee.firstname)||""} ${((ue=V.sales_credit_person)==null?void 0:ue.lastname)||""}`.toLowerCase();return M.includes(N)||Z.includes(N)||J.includes(N)||re.includes(N)})),v&&v!=="All"&&(A=A.filter(V=>v==="Quotation"?V.document_type==="Quotation"||V.type==="Quotation"||!V.is_proforma:v==="Proforma Invoices"?V.document_type==="Proforma Invoices"||V.type==="Proforma Invoices"||V.is_proforma:!0)),y&&y!=="All"&&(A=A.filter(V=>(V.status||"").toLowerCase()===y.toLowerCase())),m){const V=new Date;A=A.filter(M=>{const Z=M.quotation_date?new Date(M.quotation_date):null;if(!Z)return!1;if(m==="This Month")return Z.getMonth()===V.getMonth()&&Z.getFullYear()===V.getFullYear();if(m==="Last Month"){const J=new Date(V.getFullYear(),V.getMonth()-1,1);return Z.getMonth()===J.getMonth()&&Z.getFullYear()===J.getFullYear()}else if(m==="This Year")return Z.getFullYear()===V.getFullYear();return!0})}C&&C!=="All Branches"&&(A=A.filter(V=>{const M=V.branch_id||V.company_branch_id||V.branch&&(V.branch.id||V.branch.ID);return String(M)===String(C)})),O&&O!=="All Executives"&&(A=A.filter(V=>{const M=V.sales_credit_person_id||V.sales_credit_person&&(V.sales_credit_person.id||V.sales_credit_person.ID);return String(M)===String(O)})),s(A)})()},[r,u,v,m,y,C,O]);const U=()=>{const j=n.length?n:r,A=j.reduce((V,M)=>V+(M.grand_total||0),0);return{preTax:A,total:A,count:j.length}},{preTax:k,total:_,count:R}=U();return a.jsxs("div",{className:"quotation-list",children:[a.jsxs("div",{className:"quotation-header",children:[a.jsx("h2",{children:"Quotations"}),a.jsxs("div",{className:"header-right",children:[a.jsxs("div",{className:"stats",children:[a.jsxs("span",{className:"stat-badge count",children:["Count: ",R]}),a.jsxs("span",{className:"stat-badge pretax",children:["Pre-Tax:  ",k.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]}),a.jsxs("span",{className:"stat-badge total",children:["Total:  ",_.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),a.jsxs("div",{className:"header-actions",children:[a.jsxs("div",{className:"search-box",children:[a.jsx("input",{type:"text",placeholder:"Search",value:d,onChange:j=>h(j.target.value)}),a.jsx("span",{className:"search-icon",children:a.jsx(M6,{})})]}),a.jsx("button",{className:"icon-btn",title:"Print Settings",children:"Print Settings"}),a.jsx("button",{className:"icon-btn square",title:"Export to Excel",children:a.jsx(p7,{})}),a.jsx("button",{className:"icon-btn square",title:"Display Preferences",children:a.jsx(f7,{})}),a.jsx("button",{className:"icon-btn square",title:"Summary",children:a.jsx(L6,{})}),a.jsx("button",{className:"icon-btn square settings",title:"Configuration",children:a.jsx(v2,{})})]})]})]}),a.jsxs("div",{className:"filters-row",children:[a.jsxs("div",{className:"doc-type-buttons",children:[a.jsx("button",{className:v==="All"?"active":"",onClick:()=>g("All"),children:"All"}),a.jsx("button",{className:v==="Quotation"?"active":"",onClick:()=>g("Quotation"),children:"Quotation"}),a.jsx("button",{className:v==="Proforma Invoices"?"active":"",onClick:()=>g("Proforma Invoices"),children:"Proforma Invoices"})]}),a.jsxs("select",{value:m,onChange:j=>b(j.target.value),children:[a.jsx("option",{children:"This Month"}),a.jsx("option",{children:"Last Month"}),a.jsx("option",{children:"This Year"})]}),a.jsxs("select",{value:y,onChange:j=>S(j.target.value),children:[a.jsx("option",{children:"All"}),a.jsx("option",{children:"Open"}),a.jsx("option",{children:"Expired"}),a.jsx("option",{children:"Rejected"}),a.jsx("option",{children:"Converted"}),a.jsx("option",{children:"Cancelled"}),a.jsx("option",{children:"Replaced"})]}),a.jsxs("select",{value:C,onChange:j=>L(j.target.value),children:[a.jsx("option",{children:"All Branches"}),z&&z.map(j=>a.jsxs("option",{value:j.id,children:[j.name,j.city?` - ${j.city}`:""]},j.id||j.name))]}),a.jsxs("select",{value:O,onChange:j=>H(j.target.value),children:[a.jsx("option",{children:"All Executives"}),D&&D.map(j=>{const A=`${j.firstname||j.first_name||j.FirstName||""} ${j.lastname||j.last_name||j.LastName||""}`.trim();return a.jsx("option",{value:j.id,children:A||j.username||j.email||"Unknown"},j.id||A)})]}),a.jsx("div",{className:"filters-right",children:a.jsx("button",{className:"btn-create",onClick:()=>e("/quotation"),children:"+ Create Quotation"})})]}),a.jsx("div",{className:"table-container",children:a.jsxs("table",{className:"quotation-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Quote No."}),a.jsx("th",{children:"Customer"}),a.jsx("th",{children:"Amount ()"}),a.jsx("th",{children:"Valid Till"}),a.jsx("th",{children:"Issued On"}),a.jsx("th",{children:"Issued by"}),a.jsx("th",{children:"Type"}),a.jsx("th",{children:"Executive"}),a.jsx("th",{children:"Response"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:n.map(j=>{var A,N,V,M,Z,J,re,X;return a.jsxs("tr",{children:[a.jsx("td",{children:j.quotation_number}),a.jsx("td",{children:((A=j.customer)==null?void 0:A.company_name)||`${((N=j.customer)==null?void 0:N.salutation)||""} ${((V=j.customer)==null?void 0:V.firstname)||""} ${((M=j.customer)==null?void 0:M.lastname)||""}`.replace(/\s+/g," ").trim()||"-"}),a.jsxs("td",{children:[" ",(j.grand_total||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]}),a.jsx("td",{children:j.valid_until?new Date(j.valid_until).toLocaleDateString("en-IN"):"-"}),a.jsx("td",{children:j.quotation_date?new Date(j.quotation_date).toLocaleDateString("en-IN"):"-"}),a.jsxs("td",{children:[(Z=j.sales_credit_person)==null?void 0:Z.firstname," ",((J=j.sales_credit_person)==null?void 0:J.lastname)||"-"]}),a.jsx("td",{children:"Quotation"}),a.jsxs("td",{children:[(re=j.sales_credit_person)==null?void 0:re.firstname," ",((X=j.sales_credit_person)==null?void 0:X.lastname)||"-"]}),a.jsx("td",{children:"-"}),a.jsxs("td",{children:[a.jsx(Yf,{onClick:()=>e(`/quotation/${j.quotation_id}`),style:{cursor:"pointer",marginRight:"10px"}}),a.jsx(Zf,{onClick:()=>I(j.quotation_id),style:{cursor:"pointer"}})]})]},j.quotation_id)})})]})}),a.jsxs("div",{className:"pagination",children:[a.jsx("button",{disabled:o===1,onClick:()=>i(o-1),children:"Previous"}),a.jsxs("span",{children:["Page ",o]}),a.jsx("button",{onClick:()=>i(o+1),children:"Next"})]})]})};function Zue({open:e,handleClose:r,initialSelections:t=[],end_customer_name:n,end_dealer_name:s}){const[o,i]=G.useState([]),[c,u]=G.useState(t||[]),[l,d]=G.useState(!1),[h,f]=G.useState(!1),[p,v]=G.useState(""),[g,m]=G.useState(""),[b,y]=G.useState(!1),[S,C]=G.useState(n||""),[L,O]=G.useState(s||""),[H,z]=G.useState(!0),[q,D]=G.useState(!0),[W,P]=G.useState(null),[I,U]=G.useState("");G.useEffect(()=>{Array.isArray(t)&&t.length>0&&u(t)},[t]),G.useEffect(()=>{C(n||""),O(s||"")},[n,s]),G.useEffect(()=>{(async()=>{try{const V=await(await fetch(`${Je}/api/tandc`)).json();i(V.data||[])}catch(N){console.error("Error fetching TandC:",N)}})()},[]);const k=A=>{u(N=>N.find(V=>V.ID===A.ID)?N.filter(V=>V.ID!==A.ID):[...N,A])},_=async()=>{if(!g.trim()){alert("Please enter a term/condition name");return}try{const A={TandcName:g,SaveForFuture:b},N=await fetch(`${Je}/api/tandc`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)});if(!N.ok)throw new Error("Failed to add term/condition");const V=await N.json(),M=V.data||{ID:V.ID,TandcName:g};i(Z=>[...Z,M]),u(Z=>[...Z,M]),m(""),y(!1),f(!1)}catch(A){console.error("Error adding new term/condition:",A),alert("Failed to add term/condition")}},R=o.filter(A=>A.TandcName&&A.TandcName.toLowerCase().includes(p.toLowerCase())),j=()=>{d(!1),typeof r=="function"&&r(c,S,L)};return a.jsxs("div",{className:"customer-info-container flex-column terms-cond",children:[a.jsx("h5",{children:"Terms & Conditions"}),c&&c.length>0&&a.jsx("div",{className:"selected-terms",children:c.map(A=>a.jsx("div",{className:"selected-term",children:W===A.ID?a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",width:"100%"},children:[a.jsx("input",{className:"form-control edit-input",value:I,onChange:N=>U(N.target.value),"aria-label":`Edit ${A.TandcName}`}),a.jsx("button",{type:"button",className:"btn-save",title:"Save",onClick:async()=>{const N=A.ID,V=I.trim();if(!V){alert("Term cannot be empty");return}u(M=>M.map(Z=>Z.ID===N?{...Z,TandcName:V}:Z)),i(M=>M.map(Z=>Z.ID===N?{...Z,TandcName:V}:Z)),P(null),U("");try{await fetch(`${Je}/api/tandc/${N}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({TandcName:V})})}catch(M){console.error("Failed to persist TandC edit",M)}},children:""}),a.jsx("button",{type:"button",className:"btn-cancel",title:"Cancel",onClick:()=>{P(null),U("")},children:""})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"term-text",children:A.TandcName}),a.jsxs("div",{style:{display:"flex",gap:6},children:[a.jsx("button",{type:"button",className:"btn-edit","aria-label":`Edit ${A.TandcName}`,title:"Edit",onClick:()=>{P(A.ID),U(A.TandcName||"")},children:a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[a.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25z",stroke:"currentColor",strokeWidth:"0",fill:"currentColor"}),a.jsx("path",{d:"M20.71 7.04a1 1 0 0 0 0-1.41l-2.34-2.34a1 1 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z",stroke:"currentColor",strokeWidth:"0",fill:"currentColor"})]})}),a.jsx("button",{type:"button",className:"btn-delete","aria-label":`Remove ${A.TandcName}`,title:"Remove",onClick:()=>u(N=>N.filter(V=>V.ID!==A.ID)),children:a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[a.jsx("path",{d:"M18 6L6 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})})]})]})},A.ID))}),a.jsx("div",{className:"mt-2",children:a.jsx("button",{className:"btn btn-add-term",onClick:()=>d(!0),children:"Add Term / Condition"})}),l&&a.jsx("div",{className:"custom-modal",children:a.jsxs("div",{className:"modal-box modal-width-450 modal-scroll",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h6",{children:"Select Terms & Conditions"}),a.jsx("button",{className:"btn btn-close",onClick:()=>d(!1),children:""})]}),a.jsxs("div",{className:"modal-body",children:[a.jsx("div",{style:{marginBottom:8},children:a.jsx("input",{className:"form-control",placeholder:"Search terms...",value:p,onChange:A=>v(A.target.value)})}),a.jsx("div",{className:"terms-list",children:R.length>0?R.map(A=>a.jsxs("label",{className:"term-item",children:[a.jsx("input",{type:"checkbox",checked:!!c.find(N=>N.ID===A.ID),onChange:()=>k(A)}),a.jsx("span",{className:"term-name",children:A.TandcName})]},A.ID)):a.jsx("div",{className:"muted",children:"No results found."})}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{className:"btn btn-add-new-term",onClick:()=>f(!0),children:"+ Add New Term/Condition"}),a.jsx("button",{className:"btn btn-primary",style:{marginLeft:8},onClick:j,children:"Done"})]})]})]})}),h&&a.jsx("div",{className:"custom-modal",children:a.jsxs("div",{className:"modal-box modal-width-450",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h6",{children:"Enter Term / Condition"}),a.jsx("button",{className:"btn btn-close",onClick:()=>f(!1),children:""})]}),a.jsxs("div",{className:"modal-body",children:[a.jsx("div",{style:{marginBottom:12},children:a.jsx("textarea",{className:"form-control",placeholder:"Enter New Term / Condition",value:g,onChange:A=>m(A.target.value),rows:"4",style:{resize:"vertical",minHeight:"80px"}})}),a.jsx("div",{className:"checkbox-group",style:{marginBottom:12},children:a.jsxs("label",{className:"checkbox-label",children:[a.jsx("input",{type:"checkbox",checked:b,onChange:A=>y(A.target.checked)}),a.jsx("span",{children:"Save for Future Use"})]})}),a.jsx("div",{className:"modal-footer",style:{justifyContent:"flex-start"},children:a.jsx("button",{className:"btn btn-add",onClick:_,children:"Add"})})]})]})})]})}const G1=({options:e=[],value:r="",onChange:t,placeholder:n="",allowCustom:s=!1})=>{const[o,i]=G.useState(!1),[c,u]=G.useState(""),[l,d]=G.useState(r||"");G.useEffect(()=>d(r||""),[r]);const h=e.filter(v=>v.toLowerCase().includes(c.toLowerCase())),f=v=>{d(v),u(""),i(!1),t&&t(v)},p=()=>{setTimeout(()=>i(!1),150),s&&t&&t(l)};return a.jsxs("div",{className:"searchable-select",children:[a.jsx("input",{className:"form-control",placeholder:n,value:o?c:l,onChange:v=>{u(v.target.value),i(!0),d(v.target.value)},onFocus:()=>i(!0),onBlur:p,onKeyDown:v=>{v.key==="Enter"&&(v.preventDefault(),h.length>0?f(h[0]):s&&(t&&t(l),i(!1)))}}),o&&h.length>0&&a.jsx("div",{className:"searchable-select-dropdown",children:h.map(v=>a.jsx("div",{className:"searchable-select-option",onMouseDown:()=>f(v),children:v},v))})]})},_0=e=>{if(!e||typeof e!="string")return null;const r=e.trim();if(!r)return null;const t=r.toLowerCase();if(t.startsWith("http://")||t.startsWith("https://")||t.startsWith("data:"))return r;const n=r.replace(/\\/g,"/");return n.startsWith("uploads/")?`${Je}/${n}`:`${Je}/uploads/${n}`},K1=e=>{if(!e)return null;const r=[e.image,e.thumbnail,e.Image,e.MainImage,e.mainImage];for(const n of r){const s=_0(n);if(s)return s}const t=Array.isArray(e.Variants)?e.Variants:Array.isArray(e.variants)?e.variants:[];for(const n of t){const s=Array.isArray(n==null?void 0:n.Images)?n.Images:Array.isArray(n==null?void 0:n.images)?n.images:[];if(Array.isArray(s)&&s.length>0){const c=_0(s[0]);if(c)return c}const o=(n==null?void 0:n.MainImage)||(n==null?void 0:n.Image)||(n==null?void 0:n.image)||(n==null?void 0:n.thumbnail),i=_0(o);if(i)return i}return null},Jue=(e,r,t)=>{if(!e)return{prefix:"",number:"",postfix:""};let n=e;return r&&n.startsWith(r)&&(n=n.slice(r.length)),t&&n.endsWith(t)&&(n=n.slice(0,-t.length)),{prefix:r,number:n,postfix:t}},Lj=()=>{const[e,r]=G.useState(!1),[t,n]=G.useState([]),[s,o]=G.useState(""),[i,c]=G.useState(null),[u,l]=G.useState([]),[d,h]=G.useState(""),f=ii(),p=G.useMemo(()=>{if(!d)return null;const oe=String(d);return(u||[]).find(Ve=>String((Ve==null?void 0:Ve.id)||(Ve==null?void 0:Ve.ID)||(Ve==null?void 0:Ve.user_id)||"")===oe)||null},[u,d]),v=new Date().toISOString().split("T")[0],[g,m]=G.useState(!1),[b,y]=G.useState(v),[S,C]=G.useState(v),[L,O]=G.useState(""),[H,z]=G.useState(""),[q,D]=G.useState(null),[W,P]=G.useState(null),[I,U]=G.useState(null),[k,_]=G.useState(null),[R,j]=G.useState(!0),[A,N]=G.useState(!1),[V,M]=G.useState(!1),[Z,J]=G.useState(null),[re,X]=G.useState(""),[ne,Y]=G.useState(""),[K,ee]=G.useState(""),[ue,se]=G.useState([]),[ce,fe]=G.useState([]),[ve,_e]=G.useState(""),[le,ke]=G.useState(null),[Te,pe]=G.useState(!1),[ye,ge]=G.useState(""),[De,He]=G.useState([]),[Xe,at]=G.useState([]),[dt,wt]=G.useState("list"),[$t,Bt]=G.useState(""),[ft,tr]=G.useState(""),[Me,tt]=G.useState([]),[Ze,St]=G.useState(0),[et,Ht]=G.useState({}),[Nt,kt]=G.useState([]),kr=oe=>{kt(Ve=>Ve.includes(oe)?Ve.filter(Qt=>Qt!==oe):[...Ve,oe])},Jt=()=>kt([]),Pt=()=>{if(!De||De.length===0)return;De.filter(Ve=>Nt.includes(Ve.ID)).forEach(Ve=>{try{Hr(Ve,!0)}catch(It){console.error("Failed to add selected product",It)}}),Jt(),pe(!1)},[Ur,Lr]=G.useState(!1),[vt,nr]=G.useState(null),[Cr,Dt]=G.useState({qty:1,rate:0,discount:0,discountPercent:0,hsn:"",gst:0,unit:"",leadTime:"",desc:"",variantId:null}),[je,ct]=G.useState(null),[nt,Pe]=G.useState(!1),[Qe,gt]=G.useState({name:"",description:"",qty:1,rate:0,unit:"no.s",hsn:"",gst:0}),xe=()=>{if(!Qe||!Qe.name){alert("Please provide a service name.");return}const oe=Number(Qe.qty)||0,Ve=Number(Qe.rate)||0,It=Number(Qe.gst)||0,Qt=oe*Ve,Lt=+(Qt*(It/100)/2).toFixed(2),jt=+(Qt+Lt*2).toFixed(2),cr={id:`service-${Date.now()}`,name:Qe.name,description:Qe.description||"",qty:oe,unit:Qe.unit||"no.s",hsn:Qe.hsn||"",rate:Ve,gst:It,taxable:+Qt.toFixed(2),cgst:Lt,sgst:Lt,amount:jt,variantId:null,_isService:!0,_rowId:`${Date.now()}-${Math.random().toString(36).slice(2,8)}`};tt(Jr=>{const ta=[...Jr,cr],Ta=ta.reduce((Ts,cs)=>Ts+(Number(cs.amount)||0),0);return St(+Ta.toFixed(2)),ta}),gt({name:"",description:"",qty:1,rate:0,unit:"no.s",hsn:"",gst:0}),Pe(!1)},[Oe,Ce]=G.useState([]),[de,be]=G.useState(!1),[Se,Ne]=G.useState(""),[ze,Re]=G.useState([]),[Ie,ae]=G.useState([]),[we,Fe]=G.useState(""),[Ye,me]=G.useState(""),[Be,Ge]=G.useState(""),[mt,_t]=G.useState({}),[ot,xt]=G.useState(!1),[zt,Vt]=G.useState(!1),[Ar,wr]=G.useState("percent"),[Nr,Dr]=G.useState(0),[Yr,Vr]=G.useState(null),[on,xn]=G.useState(null),[ia,yn]=G.useState("percent"),[oa,Qn]=G.useState(0),[za,pr]=G.useState(0),[Ir,$n]=G.useState(!1),[Fr,jr]=G.useState([]),[Le,rt]=G.useState([]),[Ke,pt]=G.useState(null),[rr,ur]=G.useState(null),[Rr,Kr]=G.useState(!1),[sr,jn]=G.useState([]),[Kt,qt]=G.useState({title:"",bankName:"",accountNo:"",branch:"",ifsc:"",swiftCode:""}),[Gr,fn]=G.useState(null),[rn,$a]=G.useState(null),la=rn?sr.find(oe=>String(oe.id)===String(rn)):null,[ja,mn]=G.useState(!1),[Or,wa]=G.useState(()=>{try{const oe=localStorage.getItem("printConfig");return oe?JSON.parse(oe):{header:!0,footer:!1,digitalSignature:!1,orgDupTrip:!1,partyInformation:!0,gstin:!0,branch:!0,bankDetails:!0,disclaimer:!1,mobile:!0,email:!0,contactPersonName:!0,companyBeforePOC:!1,totalBeforeRoundOff:!1,itemCode:!0,notes:!1,discountRate:!0,discountAmt:!0,taxableAmt:!0,hsnSac:!0,gstAmounts:!0,leadTime:!1,qtyInServices:!1,itemRate:!0,nonStockItemCode:!1,autoPadSmallDocs:!1}}catch{return{}}});G.useEffect(()=>{console.log(Ye)},[Ye]);const Vn=()=>mn(!0),Xs=()=>mn(!1),Qr=oe=>wa(Ve=>({...Ve,[oe]:!Ve[oe]})),qn=()=>{try{localStorage.setItem("printConfig",JSON.stringify(Or))}catch(oe){console.warn("Failed to save print config",oe)}mn(!1)},{id:ks}=Jv(),[wn,ka]=G.useState(!1),[Xn,st]=G.useState(null);G.useEffect(()=>{console.log("selectedEmployee ID:",d),console.log("selectedEmployeeObj:",p)},[d,p]),G.useEffect(()=>{console.log(ze)},[ze]),G.useEffect(()=>{console.log(Xn),wn&&Xn&&(console.log("Edit Mode - Loaded Data:",Xn),console.log("Extra Charges:",Xn.ExtraCharges),console.log("Discounts:",Xn.Discounts),console.log("Terms & Conditions:",Xn.terms_and_conditions))},[Xn,wn]),G.useEffect(()=>{console.log(t)},[t]);const Wt=async(oe="")=>{try{const It=await(await fetch(`${Je}/api/users?page=1&limit=10&filter=${encodeURIComponent(oe)}`)).json();console.log(It),n(It.data||[])}catch(Ve){console.error("Error fetching customers:",Ve)}},At=async()=>{try{let oe=null;try{const Qt=await fetch(`${Je}/api/employees/non-heads`);if(Qt.ok){oe=await Qt.json(),l(Array.isArray(oe.data)?oe.data:Array.isArray(oe)?oe:[]);return}}catch{}const It=await(await fetch(`${Je}/api/users?page=1&limit=50&user_type=employee`)).json();l(It.data||It||[])}catch(oe){console.error("Error fetching employees:",oe)}},Xt=async(oe="")=>{try{const It=await(await fetch(`${Je}/api/products?page=1&limit=50&filter=${encodeURIComponent(oe)}`)).json();console.log(It);let Qt=It.data||[];if(oe&&Qt.length>0){const Lt=oe.toString().toLowerCase();Qt=Qt.filter(jt=>{const cr=(jt.Name||jt.name||"").toString().toLowerCase(),Jr=(jt.Code||jt.code||jt.Sku||jt.SKU||"").toString().toLowerCase();return cr.includes(Lt)||Jr.includes(Lt)})}He(Qt)}catch(Ve){console.error("Error fetching products:",Ve)}},ht=async(oe="")=>{try{const It=await(await fetch(`${Je}/api/tandc`)).json();console.log(It),Ce(It.data||[])}catch(Ve){console.error("Error fetching TandC:",Ve)}},er=async()=>{try{const oe=await fetch(`${Je}/api/company-branches?limit=1000`),Ve=await oe.json();if(!oe.ok)throw new Error(Ve.error||"Failed to fetch branches");const It=Array.isArray(Ve.data)?Ve.data:Ve,Qt=Array.isArray(It)?It.map(Lt=>({id:Lt.id||Lt.ID,name:Lt.name||Lt.Name,city:Lt.city||Lt.City,state:Lt.state||Lt.State})):[];se(Qt)}catch(oe){console.error("Error fetching branches:",oe)}},mr=async()=>{try{const oe=await fetch(`${Je}/api/series?limit=1000`),Ve=await oe.json();if(!oe.ok)throw new Error(Ve.error||"Failed to fetch series");const It=Array.isArray(Ve.data)?Ve.data:Ve,Qt=Array.isArray(It)?It.map(Lt=>({id:Lt.id||Lt.ID,name:Lt.name||Lt.Name||"",prefix:Lt.prefix||Lt.Prefix||"",prefix_number:Lt.prefix_number||Lt.prefixNumber||Lt.prefix_number||""})):[];fe(Qt)}catch(oe){console.error("Error fetching series:",oe),fe([])}},ar=async()=>{try{const Ve=await(await fetch(`${Je}/api/company-branch-banks`)).json(),It=Array.isArray(Ve.data)?Ve.data:Array.isArray(Ve)?Ve:[],Qt=Array.isArray(It)?It.map(Lt=>({id:Lt.id||Lt.ID,bankName:Lt.bank_name||Lt.bankName||Lt.bank||"",accountNo:Lt.account_number||Lt.accountNo||Lt.account||"",branch:Lt.branch_name||Lt.branch||"",ifsc:Lt.ifsc_code||Lt.ifsc||"",title:Lt.title||Lt.bank_name||Lt.bankName||Lt.bank||""})):[];jn(Qt)}catch(oe){console.error("Error fetching bank details:",oe),jn([])}};G.useEffect(()=>{console.log(Oe)},[Oe]);const Mr=G.useMemo(()=>KS.debounce(Xt,500),[]),Wr=G.useMemo(()=>KS.debounce(async oe=>{if(!oe||!oe.trim()){at([]);return}try{let Qt=(await(await fetch(`${Je}/api/products?page=1&limit=20&filter=${encodeURIComponent(oe)}`)).json()).data||[];const Lt=oe.toString().toLowerCase();Qt=Qt.filter(jt=>{const cr=(jt.Name||jt.name||"").toString().toLowerCase(),Jr=(jt.Code||jt.code||jt.Sku||jt.SKU||"").toString().toLowerCase();return cr.includes(Lt)||Jr.includes(Lt)}),at(Qt.slice(0,10))}catch(Ve){console.error("Error fetching barcode suggestions",Ve),at([])}},400),[]);G.useEffect(()=>()=>{try{Wr.cancel()}catch{}},[Wr]),G.useEffect(()=>{Wt(),At(),Xt(),ht(),er(),mr(),ar()},[]),G.useEffect(()=>{var Qt,Lt;console.log(i),console.log(De);const oe=((Qt=Xn==null?void 0:Xn.customer)==null?void 0:Qt.id)||((Lt=Xn==null?void 0:Xn.customer)==null?void 0:Lt.ID),Ve=(i==null?void 0:i.id)||(i==null?void 0:i.ID);wn&&Xn&&oe&&Ve&&String(oe)===String(Ve)||(D(null),P(null),U(null),_(null),j(!0))},[i,wn,Xn]);const _n=oe=>{const Ve=oe.target.value;if(ge(Ve),Mr(Ve),Ve&&Ve.trim()){const It=Ve.toString().toLowerCase();He((Qt=[])=>(Qt||[]).filter(Lt=>{const jt=(Lt.Name||Lt.name||"").toString().toLowerCase(),cr=(Lt.Code||Lt.code||Lt.Sku||Lt.SKU||"").toString().toLowerCase();return jt.includes(It)||cr.includes(It)}))}else Xt()},en=async oe=>{const Ve=(ye||"").trim();if(Ve)try{let Lt=(await(await fetch(`${Je}/api/products?page=1&limit=50&filter=${encodeURIComponent(Ve)}`)).json()).data||[];const jt=Ve.toString().toLowerCase(),cr=Lt.find(Jr=>[Jr.Code,Jr.code,Jr.Sku,Jr.SKU,Jr.Barcode,Jr.barcode,Jr.bar_code,Jr.Bar_code,Jr.BarcodeNumber,Jr.barcode_number].some(Ta=>Ta!=null&&Ta.toString().toLowerCase()===jt));if(cr){Hr(cr),ge("");return}if(Lt.length===1){Hr(Lt[0]),ge("");return}if(Lt.length>1){He(Lt),pe(!0);return}alert("No product found for scanned barcode/code: "+Ve)}catch(It){console.error("Barcode search failed",It),alert("Failed to search product by barcode. See console for details.")}},Yt=()=>{pe(!0),Xt()},xr=()=>pe(!1);G.useEffect(()=>{const oe=Me.reduce((Ve,It)=>Ve+It.amount,0);St(oe)},[Me]);const Hr=(oe,Ve=!1)=>{var cr;const Qt=((cr=oe.Variants)==null?void 0:cr[0])||null,Lt=(Qt==null?void 0:Qt.PurchaseCost)||0,jt=0;tt(Jr=>{var Ts,cs,Ps,Yi,wl;const ta=Array.isArray(Jr)?[...Jr]:[],Ta=ta.findIndex(oi=>String(oi.id)===String(oe.ID)?Qt&&Qt.ID?String(oi.variantId||"")===String(Qt.ID):!0:!1);if(Ta>=0&&!Ve){const oi={...ta[Ta]},Xo=(Number(oi.qty)||0)+1,li=Lt*Xo-(oi.discount||0),Yo=li*(((Ts=oe.Tax)==null?void 0:Ts.Percentage)||0)/2/100,Ju=li*(((cs=oe.Tax)==null?void 0:cs.Percentage)||0)/2/100,Kd=li+Yo+Ju;ta[Ta]={...oi,qty:Xo,rate:Lt,taxable:li,cgst:Yo,sgst:Ju,amount:Kd}}else{const oi=Lt*1-jt,Xo=oi*(((Ps=oe.Tax)==null?void 0:Ps.Percentage)||0)/2/100,li=oi*(((Yi=oe.Tax)==null?void 0:Yi.Percentage)||0)/2/100,Yo=oi+Xo+li;ta.push({_rowId:`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,id:oe.ID,name:oe.Name,image:K1(oe),hsn:oe.HsnSacCode,unit:(wl=oe.Unit)==null?void 0:wl.name,code:oe.Code||oe.code||oe.Sku||oe.SKU||"",Code:oe.Code||oe.code||oe.Sku||oe.SKU||"",sku:oe.Sku||oe.SKU||oe.Code||oe.code||"",variantId:(Qt==null?void 0:Qt.ID)||null,qty:1,rate:Lt,discount:jt,taxable:oi,cgst:Xo,sgst:li,amount:Yo,desc:"",leadTime:oe.LeadTime})}return ta}),pe(!1)},Na=(oe,Ve=null)=>{var Qt,Lt,jt;if(ct(Ve),oe&&(oe.qty!==void 0||oe.rate!==void 0||oe.amount!==void 0)){const cr=Number(oe.qty)||1,Jr=Number(oe.rate)||0,ta=Number(oe.discount)||0,Ta=cr*Jr>0?ta/(cr*Jr)*100:0,Ts=oe.taxable!==void 0?Number(oe.taxable):cr*Jr-ta,cs=Ts>0?((Number(oe.cgst)||0)+(Number(oe.sgst)||0))/Ts*100:0,Ps={Name:oe.name||oe.desc||"",Code:oe.sku||oe.Code||"",ID:oe.id||oe.product_id||null};nr(Ps),Dt({qty:cr,rate:Jr,discount:ta,discountPercent:Math.round(Ta*100)/100,hsn:oe.hsn||oe.HsnSacCode||"",gst:Math.round(cs*100)/100,unit:oe.unit||"",leadTime:oe.leadTime||oe.lead_time||"",desc:oe.desc||oe.description||oe.name||"",variantId:oe.variantId||oe.variant_id||null}),Lr(!0);return}const It=((Qt=oe.Variants)==null?void 0:Qt[0])||null;nr(oe),Dt({qty:1,rate:(It==null?void 0:It.PurchaseCost)||0,discount:0,discountPercent:0,hsn:oe.HsnSacCode||"",gst:((Lt=oe.Tax)==null?void 0:Lt.Percentage)||0,unit:((jt=oe.Unit)==null?void 0:jt.name)||"",leadTime:oe.LeadTime||"",desc:oe.Name||"",variantId:(It==null?void 0:It.ID)||null}),Lr(!0)},Ra=()=>{var Ta;if(!vt)return;const oe=Cr,Ve=Number(oe.qty)||0,It=Number(oe.rate)||0;let Qt=Number(oe.discount)||0;Number(oe.discountPercent)>0&&(Qt=It*Ve*(Number(oe.discountPercent)/100));const Lt=It*Ve-Qt,jt=Lt*(Number(oe.gst)||0)/2/100,cr=Lt*(Number(oe.gst)||0)/2/100,Jr=Lt+jt+cr,ta={_rowId:`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,id:vt.ID,name:oe.desc||vt.Name,hsn:oe.hsn,unit:oe.unit,variantId:oe.variantId,qty:Ve,rate:It,discount:Qt,taxable:Lt,cgst:jt,sgst:cr,amount:Jr,desc:oe.desc||vt.Name,leadTime:oe.leadTime,image:K1(vt)||vt.image||vt.thumbnail||je!==null&&((Ta=Me==null?void 0:Me[je])==null?void 0:Ta.image)||null,sku:vt.Sku||vt.SKU||vt.Code||vt.code||"",code:vt.Code||vt.code||vt.Sku||vt.SKU||"",Code:vt.Code||vt.code||vt.Sku||vt.SKU||""};tt(Ts=>{const cs=[...Ts];if(je!==null&&cs[je]){const Ps=cs[je]._rowId||ta._rowId;cs[je]={...cs[je],...ta,_rowId:Ps}}else cs.push(ta);return cs}),Lr(!1),pe(!1)},Xi=oe=>{const Ve=oe.target.value?Number(oe.target.value):null;if(D(Ve),Ve&&i){const It=(i.addresses||[]).find(Qt=>(Qt.id||Qt.ID)==Ve);P(Za(It)||null)}else P(null)},hn=oe=>{const Ve=oe.target.value;if(Ve==="none"){j(!0),U(null),_(null);return}const It=Ve?Number(Ve):null;if(U(It),It&&i){const Qt=(i.addresses||[]).find(Lt=>(Lt.id||Lt.ID)==It);_(Za(Qt)||null)}else _(null)},[Oi,Rs]=G.useState(!1),[Ys,Do]=G.useState("billing"),[ea,Gn]=G.useState({title:"",show_title_in_shipping:!1,address1:"",address2:"",city:"",country:"India",state:"",postal_code:"",gst_in:"",extra_key:"",extra_value:""}),Za=oe=>{if(!oe)return null;const Ve={...oe};return oe.ID&&!oe.id&&(Ve.id=oe.ID),Ve.title=oe.title||oe.Title||"",Ve.address1=oe.address1||oe.Address1||"",Ve.address2=oe.address2||oe.Address2||"",Ve.city=oe.city||oe.City||"",Ve.state=oe.state||oe.State||"",Ve.country=oe.country||oe.Country||"India",Ve.postal_code=oe.postal_code||oe.pincode||oe.Pincode||oe.pin||oe.zipcode||oe.ZipCode||"",Ve.gst_in=oe.gst_in||oe.gstin||oe.GSTIN||oe.gst||"",Ve},Zu=["Afghanistan","Albania","Algeria","Andorra","Angola","Antigua and Barbuda","Argentina","Armenia","Australia","Austria","Azerbaijan","Bahamas","Bahrain","Bangladesh","Barbados","Belarus","Belgium","Belize","Benin","Bhutan","Bolivia","Bosnia and Herzegovina","Botswana","Brazil","Brunei","Bulgaria","Burkina Faso","Burundi","Cte d'Ivoire","Cabo Verde","Cambodia","Cameroon","Canada","Central African Republic","Chad","Chile","China","Colombia","Comoros","Costa Rica","Croatia","Cuba","Cyprus","Czech Republic","Democratic Republic of the Congo","Denmark","Djibouti","Dominica","Dominican Republic","Ecuador","Egypt","El Salvador","Equatorial Guinea","Eritrea","Estonia","Eswatini","Ethiopia","Fiji","Finland","France","Gabon","Gambia","Georgia","Germany","Ghana","Greece","Grenada","Guatemala","Guinea","Guinea-Bissau","Guyana","Haiti","Honduras","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Jamaica","Japan","Jordan","Kazakhstan","Kenya","Kiribati","Kosovo","Kuwait","Kyrgyzstan","Laos","Latvia","Lebanon","Lesotho","Liberia","Libya","Liechtenstein","Lithuania","Luxembourg","Madagascar","Malawi","Malaysia","Maldives","Mali","Malta","Marshall Islands","Mauritania","Mauritius","Mexico","Micronesia","Moldova","Monaco","Mongolia","Montenegro","Morocco","Mozambique","Myanmar","Namibia","Nauru","Nepal","Netherlands","New Zealand","Nicaragua","Niger","Nigeria","North Korea","North Macedonia","Norway","Oman","Pakistan","Palau","Panama","Papua New Guinea","Paraguay","Peru","Philippines","Poland","Portugal","Qatar","Republic of the Congo","Romania","Russia","Rwanda","Saint Kitts and Nevis","Saint Lucia","Saint Vincent and the Grenadines","Samoa","San Marino","Sao Tome and Principe","Saudi Arabia","Senegal","Serbia","Seychelles","Sierra Leone","Singapore","Slovakia","Slovenia","Solomon Islands","Somalia","South Africa","South Korea","South Sudan","Spain","Sri Lanka","Sudan","Suriname","Sweden","Switzerland","Syria","Taiwan","Tajikistan","Tanzania","Thailand","Timor-Leste","Togo","Tonga","Trinidad and Tobago","Tunisia","Turkey","Turkmenistan","Tuvalu","Uganda","Ukraine","United Arab Emirates","United Kingdom","United States","Uruguay","Uzbekistan","Vanuatu","Vatican City","Venezuela","Vietnam","Yemen","Zambia","Zimbabwe"],ls=["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Goa","Gujarat","Haryana","Himachal Pradesh","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal","Delhi","Puducherry","Ladakh","Jammu and Kashmir","Andaman and Nicobar Islands","Chandigarh","Dadra and Nagar Haveli and Daman and Diu"],Es=(oe="billing")=>{if(!i){alert("Please select a customer first.");return}Do(oe),Gn({title:"",show_title_in_shipping:!1,address1:"",address2:"",city:"",country:"India",state:"",postal_code:"",gst_in:"",extra_key:"",extra_value:""}),Rs(!0)},Ns=(oe="billing")=>{if(!i){alert("Please select a customer first.");return}Do(oe);const Ve=oe==="billing"?W:k;if(!Ve){alert("No address selected to edit.");return}J(Ve.id||Ve.ID||null),Gn({title:Ve.title||"",show_title_in_shipping:Ve.show_title_in_shipping||!1,address1:Ve.address1||"",address2:Ve.address2||"",city:Ve.city||"",country:Ve.country||"India",state:Ve.state||"",postal_code:Ve.postal_code||Ve.pincode||Ve.pin||Ve.zipcode||"",gst_in:Ve.gst_in||Ve.gstin||Ve.gst||"",extra_key:Ve.extra&&typeof Ve.extra=="object"?Object.keys(Ve.extra)[0]:Ve.extra&&typeof Ve.extra=="string"?"extra":"",extra_value:Ve.extra&&typeof Ve.extra=="object"?Object.values(Ve.extra)[0]:Ve.extra&&typeof Ve.extra=="string"?Ve.extra:""}),Rs(!0)},yl=()=>{if(!ea.title||!ea.address1){alert("Please provide Title and Address Line 1.");return}const oe=ea.extra_key&&ea.extra_key.trim()?{[ea.extra_key.trim()]:ea.extra_value}:ea.extra_value&&ea.extra_value.trim()?{extra:ea.extra_value}:null,Ve={title:ea.title,address1:ea.address1,address2:ea.address2,city:ea.city,state:ea.state,country:ea.country,postal_code:ea.postal_code,gst_in:ea.gst_in,extra:oe};if(Z){const Lt=(i.addresses||[]).map(cr=>(cr.id||cr.ID)==Z?{...cr,...Ve}:cr),jt={...i,addresses:Lt};if(c(jt),n(cr=>cr.map(Jr=>Jr.id==jt.id||Jr.ID==jt.id||Jr.id==jt.ID||Jr.ID==jt.ID?jt:Jr)),Ys==="billing"){const cr=Lt.find(Jr=>(Jr.id||Jr.ID)==Z);D(Z),P(Za(cr)||null),R&&(U(Z),_(Za(cr)||null))}else{const cr=Lt.find(Jr=>(Jr.id||Jr.ID)==Z);U(Z),_(Za(cr)||null)}J(null),Rs(!1);return}const It={id:Date.now(),...Ve},Qt={...i,addresses:[...i.addresses||[],It]};c(Qt),n(Lt=>Lt.map(jt=>jt.id==Qt.id||jt.ID==Qt.id||jt.id==Qt.ID||jt.ID==Qt.ID?Qt:jt)),Ys==="billing"?(D(It.id),P(Za(It)),R&&(U(It.id),_(Za(It)))):(U(It.id),_(Za(It))),Rs(!1)},_c=async()=>{var Lt;if(!i)return alert("Select a customer.");if(!d)return alert("Select a sales credit.");if(!Me.length)return alert("Add at least one item.");let oe=Number(Ze)||0;Fr.forEach(jt=>{jt.type==="percent"?oe+=Ze*jt.value/100:oe+=jt.value}),Le.forEach(jt=>{jt.type==="percent"?oe-=Ze*jt.value/100:oe-=jt.value});const Ve=Ir?Number((Math.round(oe)-oe).toFixed(2)):0,It=Number(Ir?Math.round(oe):oe),Qt={quotation:{series_id:ve?Number(ve):null,company_branch_id:le&&(le.id||le.ID)?Number(le.id||le.ID):null,company_id:le&&(le.company_id||le.companyID)?Number(le.company_id||le.companyID):null,company_branch_bank_id:rn,quotation_number:Ie,quotation_date:new Date(b).toISOString(),customer_id:Number(i.id),sales_credit_person_id:d?Number(d):null,quotation_scp_count:wn?Number((mt==null?void 0:mt.max_quotation_scp_count)||0):Number((mt==null?void 0:mt.max_quotation_scp_count)||0)+1,valid_until:new Date(S).toISOString(),contact_person:H,total_amount:Number(Ze)||0,tax_amount:0,roundoff_amount:Ve,grand_total:Number(It)||0,extra_charges:Fr,discounts:Le,status:"Draft",created_by:Number(d),billing_address_id:q?Number(q):null,shipping_address_id:R?q?Number(q):null:I?Number(I):null,terms_and_conditions:ze,note:L,references:re,end_customer_name:ne,end_dealer_name:K},quotation_items:Me.map(jt=>({product_id:Number(jt.id)||0,product_code:jt.sku||"",description:jt.desc||jt.name||"",quantity:Number(jt.qty)||0,unit:jt.unit||"",rate:Number(jt.rate)||0,lead_time:String(jt.leadTime||""),hsncode:jt.hsn||"",gst:Number(jt.gst||0),tax_amount:Number((jt.cgst||0)+(jt.sgst||0))||0,line_total:Number(jt.amount)||0}))};try{if(console.log("Quotation payload (JS object):",Qt),console.log("Quotation items JSON string:",JSON.stringify(Qt.quotation_items)),m(!0),!Ke){wn&&ks?(await ut.put(`${Je}/api/quotations/${ks}`,Qt),alert("Quotation updated successfully.")):(await ut.post(`${Je}/api/quotations`,Qt),alert("Quotation saved successfully.")),f("/quotation-list");return}const jt=new FormData;jt.append("quotation",JSON.stringify(Qt.quotation)),jt.append("quotation_items",JSON.stringify(Qt.quotation_items)),jt.append("attachment",Ke),wn&&ks?(await ut.put(`${Je}/api/quotations/${ks}`,jt),alert("Quotation updated successfully.")):(await ut.post(`${Je}/api/quotations`,jt),alert("Quotation saved successfully.")),f("/quotation-list")}catch(jt){console.error(((Lt=jt==null?void 0:jt.response)==null?void 0:Lt.data)||jt),alert(`Failed to ${wn?"update":"save"} quotation.`)}finally{m(!1)}},Vd=()=>r(!1),Wd=oe=>{console.log("search cliked");const Ve=oe.target.value;o(Ve),Wt(Ve)},Ac=oe=>{c(oe);const Ve=`${oe.firstname||""} ${oe.lastname||""}`.trim();if(z(Ve),oe.addresses&&Array.isArray(oe.addresses)&&oe.addresses.length>0){const It=oe.addresses[0].id||oe.addresses[0].ID||null;D(It),R&&U(It)}else D(null),R&&U(null);Vd()},ah=()=>{f("/users/add")},nu=()=>{Wt(),r(!0)},sh=(oe=null)=>{oe?(qt({bankName:oe.bankName||"",accountNo:oe.accountNo||"",branch:oe.branch||"",ifsc:oe.ifsc||"",swiftCode:oe.swiftCode||"",title:oe.title||""}),fn(oe.id||null)):(qt({bankName:"",accountNo:"",branch:"",ifsc:"",swiftCode:"",title:""}),fn(null)),Kr(!0)},au=()=>{Kr(!1),qt({bankName:"",accountNo:"",branch:"",ifsc:"",swiftCode:""}),fn(null)},qd=()=>{if(!Kt.bankName.trim()){alert("Please enter Bank Name");return}if(!Kt.accountNo.trim()){alert("Please enter Account No.");return}if(Gr)jn(oe=>oe.map(Ve=>Ve.id===Gr?{...Ve,bankName:Kt.bankName,accountNo:Kt.accountNo,branch:Kt.branch,ifsc:Kt.ifsc,swiftCode:Kt.swiftCode,title:Kt.title}:Ve)),$a(oe=>oe===Gr?Gr:oe);else{const oe={id:Date.now(),bankName:Kt.bankName,accountNo:Kt.accountNo,branch:Kt.branch,ifsc:Kt.ifsc,swiftCode:Kt.swiftCode,title:Kt.title};jn(Ve=>[...Ve,oe]),$a(oe.id)}au()};G.useEffect(()=>{console.log(Ie)},[Ie]);const ih=async oe=>{const Ve=oe.target.value;if(_e(Ve),!Ve){ae(Ye||""),Fe("");return}const It=ce.find(jt=>String(jt.id)===String(Ve)),Qt=(It==null?void 0:It.prefix)||"QTN",Lt=(It==null?void 0:It.prefix_number)||"";try{let jt=0;if(!d)console.warn("No sales credit person selected yet"),_t({max_quotation_scp_count:0});else{const Yi=await ut.get(`${Je}/api/quotations/max-scp-count/${d}`);console.log(Yi.data);let wl=Yi.data;_t(wl),jt=wl.max_quotation_scp_count||0}const Jr=new Date().getFullYear(),ta=Jr+1,Ta=`${String(Jr).slice(-2)}-${String(ta).slice(-2)}`;Ge(Ta);const Ts=jt+1,cs=jt;me(String(Ts));const Ps=`${Qt}/${Lt}/${Ts}/${Ta}`;if(ae(Ps),cs>0){const Yi=`${Qt}/${Lt}/${cs}/${Ta}`;Fe(Yi)}else Fe("")}catch(jt){console.error("Failed to generate quotation number:",jt)}},ep=async oe=>{h(oe.target.value),console.log(oe.target.value)};G.useEffect(()=>{let oe=Ze;Fr.forEach(Ve=>{Ve.type==="percent"?oe+=Ze*Ve.value/100:oe+=Ve.value}),Le.forEach(Ve=>{Ve.type==="percent"?oe-=Ze*Ve.value/100:oe-=Ve.value}),pr(Ir?Math.round(Number(oe)):oe)},[Ze,Fr,Le,Ir]),G.useEffect(()=>{/^\d+$/.test(String(ks||""))?(ka(!0),Gd()):ks&&(console.warn("Invalid quotation id param:",ks),alert("Invalid quotation ID in URL. Returning to list."),f("/quotation-list"))},[ks]),G.useEffect(()=>{},[ue,Xn,wn,le]),G.useEffect(()=>{var Ve,It;if(!wn||!Xn)return;const oe=Xn.company_branch_bank_id||Xn.company_bank_id||Xn.bank_id||((Ve=Xn.bank)==null?void 0:Ve.id)||((It=Xn.bank)==null?void 0:It.ID);if(oe&&sr.length>0&&!rn){const Qt=sr.find(Lt=>String(Lt.id)===String(oe)||String(Lt.id)===String(Xn.bank_id));if(Qt){$a(Qt.id);return}}if(Xn.bank&&sr.length>0&&!rn){const Qt=Xn.bank.accountNo||Xn.bank.account_number||Xn.bank.account;if(Qt){const Lt=sr.find(jt=>String(jt.accountNo)===String(Qt));Lt&&$a(Lt.id)}}},[sr,Xn,wn,rn]),G.useEffect(()=>{R&&U(q)},[R,q]),G.useEffect(()=>{if(i&&q){const oe=(i.addresses||[]).find(Ve=>(Ve.id||Ve.ID)==q);P(Za(oe)||null)}else P(null)},[q,i]),G.useEffect(()=>{if(i&&I){const oe=(i.addresses||[]).find(Ve=>(Ve.id||Ve.ID)==I);_(Za(oe)||null)}else _(null)},[I,i]);const Gd=async()=>{var oe;try{const It=(await ut.get(`${Je}/api/quotations/${ks}`)).data;st(It),console.log("Fetched quotation data:",It),Kl(It)}catch(Ve){console.error("Error fetching quotation data:",Ve),((oe=Ve.response)==null?void 0:oe.status)===404?(alert(`Quotation with ID ${ks} not found. It may have been deleted or doesn't exist.`),f("/quotation-list")):alert("Failed to load quotation data. Please check your connection and try again.")}},Kl=async oe=>{var Ve,It,Qt,Lt;if(console.log("Prefilling form with data:",oe),oe.customer){c(oe.customer);const jt=await ut.get(`${Je}/api/users/${oe.customer.id}`);console.log("this is customer"),console.log(jt),Ac(jt.data.user)}if(oe.contact_person&&z(oe.contact_person),oe.company_branch&&(oe.company_branch.ID||oe.company_branch.id)){const jt={id:oe.company_branch.ID||oe.company_branch.id,name:oe.company_branch.Name||oe.company_branch.name||"",state:oe.company_branch.State||oe.company_branch.state||"",gst:oe.company_branch.GST||oe.company_branch.gst||""};console.log("Setting branch:",jt),ke(jt)}else if(oe.branch_id){const jt=ue.find(cr=>(cr.id||cr.ID)==oe.branch_id);jt&&ke(jt)}if(oe.series_id){_e(oe.series_id.toString());const jt=Jue(oe.quotation_number,oe.series.prefix,oe.series.postfix);me(String(jt.number))}if(oe.billing_address&&(oe.billing_address.id||oe.billing_address.ID)){const jt=oe.billing_address.id||oe.billing_address.ID;console.log("Setting billing address:",oe.billing_address,"ID:",jt),D(jt),P(Za(oe.billing_address))}else if(oe.billing_address_id&&(D(oe.billing_address_id),(Ve=oe.customer)!=null&&Ve.addresses)){const jt=oe.customer.addresses.find(cr=>(cr.id||cr.ID)==oe.billing_address_id);jt&&P(Za(jt))}if(oe.shipping_address&&(oe.shipping_address.id||oe.shipping_address.ID)){const jt=oe.shipping_address.id||oe.shipping_address.ID,cr=((It=oe.billing_address)==null?void 0:It.id)||((Qt=oe.billing_address)==null?void 0:Qt.ID);console.log("Setting shipping address:",oe.shipping_address,"ID:",jt),U(jt),_(Za(oe.shipping_address)),j(jt===cr)}else if(oe.shipping_address_id){if(U(oe.shipping_address_id),(Lt=oe.customer)!=null&&Lt.addresses){const jt=oe.customer.addresses.find(cr=>(cr.id||cr.ID)==oe.shipping_address_id);jt&&_(Za(jt))}j(oe.shipping_address_id===oe.billing_address_id)}else j(!0);if(oe.sales_credit_person_id&&h(oe.sales_credit_person_id.toString()),oe.quotation_date&&y(oe.quotation_date.split("T")[0]),oe.valid_until&&C(oe.valid_until.split("T")[0]),oe.quotation_number&&ae(oe.quotation_number),oe.quotation_number&&oe.series_id)try{const jt=String(oe.quotation_number).split("/");if(jt.length>=3){const cr=jt[2]||"";me(String(cr)),jt.length>=4&&Ge(jt[3]);const Jr=parseInt(cr,10);if(!isNaN(Jr)&&Jr>0){const ta=Jr-1,Ta=ce.find(Yi=>String(Yi.id)===String(oe.series_id)),Ts=(Ta==null?void 0:Ta.prefix)||jt[0]||"",cs=(Ta==null?void 0:Ta.prefix_number)||jt[1]||"",Ps=jt[3]||"";Fe(`${Ts}/${cs}/${ta}/${Ps}`)}}}catch(jt){console.warn("Failed to parse quotation_number for seq/year:",jt)}if(oe.note&&O(oe.note),oe.references&&X(oe.references),oe.end_customer_name&&Y(oe.end_customer_name),oe.end_dealer_name&&ee(oe.end_dealer_name),oe.attachment_path&&(console.log("Attachment path:",oe.attachment_path),ur(oe.attachment_path)),oe.quotation_items&&oe.quotation_items.length>0){const jt=oe.quotation_items.map(cr=>{var wl,oi,Xo,li,Yo,Ju,Kd,Pi,Io,Zi,Xd,oh,lh,Yd,tp,Cc,Sl,Ct,lr,Zt,qr,kn,ga,Ls,va,Qu;let Jr=null;if((wl=cr.product)!=null&&wl.Variants&&cr.product.Variants.length>0){const su=cr.product.Variants[0];su!=null&&su.Images&&su.Images.length>0&&(Jr=su.Images[0])}!Jr&&cr.product&&(Jr=K1(cr.product));const ta=cr.quantity||0,Ta=cr.rate||0,Ts=cr.line_total||0,cs=cr.tax_amount||0,Ps=Ts-cs,Yi=Ta*ta-Ps;return{_rowId:`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,id:cr.product_id,name:cr.description||((oi=cr.product)==null?void 0:oi.Name)||"",image:Jr,hsn:cr.hsncode||((Xo=cr.product)==null?void 0:Xo.HsnSacCode)||((li=cr.product)==null?void 0:li.hsn_sac_code)||"",unit:cr.unit||((Ju=(Yo=cr.product)==null?void 0:Yo.Unit)==null?void 0:Ju.name)||((Pi=(Kd=cr.product)==null?void 0:Kd.unit)==null?void 0:Pi.name)||"",variantId:((Xd=(Zi=(Io=cr.product)==null?void 0:Io.Variants)==null?void 0:Zi[0])==null?void 0:Xd.ID)||null,qty:cr.quantity,rate:cr.rate,discount:Yi>0?Yi:0,taxable:Ps,cgst:cs/2,sgst:cs/2,amount:Ts,desc:cr.description||((oh=cr.product)==null?void 0:oh.Name)||"",leadTime:cr.lead_time||((lh=cr.product)==null?void 0:lh.LeadTime)||((Yd=cr.product)==null?void 0:Yd.lead_time)||"",sku:cr.product_code||((tp=cr.product)==null?void 0:tp.Sku)||((Cc=cr.product)==null?void 0:Cc.SKU)||((Sl=cr.product)==null?void 0:Sl.Code)||((Ct=cr.product)==null?void 0:Ct.code)||"",code:cr.product_code||((lr=cr.product)==null?void 0:lr.Code)||((Zt=cr.product)==null?void 0:Zt.code)||((qr=cr.product)==null?void 0:qr.Sku)||((kn=cr.product)==null?void 0:kn.SKU)||"",Code:cr.product_code||((ga=cr.product)==null?void 0:ga.Code)||((Ls=cr.product)==null?void 0:Ls.code)||((va=cr.product)==null?void 0:va.Sku)||((Qu=cr.product)==null?void 0:Qu.SKU)||""}});tt(jt)}if(oe.terms_and_conditions){if(Array.isArray(oe.terms_and_conditions))Re(oe.terms_and_conditions);else if(typeof oe.terms_and_conditions=="string")try{const jt=JSON.parse(oe.terms_and_conditions);Array.isArray(jt)&&Re(jt)}catch{Re([oe.terms_and_conditions])}}if(oe.extra_charges||oe.ExtraCharges){const jt=oe.extra_charges||oe.ExtraCharges;if(Array.isArray(jt))jr(jt);else if(typeof jt=="string")try{const cr=JSON.parse(jt);Array.isArray(cr)&&jr(cr)}catch(cr){console.error("Failed to parse extra charges:",cr)}}if(oe.discounts||oe.Discounts){const jt=oe.discounts||oe.Discounts;if(Array.isArray(jt))rt(jt);else if(typeof jt=="string")try{const cr=JSON.parse(jt);Array.isArray(cr)&&rt(cr)}catch(cr){console.error("Failed to parse discounts:",cr)}}oe.total_amount&&St(parseFloat(oe.total_amount)),oe.grand_total&&pr(parseFloat(oe.grand_total)),oe.quotation_scp_count&&_t({max_quotation_scp_count:oe.quotation_scp_count-1})};return a.jsxs("section",{className:"right-content create-quotation",children:[a.jsxs("div",{className:"top-bar",children:[a.jsx("div",{className:"title",children:"Create Quotation"}),a.jsxs("div",{className:"actions",children:[a.jsxs("button",{className:"btn btn--print",onClick:Vn,children:[a.jsx("span",{children:a.jsx(rP,{})}),"Print Settings"]}),a.jsxs("button",{className:"btn btn--back",onClick:()=>f(-1),children:[a.jsx("span",{children:a.jsx(uz,{})}),"Back"]}),wn&&a.jsxs("button",{className:"btn btn--save",onClick:()=>_c(),disabled:g,children:[a.jsx(Z4,{})," Update"]}),a.jsxs("button",{className:"btn btn--save",onClick:()=>_c(),disabled:g,children:[a.jsx(j0,{})," Save"]})]})]}),a.jsxs("div",{className:"section-card basic-info-card",children:[a.jsx("h5",{className:"section-title",children:"Basic Information"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group left-start",children:[a.jsx("label",{htmlFor:"customer",children:"Customer :"}),a.jsxs("div",{className:"input-with-actions",children:[a.jsx("input",{id:"customer",type:"text",className:"form-control",value:i&&i.company_name||"",onClick:()=>nu(),readOnly:!0}),a.jsx("button",{onClick:()=>ah(),className:"btn-icon btn-add",children:a.jsx(J4,{})})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"branchSelect",children:"Branch :"}),a.jsxs("select",{id:"branchSelect",className:"form-control",value:(le==null?void 0:le.id)||"",onChange:oe=>{const Ve=oe.target.value,It=ue.find(Qt=>Qt.id==Ve);ke(It||null)},children:[a.jsx("option",{value:"",children:"-- Select Branch --"}),ue.map(oe=>a.jsxs("option",{value:oe.id,children:[oe.name,oe.city?` - ${oe.city}`:"",oe.state?` (${oe.state})`:""]},oe.id))]})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group left-start",children:[a.jsx("label",{htmlFor:"copyFrom",children:"Copy from :"}),a.jsxs("select",{id:"copyFrom",className:"form-control",children:[a.jsx("option",{value:"none",children:"None"}),a.jsx("option",{value:"earlier",children:"Earlier Quotations"}),a.jsx("option",{value:"templates",children:"Saved Templates"})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"series",children:"Series :"}),a.jsxs("select",{id:"series",className:"form-control",value:ve,onChange:oe=>ih(oe),children:[a.jsx("option",{value:"",children:"Select"}),ce&&ce.length>0&&ce.map(oe=>a.jsx("option",{value:oe.id,children:oe.name},oe.id))]})]})]})]}),a.jsx("div",{className:"section-card party-details-wrapper",children:a.jsxs("div",{className:"party-details-container",children:[a.jsxs("div",{className:"party-details-left",children:[a.jsx("h5",{className:"section-title",children:"Party Details"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"contactPerson",children:"Contact Person:"}),a.jsx("input",{id:"contactPerson",type:"text",className:"form-control",value:H,onChange:oe=>z(oe.target.value)})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{htmlFor:"salesCredit",children:"Sales Credit:"}),a.jsxs("select",{id:"salesCredit",className:"form-control",value:d,onChange:oe=>ep(oe),children:[a.jsx("option",{value:"",children:"None"}),u.map(oe=>{const Ve=oe.id||oe.ID||oe.user_id||oe.id_user,It=oe.salutation||"",Qt=oe.firstname||oe.first_name||oe.firstName||oe.name||oe.Name||"",Lt=oe.lastname||oe.last_name||oe.lastName||"",jt=(It+" "+Qt+" "+Lt).trim();return a.jsx("option",{value:Ve,children:jt||oe.email||oe.Email||"Unnamed"},Ve)})]})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-field field-with-address",children:[a.jsxs("div",{className:"field-inline",children:[a.jsx("label",{htmlFor:"address",children:"Address:"}),i?a.jsxs(a.Fragment,{children:[a.jsxs("select",{id:"address",className:"form-control",value:q||"",onChange:Xi,children:[a.jsx("option",{value:"",children:"--Select--"}),(i.addresses||[]).map(oe=>a.jsxs("option",{value:oe.id,children:[oe.title?oe.title+" - ":"",oe.address1||"",oe.city?", "+oe.city:"",oe.state?", "+oe.state:""]},oe.id))]}),a.jsx("button",{type:"button",className:"btn-icon btn-add",onClick:()=>Es("billing"),title:"Add address",children:a.jsx(J4,{})})]}):a.jsx("button",{className:"btn btn-success",children:"+ Click here to add an address."})]}),W&&a.jsxs("div",{className:"address-display-box",children:[a.jsxs("div",{className:"address-display-header",children:[a.jsx("h6",{className:"address-title",children:W.title||"Address"}),a.jsx("button",{type:"button",className:"btn-edit-address",onClick:()=>Ns("billing"),title:"Edit address",children:""})]}),a.jsxs("div",{className:"address-content",children:[a.jsxs("p",{children:[a.jsx("strong",{children:W.address1}),W.address2&&a.jsxs(a.Fragment,{children:[" , ",W.address2]}),W.city&&a.jsxs(a.Fragment,{children:[" , ",W.city]}),W.state&&a.jsxs(a.Fragment,{children:[" , ",W.state]}),W.postal_code&&a.jsxs(a.Fragment,{children:[" - ",W.postal_code]}),W.country&&a.jsxs(a.Fragment,{children:[" , ",W.country]})]}),W.gst_in&&a.jsxs("p",{children:[a.jsx("strong",{children:"GSTIN :"})," ",W.gst_in]}),W.extra&&(typeof W.extra=="object"?Object.entries(W.extra).map(([oe,Ve])=>a.jsxs("p",{children:[a.jsxs("strong",{children:[oe," :"]})," ",Ve]},oe)):a.jsxs("p",{children:[a.jsx("strong",{children:"Extra:"})," ",W.extra]}))]})]})]}),a.jsxs("div",{className:"form-field field-with-address",children:[a.jsxs("div",{className:"field-inline",children:[a.jsx("label",{htmlFor:"shippingAddress",children:"Shipping Address:"}),R&&a.jsxs("div",{className:"checkbox-field",children:[a.jsx("input",{className:"form-check-input",type:"checkbox",id:"checkDefault",checked:R,onChange:()=>j(oe=>!oe)}),a.jsx("label",{className:"form-check-label",htmlFor:"checkDefault",children:"Same as Billing address"})]}),!R&&i&&a.jsxs(a.Fragment,{children:[a.jsxs("select",{id:"shippingAddressSelect",className:"form-control",value:I||"",onChange:hn,children:[a.jsx("option",{value:"",children:"--Select--"}),a.jsx("option",{value:"none",children:"None"}),(i.addresses||[]).map(oe=>a.jsxs("option",{value:oe.id,children:[oe.title?oe.title+" - ":"",oe.address1||"",oe.city?", "+oe.city:"",oe.state?", "+oe.state:""]},oe.id))]}),a.jsx("button",{type:"button",className:"btn-icon btn-add",onClick:()=>Es("shipping"),title:"Add shipping address",children:a.jsx(J4,{})})]})]}),k&&a.jsxs("div",{className:"address-display-box",children:[a.jsxs("div",{className:"address-display-header",children:[a.jsx("h6",{className:"address-title",children:k.title||"Address"}),a.jsx("button",{type:"button",className:"btn-edit-address",onClick:()=>Ns("shipping"),title:"Edit address",children:""})]}),a.jsxs("div",{className:"address-content",children:[a.jsxs("p",{children:[a.jsx("strong",{children:k.address1}),k.address2&&a.jsxs(a.Fragment,{children:[" , ",k.address2]}),k.city&&a.jsxs(a.Fragment,{children:[" , ",k.city]}),k.state&&a.jsxs(a.Fragment,{children:[" , ",k.state]}),k.postal_code&&a.jsxs(a.Fragment,{children:[" - ",k.postal_code]}),k.country&&a.jsxs(a.Fragment,{children:[" , ",k.country]})]}),k.gst_in&&a.jsxs("p",{children:[a.jsx("strong",{children:"GSTIN :"})," ",k.gst_in]}),k.extra&&(typeof k.extra=="object"?Object.entries(k.extra).map(([oe,Ve])=>a.jsxs("p",{children:[a.jsxs("strong",{children:[oe," :"]})," ",Ve]},oe)):a.jsxs("p",{children:[a.jsx("strong",{children:"Extra:"})," ",k.extra]}))]})]})]})]})]}),a.jsxs("div",{className:"document-details-box",children:[a.jsx("h5",{className:"section-title",children:"Document Details"}),a.jsxs("div",{className:"form-field-vertical",children:[a.jsx("label",{children:"Quotation No. :"}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[a.jsx("div",{style:{color:"#333"},children:ve?(()=>{const oe=ce.find(Qt=>String(Qt.id)===String(ve)),Ve=(oe==null?void 0:oe.prefix)||"QTN",It=(oe==null?void 0:oe.prefix_number)||"";return`${Ve}/${It}`})():null}),ve?a.jsxs(a.Fragment,{children:[a.jsx("div",{children:"/"}),a.jsx("input",{id:"quotationSeq",type:"text",className:"form-control",style:{width:"80px"},value:Ye,onChange:oe=>{const Ve=oe.target.value.replace(/[^0-9]/g,"");me(Ve);const It=ce.find(cr=>String(cr.id)===String(ve)),Qt=(It==null?void 0:It.prefix)||"QTN",Lt=(It==null?void 0:It.prefix_number)||"",jt=Be||(()=>{const Jr=new Date().getFullYear();return`${String(Jr).slice(-2)}-${String(Jr+1).slice(-2)}`})();ae(`${Qt}/${Lt}/${Ve||""}/${jt}`)},placeholder:"###"}),a.jsx("div",{children:"/"}),a.jsx("div",{style:{color:"#333"},children:Be||(()=>{const Ve=new Date().getFullYear();return`${String(Ve).slice(-2)}-${String(Ve+1).slice(-2)}`})()})]}):a.jsx(a.Fragment,{children:a.jsx("input",{id:"quotationSeq",type:"text",className:"form-control",style:{width:"160px"},value:Ye,onChange:oe=>{const Ve=oe.target.value.replace(/[^0-9]/g,"");me(Ve),ae(Ve)},placeholder:"Quotation No."})})]}),we&&a.jsxs("small",{style:{color:"#666",fontSize:"12px",marginTop:"4px",display:"block"},children:["Prev: ",we]})]}),a.jsxs("div",{className:"form-field-vertical",children:[a.jsx("label",{htmlFor:"reference",children:"Reference :"}),a.jsx("input",{id:"reference",type:"text",className:"form-control",value:re||"",onChange:oe=>X(oe.target.value)})]}),a.jsxs("div",{className:"form-field-vertical",children:[a.jsx("label",{htmlFor:"quotationDate",children:"Quotation Date :"}),a.jsx("input",{id:"quotationDate",type:"date",className:"form-control",value:b,onChange:oe=>y(oe.target.value)})]}),a.jsxs("div",{className:"form-field-vertical",children:[a.jsx("label",{htmlFor:"validTill",children:"Valid till :"}),a.jsx("input",{id:"validTill",type:"date",className:"form-control",value:S,onChange:oe=>C(oe.target.value)})]}),a.jsxs("div",{className:"form-field-vertical",children:[a.jsx("label",{children:"Issued by :"}),p?a.jsxs("div",{className:"issued-by-box",children:[a.jsx("div",{className:"issued-by-name",children:(()=>{const oe=p.salutation||"",Ve=p.firstname||p.first_name||p.firstName||"",It=p.lastname||p.last_name||p.lastName||"";return(oe+" "+Ve+" "+It).trim()||p.name||p.Name||"N/A"})()}),a.jsxs("div",{className:"issued-by-details",children:[a.jsx("div",{className:"issued-by-phone",children:p.mobile_number||p.phone||p.mobile||"N/A"}),a.jsx("div",{className:"issued-by-email",children:p.email||"N/A"})]})]}):a.jsx("div",{className:"issued-by-box",children:a.jsx("div",{className:"muted-sm",children:"No sales credit selected"})})]})]})]})}),a.jsx("div",{className:"customer-info-container",children:a.jsxs("div",{className:"container",children:[a.jsx("h5",{children:"Items list."}),a.jsxs("div",{className:"row",children:[a.jsx("div",{className:"col-md-12",children:a.jsxs("table",{className:"table table-bordered",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"No"}),a.jsx("th",{children:"Image"}),a.jsx("th",{children:"Items Description"}),a.jsx("th",{children:"Code"}),a.jsx("th",{children:"HSN/SAC"}),a.jsx("th",{children:"Qty"}),a.jsx("th",{children:"Unit"}),a.jsx("th",{children:"Rate"}),a.jsx("th",{children:"Discount"}),a.jsx("th",{children:"Taxable"}),a.jsx("th",{children:"CGST"}),a.jsx("th",{children:"SGST"}),a.jsx("th",{children:"Amount"}),a.jsx("th",{children:"Lead Time"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:Me.map((oe,Ve)=>a.jsxs("tr",{children:[a.jsx("td",{children:Ve+1}),a.jsx("td",{className:"cell-image",children:_0(oe.image)||_0(oe.thumbnail)||oe.image||oe.thumbnail?a.jsx("img",{src:_0(oe.image)||_0(oe.thumbnail)||oe.image||oe.thumbnail,alt:oe.name,className:"item-thumb"}):a.jsx("div",{className:"item-thumb placeholder",children:"No Image"})}),a.jsx("td",{children:oe.name}),a.jsx("td",{children:oe.code||oe.Code||""}),a.jsx("td",{children:oe.hsn}),a.jsx("td",{children:a.jsxs("div",{className:"qty-control",children:[a.jsx("button",{type:"button",className:"btn-qty",onClick:()=>tt(It=>It.map((Qt,Lt)=>{if(Lt!==Ve)return Qt;const jt=Math.max(0,(Number(Qt.qty)||0)-1),cr=(Qt.rate||0)*jt-(Qt.discount||0),Jr=cr*(((Qt.cgst||0)+(Qt.sgst||0))/2)/100,ta=cr*(((Qt.cgst||0)+(Qt.sgst||0))/2)/100;return{...Qt,qty:jt,taxable:cr,cgst:Jr,sgst:ta,amount:cr+Jr+ta}})),children:""}),a.jsx("input",{type:"text",className:"form-control input-small qty-input",value:oe.qty,onChange:It=>{const Qt=Number(It.target.value)||0;tt(Lt=>Lt.map((jt,cr)=>{if(cr!==Ve)return jt;const Jr=Qt,ta=(jt.rate||0)*Jr-(jt.discount||0),Ta=ta*(((jt.cgst||0)+(jt.sgst||0))/2)/100,Ts=ta*(((jt.cgst||0)+(jt.sgst||0))/2)/100;return{...jt,qty:Jr,taxable:ta,cgst:Ta,sgst:Ts,amount:ta+Ta+Ts}}))}}),a.jsx("button",{type:"button",className:"btn-qty",onClick:()=>tt(It=>It.map((Qt,Lt)=>{if(Lt!==Ve)return Qt;const jt=(Number(Qt.qty)||0)+1,cr=(Qt.rate||0)*jt-(Qt.discount||0),Jr=cr*(((Qt.cgst||0)+(Qt.sgst||0))/2)/100,ta=cr*(((Qt.cgst||0)+(Qt.sgst||0))/2)/100;return{...Qt,qty:jt,taxable:cr,cgst:Jr,sgst:ta,amount:cr+Jr+ta}})),children:"+"})]})}),a.jsx("td",{children:a.jsx("input",{type:"text",className:"form-control input-small",value:oe.unit,onChange:It=>tt(Qt=>{const Lt=[...Qt];return Lt[Ve].unit=It.target.value,Lt})})}),a.jsx("td",{children:a.jsx("input",{type:"text",className:"form-control input-small",value:oe.rate,onChange:It=>tt(Qt=>{const Lt=[...Qt];Lt[Ve].rate=Number(It.target.value);const jt=Lt[Ve].rate*Lt[Ve].qty-Lt[Ve].discount,cr=jt*(oe.cgst+oe.sgst)/2/100,Jr=jt*(oe.cgst+oe.sgst)/2/100;return Lt[Ve].taxable=jt,Lt[Ve].cgst=cr,Lt[Ve].sgst=Jr,Lt[Ve].amount=jt+cr+Jr,Lt})})}),a.jsx("td",{children:a.jsx("input",{type:"text",className:"form-control input-small",value:oe.discount,onChange:It=>tt(Qt=>{const Lt=[...Qt];Lt[Ve].discount=Number(It.target.value);const jt=Lt[Ve].rate*Lt[Ve].qty-Lt[Ve].discount,cr=jt*(oe.cgst+oe.sgst)/2/100,Jr=jt*(oe.cgst+oe.sgst)/2/100;return Lt[Ve].taxable=jt,Lt[Ve].cgst=cr,Lt[Ve].sgst=Jr,Lt[Ve].amount=jt+cr+Jr,Lt})})}),a.jsx("td",{children:oe.taxable.toFixed(2)}),a.jsx("td",{children:oe.cgst.toFixed(2)}),a.jsx("td",{children:oe.sgst.toFixed(2)}),a.jsx("td",{children:oe.amount.toFixed(2)}),a.jsx("td",{children:oe.leadTime}),a.jsxs("td",{children:[a.jsx("button",{className:"btn-action btn-edit",onClick:()=>Na(oe,Ve),title:"Edit item",children:a.jsx(Z4,{})}),a.jsx("button",{className:"btn-action btn-delete",onClick:()=>tt(It=>It.filter((Qt,Lt)=>Lt!==Ve)),title:"Delete item",children:a.jsx(qO,{})})]})]},oe._rowId||Ve))})]})}),a.jsxs("div",{className:"col-md-12 item-list-footer",children:[a.jsx("div",{className:"left",children:a.jsx("button",{className:"btn btn-success add-another",onClick:Yt,children:"+ Add Another Item"})}),a.jsx("div",{className:"center",children:a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,width:"100%"},children:[a.jsx("label",{className:"barcode-label",style:{margin:0},children:"Search Using Barcode :"}),a.jsx("div",{className:"barcode-search",style:{flex:1},children:a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,width:"100%"},children:[a.jsx("input",{type:"text",className:"form-control",placeholder:"Scan Barcode",value:ye,onChange:oe=>{ge(oe.target.value),Wr(oe.target.value)},onKeyDown:oe=>{oe.key==="Enter"&&(oe.preventDefault(),en())},style:{flex:1}}),a.jsx("button",{className:"btn btn-success go-btn",onClick:()=>en(),children:""}),ye&&Xe.length>0&&a.jsx("div",{className:"searchable-select-dropdown",style:{position:"absolute",zIndex:40,left:0,right:0,maxHeight:280,overflowY:"auto"},children:Xe.map(oe=>a.jsxs("div",{className:"searchable-select-option",onMouseDown:()=>{Hr(oe),at([]),ge("")},children:[a.jsx("div",{style:{fontWeight:600},children:oe.Code||oe.code||oe.Sku||oe.SKU||""}),a.jsx("div",{style:{fontSize:12},children:oe.Name||oe.name})]},oe.ID||oe.id||oe.Code||oe.code))})]})})]})})]})]})]})}),a.jsx("div",{className:"container",children:a.jsxs("div",{className:"row",children:[a.jsx("div",{className:"col-md-8",children:a.jsx(Zue,{open:de,handleClose:(oe,Ve,It)=>{Re(oe),Y(Ve),ee(It)},initialSelections:wn?ze:[],end_customer_name:wn?ne:"",end_dealer_name:wn?K:""})}),a.jsx("div",{className:"col-md-4",children:a.jsxs("div",{className:"customer-info-container flex-column",children:[Me.length===0?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"row mb-2",children:a.jsxs("div",{className:"col-12 d-flex justify-content-between",children:[a.jsx("strong",{children:"Total"})," ",a.jsxs("strong",{children:["   ",Ze.toFixed(2)]})]})}),a.jsx("div",{className:"row mb-2",children:a.jsx("div",{className:"col-12 d-flex justify-content-between align-items-center",children:a.jsx("div",{style:{minWidth:"90px"}})})}),a.jsx("div",{className:"row border-top pt-2",children:a.jsxs("div",{className:"col-12 d-flex justify-content-between",children:[a.jsx("strong",{children:"Grand Total"})," ",a.jsxs("strong",{children:[" ",za.toFixed(2)]})]})})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"row mb-2",children:a.jsxs("div",{className:"col-12 d-flex justify-content-between",children:[a.jsx("strong",{children:"Total Amount before Tax"})," ",a.jsxs("strong",{children:["   ",Ze.toFixed(2)]})]})}),a.jsx("div",{className:"row mb-2 border-top pt-2",children:a.jsxs("div",{className:"col-12 d-flex justify-content-between",children:[a.jsx("strong",{children:"Add iGST"})," ",a.jsx("strong",{children:"   0.00"})]})}),a.jsx("div",{className:"row mb-2",children:a.jsxs("div",{className:"col-12 d-flex justify-content-between",children:[a.jsx("strong",{children:"Tax Amount"})," ",a.jsxs("strong",{children:["   ",Me.reduce((Ve,It)=>Ve+(It.cgst||0)+(It.sgst||0),0).toFixed(2)]})]})}),a.jsx("div",{className:"row mb-2",children:a.jsxs("div",{className:"col-12 d-flex justify-content-between",children:[a.jsx("strong",{children:"Total"})," ",a.jsxs("strong",{children:[" ",(Ze+Me.reduce((Ve,It)=>Ve+(It.cgst||0)+(It.sgst||0),0)).toFixed(2)]})]})}),Fr.length>0&&a.jsx("div",{className:"mb-2",children:Fr.map((oe,Ve)=>a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[a.jsx("button",{className:"btn-action btn-edit",title:"Edit charge",onClick:()=>{Vr(Ve),xt(!0)},children:""}),a.jsx("button",{className:"btn-action btn-delete",title:"Delete charge",onClick:()=>jr(It=>It.filter((Qt,Lt)=>Lt!==Ve)),children:""}),a.jsxs("span",{children:[oe.title," (",oe.type==="percent"?`${oe.value}%`:`${oe.value}`,")"]})]}),a.jsxs("span",{children:[""," ",oe.type==="percent"?(Ze*oe.value/100).toFixed(2):oe.value.toFixed(2)]})]},Ve))}),Le.length>0&&a.jsx("div",{className:"mb-2",children:Le.map((oe,Ve)=>a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[a.jsx("button",{className:"btn-action btn-edit",title:"Edit discount",onClick:()=>{xn(Ve),Vt(!0)},children:""}),a.jsx("button",{className:"btn-action btn-delete",title:"Delete discount",onClick:()=>rt(It=>It.filter((Qt,Lt)=>Lt!==Ve)),children:""}),a.jsxs("span",{children:[oe.title," (",oe.type==="percent"?`${oe.value}%`:`${oe.value}`,")"]})]}),a.jsxs("span",{children:["- "," ",oe.type==="percent"?(Ze*oe.value/100).toFixed(2):oe.value.toFixed(2)]})]},Ve))}),a.jsxs("div",{className:"row border-top pt-2",children:[a.jsxs("div",{className:"form-check",children:[a.jsx("input",{id:"roundOffCheck2",className:"form-check-input",type:"checkbox",checked:Ir,onChange:()=>$n(!Ir)}),a.jsx("label",{htmlFor:"roundOffCheck2",children:"Include Round off"})]}),a.jsxs("div",{className:"col-12 d-flex justify-content-between",children:[a.jsx("strong",{children:"Grand Total"})," ",a.jsxs("strong",{children:[" ",za.toFixed(2)]})]})]})]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:"10px",marginTop:"8px"},children:[a.jsx("button",{className:"btn btn-warning rounded-0",onClick:()=>xt(!0),children:"+ Add Charge"}),a.jsx("button",{className:"btn btn-warning rounded-0",onClick:()=>Vt(!0),children:"+ Add Discount"})]})]})})]})}),a.jsxs("div",{className:"container",children:[a.jsx("div",{className:"row",children:a.jsxs("div",{className:"customer-info-container",children:[a.jsxs("div",{className:"col-md-3",children:[a.jsx("h5",{children:"Notes"}),a.jsx("textarea",{cols:50,value:L,onChange:oe=>O(oe.target.value)})]}),a.jsxs("div",{className:"col-md-4",children:[a.jsx("h5",{children:"Bank Details"}),a.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px",alignItems:"center"},children:[a.jsxs("select",{className:"form-control",style:{flex:1},value:rn||"",onChange:oe=>$a(oe.target.value?Number(oe.target.value):null),children:[a.jsx("option",{value:"",children:"-- Select Bank Account --"}),sr&&sr.length>0?sr.map(oe=>a.jsx("option",{value:oe.id,children:oe.title?oe.title:oe.bankName},oe.id)):null]}),a.jsx("button",{type:"button",className:"btn btn-sm",style:{background:"#1e7b5a",color:"#fff",border:"none",borderRadius:"4px",padding:"6px 10px",cursor:"pointer",fontSize:"18px",lineHeight:1,flexShrink:0},onClick:sh,title:"Add new bank account",children:"+"})]}),a.jsx("div",{style:{maxHeight:"200px",overflowY:"auto"},children:rn?la?a.jsx("div",{style:{padding:"10px",marginBottom:"8px",background:"#f0f8f5",border:"1px solid #c8e6c9",borderRadius:"4px",fontSize:"12px",position:"relative"},children:a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[a.jsxs("div",{children:[a.jsxs("div",{children:["Bank Name : ",la.bankName]}),a.jsxs("div",{children:["Account No : ",la.accountNo]}),la.branch&&a.jsxs("div",{children:["Branch: ",la.branch]}),la.ifsc&&a.jsxs("div",{children:["IFSC: ",la.ifsc]}),la.swiftCode&&a.jsxs("div",{children:["SWIFT Code: ",la.swiftCode]})]}),a.jsx("div",{style:{marginLeft:"8px",display:"flex",gap:"6px"},children:a.jsx("button",{type:"button",title:"Edit bank details",onClick:()=>sh(la),style:{border:"none",background:"transparent",cursor:"pointer",padding:"4px",color:"#1976d2",fontSize:"16px"},children:""})})]})},la.id):a.jsx("div",{style:{color:"#999",fontSize:"12px",fontStyle:"italic"},children:"No bank details added for selected account"}):null})]})]})}),a.jsx("div",{className:"row",children:a.jsxs("div",{className:"col-md-12",children:[a.jsx("label",{children:"Upload File :"}),rr&&a.jsxs("div",{style:{marginBottom:"8px",padding:"8px",backgroundColor:"#f0f0f0",borderRadius:"4px"},children:[a.jsx("span",{style:{marginRight:"10px"},children:"Current file:"}),a.jsx("a",{href:`${Je}/${rr}`,target:"_blank",rel:"noopener noreferrer",style:{color:"#1976d2",textDecoration:"none"},children:rr.split("/").pop()}),a.jsx("span",{style:{marginLeft:"10px",fontSize:"12px",color:"#666"},children:"(Upload new file to replace)"})]}),a.jsx("input",{type:"file",accept:".pdf,.doc,.docx",onChange:oe=>pt(oe.target.files[0])}),Ke&&a.jsxs("div",{style:{marginTop:"8px",fontSize:"12px",color:"#28a745"},children:["New file selected: ",Ke.name]})]})}),a.jsxs("div",{className:"row",children:[a.jsxs("div",{className:"customer-info-container",children:[a.jsx("h5",{children:"Next Actions"}),a.jsxs("div",{className:"col-md-12",children:[a.jsxs("div",{className:"form-check",children:[a.jsx("input",{className:"form-check-input",type:"checkbox",value:"",id:"1"}),a.jsx("label",{className:"form-check-label",htmlFor:"1",children:"Save Template"})]}),a.jsxs("div",{className:"form-check",children:[a.jsx("input",{className:"form-check-input",type:"checkbox",value:"",id:"2"}),a.jsx("label",{className:"form-check-label",htmlFor:"2",children:"Share By Email"})]}),a.jsxs("div",{className:"form-check",children:[a.jsx("input",{className:"form-check-input",type:"checkbox",value:"",id:"3"}),a.jsx("label",{className:"form-check-label",htmlFor:"3",children:"Share By Whats App"})]}),a.jsxs("div",{className:"form-check",children:[a.jsx("input",{className:"form-check-input",type:"checkbox",value:"",id:"4"}),a.jsx("label",{className:"form-check-label",htmlFor:"4",children:"Print Document After save"})]}),a.jsxs("div",{className:"form-check",children:[a.jsx("input",{className:"form-check-input",type:"checkbox",value:"",id:"5"}),a.jsx("label",{className:"form-check-label",htmlFor:"5",children:"Alert me on Openning"})]})]})]}),a.jsxs("div",{className:"footer-button",children:[wn&&a.jsxs("button",{className:"btn btn--save ml-4",onClick:_c,disabled:g,children:[a.jsx(Z4,{})," Update"]}),a.jsxs("button",{className:"btn btn--save ml-4",onClick:_c,disabled:g,children:[a.jsx(j0,{})," Save"]}),a.jsxs("button",{className:"btn btn--save ml-4",onClick:async()=>{await _c(),c(null),tt([]),St(0)},disabled:g,children:[a.jsx(j0,{})," Save & Add New"]})]})]})]}),Oi&&a.jsx("div",{className:"custom-modal",onClick:()=>Rs(!1),children:a.jsxs("div",{className:"modal-box address-modal",onClick:oe=>oe.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h6",{children:"Add Address"}),a.jsx("button",{className:"btn",onClick:()=>Rs(!1),children:""})]}),a.jsxs("div",{className:"modal-body",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("label",{children:"Title"}),a.jsx("input",{className:"form-control",value:ea.title,onChange:oe=>Gn(Ve=>({...Ve,title:oe.target.value}))})]}),a.jsxs("div",{className:"mb-8",children:[a.jsx("label",{children:"Address"}),a.jsx("input",{className:"form-control",placeholder:"Line1",value:ea.address1,onChange:oe=>Gn(Ve=>({...Ve,address1:oe.target.value}))}),a.jsx("input",{className:"form-control mb-8",placeholder:"Line2",value:ea.address2,onChange:oe=>Gn(Ve=>({...Ve,address2:oe.target.value}))})]}),a.jsxs("div",{className:"mb-8",children:[a.jsx("label",{children:"City"}),a.jsx("input",{className:"form-control",value:ea.city,onChange:oe=>Gn(Ve=>({...Ve,city:oe.target.value}))})]}),a.jsxs("div",{className:"grid-2",children:[a.jsxs("div",{children:[a.jsx("label",{children:"Country"}),a.jsx(G1,{options:Zu,value:ea.country,onChange:oe=>Gn(Ve=>({...Ve,country:oe})),placeholder:"Select country"})]}),a.jsxs("div",{children:[a.jsx("label",{children:"State"}),ea.country==="India"?a.jsx(G1,{options:ls,value:ea.state,onChange:oe=>Gn(Ve=>({...Ve,state:oe})),placeholder:"Select state"}):a.jsx(G1,{options:[],value:ea.state,onChange:oe=>Gn(Ve=>({...Ve,state:oe})),placeholder:"Type state",allowCustom:!0})]})]}),a.jsxs("div",{className:"grid-2",children:[a.jsxs("div",{children:[a.jsx("label",{children:"Pincode"}),a.jsx("input",{className:"form-control",value:ea.postal_code,onChange:oe=>Gn(Ve=>({...Ve,postal_code:oe.target.value}))})]}),a.jsxs("div",{children:[a.jsx("label",{children:"GSTIN"}),a.jsx("input",{className:"form-control",value:ea.gst_in,onChange:oe=>Gn(Ve=>({...Ve,gst_in:oe.target.value}))})]})]}),a.jsxs("div",{className:"mb-8",children:[a.jsx("label",{children:"Extra Field (e.g. Mobile: 9000012345)"}),a.jsxs("div",{className:"grid-extra",children:[a.jsx("input",{className:"form-control",placeholder:"Key",value:ea.extra_key,onChange:oe=>Gn(Ve=>({...Ve,extra_key:oe.target.value}))}),a.jsx("input",{className:"form-control",placeholder:"Value",value:ea.extra_value,onChange:oe=>Gn(Ve=>({...Ve,extra_value:oe.target.value}))})]})]})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{className:"btn btn-secondary",onClick:()=>Rs(!1),children:"Cancel"}),a.jsx("button",{className:"btn btn-primary",onClick:yl,children:"Save"})]})]})}),e&&a.jsx("div",{className:"custom-modal",onClick:Vd,children:a.jsxs("div",{className:"modal-box modal-width-400",onClick:oe=>oe.stopPropagation(),children:[a.jsx("h6",{children:"Select Customer"}),a.jsx("input",{type:"text",className:"form-control input-small mb-12",placeholder:"Search customer...",value:s,onChange:Wd}),a.jsx("table",{className:"table table-sm",children:a.jsx("tbody",{children:t.map(oe=>a.jsx("tr",{className:"clickable-row",onClick:()=>Ac(oe),children:a.jsxs("td",{children:[a.jsx("div",{className:"cust-company",children:oe.company_name||oe.company||""}),a.jsx("div",{className:"muted muted-sm",children:`${oe.firstname||""} ${oe.lastname||""}`.trim()})]})},oe.id))})}),a.jsx("div",{className:"text-right",children:a.jsx("button",{className:"btn btn-secondary",onClick:Vd,children:"Close"})})]})}),Te&&a.jsx("div",{className:"custom-modal",onClick:xr,children:a.jsxs("div",{className:"modal-box modal-width-800 modal-scroll",onClick:oe=>oe.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h5",{style:{margin:0},children:"Select Item"}),a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[a.jsx("button",{type:"button",className:"btn btn--print",onClick:()=>wt(oe=>oe==="list"?"grid":"list"),children:"Change Layout"}),a.jsx("button",{className:"btn",onClick:xr,children:""})]})]}),a.jsx("input",{type:"text",className:"form-control",placeholder:"Search Products",value:ye,onChange:_n}),dt==="list"?De.map(oe=>a.jsx("div",{className:"product-row",children:a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[a.jsx("input",{type:"checkbox",checked:Nt.includes(oe.ID),onChange:()=>kr(oe.ID),onClick:Ve=>Ve.stopPropagation()}),a.jsxs("div",{style:{flex:1,cursor:"pointer"},onClick:()=>Na(oe),children:[a.jsx("div",{style:{fontWeight:600},children:oe.Code?oe.Code:""}),a.jsx("div",{children:oe.Name||""})]})]})},oe.ID)):a.jsxs("div",{children:[a.jsxs("div",{className:"filters-row",style:{display:"flex",gap:8,margin:"8px 0"},children:[a.jsx("div",{style:{flex:1},children:a.jsx(G1,{options:Array.from(new Set(De.map(oe=>{var Ve;return(((Ve=oe.Category)==null?void 0:Ve.Name)||oe.CategoryName||oe.Category||"").toString()}).filter(Boolean))),value:$t,onChange:oe=>{Bt(oe),tr("")},placeholder:"Category"})}),a.jsx("div",{style:{flex:1},children:a.jsx(G1,{options:Array.from(new Set(De.filter(oe=>{var Ve;return!$t||(((Ve=oe.Category)==null?void 0:Ve.Name)||oe.CategoryName||oe.Category||"").toString()===$t}).map(oe=>{var Ve;return(((Ve=oe.SubCategory)==null?void 0:Ve.Name)||oe.SubCategoryName||oe.SubCategory||"").toString()}).filter(Boolean))),value:ft,onChange:oe=>tr(oe),placeholder:"Sub Category"})})]}),a.jsx("div",{className:"products-grid",children:De.filter(oe=>{var It,Qt;const Ve=ye.trim().toLowerCase();return!(Ve&&!((oe.Name||"").toString().toLowerCase().includes(Ve)||(oe.Code||"").toString().toLowerCase().includes(Ve))||$t&&(((It=oe.Category)==null?void 0:It.Name)||oe.CategoryName||oe.Category||"").toString()!==$t||ft&&(((Qt=oe.SubCategory)==null?void 0:Qt.Name)||oe.SubCategoryName||oe.SubCategory||"").toString()!==ft)}).map(oe=>a.jsx("div",{className:"product-card",children:a.jsxs("div",{style:{display:"flex",alignItems:"center",width:"100%",gap:8},children:[a.jsx("input",{type:"checkbox",checked:Nt.includes(oe.ID),onChange:()=>kr(oe.ID),onClick:Ve=>Ve.stopPropagation()}),a.jsxs("div",{style:{flex:1,cursor:"pointer"},onClick:()=>Na(oe),children:[a.jsx("div",{className:"product-thumb-wrap",children:K1(oe)?a.jsx("img",{src:K1(oe),alt:oe.Name,className:"product-thumb"}):a.jsx("div",{className:"product-thumb placeholder",children:"No Image"})}),a.jsx("div",{className:"product-name",children:oe.Name})]})]})},oe.ID))})]}),a.jsxs("div",{className:"mt-12",children:[a.jsx("button",{type:"button",className:"btn btn-success add-another",onClick:()=>{xr(),f("/ManageProduct?productType=Stock")},children:"+ Add Stock Item"}),a.jsxs("button",{type:"button",className:"btn btn-primary add-another ml-8",onClick:Pt,disabled:Nt.length===0,style:{marginLeft:8},children:["Add Selected (",Nt.length,")"]}),a.jsx("button",{type:"button",className:"btn btn-success add-another ml-8",onClick:()=>{xr(),Pe(!0)},children:"+ Add Service / Non-Stock Item"})]})]})}),Ur&&vt&&a.jsx("div",{className:"custom-modal",onClick:()=>Lr(!1),children:a.jsxs("div",{className:"modal-box modal-width-520 modal-scroll",onClick:oe=>oe.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h5",{children:"Update Billing Item"}),a.jsx("button",{className:"btn",onClick:()=>Lr(!1),children:""})]}),a.jsxs("div",{className:"mt-8",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("label",{children:"Item"}),a.jsx("input",{className:"form-control",value:vt.Name,readOnly:!0})]}),a.jsxs("div",{className:"mb-8",children:[a.jsx("label",{children:"Description"}),a.jsx("textarea",{className:"form-control",rows:3,value:Cr.desc,onChange:oe=>Dt(Ve=>({...Ve,desc:oe.target.value}))})]}),a.jsxs("div",{className:"grid-3",children:[a.jsxs("div",{children:[a.jsx("label",{children:"Qty"}),a.jsx("input",{type:"text",className:"form-control",value:Cr.qty,onChange:oe=>Dt(Ve=>({...Ve,qty:Number(oe.target.value)}))})]}),a.jsxs("div",{children:[a.jsx("label",{children:"Unit"}),a.jsx("input",{className:"form-control",value:Cr.unit,onChange:oe=>Dt(Ve=>({...Ve,unit:oe.target.value}))})]}),a.jsxs("div",{children:[a.jsx("label",{children:"Rate"}),a.jsx("input",{type:"text",className:"form-control",value:Cr.rate,onChange:oe=>Dt(Ve=>({...Ve,rate:Number(oe.target.value)}))})]})]}),a.jsxs("div",{className:"grid-3",children:[a.jsxs("div",{children:[a.jsx("label",{children:"Discount ()"}),a.jsx("input",{type:"text",className:"form-control",value:Cr.discount,onChange:oe=>Dt(Ve=>({...Ve,discount:Number(oe.target.value)}))})]}),a.jsxs("div",{children:[a.jsx("label",{children:"Discount (%)"}),a.jsx("input",{type:"text",className:"form-control",value:Cr.discountPercent,onChange:oe=>Dt(Ve=>({...Ve,discountPercent:Number(oe.target.value)}))})]}),a.jsxs("div",{children:[a.jsx("label",{children:"Lead Time"}),a.jsx("input",{className:"form-control",value:Cr.leadTime,onChange:oe=>Dt(Ve=>({...Ve,leadTime:oe.target.value}))})]})]}),a.jsxs("div",{className:"grid-2",children:[a.jsxs("div",{children:[a.jsx("label",{children:"HSN/SAC"}),a.jsx("input",{className:"form-control",value:Cr.hsn,onChange:oe=>Dt(Ve=>({...Ve,hsn:oe.target.value}))})]}),a.jsxs("div",{children:[a.jsx("label",{children:"GST (%)"}),a.jsx("input",{type:"text",className:"form-control",value:Cr.gst,onChange:oe=>Dt(Ve=>({...Ve,gst:Number(oe.target.value)}))})]})]}),a.jsxs("div",{className:"flex-center-gap-12",children:[a.jsxs("div",{className:"highlight-box",children:[a.jsx("strong",{children:"Taxable :"}),"  ",(Cr.rate*Cr.qty-(Cr.discountPercent>0?Cr.rate*Cr.qty*(Cr.discountPercent/100):Cr.discount)).toFixed(2)]}),a.jsxs("div",{className:"highlight-box",children:[a.jsx("strong",{children:"Amount :"}),"  ",(()=>{const oe=Number(Cr.qty)||0,Ve=Number(Cr.rate)||0;let It=Number(Cr.discount)||0;Number(Cr.discountPercent)>0&&(It=oe*Ve*(Number(Cr.discountPercent)/100));const Qt=oe*Ve-It,Lt=Qt*(Number(Cr.gst)||0)/2/100,jt=Qt*(Number(Cr.gst)||0)/2/100;return(Qt+Lt+jt).toFixed(2)})()]})]})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{className:"btn btn-secondary",onClick:()=>Lr(!1),children:"Cancel"}),a.jsx("button",{className:"btn btn-primary",onClick:Ra,children:"Update"})]})]})}),nt&&a.jsx("div",{className:"custom-modal",onClick:()=>Pe(!1),children:a.jsxs("div",{className:"modal-box modal-width-450 modal-scroll",onClick:oe=>oe.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h5",{children:"Add Item"}),a.jsx("button",{className:"btn",onClick:()=>Pe(!1),children:""})]}),a.jsxs("div",{className:"modal-body",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("label",{children:"Item Name*"}),a.jsx("input",{className:"form-control",value:Qe.name,onChange:oe=>gt(Ve=>({...Ve,name:oe.target.value}))})]}),a.jsxs("div",{className:"mb-8",children:[a.jsx("label",{children:"Description"}),a.jsx("textarea",{className:"form-control",rows:4,value:Qe.description,onChange:oe=>gt(Ve=>({...Ve,description:oe.target.value}))})]}),a.jsxs("div",{className:"grid-3",children:[a.jsxs("div",{children:[a.jsx("label",{children:"Rate*"}),a.jsx("input",{type:"text",className:"form-control",value:Qe.rate,onChange:oe=>gt(Ve=>({...Ve,rate:oe.target.value}))})]}),a.jsxs("div",{children:[a.jsx("label",{children:"Unit"}),a.jsx("input",{className:"form-control",value:Qe.unit,onChange:oe=>gt(Ve=>({...Ve,unit:oe.target.value}))})]}),a.jsxs("div",{children:[a.jsx("label",{children:"Qty"}),a.jsx("input",{type:"text",className:"form-control",value:Qe.qty,onChange:oe=>gt(Ve=>({...Ve,qty:oe.target.value}))})]})]}),a.jsxs("div",{className:"grid-2 mt-8",children:[a.jsxs("div",{children:[a.jsx("label",{children:"HSN/SAC"}),a.jsx("input",{className:"form-control",value:Qe.hsn,onChange:oe=>gt(Ve=>({...Ve,hsn:oe.target.value}))})]}),a.jsxs("div",{children:[a.jsx("label",{children:"GST (%)"}),a.jsx("input",{type:"text",className:"form-control",value:Qe.gst,onChange:oe=>gt(Ve=>({...Ve,gst:oe.target.value}))})]})]})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{className:"btn btn-secondary",onClick:()=>Pe(!1),children:"Cancel"}),a.jsx("button",{className:"btn btn-primary",onClick:xe,children:"Save"})]})]})}),ot&&a.jsx("div",{className:"custom-modal",onClick:()=>xt(!1),children:a.jsxs("div",{className:"modal-box modal-width-450 modal-scroll",onClick:oe=>oe.stopPropagation(),children:[a.jsx("h6",{children:"Add Extra Charges"}),Fr.map((oe,Ve)=>a.jsxs("div",{className:"flex-gap-8",children:[a.jsx("input",{className:"form-control",placeholder:"Title",value:oe.title,onChange:It=>jr(Qt=>Qt.map((Lt,jt)=>jt===Ve?{...Lt,title:It.target.value}:Lt))}),a.jsxs("select",{className:"form-control select-width-120",value:oe.type,onChange:It=>jr(Qt=>Qt.map((Lt,jt)=>jt===Ve?{...Lt,type:It.target.value}:Lt)),children:[a.jsx("option",{value:"percent",children:"%"}),a.jsx("option",{value:"item",children:""})]}),a.jsx("input",{className:"form-control",type:"number",placeholder:"Amount",value:oe.value,onChange:It=>jr(Qt=>Qt.map((Lt,jt)=>jt===Ve?{...Lt,value:Number(It.target.value)}:Lt))}),a.jsx("button",{className:"btn btn-danger",onClick:()=>jr(It=>It.filter((Qt,Lt)=>Lt!==Ve)),children:""})]},Ve)),a.jsx("div",{className:"mb-8",children:a.jsx("button",{className:"btn btn-outline-secondary",onClick:()=>jr(oe=>[...oe,{title:"",type:"percent",value:""}]),children:"+ Add Row"})}),a.jsx("div",{className:"text-right mt-8",children:a.jsx("button",{className:"btn btn-primary",onClick:()=>xt(!1),children:"Done"})})]})}),zt&&a.jsx("div",{className:"custom-modal",onClick:()=>Vt(!1),children:a.jsxs("div",{className:"modal-box modal-width-450 modal-scroll",onClick:oe=>oe.stopPropagation(),children:[a.jsx("h6",{children:"Add Discounts"}),Le.map((oe,Ve)=>a.jsxs("div",{className:"flex-gap-8",children:[a.jsx("input",{className:"form-control",placeholder:"Title",value:oe.title,onChange:It=>rt(Qt=>Qt.map((Lt,jt)=>jt===Ve?{...Lt,title:It.target.value}:Lt))}),a.jsxs("select",{className:"form-control select-width-120",value:oe.type,onChange:It=>rt(Qt=>Qt.map((Lt,jt)=>jt===Ve?{...Lt,type:It.target.value}:Lt)),children:[a.jsx("option",{value:"percent",children:"%"}),a.jsx("option",{value:"item",children:""})]}),a.jsx("input",{className:"form-control",type:"number",placeholder:"Amount",value:oe.value,onChange:It=>rt(Qt=>Qt.map((Lt,jt)=>jt===Ve?{...Lt,value:Number(It.target.value)}:Lt))}),a.jsx("button",{className:"btn btn-danger",onClick:()=>rt(It=>It.filter((Qt,Lt)=>Lt!==Ve)),children:""})]},Ve)),a.jsx("div",{className:"mb-8",children:a.jsx("button",{className:"btn btn-outline-secondary",onClick:()=>rt(oe=>[...oe,{title:"",type:"percent",value:""}]),children:"+ Add Row"})}),a.jsx("div",{className:"text-right mt-8",children:a.jsx("button",{className:"btn btn-primary",onClick:()=>Vt(!1),children:"Done"})})]})}),Rr&&a.jsx("div",{className:"custom-modal",children:a.jsxs("div",{className:"modal-box address-modal",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h5",{children:"Add a Bank Detail"}),a.jsx("button",{type:"button",style:{background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#999"},onClick:au,children:""})]}),a.jsxs("div",{className:"modal-body",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Title"}),a.jsx("input",{className:"form-control",type:"text",placeholder:"Enter title (e.g., Primary, Secondary)",value:Kt.title,onChange:oe=>qt({...Kt,title:oe.target.value})})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Bank Name"}),a.jsx("input",{className:"form-control",type:"text",placeholder:"Enter bank name",value:Kt.bankName,onChange:oe=>qt({...Kt,bankName:oe.target.value})})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Account No."}),a.jsx("input",{className:"form-control",type:"text",placeholder:"Enter account number",value:Kt.accountNo,onChange:oe=>qt({...Kt,accountNo:oe.target.value})})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Branch"}),a.jsx("input",{className:"form-control",type:"text",placeholder:"Enter branch",value:Kt.branch,onChange:oe=>qt({...Kt,branch:oe.target.value})})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"IFSC"}),a.jsx("input",{className:"form-control",type:"text",placeholder:"Enter IFSC code",value:Kt.ifsc,onChange:oe=>qt({...Kt,ifsc:oe.target.value})})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"SWIFT Code"}),a.jsx("input",{className:"form-control",type:"text",placeholder:"Enter SWIFT code",value:Kt.swiftCode,onChange:oe=>qt({...Kt,swiftCode:oe.target.value})})]})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{className:"btn btn-secondary",onClick:au,style:{background:"#f8f9fa",color:"#333",border:"1px solid #e6e9ef",padding:"8px 16px",borderRadius:"4px",cursor:"pointer"},children:"Cancel"}),a.jsx("button",{className:"btn btn-success",onClick:qd,style:{background:"#28a745",color:"#fff",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:"pointer"},children:"Save"})]})]})}),ja&&a.jsx("div",{className:"custom-modal print-config-modal",children:a.jsxs("div",{className:"modal-box modal-width-800 modal-scroll",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h5",{children:"Print Configuration"}),a.jsx("div",{children:a.jsx("button",{className:"btn",onClick:Xs,style:{border:"none",background:"transparent",fontSize:18,cursor:"pointer"},children:""})})]}),a.jsxs("div",{style:{display:"flex",gap:12},children:[a.jsx("div",{style:{width:220,borderRight:"1px solid #e6e9ef",paddingRight:8},children:a.jsxs("ul",{style:{listStyle:"none",padding:8,margin:0},children:[a.jsx("li",{className:"print-nav-item active",style:{padding:"10px 8px",fontWeight:700,borderLeft:"3px solid #1e7b5a",background:"#fff"},children:"Basic Elements"}),a.jsx("li",{className:"print-nav-item",style:{padding:"10px 8px",marginTop:8},children:"Party Information"}),a.jsx("li",{className:"print-nav-item",style:{padding:"10px 8px",marginTop:8},children:"Item List"})]})}),a.jsx("div",{style:{flex:1},children:a.jsxs("div",{className:"section-card",style:{padding:12},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("div",{children:[a.jsx("h6",{style:{margin:0},children:"Basic Elements"}),a.jsx("div",{className:"muted",style:{marginTop:8},children:"Tick the items you want to include in print."})]}),a.jsx("div",{style:{display:"flex",gap:8},children:a.jsx("button",{className:"btn--print",style:{background:"#ffffff",border:"1px solid #e0e7ea",padding:"6px 10px",borderRadius:6},children:"Sales Configuration"})})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[a.jsxs("div",{style:{background:"#f8f9fa",padding:12,borderRadius:4},children:[a.jsxs("label",{className:"label-checkbox",children:[a.jsx("input",{type:"checkbox",checked:!!Or.header,onChange:()=>Qr("header")})," ",a.jsx("span",{style:{marginLeft:8},children:"Header"})]}),a.jsxs("label",{className:"label-checkbox",style:{display:"block",marginTop:8},children:[a.jsx("input",{type:"checkbox",checked:!!Or.footer,onChange:()=>Qr("footer")})," ",a.jsx("span",{style:{marginLeft:8},children:"Footer"})]}),a.jsxs("label",{className:"label-checkbox",style:{display:"block",marginTop:8},children:[a.jsx("input",{type:"checkbox",checked:!!Or.digitalSignature,onChange:()=>Qr("digitalSignature")})," ",a.jsx("span",{style:{marginLeft:8},children:"Digital Signature"})]}),a.jsxs("label",{className:"label-checkbox",style:{display:"block",marginTop:8},children:[a.jsx("input",{type:"checkbox",checked:!!Or.orgDupTrip,onChange:()=>Qr("orgDupTrip")})," ",a.jsx("span",{style:{marginLeft:8},children:"Org. / Dup. / Trip."})]}),a.jsxs("label",{className:"label-checkbox",style:{display:"block",marginTop:8},children:[a.jsx("input",{type:"checkbox",checked:!!Or.partyInformation,onChange:()=>Qr("partyInformation")})," ",a.jsx("span",{style:{marginLeft:8},children:"Party Information"})]}),a.jsxs("label",{className:"label-checkbox",style:{display:"block",marginTop:8},children:[a.jsx("input",{type:"checkbox",checked:!!Or.gstin,onChange:()=>Qr("gstin")})," ",a.jsx("span",{style:{marginLeft:8},children:"GSTIN"})]})]}),a.jsxs("div",{style:{background:"#f8f9fa",padding:12,borderRadius:4},children:[a.jsxs("label",{className:"label-checkbox",children:[a.jsx("input",{type:"checkbox",checked:!!Or.branch,onChange:()=>Qr("branch")})," ",a.jsx("span",{style:{marginLeft:8},children:"Branch"})]}),a.jsxs("label",{className:"label-checkbox",style:{display:"block",marginTop:8},children:[a.jsx("input",{type:"checkbox",checked:!!Or.bankDetails,onChange:()=>Qr("bankDetails")})," ",a.jsx("span",{style:{marginLeft:8},children:"Bank Details"})]}),a.jsxs("label",{className:"label-checkbox",style:{display:"block",marginTop:8},children:[a.jsx("input",{type:"checkbox",checked:!!Or.disclaimer,onChange:()=>Qr("disclaimer")})," ",a.jsx("span",{style:{marginLeft:8},children:"Disclaimer"})]}),a.jsxs("label",{className:"label-checkbox",style:{display:"block",marginTop:8},children:[a.jsx("input",{type:"checkbox",checked:!!Or.totalBeforeRoundOff,onChange:()=>Qr("totalBeforeRoundOff")})," ",a.jsx("span",{style:{marginLeft:8},children:"Total before Round off"})]})]})]}),a.jsxs("div",{style:{marginTop:14},children:[a.jsx("h6",{style:{margin:"6px 0"},children:"Party Information"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:8,marginTop:8},children:[a.jsxs("label",{className:"label-checkbox",children:[a.jsx("input",{type:"checkbox",checked:!!Or.mobile,onChange:()=>Qr("mobile")})," ",a.jsx("span",{style:{marginLeft:8},children:"Mobile"})]}),a.jsxs("label",{className:"label-checkbox",children:[a.jsx("input",{type:"checkbox",checked:!!Or.email,onChange:()=>Qr("email")})," ",a.jsx("span",{style:{marginLeft:8},children:"Email"})]}),a.jsxs("label",{className:"label-checkbox",children:[a.jsx("input",{type:"checkbox",checked:!!Or.contactPersonName,onChange:()=>Qr("contactPersonName")})," ",a.jsx("span",{style:{marginLeft:8},children:"Contact Person Name"})]}),a.jsxs("label",{className:"label-checkbox",children:[a.jsx("input",{type:"checkbox",checked:!!Or.companyBeforePOC,onChange:()=>Qr("companyBeforePOC")})," ",a.jsx("span",{style:{marginLeft:8},children:"Company before POC"})]})]})]}),a.jsxs("div",{style:{marginTop:14},children:[a.jsx("h6",{style:{margin:"6px 0"},children:"Item List"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:8,marginTop:8},children:[a.jsxs("label",{className:"label-checkbox",children:[a.jsx("input",{type:"checkbox",checked:!!Or.itemCode,onChange:()=>Qr("itemCode")})," ",a.jsx("span",{style:{marginLeft:8},children:"Item Code"})]}),a.jsxs("label",{className:"label-checkbox",children:[a.jsx("input",{type:"checkbox",checked:!!Or.notes,onChange:()=>Qr("notes")})," ",a.jsx("span",{style:{marginLeft:8},children:"Notes"})]}),a.jsxs("label",{className:"label-checkbox",children:[a.jsx("input",{type:"checkbox",checked:!!Or.discountRate,onChange:()=>Qr("discountRate")})," ",a.jsx("span",{style:{marginLeft:8},children:"Discount Rate"})]}),a.jsxs("label",{className:"label-checkbox",children:[a.jsx("input",{type:"checkbox",checked:!!Or.discountAmt,onChange:()=>Qr("discountAmt")})," ",a.jsx("span",{style:{marginLeft:8},children:"Discount Amt"})]}),a.jsxs("label",{className:"label-checkbox",children:[a.jsx("input",{type:"checkbox",checked:!!Or.taxableAmt,onChange:()=>Qr("taxableAmt")})," ",a.jsx("span",{style:{marginLeft:8},children:"Taxable Amt"})]}),a.jsxs("label",{className:"label-checkbox",children:[a.jsx("input",{type:"checkbox",checked:!!Or.hsnSac,onChange:()=>Qr("hsnSac")})," ",a.jsx("span",{style:{marginLeft:8},children:"HSN / SAC"})]}),a.jsxs("label",{className:"label-checkbox",children:[a.jsx("input",{type:"checkbox",checked:!!Or.gstAmounts,onChange:()=>Qr("gstAmounts")})," ",a.jsx("span",{style:{marginLeft:8},children:"GST Amounts / Tax"})]}),a.jsxs("label",{className:"label-checkbox",children:[a.jsx("input",{type:"checkbox",checked:!!Or.leadTime,onChange:()=>Qr("leadTime")})," ",a.jsx("span",{style:{marginLeft:8},children:"Lead Time"})]}),a.jsxs("label",{className:"label-checkbox",children:[a.jsx("input",{type:"checkbox",checked:!!Or.itemRate,onChange:()=>Qr("itemRate")})," ",a.jsx("span",{style:{marginLeft:8},children:"Item Rate"})]})]})]}),a.jsxs("div",{className:"modal-footer",style:{marginTop:14},children:[a.jsx("button",{className:"btn",onClick:Xs,style:{background:"#f8f9fa",color:"#333",border:"1px solid #e6eef0",padding:"8px 16px",borderRadius:"4px"},children:"Cancel"}),a.jsx("button",{className:"btn btn--save",onClick:qn,style:{background:"#1e7b5a",color:"#fff",border:"none",padding:"8px 16px",borderRadius:"4px"},children:"Save"})]})]})})]})]})})]})},Que="http://localhost:8000";function sN({isEditing:e=!1,editingRole:r=null,onUpdateRole:t,onCancel:n,onCreate:s}){const[o,i]=G.useState(""),[c,u]=G.useState(""),[l,d]=G.useState({all:!1,create:!1,delete:!1,update:!1,view:!1});G.useEffect(()=>{if(e&&r){i(r.name||""),u(r.description||"");const p=r.permissions||{};d({view:!!p.view,create:!!p.create,update:!!p.update,delete:!!p.delete,all:!!p.view&&!!p.create&&!!p.update&&!!p.delete})}else i(""),u(""),d({all:!1,create:!1,delete:!1,update:!1,view:!1})},[e,r]);const h=p=>{if(p==="all"){const v=!l.all;d({all:v,create:v,delete:v,update:v,view:v})}else{const v={...l,[p]:!l[p]};v.all=v.create&&v.delete&&v.update&&v.view,d(v)}},f=()=>{const p=o.trim();if(!p)return;const v={...l};delete v.all;const g={role_name:p,description:c,permissions:v};if(console.log("RoleCreation: submitting role",g),e){const m={id:r==null?void 0:r.id,name:p,description:c,permissions:v};typeof t=="function"&&t(m,r==null?void 0:r.name);return}fetch(`${Que}/api/roles`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)}).then(async m=>{const b=await m.json();if(!m.ok)throw new Error(b.error||"Failed to create role");const y={id:b.id,name:b.role_name||p,description:b.description||"",permissions:b.permissions||{}};try{const S=JSON.parse(localStorage.getItem("roles")||"[]");S.push(y),localStorage.setItem("roles",JSON.stringify(S))}catch{}typeof s=="function"&&s(y);try{window.dispatchEvent(new CustomEvent("roleCreated",{detail:y}))}catch{}i(""),u(""),d({all:!1,create:!1,delete:!1,update:!1,view:!1}),alert("Role created successfully!")}).catch(m=>{console.error("RoleCreation: create failed",m),alert(m.message||"Failed to create role")})};return a.jsx("div",{className:`role-creation-bg ${e?"embedded":""}`,children:a.jsxs("div",{className:"role-creation-container",children:[a.jsx("h1",{className:"role-creation-title",children:e?"Edit Role":"Create New Role"}),a.jsxs("div",{className:"role-creation-field",children:[a.jsx("label",{className:"role-creation-label",children:"Role Name"}),a.jsx("input",{type:"text",placeholder:"Enter role name",value:o,onChange:p=>i(p.target.value),className:"role-creation-input"})]}),a.jsxs("div",{className:"role-creation-field",children:[a.jsx("label",{className:"role-creation-label",children:"Description"}),a.jsx("textarea",{placeholder:"Enter description (optional)",value:c,onChange:p=>u(p.target.value),className:"role-creation-textarea"})]}),a.jsxs("div",{className:"role-creation-field",children:[a.jsx("label",{className:"role-creation-label",children:"Permissions"}),a.jsxs("div",{className:"role-creation-permissions",children:[a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:l.all,onChange:()=>h("all")}),"All"]}),a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:l.view,onChange:()=>h("view")}),"View"]}),a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:l.create,onChange:()=>h("create")}),"Create"]}),a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:l.update,onChange:()=>h("update")}),"Update"]}),a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:l.delete,onChange:()=>h("delete")}),"Delete"]})]})]}),a.jsxs("div",{className:"form-buttons",children:[e&&a.jsx("button",{className:"role-creation-btn",onClick:n,children:"Cancel"}),a.jsx("button",{className:"role-creation-btn",onClick:f,children:e?"Update Role":"Create Role"})]})]})})}const iN=({onAddMenu:e,isEditing:r,editingMenu:t,onUpdateMenu:n,onCancel:s})=>{const[o,i]=G.useState(""),[c,u]=G.useState(""),[l,d]=G.useState(""),[h,f]=G.useState(""),[p,v]=G.useState(0),[g,m]=G.useState("main"),[b,y]=G.useState(!0),[S,C]=G.useState(!1),[L,O]=G.useState({all:!1,view:!1,create:!1,update:!1,delete:!1}),[H,z]=G.useState(""),[q,D]=G.useState([]),[W,P]=G.useState([]),[I,U]=G.useState(""),[k,_]=G.useState(!1),[R,j]=G.useState(!1),A=async()=>{try{j(!0);const M=await ut.get(`${Je}/api/loadMenus?limit=1000`);console.log("Loaded menus raw:",M.data);const Z=Array.isArray(M.data)?M.data:M.data.data||[];D(Z);const J=Z.filter(re=>!r||re.id!==(t==null?void 0:t.id));P(J)}catch(M){console.error("Failed to load menus",M)}finally{j(!1)}};G.useEffect(()=>{A()},[]),G.useEffect(()=>{if(r&&t){i(t.menu_name||""),u(t.url||""),d(t.icon||""),f(t.parent_id||""),v(t.sort_order||0),m(t.menu_type||"main"),y(t.is_active!==void 0?t.is_active:!0),C(t.requires_auth!==void 0?t.requires_auth:!1),z(t.description||"");const M=t.permissions||{};O({view:!!M.view,create:!!M.create,update:!!M.update,delete:!!M.delete,all:M.view&&M.create&&M.update&&M.delete})}else i(""),u(""),d(""),f(""),v(0),m("main"),y(!0),C(!1),O({all:!1,view:!1,create:!1,update:!1,delete:!1}),z("")},[r,t]);const N=M=>{if(M==="all"){const Z=!L.all;O({all:Z,view:Z,create:Z,update:Z,delete:Z})}else{const Z={...L,[M]:!L[M]};Z.all=Z.view&&Z.create&&Z.update&&Z.delete,O(Z)}},V=async M=>{M.preventDefault();const Z=o.trim();if(!Z)return;const J={...L};delete J.all;const re={menu_name:Z,description:H,url:c,icon:l,parent_id:h?parseInt(h):null,sort_order:p,menu_type:g,is_active:b,requires_auth:S,permissions:J};console.log("Sending to backend:",re);try{if(j(!0),r){const X=await ut.put(`${Je}/api/menus/${t.id}`,re);typeof n=="function"&&n(X.data)}else{const X=await ut.post(`${Je}/api/menus`,re);typeof e=="function"&&e(X.data),await A();try{const ne=JSON.parse(localStorage.getItem("menus")||"[]");ne.push(X.data),localStorage.setItem("menus",JSON.stringify(ne))}catch{}try{window.dispatchEvent(new CustomEvent("menuCreated",{detail:X.data}))}catch{}i(""),u(""),d(""),f(""),v(0),m("main"),y(!0),C(!1),O({all:!1,view:!1,create:!1,update:!1,delete:!1}),z("")}}catch(X){console.error("Failed to save menu",X)}finally{j(!1)}};return q.filter(M=>M.menu_name.toLowerCase().includes(I.toLowerCase())&&(!r||M.id!==(t==null?void 0:t.id))),a.jsxs("div",{className:`menu-creation-container ${r?"embedded":""}`,children:[a.jsx("h1",{className:"menu-title",children:r?"Edit Menu":"Menu Creation"}),a.jsxs("form",{className:"menu-form",onSubmit:V,children:[a.jsx("label",{className:"menu-label",children:"Menu Name *"}),a.jsx("input",{className:"menu-input",type:"text",placeholder:"Enter menu name",value:o,onChange:M=>i(M.target.value),disabled:R,required:!0}),a.jsx("label",{className:"menu-label",children:"URL"}),a.jsx("input",{className:"menu-input",type:"text",placeholder:"Enter URL path (e.g., /dashboard)",value:c,onChange:M=>u(M.target.value),disabled:R}),a.jsx("label",{className:"menu-label",children:"Icon"}),a.jsx("input",{className:"menu-input",type:"text",placeholder:"Enter icon class name (e.g., fa fa-home)",value:l,onChange:M=>d(M.target.value),disabled:R}),a.jsx("label",{className:"menu-label",children:"Parent Menu"}),a.jsxs("select",{className:"menu-input",value:h,onChange:M=>f(M.target.value),disabled:R,children:[a.jsx("option",{value:"",children:"No Parent (Top Level)"}),W.map(M=>a.jsx("option",{value:M.id,children:M.menu_name},M.id))]}),a.jsx("label",{className:"menu-label",children:"Sort Order"}),a.jsx("input",{className:"menu-input",type:"number",placeholder:"Sort order",value:p,onChange:M=>v(parseInt(M.target.value)||0),disabled:R}),a.jsx("label",{className:"menu-label",children:"Menu Type"}),a.jsxs("select",{className:"menu-input",value:g,onChange:M=>m(M.target.value),disabled:R,children:[a.jsx("option",{value:"main",children:"Main Menu"}),a.jsx("option",{value:"sub",children:"Sub Menu"}),a.jsx("option",{value:"footer",children:"Footer Menu"}),a.jsx("option",{value:"sidebar",children:"Sidebar Menu"})]}),a.jsxs("div",{className:"checkbox-group",children:[a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:b,onChange:()=>y(!b),disabled:R}),"Active"]}),a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:S,onChange:()=>C(!S),disabled:R}),"Requires Authentication"]})]}),a.jsx("label",{className:"menu-label",children:"Permissions"}),a.jsxs("div",{className:"permissions-group",children:[a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:L.all,onChange:()=>N("all"),disabled:R}),"All"]}),a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:L.view,onChange:()=>N("view"),disabled:R}),"View"]}),a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:L.create,onChange:()=>N("create"),disabled:R}),"Create"]}),a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:L.update,onChange:()=>N("update"),disabled:R}),"Update"]}),a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:L.delete,onChange:()=>N("delete"),disabled:R}),"Delete"]})]}),a.jsx("label",{className:"menu-label",children:"Remarks"}),a.jsx("textarea",{className:"menu-textarea",placeholder:"Enter description (optional)",value:H,onChange:M=>z(M.target.value),disabled:R}),a.jsxs("div",{className:"form-buttons",children:[r&&a.jsx("button",{className:"menu-cancel-btn",type:"button",onClick:s,disabled:R,children:"Cancel"}),a.jsx("button",{className:"menu-submit-btn",type:"submit",disabled:R,children:R?"Processing...":r?"Update Menu":"Create Menu"})]})]})]})};function ede(){G.useEffect(()=>{if(typeof window<"u"&&!window.__ROLE_MGMT_CONSOLE_WRAPPED){console.log(" [RoleManagement] Setting up console wrapper"),window.__ROLE_MGMT_CONSOLE_LOGS=[];const D=["log","info","warn","error","debug"],W={};D.forEach(P=>{W[P]=console[P].bind(console)}),D.forEach(P=>{console[P]=(...I)=>{try{W[P](...I)}catch{}try{const U=I.map(_=>{try{return typeof _=="string"?_:typeof _=="object"?JSON.stringify(_):String(_)}catch{return"[Unserializable]"}}).join(" "),k={level:P,text:U,time:new Date().toLocaleTimeString()};if(window.__ROLE_MGMT_CONSOLE_LOGS.push(k),window.__ROLE_MGMT_CONSOLE_LOGS.length>200&&window.__ROLE_MGMT_CONSOLE_LOGS.shift(),typeof window.__ROLE_MGMT_ON_LOG=="function")try{window.__ROLE_MGMT_ON_LOG(k)}catch{}}catch{}}}),window.__ROLE_MGMT_CONSOLE_WRAPPED=!0,console.log(" [RoleManagement] Console wrapper installed successfully")}},[]);const[e,r]=G.useState(()=>{console.log(" [RoleManagement] Initializing roles state");const D=JSON.parse(localStorage.getItem("roles")||"[]");return D.length>0?(console.log(" [RoleManagement] Using stored roles:",D),D.map(W=>({label:`${W.name} - ${W.description}`,value:W.name,id:W.id}))):(console.log(" [RoleManagement] Using default superadmin role"),[{label:"superadmin - Super Administrator with access to all p",value:"superadmin"}])}),[t,n]=G.useState(e.length?e[0].value:"");G.useEffect(()=>{console.log(" [RoleManagement] Fetching roles from backend..."),console.log(" [RoleManagement] BASE_URL:",Je),fetch(`${Je}/api/roles?limit=1000`).then(async D=>{console.log(" [RoleManagement] Roles API response status:",D.status);const W=await D.text();console.log(" [RoleManagement] Roles API raw response:",W);let P;try{P=JSON.parse(W),console.log(" [RoleManagement] Roles API parsed data:",P)}catch(k){P=W,console.error(" [RoleManagement] Failed to parse roles JSON:",k)}if(!D.ok)throw new Error(P&&P.error||(typeof P=="string"?P:"Failed to fetch roles"));const I=Array.isArray(P.data)?P.data:P;console.log(" [RoleManagement] Roles list:",I);const U=I.map(k=>({label:`${k.role_name} - ${k.description||""}`,value:k.role_name,id:k.id}));console.log(" [RoleManagement] Mapped roles:",U),r(U),U.length&&n(k=>k&&U.find(_=>_.value===k)?k:U[0].value);try{localStorage.setItem("roles",JSON.stringify(U.map(k=>({name:k.value,description:k.label.split(" - ")[1]||"",id:k.id})))),console.log(" [RoleManagement] Roles saved to localStorage")}catch(k){console.error(" [RoleManagement] Failed to save roles to localStorage:",k)}}).catch(D=>{console.error(" [RoleManagement] Failed to fetch roles, using localStorage fallback",D);const W=JSON.parse(localStorage.getItem("roles")||"[]");console.log(" [RoleManagement] Fallback stored roles:",W),W.length&&r(W.map(P=>({label:`${P.name} - ${P.description}`,value:P.name,id:P.id})))})},[]);const[s,o]=G.useState([{label:"All menus...",value:"all"}]),[i,c]=G.useState([]),[u,l]=G.useState("all");G.useEffect(()=>{console.log(" [RoleManagement] Fetching menus from backend..."),(async()=>{try{const D=await fetch(`${Je}/api/loadMenus`);console.log(" [RoleManagement] Menus API response status:",D.status);const W=await D.text();console.log(" [RoleManagement] Menus API raw response:",W.substring(0,500)+"...");let P;try{P=JSON.parse(W),console.log(" [RoleManagement] Menus API parsed data:",P)}catch(_){P=W,console.error(" [RoleManagement] Failed to parse menus JSON:",_)}if(!D.ok)throw new Error(P&&P.error||(typeof P=="string"?P:"Failed to fetch menus"));const I=Array.isArray(P)?P:P&&P.data?P.data:[];console.log(" [RoleManagement] Menus list:",I);const U=[{label:"All menus...",value:"all"},...I.map(_=>({label:_.menu_name||_.name,value:_.menu_name||_.name,id:_.id}))];console.log(" [RoleManagement] Mapped menus:",U),o(U),U.length&&l(U[0].value);const k=I.map(_=>({menu:_.menu_name||_.name,permissions:["All","View","Create","Update","Delete"],id:_.id}));console.log(" [RoleManagement] Permissions data:",k),c(k)}catch(D){console.error(" [RoleManagement] Failed to fetch menus from backend",D);const W=JSON.parse(localStorage.getItem("menus")||"[]");if(console.log(" [RoleManagement] Using fallback stored menus:",W),W.length){const P=[{label:"All menus...",value:"all"},...W.map(U=>({label:U.name||U.menu_name,value:U.name||U.menu_name}))];o(P),P.length&&l(P[0].value);const I=W.map(U=>({menu:U.name||U.menu_name,permissions:["All","View","Create","Update","Delete"],id:U.id}));c(I)}}})()},[]);const[d,h]=G.useState({}),[f,p]=G.useState([]),v=G.useRef({}),[g,m]=G.useState(1),[b,y]=G.useState(10),[S,C]=G.useState([]),[L,O]=G.useState(!1);G.useEffect(()=>{console.log(" [RoleManagement] Setting up console log listener");const D=(window.__ROLE_MGMT_CONSOLE_LOGS||[]).slice(-200);return console.log(" [RoleManagement] Buffered logs count:",D.length),C(D),window.__ROLE_MGMT_ON_LOG=W=>{C(P=>{const I=P.concat(W);return I.length>200?I.slice(I.length-200):I})},()=>{try{delete window.__ROLE_MGMT_ON_LOG,console.log(" [RoleManagement] Cleaned up console listener")}catch(W){console.error(" [RoleManagement] Error cleaning up console listener:",W)}}},[]),G.useEffect(()=>{v.current={roles:e,selectedRole:t,menus:s,permissionsData:i,roleMenuTree:f,permissions:d},console.log(" [RoleManagement] Updated ref with current state")},[e,t,s,i,f,d]),G.useEffect(()=>(console.log(" [RoleManagement] Component fully mounted and ready"),console.log(" [RoleManagement] Current state:",{rolesCount:e.length,selectedRole:t,menusCount:s.length,permissionsDataCount:i.length,permissionsKeys:Object.keys(d)}),window.__ROLE_MGMT=()=>(console.log(" [RoleManagement] Debug function called, returning current state"),v.current),()=>{try{delete window.__ROLE_MGMT,console.log(" [RoleManagement] Cleaned up debug function")}catch(D){console.error(" [RoleManagement] Error cleaning up debug function:",D)}}),[]),G.useEffect(()=>{if(console.log(" [RoleManagement] Effect: selectedRole or permissionsData changed",{selectedRole:t,permissionsDataLength:i.length}),!t){console.log(" [RoleManagement] No selected role, skipping permission fetch");return}if(!i.length){console.log(" [RoleManagement] Permissions data not loaded yet, initializing empty"),h({});return}const D=e.find(W=>W.value===t);if(console.log(" [RoleManagement] Found role object:",D),D&&D.id)console.log(" [RoleManagement] Fetching permissions for role ID:",D.id),(async()=>{try{const W=`${Je}/api/roles/${D.id}/permissions/menu-tree`;console.log(" [RoleManagement] Fetching role menu tree from:",W);const P=await fetch(W);console.log(" [RoleManagement] Permissions API response status:",P.status);const I=await P.text();console.log(" [RoleManagement] Permissions API raw response:",I);let U;try{U=JSON.parse(I),console.log(" [RoleManagement] Permissions API parsed data:",U)}catch(_){U=I,console.error(" [RoleManagement] Failed to parse permissions JSON:",_)}p(U);const k={};if(Array.isArray(U))console.log(" [RoleManagement] Processing array-shaped permissions data"),i.forEach(({menu:_})=>{const R=U.find(A=>(A.menu_name||A.MenuName||A.name)===_||(A.Menu&&A.Menu.menu_name)===_),j=R?R.permissions||R.Permissions||{}:{};k[_]={All:!!j.can_all,View:!!j.can_view,Create:!!j.can_create,Update:!!j.can_update,Delete:!!j.can_delete},console.log(` [RoleManagement] Menu ${_} permissions:`,k[_])});else if(U&&typeof U=="object"){console.log(" [RoleManagement] Processing object-shaped permissions data");const _=Object.keys(U);i.forEach(({menu:R,id:j})=>{let A;if(j&&U[String(j)]&&(A=U[String(j)]),!A&&U[R]&&(A=U[R]),!A)for(const V of _){const M=U[V];if(M&&typeof M=="object"){if(V===String(j)||String(V)===String(j)){A=M;break}if(M.Menu&&(M.Menu.menu_name===R||M.Menu.name===R)){A=M.permissions||M.Permissions||{};break}if(M.menu_name===R||M.name===R){A=M.permissions||M.Permissions||M;break}}}const N=A&&(A.permissions||A.Permissions)?A.permissions||A.Permissions:A||{};k[R]={All:!!N.can_all,View:!!N.can_view,Create:!!N.can_create,Update:!!N.can_update,Delete:!!N.can_delete},console.log(` [RoleManagement] Menu ${R} permissions:`,k[R])})}else console.log(" [RoleManagement] Unknown permissions data shape, using defaults"),i.forEach(({menu:_})=>{k[_]={All:!1,View:!1,Create:!1,Update:!1,Delete:!1}});console.log(" [RoleManagement] Final mapped permissions:",k),h(k)}catch(W){console.error(" [RoleManagement] Failed to load permissions from backend",W);const P={};i.forEach(({menu:I})=>{P[I]={All:!1,View:!1,Create:!1,Update:!1,Delete:!1}}),h(P)}})();else{console.log(" [RoleManagement] No role ID found, initializing default permissions");const W={};i.forEach(({menu:P})=>{W[P]={All:!1,View:!1,Create:!1,Update:!1,Delete:!1}}),h(W)}},[t,i,e]);const H=(D,W)=>{console.log(` [RoleManagement] Changing permission: ${D}.${W}`),h(P=>{const I={...P[D],[W]:!P[D][W]},U=I.View&&I.Create&&I.Update&&I.Delete;return I.All=U,console.log(` [RoleManagement] New permissions for ${D}:`,I),{...P,[D]:I}})},z=D=>{console.log(` [RoleManagement] Toggling 'All' for menu: ${D}`);const W=!d[D].All;h(P=>({...P,[D]:{All:W,View:W,Create:W,Update:W,Delete:W}}))},q=async()=>{console.log(" [RoleManagement] Save button clicked"),console.log(" [RoleManagement] Current selectedRole:",t),console.log(" [RoleManagement] Current permissions:",d);const D=e.find(U=>U.value===t);if(console.log(" [RoleManagement] Found role object for save:",D),!D||!D.id){console.error(" [RoleManagement] Cannot save permissions: role id not found for",t),alert("Error: Role ID not found. Please select a valid role.");return}if(!i.length){console.error(" [RoleManagement] Cannot save permissions: menus not loaded yet"),alert("Error: Menus not loaded yet. Please wait and try again.");return}const W=new Map(i.map(U=>[U.menu,U.id]));if(f&&f.length)try{f.forEach(U=>{U&&(U.menu_name||U.name)&&U.id&&W.set(U.menu_name||U.name,U.id)})}catch{}console.log(" [RoleManagement] Lookup map (menu -> id):",Array.from(W.entries()));const P={},I=[];if(i.forEach(({menu:U})=>{const k=d[U]||{All:!1,View:!1,Create:!1,Update:!1,Delete:!1},_=W.get(U);if(!_){I.push(U);return}const R=String(_);P[R]={can_all:!!k.All,can_view:!!k.View,can_create:!!k.Create,can_update:!!k.Update,can_delete:!!k.Delete},console.log(` [RoleManagement] Payload for ${U} (ID: ${R}):`,P[R])}),I.length){console.error(" [RoleManagement] Cannot save: missing menu IDs for menus:",I),alert(`Error: The following menus lack IDs and cannot be saved: ${I.join(", ")}`);return}console.log(" [RoleManagement] Final payload to send (IDs only):",P);try{const U=`${Je}/api/roles/${D.id}/permissions`;console.log(" [RoleManagement] Saving to:",U),console.log(" [RoleManagement] Payload JSON string:",JSON.stringify(P));const k=await fetch(U,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(P)});console.log(" [RoleManagement] Save response status:",k.status);const _=await k.json();if(console.log(" [RoleManagement] Save response data:",_),!k.ok)throw new Error(_.error||_.message||"Failed to update permissions");console.log(" [RoleManagement] Permissions updated successfully for role:",t),alert("Permissions saved successfully!")}catch(U){console.error(" [RoleManagement] Failed to save permissions to backend:",U),alert("Error saving permissions: "+U.message)}};return a.jsxs("div",{className:"role-management-container",children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[a.jsx("div",{className:"role-management-header",children:"Role Mapping to Menus"}),a.jsx("button",{type:"button",onClick:()=>{console.log(" [RoleManagement] Debug button clicked"),console.log(" [RoleManagement] Current state via ref:",v.current),O(D=>!D)},className:"debug-button",style:{marginLeft:12},children:"Debug"})]}),L&&a.jsxs("div",{style:{marginTop:8,maxHeight:220,overflow:"auto",background:"#111",color:"#dcdcdc",padding:8,borderRadius:6},children:[a.jsxs("div",{style:{fontSize:12,marginBottom:6},children:["Console capture (last ",S.length,"):"]}),a.jsx("div",{style:{fontFamily:"monospace",fontSize:12},children:S.map((D,W)=>a.jsxs("div",{style:{opacity:.95},children:[a.jsxs("span",{style:{color:D.level==="error"?"#ff6b6b":D.level==="warn"?"#ffb86b":"#9ad0ff"},children:["[",D.time,"] ",D.level]}),a.jsxs("span",{children:[": ",D.text]})]},W))})]}),a.jsxs("div",{className:"role-management-selectors",children:[a.jsxs("div",{children:[a.jsx("label",{children:"Select Role"}),a.jsx("select",{value:t,onChange:D=>{console.log(" [RoleManagement] Role changed to:",D.target.value),n(D.target.value)},children:e.map(D=>a.jsx("option",{value:D.value,children:D.label},D.value))})]}),a.jsxs("div",{children:[a.jsx("label",{children:"Select Menu"}),a.jsx("select",{value:u,onChange:D=>{console.log(" [RoleManagement] Menu changed to:",D.target.value),l(D.target.value)},children:s.map(D=>a.jsx("option",{value:D.value,children:D.label},D.value))})]})]}),a.jsxs("div",{className:"role-management-permissions",children:[a.jsxs("div",{className:"role-management-permissions-title",children:["Role Permissions for: ",a.jsx("b",{children:t})]}),a.jsx("div",{className:"permissions-table",children:i.slice((g-1)*b,g*b).map(({menu:D,permissions:W})=>{var P;return a.jsxs("div",{className:`permissions-row${(P=d[D])!=null&&P.All?" active":""}`,children:[a.jsx("span",{className:"menu-title",children:D}),W.map(I=>{var U;return a.jsxs("label",{className:"perm-label",children:[a.jsx("input",{type:"checkbox",checked:!!((U=d[D])!=null&&U[I]),onChange:()=>{console.log(` [RoleManagement] Checkbox changed: ${D}.${I}`),I==="All"?z(D):H(D,I)}}),I]},I)})]},D)})}),a.jsxs("div",{className:"pagination",children:[a.jsxs("div",{className:"page-info",children:["Showing ",i.length===0?0:(g-1)*b+1," - ",Math.min(g*b,i.length)," of ",i.length]}),a.jsxs("div",{className:"page-controls",children:[a.jsx("button",{disabled:g===1,onClick:()=>m(D=>Math.max(1,D-1)),children:"Prev"}),[...Array(Math.max(1,Math.ceil(i.length/b)))].map((D,W)=>{const P=W+1;return a.jsx("button",{className:P===g?"active":"",onClick:()=>m(P),children:P},P)}),a.jsx("button",{disabled:g===Math.max(1,Math.ceil(i.length/b)),onClick:()=>m(D=>Math.min(Math.max(1,Math.ceil(i.length/b)),D+1)),children:"Next"})]}),a.jsxs("div",{className:"items-per-page",children:[a.jsx("label",{children:"Show:"}),a.jsxs("select",{value:b,onChange:D=>{y(Number(D.target.value)),m(1)},children:[a.jsx("option",{value:5,children:"5"}),a.jsx("option",{value:10,children:"10"}),a.jsx("option",{value:20,children:"20"}),a.jsx("option",{value:50,children:"50"})]})]})]}),a.jsx("button",{className:"save-button",onClick:q,children:"Save Changes"})]})]})}const tS="http://localhost:8000",tde=()=>{};function rde({roles:e,setRoles:r,initialRoles:t,onEditRole:n=tde}){const[s,o]=G.useState(""),[i,c]=G.useState(()=>e||JSON.parse(localStorage.getItem("roles")||"[]")),[u,l]=G.useState(!1),[d,h]=G.useState(!1),[f,p]=G.useState(null),[v,g]=G.useState("asc"),[m,b]=G.useState(1),[y,S]=G.useState(10),C=e||i,L=A=>{r&&typeof r=="function"?r(A):(c(A),localStorage.setItem("roles",JSON.stringify(A)))},O=Array.isArray(C)?C:[],H=A=>{if(r&&typeof r!="function"){console.error("ExistingRoles: setRoles provided but not a function");return}if(!window.confirm("Are you sure you want to delete this role?"))return;const N=O.find(V=>V.name===A||V.id===(A==null?void 0:A.id));N&&(N.id?fetch(`${tS}/api/roles/${N.id}`,{method:"DELETE"}).then(V=>{if(!V.ok)throw new Error("Failed to delete role");L(O.filter(M=>M.name!==A))}).catch(V=>{console.error("ExistingRoles: delete failed",V),alert("Failed to delete role")}):L(O.filter(V=>V.name!==A)))},z=A=>{h(!0),p(A)},q=(A,N)=>{const V=O.find(M=>M.name===N||A&&A.id&&M.id===A.id);if(V&&V.id){const M={role_name:A.name,description:A.description,permissions:A.permissions};fetch(`${tS}/api/roles/${V.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)}).then(async Z=>{const J=await Z.json();if(!Z.ok)throw new Error(J.error||"Failed to update role");const re={id:J.id,name:J.role_name,description:J.description,permissions:J.permissions},X=O.map(ne=>ne.id===re.id?re:ne);L(X),h(!1),p(null)}).catch(Z=>{console.error("ExistingRoles: update failed",Z),alert(Z.message||"Failed to update role")})}else{const M=O.map(Z=>Z.name===N?A:Z);L(M),h(!1),p(null)}},D=()=>{h(!1),p(null)},W=A=>{o(A.target.value),b(1)},P=()=>{if(r&&typeof r!="function"){console.error("ExistingRoles: setRoles provided but not a function");return}I(),o("")};function I(A=""){l(!0);const N=A?`?filter=${encodeURIComponent(A)}&limit=1000`:"?limit=1000";fetch(`${tS}/api/roles${N}`).then(async V=>{const M=await V.json();if(!V.ok)throw new Error(M.error||"Failed to fetch roles");const J=(Array.isArray(M.data)?M.data:M).map(re=>({id:re.id,name:re.role_name||re.RoleName||re.name,description:re.description||"",permissions:re.permissions||{}}));L(J)}).catch(V=>{console.error("ExistingRoles: fetch failed",V),Array.isArray(t)&&t.length>0&&L(t)}).finally(()=>l(!1))}G.useEffect(()=>{e&&c(e)},[e]),G.useEffect(()=>{I();const A=N=>{const V=N.detail;L([...Array.isArray(O)?O:[],V])};return window.addEventListener("roleCreated",A),()=>window.removeEventListener("roleCreated",A)},[]);const U=()=>{g(A=>A==="asc"?"desc":"asc")},_=[...O.filter(A=>A.name.toLowerCase().includes(s.toLowerCase()))].sort((A,N)=>v==="asc"?A.name.localeCompare(N.name):N.name.localeCompare(A.name)),R=Math.max(1,Math.ceil(_.length/y));G.useEffect(()=>{m>R&&b(1)},[_.length,y]);const j=_.slice((m-1)*y,m*y);return a.jsxs("div",{className:"existing-roles-container",children:[a.jsxs("section",{className:"title-section",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"page-title",children:"Role Management"}),a.jsx("div",{className:"subtitle",children:"Manage all your available roles"})]}),a.jsxs("div",{className:"actions-row",children:[a.jsx("input",{type:"text",className:"search-input",placeholder:"Search role...",value:s,onChange:W}),a.jsx("button",{className:"refresh-btn",onClick:P,children:"Refresh"})]})]}),d&&a.jsx("div",{className:"editing-container",children:a.jsx(sN,{isEditing:d,editingRole:f,onUpdateRole:q,onCancel:D})}),!d&&a.jsxs("table",{className:"roles-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsxs("th",{onClick:U,style:{cursor:"pointer"},children:["Role Name ",v==="asc"?a.jsx(d7,{}):a.jsx(c7,{})]}),a.jsx("th",{children:"Description"}),a.jsx("th",{children:"Permissions"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:j.map(A=>a.jsxs("tr",{children:[a.jsx("td",{children:A.name}),a.jsx("td",{children:A.description}),a.jsx("td",{children:A.permissions?Object.entries(A.permissions).filter(([N,V])=>V&&N!=="all").map(([N])=>N.charAt(0).toUpperCase()+N.slice(1)).join(", "):""}),a.jsxs("td",{children:[a.jsx("button",{className:"action-btn edit-btn",title:"Edit",onClick:()=>z(A),children:a.jsx(Yf,{})}),a.jsx("button",{className:"action-btn delete-btn",title:"Delete",onClick:()=>H(A.name),children:a.jsx(Zf,{})})]})]},A.name))})]}),a.jsxs("div",{className:"pagination",children:[a.jsxs("div",{className:"page-info",children:["Showing ",_.length===0?0:(m-1)*y+1," - ",Math.min(m*y,_.length)," of ",_.length]}),a.jsxs("div",{className:"page-controls",children:[a.jsx("button",{disabled:m===1,onClick:()=>b(A=>Math.max(1,A-1)),children:"Prev"}),[...Array(R)].map((A,N)=>{const V=N+1;return a.jsx("button",{className:V===m?"active":"",onClick:()=>b(V),children:V},V)}),a.jsx("button",{disabled:m===R,onClick:()=>b(A=>Math.min(R,A+1)),children:"Next"})]}),a.jsxs("div",{className:"items-per-page",children:[a.jsx("label",{children:"Show:"}),a.jsxs("select",{value:y,onChange:A=>{S(Number(A.target.value)),b(1)},children:[a.jsx("option",{value:5,children:"5"}),a.jsx("option",{value:10,children:"10"}),a.jsx("option",{value:20,children:"20"}),a.jsx("option",{value:50,children:"50"})]})]})]})]})}const nde=()=>{};function ade({menus:e,setMenus:r,initialMenus:t,onEditMenu:n=nde}){const[s,o]=G.useState(""),[i,c]=G.useState(()=>e||JSON.parse(localStorage.getItem("menus")||"[]")),[u,l]=G.useState(!1),[d,h]=G.useState(null),[f,p]=G.useState("asc"),[v,g]=G.useState(!1),[m,b]=G.useState(1),[y,S]=G.useState(10),C=async()=>{try{g(!0);const N=await ut.get(`${Je}/api/loadMenus?limit=1000`),V=Array.isArray(N.data)?N.data:N.data.data||[];O(V)}catch(N){console.error("Failed to load menus",N)}finally{g(!1)}};G.useEffect(()=>{C();const N=V=>{C()};return window.addEventListener("menuCreated",N),()=>window.removeEventListener("menuCreated",N)},[]);const L=e||i,O=N=>{r&&typeof r=="function"?r(N):(c(N),localStorage.setItem("menus",JSON.stringify(N)))},H=new Map(L.map(N=>[N.id,N.menu_name])),z=Array.isArray(L)?L:[],q=async N=>{if(r&&typeof r!="function"){console.error("ExistingMenus: setMenus provided but not a function");return}if(window.confirm("Are you sure you want to delete this menu?"))try{await ut.delete(`${Je}/api/menus/${N}`),O(z.filter(V=>V.id!==N)),C()}catch(V){console.error("Failed to delete menu",V)}},D=N=>{l(!0),h(N)},W=N=>{const V=z.map(M=>M.id===N.id?N:M);O(V),C(),l(!1),h(null)},P=()=>{l(!1),h(null)},I=N=>{o(N.target.value),b(1)},U=()=>{if(r&&typeof r!="function"){console.error("ExistingMenus: setMenus provided but not a function");return}C(),o(""),b(1)},k=()=>{p(N=>N==="asc"?"desc":"asc"),b(1)},R=[...z.filter(N=>N.menu_name.toLowerCase().includes(s.toLowerCase()))].sort((N,V)=>f==="asc"?N.menu_name.localeCompare(V.menu_name):V.menu_name.localeCompare(N.menu_name)),j=Math.ceil(R.length/y),A=R.slice((m-1)*y,m*y);return a.jsxs("div",{className:"existing-menus-container",children:[a.jsxs("section",{className:"title-section",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"page-title",children:"Menu Management"}),a.jsx("div",{className:"subtitle",children:"Manage all your available menus"})]}),a.jsxs("div",{className:"actions-row",children:[a.jsx("input",{type:"text",className:"search-input",placeholder:"Search menu...",value:s,onChange:I}),a.jsx("button",{className:"refresh-btn",onClick:U,children:"Refresh"})]})]}),u&&a.jsx("div",{className:"editing-container",children:a.jsx(iN,{isEditing:u,editingMenu:d,onUpdateMenu:W,onCancel:P})}),!u&&a.jsxs("table",{className:"menus-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsxs("th",{onClick:k,style:{cursor:"pointer"},children:["Menu Name ",f==="asc"?a.jsx(d7,{}):a.jsx(c7,{})]}),a.jsx("th",{children:"URL"}),a.jsx("th",{children:"Icon"}),a.jsx("th",{children:"Parent Menu"}),a.jsx("th",{children:"Sort Order"}),a.jsx("th",{children:"Menu Type"}),a.jsx("th",{children:"Active"}),a.jsx("th",{children:"Requires Auth"}),a.jsx("th",{children:"Permissions"}),a.jsx("th",{children:"Remarks"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:A.map(N=>a.jsxs("tr",{children:[a.jsx("td",{children:N.menu_name}),a.jsx("td",{children:N.url||""}),a.jsx("td",{children:N.icon||""}),a.jsx("td",{children:N.parent_id&&H.get(N.parent_id)||"N/A"}),a.jsx("td",{children:N.sort_order||0}),a.jsx("td",{children:N.menu_type||"main"}),a.jsx("td",{children:N.is_active?"Yes":"No"}),a.jsx("td",{children:N.requires_auth?"Yes":"No"}),a.jsx("td",{children:N.permissions?Object.entries(N.permissions).filter(([V,M])=>M&&V!=="all").map(([V])=>V.charAt(0).toUpperCase()+V.slice(1)).join(", "):""}),a.jsx("td",{children:N.description}),a.jsxs("td",{children:[a.jsx("button",{className:"action-btn edit-btn",title:"Edit",onClick:()=>D(N),children:a.jsx(Yf,{})}),a.jsx("button",{className:"action-btn delete-btn",title:"Delete",onClick:()=>q(N.id),children:a.jsx(Zf,{})})]})]},N.id))})]}),a.jsxs("div",{className:"pagination-container",children:[a.jsxs("div",{className:"pagination-info",children:["Showing ",A.length>0?(m-1)*y+1:0," to ",Math.min(m*y,R.length)," of ",R.length," entries"]}),a.jsxs("div",{className:"pagination-controls",children:[a.jsx("button",{className:"pagination-btn",onClick:()=>b(N=>Math.max(N-1,1)),disabled:m===1,children:"Previous"}),Array.from({length:j},(N,V)=>V+1).map(N=>a.jsx("button",{className:`pagination-btn ${m===N?"active":""}`,onClick:()=>b(N),children:N},N)),a.jsx("button",{className:"pagination-btn",onClick:()=>b(N=>Math.min(N+1,j)),disabled:m===j,children:"Next"})]}),a.jsxs("div",{className:"items-per-page",children:[a.jsx("label",{children:"Show:"}),a.jsxs("select",{value:y,onChange:N=>{S(Number(N.target.value)),b(1)},children:[a.jsx("option",{value:5,children:"5"}),a.jsx("option",{value:10,children:"10"}),a.jsx("option",{value:20,children:"20"}),a.jsx("option",{value:50,children:"50"})]})]})]})]})}const Mj=[{label:"admin assignor (admin@cag.com)",value:"admin@cag.com"}],Dj=(()=>{const e=JSON.parse(localStorage.getItem("roles")||"[]");return e.length>0?e.map(r=>({label:`${r.name} - ${r.description}`,value:r.name})):[{label:"superadmin - Super Administrator with access to all p",value:"superadmin"}]})(),kd=[{menu:"Home",permissions:["All","View","Create","Update","Delete"]},{menu:"About",permissions:["All","View","Create","Update","Delete"]},{menu:"Feedback",permissions:["All","View","Create","Update","Delete"]},{menu:"Data Validation",permissions:["All","View","Create","Update","Delete"]},{menu:"Bulk Upload",permissions:["All","View","Create","Update","Delete"]}];function sde(){const[e,r]=G.useState(Mj[0].value),[t,n]=G.useState(Dj[0].value),[s,o]=G.useState([{label:"All menus...",value:"all"}]),[i,c]=G.useState("all"),[u,l]=G.useState(1),[d,h]=G.useState(10);G.useEffect(()=>{(async()=>{try{const S=await ut.get(`${Je}/api/loadMenus?limit=1000`),C=Array.isArray(S.data)?S.data:S.data.data||[],L=[{label:"All menus...",value:"all"},...C.map(O=>({label:O.menu_name,value:O.menu_name,id:O.id}))];o(L);try{localStorage.setItem("menus",JSON.stringify(C))}catch{}L.length&&c(L[0].value)}catch(S){console.error("UserManagement: failed to fetch menus, falling back to localStorage",S);const C=JSON.parse(localStorage.getItem("menus")||"[]");if(C.length){const L=[{label:"All menus...",value:"all"},...C.map(O=>({label:O.name||O.menu_name,value:O.name||O.menu_name}))];o(L),L.length&&c(L[0].value)}}})()},[]);const f=(y,S)=>{let C=localStorage.getItem(`permissions_${y}_${S}`);return C?JSON.parse(C):(C=localStorage.getItem(`permissions_${S}`),C?JSON.parse(C):{Home:{All:!1,View:!1,Create:!1,Update:!1,Delete:!1},About:{All:!1,View:!1,Create:!1,Update:!1,Delete:!1},Feedback:{All:!1,View:!1,Create:!1,Update:!1,Delete:!1},"Data Validation":{All:!0,View:!0,Create:!0,Update:!0,Delete:!0},"Bulk Upload":{All:!0,View:!0,Create:!0,Update:!0,Delete:!0}})},[p,v]=G.useState(f(e,t));G.useEffect(()=>{v(f(e,t))},[e,t]),G.useEffect(()=>{u>Math.max(1,Math.ceil(kd.length/d))&&l(1)},[kd.length]);const g=(y,S)=>{v(C=>{const L={...C[y],[S]:!C[y][S]},O=L.View&&L.Create&&L.Update&&L.Delete;return L.All=O,{...C,[y]:L}})},m=y=>{const S=!p[y].All;v(C=>({...C,[y]:{All:S,View:S,Create:S,Update:S,Delete:S}}))},b=()=>{localStorage.removeItem(`permissions_${e}_${t}`),v(f(e,t))};return a.jsxs("div",{className:"user-management-container",children:[a.jsx("div",{className:"user-management-header",children:"User Mapping to Roles"}),a.jsxs("div",{className:"user-management-selectors",children:[a.jsxs("div",{children:[a.jsx("label",{children:"Select User"}),a.jsx("select",{value:e,onChange:y=>r(y.target.value),children:Mj.map(y=>a.jsx("option",{value:y.value,children:y.label},y.value))})]}),a.jsxs("div",{children:[a.jsx("label",{children:"Select Role"}),a.jsx("select",{value:t,onChange:y=>n(y.target.value),children:Dj.map(y=>a.jsx("option",{value:y.value,children:y.label},y.value))})]}),a.jsxs("div",{children:[a.jsx("label",{children:"Select Menu"}),a.jsx("select",{value:i,onChange:y=>c(y.target.value),children:s.map(y=>a.jsx("option",{value:y.value,children:y.label},y.value))})]})]}),a.jsxs("div",{className:"user-management-permissions",children:[a.jsxs("div",{className:"user-management-permissions-title",children:["Assign Permissions for: ",a.jsx("b",{children:t})]}),a.jsx("div",{className:"permissions-table",children:kd.slice((u-1)*d,u*d).map(({menu:y,permissions:S})=>a.jsxs("div",{className:`permissions-row${p[y].All?" active":""}`,children:[a.jsx("span",{className:"menu-title",children:y}),S.map(C=>a.jsxs("label",{className:"perm-label",children:[a.jsx("input",{type:"checkbox",checked:p[y][C],onChange:()=>C==="All"?m(y):g(y,C)}),C]},C))]},y))}),a.jsxs("div",{className:"pagination",children:[a.jsxs("div",{className:"page-info",children:["Showing ",kd.length===0?0:(u-1)*d+1," - ",Math.min(u*d,kd.length)," of ",kd.length]}),a.jsxs("div",{className:"page-controls",children:[a.jsx("button",{disabled:u===1,onClick:()=>l(y=>Math.max(1,y-1)),children:"Prev"}),[...Array(Math.max(1,Math.ceil(kd.length/d)))].map((y,S)=>{const C=S+1;return a.jsx("button",{className:C===u?"active":"",onClick:()=>l(C),children:C},C)}),a.jsx("button",{disabled:u===Math.max(1,Math.ceil(kd.length/d)),onClick:()=>l(y=>Math.min(Math.max(1,Math.ceil(kd.length/d)),y+1)),children:"Next"})]}),a.jsxs("div",{className:"items-per-page",children:[a.jsx("label",{children:"Show:"}),a.jsxs("select",{value:d,onChange:y=>{h(Number(y.target.value)),l(1)},children:[a.jsx("option",{value:5,children:"5"}),a.jsx("option",{value:10,children:"10"}),a.jsx("option",{value:20,children:"20"}),a.jsx("option",{value:50,children:"50"})]})]})]}),a.jsxs("div",{className:"buttons-container",children:[a.jsx("button",{className:"save-button",onClick:b,children:"Reset Permissions"}),a.jsx("button",{className:"save-button",onClick:()=>{localStorage.setItem(`permissions_${e}_${t}`,JSON.stringify(p)),console.log("Changes saved for user:",e,"role:",t)},children:"Save Changes"})]})]})]})}const Ij=[{title:"final IR Signal.docx",changes:1,user:"validator1 assignee",ip:"192.168.102.2",action:"data validation update",datetime:"27/08/2025 16:52",details:"View"}],ide=[{key:"title",label:"Title"},{key:"changes",label:"Changes"},{key:"user",label:"User"},{key:"ip",label:"IP"},{key:"action",label:"Action"},{key:"datetime",label:"Date/Time"},{key:"details",label:"Details"}];function ode(){const[e,r]=G.useState(""),[t,n]=G.useState("asc"),[s,o]=G.useState({}),i=h=>[...new Set(Ij.map(f=>f[h]))].filter(f=>f!==void 0),u=[...Ij].sort((h,f)=>e?h[e]<f[e]?t==="asc"?-1:1:h[e]>f[e]?t==="asc"?1:-1:0:0).filter(h=>Object.entries(s).every(([f,p])=>!p||h[f]===p)),l=h=>{e===h?n(t==="asc"?"desc":"asc"):(r(h),n("asc"))},d=(h,f)=>{o({...s,[h]:f})};return a.jsxs("div",{className:"auditlogs-container",children:[a.jsx("div",{className:"auditlogs-header",children:a.jsx("h2",{children:"Audit Logs"})}),a.jsxs("div",{className:"auditlogs-controls",children:[a.jsx("input",{type:"text",className:"auditlogs-search",placeholder:"Search (title/user/action)"}),a.jsxs("div",{className:"auditlogs-total",children:[a.jsxs("span",{className:"auditlogs-total-badge",children:["Total: ",u.length," log",u.length!==1?"s":""]}),a.jsx("button",{className:"auditlogs-refresh",children:"Refresh"})]})]}),a.jsx("div",{className:"auditlogs-table-wrapper",children:a.jsxs("table",{className:"auditlogs-table",children:[a.jsx("thead",{children:a.jsx("tr",{children:ide.map(h=>a.jsxs("th",{children:[a.jsxs("span",{className:h.key!=="details"?"auditlogs-sortable":"",onClick:h.key!=="details"?()=>l(h.key):void 0,style:{cursor:h.key!=="details"?"pointer":"default",userSelect:"none"},children:[h.label,h.key!=="details"&&a.jsx("span",{className:"auditlogs-sort-icon",children:e===h.key?t==="asc"?" ":" ":" "})]}),h.key!=="details"&&a.jsxs("select",{className:"auditlogs-filter",value:s[h.key]||"",onChange:f=>d(h.key,f.target.value),children:[a.jsx("option",{value:"",children:"All"}),i(h.key).map(f=>a.jsx("option",{value:f,children:f},f))]})]},h.key))})}),a.jsx("tbody",{children:u.map((h,f)=>a.jsxs("tr",{children:[a.jsx("td",{children:h.title}),a.jsx("td",{children:a.jsx("span",{className:"auditlogs-changes",children:h.changes})}),a.jsx("td",{children:a.jsx("span",{className:"auditlogs-user",children:h.user})}),a.jsx("td",{children:h.ip}),a.jsx("td",{children:a.jsx("span",{className:"auditlogs-action",children:h.action})}),a.jsx("td",{children:h.datetime}),a.jsx("td",{children:a.jsx("button",{className:"auditlogs-view",children:h.details})})]},f))})]})})]})}function lde(){const[e,r]=G.useState([]),[t,n]=G.useState(!1),[s,o]=G.useState(null),[i,c]=G.useState({tandc_name:"",tandc_type:""}),[u,l]=G.useState(""),[d,h]=G.useState(1),f=10,p=async()=>{try{const S=await ut.get(`${Je}/api/tandc/`,{params:{page:d,limit:f,filter:u}});r(S.data.data)}catch(S){console.error(S)}};G.useEffect(()=>{p()},[d,u]);const v=(S=null)=>{S?(o(S.ID),c({tandc_name:S.TandcName,tandc_type:S.TandcType})):(o(null),c({tandc_name:"",tandc_type:""})),n(!0)},g=()=>n(!1),m=S=>c({...i,[S.target.name]:S.target.value}),b=async()=>{try{s?await ut.put(`${Je}/api/tandc/${s}`,{TandcName:i.tandc_name,TandcType:i.tandc_type}):await ut.post(`${Je}/api/tandc`,{TandcName:i.tandc_name,TandcType:i.tandc_type}),g(),p()}catch(S){console.error(S),alert("Error saving T&C")}},y=async S=>{if(window.confirm("Are you sure you want to delete this T&C?"))try{await ut.delete(`${Je}/api/tandc/${S}`),p()}catch(C){console.error(C)}};return a.jsx("section",{className:"right-content",children:a.jsxs("div",{className:"tandc-page-container",children:[a.jsxs("div",{className:"tandc-page-header",children:[a.jsx("h5",{children:"Terms & Conditions"}),a.jsx("div",{className:"add-button-wrapper",children:a.jsx("button",{className:"btn-add",onClick:()=>v(),children:"+ Add T&C"})})]}),a.jsx("div",{className:"search-field-wrapper",children:a.jsx("input",{type:"text",className:"search-input",placeholder:"Search T&C...",value:u,onChange:S=>l(S.target.value)})}),a.jsx("div",{className:"table-wrapper",children:a.jsxs("table",{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"ID"}),a.jsx("th",{children:"T&C Name"}),a.jsx("th",{children:"T&C Type"}),a.jsx("th",{align:"right",children:"Actions"})]})}),a.jsx("tbody",{children:e.map(S=>a.jsxs("tr",{children:[a.jsx("td",{children:S.ID}),a.jsx("td",{children:S.TandcName}),a.jsx("td",{children:S.TandcType}),a.jsxs("td",{className:"actions-cell",children:[a.jsx("button",{className:"icon-button",onClick:()=>v(S),title:"Edit",children:""}),a.jsx("button",{className:"icon-button delete-btn",onClick:()=>y(S.ID),title:"Delete",children:""})]})]},S.ID))})]})}),a.jsx("div",{className:"pagination-wrapper",children:a.jsxs("div",{className:"pagination-info",children:[a.jsxs("span",{children:["Rows per page: ",f]}),a.jsxs("span",{children:["Page ",d]})]})}),t?a.jsx("div",{className:`dialog-overlay ${t?"":"hidden"}`,children:a.jsxs("div",{className:"dialog-wrapper",children:[a.jsx("div",{className:"dialog-header",children:s?"Edit T&C":"Add New T&C"}),a.jsxs("div",{className:"dialog-content",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"tandc_name",children:"T&C Name"}),a.jsx("input",{id:"tandc_name",type:"text",name:"tandc_name",value:i.tandc_name,onChange:m,placeholder:"Enter T&C name"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"tandc_type",children:"T&C Type"}),a.jsx("input",{id:"tandc_type",type:"text",name:"tandc_type",value:i.tandc_type,onChange:m,placeholder:"Enter T&C type"})]})]}),a.jsxs("div",{className:"dialog-footer",children:[a.jsx("button",{className:"btn-secondary",onClick:g,children:"Cancel"}),a.jsx("button",{className:"btn-primary",onClick:b,children:s?"Update":"Add"})]})]})}):null]})})}const Oj=({prefix:e,values:r,onChange:t})=>a.jsxs("div",{className:"address-block",children:[a.jsxs("div",{className:"address-line",children:[a.jsxs("label",{children:[e," Address 1"]}),a.jsx("input",{name:"add1",value:r.add1,onChange:t})]}),a.jsxs("div",{className:"address-line",children:[a.jsxs("label",{children:[e," Address 2"]}),a.jsx("input",{name:"add2",value:r.add2,onChange:t})]}),a.jsxs("div",{className:"address-line",children:[a.jsxs("label",{children:[e," Address 3"]}),a.jsx("input",{name:"add3",value:r.add3,onChange:t})]}),a.jsxs("div",{className:"address-line",children:[a.jsxs("label",{children:[e," Address 4"]}),a.jsx("input",{name:"add4",value:r.add4,onChange:t})]}),a.jsxs("div",{className:"address-line",children:[a.jsxs("label",{children:[e," Address 5"]}),a.jsx("input",{name:"add5",value:r.add5,onChange:t})]})]}),cde=()=>{const[e,r]=G.useState({id:"",type:"",acno:"",name:"",businessName:"",address:{add1:"",add2:"",add3:"",add4:"",add5:""},phones:{phone:"",mobile:""},description:"",kname:"",businessKName:"",kannadaAddress:{add1:"",add2:"",add3:"",add4:"",add5:""},kannadaPhones:{phone:"",mobile:""},kannadaDescription:"",categories:[],files:[]}),t=[{id:1,label:"Supplier"},{id:2,label:"Distributor"},{id:3,label:"Dealer"},{id:4,label:"Retailer"},{id:5,label:"Manufacturer"},{id:6,label:"Service Provider"}],[n,s]=G.useState(""),o=t.filter(v=>v.label.toLowerCase().includes(n.toLowerCase())),i=v=>{const{name:g,value:m}=v.target;r(b=>({...b,[g]:m}))},c=v=>{r(g=>({...g,categories:g.categories.includes(v)?g.categories.filter(m=>m!==v):[...g.categories,v]}))},u=v=>g=>{const{name:m,value:b}=g.target;r(y=>({...y,[v]:{...y[v],[m]:b}}))},l=(v,g)=>m=>{const{value:b}=m.target;r(y=>({...y,[v]:{...y[v],[g]:b}}))},d=v=>{const g=Array.from(v.target.files);r(m=>({...m,files:[...m.files,...g]}))},h=v=>{r(g=>({...g,files:g.files.filter((m,b)=>b!==v)}))},f=()=>{r({id:"",type:"",acno:"",name:"",businessName:"",address:{add1:"",add2:"",add3:"",add4:"",add5:""},phones:{phone:"",mobile:""},description:"",kname:"",businessKName:"",kannadaAddress:{add1:"",add2:"",add3:"",add4:"",add5:""},kannadaPhones:{phone:"",mobile:""},kannadaDescription:"",categories:[],files:[]})},p=v=>{v.preventDefault();const g={...e};console.log("Submitting form:",g),alert("Form data logged to console")};return a.jsxs("div",{className:"erp-report-wrap",children:[a.jsx("div",{className:"erp-header",children:a.jsx("h1",{children:"Contact Entry Menu"})}),a.jsxs("form",{className:"erp-form",onSubmit:p,children:[a.jsxs("div",{className:"form-header",children:[a.jsxs("div",{className:"field",children:[a.jsx("label",{children:"ID"}),a.jsx("input",{name:"id",value:e.id,onChange:i})]}),a.jsxs("div",{className:"field",children:[a.jsx("label",{children:"Type"}),a.jsx("input",{name:"type",value:e.type,onChange:i})]}),a.jsxs("div",{className:"field",children:[a.jsx("label",{children:"Account No"}),a.jsx("input",{name:"acno",value:e.acno,onChange:i})]})]}),a.jsxs("div",{className:"two-columns",children:[a.jsxs("div",{className:"column",children:[a.jsx("div",{className:"column-title",children:"English"}),a.jsxs("div",{className:"address-line",children:[a.jsx("label",{children:"Name"}),a.jsx("input",{name:"name",value:e.name,onChange:i})]}),a.jsxs("div",{className:"address-line",children:[a.jsx("label",{children:"Business"}),a.jsx("input",{name:"businessName",value:e.businessName,onChange:i})]}),a.jsx("div",{className:"section-title small",children:"Address"}),a.jsx(Oj,{prefix:"",values:e.address,onChange:u("address")}),a.jsx("div",{className:"section-title small",children:"Phone / Mobile"}),a.jsxs("div",{className:"phones-col",children:[a.jsxs("div",{className:"phone-input",children:[a.jsx("label",{children:"Phone"}),a.jsx("input",{value:e.phones.phone,onChange:l("phones","phone")})]}),a.jsxs("div",{className:"phone-input",children:[a.jsx("label",{children:"Mobile"}),a.jsx("input",{value:e.phones.mobile,onChange:l("phones","mobile")})]})]}),a.jsx("div",{className:"section-title small",children:"Description"}),a.jsxs("div",{className:"row",children:[a.jsx("label",{}),a.jsx("input",{value:e.description,onChange:v=>r(g=>({...g,description:v.target.value}))})]})]}),a.jsxs("div",{className:"column",children:[a.jsx("div",{className:"column-title",children:"Kannada"}),a.jsxs("div",{className:"address-line",children:[a.jsx("label",{children:"Name"}),a.jsx("input",{name:"kname",value:e.kname,onChange:i})]}),a.jsxs("div",{className:"address-line",children:[a.jsx("label",{children:"Business"}),a.jsx("input",{name:"businessKName",value:e.businessKName,onChange:i})]}),a.jsx("div",{className:"section-title small",children:"Address"}),a.jsx(Oj,{prefix:"",values:e.kannadaAddress,onChange:u("kannadaAddress")}),a.jsx("div",{className:"section-title small",children:"Phone / Mobile"}),a.jsxs("div",{className:"phones-col",children:[a.jsxs("div",{className:"phone-input",children:[a.jsx("label",{children:"Phone"}),a.jsx("input",{value:e.kannadaPhones.phone,onChange:l("kannadaPhones","phone")})]}),a.jsxs("div",{className:"phone-input",children:[a.jsx("label",{children:"Mobile"}),a.jsx("input",{value:e.kannadaPhones.mobile,onChange:l("kannadaPhones","mobile")})]})]}),a.jsx("div",{className:"section-title small",children:"Description"}),a.jsxs("div",{className:"row",children:[a.jsx("label",{}),a.jsx("input",{value:e.kannadaDescription,onChange:v=>r(g=>({...g,kannadaDescription:v.target.value}))})]})]})]}),a.jsxs("div",{className:"form-footer",children:[a.jsxs("div",{className:"footer-left",children:[a.jsx("label",{children:"Categories"}),a.jsx("input",{className:"category-search",placeholder:"Search categories...",value:n,onChange:v=>s(v.target.value)}),a.jsx("div",{className:"category-grid",children:o.map(v=>a.jsxs("label",{className:"category-checkbox",children:[a.jsx("input",{type:"checkbox",checked:e.categories.includes(v.id),onChange:()=>c(v.id)}),a.jsx("span",{children:v.label})]},v.id))}),e.categories.length>0&&a.jsxs("div",{className:"selected-categories",children:[a.jsx("strong",{children:"Selected:"})," ",t.filter(v=>e.categories.includes(v.id)).map(v=>v.label).join(", ")]})]}),a.jsxs("div",{className:"footer-right",children:[a.jsx("label",{children:"Documents / Uploads"}),a.jsxs("div",{className:"file-upload",children:[a.jsx("input",{type:"file",id:"file",multiple:!0,onChange:d}),a.jsxs("div",{className:"file-list",children:[e.files.map((v,g)=>a.jsxs("div",{className:"file-item",children:[a.jsx("span",{className:"file-name",children:v.name}),a.jsx("button",{type:"button",className:"btn-link",onClick:()=>h(g),children:"Remove"})]},g)),e.files.length===0&&a.jsx("div",{className:"file-hint",children:"No documents uploaded"})]})]})]})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{type:"submit",className:"btn primary",children:"Save"}),a.jsx("button",{type:"button",className:"btn",onClick:f,children:"Reset"})]})]})]})},W_=G.createContext();function ude({children:e}){const[r,t]=G.useState(!1),n={isToggleSideBar:r,setIsToggleSideBar:t};G.useEffect(()=>{},[r]);const s=qf(),i=["/","/login"].includes(s.pathname);return a.jsx(W_.Provider,{value:n,children:i?e:a.jsxs(a.Fragment,{children:[a.jsx(WB,{}),a.jsxs("div",{className:"main d-flex",children:[a.jsx("div",{className:`main-side-bar-wraper ${r===!0?"toggle-menu":""}`,children:a.jsx(XB,{})}),a.jsx("div",{className:`content ${r===!0?"toggle-menu":""}`,children:e})]})]})})}function dde(){return a.jsx(eL,{children:a.jsx(ude,{children:a.jsxs(NT,{children:[a.jsx(zn,{path:"/",element:a.jsx(y8,{})}),a.jsx(zn,{path:"/login",element:a.jsx(y8,{})}),a.jsx(zn,{path:"/home",element:a.jsx(YB,{})}),a.jsx(zn,{path:"/profile",element:a.jsx($z,{})}),a.jsx(zn,{path:"/settings",element:a.jsx(Uz,{})}),a.jsx(zn,{path:"/ManageCategory",element:a.jsx(hG,{})}),a.jsx(zn,{path:"/ManageSubcategory",element:a.jsx(vG,{})}),a.jsx(zn,{path:"/ManageTag",element:a.jsx(yG,{})}),a.jsx(zn,{path:"/ManageUnitStoreTax",element:a.jsx(OG,{})}),a.jsx(zn,{path:"/ManageProduct",element:a.jsx(dK,{})}),a.jsx(zn,{path:"/ManageBranch",element:a.jsx(Roe,{})}),a.jsx(zn,{path:"/ManageBank",element:a.jsx(Oie,{})}),a.jsx(zn,{path:"/ManageCompany",element:a.jsx(Noe,{})}),a.jsx(zn,{path:"/ManageSeries",element:a.jsx(Eoe,{})}),a.jsx(zn,{path:"/ProductMaster",element:a.jsx(Tie,{})}),a.jsx(zn,{path:"/products/:id/edit",element:a.jsx(Mie,{})}),a.jsx(zn,{path:"/products/:id/variants",element:a.jsx(Iie,{})}),a.jsx(zn,{path:"/users/add",element:a.jsx(aj,{})}),a.jsx(zn,{path:"/users/:id/edit",element:a.jsx(aj,{})}),a.jsx(zn,{path:"/users",element:a.jsx(koe,{})}),a.jsx(zn,{path:"/employeemaster",element:a.jsx(lj,{})}),a.jsx(zn,{path:"/employeemaster/:id",element:a.jsx(lj,{})}),a.jsx(zn,{path:"/employeemanagement",element:a.jsx(Doe,{})}),a.jsx(zn,{path:"/assignusertoemployee",element:a.jsx(Uoe,{})}),a.jsx(zn,{path:"/departmentmaster",element:a.jsx(zoe,{})}),a.jsx(zn,{path:"/designation",element:a.jsx($oe,{})}),a.jsx(zn,{path:"/address",element:a.jsx(G3,{})}),a.jsx(zn,{path:"/address/create",element:a.jsx(G3,{})}),a.jsx(zn,{path:"/address/edit/:id",element:a.jsx(G3,{})}),a.jsx(zn,{path:"/crm-master",element:a.jsx($ue,{})}),a.jsx(zn,{path:"/account",element:a.jsx(Uue,{})}),a.jsx(zn,{path:"/customize",element:a.jsx(Wue,{})}),a.jsx(zn,{path:"/reports",element:a.jsx(Xue,{})}),a.jsx(zn,{path:"/quotation",element:a.jsx(Lj,{})}),a.jsx(zn,{path:"/quotation/:id",element:a.jsx(Lj,{})}),a.jsx(zn,{path:"/quotation-list",element:a.jsx(Yue,{})}),a.jsx(zn,{path:"/rolecreation",element:a.jsx(sN,{})}),a.jsx(zn,{path:"/existingroles",element:a.jsx(rde,{})}),a.jsx(zn,{path:"/rolemanagement",element:a.jsx(ede,{})}),a.jsx(zn,{path:"/menucreation",element:a.jsx(iN,{})}),a.jsx(zn,{path:"/existingmenus",element:a.jsx(ade,{})}),a.jsx(zn,{path:"/usermanagement",element:a.jsx(sde,{})}),a.jsx(zn,{path:"/auditlogs",element:a.jsx(ode,{})}),a.jsx(zn,{path:"/Managetandc",element:a.jsx(lde,{})}),a.jsx(zn,{path:"*",element:a.jsx(zz,{})}),a.jsx(zn,{path:"/erpreport",element:a.jsx(cde,{})})]})})})}function fde(){return G.useEffect(()=>{const e=()=>{document.querySelectorAll("input, textarea, select").forEach(n=>{n.setAttribute("autocomplete","off"),n.setAttribute("autocorrect","off"),n.setAttribute("autocapitalize","off"),n.setAttribute("spellcheck","false")})};e();const r=new MutationObserver(e);return r.observe(document.body,{childList:!0,subtree:!0}),()=>r.disconnect()},[]),a.jsx(dde,{})}BN.createRoot(document.getElementById("root")).render(a.jsx(G.StrictMode,{children:a.jsx(fde,{})}));
